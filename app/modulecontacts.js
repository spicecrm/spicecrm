/*!
 * 
 *                     SpiceCRM
 *
 *                     release: 2024.01.001
 *
 *                     date: 2024-06-07 18:53:45
 *
 *                     build: 2024.01.001.1717779225604
 *
 */
"use strict";(self.webpackChunkcore=self.webpackChunkcore||[]).push([["src_modules_contacts_modulecontacts_ts"],{5373:(e,s,t)=>{t.r(s),t.d(s,{ModuleContacts:()=>ne});var i=t(60177),l=t(84341),n=t(71341),a=t(7745),o=t(12948),r=t(37328),c=t(70569),d=t(54438),u=t(69904),h=t(35911),m=t(50531),b=t(32062);let p=(()=>{class ContactNewslettersButton{constructor(e,s,t,i){this.language=e,this.model=s,this.modal=t,this.ViewContainerRef=i,this.disabled=!0}ngOnInit(){this.handleDisabled(),this.model.mode$.subscribe((e=>{this.handleDisabled()})),this.model.data$.subscribe((e=>{this.handleDisabled()}))}execute(){this.modal.openModal("ContactNewsletters",!0,this.ViewContainerRef.injector)}handleDisabled(){this.disabled=!(this.model.getField("email1")&&!this.model.isEditing&&this.model.checkAccess("edit"))}static#e=this.ɵfac=function(e){return new(e||ContactNewslettersButton)(d.rXU(u.B),d.rXU(h.g),d.rXU(m.y),d.rXU(d.c1b))};static#s=this.ɵcmp=d.VBU({type:ContactNewslettersButton,selectors:[["contact-newsletters-button"]],decls:2,vars:0,consts:[["label","LBL_MANAGE_SUBSCRIPTIONS"]],template:function(e,s){1&e&&(d.j41(0,"span"),d.nrm(1,"system-label",0),d.k0s())},dependencies:[b.W],encapsulation:2})}return ContactNewslettersButton})();var f=t(49722),g=t(83935),R=t(25863),_=t(40713),E=t(25028),y=t(88418),L=t(83524);function v(e,s){if(1&e){const e=d.RV6();d.j41(0,"li",16),d.bIt("click",(function(){const s=d.eBV(e).$implicit,t=d.XpG();return d.Njj(t.selectNewsletter("available",s.id))})),d.j41(1,"span",17),d.EFF(2),d.k0s()()}if(2&e){const e=s.$implicit,t=d.XpG();d.BMQ("aria-selected",t.isSelected("available",e.id)),d.R7$(2),d.JRh(e.summary_text)}}function k(e,s){if(1&e){const e=d.RV6();d.j41(0,"li",16),d.bIt("click",(function(){const s=d.eBV(e).$implicit,t=d.XpG();return d.Njj(t.selectNewsletter("subscribed",s.id))})),d.j41(1,"span",17),d.EFF(2),d.k0s()()}if(2&e){const e=s.$implicit,t=d.XpG();d.BMQ("aria-selected",t.isSelected("subscribed",e.id)),d.R7$(2),d.JRh(e.summary_text)}}let w=(()=>{class ContactNewsletters{constructor(e,s,t,i){this.language=e,this.backend=s,this.metadata=t,this.model=i,this.rawResult={},this.availableNewsLetters=[],this.subscribedNewsLetters=[],this.selectedAvailable=[],this.selectedSubscribed=[],this.multiselect=!1,this.self={},this.backend.getRequest("module/Contacts/"+this.model.id+"/newsletters/subscriptions").subscribe((e=>{this.rawResult=e;let s={};for(let t of e.news_type_list_arr)switch(t.list_type){case"default":s[t.campaign_id]||(s[t.campaign_id]={name:t.name},s[t.campaign_id].defaultList=t.prospect_list_id);break;case"exempt":s[t.campaign_id]||(s[t.campaign_id]={name:t.name}),s[t.campaign_id].exemptList=t.prospect_list_id}for(let t of e.current_plp_arr)for(let e in s)s[e].defaultList==t.prospect_list_id?(this.subscribedNewsLetters.push({id:e,summary_text:s[e].name,defaultList:s[e].defaultList,exemptList:s[e].exemptList}),delete s[e]):s[e].defaultList==t.prospect_list_id&&(this.availableNewsLetters.push({id:e,summary_text:s[e].name,defaultList:s[e].defaultList,exemptList:s[e].exemptList}),delete s[e]);for(let e in s)this.availableNewsLetters.push({id:e,summary_text:s[e].name,defaultList:s[e].defaultList,exemptList:s[e].exemptList}),delete s[e]}))}closePopup(){this.self.destroy()}keypressed(e){"keydown"===e.type&&"Control"===e.key&&!1===this.multiselect&&(this.multiselect=!0),"keyup"===e.type&&"Control"===e.key&&!0===this.multiselect&&(this.multiselect=!1)}isSelected(e,s){switch(e){case"available":return this.selectedAvailable.indexOf(s)>=0;case"subscribed":return this.selectedSubscribed.indexOf(s)>=0}}selectNewsletter(e,s){switch(e){case"available":!1===this.multiselect?this.selectedAvailable=[s]:this.selectedAvailable.indexOf(s)>=0?this.selectedAvailable.splice(this.selectedAvailable.indexOf(s),1):this.selectedAvailable.push(s);break;case"subscribed":!1===this.multiselect?this.selectedSubscribed=[s]:this.selectedSubscribed.indexOf(s)>=0?this.selectedSubscribed.splice(this.selectedSubscribed.indexOf(s),1):this.selectedSubscribed.push(s)}}subscribe(){this.selectedAvailable.forEach((e=>{this.availableNewsLetters.some(((s,t)=>{if(e==s.id)return this.subscribedNewsLetters.push(this.availableNewsLetters.splice(t,1)[0]),!0}))})),this.selectedAvailable=[]}unsubscribe(){this.selectedSubscribed.forEach((e=>{this.subscribedNewsLetters.some(((s,t)=>{if(e==s.id)return this.availableNewsLetters.push(this.subscribedNewsLetters.splice(t,1)[0]),!0}))})),this.selectedSubscribed=[]}save(){let e={subscribed:this.subscribedNewsLetters,unsubscribed:this.availableNewsLetters};this.backend.postRequest("module/Contacts/"+this.model.id+"/newsletters/subscriptions",{},e).subscribe((e=>{this.closePopup()}))}static#e=this.ɵfac=function(e){return new(e||ContactNewsletters)(d.rXU(u.B),d.rXU(f.H),d.rXU(g.yu),d.rXU(h.g))};static#s=this.ɵcmp=d.VBU({type:ContactNewsletters,selectors:[["contact-newsletters"]],decls:30,vars:7,consts:[[3,"close"],[1,"slds-text-heading--medium"],[1,"slds-picklist--draggable","slds-grid","slds-grid--align-center"],[1,"slds-grid","slds-grid--align-center"],[1,"slds-form-element"],["aria-label","select-1",1,"slds-form-element__label"],[1,"slds-picklist"],[1,"slds-picklist__options","slds-picklist__options--multi"],["draggable","false","class","slds-picklist__item","role","option",3,"click",4,"ngFor","ngForOf"],[1,"slds-grid","slds-grid--vertical"],[1,"slds-button","slds-button--icon-container",3,"disabled","click"],[3,"icon"],[1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_CANCEL"],[1,"slds-button","slds-button--brand",3,"click"],["label","LBL_SAVE"],["draggable","false","role","option",1,"slds-picklist__item",3,"click"],[1,"slds-truncate"]],template:function(e,s){1&e&&(d.j41(0,"system-modal")(1,"system-modal-header",0),d.bIt("close",(function(){return s.closePopup()})),d.j41(2,"h2",1),d.EFF(3),d.k0s()(),d.j41(4,"system-modal-content")(5,"div",2)(6,"div",3)(7,"div",4)(8,"span",5),d.EFF(9,"Available Newsletters"),d.k0s(),d.j41(10,"div",6)(11,"ul",7),d.DNE(12,v,3,2,"li",8),d.k0s()()(),d.j41(13,"div",9)(14,"button",10),d.bIt("click",(function(){return s.unsubscribe()})),d.nrm(15,"system-button-icon",11),d.k0s(),d.j41(16,"button",10),d.bIt("click",(function(){return s.subscribe()})),d.nrm(17,"system-button-icon",11),d.k0s()()(),d.j41(18,"div",3)(19,"div",4)(20,"span",5),d.EFF(21,"Subscribed Newsletters"),d.k0s(),d.j41(22,"div",6)(23,"ul",7),d.DNE(24,k,3,2,"li",8),d.k0s()()()()()(),d.j41(25,"system-modal-footer")(26,"button",12),d.bIt("click",(function(){return s.closePopup()})),d.nrm(27,"system-label",13),d.k0s(),d.j41(28,"button",14),d.bIt("click",(function(){return s.save()})),d.nrm(29,"system-label",15),d.k0s()()()),2&e&&(d.R7$(3),d.SpI("Newsletter Subscriptions for ",s.model.data.name,""),d.R7$(9),d.Y8G("ngForOf",s.availableNewsLetters),d.R7$(2),d.Y8G("disabled",0===s.selectedSubscribed.length),d.R7$(),d.Y8G("icon","left"),d.R7$(),d.Y8G("disabled",0===s.selectedAvailable.length),d.R7$(),d.Y8G("icon","right"),d.R7$(7),d.Y8G("ngForOf",s.subscribedNewsLetters))},dependencies:[i.Sq,R.t,b.W,_.D,E.I,y.Q,L.C],encapsulation:2})}return ContactNewsletters})(),P=(()=>{class ContactPortalButton{constructor(e,s,t,i,l){this.language=e,this.model=s,this.metadata=t,this.modal=i,this.viewContainerRef=l,this.disabled=!0}ngOnInit(){this.handleDisabled(),this.model.mode$.subscribe((e=>{this.handleDisabled()})),this.model.data$.subscribe((e=>{this.handleDisabled()}))}handleDisabled(){this.disabled=!((this.model.getField("email1")||this.model.getField("email_address_private"))&&!this.model.isEditing&&this.model.checkAccess("edit"))}execute(){this.modal.openModal("ContactPortalDetails",!0,this.viewContainerRef.injector)}static#e=this.ɵfac=function(e){return new(e||ContactPortalButton)(d.rXU(u.B),d.rXU(h.g),d.rXU(g.yu),d.rXU(m.y),d.rXU(d.c1b))};static#s=this.ɵcmp=d.VBU({type:ContactPortalButton,selectors:[["contact-portal-button"]],decls:2,vars:0,consts:[["label","LBL_PORTAL_INFORMATION"]],template:function(e,s){1&e&&(d.j41(0,"span"),d.nrm(1,"system-label",0),d.k0s())},dependencies:[b.W],encapsulation:2})}return ContactPortalButton})();var S=t(96697),C=t(41081),N=t(53584),x=t(48717),G=t(59851);function j(e,s){1&e&&(d.qex(0),d.nrm(1,"system-label",8),d.bVm())}function I(e,s){1&e&&(d.qex(0),d.nrm(1,"system-label",9),d.bVm())}function D(e,s){if(1&e&&(d.qex(0),d.DNE(1,j,2,0,"ng-container",1)(2,I,2,0,"ng-container",1),d.j41(3,"span",6)(4,"span",7),d.EFF(5),d.k0s()(),d.bVm()),2&e){const e=d.XpG();d.R7$(),d.Y8G("ngIf",e.isNewUser),d.R7$(),d.Y8G("ngIf",!e.isNewUser),d.R7$(3),d.JRh(e.model.data.name)}}function F(e,s){1&e&&(d.qex(0),d.nrm(1,"system-label",10),d.bVm())}function U(e,s){1&e&&d.nrm(0,"system-spinner")}function $(e,s){1&e&&(d.j41(0,"div",33),d.nrm(1,"system-label",34),d.k0s())}function B(e,s){1&e&&(d.qex(0),d.j41(1,"abbr",21),d.EFF(2,"* "),d.k0s(),d.nrm(3,"system-label",35),d.bVm())}function M(e,s){1&e&&(d.qex(0),d.nrm(1,"system-label",36),d.EFF(2,"?"),d.bVm())}function A(e,s){if(1&e&&(d.j41(0,"div",33),d.EFF(1),d.k0s()),2&e){const e=d.XpG(2);d.R7$(),d.JRh(e.pwdError)}}function T(e,s){if(1&e&&(d.j41(0,"div",37),d.nrm(1,"system-label",38),d.EFF(2,":"),d.nrm(3,"br"),d.EFF(4),d.k0s()),2&e){const e=d.XpG(2);d.R7$(4),d.SpI(" ",e.pwdGuideline," ")}}function X(e,s){if(1&e&&(d.j41(0,"option",40),d.EFF(1),d.k0s()),2&e){const e=s.$implicit,t=d.XpG(3);d.Y8G("value",e.id)("selected",t.user.aclRole===e.id),d.R7$(),d.JRh(e.name)}}function O(e,s){if(1&e){const e=d.RV6();d.j41(0,"div",12)(1,"label",13)(2,"abbr",21),d.EFF(3,"* "),d.k0s(),d.nrm(4,"system-label",39),d.k0s(),d.j41(5,"div",15)(6,"div",29)(7,"select",30),d.mxI("ngModelChange",(function(s){d.eBV(e);const t=d.XpG(2);return d.DH7(t.user.aclRole,s)||(t.user.aclRole=s),d.Njj(s)})),d.DNE(8,X,2,3,"option",31),d.k0s()()()()}if(2&e){const e=d.XpG(2);d.R7$(7),d.R50("ngModel",e.user.aclRole),d.R7$(),d.Y8G("ngForOf",e.aclRoles)}}function Y(e,s){if(1&e&&(d.j41(0,"option",40),d.EFF(1),d.k0s()),2&e){const e=s.$implicit,t=d.XpG(3);d.Y8G("value",e.id)("selected",t.user.aclProfile===e.id),d.R7$(),d.JRh(e.name)}}function V(e,s){if(1&e){const e=d.RV6();d.j41(0,"div",12)(1,"label",13)(2,"abbr",21),d.EFF(3,"* "),d.k0s(),d.nrm(4,"system-label",41),d.k0s(),d.j41(5,"div",15)(6,"div",29)(7,"select",30),d.mxI("ngModelChange",(function(s){d.eBV(e);const t=d.XpG(2);return d.DH7(t.user.aclProfile,s)||(t.user.aclProfile=s),d.Njj(s)})),d.DNE(8,Y,2,3,"option",31),d.k0s()()()()}if(2&e){const e=d.XpG(2);d.R7$(7),d.R50("ngModel",e.user.aclProfile),d.R7$(),d.Y8G("ngForOf",e.aclProfiles)}}function W(e,s){if(1&e&&(d.j41(0,"option",40),d.EFF(1),d.k0s()),2&e){const e=s.$implicit,t=d.XpG(2);d.Y8G("value",e.id)("selected",t.user.portalRole===e.id),d.R7$(),d.JRh(e.name)}}function q(e,s){if(1&e&&(d.j41(0,"label",13),d.EFF(1),d.nrm(2,"system-icon-help-text",42),d.k0s()),2&e){const e=d.XpG(2);d.R7$(),d.SpI("",e.language.getLabel("LBL_SET_DATE_TIME_PREFS")," "),d.R7$(),d.Y8G("helpText",e.language.getLabel("HLP_SET_DATE_TIME_PREFS"))}}function H(e,s){if(1&e&&(d.j41(0,"label",13),d.EFF(1),d.nrm(2,"system-icon-help-text",42),d.k0s()),2&e){const e=d.XpG(2);d.R7$(),d.SpI("",e.language.getLabel("LBL_RESET_DATE_TIME_PREFS")," "),d.R7$(),d.Y8G("helpText",e.language.getLabel("HLP_RESET_DATE_TIME_PREFS"))}}const J=e=>({"slds-has-error":e});function z(e,s){if(1&e){const e=d.RV6();d.j41(0,"div",11)(1,"div",12)(2,"label",13),d.nrm(3,"system-label",14),d.k0s(),d.j41(4,"div",15)(5,"label",16)(6,"input",17),d.mxI("ngModelChange",(function(s){d.eBV(e);const t=d.XpG();return d.DH7(t.user.active,s)||(t.user.active=s),d.Njj(s)})),d.k0s(),d.j41(7,"span",18),d.nrm(8,"span",19),d.k0s()()()(),d.j41(9,"div",20)(10,"label",13)(11,"abbr",21),d.EFF(12,"* "),d.k0s(),d.nrm(13,"system-label",22),d.k0s(),d.j41(14,"div",15)(15,"input",23),d.mxI("ngModelChange",(function(s){d.eBV(e);const t=d.XpG();return d.DH7(t.user.name,s)||(t.user.name=s),d.Njj(s)})),d.bIt("change",(function(){d.eBV(e);const s=d.XpG();return d.Njj(s.testUsername())})),d.k0s(),d.DNE(16,$,2,0,"div",24),d.k0s()(),d.j41(17,"div",20)(18,"label",13),d.DNE(19,B,4,0,"ng-container",1)(20,M,3,0,"ng-container",1),d.k0s(),d.j41(21,"div",15)(22,"input",25),d.mxI("ngModelChange",(function(s){d.eBV(e);const t=d.XpG();return d.DH7(t.user.password,s)||(t.user.password=s),d.Njj(s)})),d.k0s(),d.DNE(23,A,2,1,"div",24)(24,T,5,1,"div",26),d.k0s()(),d.DNE(25,O,9,2,"div",27)(26,V,9,2,"div",27),d.j41(27,"div",12)(28,"label",13)(29,"abbr",21),d.EFF(30,"* "),d.k0s(),d.nrm(31,"system-label",28),d.k0s(),d.j41(32,"div",15)(33,"div",29)(34,"select",30),d.mxI("ngModelChange",(function(s){d.eBV(e);const t=d.XpG();return d.DH7(t.user.portalRole,s)||(t.user.portalRole=s),d.Njj(s)})),d.DNE(35,W,2,3,"option",31),d.k0s()()()(),d.j41(36,"div",12),d.DNE(37,q,3,2,"label",32)(38,H,3,2,"label",32),d.j41(39,"div",15)(40,"label",16)(41,"input",17),d.mxI("ngModelChange",(function(s){d.eBV(e);const t=d.XpG();return d.DH7(t.user.setDateTimePrefsWithSystemDefaults,s)||(t.user.setDateTimePrefsWithSystemDefaults=s),d.Njj(s)})),d.k0s(),d.j41(42,"span",18),d.nrm(43,"span",19),d.k0s()()()()()}if(2&e){const e=d.XpG();d.R7$(6),d.R50("ngModel",e.user.active),d.R7$(3),d.Y8G("ngClass",d.eq3(19,J,e.usernameAlreadyExists)),d.R7$(6),d.R50("ngModel",e.user.name),d.Y8G("disabled",e.usernameTesting),d.R7$(),d.Y8G("ngIf",e.usernameAlreadyExists),d.R7$(),d.Y8G("ngClass",d.eq3(21,J,e.pwdError)),d.R7$(2),d.Y8G("ngIf",e.isNewUser),d.R7$(),d.Y8G("ngIf",!e.isNewUser),d.R7$(2),d.R50("ngModel",e.user.password),d.Y8G("ngClass",d.eq3(23,J,e.pwdError)),d.R7$(),d.Y8G("ngIf",e.pwdError),d.R7$(),d.Y8G("ngIf",e.pwdGuideline),d.R7$(),d.Y8G("ngIf",e.aclRoles.length),d.R7$(),d.Y8G("ngIf",e.aclProfiles.length),d.R7$(8),d.R50("ngModel",e.user.portalRole),d.R7$(),d.Y8G("ngForOf",e.portalRoles),d.R7$(2),d.Y8G("ngIf",e.isNewUser),d.R7$(),d.Y8G("ngIf",!e.isNewUser),d.R7$(3),d.R50("ngModel",e.user.setDateTimePrefsWithSystemDefaults)}}function Q(e,s){if(1&e){const e=d.RV6();d.j41(0,"button",43),d.bIt("click",(function(){d.eBV(e);const s=d.XpG();return d.Njj(s.save())})),d.nrm(1,"system-label",44),d.k0s()}if(2&e){const e=d.XpG();d.Y8G("disabled",!e.canSave)}}let K=(()=>{class ContactPortalDetails{constructor(e,s,t,i,l,n){this.language=e,this.backend=s,this.metadata=t,this.model=i,this.toast=l,this.configuration=n,this.loaded=!1,this.user={active:!1,id:"",aclRole:"",aclProfile:"",portalRole:"",password:"",name:"",setDateTimePrefsWithSystemDefaults:!0},this.pwdGuideline="",this.pwdCheckRegex=new RegExp("//"),this.aclRoles=[],this.aclProfiles=[],this.portalRoles=[],this.self=void 0,this.usernameAlreadyExists=!1,this.usernameTesting=!1,this.isSaving=!1}ngOnInit(){this.getInfo(),this.backend.getRequest("module/Contacts/"+this.model.id+"/portalAccess").pipe((0,S.s)(1)).subscribe((e=>{e.aclRoles&&(this.aclRoles=e.aclRoles),e.aclProfiles&&(this.aclProfiles=e.aclProfiles),e.defaultPortalUserProfile&&(this.defaultPortalUserProfile=e.defaultPortalUserProfile),this.portalRoles=e.portalRoles,e.user&&e.user.id&&(this.user.active=e.user.status,this.user.id=e.user.id,e.user.aclRole&&(this.user.aclRole=e.user.aclRole),e.user.aclProfile&&(this.user.aclProfile=e.user.aclProfile),this.user.portalRole=e.user.portalRole,this.user.setDateTimePrefsWithSystemDefaults=!1),this.user.id||(this.aclRoles.some((e=>{if("Portal"===e.name)return this.user.aclRole=e.id,!0})),this.portalRoles.some((e=>{if("Portal"===e.name)return this.user.portalRole=e.id,!0}))),this.user.id?(this.user.name=e.user.username,this.loaded=!0):(this.user.name=this.model.getField("email1")?this.model.getField("email1"):this.model.getField("email_address_private"),this.testUsername(),1===this.aclProfiles.length?this.user.aclProfile=this.aclProfiles[0].id:this.defaultPortalUserProfile&&(this.user.aclProfile=this.defaultPortalUserProfile))}))}testUsername(){this.user.name&&(this.usernameTesting=!0,this.backend.getRequest("module/Contacts/"+this.model.id+"/testUsername",{username:this.user.name}).pipe((0,S.s)(1)).subscribe((e=>{e.error||(this.usernameAlreadyExists=e.exists,this.loaded=!0,this.usernameTesting=!1)})))}get pwdError(){return!!this.loaded&&(!(!this.user.password||this.pwdCheckRegex.test(this.user.password))&&this.language.getLabel("MSG_PWD_NOT_LEGAL"))}closeModal(){this.self.destroy()}get isNewUser(){return this.loaded&&""==this.user.id}get canSave(){if(this.isSaving)return!1;if(this.usernameTesting)return!1;if(!this.user.name||!this.user.portalRole||!this.user.aclRole&&this.aclRoles.length||!this.user.aclProfile&&this.aclProfiles.length)return!1;if(this.usernameAlreadyExists)return!1;if(this.isNewUser){if(!this.user.password||this.pwdError)return!1}else if(this.pwdError)return!1;return!0}save(){if(this.canSave){this.isSaving=!0;let e={status:this.user.active,aclRole:this.aclRoles.length?this.user.aclRole:void 0,aclProfile:this.aclProfiles.length?this.user.aclProfile:void 0,portalRole:this.user.portalRole,username:this.user.name,password:this.user.password,setDateTimePrefsWithSystemDefaults:this.user.setDateTimePrefsWithSystemDefaults};this.toast.clearToast(this.lastToast),this.isNewUser?this.backend.postRequest("module/Contacts/"+this.model.id+"/portalAccess",{},e).pipe((0,S.s)(1)).subscribe((e=>{e.success&&(this.lastToast=this.toast.sendToast("Portal user created successfully.","success")),this.closeModal()}),(e=>{this.lastToast=this.toast.sendToast("Error saving data of portal user.","error",e.error.error.message,!1),this.isSaving=!1})):this.backend.putRequest("module/Contacts/"+this.model.id+"/portalAccess",{},e).pipe((0,S.s)(1)).subscribe((e=>{e.success&&(this.lastToast=this.toast.sendToast("Portal user edited successfully.","success")),this.closeModal()}),(e=>{this.lastToast=this.toast.sendToast("Error saving data of portal user.","error",e.error.error.message,!1),this.isSaving=!1}))}}getInfo(){let e=this.configuration.getCapabilityConfig("userpassword");this.pwdCheckRegex=new RegExp(e.regex);let s=[];e.onelower&&s.push(this.language.getLabel("MSG_PASSWORD_ONELOWER")),e.oneupper&&s.push(this.language.getLabel("MSG_PASSWORD_ONEUPPER")),e.onenumber&&s.push(this.language.getLabel("MSG_PASSWORD_ONENUMBER")),e.onespecial&&s.push(this.language.getLabel("MSG_PASSWORD_ONESPECIAL")),e.minpwdlength&&s.push(this.language.getLabel("MSG_PASSWORD_LENGTH")+" "+e.minpwdlength),this.pwdGuideline=s.join(", ")}static#e=this.ɵfac=function(e){return new(e||ContactPortalDetails)(d.rXU(u.B),d.rXU(f.H),d.rXU(g.yu),d.rXU(h.g),d.rXU(C.o),d.rXU(N.i))};static#s=this.ɵcmp=d.VBU({type:ContactPortalDetails,selectors:[["contact-portal-details"]],decls:11,vars:5,consts:[[3,"close"],[4,"ngIf"],["class","slds-form slds-form_horizontal",4,"ngIf"],[1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_CANCEL"],["class","slds-button slds-button--brand",3,"disabled","click",4,"ngIf"],[1,"slds-text-heading_small","slds-p-top_x-small",2,"display","block"],[1,"slds-p-horizontal--x-small","slds-theme--info","slds-text-color--inverse",2,"opacity","0.66"],["label","LBL_CREATE_PORTAL_USER"],["label","LBL_EDIT_PORTAL_USER"],["label","LBL_PORTAL_USER"],[1,"slds-form","slds-form_horizontal"],[1,"slds-form-element"],[1,"slds-form-element__label"],["label","LBL_ACTIVE"],[1,"slds-form-element__control"],[1,"slds-checkbox_toggle","slds-grid"],["type","checkbox","name","active",3,"ngModel","ngModelChange"],["aria-live","assertive",1,"slds-checkbox_faux_container"],[1,"slds-checkbox_faux"],[1,"slds-form-element",3,"ngClass"],["title","required",1,"slds-required"],["label","LBL_USER_NAME"],["type","text",1,"slds-input",3,"ngModel","disabled","ngModelChange","change"],["class","slds-form-element__help",4,"ngIf"],["type","text",1,"slds-input",3,"ngModel","ngClass","ngModelChange"],["class","slds-m-top--xx-small slds-form-element__help","style","color:inherit",4,"ngIf"],["class","slds-form-element",4,"ngIf"],["label","LBL_PORTAL_ROLE"],[1,"slds-select_container"],[1,"slds-select",3,"ngModel","ngModelChange"],[3,"value","selected",4,"ngFor","ngForOf"],["class","slds-form-element__label",4,"ngIf"],[1,"slds-form-element__help"],["label","MSG_USERNAME_ALREADY_EXISTS"],["label","LBL_PASSWORD"],["label","LBL_NEW_PWD"],[1,"slds-m-top--xx-small","slds-form-element__help",2,"color","inherit"],["label","LBL_PWD_GUIDELINE"],["label","LBL_ACL_ROLE"],[3,"value","selected"],["label","LBL_SPICEACLPROFILE"],[3,"helpText"],[1,"slds-button","slds-button--brand",3,"disabled","click"],["label","LBL_SAVE"]],template:function(e,s){1&e&&(d.j41(0,"system-modal")(1,"system-modal-header",0),d.bIt("close",(function(){return s.closeModal()})),d.DNE(2,D,6,3,"ng-container",1)(3,F,2,0,"ng-container",1),d.k0s(),d.j41(4,"system-modal-content"),d.DNE(5,U,1,0,"system-spinner",1)(6,z,44,25,"div",2),d.k0s(),d.j41(7,"system-modal-footer")(8,"button",3),d.bIt("click",(function(){return s.closeModal()})),d.nrm(9,"system-label",4),d.k0s(),d.DNE(10,Q,2,1,"button",5),d.k0s()()),2&e&&(d.R7$(2),d.Y8G("ngIf",s.loaded),d.R7$(),d.Y8G("ngIf",!s.loaded),d.R7$(2),d.Y8G("ngIf",!s.loaded),d.R7$(),d.Y8G("ngIf",s.loaded),d.R7$(4),d.Y8G("ngIf",s.loaded))},dependencies:[i.YU,i.Sq,i.bT,l.xH,l.y7,l.me,l.Zm,l.wz,l.BC,l.vS,b.W,_.D,E.I,y.Q,L.C,x.P,G.N],encapsulation:2})}return ContactPortalDetails})();var Z=t(18359),ee=t(48849),se=t(18521);function te(e,s){if(1&e&&d.nrm(0,"system-utility-icon",5),2&e){const e=d.XpG();d.Y8G("icon",e.syncicon)}}function ie(e,s){1&e&&d.nrm(0,"system-spinner",6)}let le=(()=>{class ContactExchangeSyncButton{constructor(e,s,t,i,l,n,a,o){this.metadata=e,this.toast=s,this.language=t,this.model=i,this.modal=l,this.backend=n,this.configuration=a,this.userpreferences=o,this.isLoading=!1,this.hidden=!0,this.route="",this.subscriptions=new Z.yU,this.setHidden(),this.configuration.datachanged$.subscribe((e=>{"microsoftserviceuserconfig"==e&&this.setHidden()})),this.setRoute()}ngOnDestroy(){this.subscriptions.unsubscribe()}setHidden(){let e=this.configuration.getData("microsoftserviceuserconfig"),s=this.metadata.getModuleDefs("Contacts");"object"==typeof e?Object.keys(e).forEach((t=>{e[t].sysmodule_id==s.id&&(this.hidden=!1)})):this.hidden=!e||e&&-1==e?.findIndex((e=>e.sysmodule_id==s.id))}setRoute(){if(this.route="module/Contacts/"+this.model.id,"msgraph"===this.userpreferences.getPreference("microsoftActiveService"))this.route+="/msgraphsync";else this.route+="/exchangesync"}execute(){this.isLoading=!0,this.model.getField("sync_contact")?this.backend.deleteRequest(this.route).subscribe((e=>{this.model.setField("sync_contact",!this.model.getField("sync_contact")),this.isLoading=!1}),(e=>{this.isLoading=!1})):this.backend.putRequest(this.route).subscribe((e=>{e.message?this.toast.sendToast(e.message,"error"):this.model.setField("sync_contact",!this.model.getField("sync_contact")),this.isLoading=!1}),(e=>{this.isLoading=!1}))}get disabled(){return!(!this.isLoading&&!this.model.isLoading&&this.model.getField("email1")&&!this.model.isEditing)}get syncicon(){return this.model.getField("sync_contact")?"check":"add"}static#e=this.ɵfac=function(e){return new(e||ContactExchangeSyncButton)(d.rXU(g.yu),d.rXU(C.o),d.rXU(u.B),d.rXU(h.g),d.rXU(m.y),d.rXU(f.H),d.rXU(N.i),d.rXU(ee.S))};static#s=this.ɵcmp=d.VBU({type:ContactExchangeSyncButton,selectors:[["ng-component"]],decls:5,vars:2,consts:[[1,"slds-grid","slds-grid--vertical-align-center"],["size","xx-small",3,"icon",4,"ngIf"],["size","12",4,"ngIf"],[1,"slds-p-left--xx-small"],["label","LBL_OUTLOOK"],["size","xx-small",3,"icon"],["size","12"]],template:function(e,s){1&e&&(d.j41(0,"div",0),d.DNE(1,te,1,1,"system-utility-icon",1)(2,ie,1,0,"system-spinner",2),d.j41(3,"div",3),d.nrm(4,"system-label",4),d.k0s()()),2&e&&(d.R7$(),d.Y8G("ngIf",!s.isLoading),d.R7$(),d.Y8G("ngIf",s.isLoading))},dependencies:[i.bT,b.W,x.P,se.B],encapsulation:2})}return ContactExchangeSyncButton})(),ne=(()=>{class ModuleContacts{static#e=this.ɵfac=function(e){return new(e||ModuleContacts)};static#s=this.ɵmod=d.$C({type:ModuleContacts});static#t=this.ɵinj=d.G2t({imports:[i.MD,l.YN,a.ObjectFields,o.GlobalComponents,r.ObjectComponents,c.SystemComponents,n.h]})}return ModuleContacts})();("undefined"==typeof ngJitMode||ngJitMode)&&d.Obh(ne,{declarations:[p,w,P,K,le],imports:[i.MD,l.YN,a.ObjectFields,o.GlobalComponents,r.ObjectComponents,c.SystemComponents,n.h]})}}]);