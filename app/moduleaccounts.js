/*!
 * 
 *                     aacService
 *
 *                     release: 2022.02.001
 *
 *                     date: 2022-09-03 11:05:02
 *
 *                     build: 2022.02.001.1662195902704
 *
 */
"use strict";(self.webpackChunkcore=self.webpackChunkcore||[]).push([["src_modules_accounts_moduleaccounts_ts"],{5330:(t,e,s)=>{s.r(e),s.d(e,{ModuleAccounts:()=>te});var i=s(6895),n=s(433),a=s(4357),c=s(3121),o=s(3283),d=s(4518),l=s(5478),r=s(1571);let u=(()=>{class ACManagerService{constructor(){this.contactccdetails={},this.contactCCDetails$=new r.vpe}get contactCCDetails(){return this.contactccdetails}set contactCCDetails(t){this.contactccdetails=t,this.contactCCDetails$.emit(t)}}return ACManagerService.ɵfac=function(t){return new(t||ACManagerService)},ACManagerService.ɵprov=r.Yz7({token:ACManagerService,factory:ACManagerService.ɵfac}),ACManagerService})();var g=s(4505),m=s(5710),h=s(4154),f=s(5329),p=s(3463),b=s(4664);function C(t,e){if(1&t&&(r.TgZ(0,"th",8)(1,"div",15),r._uU(2),r.qZA()()),2&t){const t=e.$implicit;r.xp6(2),r.hij(" ",t," ")}}function v(t,e){if(1&t&&(r.TgZ(0,"td",21)(1,"div",22),r._uU(2),r.qZA()()),2&t){const t=e.$implicit,s=r.oxw().$implicit,i=r.oxw(2);r.xp6(2),r.hij(" ",i.getKPI(s.id,t)," ")}}function y(t,e){if(1&t&&(r.TgZ(0,"tr")(1,"th",16)(2,"div",17),r._uU(3),r.qZA()(),r.YNc(4,v,3,1,"td",18),r.TgZ(5,"th",19)(6,"div",20),r._uU(7,"EUR"),r.qZA()()()),2&t){const t=e.$implicit,s=r.oxw(2);r.xp6(3),r.hij(" ",t.companycode," "),r.xp6(1),r.Q6J("ngForOf",s.years)}}function x(t,e){if(1&t&&(r.TgZ(0,"div",4)(1,"div",5)(2,"table",6)(3,"thead")(4,"tr",7)(5,"th",8)(6,"div",9),r._UZ(7,"system-label",10),r.qZA()(),r.YNc(8,C,3,1,"th",11),r.TgZ(9,"th",8)(10,"div",12),r._UZ(11,"system-label",13),r.qZA()()()(),r.TgZ(12,"tbody"),r.YNc(13,y,8,2,"tr",14),r.qZA()()()()),2&t){const t=r.oxw();r.Q6J("ngStyle",t.tableContainerStyle),r.xp6(8),r.Q6J("ngForOf",t.years),r.xp6(5),r.Q6J("ngForOf",t.companyCodes)}}function A(t,e){1&t&&r._UZ(0,"system-spinner")}function T(t,e){1&t&&(r.TgZ(0,"div",23)(1,"span"),r._uU(2," No Company Codes found "),r.qZA()())}let Z=(()=>{class AccountsKPIsOverview{constructor(t,e,s,i,n){this.backend=t,this.model=e,this.metadata=s,this.language=i,this.renderer=n,this.years=[],this.limit=0,this.yearto=0,this.companyCodes=[],this.accountKpis={},this.isLoading=!1,this.getYears(),this.isLoading=!0,this.backend.getRequest(`module/AccountKPIs/${this.model.id}/getsummary`,{yearfrom:this.yearto-this.limit+1,yearto:this.yearto}).subscribe((t=>{this.accountKpis=t.accountkpis,this.companyCodes=t.companycodes,this.isLoading=!1}))}get tableContainerStyle(){return{border:"1px solid #dddbda","border-radius":".25rem",height:"417px"}}getYears(){let t=this.metadata.getComponentConfig("AccountsKPIsOverview","AccountKPIs");this.yearto=t&&t.yearto?+t.yearto:(new moment).get("year"),this.limit=t&&t.limit?+t.limit:4;for(let t=this.yearto-this.limit+1;t<=this.yearto;t++)this.years.push(t)}getKPI(t,e){try{return this.accountKpis[t][e]?this.accountKpis[t][e]:0}catch(t){return 0}}}return AccountsKPIsOverview.ɵfac=function(t){return new(t||AccountsKPIsOverview)(r.Y36(g.y),r.Y36(m.o),r.Y36(h.Pu),r.Y36(f.d),r.Y36(r.Qsj))},AccountsKPIsOverview.ɵcmp=r.Xpm({type:AccountsKPIsOverview,selectors:[["ng-component"]],decls:4,vars:3,consts:[[1,"slds-container--fluid","slds-m-vertical--small"],["class","slds-table--header-fixed_container",3,"ngStyle",4,"ngIf"],[4,"ngIf"],["class","slds-align_absolute-center slds-p-vertical--medium",4,"ngIf"],[1,"slds-table--header-fixed_container",3,"ngStyle"],[1,"slds-scrollable--y",2,"height","100%"],[1,"slds-table","slds-table_bordered","slds-table_header-fixed","slds-theme--default"],[1,"slds-text-title_caps"],["scope","col"],["title","companyCode",1,"slds-p-left--x-small","slds-truncate","slds-cell-fixed","slds-grid","slds-grid_vertical-align-center"],["label","LBL_COMPANYCODE"],["scope","col",4,"ngFor","ngForOf"],["title","currency",1,"slds-p-left--x-small","slds-truncate","slds-cell-fixed","slds-grid","slds-grid_vertical-align-center",2,"width","fit-content"],["label","LBL_CURRENCY"],[4,"ngFor","ngForOf"],["title","year",1,"slds-p-left--x-small","slds-truncate","slds-cell-fixed","slds-grid","slds-grid_vertical-align-center"],["scope","row",1,"slds-theme_shade","slds-text-title_caps"],["title","Company Code",1,"slds-truncate"],["scope","row",4,"ngFor","ngForOf"],["scope","row",1,"slds-theme_shade"],["title","EUR",1,"slds-truncate","slds-text-title_caps"],["scope","row"],["title","Revenue",1,"slds-truncate"],[1,"slds-align_absolute-center","slds-p-vertical--medium"]],template:function(t,e){1&t&&(r.TgZ(0,"div",0),r.YNc(1,x,14,3,"div",1),r.YNc(2,A,1,0,"system-spinner",2),r.YNc(3,T,3,0,"div",3),r.qZA()),2&t&&(r.xp6(1),r.Q6J("ngIf",e.companyCodes.length>0),r.xp6(1),r.Q6J("ngIf",e.isLoading),r.xp6(1),r.Q6J("ngIf",!e.isLoading&&0==e.companyCodes.length))},dependencies:[i.sg,i.O5,i.PC,p._,b.W],encapsulation:2}),AccountsKPIsOverview})();var I=s(2294);const F=["ccdetailscontainer"];let w=(()=>{class AccountCCDetailsTab{constructor(t,e,s){this.language=t,this.metadata=e,this.model=s,this.data=void 0,this.componentconfig={},this.ccode={},this.model.module="AccountCCDetails"}ngOnInit(){this.setModelData()}ngAfterViewInit(){this.renderView()}setModelData(){this.data?(this.model.id=this.data.id,this.model.setFields(this.model.utils.backendModel2spice(this.model.module,this.data))):(this.model.initialize(this.parent),this.model.setFields({name:this.ccode.name,companycode_id:this.ccode.id}),this.model.getField("account_id")||this.model.setFields({account_id:this.parent.id,account_name:this.parent.getField("name")}))}renderView(){_.isEmpty(this.componentconfig)&&(this.componentconfig=this.metadata.getComponentConfig("AccountCCDetails","AccountCCDetails"),_.isEmpty(this.componentconfig)&&(this.componentconfig=this.metadata.getComponentConfig("AccountCCDetailsTab","Accounts")));let t=this.componentconfig.componentset;if(t){let e=this.metadata.getComponentSetObjects(t);for(let t of e)this.metadata.addComponent(t.component,this.ccdetailscontainer).subscribe((e=>{e.instance.componentconfig=t.componentconfig}))}}}return AccountCCDetailsTab.ɵfac=function(t){return new(t||AccountCCDetailsTab)(r.Y36(f.d),r.Y36(h.Pu),r.Y36(m.o))},AccountCCDetailsTab.ɵcmp=r.Xpm({type:AccountCCDetailsTab,selectors:[["account-cc-details-tab"]],viewQuery:function(t,e){if(1&t&&r.Gf(F,7,r.s_b),2&t){let t;r.iGM(t=r.CRH())&&(e.ccdetailscontainer=t.first)}},inputs:{data:"data",componentconfig:"componentconfig",parent:"parent",ccode:"ccode"},features:[r._Bn([m.o])],decls:2,vars:0,consts:[["ccdetailscontainer",""]],template:function(t,e){1&t&&r._UZ(0,"div",null,0)},encapsulation:2}),AccountCCDetailsTab})();const D=function(t){return{"slds-active":t}};function Y(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"li",8),r.NdJ("click",(function(){const e=r.CHM(t).index,s=r.oxw(2);return r.KtG(s.setActiveTab(e))})),r.TgZ(1,"a",9),r._uU(2),r.qZA()()}if(2&t){const t=e.$implicit,s=e.index,i=r.oxw(2);r.Q6J("ngClass",r.VKq(2,D,s===i.activeTab)),r.xp6(2),r.hij(" ",t.companycode," ")}}function J(t,e){if(1&t&&(r.ynx(0),r.TgZ(1,"div",10),r._UZ(2,"account-cc-details-tab",11),r.qZA(),r.BQk()),2&t){const t=e.$implicit,s=e.index,i=r.oxw(2);r.xp6(1),r.Q6J("ngStyle",i.getContentContainerStyle(s)),r.xp6(1),r.Q6J("ccode",t)("parent",i.model)("data",i.getCCDetailsData(t))}}function O(t,e){if(1&t&&(r.TgZ(0,"div",4)(1,"ul",5),r.YNc(2,Y,3,4,"li",6),r.qZA(),r.YNc(3,J,3,4,"ng-container",7),r.qZA()),2&t){const t=r.oxw();r.xp6(2),r.Q6J("ngForOf",t.companyCodes)("ngForTrackBy",t.trackByFn),r.xp6(1),r.Q6J("ngForOf",t.companyCodes)("ngForTrackBy",t.trackByFn)}}function Q(t,e){1&t&&r._UZ(0,"system-spinner")}function M(t,e){1&t&&(r.TgZ(0,"div",12),r._UZ(1,"system-label",13),r.qZA())}let N=(()=>{class AccountCCDetails{constructor(t,e,s,i){this.language=t,this.model=e,this.backend=s,this.view=i,this.companyCodes=[],this.activatedTabs=[],this.activeTab=0,this.isLoading=!1,this.loadCompanyCodes()}ngOnInit(){this.view.isEditable=!0}loadCompanyCodes(){this.isLoading=!0;let t=JSON.stringify(["companycode","date_modified","description","id"]);this.backend.getRequest("module/CompanyCodes",{fields:t}).subscribe((t=>{this.companyCodes=t.list})),this.isLoading=!1}setActiveTab(t){this.activatedTabs.push(t),this.activeTab=t}getCCDetailsData(t){let e=this.model.data.accountccdetails.beans;for(let s in e)if(e.hasOwnProperty(s)&&e[s].companycode_id==t.id)return e[s]}getContentContainerStyle(t){return{display:t!==this.activeTab?"none":"block",padding:".25rem"}}trackByFn(t,e){return t}}return AccountCCDetails.ɵfac=function(t){return new(t||AccountCCDetails)(r.Y36(f.d),r.Y36(m.o),r.Y36(g.y),r.Y36(I.e))},AccountCCDetails.ɵcmp=r.Xpm({type:AccountCCDetails,selectors:[["ng-component"]],decls:4,vars:3,consts:[[1,"slds-grid","slds-m-top--x-small","slds-p-around--xxx-small",2,"border-radius",".25rem","border","1px solid #dddbda"],["class","slds-tabs--default",4,"ngIf"],[4,"ngIf"],["class","slds-align_absolute-center slds-p-around--small",4,"ngIf"],[1,"slds-tabs--default"],["role","tablist",1,"slds-tabs--default__nav"],["class","slds-tabs--default__item slds-text-title--caps","role","presentation",3,"ngClass","click",4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngFor","ngForOf","ngForTrackBy"],["role","presentation",1,"slds-tabs--default__item","slds-text-title--caps",3,"ngClass","click"],["href","javascript:void(0);","role","tab","aria-selected","false",1,"slds-tabs--default__link"],["role","tabpanel",1,"slds-tabs--default__content","slds-p-around--xx-small","slds-show",3,"ngStyle"],[3,"ccode","parent","data"],[1,"slds-align_absolute-center","slds-p-around--small"],["label","LBL_NO_ENTRIES"]],template:function(t,e){1&t&&(r.TgZ(0,"div",0),r.YNc(1,O,4,4,"div",1),r.YNc(2,Q,1,0,"system-spinner",2),r.YNc(3,M,2,0,"div",3),r.qZA()),2&t&&(r.xp6(1),r.Q6J("ngIf",!e.isLoading&&e.companyCodes.length>0),r.xp6(1),r.Q6J("ngIf",e.isLoading),r.xp6(1),r.Q6J("ngIf",!e.isLoading&&0==e.companyCodes.length))},dependencies:[i.mk,i.sg,i.O5,i.PC,p._,b.W,w],encapsulation:2}),AccountCCDetails})();var k=s(6951);let q=(()=>{class AccountTerritoryDetailsTab{constructor(t,e,s,i){this.language=t,this.metadata=e,this.parent=s,this.model=i,this.data=void 0,this.componentconfig={},this.model.module="AccountCCDetails"}ngOnInit(){this.setModelData()}ngAfterViewInit(){this.renderView()}setModelData(){this.data?(this.model.id=this.data.id,this.model.setFields(this.model.utils.backendModel2spice(this.model.module,this.data))):(this.model.initialize(this.parent),this.model.getField("account_id")||this.model.setFields({account_id:this.parent.id,account_name:this.parent.getField("name")}))}renderView(){_.isEmpty(this.componentconfig)&&(this.componentconfig=this.metadata.getComponentConfig("AccountTerritoryDetails","AccountCCDetails")),this.componentset=this.componentconfig.componentset}}return AccountTerritoryDetailsTab.ɵfac=function(t){return new(t||AccountTerritoryDetailsTab)(r.Y36(f.d),r.Y36(h.Pu),r.Y36(m.o,4),r.Y36(m.o))},AccountTerritoryDetailsTab.ɵcmp=r.Xpm({type:AccountTerritoryDetailsTab,selectors:[["account-territory-details-tab"]],inputs:{data:"data",componentconfig:"componentconfig"},features:[r._Bn([m.o])],decls:1,vars:1,consts:[[3,"componentset"]],template:function(t,e){1&t&&r._UZ(0,"system-componentset",0),2&t&&r.Q6J("componentset",e.componentset)},dependencies:[k.E],encapsulation:2}),AccountTerritoryDetailsTab})();const L=function(t){return{"slds-active":t}};function S(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"li",8),r.NdJ("click",(function(){const e=r.CHM(t).index,s=r.oxw(2);return r.KtG(s.setActiveTab(e))})),r.TgZ(1,"a",9),r._uU(2),r.qZA()()}if(2&t){const t=e.$implicit,s=e.index,i=r.oxw(2);r.Q6J("ngClass",r.VKq(2,L,s===i.activeTab)),r.xp6(2),r.hij(" ",t.name," ")}}const H=function(t){return{"slds-hide":t}};function U(t,e){if(1&t&&(r.ynx(0),r.TgZ(1,"div",10),r._UZ(2,"account-territory-details-tab",11),r.qZA(),r.BQk()),2&t){const t=e.$implicit,s=e.index,i=r.oxw(2);r.xp6(1),r.Q6J("ngClass",r.VKq(2,H,s!=i.activeTab)),r.xp6(1),r.Q6J("data",t)}}function B(t,e){if(1&t&&(r.TgZ(0,"div",4)(1,"ul",5),r.YNc(2,S,3,4,"li",6),r.qZA(),r.YNc(3,U,3,4,"ng-container",7),r.qZA()),2&t){const t=r.oxw();r.xp6(2),r.Q6J("ngForOf",t.getCCDetails())("ngForTrackBy",t.trackByFn),r.xp6(1),r.Q6J("ngForOf",t.getCCDetails())("ngForTrackBy",t.trackByFn)}}function E(t,e){1&t&&r._UZ(0,"system-spinner")}function $(t,e){1&t&&(r.TgZ(0,"div",12),r._UZ(1,"system-label",13),r.qZA())}let V=(()=>{class AccountTerritoryDetails{constructor(t,e,s,i){this.language=t,this.model=e,this.backend=s,this.view=i,this.companyCodes=[],this.activatedTabs=[],this.activeTab=0,this.isLoading=!1}ngOnInit(){this.view.isEditable=!0}setActiveTab(t){this.activatedTabs.push(t),this.activeTab=t}getCCDetails(){return this.model.data?.accountccdetails?.beans?_.toArray(this.model.data.accountccdetails.beans):[]}getCCDetailsData(t){let e=this.model.data.accountccdetails.beans;for(let s in e)if(e.hasOwnProperty(s)&&e[s].companycode_id==t.id)return e[s]}trackByFn(t,e){return t}}return AccountTerritoryDetails.ɵfac=function(t){return new(t||AccountTerritoryDetails)(r.Y36(f.d),r.Y36(m.o),r.Y36(g.y),r.Y36(I.e))},AccountTerritoryDetails.ɵcmp=r.Xpm({type:AccountTerritoryDetails,selectors:[["ng-component"]],decls:4,vars:3,consts:[[1,"slds-grid","slds-m-top--x-small","slds-p-around--xxx-small",2,"border-radius",".25rem","border","1px solid #dddbda"],["class","slds-tabs--default",4,"ngIf"],[4,"ngIf"],["class","slds-align_absolute-center slds-p-around--small",4,"ngIf"],[1,"slds-tabs--default"],["role","tablist",1,"slds-tabs--default__nav"],["class","slds-tabs--default__item slds-text-title--caps","role","presentation",3,"ngClass","click",4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngFor","ngForOf","ngForTrackBy"],["role","presentation",1,"slds-tabs--default__item","slds-text-title--caps",3,"ngClass","click"],["href","javascript:void(0);","role","tab","aria-selected","false",1,"slds-tabs--default__link"],["role","tabpanel",1,"slds-tabs--default__content","slds-p-around--xx-small","slds-show",3,"ngClass"],[3,"data"],[1,"slds-align_absolute-center","slds-p-around--small"],["label","LBL_NO_ENTRIES"]],template:function(t,e){1&t&&(r.TgZ(0,"div",0),r.YNc(1,B,4,4,"div",1),r.YNc(2,E,1,0,"system-spinner",2),r.YNc(3,$,2,0,"div",3),r.qZA()),2&t&&(r.xp6(1),r.Q6J("ngIf",e.getCCDetails().length>0),r.xp6(1),r.Q6J("ngIf",e.isLoading),r.xp6(1),r.Q6J("ngIf",0==e.getCCDetails().length))},dependencies:[i.mk,i.sg,i.O5,p._,b.W,q],encapsulation:2}),AccountTerritoryDetails})();const K=["ccdetailscontainer"];let P=(()=>{class ContactCCDetailsTab{constructor(t,e,s){this.language=t,this.metadata=e,this.model=s,this.data=void 0,this.contactId=void 0,this.ccId=void 0,this.ccName=void 0}ngOnChanges(){this.setModelData()}ngOnInit(){this.model.module="ContactCCDetails"}ngAfterViewInit(){this.renderView()}renderView(){let t=this.metadata.getComponentConfig("ContactCCDetailsTab","Accounts").componentset;if(t){let e=this.metadata.getComponentSetObjects(t);for(let t of e)this.metadata.addComponent(t.component,this.ccdetailscontainer).subscribe((e=>{e.instance.componentconfig=t.componentconfig}))}}setModelData(){this.data?(this.model.id=this.data.id,this.model.setData(this.data)):(this.model.id=this.model.generateGuid(),this.model.setData({id:this.model.id,name:this.ccName,contact_id:this.contactId,companycode_id:this.ccId,date_entered:new moment,date_modified:new moment},!1))}}return ContactCCDetailsTab.ɵfac=function(t){return new(t||ContactCCDetailsTab)(r.Y36(f.d),r.Y36(h.Pu),r.Y36(m.o))},ContactCCDetailsTab.ɵcmp=r.Xpm({type:ContactCCDetailsTab,selectors:[["contact-cc-details-tab"]],viewQuery:function(t,e){if(1&t&&r.Gf(K,7,r.s_b),2&t){let t;r.iGM(t=r.CRH())&&(e.ccdetailscontainer=t.first)}},inputs:{data:"data",contactId:["contactid","contactId"],ccId:["ccid","ccId"],ccName:["ccname","ccName"]},features:[r._Bn([m.o]),r.TTD],decls:2,vars:0,consts:[["ccdetailscontainer",""]],template:function(t,e){1&t&&r._UZ(0,"div",null,0)},encapsulation:2}),ContactCCDetailsTab})();const j=function(t){return{"slds-active":t}};function G(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"li",8),r.NdJ("click",(function(){const e=r.CHM(t).index,s=r.oxw(2);return r.KtG(s.setActiveTab(e))})),r.TgZ(1,"a",9),r._uU(2),r.qZA()()}if(2&t){const t=e.$implicit,s=e.index,i=r.oxw(2);r.Q6J("ngClass",r.VKq(2,j,s===i.activeTab)),r.xp6(2),r.hij(" ",t.companycode," ")}}function R(t,e){if(1&t&&(r.ynx(0),r.TgZ(1,"div",10),r._UZ(2,"contact-cc-details-tab",11),r.qZA(),r.BQk()),2&t){const t=e.$implicit,s=e.index,i=r.oxw(2);r.xp6(1),r.Q6J("ngStyle",i.getContentContainerStyle(s)),r.xp6(1),r.Q6J("ccid",t.id)("ccname",t.companycode)("contactid",i.model.id)("data",i.getCCDetailsData(t))}}function X(t,e){if(1&t&&(r.TgZ(0,"div",4)(1,"ul",5),r.YNc(2,G,3,4,"li",6),r.qZA(),r.YNc(3,R,3,5,"ng-container",7),r.qZA()),2&t){const t=r.oxw();r.xp6(2),r.Q6J("ngForOf",t.companyCodes)("ngForTrackBy",t.trackByFn),r.xp6(1),r.Q6J("ngForOf",t.companyCodes)("ngForTrackBy",t.trackByFn)}}function z(t,e){1&t&&r._UZ(0,"system-spinner")}function W(t,e){1&t&&(r.TgZ(0,"div",12),r._UZ(1,"system-label",13),r.qZA())}let tt=(()=>{class ContactCCDetails{constructor(t,e,s,i,n){this.language=t,this.model=e,this.acmService=s,this.backend=i,this.view=n,this.activatedTabs=[],this.companyCodes=[],this.activeTab=0,this.contactccdetails={},this.isLoading=!1,this.loadCompanyCode(),this.subscribeContactCCDetailsChanges()}get contactCCDetails(){return this.contactccdetails}set contactCCDetails(t){this.contactccdetails=t}ngOnInit(){this.view.isEditable=!0}ngOnDestroy(){this.accountsContactsManagerSubscriber.unsubscribe()}setActiveTab(t){this.activatedTabs.push(t),this.activeTab=t}getCCDetailsData(t){if(!_.isEmpty(this.contactCCDetails))for(let e in this.contactCCDetails)if(this.contactCCDetails[e].companycode_id==t.id)return this.contactCCDetails[e]}getContentContainerStyle(t){return{display:t!==this.activeTab?"none":"block",padding:".25rem"}}loadCompanyCode(){this.isLoading=!0;let t=JSON.stringify(["companycode","date_modified","description","id"]);this.backend.getRequest("module/CompanyCodes",{fields:t}).subscribe((t=>{this.companyCodes=t.list,this.isLoading=!1}))}subscribeContactCCDetailsChanges(){this.accountsContactsManagerSubscriber=this.acmService.contactCCDetails$.subscribe((t=>{this.activeTab=0,this.companyCodes=this.companyCodes.slice(),this.contactCCDetails=t}))}trackByFn(t,e){return t}}return ContactCCDetails.ɵfac=function(t){return new(t||ContactCCDetails)(r.Y36(f.d),r.Y36(m.o),r.Y36(u),r.Y36(g.y),r.Y36(I.e))},ContactCCDetails.ɵcmp=r.Xpm({type:ContactCCDetails,selectors:[["contact-cc-details"]],features:[r._Bn([I.e])],decls:4,vars:3,consts:[[1,"slds-grid","slds-m-top--x-small","slds-p-around--xxx-small",2,"border-radius",".25rem","border","1px solid #dddbda"],["class","slds-tabs--default",4,"ngIf"],[4,"ngIf"],["class","slds-align_absolute-center slds-p-around--small",4,"ngIf"],[1,"slds-tabs--default"],["role","tablist",1,"slds-tabs--default__nav"],["class","slds-tabs--default__item slds-text-title--caps","role","presentation",3,"ngClass","click",4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngFor","ngForOf","ngForTrackBy"],["role","presentation",1,"slds-tabs--default__item","slds-text-title--caps",3,"ngClass","click"],["href","javascript:void(0);","role","tab","aria-selected","false",1,"slds-tabs--default__link"],["role","tabpanel",1,"slds-tabs--default__content","slds-p-around--xx-small","slds-show",3,"ngStyle"],[3,"ccid","ccname","contactid","data"],[1,"slds-align_absolute-center","slds-p-around--small"],["label","LBL_NO_ENTRIES"]],template:function(t,e){1&t&&(r.TgZ(0,"div",0),r.YNc(1,X,4,4,"div",1),r.YNc(2,z,1,0,"system-spinner",2),r.YNc(3,W,2,0,"div",3),r.qZA()),2&t&&(r.xp6(1),r.Q6J("ngIf",!e.isLoading&&e.companyCodes.length>0),r.xp6(1),r.Q6J("ngIf",e.isLoading),r.xp6(1),r.Q6J("ngIf",!e.isLoading&&0==e.companyCodes.length))},dependencies:[i.mk,i.sg,i.O5,i.PC,p._,b.W,P],encapsulation:2}),ContactCCDetails})();var et=s(6040),st=s(8652);const it=["detailscontainer"];function nt(t,e){1&t&&(r.TgZ(0,"div",4)(1,"span"),r._UZ(2,"system-label",5),r.qZA()())}let at=(()=>{class AccountsContactsManagerDetails{constructor(t,e,s,i,n,a){this.language=t,this.metadata=e,this.view=s,this.acmService=i,this.relatedmodels=n,this.model=a,this.activeContactId=void 0,this.renderedComponents=[],this.model.module="Contacts"}ngAfterViewInit(){this.buildContainer()}ngOnChanges(){this.activeContactId&&(this.resetView(),this.buildContainer(),this.view.setViewMode(),this.model.id=this.activeContactId,this.model.getData(!0,"",!0).subscribe((t=>{_.isEmpty(t.contactccdetails.beans)?this.acmService.contactCCDetails={}:this.acmService.contactCCDetails=t.contactccdetails.beans})))}resetView(){for(let t of this.renderedComponents)t.destroy();this.renderedComponents=[]}buildContainer(){let t=this.metadata.getComponentConfig("AccountsContactsManager","Accounts").detailscomponentset;if(t){let e=this.metadata.getComponentSetObjects(t);for(let t of e)this.metadata.addComponent(t.component,this.detailscontainer).subscribe((e=>{this.renderedComponents.push(e),e.instance.componentconfig=t.componentconfig}))}}}return AccountsContactsManagerDetails.ɵfac=function(t){return new(t||AccountsContactsManagerDetails)(r.Y36(f.d),r.Y36(h.Pu),r.Y36(I.e),r.Y36(u),r.Y36(et.j),r.Y36(m.o))},AccountsContactsManagerDetails.ɵcmp=r.Xpm({type:AccountsContactsManagerDetails,selectors:[["accounts-contacts-manager-details"]],viewQuery:function(t,e){if(1&t&&r.Gf(it,7,r.s_b),2&t){let t;r.iGM(t=r.CRH())&&(e.detailscontainer=t.first)}},inputs:{activeContactId:["activecontactid","activeContactId"]},features:[r._Bn([m.o,I.e]),r.TTD],decls:5,vars:2,consts:[[1,"slds-scrollable--y","slds-p-around--x-small"],["class","slds-text-align_center slds-p-vertical--medium",4,"ngIf"],[3,"hidden"],["detailscontainer",""],[1,"slds-text-align_center","slds-p-vertical--medium"],["label","LBL_MAKE_SELECTION"]],template:function(t,e){1&t&&(r.TgZ(0,"div",0),r.YNc(1,nt,3,0,"div",1),r.TgZ(2,"div",2),r._UZ(3,"div",null,3),r.qZA()()),2&t&&(r.xp6(1),r.Q6J("ngIf",!e.activeContactId),r.xp6(1),r.Q6J("hidden",!e.activeContactId))},dependencies:[i.O5,p._],encapsulation:2}),AccountsContactsManagerDetails})();var ct=s(6367),ot=s(3634),dt=s(7763);const lt=["tableContainer"];function rt(t,e){if(1&t&&(r.TgZ(0,"th",10)(1,"div",11),r._UZ(2,"field-label",12),r.qZA()()),2&t){const t=e.$implicit;r.xp6(2),r.Q6J("fieldname",t.field)("fieldconfig",t.fieldconfig)}}function ut(t,e){if(1&t&&(r.TgZ(0,"td"),r._UZ(1,"field-container",15),r.qZA()),2&t){const t=e.$implicit;r.xp6(1),r.Q6J("fieldname",t.field)("fieldconfig",t.fieldconfig)}}const gt=function(t){return{module:"Contacts",data:t}},mt=function(t){return{"slds-theme_shade":t}},ht=function(t,e){return{"border-bottom":t,"font-weight":e}};function ft(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"tr",13),r.NdJ("click",(function(){const e=r.CHM(t).$implicit,s=r.oxw(2);return r.KtG(s.setActiveContactId(e.id))}))("mouseover",(function(){const e=r.CHM(t).$implicit,s=r.oxw(2);return r.KtG(s.hovered=e.id)}))("mouseout",(function(){r.CHM(t);const e=r.oxw(2);return r.KtG(e.hovered="")})),r.YNc(1,ut,2,2,"td",14),r.qZA()}if(2&t){const t=e.$implicit,s=r.oxw(2);r.Q6J("system-model-provider",r.VKq(4,gt,t))("ngClass",r.VKq(6,mt,s.activeContactId==t.id))("ngStyle",r.WLB(8,ht,s.hovered==t.id?"1px solid darkred":"",s.activeContactId==t.id?"700":"")),r.xp6(1),r.Q6J("ngForOf",s.listfields)}}function pt(t,e){if(1&t&&(r.TgZ(0,"div",3,4)(2,"div",5)(3,"table",6)(4,"thead")(5,"tr",7),r.YNc(6,rt,3,2,"th",8),r.qZA()(),r.TgZ(7,"tbody"),r.YNc(8,ft,2,11,"tr",9),r.qZA()()()()),2&t){const t=r.oxw();r.Q6J("ngStyle",t.tableHeight),r.xp6(6),r.Q6J("ngForOf",t.listfields),r.xp6(2),r.Q6J("ngForOf",t.contacts)}}function bt(t,e){1&t&&r._UZ(0,"system-spinner")}function Ct(t,e){1&t&&(r.TgZ(0,"div",16)(1,"span"),r._UZ(2,"system-label",17),r.qZA()())}let vt=(()=>{class AccountsContactsManagerList{constructor(t,e,s,i){this.language=t,this.metadata=e,this.relatedmodels=s,this.model=i,this.listfields=[],this.hovered="",this.fieldset="",this.tableheight={},this.activeContactId$=new r.vpe,this.activeContactId=void 0,this.model.module="Contacts"}ngOnInit(){let t=this.metadata.getComponentConfig("AccountsContactsManager","Accounts");this.listfields=this.metadata.getFieldSetFields(t.listfieldset)}setActiveContactId(t){this.activeContactId=t,this.activeContactId$.emit(t)}get contacts(){return this.relatedmodels.items}get tableHeight(){return this.tableheight}get isloading(){return this.relatedmodels.isloading}}return AccountsContactsManagerList.ɵfac=function(t){return new(t||AccountsContactsManagerList)(r.Y36(f.d),r.Y36(h.Pu),r.Y36(et.j),r.Y36(m.o))},AccountsContactsManagerList.ɵcmp=r.Xpm({type:AccountsContactsManagerList,selectors:[["accounts-contacts-manager-list"]],viewQuery:function(t,e){if(1&t&&r.Gf(lt,7,r.s_b),2&t){let t;r.iGM(t=r.CRH())&&(e.tableContainer=t.first)}},inputs:{fieldset:"fieldset",tableheight:["tableHeight","tableheight"]},outputs:{activeContactId$:"activeContactId$"},features:[r._Bn([I.e,m.o])],decls:3,vars:3,consts:[["class","slds-table--header-fixed_container",3,"ngStyle",4,"ngIf"],[4,"ngIf"],["class","slds-text-align_center slds-p-vertical--medium",4,"ngIf"],[1,"slds-table--header-fixed_container",3,"ngStyle"],["tableContainer",""],[1,"slds-scrollable--y",2,"height","100%"],[1,"slds-table","slds-table_bordered","slds-table_cell-buffer","slds-table_header-fixed",2,"border-top","0"],[1,"slds-text-title_caps"],["scope","col",4,"ngFor","ngForOf"],["style","cursor: pointer",3,"system-model-provider","ngClass","ngStyle","click","mouseover","mouseout",4,"ngFor","ngForOf"],["scope","col"],[1,"slds-truncate","slds-cell-fixed","slds-grid","slds-grid_vertical-align-center"],[3,"fieldname","fieldconfig"],[2,"cursor","pointer",3,"system-model-provider","ngClass","ngStyle","click","mouseover","mouseout"],[4,"ngFor","ngForOf"],["fielddisplayclass","slds-truncate",3,"fieldname","fieldconfig"],[1,"slds-text-align_center","slds-p-vertical--medium"],["label","LBL_NO_ENTRIES"]],template:function(t,e){1&t&&(r.YNc(0,pt,9,3,"div",0),r.YNc(1,bt,1,0,"system-spinner",1),r.YNc(2,Ct,3,0,"div",2)),2&t&&(r.Q6J("ngIf",!e.isloading&&(null==e.contacts?null:e.contacts.length)>0),r.xp6(1),r.Q6J("ngIf",e.isloading),r.xp6(1),r.Q6J("ngIf",!e.isloading&&0==(null==e.contacts?null:e.contacts.length)))},dependencies:[i.mk,i.sg,i.O5,i.PC,ct.q,ot.j,p._,b.W,dt.u],encapsulation:2}),AccountsContactsManagerList})();const yt=function(){return{object:"Contacts"}};let xt=(()=>{class AccountsContactsManager{constructor(t,e,s,i,n){this.language=t,this.metadata=e,this.relatedmodels=s,this.acmService=i,this.model=n,this.editcomponentset="",this.module="",this.displayitems=5,this.activeContactId=void 0,this.relatedmodels.module=this.model.module,this.relatedmodels.id=this.model.id}setActiveContactId(t){this.activeContactId=t}get childrenHeight(){return{height:"340px"}}get mainStyle(){return{height:"350pxpx","border-radius":".25rem",border:"1px solid #dddbda"}}ngAfterViewInit(){this.loadRelated()}loadRelated(){this.relatedmodels.relatedModule="Contacts",this.relatedmodels.getData()}ngOnDestroy(){this.relatedmodels.stopSubscriptions()}aclAccess(){return this.metadata.checkModuleAcl(this.module,"list")}}return AccountsContactsManager.ɵfac=function(t){return new(t||AccountsContactsManager)(r.Y36(f.d),r.Y36(h.Pu),r.Y36(et.j),r.Y36(u),r.Y36(m.o))},AccountsContactsManager.ɵcmp=r.Xpm({type:AccountsContactsManager,selectors:[["accounts-contacts-manager"]],features:[r._Bn([et.j,u])],decls:6,vars:5,consts:[[3,"componentconfig"],[1,"slds-grid","slds-border--top",2,"height","350px"],[1,"slds-size--1-of-3","slds-border--right","slds-p-around--xxx-small"],[3,"tableHeight","activeContactId$"],[1,"slds-size--2-of-3",3,"ngStyle"],[3,"activecontactid"]],template:function(t,e){1&t&&(r.TgZ(0,"object-related-card",0)(1,"div",1)(2,"div",2)(3,"accounts-contacts-manager-list",3),r.NdJ("activeContactId$",(function(t){return e.setActiveContactId(t)})),r.qZA()(),r.TgZ(4,"div",4),r._UZ(5,"accounts-contacts-manager-details",5),r.qZA()()()),2&t&&(r.Q6J("componentconfig",r.DdM(4,yt)),r.xp6(3),r.Q6J("tableHeight",e.childrenHeight),r.xp6(1),r.Q6J("ngStyle",e.childrenHeight),r.xp6(1),r.Q6J("activecontactid",e.activeContactId))},dependencies:[i.PC,st.E,at,vt],encapsulation:2}),AccountsContactsManager})();var _t=s(7579);let At=(()=>{class accountHierarchy{constructor(t){this.backend=t,this.parentId="",this.requestedFields=[],this.members=[],this.membersList=[]}loadHierachy(t=this.parentId,e=!1){let s=new _t.x,i=[];for(let t of this.requestedFields)i.push(t.field);return this.backend.getRequest(`module/Accounts/${t}/hierarchy/${JSON.stringify(i)}`).subscribe((i=>{for(let e of i)this.members.push({parent_id:t,id:e.id,member_count:e.member_count,expanded:!1,loaded:!1,summary_text:e.summary_text,data:e.data});this.members.some((s=>{if(s.id===t)return s.loaded=!0,e&&(s.expanded=!0),!0})),this.rebuildMembersList(),s.next(!0),s.complete()})),s.asObservable()}expand(t){this.members.some((e=>{if(e.id===t)return e.loaded?e.expanded=!0:this.loadHierachy(t,!0),!0})),this.rebuildMembersList()}collapse(t){this.members.some((e=>{if(e.id===t)return e.expanded=!1,!0})),this.rebuildMembersList()}rebuildMembersList(){this.membersList=[],this.buildMembersList()}buildMembersList(t=this.parentId,e=0){for(let s of this.members)s.parent_id==t&&(this.membersList.push({level:e+1,id:s.id,member_count:parseInt(s.member_count,10),summary_text:s.summary_text,data:s.data,expanded:s.expanded}),s.expanded&&this.buildMembersList(s.id,e+1))}}return accountHierarchy.ɵfac=function(t){return new(t||accountHierarchy)(r.LFG(g.y))},accountHierarchy.ɵprov=r.Yz7({token:accountHierarchy,factory:accountHierarchy.ɵfac}),accountHierarchy})();var Tt=s(4561),Zt=s(7674),It=s(2161),Ft=s(2656);const wt=["account-hierarchy-node",""];function Dt(t,e){if(1&t&&r._UZ(0,"system-button-icon",8),2&t){const t=r.oxw(3);r.Q6J("icon",t.getIcon())}}function Yt(t,e){1&t&&r._UZ(0,"system-button-icon",8),2&t&&r.Q6J("icon","spinner")}function Jt(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"td",3)(1,"button",4),r.NdJ("click",(function(){r.CHM(t);const e=r.oxw(2);return r.KtG(e.expandNode())})),r.YNc(2,Dt,1,1,"system-button-icon",5),r.YNc(3,Yt,1,1,"system-button-icon",5),r.qZA(),r.TgZ(4,"div",6),r._UZ(5,"field-container",7),r.qZA()()}if(2&t){const t=r.oxw().$implicit,e=r.oxw();r.xp6(1),r.Q6J("disabled",0===e.nodedata.member_count),r.xp6(1),r.Q6J("ngIf",!e.loading),r.xp6(1),r.Q6J("ngIf",e.loading),r.xp6(2),r.Q6J("field",t.field)("fieldconfig",t.fieldconfig)("fielddisplayclass","slds-truncate")}}function Ot(t,e){if(1&t&&(r.TgZ(0,"td")(1,"div",6),r._UZ(2,"field-container",7),r.qZA()()),2&t){const t=r.oxw().$implicit;r.xp6(2),r.Q6J("field",t.field)("fieldconfig",t.fieldconfig)("fielddisplayclass","slds-truncate")}}function Qt(t,e){if(1&t&&(r.ynx(0),r.YNc(1,Jt,6,6,"td",1),r.YNc(2,Ot,3,3,"td",2),r.BQk()),2&t){const t=e.index;r.xp6(1),r.Q6J("ngIf",0===t),r.xp6(1),r.Q6J("ngIf",t>0)}}let Mt=(()=>{class AccountHierarchyNode{constructor(t,e,s,i,n){this.view=t,this.language=e,this.metadata=s,this.accountHierarchy=i,this.model=n,this.nodedata={},this.fields=[],this.loading=!1,this.view.displayLabels=!1}ngOnInit(){this.model.module="Accounts",this.model.id=this.nodedata.id,this.model.setData(this.nodedata.data)}expandNode(){this.nodedata.expanded?this.accountHierarchy.collapse(this.nodedata.id):(this.loading=!0,this.accountHierarchy.expand(this.nodedata.id))}getIcon(){switch(this.nodedata.expanded){case!1:return"chevronright";case!0:return"chevrondown"}}}return AccountHierarchyNode.ɵfac=function(t){return new(t||AccountHierarchyNode)(r.Y36(I.e),r.Y36(f.d),r.Y36(h.Pu),r.Y36(At),r.Y36(m.o))},AccountHierarchyNode.ɵcmp=r.Xpm({type:AccountHierarchyNode,selectors:[["","account-hierarchy-node",""]],hostVars:1,hostBindings:function(t,e){2&t&&r.uIk("aria-level",e.nodedata.level)},inputs:{nodedata:"nodedata",fields:"fields"},features:[r._Bn([m.o,I.e])],attrs:wt,decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],["scope","row","class","slds-tree__item",4,"ngIf"],[4,"ngIf"],["scope","row",1,"slds-tree__item"],[1,"slds-button","slds-button--icon","slds-button--icon-x-small","slds-m-right--x-small",3,"disabled","click"],[3,"icon",4,"ngIf"],[1,"slds-truncate"],[3,"field","fieldconfig","fielddisplayclass"],[3,"icon"]],template:function(t,e){1&t&&r.YNc(0,Qt,3,2,"ng-container",0),2&t&&r.Q6J("ngForOf",e.fields)},dependencies:[i.sg,i.O5,ot.j,Ft.J],encapsulation:2}),AccountHierarchyNode})();function Nt(t,e){if(1&t&&(r.TgZ(0,"th",14)(1,"div",15),r._UZ(2,"system-label-fieldname",16),r.qZA()()),2&t){const t=e.$implicit;r.xp6(2),r.Q6J("field",t.field)}}function kt(t,e){if(1&t&&r._UZ(0,"tr",17),2&t){const t=e.$implicit,s=r.oxw();r.Q6J("nodedata",t)("fields",s.fieldsetFields)}}function qt(t,e){if(1&t&&r._UZ(0,"tbody",18),2&t){const t=r.oxw();r.Q6J("columns",t.fieldsetFields.length)("rows",5)}}let Lt=(()=>{class AccountHierarchy{constructor(t,e,s,i){this.language=t,this.metadata=e,this.accountHierarchy=s,this.model=i,this.componentconfig={},this.fieldsetFields=[],this.loading=!1}loadHierarchy(){return this.accountHierarchy.parentId=this.model.id,this.accountHierarchy.requestedFields=this.fieldsetFields,this.accountHierarchy.loadHierachy()}ngOnInit(){this.fieldsetFields=this.metadata.getFieldSetFields(this.componentconfig.fieldset),this.loading=!0,this.loadHierarchy().subscribe((t=>{this.loading=!1}))}}return AccountHierarchy.ɵfac=function(t){return new(t||AccountHierarchy)(r.Y36(f.d),r.Y36(h.Pu),r.Y36(At),r.Y36(m.o))},AccountHierarchy.ɵcmp=r.Xpm({type:AccountHierarchy,selectors:[["account-hierarchy"]],features:[r._Bn([At])],decls:17,vars:5,consts:[[1,"slds-card","slds-card_boundary","slds-m-bottom--medium"],[1,"slds-card__header","slds-grid"],[1,"slds-media","slds-media--center","slds-has-flexi-truncate"],[3,"icon","size"],[1,"slds-media__body","slds-truncate"],["href","javascript:void(0);",1,"slds-text-link--reset"],[1,"slds-text-heading--small"],["label","LBL_SUBSIDIARIES"],[1,"slds-card__body"],["role","treegrid",1,"slds-table","slds-table--bordered","slds-tree","slds-table--tree"],[1,"slds-text-title--caps"],["class","slds-cell-buffer--left","scope","col",4,"ngFor","ngForOf"],["account-hierarchy-node","","class","slds-hint-parent","role","row","aria-expanded","true",3,"nodedata","fields",4,"ngFor","ngForOf"],["system-table-stencils","",3,"columns","rows",4,"ngIf"],["scope","col",1,"slds-cell-buffer--left"],[1,"slds-truncate"],["module","Accounts",3,"field"],["account-hierarchy-node","","role","row","aria-expanded","true",1,"slds-hint-parent",3,"nodedata","fields"],["system-table-stencils","",3,"columns","rows"]],template:function(t,e){1&t&&(r.TgZ(0,"article",0)(1,"div",1)(2,"header",2),r._UZ(3,"system-icon",3),r.TgZ(4,"div",4)(5,"h2")(6,"a",5)(7,"span",6),r._UZ(8,"system-label",7),r.qZA()()()()()(),r.TgZ(9,"div",8)(10,"table",9)(11,"thead")(12,"tr",10),r.YNc(13,Nt,3,1,"th",11),r.qZA()(),r.TgZ(14,"tbody"),r.YNc(15,kt,1,2,"tr",12),r.qZA(),r.YNc(16,qt,1,2,"tbody",13),r.qZA()()()),2&t&&(r.xp6(3),r.Q6J("icon","hierarchy")("size","small"),r.xp6(10),r.Q6J("ngForOf",e.fieldsetFields),r.xp6(2),r.Q6J("ngForOf",e.accountHierarchy.membersList),r.xp6(1),r.Q6J("ngIf",e.loading))},dependencies:[i.sg,i.O5,Tt.f,p._,Zt.h,It.x,Mt],encapsulation:2}),AccountHierarchy})();var St=s(7040),Ht=s(7774),Ut=s(3278),Bt=s(3208),Et=s(5638),$t=s(494);function Vt(t,e){if(1&t&&r._UZ(0,"field-label",3),2&t){const t=r.oxw();r.Q6J("fieldname",t.fieldname)("fieldconfig",t.fieldconfig)}}function Kt(t,e){if(1&t&&(r.TgZ(0,"field-generic-display",6),r._UZ(1,"div",7),r.TgZ(2,"div"),r._uU(3),r.qZA()()),2&t){const t=e.$implicit,s=r.oxw(2);r.Q6J("fielddisplayclass",s.fielddisplayclass)("fieldconfig",s.fieldconfig)("editable",s.isEditable()),r.xp6(1),r.Q6J("ngStyle",s.getColor(t.id)),r.xp6(2),r.AsE(" ",t.country,"",t.vat_id," ")}}function Pt(t,e){if(1&t&&(r.TgZ(0,"div",4),r.YNc(1,Kt,4,6,"field-generic-display",5),r.qZA()),2&t){const t=r.oxw();r.xp6(1),r.Q6J("ngForOf",t.getAccountVATIDs())}}function jt(t,e){if(1&t&&(r.TgZ(0,"option",28),r._uU(1),r.qZA()),2&t){const t=e.$implicit;r.Q6J("value",t.value),r.xp6(1),r.Oqu(t.display)}}function Gt(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"div",22)(1,"div",23)(2,"div",24)(3,"select",25,17),r.NdJ("ngModelChange",(function(e){r.CHM(t);const s=r.oxw().$implicit;return r.KtG(s.country=e)})),r.YNc(5,jt,2,2,"option",26),r.qZA()(),r._UZ(6,"field-messages",27),r.qZA()()}if(2&t){const t=r.oxw().$implicit,e=r.oxw(2);r.xp6(1),r.Q6J("ngClass",e.getFieldClass()),r.xp6(2),r.Q6J("ngModel",t.country),r.xp6(2),r.Q6J("ngForOf",e.options),r.xp6(1),r.Q6J("fieldname",e.fieldname)}}function Rt(t,e){if(1&t&&r._UZ(0,"system-tooltip",29),2&t){const t=r.oxw().$implicit,e=r.oxw(2);r.Q6J("tooltiptext",e.vatInfo(t.id))}}function Xt(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"div",12)(1,"button",13)(2,"system-button-icon",14),r.NdJ("click",(function(){const e=r.CHM(t).$implicit,s=r.oxw(2);return r.KtG(s.delete(e.id))})),r.qZA()(),r.YNc(3,Gt,7,4,"div",15),r.TgZ(4,"input",16,17),r.NdJ("ngModelChange",(function(e){const s=r.CHM(t).$implicit;return r.KtG(s.vat_id=e)})),r.qZA(),r.TgZ(6,"div",18),r.YNc(7,Rt,1,1,"system-tooltip",19),r.TgZ(8,"button",20),r.NdJ("click",(function(){const e=r.CHM(t).$implicit,s=r.oxw(2);return r.KtG(s.validate(e.country,e.vat_id,e.id))})),r._UZ(9,"system-label",21),r.qZA()()()}if(2&t){const t=e.$implicit,s=r.oxw(2);r.xp6(3),r.Q6J("ngIf",s.isEditMode()),r.xp6(1),r.Q6J("ngModel",t.vat_id),r.xp6(3),r.Q6J("ngIf",s.isvalid(t.id)),r.xp6(1),r.Q6J("disabled",!s.canCheck(t.vat_id))}}function zt(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"div"),r.YNc(1,Xt,10,4,"div",8),r.TgZ(2,"div",9)(3,"button",10)(4,"system-button-icon",11),r.NdJ("click",(function(){r.CHM(t);const e=r.oxw();return r.KtG(e.add())})),r.qZA()()()()}if(2&t){const t=r.oxw();r.xp6(1),r.Q6J("ngForOf",t.getAccountVATIDs())}}let Wt=(()=>{class AccountVATIDField extends St.O{constructor(t,e,s,i,n,a,c){super(t,e,s,i,n),this.model=t,this.view=e,this.language=s,this.metadata=i,this.router=n,this.backend=a,this.toast=c,this.isvalidating=!1,this.options=[],this.subscriptions.add(this.language.currentlanguage$.subscribe((t=>{this.getOptions()})))}get emptyVATIDS(){return this.getAccountVATIDs().length>0}ngOnInit(){this.getOptions(),this.model.getField("accountvatids")||this.model.initializeField("accountvatids",{beans:{},beans_relations_to_delete:{}}),this.getAccountVATIDs()}getOptions(){let t=[],e=this.language.getFieldDisplayOptions("AccountVATIDs","country");for(let s in e)t.push({value:s,display:e[s]});if(this.options=t,this.fieldconfig.sortdirection)switch(this.fieldconfig.sortdirection.toLowerCase()){case"desc":this.options.sort(((t,e)=>t.display.toLowerCase()<e.display.toLowerCase()?1:-1));break;case"asc":this.options.sort(((t,e)=>t.display.toLowerCase()>e.display.toLowerCase()?1:-1))}}getColor(t){let e="gray";switch(this.model.getField("accountvatids").beans[t].vatid_status){case"valid":e="green";break;case"not_valid":e="red"}return{"background-color":e}}getAccountVATIDs(){let t=[];if(this.model.getField("accountvatids")){let e=this.model.getField("accountvatids");for(let s in e.beans)1!=e.beans[s].deleted&&t.push(e.beans[s])}return t}validate(t,e,s){this.isvalidating=!0,this.backend.getRequest(`module/Account/${t+e}/vatids`).subscribe((t=>{"success"==t.status?!0!==t.data.valid?(this.toast.sendToast(this.language.getLabel("ERR_INVALID_VAT"),"error"),this.model.getField("accountvatids").beans[s].vatid_status="not_valid"):(this.model.getField("accountvatids").beans[s].verification_details=JSON.stringify(t.data),this.model.getField("accountvatids").beans[s].vatid_status="valid"):this.toast.sendToast(this.language.getLabel("ERR_CHECK_VAT"),"error"),this.isvalidating=!1}))}canCheck(t){return t.length>3}add(){let t=this.model.generateGuid();this.model.getField("accountvatids").beans[t]={id:t,account_id:this.model.id,account_name:this.model.displayname,vat_id:"",vatid_status:"",country:""},this.getAccountVATIDs()}delete(t){this.model.getField("accountvatids").beans[t].deleted=1,this.getAccountVATIDs()}isvalid(t){return"valid"==this.model.getField("accountvatids").beans[t].vatid_status}vatInfo(t){let e=JSON.parse(this.model.getField("accountvatids").beans[t].verification_details);return e.name+"\n"+e.address}}return AccountVATIDField.ɵfac=function(t){return new(t||AccountVATIDField)(r.Y36(m.o),r.Y36(I.e),r.Y36(f.d),r.Y36(h.Pu),r.Y36(Ht.F0),r.Y36(g.y),r.Y36(Ut.A))},AccountVATIDField.ɵcmp=r.Xpm({type:AccountVATIDField,selectors:[["account-vatid-field"]],features:[r.qOj],decls:3,vars:3,consts:[[3,"fieldname","fieldconfig",4,"ngIf"],["class","slds-p-vertical--small",4,"ngIf"],[4,"ngIf"],[3,"fieldname","fieldconfig"],[1,"slds-p-vertical--small"],[3,"fielddisplayclass","fieldconfig","editable",4,"ngFor","ngForOf"],[3,"fielddisplayclass","fieldconfig","editable"],[2,"float","left","width","10px","height","10px","border-radius","5px","margin-top","5px","margin-right","5px",3,"ngStyle"],["class","slds-grid slds-grid--vertical-align-center",4,"ngFor","ngForOf"],[1,"slds-grid","slds-align-content-center","slds-p-vertical--x-small","slds-border--top"],[1,"slds-button","slds-button--icon-small","slds-button--icon-border"],["icon","add",3,"click"],[1,"slds-grid","slds-grid--vertical-align-center"],[1,"slds-button","slds-button--icon-small","slds-button--icon-border","slds-m-right--x-small"],["icon","close",3,"click"],["class","slds-form-element slds-col slds-m-right--x-small",4,"ngIf"],["type","text",1,"slds-input",3,"ngModel","ngModelChange"],["focus",""],[1,"slds-col_bump-left","slds-grid","slds-grid--vertical-align-center"],["class","slds-m-left--x-small",3,"tooltiptext",4,"ngIf"],[1,"slds-button","slds-button--neutral","slds-m-left--x-small",3,"disabled","click"],["label","LBL_CHECK"],[1,"slds-form-element","slds-col","slds-m-right--x-small"],[1,"slds-form-element__control",3,"ngClass"],[1,"slds-select_container","slds-m-vertical--xx-small"],[1,"slds-select",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"fieldname"],[3,"value"],[1,"slds-m-left--x-small",3,"tooltiptext"]],template:function(t,e){1&t&&(r.YNc(0,Vt,1,2,"field-label",0),r.YNc(1,Pt,2,1,"div",1),r.YNc(2,zt,5,1,"div",2)),2&t&&(r.Q6J("ngIf",e.displayLabel),r.xp6(1),r.Q6J("ngIf",!e.isEditMode()),r.xp6(1),r.Q6J("ngIf",e.isEditMode()))},dependencies:[i.mk,i.sg,i.O5,i.PC,n.YN,n.Kr,n.Fj,n.EJ,n.JJ,n.On,ct.q,Bt.D,Et.a,Ft.J,p._,$t.S],encapsulation:2}),AccountVATIDField})(),te=(()=>{class ModuleAccounts{}return ModuleAccounts.ɵfac=function(t){return new(t||ModuleAccounts)},ModuleAccounts.ɵmod=r.oAB({type:ModuleAccounts}),ModuleAccounts.ɵinj=r.cJS({providers:[u],imports:[i.ez,n.u5,c.ObjectFields,o.GlobalComponents,d.ObjectComponents,l.SystemComponents,a.o]}),ModuleAccounts})();("undefined"==typeof ngJitMode||ngJitMode)&&r.kYT(te,{declarations:[Z,N,w,q,V,tt,P,xt,at,vt,Lt,Mt,Wt],imports:[i.ez,n.u5,c.ObjectFields,o.GlobalComponents,d.ObjectComponents,l.SystemComponents,a.o]})}}]);