/*!
 * 
 *                     aacService
 *
 *                     release: 2023.02.001
 *
 *                     date: 2023-08-15 08:39:15
 *
 *                     build: 2023.02.001.1692081555935
 *
 */
"use strict";(self.webpackChunkcore=self.webpackChunkcore||[]).push([["src_modules_accounts_moduleaccounts_ts"],{6035:(t,e,s)=>{s.r(e),s.d(e,{ModuleAccounts:()=>de});var i=s(1180),n=s(4755),a=s(5030),o=s(4357),c=s(3190),d=s(4826),l=s(6490),r=s(3735),u=s(2242);let g=(()=>{var t;class ACManagerService{constructor(){(0,i.Z)(this,"contactccdetails",{}),(0,i.Z)(this,"contactCCDetails$",new u.vpe)}get contactCCDetails(){return this.contactccdetails}set contactCCDetails(t){this.contactccdetails=t,this.contactCCDetails$.emit(t)}}return t=ACManagerService,(0,i.Z)(ACManagerService,"ɵfac",(function(e){return new(e||t)})),(0,i.Z)(ACManagerService,"ɵprov",u.Yz7({token:t,factory:t.ɵfac})),ACManagerService})();var h=s(4505),m=s(5710),p=s(4154),f=s(5329),v=s(3463),b=s(4664);function C(t,e){if(1&t&&(u.TgZ(0,"th",8)(1,"div",15),u._uU(2),u.qZA()()),2&t){const t=e.$implicit;u.xp6(2),u.hij(" ",t," ")}}function Z(t,e){if(1&t&&(u.TgZ(0,"td",21)(1,"div",22),u._uU(2),u.qZA()()),2&t){const t=e.$implicit,s=u.oxw().$implicit,i=u.oxw(2);u.xp6(2),u.hij(" ",i.getKPI(s.id,t)," ")}}function y(t,e){if(1&t&&(u.TgZ(0,"tr")(1,"th",16)(2,"div",17),u._uU(3),u.qZA()(),u.YNc(4,Z,3,1,"td",18),u.TgZ(5,"th",19)(6,"div",20),u._uU(7,"EUR"),u.qZA()()()),2&t){const t=e.$implicit,s=u.oxw(2);u.xp6(3),u.hij(" ",t.companycode," "),u.xp6(1),u.Q6J("ngForOf",s.years)}}function x(t,e){if(1&t&&(u.TgZ(0,"div",4)(1,"div",5)(2,"table",6)(3,"thead")(4,"tr",7)(5,"th",8)(6,"div",9),u._UZ(7,"system-label",10),u.qZA()(),u.YNc(8,C,3,1,"th",11),u.TgZ(9,"th",8)(10,"div",12),u._UZ(11,"system-label",13),u.qZA()()()(),u.TgZ(12,"tbody"),u.YNc(13,y,8,2,"tr",14),u.qZA()()()()),2&t){const t=u.oxw();u.Q6J("ngStyle",t.tableContainerStyle),u.xp6(8),u.Q6J("ngForOf",t.years),u.xp6(5),u.Q6J("ngForOf",t.companyCodes)}}function A(t,e){1&t&&u._UZ(0,"system-spinner")}function T(t,e){1&t&&(u.TgZ(0,"div",23)(1,"span"),u._uU(2," No Company Codes found "),u.qZA()())}let I=(()=>{var t;class AccountsKPIsOverview{constructor(t,e,s,n,a){(0,i.Z)(this,"backend",void 0),(0,i.Z)(this,"model",void 0),(0,i.Z)(this,"metadata",void 0),(0,i.Z)(this,"language",void 0),(0,i.Z)(this,"renderer",void 0),(0,i.Z)(this,"years",[]),(0,i.Z)(this,"limit",0),(0,i.Z)(this,"yearto",0),(0,i.Z)(this,"companyCodes",[]),(0,i.Z)(this,"accountKpis",{}),(0,i.Z)(this,"isLoading",!1),this.backend=t,this.model=e,this.metadata=s,this.language=n,this.renderer=a,this.getYears(),this.isLoading=!0,this.backend.getRequest(`module/AccountKPIs/${this.model.id}/getsummary`,{yearfrom:this.yearto-this.limit+1,yearto:this.yearto}).subscribe((t=>{this.accountKpis=t.accountkpis,this.companyCodes=t.companycodes,this.isLoading=!1}))}get tableContainerStyle(){return{border:"1px solid #dddbda","border-radius":".25rem",height:"417px"}}getYears(){let t=this.metadata.getComponentConfig("AccountsKPIsOverview","AccountKPIs");this.yearto=t&&t.yearto?+t.yearto:(new moment).get("year"),this.limit=t&&t.limit?+t.limit:4;for(let t=this.yearto-this.limit+1;t<=this.yearto;t++)this.years.push(t)}getKPI(t,e){try{return this.accountKpis[t][e]?this.accountKpis[t][e]:0}catch(t){return 0}}}return t=AccountsKPIsOverview,(0,i.Z)(AccountsKPIsOverview,"ɵfac",(function(e){return new(e||t)(u.Y36(h.y),u.Y36(m.o),u.Y36(p.Pu),u.Y36(f.d),u.Y36(u.Qsj))})),(0,i.Z)(AccountsKPIsOverview,"ɵcmp",u.Xpm({type:t,selectors:[["ng-component"]],decls:4,vars:3,consts:[[1,"slds-container--fluid","slds-m-vertical--small"],["class","slds-table--header-fixed_container",3,"ngStyle",4,"ngIf"],[4,"ngIf"],["class","slds-align_absolute-center slds-p-vertical--medium",4,"ngIf"],[1,"slds-table--header-fixed_container",3,"ngStyle"],[1,"slds-scrollable--y",2,"height","100%"],[1,"slds-table","slds-table_bordered","slds-table_header-fixed","slds-theme--default"],[1,"slds-text-title_caps"],["scope","col"],["title","companyCode",1,"slds-p-left--x-small","slds-truncate","slds-cell-fixed","slds-grid","slds-grid_vertical-align-center"],["label","LBL_COMPANYCODE"],["scope","col",4,"ngFor","ngForOf"],["title","currency",1,"slds-p-left--x-small","slds-truncate","slds-cell-fixed","slds-grid","slds-grid_vertical-align-center",2,"width","fit-content"],["label","LBL_CURRENCY"],[4,"ngFor","ngForOf"],["title","year",1,"slds-p-left--x-small","slds-truncate","slds-cell-fixed","slds-grid","slds-grid_vertical-align-center"],["scope","row",1,"slds-theme_shade","slds-text-title_caps"],["title","Company Code",1,"slds-truncate"],["scope","row",4,"ngFor","ngForOf"],["scope","row",1,"slds-theme_shade"],["title","EUR",1,"slds-truncate","slds-text-title_caps"],["scope","row"],["title","Revenue",1,"slds-truncate"],[1,"slds-align_absolute-center","slds-p-vertical--medium"]],template:function(t,e){1&t&&(u.TgZ(0,"div",0),u.YNc(1,x,14,3,"div",1),u.YNc(2,A,1,0,"system-spinner",2),u.YNc(3,T,3,0,"div",3),u.qZA()),2&t&&(u.xp6(1),u.Q6J("ngIf",e.companyCodes.length>0),u.xp6(1),u.Q6J("ngIf",e.isLoading),u.xp6(1),u.Q6J("ngIf",!e.isLoading&&0==e.companyCodes.length))},dependencies:[n.sg,n.O5,n.PC,v._,b.W],encapsulation:2})),AccountsKPIsOverview})();var w=s(2294);const F=["ccdetailscontainer"];let J=(()=>{var t;class AccountCCDetailsTab{constructor(t,e,s){(0,i.Z)(this,"language",void 0),(0,i.Z)(this,"metadata",void 0),(0,i.Z)(this,"model",void 0),(0,i.Z)(this,"ccdetailscontainer",void 0),(0,i.Z)(this,"data",void 0),(0,i.Z)(this,"componentconfig",{}),(0,i.Z)(this,"parent",void 0),(0,i.Z)(this,"ccode",{}),this.language=t,this.metadata=e,this.model=s,this.model.module="AccountCCDetails"}ngOnInit(){this.setModelData()}ngAfterViewInit(){this.renderView()}setModelData(){this.data?(this.model.id=this.data.id,this.model.setFields(this.model.utils.backendModel2spice(this.model.module,this.data))):(this.model.initialize(this.parent),this.model.setFields({name:this.ccode.name,companycode_id:this.ccode.id}),this.model.getField("account_id")||this.model.setFields({account_id:this.parent.id,account_name:this.parent.getField("name")}))}renderView(){_.isEmpty(this.componentconfig)&&(this.componentconfig=this.metadata.getComponentConfig("AccountCCDetails","AccountCCDetails"),_.isEmpty(this.componentconfig)&&(this.componentconfig=this.metadata.getComponentConfig("AccountCCDetailsTab","Accounts")));let t=this.componentconfig.componentset;if(t){let e=this.metadata.getComponentSetObjects(t);for(let t of e)this.metadata.addComponent(t.component,this.ccdetailscontainer).subscribe((e=>{e.instance.componentconfig=t.componentconfig}))}}}return t=AccountCCDetailsTab,(0,i.Z)(AccountCCDetailsTab,"ɵfac",(function(e){return new(e||t)(u.Y36(f.d),u.Y36(p.Pu),u.Y36(m.o))})),(0,i.Z)(AccountCCDetailsTab,"ɵcmp",u.Xpm({type:t,selectors:[["account-cc-details-tab"]],viewQuery:function(t,e){if(1&t&&u.Gf(F,7,u.s_b),2&t){let t;u.iGM(t=u.CRH())&&(e.ccdetailscontainer=t.first)}},inputs:{data:"data",componentconfig:"componentconfig",parent:"parent",ccode:"ccode"},features:[u._Bn([m.o])],decls:2,vars:0,consts:[["ccdetailscontainer",""]],template:function(t,e){1&t&&u._UZ(0,"div",null,0)},encapsulation:2})),AccountCCDetailsTab})();const D=function(t){return{"slds-active":t}};function Y(t,e){if(1&t){const t=u.EpF();u.TgZ(0,"li",8),u.NdJ("click",(function(){const e=u.CHM(t).index,s=u.oxw(2);return u.KtG(s.setActiveTab(e))})),u.TgZ(1,"a",9),u._uU(2),u.qZA()()}if(2&t){const t=e.$implicit,s=e.index,i=u.oxw(2);u.Q6J("ngClass",u.VKq(2,D,s===i.activeTab)),u.xp6(2),u.hij(" ",t.companycode," ")}}function O(t,e){if(1&t&&(u.ynx(0),u.TgZ(1,"div",10),u._UZ(2,"account-cc-details-tab",11),u.qZA(),u.BQk()),2&t){const t=e.$implicit,s=e.index,i=u.oxw(2);u.xp6(1),u.Q6J("ngStyle",i.getContentContainerStyle(s)),u.xp6(1),u.Q6J("ccode",t)("parent",i.model)("data",i.getCCDetailsData(t))}}function N(t,e){if(1&t&&(u.TgZ(0,"div",4)(1,"ul",5),u.YNc(2,Y,3,4,"li",6),u.qZA(),u.YNc(3,O,3,4,"ng-container",7),u.qZA()),2&t){const t=u.oxw();u.xp6(2),u.Q6J("ngForOf",t.companyCodes)("ngForTrackBy",t.trackByFn),u.xp6(1),u.Q6J("ngForOf",t.companyCodes)("ngForTrackBy",t.trackByFn)}}function k(t,e){1&t&&u._UZ(0,"system-spinner")}function Q(t,e){1&t&&(u.TgZ(0,"div",12),u._UZ(1,"system-label",13),u.qZA())}let M=(()=>{var t;class AccountCCDetails{constructor(t,e,s,n){(0,i.Z)(this,"language",void 0),(0,i.Z)(this,"model",void 0),(0,i.Z)(this,"backend",void 0),(0,i.Z)(this,"view",void 0),(0,i.Z)(this,"companyCodes",[]),(0,i.Z)(this,"activatedTabs",[]),(0,i.Z)(this,"activeTab",0),(0,i.Z)(this,"isLoading",!1),this.language=t,this.model=e,this.backend=s,this.view=n,this.loadCompanyCodes()}ngOnInit(){this.view.isEditable=!0}loadCompanyCodes(){this.isLoading=!0;let t=JSON.stringify(["companycode","date_modified","description","id"]);this.backend.getRequest("module/CompanyCodes",{fields:t}).subscribe((t=>{this.companyCodes=t.list})),this.isLoading=!1}setActiveTab(t){this.activatedTabs.push(t),this.activeTab=t}getCCDetailsData(t){let e=this.model.data.accountccdetails.beans;for(let s in e)if(e.hasOwnProperty(s)&&e[s].companycode_id==t.id)return e[s]}getContentContainerStyle(t){return{display:t!==this.activeTab?"none":"block",padding:".25rem"}}trackByFn(t,e){return t}}return t=AccountCCDetails,(0,i.Z)(AccountCCDetails,"ɵfac",(function(e){return new(e||t)(u.Y36(f.d),u.Y36(m.o),u.Y36(h.y),u.Y36(w.e))})),(0,i.Z)(AccountCCDetails,"ɵcmp",u.Xpm({type:t,selectors:[["ng-component"]],decls:4,vars:3,consts:[[1,"slds-grid","slds-m-top--x-small","slds-p-around--xxx-small",2,"border-radius",".25rem","border","1px solid #dddbda"],["class","slds-tabs--default",4,"ngIf"],[4,"ngIf"],["class","slds-align_absolute-center slds-p-around--small",4,"ngIf"],[1,"slds-tabs--default"],["role","tablist",1,"slds-tabs--default__nav"],["class","slds-tabs--default__item slds-text-title--caps","role","presentation",3,"ngClass","click",4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngFor","ngForOf","ngForTrackBy"],["role","presentation",1,"slds-tabs--default__item","slds-text-title--caps",3,"ngClass","click"],["href","javascript:void(0);","role","tab","aria-selected","false",1,"slds-tabs--default__link"],["role","tabpanel",1,"slds-tabs--default__content","slds-p-around--xx-small","slds-show",3,"ngStyle"],[3,"ccode","parent","data"],[1,"slds-align_absolute-center","slds-p-around--small"],["label","LBL_NO_ENTRIES"]],template:function(t,e){1&t&&(u.TgZ(0,"div",0),u.YNc(1,N,4,4,"div",1),u.YNc(2,k,1,0,"system-spinner",2),u.YNc(3,Q,2,0,"div",3),u.qZA()),2&t&&(u.xp6(1),u.Q6J("ngIf",!e.isLoading&&e.companyCodes.length>0),u.xp6(1),u.Q6J("ngIf",e.isLoading),u.xp6(1),u.Q6J("ngIf",!e.isLoading&&0==e.companyCodes.length))},dependencies:[n.mk,n.sg,n.O5,n.PC,v._,b.W,J],encapsulation:2})),AccountCCDetails})();var q=s(6951);let L=(()=>{var t;class AccountTerritoryDetailsTab{constructor(t,e,s,n){(0,i.Z)(this,"language",void 0),(0,i.Z)(this,"metadata",void 0),(0,i.Z)(this,"parent",void 0),(0,i.Z)(this,"model",void 0),(0,i.Z)(this,"data",void 0),(0,i.Z)(this,"componentconfig",{}),(0,i.Z)(this,"componentset",void 0),this.language=t,this.metadata=e,this.parent=s,this.model=n,this.model.module="AccountCCDetails"}ngOnInit(){this.setModelData()}ngAfterViewInit(){this.renderView()}setModelData(){this.data?(this.model.id=this.data.id,this.model.setFields(this.model.utils.backendModel2spice(this.model.module,this.data))):(this.model.initialize(this.parent),this.model.getField("account_id")||this.model.setFields({account_id:this.parent.id,account_name:this.parent.getField("name")}))}renderView(){_.isEmpty(this.componentconfig)&&(this.componentconfig=this.metadata.getComponentConfig("AccountTerritoryDetails","AccountCCDetails")),this.componentset=this.componentconfig.componentset}}return t=AccountTerritoryDetailsTab,(0,i.Z)(AccountTerritoryDetailsTab,"ɵfac",(function(e){return new(e||t)(u.Y36(f.d),u.Y36(p.Pu),u.Y36(m.o,4),u.Y36(m.o))})),(0,i.Z)(AccountTerritoryDetailsTab,"ɵcmp",u.Xpm({type:t,selectors:[["account-territory-details-tab"]],inputs:{data:"data",componentconfig:"componentconfig"},features:[u._Bn([m.o])],decls:1,vars:1,consts:[[3,"componentset"]],template:function(t,e){1&t&&u._UZ(0,"system-componentset",0),2&t&&u.Q6J("componentset",e.componentset)},dependencies:[q.E],encapsulation:2})),AccountTerritoryDetailsTab})();const S=function(t){return{"slds-active":t}};function E(t,e){if(1&t){const t=u.EpF();u.TgZ(0,"li",8),u.NdJ("click",(function(){const e=u.CHM(t).index,s=u.oxw(2);return u.KtG(s.setActiveTab(e))})),u.TgZ(1,"a",9),u._uU(2),u.qZA()()}if(2&t){const t=e.$implicit,s=e.index,i=u.oxw(2);u.Q6J("ngClass",u.VKq(2,S,s===i.activeTab)),u.xp6(2),u.hij(" ",t.name," ")}}const U=function(t){return{"slds-hide":t}};function H(t,e){if(1&t&&(u.ynx(0),u.TgZ(1,"div",10),u._UZ(2,"account-territory-details-tab",11),u.qZA(),u.BQk()),2&t){const t=e.$implicit,s=e.index,i=u.oxw(2);u.xp6(1),u.Q6J("ngClass",u.VKq(2,U,s!=i.activeTab)),u.xp6(1),u.Q6J("data",t)}}function B(t,e){if(1&t&&(u.TgZ(0,"div",4)(1,"ul",5),u.YNc(2,E,3,4,"li",6),u.qZA(),u.YNc(3,H,3,4,"ng-container",7),u.qZA()),2&t){const t=u.oxw();u.xp6(2),u.Q6J("ngForOf",t.getCCDetails())("ngForTrackBy",t.trackByFn),u.xp6(1),u.Q6J("ngForOf",t.getCCDetails())("ngForTrackBy",t.trackByFn)}}function $(t,e){1&t&&u._UZ(0,"system-spinner")}function V(t,e){1&t&&(u.TgZ(0,"div",12),u._UZ(1,"system-label",13),u.qZA())}let K=(()=>{var t;class AccountTerritoryDetails{constructor(t,e,s,n){(0,i.Z)(this,"language",void 0),(0,i.Z)(this,"model",void 0),(0,i.Z)(this,"backend",void 0),(0,i.Z)(this,"view",void 0),(0,i.Z)(this,"companyCodes",[]),(0,i.Z)(this,"activatedTabs",[]),(0,i.Z)(this,"activeTab",0),(0,i.Z)(this,"isLoading",!1),this.language=t,this.model=e,this.backend=s,this.view=n}ngOnInit(){this.view.isEditable=!0}setActiveTab(t){this.activatedTabs.push(t),this.activeTab=t}getCCDetails(){return this.model.data?.accountccdetails?.beans?_.toArray(this.model.data.accountccdetails.beans):[]}getCCDetailsData(t){let e=this.model.data.accountccdetails.beans;for(let s in e)if(e.hasOwnProperty(s)&&e[s].companycode_id==t.id)return e[s]}trackByFn(t,e){return t}}return t=AccountTerritoryDetails,(0,i.Z)(AccountTerritoryDetails,"ɵfac",(function(e){return new(e||t)(u.Y36(f.d),u.Y36(m.o),u.Y36(h.y),u.Y36(w.e))})),(0,i.Z)(AccountTerritoryDetails,"ɵcmp",u.Xpm({type:t,selectors:[["ng-component"]],decls:4,vars:3,consts:[[1,"slds-grid","slds-m-top--x-small","slds-p-around--xxx-small",2,"border-radius",".25rem","border","1px solid #dddbda"],["class","slds-tabs--default",4,"ngIf"],[4,"ngIf"],["class","slds-align_absolute-center slds-p-around--small",4,"ngIf"],[1,"slds-tabs--default"],["role","tablist",1,"slds-tabs--default__nav"],["class","slds-tabs--default__item slds-text-title--caps","role","presentation",3,"ngClass","click",4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngFor","ngForOf","ngForTrackBy"],["role","presentation",1,"slds-tabs--default__item","slds-text-title--caps",3,"ngClass","click"],["href","javascript:void(0);","role","tab","aria-selected","false",1,"slds-tabs--default__link"],["role","tabpanel",1,"slds-tabs--default__content","slds-p-around--xx-small","slds-show",3,"ngClass"],[3,"data"],[1,"slds-align_absolute-center","slds-p-around--small"],["label","LBL_NO_ENTRIES"]],template:function(t,e){1&t&&(u.TgZ(0,"div",0),u.YNc(1,B,4,4,"div",1),u.YNc(2,$,1,0,"system-spinner",2),u.YNc(3,V,2,0,"div",3),u.qZA()),2&t&&(u.xp6(1),u.Q6J("ngIf",e.getCCDetails().length>0),u.xp6(1),u.Q6J("ngIf",e.isLoading),u.xp6(1),u.Q6J("ngIf",0==e.getCCDetails().length))},dependencies:[n.mk,n.sg,n.O5,v._,b.W,L],encapsulation:2})),AccountTerritoryDetails})();const R=["ccdetailscontainer"];let j=(()=>{var t;class ContactCCDetailsTab{constructor(t,e,s){(0,i.Z)(this,"language",void 0),(0,i.Z)(this,"metadata",void 0),(0,i.Z)(this,"model",void 0),(0,i.Z)(this,"ccdetailscontainer",void 0),(0,i.Z)(this,"data",void 0),(0,i.Z)(this,"contactId",void 0),(0,i.Z)(this,"ccId",void 0),(0,i.Z)(this,"ccName",void 0),this.language=t,this.metadata=e,this.model=s}ngOnChanges(){this.setModelData()}ngOnInit(){this.model.module="ContactCCDetails"}ngAfterViewInit(){this.renderView()}renderView(){let t=this.metadata.getComponentConfig("ContactCCDetailsTab","Accounts").componentset;if(t){let e=this.metadata.getComponentSetObjects(t);for(let t of e)this.metadata.addComponent(t.component,this.ccdetailscontainer).subscribe((e=>{e.instance.componentconfig=t.componentconfig}))}}setModelData(){this.data?(this.model.id=this.data.id,this.model.setData(this.data)):(this.model.id=this.model.generateGuid(),this.model.setData({id:this.model.id,name:this.ccName,contact_id:this.contactId,companycode_id:this.ccId,date_entered:new moment,date_modified:new moment},!1))}}return t=ContactCCDetailsTab,(0,i.Z)(ContactCCDetailsTab,"ɵfac",(function(e){return new(e||t)(u.Y36(f.d),u.Y36(p.Pu),u.Y36(m.o))})),(0,i.Z)(ContactCCDetailsTab,"ɵcmp",u.Xpm({type:t,selectors:[["contact-cc-details-tab"]],viewQuery:function(t,e){if(1&t&&u.Gf(R,7,u.s_b),2&t){let t;u.iGM(t=u.CRH())&&(e.ccdetailscontainer=t.first)}},inputs:{data:"data",contactId:["contactid","contactId"],ccId:["ccid","ccId"],ccName:["ccname","ccName"]},features:[u._Bn([m.o]),u.TTD],decls:2,vars:0,consts:[["ccdetailscontainer",""]],template:function(t,e){1&t&&u._UZ(0,"div",null,0)},encapsulation:2})),ContactCCDetailsTab})();const P=function(t){return{"slds-active":t}};function G(t,e){if(1&t){const t=u.EpF();u.TgZ(0,"li",8),u.NdJ("click",(function(){const e=u.CHM(t).index,s=u.oxw(2);return u.KtG(s.setActiveTab(e))})),u.TgZ(1,"a",9),u._uU(2),u.qZA()()}if(2&t){const t=e.$implicit,s=e.index,i=u.oxw(2);u.Q6J("ngClass",u.VKq(2,P,s===i.activeTab)),u.xp6(2),u.hij(" ",t.companycode," ")}}function z(t,e){if(1&t&&(u.ynx(0),u.TgZ(1,"div",10),u._UZ(2,"contact-cc-details-tab",11),u.qZA(),u.BQk()),2&t){const t=e.$implicit,s=e.index,i=u.oxw(2);u.xp6(1),u.Q6J("ngStyle",i.getContentContainerStyle(s)),u.xp6(1),u.Q6J("ccid",t.id)("ccname",t.companycode)("contactid",i.model.id)("data",i.getCCDetailsData(t))}}function X(t,e){if(1&t&&(u.TgZ(0,"div",4)(1,"ul",5),u.YNc(2,G,3,4,"li",6),u.qZA(),u.YNc(3,z,3,5,"ng-container",7),u.qZA()),2&t){const t=u.oxw();u.xp6(2),u.Q6J("ngForOf",t.companyCodes)("ngForTrackBy",t.trackByFn),u.xp6(1),u.Q6J("ngForOf",t.companyCodes)("ngForTrackBy",t.trackByFn)}}function W(t,e){1&t&&u._UZ(0,"system-spinner")}function tt(t,e){1&t&&(u.TgZ(0,"div",12),u._UZ(1,"system-label",13),u.qZA())}let et=(()=>{var t;class ContactCCDetails{constructor(t,e,s,n,a){(0,i.Z)(this,"language",void 0),(0,i.Z)(this,"model",void 0),(0,i.Z)(this,"acmService",void 0),(0,i.Z)(this,"backend",void 0),(0,i.Z)(this,"view",void 0),(0,i.Z)(this,"activatedTabs",[]),(0,i.Z)(this,"companyCodes",[]),(0,i.Z)(this,"activeTab",0),(0,i.Z)(this,"contactccdetails",{}),(0,i.Z)(this,"isLoading",!1),(0,i.Z)(this,"accountsContactsManagerSubscriber",void 0),this.language=t,this.model=e,this.acmService=s,this.backend=n,this.view=a,this.loadCompanyCode(),this.subscribeContactCCDetailsChanges()}get contactCCDetails(){return this.contactccdetails}set contactCCDetails(t){this.contactccdetails=t}ngOnInit(){this.view.isEditable=!0}ngOnDestroy(){this.accountsContactsManagerSubscriber.unsubscribe()}setActiveTab(t){this.activatedTabs.push(t),this.activeTab=t}getCCDetailsData(t){if(!_.isEmpty(this.contactCCDetails))for(let e in this.contactCCDetails)if(this.contactCCDetails[e].companycode_id==t.id)return this.contactCCDetails[e]}getContentContainerStyle(t){return{display:t!==this.activeTab?"none":"block",padding:".25rem"}}loadCompanyCode(){this.isLoading=!0;let t=JSON.stringify(["companycode","date_modified","description","id"]);this.backend.getRequest("module/CompanyCodes",{fields:t}).subscribe((t=>{this.companyCodes=t.list,this.isLoading=!1}))}subscribeContactCCDetailsChanges(){this.accountsContactsManagerSubscriber=this.acmService.contactCCDetails$.subscribe((t=>{this.activeTab=0,this.companyCodes=this.companyCodes.slice(),this.contactCCDetails=t}))}trackByFn(t,e){return t}}return t=ContactCCDetails,(0,i.Z)(ContactCCDetails,"ɵfac",(function(e){return new(e||t)(u.Y36(f.d),u.Y36(m.o),u.Y36(g),u.Y36(h.y),u.Y36(w.e))})),(0,i.Z)(ContactCCDetails,"ɵcmp",u.Xpm({type:t,selectors:[["contact-cc-details"]],features:[u._Bn([w.e])],decls:4,vars:3,consts:[[1,"slds-grid","slds-m-top--x-small","slds-p-around--xxx-small",2,"border-radius",".25rem","border","1px solid #dddbda"],["class","slds-tabs--default",4,"ngIf"],[4,"ngIf"],["class","slds-align_absolute-center slds-p-around--small",4,"ngIf"],[1,"slds-tabs--default"],["role","tablist",1,"slds-tabs--default__nav"],["class","slds-tabs--default__item slds-text-title--caps","role","presentation",3,"ngClass","click",4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngFor","ngForOf","ngForTrackBy"],["role","presentation",1,"slds-tabs--default__item","slds-text-title--caps",3,"ngClass","click"],["href","javascript:void(0);","role","tab","aria-selected","false",1,"slds-tabs--default__link"],["role","tabpanel",1,"slds-tabs--default__content","slds-p-around--xx-small","slds-show",3,"ngStyle"],[3,"ccid","ccname","contactid","data"],[1,"slds-align_absolute-center","slds-p-around--small"],["label","LBL_NO_ENTRIES"]],template:function(t,e){1&t&&(u.TgZ(0,"div",0),u.YNc(1,X,4,4,"div",1),u.YNc(2,W,1,0,"system-spinner",2),u.YNc(3,tt,2,0,"div",3),u.qZA()),2&t&&(u.xp6(1),u.Q6J("ngIf",!e.isLoading&&e.companyCodes.length>0),u.xp6(1),u.Q6J("ngIf",e.isLoading),u.xp6(1),u.Q6J("ngIf",!e.isLoading&&0==e.companyCodes.length))},dependencies:[n.mk,n.sg,n.O5,n.PC,v._,b.W,j],encapsulation:2})),ContactCCDetails})();var st=s(6040),it=s(8652);const nt=["detailscontainer"];function at(t,e){1&t&&(u.TgZ(0,"div",4)(1,"span"),u._UZ(2,"system-label",5),u.qZA()())}let ot=(()=>{var t;class AccountsContactsManagerDetails{constructor(t,e,s,n,a,o){(0,i.Z)(this,"language",void 0),(0,i.Z)(this,"metadata",void 0),(0,i.Z)(this,"view",void 0),(0,i.Z)(this,"acmService",void 0),(0,i.Z)(this,"relatedmodels",void 0),(0,i.Z)(this,"model",void 0),(0,i.Z)(this,"detailscontainer",void 0),(0,i.Z)(this,"activeContactId",void 0),(0,i.Z)(this,"renderedComponents",[]),this.language=t,this.metadata=e,this.view=s,this.acmService=n,this.relatedmodels=a,this.model=o,this.model.module="Contacts"}ngAfterViewInit(){this.buildContainer()}ngOnChanges(){this.activeContactId&&(this.resetView(),this.buildContainer(),this.view.setViewMode(),this.model.id=this.activeContactId,this.model.getData(!0,"",!0).subscribe((t=>{_.isEmpty(t.contactccdetails.beans)?this.acmService.contactCCDetails={}:this.acmService.contactCCDetails=t.contactccdetails.beans})))}resetView(){for(let t of this.renderedComponents)t.destroy();this.renderedComponents=[]}buildContainer(){let t=this.metadata.getComponentConfig("AccountsContactsManager","Accounts").detailscomponentset;if(t){let e=this.metadata.getComponentSetObjects(t);for(let t of e)this.metadata.addComponent(t.component,this.detailscontainer).subscribe((e=>{this.renderedComponents.push(e),e.instance.componentconfig=t.componentconfig}))}}}return t=AccountsContactsManagerDetails,(0,i.Z)(AccountsContactsManagerDetails,"ɵfac",(function(e){return new(e||t)(u.Y36(f.d),u.Y36(p.Pu),u.Y36(w.e),u.Y36(g),u.Y36(st.j),u.Y36(m.o))})),(0,i.Z)(AccountsContactsManagerDetails,"ɵcmp",u.Xpm({type:t,selectors:[["accounts-contacts-manager-details"]],viewQuery:function(t,e){if(1&t&&u.Gf(nt,7,u.s_b),2&t){let t;u.iGM(t=u.CRH())&&(e.detailscontainer=t.first)}},inputs:{activeContactId:["activecontactid","activeContactId"]},features:[u._Bn([m.o,w.e]),u.TTD],decls:5,vars:2,consts:[[1,"slds-scrollable--y","slds-p-around--x-small"],["class","slds-text-align_center slds-p-vertical--medium",4,"ngIf"],[3,"hidden"],["detailscontainer",""],[1,"slds-text-align_center","slds-p-vertical--medium"],["label","LBL_MAKE_SELECTION"]],template:function(t,e){1&t&&(u.TgZ(0,"div",0),u.YNc(1,at,3,0,"div",1),u.TgZ(2,"div",2),u._UZ(3,"div",null,3),u.qZA()()),2&t&&(u.xp6(1),u.Q6J("ngIf",!e.activeContactId),u.xp6(1),u.Q6J("hidden",!e.activeContactId))},dependencies:[n.O5,v._],encapsulation:2})),AccountsContactsManagerDetails})();var ct=s(6367),dt=s(3634),lt=s(7763);const rt=["tableContainer"];function ut(t,e){if(1&t&&(u.TgZ(0,"th",10)(1,"div",11),u._UZ(2,"field-label",12),u.qZA()()),2&t){const t=e.$implicit;u.xp6(2),u.Q6J("fieldname",t.field)("fieldconfig",t.fieldconfig)}}function gt(t,e){if(1&t&&(u.TgZ(0,"td"),u._UZ(1,"field-container",15),u.qZA()),2&t){const t=e.$implicit;u.xp6(1),u.Q6J("fieldname",t.field)("fieldconfig",t.fieldconfig)}}const ht=function(t){return{module:"Contacts",data:t}},mt=function(t){return{"slds-theme_shade":t}},pt=function(t,e){return{"border-bottom":t,"font-weight":e}};function ft(t,e){if(1&t){const t=u.EpF();u.TgZ(0,"tr",13),u.NdJ("click",(function(){const e=u.CHM(t).$implicit,s=u.oxw(2);return u.KtG(s.setActiveContactId(e.id))}))("mouseover",(function(){const e=u.CHM(t).$implicit,s=u.oxw(2);return u.KtG(s.hovered=e.id)}))("mouseout",(function(){u.CHM(t);const e=u.oxw(2);return u.KtG(e.hovered="")})),u.YNc(1,gt,2,2,"td",14),u.qZA()}if(2&t){const t=e.$implicit,s=u.oxw(2);u.Q6J("system-model-provider",u.VKq(4,ht,t))("ngClass",u.VKq(6,mt,s.activeContactId==t.id))("ngStyle",u.WLB(8,pt,s.hovered==t.id?"1px solid darkred":"",s.activeContactId==t.id?"700":"")),u.xp6(1),u.Q6J("ngForOf",s.listfields)}}function vt(t,e){if(1&t&&(u.TgZ(0,"div",3,4)(2,"div",5)(3,"table",6)(4,"thead")(5,"tr",7),u.YNc(6,ut,3,2,"th",8),u.qZA()(),u.TgZ(7,"tbody"),u.YNc(8,ft,2,11,"tr",9),u.qZA()()()()),2&t){const t=u.oxw();u.Q6J("ngStyle",t.tableHeight),u.xp6(6),u.Q6J("ngForOf",t.listfields),u.xp6(2),u.Q6J("ngForOf",t.contacts)}}function bt(t,e){1&t&&u._UZ(0,"system-spinner")}function Ct(t,e){1&t&&(u.TgZ(0,"div",16)(1,"span"),u._UZ(2,"system-label",17),u.qZA()())}let Zt=(()=>{var t;class AccountsContactsManagerList{constructor(t,e,s,n){(0,i.Z)(this,"language",void 0),(0,i.Z)(this,"metadata",void 0),(0,i.Z)(this,"relatedmodels",void 0),(0,i.Z)(this,"model",void 0),(0,i.Z)(this,"tableContainer",void 0),(0,i.Z)(this,"listfields",[]),(0,i.Z)(this,"hovered",""),(0,i.Z)(this,"fieldset",""),(0,i.Z)(this,"tableheight",{}),(0,i.Z)(this,"activeContactId$",new u.vpe),(0,i.Z)(this,"activeContactId",void 0),this.language=t,this.metadata=e,this.relatedmodels=s,this.model=n,this.model.module="Contacts"}ngOnInit(){let t=this.metadata.getComponentConfig("AccountsContactsManager","Accounts");this.listfields=this.metadata.getFieldSetFields(t.listfieldset)}setActiveContactId(t){this.activeContactId=t,this.activeContactId$.emit(t)}get contacts(){return this.relatedmodels.items}get tableHeight(){return this.tableheight}get isloading(){return this.relatedmodels.isloading}}return t=AccountsContactsManagerList,(0,i.Z)(AccountsContactsManagerList,"ɵfac",(function(e){return new(e||t)(u.Y36(f.d),u.Y36(p.Pu),u.Y36(st.j),u.Y36(m.o))})),(0,i.Z)(AccountsContactsManagerList,"ɵcmp",u.Xpm({type:t,selectors:[["accounts-contacts-manager-list"]],viewQuery:function(t,e){if(1&t&&u.Gf(rt,7,u.s_b),2&t){let t;u.iGM(t=u.CRH())&&(e.tableContainer=t.first)}},inputs:{fieldset:"fieldset",tableheight:["tableHeight","tableheight"]},outputs:{activeContactId$:"activeContactId$"},features:[u._Bn([w.e,m.o])],decls:3,vars:3,consts:[["class","slds-table--header-fixed_container",3,"ngStyle",4,"ngIf"],[4,"ngIf"],["class","slds-text-align_center slds-p-vertical--medium",4,"ngIf"],[1,"slds-table--header-fixed_container",3,"ngStyle"],["tableContainer",""],[1,"slds-scrollable--y",2,"height","100%"],[1,"slds-table","slds-table_bordered","slds-table_cell-buffer","slds-table_header-fixed",2,"border-top","0"],[1,"slds-text-title_caps"],["scope","col",4,"ngFor","ngForOf"],["style","cursor: pointer",3,"system-model-provider","ngClass","ngStyle","click","mouseover","mouseout",4,"ngFor","ngForOf"],["scope","col"],[1,"slds-truncate","slds-cell-fixed","slds-grid","slds-grid_vertical-align-center"],[3,"fieldname","fieldconfig"],[2,"cursor","pointer",3,"system-model-provider","ngClass","ngStyle","click","mouseover","mouseout"],[4,"ngFor","ngForOf"],["fielddisplayclass","slds-truncate",3,"fieldname","fieldconfig"],[1,"slds-text-align_center","slds-p-vertical--medium"],["label","LBL_NO_ENTRIES"]],template:function(t,e){1&t&&(u.YNc(0,vt,9,3,"div",0),u.YNc(1,bt,1,0,"system-spinner",1),u.YNc(2,Ct,3,0,"div",2)),2&t&&(u.Q6J("ngIf",!e.isloading&&(null==e.contacts?null:e.contacts.length)>0),u.xp6(1),u.Q6J("ngIf",e.isloading),u.xp6(1),u.Q6J("ngIf",!e.isloading&&0==(null==e.contacts?null:e.contacts.length)))},dependencies:[n.mk,n.sg,n.O5,n.PC,ct.q,dt.j,v._,b.W,lt.u],encapsulation:2})),AccountsContactsManagerList})();const yt=function(){return{object:"Contacts"}};let xt=(()=>{var t;class AccountsContactsManager{constructor(t,e,s,n,a){(0,i.Z)(this,"language",void 0),(0,i.Z)(this,"metadata",void 0),(0,i.Z)(this,"relatedmodels",void 0),(0,i.Z)(this,"acmService",void 0),(0,i.Z)(this,"model",void 0),(0,i.Z)(this,"editcomponentset",""),(0,i.Z)(this,"module",""),(0,i.Z)(this,"displayitems",5),(0,i.Z)(this,"activeContactId",void 0),this.language=t,this.metadata=e,this.relatedmodels=s,this.acmService=n,this.model=a,this.relatedmodels.module=this.model.module,this.relatedmodels.id=this.model.id}setActiveContactId(t){this.activeContactId=t}get childrenHeight(){return{height:"340px"}}get mainStyle(){return{height:"350pxpx","border-radius":".25rem",border:"1px solid #dddbda"}}ngAfterViewInit(){this.loadRelated()}loadRelated(){this.relatedmodels.relatedModule="Contacts",this.relatedmodels.getData()}ngOnDestroy(){this.relatedmodels.stopSubscriptions()}aclAccess(){return this.metadata.checkModuleAcl(this.module,"list")}}return t=AccountsContactsManager,(0,i.Z)(AccountsContactsManager,"ɵfac",(function(e){return new(e||t)(u.Y36(f.d),u.Y36(p.Pu),u.Y36(st.j),u.Y36(g),u.Y36(m.o))})),(0,i.Z)(AccountsContactsManager,"ɵcmp",u.Xpm({type:t,selectors:[["accounts-contacts-manager"]],features:[u._Bn([st.j,g])],decls:6,vars:5,consts:[[3,"componentconfig"],[1,"slds-grid","slds-border--top",2,"height","350px"],[1,"slds-size--1-of-3","slds-border--right","slds-p-around--xxx-small"],[3,"tableHeight","activeContactId$"],[1,"slds-size--2-of-3",3,"ngStyle"],[3,"activecontactid"]],template:function(t,e){1&t&&(u.TgZ(0,"object-related-card",0)(1,"div",1)(2,"div",2)(3,"accounts-contacts-manager-list",3),u.NdJ("activeContactId$",(function(t){return e.setActiveContactId(t)})),u.qZA()(),u.TgZ(4,"div",4),u._UZ(5,"accounts-contacts-manager-details",5),u.qZA()()()),2&t&&(u.Q6J("componentconfig",u.DdM(4,yt)),u.xp6(3),u.Q6J("tableHeight",e.childrenHeight),u.xp6(1),u.Q6J("ngStyle",e.childrenHeight),u.xp6(1),u.Q6J("activecontactid",e.activeContactId))},dependencies:[n.PC,it.E,ot,Zt],encapsulation:2})),AccountsContactsManager})();var _t=s(7579);let At=(()=>{var t;class accountHierarchy{constructor(t){(0,i.Z)(this,"backend",void 0),(0,i.Z)(this,"httpRequestsRefID",window._.uniqueId("account_hierarchy_http_ref_")),(0,i.Z)(this,"parentId",""),(0,i.Z)(this,"requestedFields",[]),(0,i.Z)(this,"members",[]),(0,i.Z)(this,"membersList",[]),this.backend=t}loadHierachy(t=this.parentId,e=!1){let s=new _t.x,i=[];for(let t of this.requestedFields)i.push(t.field);return this.backend.getRequest(`module/Accounts/${t}/hierarchy/${JSON.stringify(i)}`,null,this.httpRequestsRefID).subscribe((i=>{for(let e of i)this.members.push({parent_id:t,id:e.id,member_count:e.member_count,expanded:!1,loaded:!1,summary_text:e.summary_text,data:e.data});this.members.some((s=>{if(s.id===t)return s.loaded=!0,e&&(s.expanded=!0),!0})),this.rebuildMembersList(),s.next(!0),s.complete()})),s.asObservable()}expand(t){this.members.some((e=>{if(e.id===t)return e.loaded?e.expanded=!0:this.loadHierachy(t,!0),!0})),this.rebuildMembersList()}collapse(t){this.members.some((e=>{if(e.id===t)return e.expanded=!1,!0})),this.rebuildMembersList()}rebuildMembersList(){this.membersList=[],this.buildMembersList()}buildMembersList(t=this.parentId,e=0){for(let s of this.members)s.parent_id==t&&(this.membersList.push({level:e+1,id:s.id,member_count:parseInt(s.member_count,10),summary_text:s.summary_text,data:s.data,expanded:s.expanded}),s.expanded&&this.buildMembersList(s.id,e+1))}ngOnDestroy(){this.backend.cancelPendingRequests([this.httpRequestsRefID])}}return t=accountHierarchy,(0,i.Z)(accountHierarchy,"ɵfac",(function(e){return new(e||t)(u.LFG(h.y))})),(0,i.Z)(accountHierarchy,"ɵprov",u.Yz7({token:t,factory:t.ɵfac})),accountHierarchy})();var Tt=s(4561),It=s(7674),wt=s(2161),Ft=s(2656);const Jt=["account-hierarchy-node",""];function Dt(t,e){if(1&t&&u._UZ(0,"system-button-icon",8),2&t){const t=u.oxw(3);u.Q6J("icon",t.getIcon())}}function Yt(t,e){1&t&&u._UZ(0,"system-button-icon",8),2&t&&u.Q6J("icon","spinner")}function Ot(t,e){if(1&t){const t=u.EpF();u.TgZ(0,"td",3)(1,"button",4),u.NdJ("click",(function(){u.CHM(t);const e=u.oxw(2);return u.KtG(e.expandNode())})),u.YNc(2,Dt,1,1,"system-button-icon",5),u.YNc(3,Yt,1,1,"system-button-icon",5),u.qZA(),u.TgZ(4,"div",6),u._UZ(5,"field-container",7),u.qZA()()}if(2&t){const t=u.oxw().$implicit,e=u.oxw();u.xp6(1),u.Q6J("disabled",0===e.nodedata.member_count),u.xp6(1),u.Q6J("ngIf",!e.loading),u.xp6(1),u.Q6J("ngIf",e.loading),u.xp6(2),u.Q6J("field",t.field)("fieldconfig",t.fieldconfig)("fielddisplayclass","slds-truncate")}}function Nt(t,e){if(1&t&&(u.TgZ(0,"td")(1,"div",6),u._UZ(2,"field-container",7),u.qZA()()),2&t){const t=u.oxw().$implicit;u.xp6(2),u.Q6J("field",t.field)("fieldconfig",t.fieldconfig)("fielddisplayclass","slds-truncate")}}function kt(t,e){if(1&t&&(u.ynx(0),u.YNc(1,Ot,6,6,"td",1),u.YNc(2,Nt,3,3,"td",2),u.BQk()),2&t){const t=e.index;u.xp6(1),u.Q6J("ngIf",0===t),u.xp6(1),u.Q6J("ngIf",t>0)}}let Qt=(()=>{var t;class AccountHierarchyNode{constructor(t,e,s,n,a){(0,i.Z)(this,"view",void 0),(0,i.Z)(this,"language",void 0),(0,i.Z)(this,"metadata",void 0),(0,i.Z)(this,"accountHierarchy",void 0),(0,i.Z)(this,"model",void 0),(0,i.Z)(this,"nodedata",{}),(0,i.Z)(this,"fields",[]),(0,i.Z)(this,"loading",!1),this.view=t,this.language=e,this.metadata=s,this.accountHierarchy=n,this.model=a,this.view.displayLabels=!1}ngOnInit(){this.model.module="Accounts",this.model.id=this.nodedata.id,this.model.setData(this.nodedata.data)}expandNode(){this.nodedata.expanded?this.accountHierarchy.collapse(this.nodedata.id):(this.loading=!0,this.accountHierarchy.expand(this.nodedata.id))}getIcon(){switch(this.nodedata.expanded){case!1:return"chevronright";case!0:return"chevrondown"}}}return t=AccountHierarchyNode,(0,i.Z)(AccountHierarchyNode,"ɵfac",(function(e){return new(e||t)(u.Y36(w.e),u.Y36(f.d),u.Y36(p.Pu),u.Y36(At),u.Y36(m.o))})),(0,i.Z)(AccountHierarchyNode,"ɵcmp",u.Xpm({type:t,selectors:[["","account-hierarchy-node",""]],hostVars:1,hostBindings:function(t,e){2&t&&u.uIk("aria-level",e.nodedata.level)},inputs:{nodedata:"nodedata",fields:"fields"},features:[u._Bn([m.o,w.e])],attrs:Jt,decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],["scope","row","class","slds-tree__item",4,"ngIf"],[4,"ngIf"],["scope","row",1,"slds-tree__item"],[1,"slds-button","slds-button--icon","slds-button--icon-x-small","slds-m-right--x-small",3,"disabled","click"],[3,"icon",4,"ngIf"],[1,"slds-truncate"],[3,"field","fieldconfig","fielddisplayclass"],[3,"icon"]],template:function(t,e){1&t&&u.YNc(0,kt,3,2,"ng-container",0),2&t&&u.Q6J("ngForOf",e.fields)},dependencies:[n.sg,n.O5,dt.j,Ft.J],encapsulation:2})),AccountHierarchyNode})();function Mt(t,e){if(1&t&&(u.TgZ(0,"th",14)(1,"div",15),u._UZ(2,"system-label-fieldname",16),u.qZA()()),2&t){const t=e.$implicit;u.xp6(2),u.Q6J("field",t.field)}}function qt(t,e){if(1&t&&u._UZ(0,"tr",17),2&t){const t=e.$implicit,s=u.oxw();u.Q6J("nodedata",t)("fields",s.fieldsetFields)}}function Lt(t,e){if(1&t&&u._UZ(0,"tbody",18),2&t){const t=u.oxw();u.Q6J("columns",t.fieldsetFields.length)("rows",5)}}let St=(()=>{var t;class AccountHierarchy{constructor(t,e,s,n){(0,i.Z)(this,"language",void 0),(0,i.Z)(this,"metadata",void 0),(0,i.Z)(this,"accountHierarchy",void 0),(0,i.Z)(this,"model",void 0),(0,i.Z)(this,"componentconfig",{}),(0,i.Z)(this,"fieldsetFields",[]),(0,i.Z)(this,"loading",!1),this.language=t,this.metadata=e,this.accountHierarchy=s,this.model=n}loadHierarchy(){return this.accountHierarchy.parentId=this.model.id,this.accountHierarchy.requestedFields=this.fieldsetFields,this.accountHierarchy.loadHierachy()}ngOnInit(){this.fieldsetFields=this.metadata.getFieldSetFields(this.componentconfig.fieldset),this.loading=!0,this.loadHierarchy().subscribe((t=>{this.loading=!1}))}}return t=AccountHierarchy,(0,i.Z)(AccountHierarchy,"ɵfac",(function(e){return new(e||t)(u.Y36(f.d),u.Y36(p.Pu),u.Y36(At),u.Y36(m.o))})),(0,i.Z)(AccountHierarchy,"ɵcmp",u.Xpm({type:t,selectors:[["account-hierarchy"]],features:[u._Bn([At])],decls:17,vars:5,consts:[[1,"slds-card","slds-card_boundary","slds-m-bottom--medium"],[1,"slds-card__header","slds-grid"],[1,"slds-media","slds-media--center","slds-has-flexi-truncate"],[3,"icon","size"],[1,"slds-media__body","slds-truncate"],["href","javascript:void(0);",1,"slds-text-link--reset"],[1,"slds-text-heading--small"],["label","LBL_SUBSIDIARIES"],[1,"slds-card__body"],["role","treegrid",1,"slds-table","slds-table--bordered","slds-tree","slds-table--tree"],[1,"slds-text-title--caps"],["class","slds-cell-buffer--left","scope","col",4,"ngFor","ngForOf"],["account-hierarchy-node","","class","slds-hint-parent","role","row","aria-expanded","true",3,"nodedata","fields",4,"ngFor","ngForOf"],["system-table-stencils","",3,"columns","rows",4,"ngIf"],["scope","col",1,"slds-cell-buffer--left"],[1,"slds-truncate"],["module","Accounts",3,"field"],["account-hierarchy-node","","role","row","aria-expanded","true",1,"slds-hint-parent",3,"nodedata","fields"],["system-table-stencils","",3,"columns","rows"]],template:function(t,e){1&t&&(u.TgZ(0,"article",0)(1,"div",1)(2,"header",2),u._UZ(3,"system-icon",3),u.TgZ(4,"div",4)(5,"h2")(6,"a",5)(7,"span",6),u._UZ(8,"system-label",7),u.qZA()()()()()(),u.TgZ(9,"div",8)(10,"table",9)(11,"thead")(12,"tr",10),u.YNc(13,Mt,3,1,"th",11),u.qZA()(),u.TgZ(14,"tbody"),u.YNc(15,qt,1,2,"tr",12),u.qZA(),u.YNc(16,Lt,1,2,"tbody",13),u.qZA()()()),2&t&&(u.xp6(3),u.Q6J("icon","hierarchy")("size","small"),u.xp6(10),u.Q6J("ngForOf",e.fieldsetFields),u.xp6(2),u.Q6J("ngForOf",e.accountHierarchy.membersList),u.xp6(1),u.Q6J("ngIf",e.loading))},dependencies:[n.sg,n.O5,Tt.f,v._,It.h,wt.x,Qt],encapsulation:2})),AccountHierarchy})();var Et=s(7040),Ut=s(3348),Ht=s(3278),Bt=s(3208),$t=s(5638),Vt=s(494);function Kt(t,e){if(1&t&&u._UZ(0,"field-label",3),2&t){const t=u.oxw();u.Q6J("fieldname",t.fieldname)("fieldconfig",t.fieldconfig)}}function Rt(t,e){if(1&t&&(u.TgZ(0,"field-generic-display",6),u._UZ(1,"div",7),u.TgZ(2,"div"),u._uU(3),u.qZA()()),2&t){const t=e.$implicit,s=u.oxw(2);u.Q6J("fielddisplayclass",s.fielddisplayclass)("fieldconfig",s.fieldconfig)("editable",s.isEditable()),u.xp6(1),u.Q6J("ngStyle",s.getColor(t.id)),u.xp6(2),u.AsE(" (",t.country,") ",t.vat_id," ")}}function jt(t,e){if(1&t&&(u.TgZ(0,"div",4),u.YNc(1,Rt,4,6,"field-generic-display",5),u.qZA()),2&t){const t=u.oxw();u.xp6(1),u.Q6J("ngForOf",t.getAccountVATIDs())}}function Pt(t,e){if(1&t&&(u.TgZ(0,"option",28),u._uU(1),u.qZA()),2&t){const t=e.$implicit;u.Q6J("value",t.value),u.xp6(1),u.Oqu(t.display)}}function Gt(t,e){if(1&t){const t=u.EpF();u.TgZ(0,"div",22)(1,"div",23)(2,"div",24)(3,"select",25,17),u.NdJ("ngModelChange",(function(e){u.CHM(t);const s=u.oxw().$implicit;return u.KtG(s.country=e)})),u.YNc(5,Pt,2,2,"option",26),u.qZA()(),u._UZ(6,"field-messages",27),u.qZA()()}if(2&t){const t=u.oxw().$implicit,e=u.oxw(2);u.xp6(1),u.Q6J("ngClass",e.getFieldClass()),u.xp6(2),u.Q6J("ngModel",t.country),u.xp6(2),u.Q6J("ngForOf",e.options),u.xp6(1),u.Q6J("fieldname",e.fieldname)}}function zt(t,e){if(1&t&&u._UZ(0,"system-tooltip",29),2&t){const t=u.oxw().$implicit,e=u.oxw(2);u.Q6J("tooltiptext",e.vatInfo(t.id))}}function Xt(t,e){if(1&t){const t=u.EpF();u.TgZ(0,"div",12)(1,"button",13)(2,"system-button-icon",14),u.NdJ("click",(function(){const e=u.CHM(t).$implicit,s=u.oxw(2);return u.KtG(s.delete(e.id))})),u.qZA()(),u.YNc(3,Gt,7,4,"div",15),u.TgZ(4,"input",16,17),u.NdJ("ngModelChange",(function(e){const s=u.CHM(t).$implicit;return u.KtG(s.vat_id=e)})),u.qZA(),u.TgZ(6,"div",18),u.YNc(7,zt,1,1,"system-tooltip",19),u.TgZ(8,"button",20),u.NdJ("click",(function(){const e=u.CHM(t).$implicit,s=u.oxw(2);return u.KtG(s.validate(e.country,e.vat_id,e.id))})),u._UZ(9,"system-label",21),u.qZA()()()}if(2&t){const t=e.$implicit,s=u.oxw(2);u.xp6(3),u.Q6J("ngIf",s.isEditMode()),u.xp6(1),u.Q6J("ngModel",t.vat_id),u.xp6(3),u.Q6J("ngIf",s.isvalid(t.id)),u.xp6(1),u.Q6J("disabled",!s.canCheck(t.vat_id))}}function Wt(t,e){if(1&t){const t=u.EpF();u.TgZ(0,"div"),u.YNc(1,Xt,10,4,"div",8),u.TgZ(2,"div",9)(3,"button",10)(4,"system-button-icon",11),u.NdJ("click",(function(){u.CHM(t);const e=u.oxw();return u.KtG(e.add())})),u.qZA()()()()}if(2&t){const t=u.oxw();u.xp6(1),u.Q6J("ngForOf",t.getAccountVATIDs())}}let te=(()=>{var t;class AccountVATIDField extends Et.O{constructor(t,e,s,n,a,o,c){super(t,e,s,n,a),(0,i.Z)(this,"model",void 0),(0,i.Z)(this,"view",void 0),(0,i.Z)(this,"language",void 0),(0,i.Z)(this,"metadata",void 0),(0,i.Z)(this,"router",void 0),(0,i.Z)(this,"backend",void 0),(0,i.Z)(this,"toast",void 0),(0,i.Z)(this,"isvalidating",!1),(0,i.Z)(this,"options",[]),this.model=t,this.view=e,this.language=s,this.metadata=n,this.router=a,this.backend=o,this.toast=c,this.subscriptions.add(this.language.currentlanguage$.subscribe((t=>{this.getOptions()})))}get emptyVATIDS(){return this.getAccountVATIDs().length>0}ngOnInit(){this.getOptions(),this.model.getField("accountvatids")||this.model.initializeField("accountvatids",{beans:{},beans_relations_to_delete:{}}),this.getAccountVATIDs()}getOptions(){let t=[],e=this.language.getFieldDisplayOptions("AccountVATIDs","country");for(let s in e)t.push({value:s,display:e[s]});if(this.options=t,this.fieldconfig.sortdirection)switch(this.fieldconfig.sortdirection.toLowerCase()){case"desc":this.options.sort(((t,e)=>t.display.toLowerCase()<e.display.toLowerCase()?1:-1));break;case"asc":this.options.sort(((t,e)=>t.display.toLowerCase()>e.display.toLowerCase()?1:-1))}}getColor(t){let e="gray";switch(this.model.getField("accountvatids").beans[t].vatid_status){case"valid":e="green";break;case"not_valid":e="red"}return{"background-color":e}}getAccountVATIDs(){let t=[];if(this.model.getField("accountvatids")){let e=this.model.getField("accountvatids");for(let s in e.beans)1!=e.beans[s].deleted&&t.push(e.beans[s])}return t}validate(t,e,s){this.isvalidating=!0,this.backend.getRequest(`module/Account/${t+e}/vatids`).subscribe((t=>{"success"==t.status?!0!==t.data.valid?(this.toast.sendToast(this.language.getLabel("ERR_INVALID_VAT"),"error"),this.model.getField("accountvatids").beans[s].vatid_status="not_valid"):(this.model.getField("accountvatids").beans[s].verification_details=JSON.stringify(t.data),this.model.getField("accountvatids").beans[s].vatid_status="valid",this.toast.sendToast(this.language.getLabel("VALID_VAT"),"success")):this.toast.sendToast(this.language.getLabel("ERR_CHECK_VAT"),"error"),this.isvalidating=!1}))}canCheck(t){return t.length>3}add(){let t=this.model.generateGuid();this.model.getField("accountvatids").beans[t]={id:t,account_id:this.model.id,account_name:this.model.displayname,vat_id:"",vatid_status:"",country:""},this.getAccountVATIDs()}delete(t){this.model.getField("accountvatids").beans[t].deleted=1,this.getAccountVATIDs()}isvalid(t){return"valid"==this.model.getField("accountvatids").beans[t].vatid_status}vatInfo(t){let e=JSON.parse(this.model.getField("accountvatids").beans[t].verification_details);return e.name+"\n"+e.address}}return t=AccountVATIDField,(0,i.Z)(AccountVATIDField,"ɵfac",(function(e){return new(e||t)(u.Y36(m.o),u.Y36(w.e),u.Y36(f.d),u.Y36(p.Pu),u.Y36(Ut.F0),u.Y36(h.y),u.Y36(Ht.A))})),(0,i.Z)(AccountVATIDField,"ɵcmp",u.Xpm({type:t,selectors:[["account-vatid-field"]],features:[u.qOj],decls:3,vars:3,consts:[[3,"fieldname","fieldconfig",4,"ngIf"],["class","slds-p-vertical--small",4,"ngIf"],[4,"ngIf"],[3,"fieldname","fieldconfig"],[1,"slds-p-vertical--small"],[3,"fielddisplayclass","fieldconfig","editable",4,"ngFor","ngForOf"],[3,"fielddisplayclass","fieldconfig","editable"],[2,"float","left","width","10px","height","10px","border-radius","5px","margin-top","5px","margin-right","5px",3,"ngStyle"],["class","slds-grid slds-grid--vertical-align-center",4,"ngFor","ngForOf"],[1,"slds-grid","slds-align-content-center","slds-p-vertical--x-small","slds-border--top"],[1,"slds-button","slds-button--icon-small","slds-button--icon-border"],["icon","add",3,"click"],[1,"slds-grid","slds-grid--vertical-align-center"],[1,"slds-button","slds-button--icon-small","slds-button--icon-border","slds-m-right--x-small"],["icon","close",3,"click"],["class","slds-form-element slds-col slds-m-right--x-small",4,"ngIf"],["type","text",1,"slds-input",3,"ngModel","ngModelChange"],["focus",""],[1,"slds-col_bump-left","slds-grid","slds-grid--vertical-align-center"],["class","slds-m-left--x-small",3,"tooltiptext",4,"ngIf"],[1,"slds-button","slds-button--neutral","slds-m-left--x-small",3,"disabled","click"],["label","LBL_CHECK"],[1,"slds-form-element","slds-col","slds-m-right--x-small"],[1,"slds-form-element__control",3,"ngClass"],[1,"slds-select_container","slds-m-vertical--xx-small"],[1,"slds-select",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"fieldname"],[3,"value"],[1,"slds-m-left--x-small",3,"tooltiptext"]],template:function(t,e){1&t&&(u.YNc(0,Kt,1,2,"field-label",0),u.YNc(1,jt,2,1,"div",1),u.YNc(2,Wt,5,1,"div",2)),2&t&&(u.Q6J("ngIf",e.displayLabel),u.xp6(1),u.Q6J("ngIf",!e.isEditMode()),u.xp6(1),u.Q6J("ngIf",e.isEditMode()))},dependencies:[n.mk,n.sg,n.O5,n.PC,a.YN,a.Kr,a.Fj,a.EJ,a.JJ,a.On,ct.q,Bt.D,$t.a,Ft.J,v._,Vt.S],encapsulation:2})),AccountVATIDField})();var ee=s(6349),se=s(4044),ie=s(3772),ne=s(1058),ae=s(3194);function oe(t,e){if(1&t&&(u.TgZ(0,"div",19)(1,"div",20),u._uU(2),u.qZA(),u.TgZ(3,"div",21),u._uU(4),u.qZA()()),2&t){const t=e.$implicit;u.xp6(2),u.Oqu(t.nace),u.xp6(2),u.Oqu(t.label)}}let ce=(()=>{var t;class AccountNACELoader{constructor(t,e,s){(0,i.Z)(this,"language",void 0),(0,i.Z)(this,"modal",void 0),(0,i.Z)(this,"backend",void 0),(0,i.Z)(this,"nacecoedsraw",void 0),(0,i.Z)(this,"levels",1),(0,i.Z)(this,"treename","industrycodes"),(0,i.Z)(this,"labelprefix","LBL_NACE_"),this.language=t,this.modal=e,this.backend=s}ngOnInit(){this.backend.getRequest("common/nace").subscribe({next:t=>{if(t&&t.length>0){let e=t.map((t=>({value:t,display:t})));this.modal.prompt("input",null,"select codes file","shade",null,e).subscribe({next:t=>{this.backend.getRequest("common/nace/"+t).subscribe({next:t=>{this.nacecoedsraw=t.content}})}})}}})}get parsedCodes(){if(!this.nacecoedsraw)return[];let t=[],e=this.nacecoedsraw.replace(/"/g,"").split(/\r?\n/);for(let s of e){let e=s.split(";");(0,ee.i2)(parseInt(e[0],10))||parseInt(e[0],10)>this.levels||t.push({level:e[0],nace:e[1],label:e[3]})}return t}save(){this.backend.postRequest("common/nace",{},{treename:this.treename,labelprefix:this.labelprefix,nacecodes:this.parsedCodes}).subscribe({next:()=>{console.log("OK")}})}}return t=AccountNACELoader,(0,i.Z)(AccountNACELoader,"ɵfac",(function(e){return new(e||t)(u.Y36(f.d),u.Y36(se.o),u.Y36(h.y))})),(0,i.Z)(AccountNACELoader,"ɵcmp",u.Xpm({type:t,selectors:[["account-nace-loadser"]],decls:27,vars:5,consts:[[1,"slds-grid","slds-grid_vertical-align-center","slds-p-around--small","slds-border--bottom"],["sprite","custom","icon","custom32"],[1,"slds-text-heading_medium"],["label","LBL_LOAD_NACE_CODES"],[1,"slds-col--bump-left","slds-grid","slds-grid--vertical-align-center"],["label","LBL_LEVELS"],[1,"slds-select_container","slds-m-horizontal--x-small"],[1,"slds-select",3,"ngModel","ngModelChange"],["label","LBL_TREENAME"],[1,"slds-m-horizontal--x-small",3,"ngModel","ngModelChange"],[1,"slds-button","slds-button--brand",3,"disabled","click"],["label","LBL_GENERATE"],["system-to-bottom-noscroll","",1,"slds-theme--default","slds-grid"],[1,"slds-size--1-of-2"],[1,"slds-form-element"],["system-to-bottom","",1,"slds-form-element__control"],[1,"slds-textarea",2,"height","calc(100% - 5px)",3,"ngModel","ngModelChange"],["system-to-bottom","",1,"slds-size--1-of-2","slds-p-horizontal--xx-small"],["class","slds-grid",4,"ngFor","ngForOf"],[1,"slds-grid"],[1,"slds-size--1-of-4"],[1,"slds-size--3-of-4"]],template:function(t,e){1&t&&(u.TgZ(0,"div",0),u._UZ(1,"system-icon",1),u.TgZ(2,"h2",2),u._UZ(3,"system-label",3),u.qZA(),u.TgZ(4,"div",4),u._UZ(5,"system-label",5),u.TgZ(6,"div",6)(7,"select",7),u.NdJ("ngModelChange",(function(t){return e.levels=t})),u.TgZ(8,"option"),u._uU(9,"1"),u.qZA(),u.TgZ(10,"option"),u._uU(11,"2"),u.qZA(),u.TgZ(12,"option"),u._uU(13,"3"),u.qZA(),u.TgZ(14,"option"),u._uU(15,"4"),u.qZA()()(),u._UZ(16,"system-label",8),u.TgZ(17,"system-input-text",9),u.NdJ("ngModelChange",(function(t){return e.treename=t})),u.qZA(),u.TgZ(18,"button",10),u.NdJ("click",(function(){return e.save()})),u._UZ(19,"system-label",11),u.qZA()()(),u.TgZ(20,"div",12)(21,"div",13)(22,"div",14)(23,"div",15)(24,"textarea",16),u.NdJ("ngModelChange",(function(t){return e.nacecoedsraw=t})),u.qZA()()()(),u.TgZ(25,"div",17),u.YNc(26,oe,5,2,"div",18),u.qZA()()),2&t&&(u.xp6(7),u.Q6J("ngModel",e.levels),u.xp6(10),u.Q6J("ngModel",e.treename),u.xp6(1),u.Q6J("disabled",0==e.parsedCodes.length||!e.treename),u.xp6(6),u.Q6J("ngModel",e.nacecoedsraw),u.xp6(2),u.Q6J("ngForOf",e.parsedCodes))},dependencies:[n.sg,a.YN,a.Kr,a.Fj,a.EJ,a.JJ,a.On,Tt.f,ie.Z,v._,ne.H,ae.t],encapsulation:2})),AccountNACELoader})(),de=(()=>{var t;class ModuleAccounts{}return t=ModuleAccounts,(0,i.Z)(ModuleAccounts,"ɵfac",(function(e){return new(e||t)})),(0,i.Z)(ModuleAccounts,"ɵmod",u.oAB({type:t})),(0,i.Z)(ModuleAccounts,"ɵinj",u.cJS({providers:[g],imports:[n.ez,a.u5,c.ObjectFields,d.GlobalComponents,l.ObjectComponents,r.SystemComponents,o.o]})),ModuleAccounts})();("undefined"==typeof ngJitMode||ngJitMode)&&u.kYT(de,{declarations:[I,M,J,L,K,et,j,xt,ot,Zt,St,Qt,te,ce],imports:[n.ez,a.u5,c.ObjectFields,d.GlobalComponents,l.ObjectComponents,r.SystemComponents,o.o]})}}]);