/*!
 * 
 *                     aacService
 *
 *                     release: 2023.02.001
 *
 *                     date: 2023-08-14 15:46:31
 *
 *                     build: 2023.02.001.1692020791886
 *
 */
"use strict";(self.webpackChunkcore=self.webpackChunkcore||[]).push([["src_modules_spiceimports_modulespiceimports_ts"],{9678:(t,e,s)=>{s.r(e),s.d(e,{ModuleSpiceImports:()=>w});var i=s(1180),o=s(4755),l=s(5030),n=s(3190),r=s(4826),a=s(6490),c=s(3735),d=s(2242),p=s(4505);let m=(()=>{var t;class spiceimportsservice{constructor(t){(0,i.Z)(this,"backend",void 0),(0,i.Z)(this,"isloading",!1),(0,i.Z)(this,"isloadingLogs",!1),(0,i.Z)(this,"canLoadMore",!0),(0,i.Z)(this,"activeimportdata",void 0),(0,i.Z)(this,"activeLogName",void 0),(0,i.Z)(this,"loadLimit",25),(0,i.Z)(this,"activeimportdata$",new d.vpe),(0,i.Z)(this,"items",[]),(0,i.Z)(this,"activeItemLogs",void 0),this.backend=t}get activeImportData(){return this.activeimportdata}set activeImportData(t){this.activeimportdata=t,this.activeimportdata$.emit(t)}getItemLogs(){this.activeItemLogs=void 0,this.isloadingLogs=!0,this.backend.getRequest(`module/SpiceImports/${this.activeImportData.id}/logs`).subscribe((t=>{t.map((t=>t.data=t.data.split('";"'))),this.activeItemLogs=t,this.isloadingLogs=!1}))}loadData(){this.isloading=!0,this.backend.getRequest("module/SpiceImports",{orderby:"date_entered DESC",limit:this.loadLimit,offset:0,fields:"*"}).subscribe((t=>{this.parseItemsStatus(t.list),this.items=t.list,this.isloading=!1}))}loadMoreData(){if(this.isloading||!this.canLoadMore)return!1;this.isloading=!0,this.backend.getRequest("module/SpiceImports",{orderby:"date_entered DESC",limit:this.loadLimit,offset:this.items.length,fields:"*"}).subscribe((t=>{this.parseItemsStatus(t.list),this.items=this.items.concat(t.list),t.list.length<this.loadLimit&&(this.canLoadMore=!1),this.isloading=!1}))}deleteImport(){this.items.every((t=>{let e=this.items.indexOf(t);return t.id==this.activeImportData.id&&this.items.splice(e,1),!0}))}parseItemsStatus(t){t.map((t=>{let e=JSON.parse(t.data);switch(t.status){case"c":"new"==e.importAction?t.statusdisplay="LBL_IMPORTED":t.statusdisplay="LBL_UPDATED";break;case"e":"new"==e.importAction?t.statusdisplay="LBL_IMPORTED":t.statusdisplay="LBL_UPDATE_FAILED";break;default:t.statusdisplay="LBL_SCHEDULED"}return t}))}}return t=spiceimportsservice,(0,i.Z)(spiceimportsservice,"ɵfac",(function(e){return new(e||t)(d.LFG(p.y))})),(0,i.Z)(spiceimportsservice,"ɵprov",d.Yz7({token:t,factory:t.ɵfac})),spiceimportsservice})();var u=s(5329),g=s(6898),v=s(3463),h=s(4664),f=s(4561);const Z=function(t){return{"slds-theme_shade":t}};let b=(()=>{var t;class SpiceImportsListItem{constructor(t,e){(0,i.Z)(this,"language",void 0),(0,i.Z)(this,"spiceimportsservice",void 0),(0,i.Z)(this,"item",void 0),this.language=t,this.spiceimportsservice=e}}return t=SpiceImportsListItem,(0,i.Z)(SpiceImportsListItem,"ɵfac",(function(e){return new(e||t)(d.Y36(u.d),d.Y36(m))})),(0,i.Z)(SpiceImportsListItem,"ɵcmp",d.Xpm({type:t,selectors:[["spice-imports-list-item"]],inputs:{item:"item"},decls:15,vars:13,consts:[[1,"slds-p-around--medium","slds-border--bottom","slds-border--right","slds-grid",2,"cursor","pointer",3,"ngClass","click"],[1,"slds-icon_container","slds-col","slds-size--1-of-12",3,"title"],["size","medium",3,"module"],[1,"slds-col","slds-size--11-of-12"],[1,"slds-grid","slds-grid--align-spread"],[1,"slds-text-title_caps"],[1,"slds-col--bump-left","slds-truncate"],[1,"slds-truncate"]],template:function(t,e){1&t&&(d.TgZ(0,"div",0),d.NdJ("click",(function(){return e.spiceimportsservice.activeImportData={id:e.item.id,name:e.item.name}})),d.TgZ(1,"div",1),d._UZ(2,"system-icon",2),d.qZA(),d.TgZ(3,"div",3)(4,"div",4)(5,"div",5),d._uU(6),d.qZA(),d.TgZ(7,"div",6),d._uU(8),d.ALo(9,"slice"),d.qZA()(),d.TgZ(10,"div",4)(11,"div",7),d._uU(12),d.qZA(),d.TgZ(13,"div",6),d._uU(14),d.qZA()()()()),2&t&&(d.Q6J("ngClass",d.VKq(11,Z,(null==e.spiceimportsservice.activeImportData?null:e.spiceimportsservice.activeImportData.id)==e.item.id)),d.xp6(1),d.s9C("title",e.item.model),d.xp6(1),d.Q6J("module",e.item.module),d.xp6(4),d.Oqu(e.item.name),d.xp6(2),d.Oqu(d.Dn7(9,7,e.item.date_entered,0,16)),d.xp6(4),d.Oqu(e.language.getLabel(e.item.statusdisplay)),d.xp6(2),d.Oqu(e.item.created_by_name))},dependencies:[o.mk,f.f,o.OU],encapsulation:2})),SpiceImportsListItem})();const L=["listcontainer"];function I(t,e){if(1&t&&(d.TgZ(0,"option",12),d._UZ(1,"system-label",13),d.qZA()),2&t){const t=e.$implicit;d.Q6J("value",t.value),d.xp6(1),d.Q6J("label",t.label)}}function _(t,e){1&t&&(d.TgZ(0,"div",14)(1,"span"),d._UZ(2,"system-label",15),d.qZA()())}function S(t,e){if(1&t&&d._UZ(0,"spice-imports-list-item",16),2&t){const t=e.$implicit;d.Q6J("item",t)}}function x(t,e){1&t&&d._UZ(0,"system-spinner")}let y=(()=>{var t;class SpiceImportsList{constructor(t,e){(0,i.Z)(this,"language",void 0),(0,i.Z)(this,"spiceimportsservice",void 0),(0,i.Z)(this,"listcontainer",void 0),(0,i.Z)(this,"filtermodule",""),(0,i.Z)(this,"filterstatus",""),(0,i.Z)(this,"filterstatusoptions",[]),this.language=t,this.spiceimportsservice=e,this.filterstatusoptions.push({value:"c",label:"LBL_IMPORTED"},{value:"q",label:"LBL_SCHEDULED"},{value:"e",label:"LBL_ERROR"})}listStyle(){return{height:"calc(100vh - "+this.listcontainer.element.nativeElement.getBoundingClientRect().top+"px)"}}get items(){return this.filtermodule&&this.filterstatus?this.spiceimportsservice.items.filter((t=>t.module===this.filtermodule&&t.status===this.filterstatus)):this.filtermodule?this.spiceimportsservice.items.filter((t=>t.module===this.filtermodule)):this.filterstatus?this.spiceimportsservice.items.filter((t=>t.status===this.filterstatus)):this.spiceimportsservice.items}onScroll(t){let e=this.listcontainer.element.nativeElement;e.scrollTop+e.clientHeight+50>e.scrollHeight&&this.spiceimportsservice.loadMoreData()}}return t=SpiceImportsList,(0,i.Z)(SpiceImportsList,"ɵfac",(function(e){return new(e||t)(d.Y36(u.d),d.Y36(m))})),(0,i.Z)(SpiceImportsList,"ɵcmp",d.Xpm({type:t,selectors:[["spice-imports-list"]],viewQuery:function(t,e){if(1&t&&d.Gf(L,7,d.s_b),2&t){let t;d.iGM(t=d.CRH())&&(e.listcontainer=t.first)}},decls:12,vars:8,consts:[[1,"slds-p-around--xx-small","slds-grid","slds-grid--vertical-align-center"],["label","LBL_MODULE"],[1,"slds-select",3,"ngModel","displayEmptyOption","ngModelChange"],["label","LBL_STATUS"],[1,"slds-select",3,"ngModel","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"slds-scrollable--y",3,"ngStyle","scroll"],["listcontainer",""],["class","slds-text-align_center slds-p-vertical--medium",4,"ngIf"],[3,"item",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"value"],[3,"label"],[1,"slds-text-align_center","slds-p-vertical--medium"],["label","LBL_NO_ENTRIES"],[3,"item"]],template:function(t,e){1&t&&(d.TgZ(0,"div",0),d._UZ(1,"system-label",1),d.TgZ(2,"system-input-module",2),d.NdJ("ngModelChange",(function(t){return e.filtermodule=t})),d.qZA(),d._UZ(3,"system-label",3),d.TgZ(4,"select",4),d.NdJ("ngModelChange",(function(t){return e.filterstatus=t})),d._UZ(5,"option",5),d.YNc(6,I,2,2,"option",6),d.qZA()(),d.TgZ(7,"div",7,8),d.NdJ("scroll",(function(t){return e.onScroll(t)})),d.YNc(9,_,3,0,"div",9),d.YNc(10,S,1,1,"spice-imports-list-item",10),d.YNc(11,x,1,0,"system-spinner",11),d.qZA()),2&t&&(d.xp6(2),d.Q6J("ngModel",e.filtermodule)("displayEmptyOption",!0),d.xp6(2),d.Q6J("ngModel",e.filterstatus),d.xp6(2),d.Q6J("ngForOf",e.filterstatusoptions),d.xp6(1),d.Q6J("ngStyle",e.listStyle()),d.xp6(2),d.Q6J("ngIf",!e.spiceimportsservice.isloading&&0==(null==e.items?null:e.items.length)),d.xp6(1),d.Q6J("ngForOf",e.items),d.xp6(1),d.Q6J("ngIf",e.spiceimportsservice.isloading))},dependencies:[o.sg,o.O5,o.PC,l.YN,l.Kr,l.EJ,l.JJ,l.On,g.a,v._,h.W,b],encapsulation:2})),SpiceImportsList})();var E=s(4044),T=s(3278),O=s(2656);const D=["logscontainer"];function q(t,e){if(1&t){const t=d.EpF();d.TgZ(0,"button",9),d.NdJ("click",(function(){d.CHM(t);const e=d.oxw();return d.KtG(e.delete())})),d._UZ(1,"system-label",10),d.qZA()}}function J(t,e){1&t&&(d.TgZ(0,"div",11),d._UZ(1,"system-label",12),d.qZA())}function A(t,e){1&t&&(d.TgZ(0,"div",11),d._UZ(1,"system-label",13),d.qZA())}function M(t,e){1&t&&d._UZ(0,"system-spinner")}function N(t,e){if(1&t&&(d.TgZ(0,"div",19)(1,"button",20),d._UZ(2,"system-button-icon",21),d.qZA()()),2&t){const t=d.oxw().$implicit,e=d.oxw();d.xp6(2),d.Q6J("icon",e.getButtonicon(t.id))}}function U(t,e){if(1&t&&(d.TgZ(0,"tr")(1,"td",23),d._uU(2),d.qZA(),d.TgZ(3,"td",23),d._uU(4),d.qZA()()),2&t){const t=e.$implicit,s=e.index,i=d.oxw(3);d.xp6(2),d.Oqu(i.itemHeader[s]),d.xp6(2),d.Oqu(t)}}function C(t,e){if(1&t&&(d.TgZ(0,"table",22)(1,"tbody"),d.YNc(2,U,5,2,"tr",8),d.qZA()()),2&t){const t=d.oxw().$implicit;d.xp6(2),d.Q6J("ngForOf",t.data)}}function Y(t,e){if(1&t){const t=d.EpF();d.TgZ(0,"div")(1,"div",14),d.NdJ("click",(function(){const e=d.CHM(t).$implicit,s=d.oxw();return d.KtG(s.toggleOpen(e.id))})),d.TgZ(2,"div",15),d._uU(3),d.qZA(),d.TgZ(4,"div",16),d._uU(5),d.qZA(),d.YNc(6,N,3,1,"div",17),d.qZA(),d.YNc(7,C,3,1,"table",18),d.qZA()}if(2&t){const t=e.$implicit,s=d.oxw();d.xp6(3),d.hij(" ",t.msg," "),d.xp6(1),d.Q6J("hidden",s.opened&&t.id==s.activeLogId&&s.itemHeader),d.xp6(1),d.hij(" ",t.data.join(" , ")," "),d.xp6(1),d.Q6J("ngIf",s.itemHeader),d.xp6(1),d.Q6J("ngIf",s.opened&&t.id==s.activeLogId&&s.itemHeader)}}let Q=(()=>{var t;class Spiceimportslogs{constructor(t,e,s,o,l){(0,i.Z)(this,"language",void 0),(0,i.Z)(this,"modal",void 0),(0,i.Z)(this,"backend",void 0),(0,i.Z)(this,"toast",void 0),(0,i.Z)(this,"spiceimportsservice",void 0),(0,i.Z)(this,"logscontainer",void 0),(0,i.Z)(this,"itemHeader",void 0),(0,i.Z)(this,"activeLogId",void 0),(0,i.Z)(this,"activelogname",void 0),(0,i.Z)(this,"opened",!1),this.language=t,this.modal=e,this.backend=s,this.toast=o,this.spiceimportsservice=l,this.spiceimportsservice.activeimportdata$.subscribe((t=>{t&&(this.activeLogName=t.name,this.spiceimportsservice.getItemLogs(),this.setItemHeader(t.id)),this.opened=!1}))}get itemLogs(){return this.spiceimportsservice.activeItemLogs}get activeLogName(){return this.activelogname}set activeLogName(t){this.activelogname=t}getButtonicon(t){return this.opened&&this.activeLogId==t?"chevronup":"chevrondown"}setItemHeader(t){this.spiceimportsservice.items.some((e=>{let s=JSON.parse(e.data);return e.id==t&&(this.itemHeader=s.fileHeader),!0}))}mainStyle(){return{height:"calc(100vh - "+this.logscontainer.element.nativeElement.getBoundingClientRect().top+"px)",overflow:"auto"}}toggleOpen(t){this.opened&&t!=this.activeLogId||(this.opened=!this.opened),this.activeLogId=t}delete(){this.modal.confirm(this.language.getLabel("MSG_DELETE_RECORD","","long"),this.language.getLabel("MSG_DELETE_RECORD")).subscribe((t=>{t&&this.backend.deleteRequest(`module/SpiceImports/${this.spiceimportsservice.activeImportData.id}`).subscribe((t=>{t?(this.toast.sendToast(this.language.getLabel("MSG_SUCCESSFULLY_DELETED"),"success"),this.spiceimportsservice.deleteImport(),this.resetData()):this.toast.sendToast(this.language.getLabel("ERR_CANT_DELETE"),"error")}))}))}resetData(){this.spiceimportsservice.activeImportData=void 0,this.spiceimportsservice.activeItemLogs=void 0,this.activeLogName=void 0}}return t=Spiceimportslogs,(0,i.Z)(Spiceimportslogs,"ɵfac",(function(e){return new(e||t)(d.Y36(u.d),d.Y36(E.o),d.Y36(p.y),d.Y36(T.A),d.Y36(m))})),(0,i.Z)(Spiceimportslogs,"ɵcmp",d.Xpm({type:t,selectors:[["spice-imports-logs"]],viewQuery:function(t,e){if(1&t&&d.Gf(D,7,d.s_b),2&t){let t;d.iGM(t=d.CRH())&&(e.logscontainer=t.first)}},decls:11,vars:7,consts:[[1,"slds-grid","slds-page-header","slds-p-horizontal--none","slds-p-vertical--xx-small","slds-grid--vertical-align-center",2,"border-radius","0","border-left","0","height","50px"],[1,"slds-text-title_caps","slds-p-left--small"],[1,"slds-p-around_xx-small","slds-col--bump-left"],["class","slds-button slds-button--brand",3,"click",4,"ngIf"],[1,"slds-scrollable--y",3,"ngStyle"],["logscontainer",""],["class","slds-align_absolute-center slds-m-around--xx-large slds-text-heading--medium",4,"ngIf"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"slds-button","slds-button--brand",3,"click"],["label","LBL_DELETE"],[1,"slds-align_absolute-center","slds-m-around--xx-large","slds-text-heading--medium"],["label","MSG_NO_LOGS_FOUND"],["label","LBL_MAKE_SELECTION"],[1,"slds-p-left--small","slds-border--bottom","slds-border--right","slds-grid",2,"cursor","pointer",3,"click"],[1,"slds-p-vertical--small","slds-col","slds-size--2-of-12","slds-border--right"],[1,"slds-p-around--small","slds-col","slds-size--9-of-12","slds-truncate",3,"hidden"],["class","slds-p-around--small slds-size--1-of-12 slds-col_bump-left",4,"ngIf"],["class","slds-table slds-table--bordered slds-table--cell-buffer",4,"ngIf"],[1,"slds-p-around--small","slds-size--1-of-12","slds-col_bump-left"],[1,"slds-button","slds-button_icon"],[3,"icon"],[1,"slds-table","slds-table--bordered","slds-table--cell-buffer"],[1,"slds-truncate"]],template:function(t,e){1&t&&(d.TgZ(0,"div",0)(1,"div",1),d._uU(2),d.qZA(),d.TgZ(3,"div",2),d.YNc(4,q,2,0,"button",3),d.qZA()(),d.TgZ(5,"div",4,5),d.YNc(7,J,2,0,"div",6),d.YNc(8,A,2,0,"div",6),d.YNc(9,M,1,0,"system-spinner",7),d.YNc(10,Y,8,5,"div",8),d.qZA()),2&t&&(d.xp6(2),d.Oqu(e.activeLogName),d.xp6(2),d.Q6J("ngIf",e.activeLogName),d.xp6(1),d.Q6J("ngStyle",e.mainStyle()),d.xp6(2),d.Q6J("ngIf",!e.spiceimportsservice.isloadingLogs&&e.spiceimportsservice.activeImportData&&(null==e.itemLogs?null:e.itemLogs.length)<=0),d.xp6(1),d.Q6J("ngIf",!e.spiceimportsservice.isloadingLogs&&!e.spiceimportsservice.activeImportData),d.xp6(1),d.Q6J("ngIf",e.spiceimportsservice.isloadingLogs),d.xp6(1),d.Q6J("ngForOf",e.itemLogs))},dependencies:[o.sg,o.O5,o.PC,O.J,v._,h.W],encapsulation:2})),Spiceimportslogs})(),k=(()=>{var t;class SpiceImports{constructor(t,e){(0,i.Z)(this,"language",void 0),(0,i.Z)(this,"spiceimportsservice",void 0),this.language=t,this.spiceimportsservice=e}ngOnInit(){this.spiceimportsservice.loadData()}}return t=SpiceImports,(0,i.Z)(SpiceImports,"ɵfac",(function(e){return new(e||t)(d.Y36(u.d),d.Y36(m))})),(0,i.Z)(SpiceImports,"ɵcmp",d.Xpm({type:t,selectors:[["ng-component"]],features:[d._Bn([m])],decls:5,vars:0,consts:[[1,"slds-grid"],[1,"slds-size--1-of-2"],[1,"slds-scrollable"],[1,"slds-size--1-of-2","slds-theme--shade"]],template:function(t,e){1&t&&(d.TgZ(0,"div",0)(1,"spice-imports-list",1),d._UZ(2,"div",2),d.qZA(),d.TgZ(3,"spice-imports-logs",3),d._UZ(4,"div",2),d.qZA()())},dependencies:[y,Q],encapsulation:2})),SpiceImports})(),w=(()=>{var t;class ModuleSpiceImports{}return t=ModuleSpiceImports,(0,i.Z)(ModuleSpiceImports,"ɵfac",(function(e){return new(e||t)})),(0,i.Z)(ModuleSpiceImports,"ɵmod",d.oAB({type:t})),(0,i.Z)(ModuleSpiceImports,"ɵinj",d.cJS({providers:[m],imports:[o.ez,l.u5,n.ObjectFields,r.GlobalComponents,a.ObjectComponents,c.SystemComponents]})),ModuleSpiceImports})();("undefined"==typeof ngJitMode||ngJitMode)&&d.kYT(w,{declarations:[k,y,b,Q],imports:[o.ez,l.u5,n.ObjectFields,r.GlobalComponents,a.ObjectComponents,c.SystemComponents]})}}]);