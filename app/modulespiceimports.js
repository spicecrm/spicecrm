/*!
 * 
 *                     aacService
 *
 *                     release: 2023.03.001
 *
 *                     date: 2024-01-09 16:51:03
 *
 *                     build: 2023.03.001.1704815463270
 *
 */
"use strict";(self.webpackChunkcore=self.webpackChunkcore||[]).push([["src_modules_spiceimports_modulespiceimports_ts"],{69678:(e,t,s)=>{s.r(t),s.d(t,{ModuleSpiceImports:()=>k});var i=s(44755),o=s(95030),l=s(53190),a=s(34826),n=s(19784),c=s(57239),r=s(62242),d=s(14505);let p=(()=>{class spiceimportsservice{backend;isloading=!1;isloadingLogs=!1;canLoadMore=!0;activeimportdata=void 0;activeLogName;loadLimit=25;activeimportdata$=new r.vpe;items=[];activeItemLogs=void 0;constructor(e){this.backend=e}get activeImportData(){return this.activeimportdata}set activeImportData(e){this.activeimportdata=e,this.activeimportdata$.emit(e)}getItemLogs(){this.activeItemLogs=void 0,this.isloadingLogs=!0,this.backend.getRequest(`module/SpiceImports/${this.activeImportData.id}/logs`).subscribe((e=>{e.map((e=>e.data=e.data.split('";"'))),this.activeItemLogs=e,this.isloadingLogs=!1}))}loadData(){this.isloading=!0,this.backend.getRequest("module/SpiceImports",{orderby:"date_entered DESC",limit:this.loadLimit,offset:0,fields:"*"}).subscribe((e=>{this.parseItemsStatus(e.list),this.items=e.list,this.isloading=!1}))}loadMoreData(){if(this.isloading||!this.canLoadMore)return!1;this.isloading=!0,this.backend.getRequest("module/SpiceImports",{orderby:"date_entered DESC",limit:this.loadLimit,offset:this.items.length,fields:"*"}).subscribe((e=>{this.parseItemsStatus(e.list),this.items=this.items.concat(e.list),e.list.length<this.loadLimit&&(this.canLoadMore=!1),this.isloading=!1}))}deleteImport(){this.items.every((e=>{let t=this.items.indexOf(e);return e.id==this.activeImportData.id&&this.items.splice(t,1),!0}))}parseItemsStatus(e){e.map((e=>{let t=JSON.parse(e.data);switch(e.status){case"c":"new"==t.importAction?e.statusdisplay="LBL_IMPORTED":e.statusdisplay="LBL_UPDATED";break;case"e":"new"==t.importAction?e.statusdisplay="LBL_IMPORTED":e.statusdisplay="LBL_UPDATE_FAILED";break;default:e.statusdisplay="LBL_SCHEDULED"}return e}))}static ɵfac=function(e){return new(e||spiceimportsservice)(r.LFG(d.y))};static ɵprov=r.Yz7({token:spiceimportsservice,factory:spiceimportsservice.ɵfac})}return spiceimportsservice})();var m=s(55329),u=s(66898),g=s(83463),v=s(94664),f=s(44561);const h=function(e){return{"slds-theme_shade":e}};let b=(()=>{class SpiceImportsListItem{language;spiceimportsservice;item=void 0;constructor(e,t){this.language=e,this.spiceimportsservice=t}static ɵfac=function(e){return new(e||SpiceImportsListItem)(r.Y36(m.d),r.Y36(p))};static ɵcmp=r.Xpm({type:SpiceImportsListItem,selectors:[["spice-imports-list-item"]],inputs:{item:"item"},decls:15,vars:13,consts:[[1,"slds-p-around--medium","slds-border--bottom","slds-border--right","slds-grid",2,"cursor","pointer",3,"ngClass","click"],[1,"slds-icon_container","slds-col","slds-size--1-of-12",3,"title"],["size","medium",3,"module"],[1,"slds-col","slds-size--11-of-12"],[1,"slds-grid","slds-grid--align-spread"],[1,"slds-text-title_caps"],[1,"slds-col--bump-left","slds-truncate"],[1,"slds-truncate"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.NdJ("click",(function(){return t.spiceimportsservice.activeImportData={id:t.item.id,name:t.item.name}})),r.TgZ(1,"div",1),r._UZ(2,"system-icon",2),r.qZA(),r.TgZ(3,"div",3)(4,"div",4)(5,"div",5),r._uU(6),r.qZA(),r.TgZ(7,"div",6),r._uU(8),r.ALo(9,"slice"),r.qZA()(),r.TgZ(10,"div",4)(11,"div",7),r._uU(12),r.qZA(),r.TgZ(13,"div",6),r._uU(14),r.qZA()()()()),2&e&&(r.Q6J("ngClass",r.VKq(11,h,(null==t.spiceimportsservice.activeImportData?null:t.spiceimportsservice.activeImportData.id)==t.item.id)),r.xp6(1),r.s9C("title",t.item.model),r.xp6(1),r.Q6J("module",t.item.module),r.xp6(4),r.Oqu(t.item.name),r.xp6(2),r.Oqu(r.Dn7(9,7,t.item.date_entered,0,16)),r.xp6(4),r.Oqu(t.language.getLabel(t.item.statusdisplay)),r.xp6(2),r.Oqu(t.item.created_by_name))},dependencies:[i.mk,f.f,i.OU],encapsulation:2})}return SpiceImportsListItem})();const L=["listcontainer"];function I(e,t){if(1&e&&(r.TgZ(0,"option",11),r._UZ(1,"system-label",12),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.value),r.xp6(1),r.Q6J("label",e.label)}}function _(e,t){1&e&&(r.TgZ(0,"div",13)(1,"span"),r._UZ(2,"system-label",14),r.qZA()())}function Z(e,t){if(1&e&&r._UZ(0,"spice-imports-list-item",15),2&e){const e=t.$implicit;r.Q6J("item",e)}}function S(e,t){1&e&&r._UZ(0,"system-spinner")}let x=(()=>{class SpiceImportsList{language;spiceimportsservice;listcontainer;filtermodule="";filterstatus="";filterstatusoptions=[];constructor(e,t){this.language=e,this.spiceimportsservice=t,this.filterstatusoptions.push({value:"c",label:"LBL_IMPORTED"},{value:"q",label:"LBL_SCHEDULED"},{value:"e",label:"LBL_ERROR"})}listStyle(){return{height:"calc(100vh - "+this.listcontainer.element.nativeElement.getBoundingClientRect().top+"px)"}}get items(){return this.filtermodule&&this.filterstatus?this.spiceimportsservice.items.filter((e=>e.module===this.filtermodule&&e.status===this.filterstatus)):this.filtermodule?this.spiceimportsservice.items.filter((e=>e.module===this.filtermodule)):this.filterstatus?this.spiceimportsservice.items.filter((e=>e.status===this.filterstatus)):this.spiceimportsservice.items}onScroll(e){let t=this.listcontainer.element.nativeElement;t.scrollTop+t.clientHeight+50>t.scrollHeight&&this.spiceimportsservice.loadMoreData()}static ɵfac=function(e){return new(e||SpiceImportsList)(r.Y36(m.d),r.Y36(p))};static ɵcmp=r.Xpm({type:SpiceImportsList,selectors:[["spice-imports-list"]],viewQuery:function(e,t){if(1&e&&r.Gf(L,7,r.s_b),2&e){let e;r.iGM(e=r.CRH())&&(t.listcontainer=e.first)}},decls:12,vars:7,consts:[[1,"slds-p-around--xx-small","slds-grid","slds-grid--vertical-align-center"],["label","LBL_MODULE"],[1,"slds-select",3,"ngModel","ngModelChange"],["label","LBL_STATUS"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"slds-scrollable--y",3,"ngStyle","scroll"],["listcontainer",""],["class","slds-text-align_center slds-p-vertical--medium",4,"ngIf"],[3,"item",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"value"],[3,"label"],[1,"slds-text-align_center","slds-p-vertical--medium"],["label","LBL_NO_ENTRIES"],[3,"item"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r._UZ(1,"system-label",1),r.TgZ(2,"system-input-module",2),r.NdJ("ngModelChange",(function(e){return t.filtermodule=e})),r.qZA(),r._UZ(3,"system-label",3),r.TgZ(4,"select",2),r.NdJ("ngModelChange",(function(e){return t.filterstatus=e})),r._UZ(5,"option",4),r.YNc(6,I,2,2,"option",5),r.qZA()(),r.TgZ(7,"div",6,7),r.NdJ("scroll",(function(e){return t.onScroll(e)})),r.YNc(9,_,3,0,"div",8),r.YNc(10,Z,1,1,"spice-imports-list-item",9),r.YNc(11,S,1,0,"system-spinner",10),r.qZA()),2&e&&(r.xp6(2),r.Q6J("ngModel",t.filtermodule),r.xp6(2),r.Q6J("ngModel",t.filterstatus),r.xp6(2),r.Q6J("ngForOf",t.filterstatusoptions),r.xp6(1),r.Q6J("ngStyle",t.listStyle()),r.xp6(2),r.Q6J("ngIf",!t.spiceimportsservice.isloading&&0==(null==t.items?null:t.items.length)),r.xp6(1),r.Q6J("ngForOf",t.items),r.xp6(1),r.Q6J("ngIf",t.spiceimportsservice.isloading))},dependencies:[i.sg,i.O5,i.PC,o.YN,o.Kr,o.EJ,o.JJ,o.On,u.a,g._,v.W,b],encapsulation:2})}return SpiceImportsList})();var y=s(44044),T=s(13278),E=s(72656);const D=["logscontainer"];function O(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",9),r.NdJ("click",(function(){r.CHM(e);const t=r.oxw();return r.KtG(t.delete())})),r._UZ(1,"system-label",10),r.qZA()}}function q(e,t){1&e&&(r.TgZ(0,"div",11),r._UZ(1,"system-label",12),r.qZA())}function J(e,t){1&e&&(r.TgZ(0,"div",11),r._UZ(1,"system-label",13),r.qZA())}function A(e,t){1&e&&r._UZ(0,"system-spinner")}function N(e,t){if(1&e&&(r.TgZ(0,"div",19)(1,"button",20),r._UZ(2,"system-button-icon",21),r.qZA()()),2&e){const e=r.oxw().$implicit,t=r.oxw();r.xp6(2),r.Q6J("icon",t.getButtonicon(e.id))}}function U(e,t){if(1&e&&(r.TgZ(0,"tr")(1,"td",23),r._uU(2),r.qZA(),r.TgZ(3,"td",23),r._uU(4),r.qZA()()),2&e){const e=t.$implicit,s=t.index,i=r.oxw(3);r.xp6(2),r.Oqu(i.itemHeader[s]),r.xp6(2),r.Oqu(e)}}function C(e,t){if(1&e&&(r.TgZ(0,"table",22)(1,"tbody"),r.YNc(2,U,5,2,"tr",8),r.qZA()()),2&e){const e=r.oxw().$implicit;r.xp6(2),r.Q6J("ngForOf",e.data)}}function M(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div")(1,"div",14),r.NdJ("click",(function(){const t=r.CHM(e).$implicit,s=r.oxw();return r.KtG(s.toggleOpen(t.id))})),r.TgZ(2,"div",15),r._uU(3),r.qZA(),r.TgZ(4,"div",16),r._uU(5),r.qZA(),r.YNc(6,N,3,1,"div",17),r.qZA(),r.YNc(7,C,3,1,"table",18),r.qZA()}if(2&e){const e=t.$implicit,s=r.oxw();r.xp6(3),r.hij(" ",e.msg," "),r.xp6(1),r.Q6J("hidden",s.opened&&e.id==s.activeLogId&&s.itemHeader),r.xp6(1),r.hij(" ",e.data.join(" , ")," "),r.xp6(1),r.Q6J("ngIf",s.itemHeader),r.xp6(1),r.Q6J("ngIf",s.opened&&e.id==s.activeLogId&&s.itemHeader)}}let Y=(()=>{class Spiceimportslogs{language;modal;backend;toast;spiceimportsservice;logscontainer;itemHeader=void 0;activeLogId=void 0;activelogname=void 0;opened=!1;constructor(e,t,s,i,o){this.language=e,this.modal=t,this.backend=s,this.toast=i,this.spiceimportsservice=o,this.spiceimportsservice.activeimportdata$.subscribe((e=>{e&&(this.activeLogName=e.name,this.spiceimportsservice.getItemLogs(),this.setItemHeader(e.id)),this.opened=!1}))}get itemLogs(){return this.spiceimportsservice.activeItemLogs}get activeLogName(){return this.activelogname}set activeLogName(e){this.activelogname=e}getButtonicon(e){return this.opened&&this.activeLogId==e?"chevronup":"chevrondown"}setItemHeader(e){this.spiceimportsservice.items.some((t=>{let s=JSON.parse(t.data);return t.id==e&&(this.itemHeader=s.fileHeader),!0}))}mainStyle(){return{height:"calc(100vh - "+this.logscontainer.element.nativeElement.getBoundingClientRect().top+"px)",overflow:"auto"}}toggleOpen(e){this.opened&&e!=this.activeLogId||(this.opened=!this.opened),this.activeLogId=e}delete(){this.modal.confirm(this.language.getLabel("MSG_DELETE_RECORD","","long"),this.language.getLabel("MSG_DELETE_RECORD")).subscribe((e=>{e&&this.backend.deleteRequest(`module/SpiceImports/${this.spiceimportsservice.activeImportData.id}`).subscribe((e=>{e?(this.toast.sendToast(this.language.getLabel("MSG_SUCCESSFULLY_DELETED"),"success"),this.spiceimportsservice.deleteImport(),this.resetData()):this.toast.sendToast(this.language.getLabel("ERR_CANT_DELETE"),"error")}))}))}resetData(){this.spiceimportsservice.activeImportData=void 0,this.spiceimportsservice.activeItemLogs=void 0,this.activeLogName=void 0}static ɵfac=function(e){return new(e||Spiceimportslogs)(r.Y36(m.d),r.Y36(y.o),r.Y36(d.y),r.Y36(T.A),r.Y36(p))};static ɵcmp=r.Xpm({type:Spiceimportslogs,selectors:[["spice-imports-logs"]],viewQuery:function(e,t){if(1&e&&r.Gf(D,7,r.s_b),2&e){let e;r.iGM(e=r.CRH())&&(t.logscontainer=e.first)}},decls:11,vars:7,consts:[[1,"slds-grid","slds-page-header","slds-p-horizontal--none","slds-p-vertical--xx-small","slds-grid--vertical-align-center",2,"border-radius","0","border-left","0","height","50px"],[1,"slds-text-title_caps","slds-p-left--small"],[1,"slds-p-around_xx-small","slds-col--bump-left"],["class","slds-button slds-button--brand",3,"click",4,"ngIf"],[1,"slds-scrollable--y",3,"ngStyle"],["logscontainer",""],["class","slds-align_absolute-center slds-m-around--xx-large slds-text-heading--medium",4,"ngIf"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"slds-button","slds-button--brand",3,"click"],["label","LBL_DELETE"],[1,"slds-align_absolute-center","slds-m-around--xx-large","slds-text-heading--medium"],["label","MSG_NO_LOGS_FOUND"],["label","LBL_MAKE_SELECTION"],[1,"slds-p-left--small","slds-border--bottom","slds-border--right","slds-grid",2,"cursor","pointer",3,"click"],[1,"slds-p-vertical--small","slds-col","slds-size--2-of-12","slds-border--right"],[1,"slds-p-around--small","slds-col","slds-size--9-of-12","slds-truncate",3,"hidden"],["class","slds-p-around--small slds-size--1-of-12 slds-col_bump-left",4,"ngIf"],["class","slds-table slds-table--bordered slds-table--cell-buffer",4,"ngIf"],[1,"slds-p-around--small","slds-size--1-of-12","slds-col_bump-left"],[1,"slds-button","slds-button_icon"],[3,"icon"],[1,"slds-table","slds-table--bordered","slds-table--cell-buffer"],[1,"slds-truncate"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0)(1,"div",1),r._uU(2),r.qZA(),r.TgZ(3,"div",2),r.YNc(4,O,2,0,"button",3),r.qZA()(),r.TgZ(5,"div",4,5),r.YNc(7,q,2,0,"div",6),r.YNc(8,J,2,0,"div",6),r.YNc(9,A,1,0,"system-spinner",7),r.YNc(10,M,8,5,"div",8),r.qZA()),2&e&&(r.xp6(2),r.Oqu(t.activeLogName),r.xp6(2),r.Q6J("ngIf",t.activeLogName),r.xp6(1),r.Q6J("ngStyle",t.mainStyle()),r.xp6(2),r.Q6J("ngIf",!t.spiceimportsservice.isloadingLogs&&t.spiceimportsservice.activeImportData&&(null==t.itemLogs?null:t.itemLogs.length)<=0),r.xp6(1),r.Q6J("ngIf",!t.spiceimportsservice.isloadingLogs&&!t.spiceimportsservice.activeImportData),r.xp6(1),r.Q6J("ngIf",t.spiceimportsservice.isloadingLogs),r.xp6(1),r.Q6J("ngForOf",t.itemLogs))},dependencies:[i.sg,i.O5,i.PC,E.J,g._,v.W],encapsulation:2})}return Spiceimportslogs})(),Q=(()=>{class SpiceImports{language;spiceimportsservice;constructor(e,t){this.language=e,this.spiceimportsservice=t}ngOnInit(){this.spiceimportsservice.loadData()}static ɵfac=function(e){return new(e||SpiceImports)(r.Y36(m.d),r.Y36(p))};static ɵcmp=r.Xpm({type:SpiceImports,selectors:[["ng-component"]],features:[r._Bn([p])],decls:5,vars:0,consts:[[1,"slds-grid"],[1,"slds-size--1-of-2"],[1,"slds-scrollable"],[1,"slds-size--1-of-2","slds-theme--shade"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0)(1,"spice-imports-list",1),r._UZ(2,"div",2),r.qZA(),r.TgZ(3,"spice-imports-logs",3),r._UZ(4,"div",2),r.qZA()())},dependencies:[x,Y],encapsulation:2})}return SpiceImports})(),k=(()=>{class ModuleSpiceImports{static ɵfac=function(e){return new(e||ModuleSpiceImports)};static ɵmod=r.oAB({type:ModuleSpiceImports});static ɵinj=r.cJS({providers:[p],imports:[i.ez,o.u5,l.ObjectFields,a.GlobalComponents,n.ObjectComponents,c.SystemComponents]})}return ModuleSpiceImports})();("undefined"==typeof ngJitMode||ngJitMode)&&r.kYT(k,{declarations:[Q,x,b,Y],imports:[i.ez,o.u5,l.ObjectFields,a.GlobalComponents,n.ObjectComponents,c.SystemComponents]})}}]);