/*!
 * 
 *                     aacService
 *
 *                     release: 2023.02.001
 *
 *                     date: 2023-08-14 15:46:31
 *
 *                     build: 2023.02.001.1692020791886
 *
 */
"use strict";(self.webpackChunkcore=self.webpackChunkcore||[]).push([["default-src_modules_reports_modulereports_ts"],{8477:(e,t,i)=>{i.d(t,{h:()=>c});var s=i(1180),o=i(2242),r=i(5329),n=i(5710),l=i(4542),a=i(5030),d=i(6822);let c=(()=>{var e;class ReporterFilterItemDate{constructor(e,t,i){(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"model",void 0),(0,s.Z)(this,"reporterconfig",void 0),(0,s.Z)(this,"field",""),(0,s.Z)(this,"wherecondition",{}),(0,s.Z)(this,"fieldDate",new moment),this.language=e,this.model=t,this.reporterconfig=i}ngOnInit(){this.fieldDate=new moment(this.wherecondition[this.field])}get filterValue(){return this.fieldDate}set filterValue(e){this.fieldDate=e,this.wherecondition[this.field]=e.format("YYYY-MM-DD")}}return e=ReporterFilterItemDate,(0,s.Z)(ReporterFilterItemDate,"ɵfac",(function(t){return new(t||e)(o.Y36(r.d),o.Y36(n.o),o.Y36(l.s))})),(0,s.Z)(ReporterFilterItemDate,"ɵcmp",o.Xpm({type:e,selectors:[["reporter-filter-item-date"]],inputs:{field:"field",wherecondition:"wherecondition"},decls:2,vars:1,consts:[[1,"slds-form-element"],[3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(o.TgZ(0,"div",0)(1,"system-input-date",1),o.NdJ("ngModelChange",(function(e){return t.filterValue=e})),o.qZA()()),2&e&&(o.xp6(1),o.Q6J("ngModel",t.filterValue))},dependencies:[a.JJ,a.On,d.z],encapsulation:2})),ReporterFilterItemDate})()},3411:(e,t,i)=>{i.d(t,{i:()=>Z});var s=i(1180),o=i(727),r=i(2242),n=i(4154),l=i(5329),a=i(4505),d=i(4755),c=i(5030),p=i(9503),h=i(8658);function u(e,t){if(1&e&&(r.TgZ(0,"option",7),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("ngValue",e.value),r.xp6(1),r.Oqu(e.display)}}function g(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",3)(1,"div",4)(2,"select",5),r.NdJ("ngModelChange",(function(t){r.CHM(e);const i=r.oxw();return r.KtG(i.value=t)})),r.YNc(3,u,2,2,"option",6),r.qZA()()()}if(2&e){const e=r.oxw();r.xp6(2),r.Q6J("disabled",e.isDisabled)("ngModel",e.value),r.xp6(1),r.Q6J("ngForOf",e.enumOptions)}}function f(e,t){if(1&e&&(r.TgZ(0,"div",11)(1,"system-checkbox-group-checkbox",12)(2,"span",13),r._uU(3),r.qZA()()()),2&e){const e=r.oxw().$implicit;r.Q6J("title",e.display),r.xp6(1),r.Q6J("value",e.value),r.xp6(2),r.Oqu(e.display)}}function m(e,t){if(1&e&&(r.ynx(0),r.YNc(1,f,4,3,"div",10),r.BQk()),2&e){const e=t.$implicit;r.xp6(1),r.Q6J("ngIf",!!e.value)}}function v(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"system-checkbox-group",8),r.NdJ("ngModelChange",(function(t){r.CHM(e);const i=r.oxw();return r.KtG(i.value=t)})),r.YNc(1,m,2,1,"ng-container",9),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("ngModel",e.value),r.xp6(1),r.Q6J("ngForOf",e.enumOptions)}}let Z=(()=>{var e;class ReporterFilterItemEnum{constructor(e,t,i){(0,s.Z)(this,"metadata",void 0),(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"backend",void 0),(0,s.Z)(this,"field",""),(0,s.Z)(this,"isMultiSelect",!1),(0,s.Z)(this,"wherecondition",{}),(0,s.Z)(this,"fieldName",void 0),(0,s.Z)(this,"moduleName",void 0),(0,s.Z)(this,"enumOptions",[]),(0,s.Z)(this,"_value",[]),(0,s.Z)(this,"subscription",new o.w0),this.metadata=e,this.language=t,this.backend=i,this.subscription=this.language.currentlanguage$.subscribe((()=>{this.getEnumOptions()}))}get isDisabled(){return 0==this.enumOptions.length}get value(){return this._value}set value(e){this.isMultiSelect&&(this._value=e,e=e.join(",")),this.wherecondition[this.field]=e,this.wherecondition[this.field+"key"]=this.wherecondition[this.field]}ngOnInit(){let e=this.wherecondition.path.split("::"),t=e.length,i=e[t-1].split(":");this.fieldName=i[1];let s=e[t-2].split(":");switch(s[0]){case"root":this.moduleName=s[1];break;case"link":let e=this.metadata.getFieldDefs(s[1],s[2]);this.moduleName=e.module}this.getEnumOptions(),this.initializeValueArray()}ngOnDestroy(){this.subscription.unsubscribe()}initializeValueArray(){const e=this.wherecondition[this.field+"key"]?this.wherecondition[this.field+"key"]:this.wherecondition[this.field];this._value=this.isMultiSelect?e?e.split(","):[]:e}getEnumOptions(){this.moduleName&&this.fieldName?this.enumOptions=this.language.getFieldDisplayOptions(this.moduleName,this.fieldName,!0):this.backend.getRequest("module/KReports/core/enumoptions",{path:this.wherecondition.path}).subscribe((e=>{e&&0!=e.length&&(this.enumOptions=e.map((e=>({value:e.value,display:e.text}))))}))}ngOnChanges(){this.initializeValueArray()}}return e=ReporterFilterItemEnum,(0,s.Z)(ReporterFilterItemEnum,"ɵfac",(function(t){return new(t||e)(r.Y36(n.Pu),r.Y36(l.d),r.Y36(a.y))})),(0,s.Z)(ReporterFilterItemEnum,"ɵcmp",r.Xpm({type:e,selectors:[["reporter-filter-item-enum"]],inputs:{field:"field",isMultiSelect:"isMultiSelect",wherecondition:"wherecondition"},features:[r.TTD],decls:4,vars:2,consts:[[1,"slds-form-element"],["class","slds-form-element__control",4,"ngIf","ngIfElse"],["checkboxContainer",""],[1,"slds-form-element__control"],[1,"slds-select_container"],[1,"slds-select",3,"disabled","ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"ngValue"],[1,"slds-grid","slds-wrap",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],["class","slds-large-size--1-of-3 slds-medium-size--1-of-1 slds-truncate",3,"title",4,"ngIf"],[1,"slds-large-size--1-of-3","slds-medium-size--1-of-1","slds-truncate",3,"title"],[3,"value"],[1,"slds-m-left--xx-small"]],template:function(e,t){if(1&e&&(r.TgZ(0,"div",0),r.YNc(1,g,4,3,"div",1),r.YNc(2,v,2,2,"ng-template",null,2,r.W1O),r.qZA()),2&e){const e=r.MAs(3);r.xp6(1),r.Q6J("ngIf",!t.isMultiSelect)("ngIfElse",e)}},dependencies:[d.sg,d.O5,c.YN,c.Kr,c.EJ,c.JJ,c.On,p.L,h.m],encapsulation:2})),ReporterFilterItemEnum})()},7832:(e,t,i)=>{i.d(t,{K:()=>c});var s=i(1180),o=i(2242),r=i(5329),n=i(4542),l=i(4755),a=i(5030);function d(e,t){if(1&e&&(o.TgZ(0,"option",5),o._uU(1),o.qZA()),2&e){const e=t.$implicit;o.Q6J("value",e.field),o.xp6(1),o.hij(" ",e.description," ")}}let c=(()=>{var e;class ReporterFilterItemFunction{constructor(e,t){(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"reporterconfig",void 0),(0,s.Z)(this,"whereCondition",{}),this.language=e,this.reporterconfig=t}set functionField(e){this.whereCondition.value=e,this.whereCondition.valuekey=e}get functionField(){return this.whereCondition.value}}return e=ReporterFilterItemFunction,(0,s.Z)(ReporterFilterItemFunction,"ɵfac",(function(t){return new(t||e)(o.Y36(r.d),o.Y36(n.s))})),(0,s.Z)(ReporterFilterItemFunction,"ɵcmp",o.Xpm({type:e,selectors:[["reporter-filter-item-function"]],inputs:{whereCondition:"whereCondition"},decls:5,vars:2,consts:[[1,"slds-form-element"],[1,"slds-form-element__control"],[1,"slds-select_container"],[1,"slds-select",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){1&e&&(o.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"select",3),o.NdJ("ngModelChange",(function(e){return t.functionField=e})),o.YNc(4,d,2,2,"option",4),o.qZA()()()()),2&e&&(o.xp6(3),o.Q6J("ngModel",t.functionField),o.xp6(1),o.Q6J("ngForOf",t.reporterconfig.whereFunctions))},dependencies:[l.sg,a.YN,a.Kr,a.EJ,a.JJ,a.On],encapsulation:2})),ReporterFilterItemFunction})()},5336:(e,t,i)=>{i.d(t,{g:()=>u});var s=i(1180),o=i(727),r=i(2242),n=i(4154),l=i(5329),a=i(4505),d=i(5710),c=i(4755),p=i(5030);function h(e,t){if(1&e&&(r.TgZ(0,"option",5),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.Oqu(e)}}let u=(()=>{var e;class ReporterFilterItemParent{constructor(e,t,i,r){(0,s.Z)(this,"metadata",void 0),(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"backend",void 0),(0,s.Z)(this,"model",void 0),(0,s.Z)(this,"field",""),(0,s.Z)(this,"wherecondition",{}),(0,s.Z)(this,"fieldName",void 0),(0,s.Z)(this,"moduleName",void 0),(0,s.Z)(this,"fields",[]),(0,s.Z)(this,"_value",void 0),(0,s.Z)(this,"subscription",new o.w0),this.metadata=e,this.language=t,this.backend=i,this.model=r,this.getEnumOptions()}get isDisabled(){return 0==this.fields.length}get value(){return this._value}set value(e){this.wherecondition[this.field]=e,this.wherecondition[this.field+"key"]=this.wherecondition[this.field]}ngOnInit(){let e=this.wherecondition.path.split("::"),t=e.length,i=e[t-1].split(":");this.fieldName=i[1];let s=e[t-2].split(":");switch(s[0]){case"root":this.moduleName=s[1];break;case"link":let e=this.metadata.getFieldDefs(s[1],s[2]);this.moduleName=e.module}this.getEnumOptions(),this._value=this.wherecondition[this.field+"key"]?this.wherecondition[this.field+"key"]:this.wherecondition[this.field]}ngOnDestroy(){this.subscription.unsubscribe()}getEnumOptions(){this.fields=[];const e=this.model.getField("integration_params");let t=this.metadata.getModuleFields(e.kpublishing.subpanelModule);for(let e in t)this.fields.push(e);this.fields.sort()}}return e=ReporterFilterItemParent,(0,s.Z)(ReporterFilterItemParent,"ɵfac",(function(t){return new(t||e)(r.Y36(n.Pu),r.Y36(l.d),r.Y36(a.y),r.Y36(d.o))})),(0,s.Z)(ReporterFilterItemParent,"ɵcmp",r.Xpm({type:e,selectors:[["reporter-filter-item-parent"]],inputs:{field:"field",wherecondition:"wherecondition"},decls:5,vars:3,consts:[[1,"slds-form-element"],[1,"slds-form-element__control"],[1,"slds-select_container"],[1,"slds-select",3,"disabled","ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"select",3),r.NdJ("ngModelChange",(function(e){return t.value=e})),r.YNc(4,h,2,2,"option",4),r.qZA()()()()),2&e&&(r.xp6(3),r.Q6J("disabled",t.isDisabled)("ngModel",t.value),r.xp6(1),r.Q6J("ngForOf",t.fields))},dependencies:[c.sg,p.YN,p.Kr,p.EJ,p.JJ,p.On],encapsulation:2})),ReporterFilterItemParent})()},6257:(e,t,i)=>{i.d(t,{W:()=>h});var s=i(1180),o=i(2242),r=i(5329),n=i(4542),l=i(5710),a=i(4755),d=i(5030),c=i(3463);function p(e,t){if(1&e&&(o.TgZ(0,"option",5),o._UZ(1,"system-label",6),o.qZA()),2&e){const e=t.$implicit;o.Q6J("value",e.reference),o.xp6(1),o.Q6J("label",e.reference)}}let h=(()=>{var e;class ReporterFilterItemReference{constructor(e,t,i){(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"reporterConfig",void 0),(0,s.Z)(this,"model",void 0),(0,s.Z)(this,"whereCondition",{}),(0,s.Z)(this,"fieldName",void 0),this.language=e,this.reporterConfig=t,this.model=i}set referenceField(e){this.whereCondition.value=e,this.whereCondition.valuekey=e}get referenceField(){return this.whereCondition.value}get referenceFields(){const e=this.model.getField("whereconditions"),t=this.reporterConfig.operatorAssignments[this.whereCondition.overrideType||this.whereCondition.type]||"varchar";return e.filter((e=>!!e.reference&&(this.reporterConfig.operatorAssignments[e.type]||"varchar")==t&&this.whereCondition.fieldid!=e.fieldid))}ngOnInit(){const e=this.whereCondition.path.split("::");let t=e[e.length-1].split(":");this.fieldName=t[1]}}return e=ReporterFilterItemReference,(0,s.Z)(ReporterFilterItemReference,"ɵfac",(function(t){return new(t||e)(o.Y36(r.d),o.Y36(n.s),o.Y36(l.o))})),(0,s.Z)(ReporterFilterItemReference,"ɵcmp",o.Xpm({type:e,selectors:[["reporter-filter-item-reference"]],inputs:{whereCondition:"whereCondition"},decls:5,vars:2,consts:[[1,"slds-form-element"],[1,"slds-form-element__control"],[1,"slds-select_container"],[1,"slds-select",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[3,"label"]],template:function(e,t){1&e&&(o.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"select",3),o.NdJ("ngModelChange",(function(e){return t.referenceField=e})),o.YNc(4,p,2,2,"option",4),o.qZA()()()()),2&e&&(o.xp6(3),o.Q6J("ngModel",t.referenceField),o.xp6(1),o.Q6J("ngForOf",t.referenceFields))},dependencies:[a.sg,d.YN,d.Kr,d.EJ,d.JJ,d.On,c._],encapsulation:2})),ReporterFilterItemReference})()},8717:(e,t,i)=>{i.d(t,{I:()=>d});var s=i(1180),o=i(2242),r=i(5329),n=i(5710),l=i(4542),a=i(5030);let d=(()=>{var e;class ReporterFilterItemText{constructor(e,t,i){(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"model",void 0),(0,s.Z)(this,"reporterconfig",void 0),(0,s.Z)(this,"field",""),(0,s.Z)(this,"wherecondition",{}),this.language=e,this.model=t,this.reporterconfig=i}}return e=ReporterFilterItemText,(0,s.Z)(ReporterFilterItemText,"ɵfac",(function(t){return new(t||e)(o.Y36(r.d),o.Y36(n.o),o.Y36(l.s))})),(0,s.Z)(ReporterFilterItemText,"ɵcmp",o.Xpm({type:e,selectors:[["reporter-filter-item-text"]],inputs:{field:"field",wherecondition:"wherecondition"},decls:3,vars:1,consts:[[1,"slds-form-element"],[1,"slds-form-element__control"],["type","text",1,"slds-input",3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(o.TgZ(0,"div",0)(1,"div",1)(2,"input",2),o.NdJ("ngModelChange",(function(e){return t.wherecondition[t.field]=e})),o.qZA()()()),2&e&&(o.xp6(2),o.Q6J("ngModel",t.wherecondition[t.field]))},dependencies:[a.Fj,a.JJ,a.On],encapsulation:2})),ReporterFilterItemText})()},429:(e,t,i)=>{i.d(t,{f:()=>c});var s=i(1180),o=i(2242),r=i(4755),n=i(6434),l=i(1512);function a(e,t){if(1&e&&o._UZ(0,"reporter-filter-item-user-single",3),2&e){const e=o.oxw();o.Q6J("whereCondition",e.whereCondition)("fieldName",e.fieldName)}}function d(e,t){if(1&e&&o._UZ(0,"reporter-filter-item-user-multiple",3),2&e){const e=o.oxw();o.Q6J("whereCondition",e.whereCondition)("fieldName",e.fieldName)}}let c=(()=>{var e;class ReporterFilterItemUser{constructor(){(0,s.Z)(this,"whereCondition",{}),(0,s.Z)(this,"fieldName",void 0)}get isMultiSelect(){switch(this.whereCondition.operator){case"oneof":case"oneofnot":case"oneofnotornull":return!0;default:return!1}}ngOnInit(){const e=this.whereCondition.path.split("::");let t=e[e.length-1].split(":");this.fieldName=t[1]}}return e=ReporterFilterItemUser,(0,s.Z)(ReporterFilterItemUser,"ɵfac",(function(t){return new(t||e)})),(0,s.Z)(ReporterFilterItemUser,"ɵcmp",o.Xpm({type:e,selectors:[["reporter-filter-item-user"]],inputs:{whereCondition:"whereCondition"},decls:4,vars:2,consts:[[1,"slds-grid","slds-grid--vertical-align-center"],["class","slds-grid slds-grid--vertical-align-center slds-size--1-of-1",3,"whereCondition","fieldName",4,"ngIf","ngIfElse"],["multipleSelectContainer",""],[1,"slds-grid","slds-grid--vertical-align-center","slds-size--1-of-1",3,"whereCondition","fieldName"]],template:function(e,t){if(1&e&&(o.TgZ(0,"div",0),o.YNc(1,a,1,2,"reporter-filter-item-user-single",1),o.YNc(2,d,1,2,"ng-template",null,2,o.W1O),o.qZA()),2&e){const e=o.MAs(3);o.xp6(1),o.Q6J("ngIf",!t.isMultiSelect)("ngIfElse",e)}},dependencies:[r.O5,n.i,l.Q],encapsulation:2})),ReporterFilterItemUser})()},1512:(e,t,i)=>{i.d(t,{Q:()=>b});var s=i(1180),o=i(2242),r=i(5329),n=i(4044),l=i(5920),a=i(4755),d=i(5030),c=i(2656),p=i(7514),h=i(4561),u=i(3463);function g(e,t){if(1&e&&(o.TgZ(0,"span",23),o._uU(1),o.qZA()),2&e){const e=o.oxw().$implicit;o.xp6(1),o.hij(" ",e," ")}}function f(e,t){if(1&e&&(o.TgZ(0,"span",23),o._uU(1),o.qZA()),2&e){const e=o.oxw(3);o.xp6(1),o.hij(" ",e.activeUserName," ")}}function m(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"li",15)(1,"span",16)(2,"span",17),o._UZ(3,"system-icon",18),o.qZA(),o.YNc(4,g,2,1,"span",19),o.YNc(5,f,2,1,"ng-template",null,20,o.W1O),o.TgZ(7,"span",21)(8,"system-button-icon",22),o.NdJ("click",(function(){const t=o.CHM(e).$implicit,i=o.oxw(2);return o.KtG(i.removeUser(t))})),o.qZA()()()()}if(2&e){const e=t.$implicit,i=o.MAs(6);o.xp6(4),o.Q6J("ngIf","current_user_id"!=e)("ngIfElse",i),o.xp6(4),o.Q6J("icon","close")}}function v(e,t){if(1&e&&(o.TgZ(0,"div",12)(1,"ul",13),o.YNc(2,m,9,3,"li",14),o.qZA()()),2&e){const e=o.oxw();o.xp6(2),o.Q6J("ngForOf",e.value)("ngForTrackBy",e.trackByFn)}}function Z(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"div",24)(1,"div",25)(2,"input",26),o.NdJ("focus",(function(){o.CHM(e);const t=o.oxw();return o.KtG(t.searchWithModal())})),o.qZA(),o.TgZ(3,"button",8),o.NdJ("click",(function(){o.CHM(e);const t=o.oxw();return o.KtG(t.searchWithModal())})),o._UZ(4,"system-button-icon",9),o.qZA()()()}if(2&e){const e=o.oxw();o.xp6(2),o.Q6J("placeholder",e.language.getModuleCombinedLabel("LBL_SEARCH","Users")),o.xp6(2),o.Q6J("icon","search")}}let b=(()=>{var e;class ReporterFilterItemUserMultiple{constructor(e,t,i){(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"modal",void 0),(0,s.Z)(this,"session",void 0),(0,s.Z)(this,"whereCondition",{}),(0,s.Z)(this,"fieldName",void 0),(0,s.Z)(this,"activeUserName",""),this.language=e,this.modal=t,this.session=i}get activeUser(){return this.whereCondition.value.indexOf("current_user_id")>-1}set activeUser(e){this.value=e?[...this.whereCondition.value,"current_user_id"]:this.whereCondition.value.filter((e=>"current_user_id"!=e)).slice()}get value(){return this.whereCondition.value}set value(e){e&&0!=e.length&&(this.whereCondition.value=e,this.whereCondition.valueinit=e.join(","))}ngOnInit(){this.activeUserName=this.session.authData.userName}trackByFn(e,t){return t}removeUser(e){this.value=this.whereCondition.value.filter((t=>t!=e)).slice()}searchWithModal(){this.modal.openModal("ObjectModalModuleLookup").subscribe((e=>{e.instance.module="Users",e.instance.multiselect=!0,e.instance.selectedItems.subscribe((e=>{e.length&&(this.value=e.map((e=>e.user_name)))}))}))}}return e=ReporterFilterItemUserMultiple,(0,s.Z)(ReporterFilterItemUserMultiple,"ɵfac",(function(t){return new(t||e)(o.Y36(r.d),o.Y36(n.o),o.Y36(l.n))})),(0,s.Z)(ReporterFilterItemUserMultiple,"ɵcmp",o.Xpm({type:e,selectors:[["reporter-filter-item-user-multiple"]],inputs:{whereCondition:"whereCondition",fieldName:"fieldName"},decls:13,vars:4,consts:[[1,"slds-form-element","slds-grow"],[1,"slds-form-element__control","slds-size--1-of-1"],[1,"slds-combobox_container"],["role","combobox",1,"slds-combobox","slds-dropdown-trigger","slds-dropdown-trigger_click"],["role","none",1,"slds-combobox__form-element","slds-input-has-icon","slds-input-has-icon_right"],["class","slds-pill_container",4,"ngIf","ngIfElse"],["inputContainer",""],[1,"slds-grow"],[1,"slds-button","slds-button_icon","slds-input__icon","slds-input__icon_right",3,"click"],[3,"icon"],[1,"slds-m-left--x-small",3,"ngModel","ngModelChange"],["label","LBL_ACTIVE_USER"],[1,"slds-pill_container"],["role","listbox",1,"slds-listbox","slds-listbox_horizontal"],["class","slds-listbox-item","role","presentation",4,"ngFor","ngForOf","ngForTrackBy"],["role","presentation",1,"slds-listbox-item"],["role","option",1,"slds-pill"],[1,"slds-icon_container"],["module","Users","size","x-small","divClass","slds-p-right--x-small"],["class","slds-pill__label",4,"ngIf","ngIfElse"],["currentUserContainer",""],[1,"slds-icon_container","slds-pill__remove"],[3,"icon","click"],[1,"slds-pill__label"],[1,"slds-form-element__control","slds-grid","slds-box--border"],[1,"slds-input-has-icon","slds-input-has-icon--right","slds-grow"],["type","text","autocomplete","none","role","combobox",1,"slds-lookup__search-input","slds-input--bare","slds-theme--default",3,"placeholder","focus"]],template:function(e,t){if(1&e&&(o.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),o.YNc(5,v,3,2,"div",5),o.YNc(6,Z,5,2,"ng-template",null,6,o.W1O),o.TgZ(8,"div",7)(9,"button",8),o.NdJ("click",(function(){return t.searchWithModal()})),o._UZ(10,"system-button-icon",9),o.qZA()()()()()()(),o.TgZ(11,"system-checkbox",10),o.NdJ("ngModelChange",(function(e){return t.activeUser=e})),o._UZ(12,"system-label",11),o.qZA()),2&e){const e=o.MAs(7);o.xp6(5),o.Q6J("ngIf",t.value.length>0)("ngIfElse",e),o.xp6(5),o.Q6J("icon","search"),o.xp6(1),o.Q6J("ngModel",t.activeUser)}},dependencies:[a.sg,a.O5,d.JJ,d.On,c.J,p.U,h.f,u._],encapsulation:2})),ReporterFilterItemUserMultiple})()},6434:(e,t,i)=>{i.d(t,{i:()=>Z});var s=i(1180),o=i(2242),r=i(5329),n=i(4044),l=i(5920),a=i(4755),d=i(5030),c=i(2656),p=i(7514),h=i(4561),u=i(3463);function g(e,t){if(1&e&&(o.TgZ(0,"span",18),o._uU(1),o.qZA()),2&e){const e=o.oxw(2);o.xp6(1),o.hij(" ",e.value," ")}}function f(e,t){if(1&e&&(o.TgZ(0,"span",18),o._uU(1),o.qZA()),2&e){const e=o.oxw(2);o.xp6(1),o.hij(" ",e.activeUserName," ")}}function m(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"div",9)(1,"div",10)(2,"span",11)(3,"span",12),o._UZ(4,"system-icon",13),o.qZA(),o.YNc(5,g,2,1,"span",14),o.YNc(6,f,2,1,"ng-template",null,15,o.W1O),o.TgZ(8,"button",16),o.NdJ("click",(function(){o.CHM(e);const t=o.oxw();return o.KtG(t.clearField())})),o._UZ(9,"system-button-icon",17),o.qZA()()()()}if(2&e){const e=o.MAs(7),t=o.oxw();o.xp6(5),o.Q6J("ngIf","current_user_id"!=t.value)("ngIfElse",e),o.xp6(4),o.Q6J("icon","close")}}function v(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"div",19)(1,"div",20)(2,"input",21),o.NdJ("focus",(function(){o.CHM(e);const t=o.oxw();return o.KtG(t.searchWithModal())})),o.qZA(),o.TgZ(3,"button",22),o.NdJ("click",(function(){o.CHM(e);const t=o.oxw();return o.KtG(t.searchWithModal())})),o._UZ(4,"system-button-icon",17),o.qZA()()()}if(2&e){const e=o.oxw();o.xp6(2),o.Q6J("placeholder",e.language.getModuleCombinedLabel("LBL_SEARCH","Users")),o.xp6(2),o.Q6J("icon","search")}}let Z=(()=>{var e;class ReporterFilterItemUserSingle{constructor(e,t,i){(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"modal",void 0),(0,s.Z)(this,"session",void 0),(0,s.Z)(this,"whereCondition",{}),(0,s.Z)(this,"fieldName",void 0),(0,s.Z)(this,"activeUserName",""),this.language=e,this.modal=t,this.session=i}get activeUser(){return this.whereCondition.value.indexOf("current_user_id")>-1}set activeUser(e){this.value=e?["current_user_id"]:[""]}get value(){return this.whereCondition.value}set value(e){e&&0!=e.length&&(this.whereCondition.valuekey=e[0],this.whereCondition.value=e[0])}ngOnInit(){this.activeUserName=this.session.authData.userName}clearField(){this.whereCondition.value="",this.whereCondition.valuekey=""}searchWithModal(){this.modal.openModal("ObjectModalModuleLookup").subscribe((e=>{e.instance.module="Users",e.instance.multiselect=!1,e.instance.selectedItems.subscribe((e=>{e.length&&(this.value=e.map((e=>e.user_name)))}))}))}}return e=ReporterFilterItemUserSingle,(0,s.Z)(ReporterFilterItemUserSingle,"ɵfac",(function(t){return new(t||e)(o.Y36(r.d),o.Y36(n.o),o.Y36(l.n))})),(0,s.Z)(ReporterFilterItemUserSingle,"ɵcmp",o.Xpm({type:e,selectors:[["reporter-filter-item-user-single"]],inputs:{whereCondition:"whereCondition",fieldName:"fieldName"},decls:10,vars:3,consts:[[1,"slds-form-element","slds-grow"],[1,"slds-form-element__control","slds-size--1-of-1"],[1,"slds-combobox_container"],[1,"slds-form-element","slds-lookup"],["role","combobox",1,"slds-combobox","slds-dropdown-trigger","slds-dropdown-trigger_click"],["class","slds-form-element__control",4,"ngIf","ngIfElse"],["inputContainer",""],[1,"slds-m-left--x-small",3,"ngModel","ngModelChange"],["label","LBL_ACTIVE_USER"],[1,"slds-form-element__control"],[1,"slds-pill_container"],[1,"slds-pill","slds-size--1-of-1"],[1,"slds-icon_container","slds-icon-standard-account","slds-pill__icon_container"],["module","Users","size","small"],["class","slds-pill__label",4,"ngIf","ngIfElse"],["currentUserContainer",""],[1,"slds-button","slds-button--icon","slds-pill__remove",3,"click"],[3,"icon"],[1,"slds-pill__label"],[1,"slds-form-element__control","slds-grid","slds-box--border"],[1,"slds-input-has-icon","slds-input-has-icon--right","slds-grow"],["type","text","autocomplete","none","role","combobox",1,"slds-lookup__search-input","slds-input--bare","slds-theme--default",3,"placeholder","focus"],[1,"slds-button","slds-button_icon","slds-input__icon","slds-input__icon_right",3,"click"]],template:function(e,t){if(1&e&&(o.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),o.YNc(5,m,10,3,"div",5),o.YNc(6,v,5,2,"ng-template",null,6,o.W1O),o.qZA()()()()(),o.TgZ(8,"system-checkbox",7),o.NdJ("ngModelChange",(function(e){return t.activeUser=e})),o._UZ(9,"system-label",8),o.qZA()),2&e){const e=o.MAs(7);o.xp6(5),o.Q6J("ngIf",!!t.value)("ngIfElse",e),o.xp6(3),o.Q6J("ngModel",t.activeUser)}},dependencies:[a.O5,d.JJ,d.On,c.J,p.U,h.f,u._],encapsulation:2})),ReporterFilterItemUserSingle})()},6820:(e,t,i)=>{i.r(t),i.d(t,{ModuleReports:()=>hi});var s=i(1180),o=i(4755),r=i(5030),n=i(3190),l=i(6490),a=i(3735),d=i(4357),c=i(3418),p=i(2242),h=i(5710),u=i(4542),g=i(1591),f=i(2294),m=i(727),v=i(3369),Z=i(5329),b=i(4154),w=i(4505),y=i(3348),x=i(7017),F=i(3194),R=i(2613),C=i(8861),k=i(5931),I=i(4778),T=i(4561),D=i(3333),J=i(3814),A=i(2656),M=i(3463);const Y=["actionitems"];let q=(()=>{var e;class ReporterFilterButton{constructor(e,t){(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"reporterconfig",void 0),(0,s.Z)(this,"actionitems",void 0),(0,s.Z)(this,"whereConditions",{}),(0,s.Z)(this,"hasUserFilters",!1),(0,s.Z)(this,"showFilters",!1),(0,s.Z)(this,"filter",new p.vpe),this.language=e,this.reporterconfig=t}ngOnChanges(){if(Array.isArray(this.whereConditions))for(let e of this.whereConditions)"yes"==e.usereditable&&(this.reporterconfig.addUserFilter(e),this.hasUserFilters=!0)}ngOnDestroy(){}toggleFilters(){this.showFilters=!this.showFilters,this.filter.emit(this.showFilters)}}return e=ReporterFilterButton,(0,s.Z)(ReporterFilterButton,"ɵfac",(function(t){return new(t||e)(p.Y36(Z.d),p.Y36(u.s))})),(0,s.Z)(ReporterFilterButton,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-filter-button"]],viewQuery:function(e,t){if(1&e&&p.Gf(Y,7,p.s_b),2&e){let e;p.iGM(e=p.CRH())&&(t.actionitems=e.first)}},inputs:{whereConditions:"whereConditions"},outputs:{filter:"filter"},features:[p.TTD],decls:4,vars:2,consts:[[1,"slds-button","slds-button--neutral","slds-grid","slds-grid--vertical-align-center",2,"border-top-left-radius","0","border-bottom-left-radius","0",3,"disabled","click"],["label","LBL_FILTER"],[1,"slds-p-horizontal--xxx-small",3,"icon"]],template:function(e,t){1&e&&(p.TgZ(0,"button",0),p.NdJ("click",(function(){return t.toggleFilters()})),p.TgZ(1,"span"),p._UZ(2,"system-label",1),p.qZA(),p._UZ(3,"system-button-icon",2),p.qZA()),2&e&&(p.Q6J("disabled",!t.hasUserFilters),p.xp6(3),p.Q6J("icon","filterList"))},dependencies:[A.J,M._],encapsulation:2})),ReporterFilterButton})();var N=i(4361);const P=["actionItemsContainer"];let O=(()=>{var e;class ReporterIntegrationExportButton{constructor(e,t,i){(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"metadata",void 0),(0,s.Z)(this,"model",void 0),(0,s.Z)(this,"actionItemsContainer",void 0),(0,s.Z)(this,"integrationParams",{}),(0,s.Z)(this,"actionComponentRefs",[]),this.language=e,this.metadata=t,this.model=i}get isDisabled(){if(!this.model.checkAccess("export"))return!1;if(this.integrationParams.activePlugins)for(let e in this.integrationParams.activePlugins)if(this.integrationParams.activePlugins.hasOwnProperty(e)&&1==this.integrationParams.activePlugins[e])switch(e){case"ktargetlistexport":case"kcsvexport":case"kexcelexport":case"kpdfexport":case"kplannerexport":if(1==this.integrationParams.activePlugins[e])return!1}return!0}ngAfterViewInit(){this.renderActionItems()}ngOnChanges(){this.renderActionItems()}renderActionItems(){if(this.actionComponentRefs.forEach((e=>e.destroy())),this.actionComponentRefs=[],this.integrationParams.activePlugins)for(let e in this.integrationParams.activePlugins)if(this.integrationParams.activePlugins.hasOwnProperty(e)&&1==this.integrationParams.activePlugins[e])switch(e){case"ktargetlistexport":1==this.integrationParams.activePlugins.ktargetlistexport&&this.renderActionItem("ReporterIntegrationTargetlistexportButton");break;case"kcsvexport":1==this.integrationParams.activePlugins.kcsvexport&&this.renderActionItem("ReporterIntegrationCSVexportButton");break;case"kexcelexport":1==this.integrationParams.activePlugins.kexcelexport&&this.renderActionItem("ReporterIntegrationXLSexportButton");break;case"kpdfexport":1==this.integrationParams.activePlugins.kpdfexport&&this.renderActionItem("ReporterIntegrationPDFexportButton");break;case"kplannerexport":1==this.integrationParams.activePlugins.kplannerexport&&this.renderActionItem("SalesPlanningReporterIntegrationExportButton")}}renderActionItem(e){this.metadata.addComponent(e,this.actionItemsContainer).subscribe((e=>{this.actionComponentRefs.push(e)}))}}return e=ReporterIntegrationExportButton,(0,s.Z)(ReporterIntegrationExportButton,"ɵfac",(function(t){return new(t||e)(p.Y36(Z.d),p.Y36(b.Pu),p.Y36(h.o))})),(0,s.Z)(ReporterIntegrationExportButton,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-integration-export-button"]],viewQuery:function(e,t){if(1&e&&p.Gf(P,7,p.s_b),2&e){let e;p.iGM(e=p.CRH())&&(t.actionItemsContainer=e.first)}},inputs:{integrationParams:"integrationParams"},features:[p.TTD],decls:9,vars:2,consts:[["system-dropdown-trigger-simple","",1,"slds-dropdown-trigger","slds-dropdown-trigger_click"],["aria-haspopup","true",1,"slds-button","slds-button--neutral",2,"border-top-right-radius","0","border-bottom-right-radius","0",3,"disabled"],["label","LBL_EXPORT"],[3,"icon"],[1,"slds-dropdown","slds-dropdown_right"],["role","menu",1,"slds-dropdown__list"],["actionItemsContainer",""]],template:function(e,t){1&e&&(p.TgZ(0,"div",0)(1,"button",1)(2,"span"),p._UZ(3,"system-label",2),p.qZA(),p._UZ(4,"system-button-icon",3),p.qZA(),p.TgZ(5,"div",4)(6,"ul",5),p._UZ(7,"div",null,6),p.qZA()()()),2&e&&(p.xp6(1),p.Q6J("disabled",t.isDisabled),p.xp6(3),p.Q6J("icon","down"))},dependencies:[A.J,M._,N.w],encapsulation:2,changeDetection:0})),ReporterIntegrationExportButton})();const U=["actionItemsContainer"];let L=(()=>{var e;class ReporterIntegrationToolsButton{constructor(e,t){(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"metadata",void 0),(0,s.Z)(this,"actionItemsContainer",void 0),(0,s.Z)(this,"integrationParams",{}),(0,s.Z)(this,"actionComponentRefs",[]),this.language=e,this.metadata=t}get isDisabled(){if(this.integrationParams.activePlugins)for(let e in this.integrationParams.activePlugins)if(this.integrationParams.activePlugins.hasOwnProperty(e)&&"kqueryanalizer"===e)if(1==this.integrationParams.activePlugins.kqueryanalizer)return!1;return!0}ngOnChanges(){this.renderActionItems()}ngAfterViewInit(){this.renderActionItems()}renderActionItems(){if(this.actionComponentRefs.forEach((e=>e.destroy())),this.actionComponentRefs=[],this.integrationParams.activePlugins)for(let e in this.integrationParams.activePlugins)if(this.integrationParams.activePlugins.hasOwnProperty(e)&&"kqueryanalizer"===e)1==this.integrationParams.activePlugins.kqueryanalizer&&this.metadata.addComponent("ReporterIntegrationQueryanalyzerButton",this.actionItemsContainer).subscribe((e=>{this.actionComponentRefs.push(e)}))}}return e=ReporterIntegrationToolsButton,(0,s.Z)(ReporterIntegrationToolsButton,"ɵfac",(function(t){return new(t||e)(p.Y36(Z.d),p.Y36(b.Pu))})),(0,s.Z)(ReporterIntegrationToolsButton,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-integration-tools-button"]],viewQuery:function(e,t){if(1&e&&p.Gf(U,5,p.s_b),2&e){let e;p.iGM(e=p.CRH())&&(t.actionItemsContainer=e.first)}},inputs:{integrationParams:"integrationParams"},features:[p.TTD],decls:10,vars:2,consts:[["system-dropdown-trigger-simple","",1,"slds-dropdown-trigger","slds-dropdown-trigger_click"],["aria-haspopup","true",1,"slds-button","slds-button--neutral",2,"border-radius","0","border-left","0","border-right","0",3,"disabled"],["label","LBL_TOOLS"],[3,"icon"],[1,"slds-dropdown","slds-dropdown_right"],["role","menu",1,"slds-dropdown__list"],["actionItemsContainer",""]],template:function(e,t){1&e&&(p.TgZ(0,"div",0)(1,"button",1)(2,"span")(3,"span"),p._UZ(4,"system-label",2),p.qZA()(),p._UZ(5,"system-button-icon",3),p.qZA(),p.TgZ(6,"div",4)(7,"ul",5),p._UZ(8,"div",null,6),p.qZA()()()),2&e&&(p.xp6(1),p.Q6J("disabled",t.isDisabled),p.xp6(4),p.Q6J("icon","down"))},dependencies:[A.J,M._,N.w],encapsulation:2,changeDetection:0})),ReporterIntegrationToolsButton})();function z(e,t){if(1&e&&(p.ynx(0),p._uU(1),p.BQk()),2&e){const e=p.oxw();p.xp6(1),p.Oqu(e.model.data.summary_text)}}const Q=function(){return{displayLabels:!1}};function E(e,t){if(1&e&&p._UZ(0,"object-record-fieldset-horizontal-list",16),2&e){const e=p.oxw();p.Q6J("fieldset",e.fieldset)("system-view-provider",p.DdM(2,Q))}}let S=(()=>{var e;class ReporterDetailViewHeader extends R.Y{constructor(e,t,i,o){super(e,o,i,t),(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"metadata",void 0),(0,s.Z)(this,"model",void 0),(0,s.Z)(this,"router",void 0),(0,s.Z)(this,"whereConditions",{}),(0,s.Z)(this,"integrationParams",{}),(0,s.Z)(this,"showFilters",new p.vpe),this.language=e,this.metadata=t,this.model=i,this.router=o}toggleFilters(e){this.showFilters.emit(e)}}return e=ReporterDetailViewHeader,(0,s.Z)(ReporterDetailViewHeader,"ɵfac",(function(t){return new(t||e)(p.Y36(Z.d),p.Y36(b.Pu),p.Y36(h.o),p.Y36(y.F0))})),(0,s.Z)(ReporterDetailViewHeader,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-detail-view-header"]],inputs:{whereConditions:"whereConditions",integrationParams:"integrationParams"},outputs:{showFilters:"showFilters"},features:[p.qOj],decls:19,vars:8,consts:[[1,"slds-page-header"],[1,"slds-grid"],[1,"slds-col","slds-has-flexi-truncate"],[1,"slds-media","slds-no-space","slds-grow"],[3,"module","click"],[1,"slds-media__body"],[1,"slds-text-title--caps","slds-line-height--reset"],[3,"click"],[3,"module"],[1,"slds-page-header__title","slds-m-right--small","slds-align-middle","slds-truncate"],[4,"ngIf"],[3,"fieldset","system-view-provider",4,"ngIf"],[1,"slds-m-horizontal--x-small","slds-show--medium","slds-button-group"],[3,"integrationParams"],[3,"whereConditions","filter"],[3,"actionset"],[3,"fieldset","system-view-provider"]],template:function(e,t){1&e&&(p.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"system-icon",4),p.NdJ("click",(function(){return t.goToModule()})),p.qZA(),p.TgZ(5,"div",5)(6,"p",6)(7,"a",7),p.NdJ("click",(function(){return t.goToModule()})),p._UZ(8,"system-label-modulename",8),p.qZA()(),p.TgZ(9,"div")(10,"h1",9),p.YNc(11,z,2,1,"ng-container",10),p.YNc(12,E,1,3,"object-record-fieldset-horizontal-list",11),p.qZA()()()()(),p.TgZ(13,"div",12),p._UZ(14,"reporter-integration-export-button",13)(15,"reporter-integration-tools-button",13),p.TgZ(16,"reporter-filter-button",14),p.NdJ("filter",(function(e){return t.toggleFilters(e)})),p.qZA()(),p._UZ(17,"object-action-container",15),p.qZA(),p._UZ(18,"object-page-header-tags"),p.qZA()),2&e&&(p.xp6(4),p.Q6J("module",t.moduleName),p.xp6(4),p.Q6J("module",t.moduleName),p.xp6(3),p.Q6J("ngIf",!t.fieldset),p.xp6(1),p.Q6J("ngIf",t.fieldset),p.xp6(2),p.Q6J("integrationParams",t.integrationParams),p.xp6(1),p.Q6J("integrationParams",t.integrationParams),p.xp6(1),p.Q6J("whereConditions",t.whereConditions),p.xp6(1),p.Q6J("actionset",t.actionSet))},dependencies:[o.O5,C.S,k.Z,I.d,T.f,D.M,J.V,q,O,L],encapsulation:2})),ReporterDetailViewHeader})();var B=i(3278),V=i(5920),G=i(7514),H=i(5681);function j(e,t){if(1&e&&(p.TgZ(0,"option",6),p._uU(1),p.qZA()),2&e){const e=t.$implicit;p.Q6J("value",e.savedfilter_id),p.xp6(1),p.Oqu(e.name)}}let K=(()=>{var e;class ReporterFilterSavedFilters{constructor(e,t,i,o,r){(0,s.Z)(this,"metadata",void 0),(0,s.Z)(this,"model",void 0),(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"reporterconfig",void 0),(0,s.Z)(this,"backend",void 0),(0,s.Z)(this,"selectFilterChange",new p.vpe),(0,s.Z)(this,"reportId",""),(0,s.Z)(this,"_selectedFilterId",""),(0,s.Z)(this,"savedFilters",[]),this.metadata=e,this.model=t,this.language=i,this.reporterconfig=o,this.backend=r}get selectedFilter(){return this._selectedFilterId}set selectedFilter(e){this._selectedFilterId=e,0==this._selectedFilterId.length?(this.reporterconfig.setDefaultUserFilter(),this.selectFilterChange.emit(null)):(this.selectFilterChange.emit(e),this.savedFilters.some((t=>{if(t.savedfilter_id==e)return this.reporterconfig.setSavedFilter(JSON.parse(t.selectedfilters)),!0})))}get isDisabled(){return 0==this.savedFilters.length}ngOnInit(){this.backend.getRequest(`module/KReports/${this.reportId}/savedfilters`,{assigneduserid:"own"}).subscribe((e=>{this.savedFilters=e}))}pushNewFilter(e){e.selectedfilters=JSON.stringify(e.selectedfilters),e.is_global&&(e.name="(G) "+e.name),this.savedFilters.push(e),this.selectedFilter=e.savedfilter_id}updateFilterData(){this.savedFilters.some((e=>{if(this.selectedFilter==e.savedfilter_id)return e.selectedfilters=JSON.stringify(this.reporterconfig.userFilters),!0}))}}return e=ReporterFilterSavedFilters,(0,s.Z)(ReporterFilterSavedFilters,"ɵfac",(function(t){return new(t||e)(p.Y36(b.Pu),p.Y36(h.o),p.Y36(Z.d),p.Y36(u.s),p.Y36(w.y))})),(0,s.Z)(ReporterFilterSavedFilters,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-filter-saved-filters"]],inputs:{reportId:"reportId",_selectedFilterId:"_selectedFilterId"},outputs:{selectFilterChange:"selectFilterChange"},decls:8,vars:3,consts:[[1,"slds-form-element"],[1,"slds-form-element__control"],[1,"slds-select_container"],[1,"slds-select",3,"ngModel","disabled","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){1&e&&(p.TgZ(0,"div")(1,"div",0)(2,"div",1)(3,"div",2)(4,"select",3),p.NdJ("ngModelChange",(function(e){return t.selectedFilter=e})),p.TgZ(5,"option",4),p._uU(6,"---"),p.qZA(),p.YNc(7,j,2,2,"option",5),p.qZA()()()()()),2&e&&(p.xp6(4),p.Q6J("ngModel",t.selectedFilter)("disabled",t.isDisabled),p.xp6(3),p.Q6J("ngForOf",t.savedFilters))},dependencies:[o.sg,r.YN,r.Kr,r.EJ,r.JJ,r.On],encapsulation:2})),ReporterFilterSavedFilters})();var X=i(8717),$=i(3411),W=i(8477);function ee(e,t){if(1&e&&(p.TgZ(0,"option",11),p._uU(1),p.qZA()),2&e){const e=t.$implicit;p.Q6J("ngValue",e.value),p.xp6(1),p.Oqu(e.display)}}function te(e,t){if(1&e&&p._UZ(0,"reporter-filter-item-enum",17),2&e){const e=p.oxw(2);p.Q6J("field","value")("wherecondition",e.wherecondition)("isMultiSelect",e.wherecondition.operator.includes("oneof"))}}function ie(e,t){if(1&e&&p._UZ(0,"reporter-filter-item-date",18),2&e){const e=p.oxw(2);p.Q6J("field","valuekey")("wherecondition",e.wherecondition)}}function se(e,t){if(1&e&&p._UZ(0,"reporter-filter-item-text",18),2&e){const e=p.oxw(2);p.Q6J("field","value")("wherecondition",e.wherecondition)}}function oe(e,t){if(1&e&&p._UZ(0,"reporter-filter-item-enum",18),2&e){const e=p.oxw(3);p.Q6J("field","valueto")("wherecondition",e.wherecondition)}}function re(e,t){if(1&e&&p._UZ(0,"reporter-filter-item-date",18),2&e){const e=p.oxw(3);p.Q6J("field","valuetokey")("wherecondition",e.wherecondition)}}function ne(e,t){if(1&e&&p._UZ(0,"reporter-filter-item-text",18),2&e){const e=p.oxw(3);p.Q6J("field","valueto")("wherecondition",e.wherecondition)}}function le(e,t){if(1&e&&(p.TgZ(0,"div",19),p.YNc(1,oe,1,2,"reporter-filter-item-enum",15),p.YNc(2,re,1,2,"reporter-filter-item-date",15),p.YNc(3,ne,1,2,"reporter-filter-item-text",15),p.qZA()),2&e){const e=p.oxw(2);p.Q6J("ngSwitch",e.itemType),p.xp6(1),p.Q6J("ngSwitchCase","enum"),p.xp6(1),p.Q6J("ngSwitchCase","date"),p.xp6(1),p.Q6J("ngSwitchCase","text")}}const ae=function(e,t,i){return{"slds-size--1-of-1":e,"slds-size--1-of-2":t,"slds-p-right--xxx-small":i}};function de(e,t){if(1&e&&(p.TgZ(0,"div",12)(1,"div",13),p.YNc(2,te,1,3,"reporter-filter-item-enum",14),p.YNc(3,ie,1,2,"reporter-filter-item-date",15),p.YNc(4,se,1,2,"reporter-filter-item-text",15),p.qZA(),p.YNc(5,le,4,4,"div",16),p.qZA()),2&e){const e=p.oxw();p.xp6(1),p.Q6J("ngSwitch",e.itemType)("ngClass",p.kEZ(6,ae,!e.showValueTo,e.showValueTo,e.showValueTo)),p.xp6(1),p.Q6J("ngSwitchCase","enum"),p.xp6(1),p.Q6J("ngSwitchCase","date"),p.xp6(1),p.Q6J("ngSwitchCase","text"),p.xp6(1),p.Q6J("ngIf",e.showValueTo)}}let ce=(()=>{var e;class ReporterFilterItem{constructor(e,t,i){(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"model",void 0),(0,s.Z)(this,"reporterconfig",void 0),(0,s.Z)(this,"wherecondition",{}),this.language=e,this.model=t,this.reporterconfig=i}getOperators(){let e=[];const t=this.reporterconfig.operatorAssignments[this.wherecondition.type]||"varchar";let i=this.reporterconfig.operatorTypes[t];for(let t of i)e.push({value:t,display:this.language.getLabel("LBL_OP_"+t.toUpperCase())});return e.sort(((e,t)=>e.display>t.display?1:-1)),e}get itemType(){let e="text";switch(this.wherecondition.type){case"enum":case"multienum":case"radioenum":switch(this.wherecondition.operator){case"equals":case"notequal":case"oneof":case"oneofnot":case"oneofnotornull":e="enum"}break;case"date":case"datetime":case"datetimecombo":switch(this.wherecondition.operator){case"before":case"after":case"between":case"equals":e="date"}}return e}get showValue(){return this.reporterconfig.operatorCount[this.wherecondition.operator]>0}get showValueTo(){return this.reporterconfig.operatorCount[this.wherecondition.operator]>1}changeOperator(){this.wherecondition.value="",this.wherecondition.valuekey="",this.wherecondition.valueto="",this.wherecondition.valuetokey=""}}return e=ReporterFilterItem,(0,s.Z)(ReporterFilterItem,"ɵfac",(function(t){return new(t||e)(p.Y36(Z.d),p.Y36(h.o),p.Y36(u.s))})),(0,s.Z)(ReporterFilterItem,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-filter-item"]],inputs:{wherecondition:"wherecondition"},decls:11,vars:4,consts:[[1,"slds-p-bottom--small"],[1,"slds-text-heading--label","slds-p-bottom--xxx-small"],[3,"label"],[1,"slds-form-element","slds-p-vertical--xx-small"],[1,"slds-form-element__control"],[1,"slds-select_container"],[1,"slds-select",3,"ngModel","ngModelChange","change"],["value","ignore"],["label","LBL_OP_IGNORE"],[3,"ngValue",4,"ngFor","ngForOf"],["class","slds-grid slds-p-vertical--xx-small",4,"ngIf"],[3,"ngValue"],[1,"slds-grid","slds-p-vertical--xx-small"],[3,"ngSwitch","ngClass"],[3,"field","wherecondition","isMultiSelect",4,"ngSwitchCase"],[3,"field","wherecondition",4,"ngSwitchCase"],["class","slds-size--1-of-2 slds-p-left--xxx-small",3,"ngSwitch",4,"ngIf"],[3,"field","wherecondition","isMultiSelect"],[3,"field","wherecondition"],[1,"slds-size--1-of-2","slds-p-left--xxx-small",3,"ngSwitch"]],template:function(e,t){1&e&&(p.TgZ(0,"div",0)(1,"div",1),p._UZ(2,"system-label",2),p.qZA(),p.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"select",6),p.NdJ("ngModelChange",(function(e){return t.wherecondition.operator=e}))("change",(function(){return t.changeOperator()})),p.TgZ(7,"option",7),p._UZ(8,"system-label",8),p.qZA(),p.YNc(9,ee,2,2,"option",9),p.qZA()()()(),p.YNc(10,de,6,10,"div",10),p.qZA()),2&e&&(p.xp6(2),p.Q6J("label",t.wherecondition.label),p.xp6(4),p.Q6J("ngModel",t.wherecondition.operator),p.xp6(3),p.Q6J("ngForOf",t.getOperators()),p.xp6(1),p.Q6J("ngIf",t.showValue))},dependencies:[o.mk,o.sg,o.O5,o.RF,o.n9,r.YN,r.Kr,r.EJ,r.JJ,r.On,M._,X.I,$.i,W.h],encapsulation:2})),ReporterFilterItem})();const pe=["popover"],he=["savedFiltersContainer"];function ue(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"div",28)(1,"reporter-filter-saved-filters",29,30),p.NdJ("selectFilterChange",(function(t){p.CHM(e);const i=p.oxw();return p.KtG(i.setSelectedFilterId(t))})),p.qZA()()}if(2&e){const e=p.oxw();p.xp6(1),p.Q6J("reportId",e.model.id)}}function ge(e,t){if(1&e&&p._UZ(0,"reporter-filter-item",31),2&e){const e=t.$implicit;p.Q6J("wherecondition",e)}}function fe(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"div",45)(1,"system-checkbox",46),p.NdJ("ngModelChange",(function(t){p.CHM(e);const i=p.oxw(2);return p.KtG(i.filter.is_global=t)})),p._UZ(2,"system-label",47),p.qZA()()}if(2&e){const e=p.oxw(2);p.xp6(1),p.Q6J("ngModel",e.filter.is_global)}}function me(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"div",32)(1,"div",33)(2,"fieldset",34)(3,"div",35)(4,"label",36),p._UZ(5,"system-label",37),p.qZA(),p.TgZ(6,"div",38)(7,"input",39),p.NdJ("ngModelChange",(function(t){p.CHM(e);const i=p.oxw();return p.KtG(i.filter.name=t)})),p.qZA()()(),p.YNc(8,fe,3,1,"div",40),p.qZA(),p.TgZ(9,"div",41)(10,"button",42),p.NdJ("click",(function(){p.CHM(e);const t=p.oxw();return p.KtG(t.confirmSave())})),p._UZ(11,"system-label",19),p.qZA(),p.TgZ(12,"button",43),p.NdJ("click",(function(){p.CHM(e);const t=p.oxw();return p.KtG(t.closePopover())})),p._UZ(13,"system-label",44),p.qZA()()()()}if(2&e){const e=p.oxw();p.Q6J("@animatepopover",void 0),p.xp6(7),p.Q6J("ngModel",e.filter.name),p.xp6(1),p.Q6J("ngIf",e.isAdmin)}}const ve=[(0,g.X$)("animatepopover",[(0,g.eR)(":enter",[(0,g.oB)({opacity:0}),(0,g.jt)(".25s",(0,g.oB)({opacity:1}))]),(0,g.eR)(":leave",[(0,g.oB)({opacity:"1"}),(0,g.jt)(".25s",(0,g.oB)({opacity:0}))])])];let Ze=(()=>{var e;class ReporterFilterPanel{constructor(e,t,i,o,r,n,l){(0,s.Z)(this,"model",void 0),(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"elementRef",void 0),(0,s.Z)(this,"toast",void 0),(0,s.Z)(this,"backend",void 0),(0,s.Z)(this,"session",void 0),(0,s.Z)(this,"reporterconfig",void 0),(0,s.Z)(this,"popover",void 0),(0,s.Z)(this,"savedFiltersComponent",void 0),(0,s.Z)(this,"filterapplied",new p.vpe),(0,s.Z)(this,"integrationparams",{}),(0,s.Z)(this,"selectedFilterId",void 0),(0,s.Z)(this,"showPopover",!1),(0,s.Z)(this,"filter",{}),this.model=e,this.language=t,this.elementRef=i,this.toast=o,this.backend=r,this.session=n,this.reporterconfig=l}get isAdmin(){return!!this.session.authData.admin}get whereConditions(){return this.reporterconfig.userFilters}get popoverStyle(){let e=this.elementRef.nativeElement.getBoundingClientRect(),t=this.popover.element.nativeElement.getBoundingClientRect();return{position:"fixed",top:e.top+(e.height-t.height)/2+"px",left:e.left-t.width+"px"}}get displaySavedFilters(){return!!this.integrationparams.activePlugins&&!!this.integrationparams.activePlugins.ksavedfilters}openPopover(){this.showPopover=!0,this.initializeFilter()}closePopover(){this.showPopover=!1,this.initializeFilter()}initializeFilter(){this.filter={savedfilter_id:this.model.generateGuid(),name:"",isNew:!0,is_global:!1}}applyFilter(){this.filterapplied.emit(!0),this.reporterconfig.refresh()}setSelectedFilterId(e){this.selectedFilterId=e}handleSave(){if(!this.selectedFilterId)return this.openPopover();this.saveFilter(this.selectedFilterId)}saveFilter(e,t){let i={selectedfilters:{...this.reporterconfig.userFilters}};i&&(i={...t,...i}),this.backend.postRequest(`module/KReports/${this.model.id}/savedfilter/${e}`,[],i).subscribe((e=>{e&&e.success?(this.toast.sendToast(this.language.getLabel("LBL_DATA_SAVED"),"success"),this.savedFiltersComponent&&(t?this.savedFiltersComponent.pushNewFilter(i):this.savedFiltersComponent.updateFilterData())):this.toast.sendToast(this.language.getLabel("ERR_FAILED_TO_EXECUTE"),"error")}))}saveFilterAs(){this.selectedFilterId&&this.openPopover()}confirmSave(){this.selectedFilterId=void 0,this.saveFilter(this.filter.savedfilter_id,this.filter),this.closePopover()}}return e=ReporterFilterPanel,(0,s.Z)(ReporterFilterPanel,"ɵfac",(function(t){return new(t||e)(p.Y36(h.o),p.Y36(Z.d),p.Y36(p.SBq),p.Y36(B.A),p.Y36(w.y),p.Y36(V.n),p.Y36(u.s))})),(0,s.Z)(ReporterFilterPanel,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-filter-panel"]],viewQuery:function(e,t){if(1&e&&(p.Gf(pe,7,p.s_b),p.Gf(he,5)),2&e){let e;p.iGM(e=p.CRH())&&(t.popover=e.first),p.iGM(e=p.CRH())&&(t.savedFiltersComponent=e.first)}},inputs:{integrationparams:"integrationparams"},outputs:{filterapplied:"filterapplied"},decls:30,vars:8,consts:[[1,"slds-panel","slds-grid","slds-grid_vertical","slds-nowrap","slds-panel_filters","slds-height_full",2,"width","500px","box-shadow","0 10px 10px #888"],[1,"slds-form","slds-form_stacked","slds-grow","slds-scrollable_y","slds-grid","slds-grid_vertical"],[1,"slds-filters"],[1,"slds-filters__header","slds-grid","slds-has-divider_bottom-space"],[1,"slds-align-middle","slds-text-heading_small"],["label","LBL_FILTER"],[1,"slds-button-group","slds-col_bump-left"],[1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_APPLY"],["system-dropdown-trigger","",1,"slds-dropdown-trigger","slds-dropdown-trigger_click","slds-button_last"],["aria-haspopup","true",1,"slds-button","slds-button_icon","slds-button_icon-border-filled",3,"disabled","title"],["icon","down"],[1,"slds-assistive-text"],["label","LBL_MORE"],[1,"slds-dropdown","slds-dropdown_right","slds-dropdown_actions"],["role","menu",1,"slds-dropdown__list"],["role","presentation",1,"slds-dropdown__item"],["href","javascript:void(0);","role","menuitem","tabindex","0",3,"click"],[1,"slds-truncate"],["label","LBL_SAVE"],["href","javascript:void(0);","role","menuitem","tabindex","-1",3,"click"],["label","LBL_SAVE_AS"],["class","slds-filters__header slds-has-divider_bottom-space",4,"ngIf"],[1,"slds-filters__body"],[3,"wherecondition",4,"ngFor","ngForOf"],[3,"ngStyle"],["popover",""],["class","slds-popover slds-nubbin--right","role","dialog",4,"ngIf"],[1,"slds-filters__header","slds-has-divider_bottom-space"],[3,"reportId","selectFilterChange"],["savedFiltersContainer",""],[3,"wherecondition"],["role","dialog",1,"slds-popover","slds-nubbin--right"],[1,"slds-popover__body"],[1,"slds-form--stacked"],[1,"slds-form-element"],[1,"slds-form-element__label"],["label","LBL_NAME"],[1,"slds-form-element__control"],["type","text",1,"slds-input",3,"ngModel","ngModelChange"],["class","slds-m-top--small",4,"ngIf"],[1,"slds-text-align--right","slds-p-top--x-small"],["type","button",1,"slds-button","slds-button--brand","slds-button-space-left",3,"click"],["type","button",1,"slds-button","slds-button--neutral","slds-button-space-left",3,"click"],["label","LBL_CLOSE"],[1,"slds-m-top--small"],[3,"ngModel","ngModelChange"],["label","LBL_GLOBAL"]],template:function(e,t){1&e&&(p.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),p._UZ(5,"system-label",5),p.qZA(),p.TgZ(6,"div",6)(7,"button",7),p.NdJ("click",(function(){return t.applyFilter()})),p._UZ(8,"system-label",8),p.qZA(),p.TgZ(9,"div",9)(10,"button",10),p._UZ(11,"system-button-icon",11),p.TgZ(12,"span",12),p._UZ(13,"system-label",13),p.qZA()(),p.TgZ(14,"div",14)(15,"ul",15)(16,"li",16)(17,"a",17),p.NdJ("click",(function(){return t.handleSave()})),p.TgZ(18,"span",18),p._UZ(19,"system-label",19),p.qZA()()(),p.TgZ(20,"li",16)(21,"a",20),p.NdJ("click",(function(){return t.saveFilterAs()})),p.TgZ(22,"span",18),p._UZ(23,"system-label",21),p.qZA()()()()()()()(),p.YNc(24,ue,3,1,"div",22),p.TgZ(25,"div",23),p.YNc(26,ge,1,1,"reporter-filter-item",24),p.qZA()()()(),p.TgZ(27,"div",25,26),p.YNc(29,me,14,3,"div",27),p.qZA()),2&e&&(p.xp6(10),p.Q6J("disabled",!t.displaySavedFilters)("title",t.language.getLabel("LBL_MORE")),p.xp6(12),p.ekj("slds-disabled-text",!t.selectedFilterId),p.xp6(2),p.Q6J("ngIf",t.displaySavedFilters),p.xp6(2),p.Q6J("ngForOf",t.whereConditions),p.xp6(1),p.Q6J("ngStyle",t.popoverStyle),p.xp6(2),p.Q6J("ngIf",t.showPopover))},dependencies:[o.sg,o.O5,o.PC,r.Fj,r.JJ,r.On,A.J,G.U,M._,H.l,K,ce],encapsulation:2,data:{animation:ve}})),ReporterFilterPanel})();var be=i(4021);const we=["vizcontainer"];function ye(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"div",3)(1,"div",4),p.NdJ("click",(function(){p.CHM(e);const t=p.oxw();return p.KtG(t.openReport())})),p._uU(2),p.qZA(),p.TgZ(3,"button",5),p.NdJ("click",(function(){p.CHM(e);const t=p.oxw();return p.KtG(t.reload())})),p._UZ(4,"system-button-icon",6),p.qZA()()}if(2&e){const e=p.oxw();p.xp6(2),p.Oqu(e.model.data.name)}}let _e=(()=>{var e;class ReporterDetailVisualization{constructor(e,t,i,o,r,n){(0,s.Z)(this,"reporterconfig",void 0),(0,s.Z)(this,"metadata",void 0),(0,s.Z)(this,"model",void 0),(0,s.Z)(this,"toast",void 0),(0,s.Z)(this,"backend",void 0),(0,s.Z)(this,"cdRef",void 0),(0,s.Z)(this,"httpRequestsRefID",window._.uniqueId("reporter_visualization_http_ref_")),(0,s.Z)(this,"vizcontainer",void 0),(0,s.Z)(this,"parentModule",""),(0,s.Z)(this,"parentId",""),(0,s.Z)(this,"displayEmbedded",!1),(0,s.Z)(this,"loading",!0),(0,s.Z)(this,"vizData",{}),(0,s.Z)(this,"chartComponent",void 0),(0,s.Z)(this,"subscriptions",new m.w0),this.reporterconfig=e,this.metadata=t,this.model=i,this.toast=o,this.backend=r,this.cdRef=n,this.subscriptions.add(this.reporterconfig.refresh$.subscribe({next:e=>{e?this.getVisualization():this.handleCancel()}}))}ngAfterViewInit(){this.getVisualization()}ngOnDestroy(){this.subscriptions.unsubscribe(),this.backend.cancelPendingRequests([this.httpRequestsRefID])}reload(){this.chartComponent&&(this.chartComponent.destroy(),this.chartComponent=null),this.getVisualization()}getVisualization(){this.loading=!0,this.reporterconfig.isLoading.visualization=!0,this.cdRef.detectChanges();let e={};this.parentModule&&this.parentId&&(e.parentbeanId=this.parentId,e.parentbeanModule=this.parentModule);let t=[];for(let e of this.reporterconfig.userFilters)t.push({fieldid:e.fieldid,operator:e.operator,value:e.value,valuekey:e.valuekey,valueto:e.valueto,valuetokey:e.valuetokey});e.whereConditions=JSON.stringify(t),this.backend.cancelPendingRequests([this.httpRequestsRefID]),this.backend.getRequest("module/KReports/"+this.model.id+"/visualization",e,this.httpRequestsRefID).subscribe({next:e=>{this.vizData=e,this.loading=!1,this.reporterconfig.isLoading.visualization=!1,this.cdRef.detectChanges(),this.renderVisualization()},error:()=>{this.toast.sendToast("ERR_LOADING_RECORD","error"),this.loading=!1,this.reporterconfig.isLoading.visualization=!1,this.cdRef.detectChanges()}})}get visualizationStyle(){return{height:this.displayEmbedded?"calc(100% - 36px)":"100%"}}renderVisualization(){this.chartComponent&&(this.chartComponent.destroy(),this.chartComponent=null);for(let e of this.vizData){let t="";switch(e.plugin){case"highcharts":t="ReporterDetailVisualizationHighcharts";break;case"googlecharts":t="ReporterDetailVisualizationGooglecharts";break;case"googlemaps":t="ReporterDetailVisualizationGoogleMaps"}""!=t&&this.metadata.addComponent(t,this.vizcontainer).subscribe((t=>{this.chartComponent=t,t.instance.vizdata=e,t.changeDetectorRef.detectChanges()}))}}openReport(){this.model.goDetail()}handleCancel(){this.loading=!1,this.reporterconfig.isLoading.visualization=!1,this.cdRef.detectChanges(),this.backend.cancelPendingRequests([this.httpRequestsRefID])}}return e=ReporterDetailVisualization,(0,s.Z)(ReporterDetailVisualization,"ɵfac",(function(t){return new(t||e)(p.Y36(u.s),p.Y36(b.Pu),p.Y36(h.o),p.Y36(B.A),p.Y36(w.y),p.Y36(p.sBO))})),(0,s.Z)(ReporterDetailVisualization,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-detail-visualization"]],viewQuery:function(e,t){if(1&e&&p.Gf(we,7,p.s_b),2&e){let e;p.iGM(e=p.CRH())&&(t.vizcontainer=e.first)}},inputs:{parentModule:"parentModule",parentId:"parentId",displayEmbedded:"displayEmbedded"},decls:4,vars:4,consts:[["class","slds-grid slds-grid--align-spread slds-p-horizontal--xx-small slds-p-vertical--x-small",4,"ngIf"],[1,"slds-is-relative","slds-size--1-of-1",3,"ngStyle","cancellable","system-overlay-loading-spinner","onCancel"],["vizcontainer",""],[1,"slds-grid","slds-grid--align-spread","slds-p-horizontal--xx-small","slds-p-vertical--x-small"],[1,"slds-text-heading_small","slds-text-link_faux",3,"click"],[1,"slds-button","slds-button--icon",3,"click"],["icon","refresh"]],template:function(e,t){1&e&&(p.YNc(0,ye,5,1,"div",0),p.TgZ(1,"div",1),p.NdJ("onCancel",(function(){return t.handleCancel()})),p._UZ(2,"div",null,2),p.qZA()),2&e&&(p.Q6J("ngIf",t.displayEmbedded),p.xp6(1),p.Q6J("ngStyle",t.visualizationStyle)("cancellable",!0)("system-overlay-loading-spinner",t.loading))},dependencies:[o.O5,o.PC,A.J,be._],encapsulation:2,changeDetection:0})),ReporterDetailVisualization})();const xe=["presentationContainer"];function Fe(e,t){if(1&e&&(p.TgZ(0,"div",7),p._UZ(1,"reporter-detail-visualization"),p.qZA()),2&e){const e=p.oxw();p.Udp("height",e.visualizationHeight,"px")}}function Re(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"reporter-filter-panel",8),p.NdJ("filterapplied",(function(){p.CHM(e);const t=p.oxw();return p.KtG(t.filterApplied())})),p.qZA()}if(2&e){const e=p.oxw();p.Q6J("@displayfilter",void 0)("integrationparams",e.integrationParams)}}const Ce=[(0,g.X$)("displayfilter",[(0,g.eR)(":enter",[(0,g.oB)({width:"0px",overflow:"hidden"}),(0,g.jt)(".5s",(0,g.oB)({width:"*"})),(0,g.oB)({overflow:"unset"})]),(0,g.eR)(":leave",[(0,g.oB)({overflow:"hidden"}),(0,g.jt)(".5s",(0,g.oB)({width:"0px"}))])])];let ke=(()=>{var e;class ReporterDetailView{constructor(e,t,i,o,r,n,l,a,d,c,p,h){(0,s.Z)(this,"broadcast",void 0),(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"metadata",void 0),(0,s.Z)(this,"injector",void 0),(0,s.Z)(this,"model",void 0),(0,s.Z)(this,"backend",void 0),(0,s.Z)(this,"activatedRoute",void 0),(0,s.Z)(this,"navigationtab",void 0),(0,s.Z)(this,"router",void 0),(0,s.Z)(this,"reporterconfig",void 0),(0,s.Z)(this,"cdRef",void 0),(0,s.Z)(this,"view",void 0),(0,s.Z)(this,"presentationContainer",void 0),(0,s.Z)(this,"presentationComponentRef",void 0),(0,s.Z)(this,"hasVisualization",!1),(0,s.Z)(this,"visualizationHeight",0),(0,s.Z)(this,"whereConditions",{}),(0,s.Z)(this,"integrationParams",{}),(0,s.Z)(this,"showFilters",!1),(0,s.Z)(this,"subscriptions",new m.w0),this.broadcast=e,this.language=t,this.metadata=i,this.injector=o,this.model=r,this.backend=n,this.activatedRoute=l,this.navigationtab=a,this.router=d,this.reporterconfig=c,this.cdRef=p,this.view=h,this.subscribeToBroadcast()}ngOnInit(){this.setNavigationTabInfos(this.language.getModuleName(this.model.module)),this.setModelData(),this.view.isEditable=this.metadata.checkModuleAcl(this.model.module,"edit")}ngOnDestroy(){this.subscriptions.unsubscribe()}subscribeToBroadcast(){this.subscriptions.add(this.broadcast.message$.subscribe((e=>{"model.save"==e.messagetype&&e.messagedata.module==this.model.module&&e.messagedata.id==this.model.id&&(this.showFilters=!1,this.reporterconfig.resetUserFilters(),this.whereConditions=e.messagedata.data.whereconditions,this.setIntegrationParams(e.messagedata.data.integration_params),this.setVisualizationProperties(e.messagedata.data.visualization_params),this.renderPresentation(e.messagedata.data.presentation_params),this.reporterconfig.refresh(),this.cdRef.detectChanges())})))}setNavigationTabInfos(e){this.navigationtab.setTabInfo({displayname:e,displaymodule:this.model.module})}setModelData(){this.model.module=this.navigationtab.activeRoute.params.module,this.model.id=this.navigationtab.activeRoute.params.id,this.model.getData(!0,"detailview",!0,!0).subscribe((e=>{this.setNavigationTabInfos(e.summary_text),this.setVisualizationProperties(e.visualization_params),this.reporterconfig.resetUserFilters(),this.whereConditions=e.whereconditions,this.renderPresentation(e.presentation_params),this.setIntegrationParams(e.integration_params),this.cdRef.detectChanges()}))}setIntegrationParams(e){this.integrationParams=void 0,e&&(this.integrationParams=e)}setVisualizationProperties(e){this.hasVisualization=!1,e&&e&&e.layout&&"-"!=e.layout&&(this.hasVisualization=!0,this.visualizationHeight=e.chartheight?e.chartheight:300)}renderPresentation(e){if(this.presentationComponentRef&&(this.presentationComponentRef.destroy(),this.presentationComponentRef=void 0),!e)return;let t="";switch(e.plugin){case"standard":t="ReporterDetailPresentationStandard";break;case"grouped":t="ReporterDetailPresentationGrouped";break;case"standardws":t="ReporterDetailPresentationStandardWS";break;case"tree":t="ReporterDetailPresentationTree";break;case"pivot":t="ReporterDetailPresentationPivot"}""!=t&&this.metadata.addComponent(t,this.presentationContainer).subscribe((e=>{this.presentationComponentRef=e,this.presentationComponentRef.changeDetectorRef.detectChanges()}))}toggleFilters(e){this.showFilters=e}filterApplied(){this.showFilters=!1}}return e=ReporterDetailView,(0,s.Z)(ReporterDetailView,"ɵfac",(function(t){return new(t||e)(p.Y36(v.f),p.Y36(Z.d),p.Y36(b.Pu),p.Y36(p.zs3),p.Y36(h.o),p.Y36(w.y),p.Y36(y.gz),p.Y36(x.d),p.Y36(y.F0),p.Y36(u.s),p.Y36(p.sBO),p.Y36(f.e))})),(0,s.Z)(ReporterDetailView,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-detilview"]],viewQuery:function(e,t){if(1&e&&p.Gf(xe,7,p.s_b),2&e){let e;p.iGM(e=p.CRH())&&(t.presentationContainer=e.first)}},features:[p._Bn([f.e,h.o,u.s])],decls:9,vars:4,consts:[[1,"slds-grid","slds-grid--vertical"],[3,"integrationParams","whereConditions","showFilters"],[1,"slds-is-relative","slds-grow",2,"min-height","0"],["class","slds-size--1-of-1",3,"height",4,"ngIf"],["system-to-bottom-noscroll",""],["presentationContainer",""],["class","slds-is-absolute","style","z-index: 100; right: 0; top: 0; bottom: 0",3,"integrationparams","filterapplied",4,"ngIf"],[1,"slds-size--1-of-1"],[1,"slds-is-absolute",2,"z-index","100","right","0","top","0","bottom","0",3,"integrationparams","filterapplied"]],template:function(e,t){1&e&&(p.TgZ(0,"div",0)(1,"div")(2,"reporter-detail-view-header",1),p.NdJ("showFilters",(function(e){return t.toggleFilters(e)})),p.qZA()(),p.TgZ(3,"div",2),p.YNc(4,Fe,2,2,"div",3),p.TgZ(5,"div",4),p._UZ(6,"div",null,5),p.qZA(),p.YNc(8,Re,1,2,"reporter-filter-panel",6),p.qZA()()),2&e&&(p.xp6(2),p.Q6J("integrationParams",t.integrationParams)("whereConditions",t.whereConditions),p.xp6(2),p.Q6J("ngIf",t.hasVisualization),p.xp6(4),p.Q6J("ngIf",t.showFilters))},dependencies:[o.O5,F.t,S,Ze,_e],encapsulation:2,data:{animation:Ce},changeDetection:0})),ReporterDetailView})(),Ie=(()=>{var e;class ReporterDetailViewRefreshButton{constructor(e,t){(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"reporterconfig",void 0),(0,s.Z)(this,"subscription",new m.w0),this.language=e,this.reporterconfig=t}ngOnDestroy(){this.subscription.unsubscribe()}execute(){this.reporterconfig.isLoading.visualization||this.reporterconfig.isLoading.presentation?this.reporterconfig.cancelRequests():this.reporterconfig.refresh()}}return e=ReporterDetailViewRefreshButton,(0,s.Z)(ReporterDetailViewRefreshButton,"ɵfac",(function(t){return new(t||e)(p.Y36(Z.d),p.Y36(u.s))})),(0,s.Z)(ReporterDetailViewRefreshButton,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-detail-view-refresh-button"]],decls:2,vars:1,consts:[[3,"label"]],template:function(e,t){1&e&&(p.TgZ(0,"span"),p._UZ(1,"system-label",0),p.qZA()),2&e&&(p.xp6(1),p.Q6J("label",t.reporterconfig.isLoading.visualization||t.reporterconfig.isLoading.presentation?"LBL_CANCEL":"LBL_REFRESH"))},dependencies:[M._],encapsulation:2})),ReporterDetailViewRefreshButton})(),Te=(()=>{var e;class ReporterDetailViewEditButton{constructor(e,t,i){(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"router",void 0),(0,s.Z)(this,"model",void 0),this.language=e,this.router=t,this.model=i}execute(){this.disabled||this.router.navigate(["/module/KReports/designer/"+this.model.id])}get disabled(){return!this.model.checkAccess("edit")||(this.model.isEditing||this.model.isSaving)}}return e=ReporterDetailViewEditButton,(0,s.Z)(ReporterDetailViewEditButton,"ɵfac",(function(t){return new(t||e)(p.Y36(Z.d),p.Y36(y.F0),p.Y36(h.o))})),(0,s.Z)(ReporterDetailViewEditButton,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-detail-view-edit-button"]],decls:2,vars:0,consts:[["label","LBL_EDIT"]],template:function(e,t){1&e&&(p.TgZ(0,"span"),p._UZ(1,"system-label",0),p.qZA())},dependencies:[M._],encapsulation:2})),ReporterDetailViewEditButton})();var De=i(429),Je=i(5336),Ae=i(6257),Me=i(7832),Ye=i(6434),qe=i(1512),Ne=i(7982),Pe=i(4044),Oe=i(34),Ue=i(8859),Le=i(151),ze=i(2995),Qe=i(1790);const Ee=function(e,t){return{record:e,field:t}};function Se(e,t){if(1&e&&(p.ynx(0),p.TgZ(1,"div",2),p._UZ(2,"system-dynamic-component",3),p.qZA(),p.BQk()),2&e){const e=p.oxw();p.xp6(1),p.Q6J("module",e.recordModule)("id",e.recordId),p.xp6(1),p.Q6J("component",e.fieldType)("componentattributes",p.WLB(4,Ee,e.record,e.field))}}function Be(e,t){if(1&e&&p._UZ(0,"system-dynamic-component",3),2&e){const e=p.oxw();p.Q6J("component",e.fieldType)("componentattributes",p.WLB(2,Ee,e.record,e.field))}}let Ve=(()=>{var e;class ReporterFieldContainer{constructor(e){(0,s.Z)(this,"metadata",void 0),(0,s.Z)(this,"record",{}),(0,s.Z)(this,"value",""),(0,s.Z)(this,"field",{}),(0,s.Z)(this,"recordModule",void 0),(0,s.Z)(this,"recordId",void 0),(0,s.Z)(this,"fieldType",void 0),this.metadata=e}ngOnInit(){this.initializeRecord(),this.buildLinkInfo(),this.determineFieldType()}initializeRecord(){this.value&&_.isEmpty(this.record)&&(this.record={},this.record[this.field.fieldid]=this.value,this.record[this.field.fieldid+"_val"]=this.value)}buildLinkInfo(){if("yes"==this.field.link&&this.record)if(this.field.linkinfo&&this.field.linkinfo[this.record.unionid?this.record.unionid:"root"])this.recordModule=this.field.linkinfo[this.record.unionid?this.record.unionid:"root"].module,this.recordId=this.record[this.field.linkinfo[this.record.unionid?this.record.unionid:"root"].idfield];else if(this.hasPathField){let e=this.fieldPathInfo.path.split("::").pop().split(":"),t=this.metadata.getFieldDefs(e[1],e[2]);this.recordModule=t.module,this.recordId=this.fieldPathInfo.id}else this.recordModule=this.record.sugarRecordModule,this.recordId=this.record.sugarRecordId}get fieldPathInfo(){let e=this.field.path.split("::");e.pop();let t,i=e.join("::");for(let e in this.record)if(this.record.hasOwnProperty(e)&&this.record[e]==i){t={},t.path=i,t.id=this.record[e.replace("path","id")];break}return t}get hasPathField(){let e=this.field.path.split("::");if(e.pop(),1==e.length)return!1;let t=e.join("::");for(let e in this.record)if(this.record.hasOwnProperty(e)&&this.record[e]==t)return!0;return!1}determineFieldType(){if(this.field.component)this.fieldType=this.field.component;else switch(this.field.type){case"percentage":this.fieldType="ReporterFieldPercentage";break;case"currency":case"currencyint":this.fieldType="ReporterFieldCurrency";break;case"enum":case"multienum":case"radioenum":this.fieldType="ReporterFieldEnum";break;case"datetimecombo":case"datetime":this.fieldType="ReporterFieldDateTime";break;case"date":this.fieldType="ReporterFieldDate";break;case"text":this.fieldType="ReporterFieldText";break;case"category":this.fieldType="ReporterFieldCategoryTree";break;default:this.fieldType="ReporterFieldStandard"}}}return e=ReporterFieldContainer,(0,s.Z)(ReporterFieldContainer,"ɵfac",(function(t){return new(t||e)(p.Y36(b.Pu))})),(0,s.Z)(ReporterFieldContainer,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-field-container"]],inputs:{record:"record",value:"value",field:"field"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["nolink",""],["system-model-popover","",1,"slds-text-link_reset",3,"module","id"],[3,"component","componentattributes"]],template:function(e,t){if(1&e&&(p.YNc(0,Se,3,7,"ng-container",0),p.YNc(1,Be,1,5,"ng-template",null,1,p.W1O)),2&e){const e=p.MAs(2);p.Q6J("ngIf","yes"==t.field.link)("ngIfElse",e)}},dependencies:[o.O5,ze.T,Qe.g],encapsulation:2,changeDetection:0})),ReporterFieldContainer})();function Ge(e,t){if(1&e&&p._UZ(0,"system-utility-icon",15),2&e){const e=p.oxw(3);p.Udp("transform","desc"==e.sortData.sortDirection?"rotate(180deg)":"none")}}function He(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"a",11),p.NdJ("click",(function(){p.CHM(e);const t=p.oxw().$implicit,i=p.oxw();return p.KtG(i.toggleSort(t))})),p.TgZ(1,"div",12),p._UZ(2,"system-label",13),p.qZA(),p.YNc(3,Ge,1,2,"system-utility-icon",14),p.qZA()}if(2&e){const e=p.oxw().$implicit,t=p.oxw();p.Q6J("ngClass",t.fieldsDisplayClasses[e.fieldid]),p.xp6(2),p.Q6J("label",e.name),p.xp6(1),p.Q6J("ngIf",!!t.sortData.sortDirection)}}function je(e,t){if(1&e&&p._UZ(0,"system-utility-icon",15),2&e){const e=p.oxw(2).$implicit;p.Udp("transform","desc"==e.sort?"rotate(180deg)":"none")}}function Ke(e,t){if(1&e&&(p.TgZ(0,"div",16)(1,"div",17),p._UZ(2,"system-label",13),p.qZA(),p.YNc(3,je,1,2,"system-utility-icon",14),p.qZA()),2&e){const e=p.oxw().$implicit;p.xp6(2),p.Q6J("label",e.name),p.xp6(1),p.Q6J("ngIf",!!e.sort&&"-"!=e.sort)}}function Xe(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"th",8),p.NdJ("system-resize",(function(){p.CHM(e);const t=p.oxw();return p.KtG(t.onresize())})),p.YNc(1,He,4,3,"a",9),p.YNc(2,Ke,4,2,"ng-template",null,10,p.W1O),p.qZA()}if(2&e){const e=t.$implicit,i=p.MAs(3),s=p.oxw();p.Udp("width",s.fieldsData[e.fieldid].width,"%"),p.Q6J("ngClass",s.fieldsDisplayClasses[e.fieldid])("resizeid",e.fieldid),p.xp6(1),p.Q6J("ngIf",!!e.sort&&"sortable"==e.sort)("ngIfElse",i)}}function $e(e,t){if(1&e&&(p.TgZ(0,"td",21),p._UZ(1,"reporter-field-container",22),p.qZA()),2&e){const e=t.$implicit,i=p.oxw().$implicit;p.xp6(1),p.Q6J("field",e)("record",i)}}function We(e,t){if(1&e&&(p.TgZ(0,"tr",19),p.YNc(1,$e,2,2,"td",20),p.qZA()),2&e){const e=p.oxw(2);p.xp6(1),p.Q6J("ngForOf",e.displayFields)("ngForTrackBy",e.trackByFn)}}function et(e,t){if(1&e&&(p.ynx(0),p.YNc(1,We,2,2,"tr",18),p.BQk()),2&e){const e=p.oxw();p.xp6(1),p.Q6J("ngForOf",e.presData.records)("ngForTrackBy",e.trackByFn)}}function tt(e,t){1&e&&(p.TgZ(0,"div",23)(1,"h2",24),p._UZ(2,"system-label",25),p.qZA()())}function it(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"button",36),p.NdJ("click",(function(){p.CHM(e);const t=p.oxw(2);return p.KtG(t.saveLayout())})),p._UZ(1,"system-button-icon",37),p.qZA()}}function st(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"div",26)(1,"div",27),p._uU(2),p.qZA(),p.TgZ(3,"div",27)(4,"button",28),p.NdJ("click",(function(){p.CHM(e);const t=p.oxw();return p.KtG(t.firstPage())})),p._UZ(5,"system-custom-icon",29),p.qZA(),p.TgZ(6,"button",28),p.NdJ("click",(function(){p.CHM(e);const t=p.oxw();return p.KtG(t.prevPage())})),p._UZ(7,"system-button-icon",30),p.qZA(),p.TgZ(8,"button",28),p.NdJ("click",(function(){p.CHM(e);const t=p.oxw();return p.KtG(t.nextPage())})),p._UZ(9,"system-button-icon",31),p.qZA(),p.TgZ(10,"button",28),p.NdJ("click",(function(){p.CHM(e);const t=p.oxw();return p.KtG(t.lastPage())})),p._UZ(11,"system-custom-icon",32),p.qZA(),p.TgZ(12,"button",33),p.NdJ("click",(function(){p.CHM(e);const t=p.oxw();return p.KtG(t.selectFields())})),p._UZ(13,"system-button-icon",34),p.qZA(),p.YNc(14,it,2,0,"button",35),p.qZA()()}if(2&e){const e=p.oxw();p.xp6(2),p.AsE(" ",e.displayRecords," of ",e.presData.count," "),p.xp6(2),p.Q6J("disabled",e.prevDisabled),p.xp6(2),p.Q6J("disabled",e.prevDisabled),p.xp6(2),p.Q6J("disabled",e.nextDisabled),p.xp6(2),p.Q6J("disabled",e.nextDisabled),p.xp6(4),p.Q6J("ngIf",e.canSave)}}let ot=(()=>{var e;class ReporterDetailPresentationStandard{constructor(e,t,i,o,r,n,l,a){(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"model",void 0),(0,s.Z)(this,"modal",void 0),(0,s.Z)(this,"injector",void 0),(0,s.Z)(this,"backend",void 0),(0,s.Z)(this,"reporterconfig",void 0),(0,s.Z)(this,"cdRef",void 0),(0,s.Z)(this,"toast",void 0),(0,s.Z)(this,"httpRequestsRefID",window._.uniqueId("reporter_presentation_http_ref_")),(0,s.Z)(this,"presParams",{}),(0,s.Z)(this,"presData",{}),(0,s.Z)(this,"fieldsData",{}),(0,s.Z)(this,"fieldsDisplayClasses",{}),(0,s.Z)(this,"totalWidth",0),(0,s.Z)(this,"showFooter",!0),(0,s.Z)(this,"isLoading",!0),(0,s.Z)(this,"sortData",{sortField:"",sortDirection:""}),(0,s.Z)(this,"displayFields",[]),(0,s.Z)(this,"resizeElements",void 0),(0,s.Z)(this,"currentPage",1),(0,s.Z)(this,"subscriptions",new m.w0),this.language=e,this.model=t,this.modal=i,this.injector=o,this.backend=r,this.reporterconfig=n,this.cdRef=l,this.toast=a,this.subscriptions.add(this.reporterconfig.refresh$.subscribe({next:e=>{e?this.getPresentation():this.handleCancel()}}))}get listEntries(){try{return this.presParams.pluginData.standardViewProperties.listEntries}catch(e){return 25}}get displayRecords(){let e=(this.currentPage-1)*this.listEntries+1,t=this.currentPage*this.listEntries;return e+" - "+(t>this.presData.count?this.presData.count:t)}get canSave(){return this.model.checkAccess("edit")}get prevDisabled(){return this.currentPage<=1}get nextDisabled(){return this.currentPage*this.listEntries>=this.presData.count}ngOnInit(){this.presParams=this.model.getField("presentation_params")}ngAfterViewInit(){this.getPresentation()}ngOnDestroy(){this.subscriptions.unsubscribe(),this.backend.cancelPendingRequests([this.httpRequestsRefID])}getPresentation(){this.isLoading=!0,this.reporterconfig.isLoading.presentation=!0,this.cdRef.detectChanges();let e=[];for(let t of this.reporterconfig.userFilters)e.push({fieldid:t.fieldid,operator:t.operator,value:t.value,valuekey:t.valuekey,valueto:t.valueto,valuetokey:t.valuetokey});let t={start:(this.currentPage-1)*this.listEntries,limit:this.listEntries,whereConditions:JSON.stringify(e),parentbeanId:this.model.parentBeanId,parentbeanModule:this.model.parentBeanModule,sort:void 0};this.sortData.sortField&&(t.sort=JSON.stringify([{direction:this.sortData.sortDirection.toUpperCase(),property:this.sortData.sortField}])),this.backend.cancelPendingRequests([this.httpRequestsRefID]),this.backend.postRequest(`module/KReports/${this.model.id}/presentation/dynamicoptions`,{},t,this.httpRequestsRefID).subscribe({next:e=>{if(this.presData=[],this.cdRef.detectChanges(),e){if(0==this.totalWidth)for(let t of e.reportmetadata.fields)this.fieldsData[t.fieldid]=t,this.fieldsDisplayClasses[t.fieldid]=this.generateFieldDisplayClass(t),this.totalWidth+=t.width;this.presData=e,this.setDisplayFields(),this.processPresData(),this.isLoading=!1,this.reporterconfig.isLoading.presentation=!1,this.cdRef.detectChanges()}},error:()=>{this.toast.sendToast("ERR_LOADING_RECORD","error"),this.isLoading=!1,this.reporterconfig.isLoading.presentation=!1,this.cdRef.detectChanges()}})}processPresData(){}trackByFn(e,t){return t.id}setDisplayFields(){this.displayFields=[],this.cdRef.detectChanges(),this.presData.reportmetadata&&this.presData.reportmetadata.fields&&(this.displayFields=this.presData.reportmetadata.fields.filter((e=>"yes"==e.display)).sort(((e,t)=>e.sequence&&t.sequence?parseInt(e.sequence,10)>parseInt(t.sequence,10)?1:-1:0)),this.cdRef.detectChanges())}generateFieldDisplayClass(e){let t=[];switch(e.sort&&"-"!=e.sort&&(t.push("slds-is-sortable"),e.fieldid==this.sortData.sortField&&(t.push("slds-is-sorted"),"asc"==this.sortData.sortDirection&&t.push("slds-is-sorted_asc"))),e.type){case"currency":case"currencyint":t.push("slds-grid--align-end");break;case"enum":case"multienum":case"radioenum":t.push("slds-grid--align-center")}return t.join(" ")}toggleSort(e){"sortable"==e.sort&&(this.sortData.sortField==e.fieldid?("asc"==this.sortData.sortDirection?this.sortData.sortDirection="desc":(this.sortData.sortField="",this.sortData.sortDirection=""),this.getPresentation()):(this.sortData.sortField=e.fieldid,this.sortData.sortDirection="asc",this.getPresentation()))}onresize(){let e={},t=0;this.resizeElements.forEach((i=>{let s=i.getElementWidth();t+=s,e[i.resizeid]=i.getElementWidth()}));for(let i in this.fieldsData)this.fieldsData.hasOwnProperty(i)&&(this.fieldsData[i].width=Math.round(e[i]/t*100));this.totalWidth=100}saveLayout(){if(this.model.checkAccess("edit")){let e=[];for(let t of this.model.getField("listfields").filter((e=>"hidden"!=e.display)))e.push({dataIndex:t.fieldid,width:this.fieldsData[t.fieldid].width,sequence:parseInt(this.fieldsData[t.fieldid].sequence,10),isHidden:"yes"!=this.fieldsData[t.fieldid].display});this.backend.postRequest("module/KReports/"+this.model.id+"/layout",{},{layout:e}).subscribe((e=>{e.success&&this.toast.sendToast("Layout saved")}))}}firstPage(){this.currentPage=1,this.getPresentation()}prevPage(){this.currentPage--,this.getPresentation()}nextPage(){this.currentPage++,this.getPresentation()}lastPage(){this.currentPage=Math.ceil(this.presData.count/this.listEntries),this.getPresentation()}selectFields(){this.modal.openModal("ReporterDetailSelectFieldsModal",!0,this.injector).subscribe((e=>{e.instance.presentationFields=this.presData.reportmetadata.fields,e.instance.dataChanged$.subscribe((e=>{e&&this.setDisplayFields()}))}))}handleCancel(){this.isLoading=!1,this.reporterconfig.isLoading.presentation=!1,this.backend.cancelPendingRequests([this.httpRequestsRefID]),this.cdRef.detectChanges()}}return e=ReporterDetailPresentationStandard,(0,s.Z)(ReporterDetailPresentationStandard,"ɵfac",(function(t){return new(t||e)(p.Y36(Z.d),p.Y36(h.o),p.Y36(Pe.o),p.Y36(p.zs3),p.Y36(w.y),p.Y36(u.s),p.Y36(p.sBO),p.Y36(B.A))})),(0,s.Z)(ReporterDetailPresentationStandard,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-detail-presentation-standard"]],viewQuery:function(e,t){if(1&e&&p.Gf(Ne.h,5),2&e){let e;p.iGM(e=p.CRH())&&(t.resizeElements=e)}},decls:11,vars:7,consts:[[1,"slds-height_full","slds-grid","slds-grid--vertical"],[1,"slds-scrollable--y","slds-grow","slds-grid","slds-grid--vertical",2,"min-height","0",3,"cancellable","system-overlay-loading-spinner","onCancel"],[1,"slds-table","slds-table_bordered","slds-table--fixed-layout","slds-table--header-fixed"],[1,"slds-text-title--caps"],["scope","col","class","slds-resizable",3,"ngClass","width","resizeid","system-resize",4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],["class","slds-p-around--medium slds-align--absolute-center slds-grow","style","min-height: 0",4,"ngIf"],["class","slds-p-vertical--x-small slds-grid slds-grid_vertical-align-center slds-grid_align-spread",4,"ngIf"],["scope","col",1,"slds-resizable",3,"ngClass","resizeid","system-resize"],["href","javascript:void(0);","class","slds-th__action slds-text-link--reset slds-grid",3,"ngClass","click",4,"ngIf","ngIfElse"],["notsortable",""],["href","javascript:void(0);",1,"slds-th__action","slds-text-link--reset","slds-grid",3,"ngClass","click"],[1,"slds-truncate","slds-p-vertical--xx-small"],[3,"label"],["icon","arrowdown","size","x-small",3,"transform",4,"ngIf"],["icon","arrowdown","size","x-small"],[1,"slds-th__action","slds-grid"],[1,"slds-truncate"],["style","vertical-align: top;",4,"ngFor","ngForOf","ngForTrackBy"],[2,"vertical-align","top"],["scope","row",4,"ngFor","ngForOf","ngForTrackBy"],["scope","row"],[3,"field","record"],[1,"slds-p-around--medium","slds-align--absolute-center","slds-grow",2,"min-height","0"],[1,"slds-text-heading--small"],["label","LBL_NO_ENTRIES"],[1,"slds-p-vertical--x-small","slds-grid","slds-grid_vertical-align-center","slds-grid_align-spread"],[1,"slds-p-horizontal--medium"],[1,"slds-button","slds-button_icon",3,"disabled","click"],["icon","chevrondoubleleft","size","x-small"],["icon","chevronleft"],["icon","chevronright"],["icon","chevrondoubleright","size","x-small"],["system-title","LBL_CHOOSE_FIELDS",1,"slds-button","slds-button_icon",3,"click"],["icon","settings"],["class","slds-button slds-button_icon","system-title","LBL_SAVE_LAYOUT",3,"click",4,"ngIf"],["system-title","LBL_SAVE_LAYOUT",1,"slds-button","slds-button_icon",3,"click"],["icon","save"]],template:function(e,t){1&e&&(p.TgZ(0,"div",0)(1,"div",1),p.NdJ("onCancel",(function(){return t.handleCancel()})),p.TgZ(2,"table",2)(3,"thead")(4,"tr",3),p.YNc(5,Xe,4,6,"th",4),p.qZA()(),p.TgZ(6,"tbody"),p.YNc(7,et,2,2,"ng-container",5),p.qZA()(),p.YNc(8,tt,3,0,"div",6),p.qZA(),p.TgZ(9,"div"),p.YNc(10,st,15,7,"div",7),p.qZA()()),2&e&&(p.xp6(1),p.Q6J("cancellable",!0)("system-overlay-loading-spinner",t.isLoading),p.xp6(4),p.Q6J("ngForOf",t.displayFields)("ngForTrackBy",t.trackByFn),p.xp6(2),p.Q6J("ngIf",(null==t.presData||null==t.presData.records?null:t.presData.records.length)>0),p.xp6(1),p.Q6J("ngIf",!t.isLoading&&0==(null==t.presData.records?null:t.presData.records.length)),p.xp6(2),p.Q6J("ngIf",t.showFooter))},dependencies:[o.mk,o.sg,o.O5,A.J,Oe.$,M._,Ue.r,be._,Ne.h,Le.S,Ve],encapsulation:2,changeDetection:0})),ReporterDetailPresentationStandard})();var rt=i(1135),nt=i(9621),lt=i(3499),at=i(5767),dt=i(1916);function ct(e,t){if(1&e&&(p.TgZ(0,"div",16)(1,"span",17),p._UZ(2,"system-label",18),p.qZA()()),2&e){const e=t.$implicit;p.Q6J("cdkDragData",e),p.xp6(2),p.Q6J("label",e.name)}}function pt(e,t){if(1&e&&(p.TgZ(0,"div",16)(1,"span",17),p._UZ(2,"system-label",18),p.qZA()()),2&e){const e=t.$implicit;p.Q6J("cdkDragData",e),p.xp6(2),p.Q6J("label",e.name)}}const ht=function(e){return[e]};let ut=(()=>{var e;class ReporterDetailSelectFieldsModal{constructor(e,t){(0,s.Z)(this,"metadata",void 0),(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"dataChanged$",new rt.X(!1)),(0,s.Z)(this,"presentationFields",[]),(0,s.Z)(this,"self",{}),(0,s.Z)(this,"availableFields",[]),(0,s.Z)(this,"displayFields",[]),this.metadata=e,this.language=t}ngOnInit(){this.availableFields=this.presentationFields.filter((e=>"no"==e.display)),this.displayFields=this.presentationFields.filter((e=>"yes"==e.display)),this.availableFields.length>0&&this.sortAvailableFields(),this.displayFields.sort(((e,t)=>e.sequence&&t.sequence?parseInt(e.sequence,10)>parseInt(t.sequence,10)?1:-1:0))}sortAvailableFields(){this.availableFields=this.availableFields.sort(((e,t)=>this.language.getLabel(e.name).toLowerCase()>this.language.getLabel(t.name).toLowerCase()?1:-1))}close(){this.self.destroy()}canSet(){return this.displayFields.length>0}set(){if(this.canSet()){let e=1;for(let t of this.displayFields)t.display="yes",t.sequence=e,t.width||(t.width=25),e++;for(let t of this.availableFields)t.display="no",t.sequence=e,e++;this.presentationFields.sort(((e,t)=>e.sequence&&t.sequence?parseInt(e.sequence,10)>parseInt(t.sequence,10)?1:-1:0)),this.dataChanged$.next(!0),this.dataChanged$.complete(),this.close()}}onFieldDrop(e){let t=e.previousContainer.data.splice(e.previousIndex,1);e.container.data.splice(e.currentIndex,0,t[0])}}return e=ReporterDetailSelectFieldsModal,(0,s.Z)(ReporterDetailSelectFieldsModal,"ɵfac",(function(t){return new(t||e)(p.Y36(b.Pu),p.Y36(Z.d))})),(0,s.Z)(ReporterDetailSelectFieldsModal,"ɵcmp",p.Xpm({type:e,selectors:[["ng-component"]],decls:22,vars:11,consts:[[3,"close"],["label","LBL_SETFIELDS"],[1,"slds-grid"],[1,"slds-form-element","slds-p-horizontal--small","slds-size--1-of-2"],[1,"slds-form-element__label"],["label","LBL_AVAILABLE_FIELDS"],["cdkDropList","",1,"slds-picklist","slds-picklist__options","slds-size--1-of-1",2,"height","50vh",3,"cdkDropListData","cdkDropListConnectedTo","cdkDropListDropped"],["listOne","cdkDropList"],["cdkDrag","","class","slds-drag--preview slds-picklist__item","role","option",3,"cdkDragData",4,"ngFor","ngForOf"],["label","LBL_SELECTED_FIELDS"],["cdkDropList","",1,"slds-picklist","slds-picklist__options","slds-size--1-of-1","cdk-drag",2,"height","50vh",3,"cdkDropListData","cdkDropListConnectedTo","cdkDropListDropped"],["listTwo","cdkDropList"],[1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_CANCEL"],[1,"slds-button","slds-button--brand",3,"disabled","click"],["label","LBL_SET"],["cdkDrag","","role","option",1,"slds-drag--preview","slds-picklist__item",3,"cdkDragData"],[1,"slds-truncate"],[3,"label"]],template:function(e,t){if(1&e&&(p.TgZ(0,"system-modal")(1,"system-modal-header",0),p.NdJ("close",(function(){return t.close()})),p._UZ(2,"system-label",1),p.qZA(),p.TgZ(3,"system-modal-content")(4,"div",2)(5,"div",3)(6,"span",4),p._UZ(7,"system-label",5),p.qZA(),p.TgZ(8,"div",6,7),p.NdJ("cdkDropListDropped",(function(e){return t.onFieldDrop(e)})),p.YNc(10,ct,3,2,"div",8),p.qZA()(),p.TgZ(11,"div",3)(12,"span",4),p._UZ(13,"system-label",9),p.qZA(),p.TgZ(14,"div",10,11),p.NdJ("cdkDropListDropped",(function(e){return t.onFieldDrop(e)})),p.YNc(16,pt,3,2,"div",8),p.qZA()()()(),p.TgZ(17,"system-modal-footer")(18,"button",12),p.NdJ("click",(function(){return t.close()})),p._UZ(19,"system-label",13),p.qZA(),p.TgZ(20,"button",14),p.NdJ("click",(function(){return t.set()})),p._UZ(21,"system-label",15),p.qZA()()()),2&e){const e=p.MAs(9),i=p.MAs(15);p.xp6(8),p.Q6J("cdkDropListData",t.availableFields)("cdkDropListConnectedTo",p.VKq(7,ht,i)),p.xp6(2),p.Q6J("ngForOf",t.availableFields),p.xp6(4),p.Q6J("cdkDropListData",t.displayFields)("cdkDropListConnectedTo",p.VKq(9,ht,e)),p.xp6(2),p.Q6J("ngForOf",t.displayFields),p.xp6(4),p.Q6J("disabled",!t.canSet())}},dependencies:[o.sg,M._,nt.j,lt.x,at.p,dt.y,c.Wj,c.Zt],encapsulation:2,changeDetection:0})),ReporterDetailSelectFieldsModal})();var gt=i(2067);let ft=(()=>{var e;class ReporterDetailVisualizationGooglecharts{constructor(e,t,i,o,r){(0,s.Z)(this,"renderer",void 0),(0,s.Z)(this,"elementRef",void 0),(0,s.Z)(this,"metadata",void 0),(0,s.Z)(this,"zone",void 0),(0,s.Z)(this,"libloader",void 0),(0,s.Z)(this,"vizdata",{}),(0,s.Z)(this,"wrapper",void 0),(0,s.Z)(this,"resizeHandler",{}),this.renderer=e,this.elementRef=t,this.metadata=i,this.zone=o,this.libloader=r,this.resizeHandler=this.renderer.listen("window","resize",(()=>this.onResize()))}ngAfterViewInit(){this.loadGoogleChart()}loadGoogleChart(){this.vizdata.data.options.height||(this.vizdata.data.options.height=this.elementRef.nativeElement.height),this.libloader.loadLib("googlecharts").subscribe((e=>{this.zone.runOutsideAngular((()=>{google.charts.load("current",{packages:["corechart"]}),google.charts.setOnLoadCallback((()=>{this.drawchart()}))}))}))}ngOnDestroy(){this.resizeHandler()}drawchart(){this.wrapper=new google.visualization.ChartWrapper(this.vizdata.data),this.wrapper.draw()}onResize(){this.wrapper&&this.zone.runOutsideAngular((()=>{this.wrapper.draw()}))}}return e=ReporterDetailVisualizationGooglecharts,(0,s.Z)(ReporterDetailVisualizationGooglecharts,"ɵfac",(function(t){return new(t||e)(p.Y36(p.Qsj),p.Y36(p.SBq),p.Y36(b.Pu),p.Y36(p.R0b),p.Y36(gt.$))})),(0,s.Z)(ReporterDetailVisualizationGooglecharts,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-detail-visualization-googlecharts"]],decls:2,vars:2,consts:[[1,"slds-is-absolute","slds-box--border","slds-p-vertical--small","slds-p-horizontal--small",3,"ngStyle"],[2,"width","100%","height","100%",3,"id"]],template:function(e,t){1&e&&(p.TgZ(0,"div",0),p._UZ(1,"div",1),p.qZA()),2&e&&(p.Q6J("ngStyle",null==t.vizdata?null:t.vizdata.layout),p.xp6(1),p.Q6J("id",t.vizdata.uid))},dependencies:[o.PC],encapsulation:2,changeDetection:0})),ReporterDetailVisualizationGooglecharts})();function mt(e,t){if(1&e&&p._UZ(0,"reporter-detail-visualization",1),2&e){const e=p.oxw();p.Q6J("parentId",e.parentId)("parentModule",e.parentModule)("displayEmbedded",!0)}}let vt=(()=>{var e;class ReporterVisualizationDashlet{constructor(e,t){(0,s.Z)(this,"model",void 0),(0,s.Z)(this,"reporterconfig",void 0),(0,s.Z)(this,"id",""),(0,s.Z)(this,"config",void 0),(0,s.Z)(this,"parentModule",""),(0,s.Z)(this,"parentId",""),(0,s.Z)(this,"componentconfig",{}),(0,s.Z)(this,"hasVisualization",!1),(0,s.Z)(this,"noAccess",new p.vpe),this.model=e,this.reporterconfig=t}ngOnInit(){this.config&&(this.componentconfig=this.config)}ngAfterViewInit(){""!==this.componentconfig.reportid&&(this.model.module="KReports",this.model.id=this.componentconfig.reportid,this.model.getData().subscribe((e=>{""!=e.visualization_params&&(this.hasVisualization=!0)}),(e=>{"403"!=e.status&&"404"!=e.status||this.noAccess.emit(!0)})))}}return e=ReporterVisualizationDashlet,(0,s.Z)(ReporterVisualizationDashlet,"ɵfac",(function(t){return new(t||e)(p.Y36(h.o),p.Y36(u.s))})),(0,s.Z)(ReporterVisualizationDashlet,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-visualization-dashlet"]],inputs:{id:"id",config:"config",parentModule:"parentModule",parentId:"parentId"},outputs:{noAccess:"noAccess"},features:[p._Bn([h.o,u.s])],decls:1,vars:1,consts:[[3,"parentId","parentModule","displayEmbedded",4,"ngIf"],[3,"parentId","parentModule","displayEmbedded"]],template:function(e,t){1&e&&p.YNc(0,mt,1,3,"reporter-detail-visualization",0),2&e&&p.Q6J("ngIf",t.hasVisualization)},dependencies:[o.O5,_e],encapsulation:2})),ReporterVisualizationDashlet})();const Zt=function(e){return{"slds-hide":e}};let bt=(()=>{var e;class ReporterVisualizationContainer{constructor(e){(0,s.Z)(this,"model",void 0),(0,s.Z)(this,"componentconfig",{}),(0,s.Z)(this,"isHidden",!1),this.model=e}noAccess(e){this.isHidden=e}}return e=ReporterVisualizationContainer,(0,s.Z)(ReporterVisualizationContainer,"ɵfac",(function(t){return new(t||e)(p.Y36(h.o))})),(0,s.Z)(ReporterVisualizationContainer,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-visualization-container"]],decls:2,vars:6,consts:[[1,"slds-card","slds-m-bottom--medium",2,"height","300px","width","100%",3,"ngClass"],[3,"config","parentModule","parentId","noAccess"]],template:function(e,t){1&e&&(p.TgZ(0,"div",0)(1,"reporter-visualization-dashlet",1),p.NdJ("noAccess",(function(e){return t.noAccess(e)})),p.qZA()()),2&e&&(p.Q6J("ngClass",p.VKq(4,Zt,t.isHidden)),p.xp6(1),p.Q6J("config",t.componentconfig)("parentModule",t.model.module)("parentId",t.model.id))},dependencies:[o.mk,vt],styles:["[_nghost-%COMP%]{height:300px;width:100%}"]})),ReporterVisualizationContainer})();var wt=i(7579);const yt=["presentationcontainer"];function _t(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"h2",3),p.NdJ("click",(function(){p.CHM(e);const t=p.oxw();return p.KtG(t.openReport())})),p.TgZ(1,"span",4),p._uU(2),p.qZA()()}if(2&e){const e=p.oxw();p.xp6(2),p.Oqu(e.model.data.name)}}let xt=(()=>{var e;class ReporterPresentationDashlet{constructor(e,t,i,o,r,n){(0,s.Z)(this,"model",void 0),(0,s.Z)(this,"metadata",void 0),(0,s.Z)(this,"elementRef",void 0),(0,s.Z)(this,"toast",void 0),(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"reporterconfig",void 0),(0,s.Z)(this,"presentationcontainer",void 0),(0,s.Z)(this,"parentModule",""),(0,s.Z)(this,"parentId",""),(0,s.Z)(this,"displayheader",!0),(0,s.Z)(this,"componentconfig",{}),(0,s.Z)(this,"refreshReport",new wt.x),(0,s.Z)(this,"dashletTitle",new p.vpe),(0,s.Z)(this,"presComponent",void 0),(0,s.Z)(this,"noAccess",new p.vpe),this.model=e,this.metadata=t,this.elementRef=i,this.toast=o,this.language=r,this.reporterconfig=n}ngAfterViewInit(){""!==this.componentconfig.reportid&&(this.model.module="KReports",this.model.id=this.componentconfig.reportid,this.parentId&&this.parentModule&&(this.model.parentBeanId=this.parentId,this.model.parentBeanModule=this.parentModule),this.model.getData().subscribe({next:e=>{this.dashletTitle.emit(this.model.getField("name")),this.renderPresentation()},error:e=>{"403"==e.status||"404"==e.status?this.noAccess.emit(!0):this.toast.sendToast(this.language.getLabel("LBL_ERROR_LOADING_DATA"),"error")}}))}ngOnInit(){this.refreshReport.subscribe((e=>{e&&this.reporterconfig.refresh()}))}get containerstyle(){this.presentationcontainer.element.nativeElement.getBoundingClientRect();return{height:"calc(100% - "+this.presentationcontainer.element.nativeElement.offsetTop+"px)"}}openReport(){this.model.goDetail()}renderPresentation(){this.presComponent&&(this.presComponent.destroy(),this.presComponent=void 0);let e="";switch(this.model.getField("presentation_params").plugin){case"standard":e="ReporterDetailPresentationStandard";break;case"grouped":e="ReporterDetailPresentationGrouped";break;case"standardws":e="ReporterDetailPresentationStandardWS";break;case"tree":e="ReporterDetailPresentationTree";break;case"pivot":e="ReporterDetailPresentationPivot"}""!=e&&this.metadata.addComponent(e,this.presentationcontainer).subscribe((e=>{e.instance.showFooter=!1,this.presComponent=e}))}}return e=ReporterPresentationDashlet,(0,s.Z)(ReporterPresentationDashlet,"ɵfac",(function(t){return new(t||e)(p.Y36(h.o),p.Y36(b.Pu),p.Y36(p.SBq),p.Y36(B.A),p.Y36(Z.d),p.Y36(u.s))})),(0,s.Z)(ReporterPresentationDashlet,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-presentation-dashlet"]],viewQuery:function(e,t){if(1&e&&p.Gf(yt,7,p.s_b),2&e){let e;p.iGM(e=p.CRH())&&(t.presentationcontainer=e.first)}},inputs:{parentModule:"parentModule",parentId:"parentId",displayheader:"displayheader",componentconfig:"componentconfig",refreshReport:"refreshReport"},outputs:{dashletTitle:"dashletTitle",noAccess:"noAccess"},features:[p._Bn([h.o,u.s])],decls:4,vars:2,consts:[["class","slds-text-heading--medium slds-p-around--medium",3,"click",4,"ngIf"],[1,"slds-scrollable--y",3,"ngStyle"],["presentationcontainer",""],[1,"slds-text-heading--medium","slds-p-around--medium",3,"click"],[1,"slds-text-link_faux"]],template:function(e,t){1&e&&(p.YNc(0,_t,3,1,"h2",0),p.TgZ(1,"div",1),p._UZ(2,"div",null,2),p.qZA()),2&e&&(p.Q6J("ngIf",t.displayheader),p.xp6(1),p.Q6J("ngStyle",t.containerstyle))},dependencies:[o.O5,o.PC],styles:["[_nghost-%COMP%]{height:100%;width:100%}"]})),ReporterPresentationDashlet})();const Ft=function(e){return{"slds-hide":e}};let Rt=(()=>{var e;class ReporterPresentationContainer{constructor(e,t,i){(0,s.Z)(this,"model",void 0),(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"reporterconfig",void 0),(0,s.Z)(this,"componentconfig",{}),(0,s.Z)(this,"dashletTitle",void 0),(0,s.Z)(this,"isHidden",!1),(0,s.Z)(this,"refreshReport",new wt.x),this.model=e,this.language=t,this.reporterconfig=i}get title(){return this.dashletTitle?this.dashletTitle:this.language.getModuleName("KReports")}noAccess(e){this.isHidden=e}execute(){this.refreshReport.next(!0)}}return e=ReporterPresentationContainer,(0,s.Z)(ReporterPresentationContainer,"ɵfac",(function(t){return new(t||e)(p.Y36(h.o),p.Y36(Z.d),p.Y36(u.s))})),(0,s.Z)(ReporterPresentationContainer,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-presentation-container"]],features:[p._Bn([u.s])],decls:13,vars:10,consts:[[1,"slds-card","slds-card_boundary","slds-m-bottom--medium",3,"ngClass"],[1,"slds-card__header","slds-grid","slds-grid--vertical-align-center"],[1,"slds-media","slds-media--center","slds-has-flexi-truncate"],["module","KReports",3,"size"],[1,"slds-media__body","slds-truncate","slds-grid","slds-grid--vertical-align-center"],[1,"slds-text-heading--small"],[3,"refreshReport","componentconfig","parentModule","parentId","displayheader","dashletTitle","noAccess"],[1,"slds-card__footer"],[1,"slds-grid","slds-grid_align-end"],[1,"slds-text-align--right"],[1,"slds-button","slds-button_icon",3,"click"],["icon","refresh"]],template:function(e,t){1&e&&(p.TgZ(0,"div",0)(1,"div",1)(2,"header",2),p._UZ(3,"system-icon",3),p.TgZ(4,"div",4)(5,"h2",5),p._uU(6),p.qZA()()()(),p.TgZ(7,"reporter-presentation-dashlet",6),p.NdJ("dashletTitle",(function(e){return t.dashletTitle=e}))("noAccess",(function(e){return t.noAccess(e)})),p.qZA(),p.TgZ(8,"footer",7)(9,"div",8)(10,"div",9)(11,"button",10),p.NdJ("click",(function(){return t.execute()})),p._UZ(12,"system-button-icon",11),p.qZA()()()()()),2&e&&(p.Q6J("ngClass",p.VKq(8,Ft,t.isHidden)),p.xp6(3),p.Q6J("size","small"),p.xp6(3),p.Oqu(t.title),p.xp6(1),p.Q6J("refreshReport",t.refreshReport)("componentconfig",t.componentconfig)("parentModule",t.model.module)("parentId",t.model.id)("displayheader",!1))},dependencies:[o.mk,A.J,T.f,xt],encapsulation:2})),ReporterPresentationContainer})();var Ct=i(5684),kt=i(2644),It=i(6625);let Tt=(()=>{var e;class ReporterCockpitTile{constructor(e,t){(0,s.Z)(this,"backend",void 0),(0,s.Z)(this,"router",void 0),(0,s.Z)(this,"report",{}),this.backend=e,this.router=t}navigateDetail(){this.router.navigate(["/module/KReports/"+this.report.id])}}return e=ReporterCockpitTile,(0,s.Z)(ReporterCockpitTile,"ɵfac",(function(t){return new(t||e)(p.Y36(w.y),p.Y36(y.F0))})),(0,s.Z)(ReporterCockpitTile,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-cockpit-tile"]],hostAttrs:[1,"slds-tile","slds-media","slds-p-vertical--small","slds-card__tile","slds-p-horizontal--small","slds-size--1-of-3","slds-hint-parent"],inputs:{report:"report"},decls:9,vars:4,consts:[[1,"slds-media__figure","slds-m-right--none","slds-p-top--xxx-small"],[3,"module"],[1,"slds-media__body","slds-truncate"],[1,"slds-grid","slds-grid--align-spread","slds-has-flexi-truncate"],[1,"slds-truncate"],["href","javascript:void(0);",3,"click"],[1,"slds-tile__detail","slds-text-body--small",3,"title"],[1,"slds-item--detail","slds-truncate",3,"innerHtml"]],template:function(e,t){1&e&&(p.TgZ(0,"div",0),p._UZ(1,"system-icon",1),p.qZA(),p.TgZ(2,"div",2)(3,"div",3)(4,"h3",4)(5,"a",5),p.NdJ("click",(function(){return t.navigateDetail()})),p._uU(6),p.qZA()()(),p.TgZ(7,"div",6),p._UZ(8,"dd",7),p.qZA()()),2&e&&(p.xp6(1),p.Q6J("module",t.report.report_module),p.xp6(5),p.hij(" ",t.report.name," "),p.xp6(1),p.Q6J("title",t.report.description),p.xp6(1),p.Q6J("innerHtml",t.report.description,p.oJD))},dependencies:[T.f],encapsulation:2})),ReporterCockpitTile})();function Dt(e,t){if(1&e&&p._UZ(0,"reporter-cockpit-tile",12),2&e){const e=t.$implicit;p.Q6J("report",e)}}function Jt(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"div",13)(1,"div"),p._uU(2),p._UZ(3,"system-label",14),p._uU(4),p.qZA(),p.TgZ(5,"div",15)(6,"a",16),p.NdJ("click",(function(){p.CHM(e);const t=p.oxw(2).$implicit,i=p.oxw();return p.KtG(i.loadMore(t.bucket))})),p._UZ(7,"system-label",17),p.qZA()()()}if(2&e){const e=p.oxw(2).$implicit;p.xp6(2),p.hij(" ",e.items," "),p.xp6(2),p.hij(" ",e.total," ")}}function At(e,t){if(1&e&&(p.TgZ(0,"article",3)(1,"div",4)(2,"header",5)(3,"div",6)(4,"h2")(5,"span",7),p._uU(6),p.qZA()()()()(),p.TgZ(7,"div",8)(8,"div",9),p.YNc(9,Dt,1,1,"reporter-cockpit-tile",10),p.qZA()(),p.YNc(10,Jt,8,2,"div",11),p.qZA()),2&e){const e=p.oxw().$implicit,t=p.oxw();p.xp6(6),p.AsE("",e.bucket," (",e.items,")"),p.xp6(3),p.Q6J("ngForOf",t.getCategoryReports(e.bucket)),p.xp6(1),p.Q6J("ngIf",e.items<e.total)}}function Mt(e,t){if(1&e&&(p.ynx(0),p.YNc(1,At,11,4,"article",2),p.BQk()),2&e){const e=t.$implicit;p.xp6(1),p.Q6J("ngIf",(null==e?null:e.items)>0)}}let Yt=(()=>{var e;class ReporterCockpit{constructor(e,t,i,o,r){(0,s.Z)(this,"backend",void 0),(0,s.Z)(this,"modellist",void 0),(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"configuration",void 0),(0,s.Z)(this,"metadata",void 0),(0,s.Z)(this,"componentconfig",{}),(0,s.Z)(this,"subscriptions",new m.w0),(0,s.Z)(this,"allFields",[]),this.backend=e,this.modellist=t,this.language=i,this.configuration=o,this.metadata=r}get sortField(){return this.componentconfig.sortfield}get sortDirection(){return this.componentconfig.sortdirection?this.componentconfig.sortdirection:"ASC"}ngOnInit(){this.initialize()}initialize(){this.componentconfig=this.metadata.getComponentConfig("ReporterCockpit",this.modellist.module),this.modellist.loadlimit=15,this.loadCategories(),this.sortField&&this.modellist.setSortField(this.sortField,this.sortDirection),this.subscriptions.add(this.modellist.listType$.pipe((0,Ct.T)(1)).subscribe((e=>this.handleListTypeChange(e))))}handleListTypeChange(e){"ReporterCockpit"==e.listcomponent&&this.modellist.reLoadList()}loadCategories(){const e=this.configuration.getData("reportcategories");e?(this.setBuckets(e),this.modellist.getListData()):this.backend.getRequest("module/KReports/categoriesmanager/categories").subscribe((e=>{e&&(this.setBuckets(e),this.modellist.getListData())}))}setBuckets(e){this.modellist.buckets={bucketfield:"category_name",buckettotal:[],bucketitems:e.map((e=>({bucket:e.name,values:{},items:0,hidden:!1})))}}ngOnDestroy(){this.modellist.buckets={}}loadMore(e){this.modellist.loadMoreBucketList(e)}getCategoryReports(e){return this.modellist.listData.list.filter((t=>t.category_name==e))}}return e=ReporterCockpit,(0,s.Z)(ReporterCockpit,"ɵfac",(function(t){return new(t||e)(p.Y36(w.y),p.Y36(kt.t),p.Y36(Z.d),p.Y36(It.C),p.Y36(b.Pu))})),(0,s.Z)(ReporterCockpit,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-cockpit"]],decls:2,vars:2,consts:[[1,"slds-scrollable",2,"height","100%",3,"system-overlay-loading-spinner"],[4,"ngFor","ngForOf"],["class","slds-card slds-m-around--medium",4,"ngIf"],[1,"slds-card","slds-m-around--medium"],[1,"slds-card__header","slds-grid"],[1,"slds-media","slds-media--center","slds-has-flexi-truncate"],[1,"slds-media__body"],[1,"slds-text-heading--medium"],[1,"slds-card__body","slds-card__body_inner"],[1,"slds-card__body--inner","slds-grid","slds-wrap","slds-grid--pull-padded"],[3,"report",4,"ngFor","ngForOf"],["class","slds-card__footer slds-grid",4,"ngIf"],[3,"report"],[1,"slds-card__footer","slds-grid"],["label","LBL_OF"],[1,"slds-grow"],["href","javascript:void(0);",3,"click"],["label","LBL_MORE"]],template:function(e,t){1&e&&(p.TgZ(0,"div",0),p.YNc(1,Mt,2,1,"ng-container",1),p.qZA()),2&e&&(p.Q6J("system-overlay-loading-spinner",t.modellist.isLoading),p.xp6(1),p.Q6J("ngForOf",null==t.modellist.buckets?null:t.modellist.buckets.bucketitems))},dependencies:[o.sg,o.O5,M._,be._,Tt],encapsulation:2})),ReporterCockpit})();function qt(e,t){if(1&e&&(p.TgZ(0,"div",1),p._uU(1),p.qZA()),2&e){const e=p.oxw();p.xp6(1),p.hij(" ",e.record[e.field.fieldid],"\n")}}let Nt=(()=>{var e;class ReporterFieldStandard{constructor(){(0,s.Z)(this,"record",{}),(0,s.Z)(this,"field",{})}}return e=ReporterFieldStandard,(0,s.Z)(ReporterFieldStandard,"ɵfac",(function(t){return new(t||e)})),(0,s.Z)(ReporterFieldStandard,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-field-standard"]],decls:1,vars:1,consts:[["class","slds-truncate",4,"ngIf"],[1,"slds-truncate"]],template:function(e,t){1&e&&p.YNc(0,qt,2,1,"div",0),2&e&&p.Q6J("ngIf",t.record)},dependencies:[o.O5],encapsulation:2,changeDetection:0})),ReporterFieldStandard})();var Pt=i(6550);let Ot=(()=>{var e;class ReporterFieldText{constructor(e){(0,s.Z)(this,"sanitizer",void 0),(0,s.Z)(this,"record",{}),(0,s.Z)(this,"field",{}),(0,s.Z)(this,"value",""),this.sanitizer=e}ngOnInit(){this.setFormattedFieldValue()}setFormattedFieldValue(){this.record[this.field.fieldid]&&(this.value=this.sanitizer.bypassSecurityTrustHtml(this.record[this.field.fieldid].replace(/(?:\r\n|\r|\n)/g,"<br>")))}}return e=ReporterFieldText,(0,s.Z)(ReporterFieldText,"ɵfac",(function(t){return new(t||e)(p.Y36(Pt.H7))})),(0,s.Z)(ReporterFieldText,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-field-text"]],decls:1,vars:1,consts:[[1,"slds-truncate",2,"white-space","normal",3,"innerHTML"]],template:function(e,t){1&e&&p._UZ(0,"div",0),2&e&&p.Q6J("innerHTML",t.value,p.oJD)},encapsulation:2,changeDetection:0})),ReporterFieldText})();var Ut=i(5547),Lt=i(2422);let zt=(()=>{var e;class ReporterFieldCurrency{constructor(e,t){(0,s.Z)(this,"currency",void 0),(0,s.Z)(this,"userpreferences",void 0),(0,s.Z)(this,"record",{}),(0,s.Z)(this,"field",{}),(0,s.Z)(this,"value",""),(0,s.Z)(this,"currencySymbol",""),this.currency=e,this.userpreferences=t}ngOnInit(){this.setCurrencySymbol(),this.setFormattedFieldValue()}setCurrencySymbol(){if(!this.record[this.field.fieldid])return;let e=-99;const t=this.field.fieldid+"_curid",i=this.currency.getCurrencies()||[];t&&(e=this.record[t]);const s=i.find((t=>t.id==e));this.currencySymbol=s?s.symbol:""}setFormattedFieldValue(){this.record[this.field.fieldid]?this.value=this.userpreferences.formatMoney(parseFloat(this.record[this.field.fieldid])):this.value=""}}return e=ReporterFieldCurrency,(0,s.Z)(ReporterFieldCurrency,"ɵfac",(function(t){return new(t||e)(p.Y36(Ut.A),p.Y36(Lt.z))})),(0,s.Z)(ReporterFieldCurrency,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-field-currency"]],decls:5,vars:2,consts:[[1,"slds-grid","slds-grid--align-end"],[1,"slds-text-align--right"]],template:function(e,t){1&e&&(p.TgZ(0,"div",0)(1,"div"),p._uU(2),p.qZA(),p.TgZ(3,"div",1),p._uU(4),p.qZA()()),2&e&&(p.xp6(2),p.hij(" ",t.currencySymbol," "),p.xp6(2),p.hij(" ",t.value," "))},encapsulation:2,changeDetection:0})),ReporterFieldCurrency})(),Qt=(()=>{var e;class ReporterFieldPercentage{constructor(e){(0,s.Z)(this,"userpreferences",void 0),(0,s.Z)(this,"record",{}),(0,s.Z)(this,"field",{}),(0,s.Z)(this,"value",""),this.userpreferences=e}ngOnInit(){this.setFormattedFieldValue()}setFormattedFieldValue(){this.record[this.field.fieldid]?this.value=this.userpreferences.formatMoney(parseFloat(this.record[this.field.fieldid]),2,99)+"%":this.value=""}}return e=ReporterFieldPercentage,(0,s.Z)(ReporterFieldPercentage,"ɵfac",(function(t){return new(t||e)(p.Y36(Lt.z))})),(0,s.Z)(ReporterFieldPercentage,"ɵcmp",p.Xpm({type:e,selectors:[["ng-component"]],decls:2,vars:1,consts:[[1,"slds-text-align--center"]],template:function(e,t){1&e&&(p.TgZ(0,"div",0),p._uU(1),p.qZA()),2&e&&(p.xp6(1),p.hij(" ",t.value,"\n"))},encapsulation:2,changeDetection:0})),ReporterFieldPercentage})(),Et=(()=>{var e;class ReporterFieldEnum{constructor(e,t){(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"metadata",void 0),(0,s.Z)(this,"record",{}),(0,s.Z)(this,"field",{}),(0,s.Z)(this,"value",""),this.language=e,this.metadata=t}ngOnInit(){this.setFormattedFieldValue()}setFormattedFieldValue(){let e=this.field.path.split("::"),t=e.length;const i=e[t-1].split(":")[1];let s,o=e[t-2].split(":");switch(o[0]){case"root":s=o[1];break;case"link":s=this.metadata.getFieldDefs(o[1],o[2]).module}this.value=i&&s?this.language.getFieldDisplayOptionValue(s,i,this.record[this.field.fieldid+"_val"]):this.record[this.field.fieldid]}}return e=ReporterFieldEnum,(0,s.Z)(ReporterFieldEnum,"ɵfac",(function(t){return new(t||e)(p.Y36(Z.d),p.Y36(b.Pu))})),(0,s.Z)(ReporterFieldEnum,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-field-enum"]],decls:2,vars:1,consts:[[1,"slds-truncate","slds-text-align--center"]],template:function(e,t){1&e&&(p.TgZ(0,"div",0),p._uU(1),p.qZA()),2&e&&(p.xp6(1),p.hij(" ",t.value,"\n"))},encapsulation:2,changeDetection:0})),ReporterFieldEnum})(),St=(()=>{var e;class ReporterFieldDate{constructor(e){(0,s.Z)(this,"userpreferences",void 0),(0,s.Z)(this,"record",{}),(0,s.Z)(this,"field",{}),(0,s.Z)(this,"value",""),this.userpreferences=e}ngOnInit(){this.setFormattedFieldValue()}setFormattedFieldValue(){if(this.record[this.field.fieldid]){let e=new moment.utc(this.record[this.field.fieldid]);e.isValid()&&(this.value=e.format(this.userpreferences.getDateFormat()))}}}return e=ReporterFieldDate,(0,s.Z)(ReporterFieldDate,"ɵfac",(function(t){return new(t||e)(p.Y36(Lt.z))})),(0,s.Z)(ReporterFieldDate,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-field-date"]],decls:2,vars:1,consts:[[1,"slds-truncate"]],template:function(e,t){1&e&&(p.TgZ(0,"div",0),p._uU(1),p.qZA()),2&e&&(p.xp6(1),p.hij(" ",t.value,"\n"))},encapsulation:2,changeDetection:0})),ReporterFieldDate})(),Bt=(()=>{var e;class ReporterFieldDateTime{constructor(e,t,i,o){(0,s.Z)(this,"userpreferences",void 0),(0,s.Z)(this,"session",void 0),(0,s.Z)(this,"cdRef",void 0),(0,s.Z)(this,"broadcast",void 0),(0,s.Z)(this,"record",{}),(0,s.Z)(this,"field",{}),(0,s.Z)(this,"value",""),(0,s.Z)(this,"subscription",new m.w0),this.userpreferences=e,this.session=t,this.cdRef=i,this.broadcast=o,this.subscribeToTimezoneChange()}ngOnInit(){this.setFormattedFieldValue()}ngOnDestroy(){this.subscription.unsubscribe()}subscribeToTimezoneChange(){this.subscription.add(this.broadcast.message$.subscribe((e=>{"timezone.changed"==e.messagetype&&(this.setFormattedFieldValue(),this.cdRef.detectChanges())})))}setFormattedFieldValue(){if(this.record[this.field.fieldid]){let e=new moment.utc(this.record[this.field.fieldid]).tz(this.session.getSessionData("timezone")||moment.tz.guess(!0));e.isValid()&&(this.value=this.userpreferences.formatDateTime(e))}}}return e=ReporterFieldDateTime,(0,s.Z)(ReporterFieldDateTime,"ɵfac",(function(t){return new(t||e)(p.Y36(Lt.z),p.Y36(V.n),p.Y36(p.sBO),p.Y36(v.f))})),(0,s.Z)(ReporterFieldDateTime,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-field-date-time"]],decls:2,vars:1,consts:[[1,"slds-truncate"]],template:function(e,t){1&e&&(p.TgZ(0,"div",0),p._uU(1),p.qZA()),2&e&&(p.xp6(1),p.hij(" ",t.value,"\n"))},encapsulation:2,changeDetection:0})),ReporterFieldDateTime})(),Vt=(()=>{var e;class ReporterFieldColor{constructor(){(0,s.Z)(this,"record",{}),(0,s.Z)(this,"field",{})}}return e=ReporterFieldColor,(0,s.Z)(ReporterFieldColor,"ɵfac",(function(t){return new(t||e)})),(0,s.Z)(ReporterFieldColor,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-field-Color"]],decls:3,vars:1,consts:[[1,"slds-align--absolute-center"],["height","16","width","16"],["cx","8","cy","8","r","6","stroke","grey","stroke-width","1"]],template:function(e,t){1&e&&(p.TgZ(0,"div",0),p.O4$(),p.TgZ(1,"svg",1),p._UZ(2,"circle",2),p.qZA()()),2&e&&(p.xp6(2),p.uIk("fill",t.record[t.field.fieldid]))},encapsulation:2})),ReporterFieldColor})();var Gt=i(7040),Ht=i(6367),jt=i(3208),Kt=i(5638);function Xt(e,t){if(1&e&&p._UZ(0,"field-label",3),2&e){const e=p.oxw();p.Q6J("fieldname",e.fieldname)("fieldconfig",e.fieldconfig)}}function $t(e,t){if(1&e&&(p.TgZ(0,"option",9),p._uU(1),p.qZA()),2&e){const e=t.$implicit;p.Q6J("value",e.id),p.xp6(1),p.hij(" ",e.name," ")}}function Wt(e,t){if(1&e&&(p.TgZ(0,"field-generic-display",4)(1,"div",5)(2,"div",6)(3,"select",7),p._UZ(4,"option"),p.YNc(5,$t,2,2,"option",8),p.qZA()()()()),2&e){const e=p.oxw();p.Q6J("fielddisplayclass",e.fielddisplayclass)("editable",e.isEditable())("fieldconfig",e.fieldconfig)("fieldid",e.fieldid),p.xp6(3),p.Q6J("ngModel",e.valueId)("disabled",!0),p.xp6(2),p.Q6J("ngForOf",e.categories)}}function ei(e,t){if(1&e&&(p.TgZ(0,"option",9),p._uU(1),p.qZA()),2&e){const e=t.$implicit;p.Q6J("value",e.id),p.xp6(1),p.hij(" ",e.name," ")}}function ti(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"div",10)(1,"div",5)(2,"div",6)(3,"select",11),p.NdJ("ngModelChange",(function(t){p.CHM(e);const i=p.oxw();return p.KtG(i.valueId=t)})),p._UZ(4,"option"),p.YNc(5,ei,2,2,"option",8),p.qZA()()(),p._UZ(6,"field-messages",12),p.qZA()}if(2&e){const e=p.oxw();p.Q6J("ngClass",e.getFieldClass()),p.xp6(3),p.Q6J("ngModel",e.valueId),p.xp6(2),p.Q6J("ngForOf",e.categories),p.xp6(1),p.Q6J("fieldname",e.fieldname)}}let ii=(()=>{var e;class FieldReportCategory extends Gt.O{constructor(e,t,i,o,r,n,l){super(l,i,e,n,t),(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"router",void 0),(0,s.Z)(this,"view",void 0),(0,s.Z)(this,"backend",void 0),(0,s.Z)(this,"configuration",void 0),(0,s.Z)(this,"metadata",void 0),(0,s.Z)(this,"model",void 0),(0,s.Z)(this,"categories",[]),this.language=e,this.router=t,this.view=i,this.backend=o,this.configuration=r,this.metadata=n,this.model=l,this.loadCategories()}set valueId(e){this.model.setField("category_id",e)}get valueId(){return this.model.getField("category_id")}loadCategories(){const e=this.configuration.getData("reportcategories");e?this.categories=e:this.backend.getRequest("module/KReports/categoriesmanager/categories").subscribe((e=>{e&&(this.categories=e)}))}}return e=FieldReportCategory,(0,s.Z)(FieldReportCategory,"ɵfac",(function(t){return new(t||e)(p.Y36(Z.d),p.Y36(y.F0),p.Y36(f.e),p.Y36(w.y),p.Y36(It.C),p.Y36(b.Pu),p.Y36(h.o))})),(0,s.Z)(FieldReportCategory,"ɵcmp",p.Xpm({type:e,selectors:[["field-report-category"]],features:[p.qOj],decls:3,vars:3,consts:[[3,"fieldname","fieldconfig",4,"ngIf"],[3,"fielddisplayclass","editable","fieldconfig","fieldid",4,"ngIf"],["class","slds-form-element",3,"ngClass",4,"ngIf"],[3,"fieldname","fieldconfig"],[3,"fielddisplayclass","editable","fieldconfig","fieldid"],[1,"slds-form-element__control","slds-p-vertical--xx-small"],[1,"slds-select_container"],[1,"slds-select",3,"ngModel","disabled"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"slds-form-element",3,"ngClass"],[1,"slds-select",3,"ngModel","ngModelChange"],[3,"fieldname"]],template:function(e,t){1&e&&(p.YNc(0,Xt,1,2,"field-label",0),p.YNc(1,Wt,6,7,"field-generic-display",1),p.YNc(2,ti,7,4,"div",2)),2&e&&(p.Q6J("ngIf",t.displayLabel),p.xp6(1),p.Q6J("ngIf",!t.isEditMode()),p.xp6(1),p.Q6J("ngIf",t.isEditable()&&t.isEditMode()))},dependencies:[o.mk,o.sg,o.O5,r.YN,r.Kr,r.EJ,r.JJ,r.On,Ht.q,jt.D,Kt.a],encapsulation:2})),FieldReportCategory})(),si=(()=>{var e;class ReporterIntegrationTargetlistexportButton{constructor(e,t,i,o,r){(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"metadata",void 0),(0,s.Z)(this,"model",void 0),(0,s.Z)(this,"modal",void 0),(0,s.Z)(this,"reporterconfig",void 0),this.language=e,this.metadata=t,this.model=i,this.modal=o,this.reporterconfig=r}showModal(){let e=[];for(let t of this.reporterconfig.userFilters)e.push({fieldid:t.fieldid,operator:t.operator,value:t.value,valuekey:t.valuekey,valueto:t.valueto,valuetokey:t.valuetokey});this.modal.openModal("ReporterIntegrationTargetlistexportModal").subscribe((t=>{t.instance.model=this.model,t.instance.whereConditions=e}))}}return e=ReporterIntegrationTargetlistexportButton,(0,s.Z)(ReporterIntegrationTargetlistexportButton,"ɵfac",(function(t){return new(t||e)(p.Y36(Z.d),p.Y36(b.Pu),p.Y36(h.o),p.Y36(Pe.o),p.Y36(u.s))})),(0,s.Z)(ReporterIntegrationTargetlistexportButton,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-integration-targetlistexport-button"]],decls:5,vars:1,consts:[["role","presentation",1,"slds-dropdown__item",3,"click"],["href","javascript:void(0);","role","menuitem","tabindex","0"],["module","ProspectLists","size","x-small"],[1,"slds-truncate"],["module","ProspectLists",3,"singular"]],template:function(e,t){1&e&&(p.TgZ(0,"li",0),p.NdJ("click",(function(){return t.showModal()})),p.TgZ(1,"a",1),p._UZ(2,"system-icon",2),p.TgZ(3,"span",3),p._UZ(4,"system-label-modulename",4),p.qZA()()()),2&e&&(p.xp6(4),p.Q6J("singular",!0))},dependencies:[T.f,D.M],encapsulation:2})),ReporterIntegrationTargetlistexportButton})();var oi=i(4664);let ri=(()=>{var e;class ReporterIntegrationExportMask{constructor(e){(0,s.Z)(this,"language",void 0),this.language=e}}return e=ReporterIntegrationExportMask,(0,s.Z)(ReporterIntegrationExportMask,"ɵfac",(function(t){return new(t||e)(p.Y36(Z.d))})),(0,s.Z)(ReporterIntegrationExportMask,"ɵcmp",p.Xpm({type:e,selectors:[["ng-component"]],decls:4,vars:0,consts:[[1,"slds-modal","slds-fade-in-open","slds-align--absolute-center",2,"width","100%","height","100vh"],[1,"slds-box","slds-theme--default"],[1,"slds-backdrop","slds-backdrop--open"]],template:function(e,t){1&e&&(p.TgZ(0,"div",0)(1,"div",1),p._UZ(2,"system-spinner"),p.qZA()(),p._UZ(3,"div",2))},dependencies:[oi.W],encapsulation:2})),ReporterIntegrationExportMask})(),ni=(()=>{var e;class ReporterIntegrationTargetlistexportModal{constructor(e,t,i,o){(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"metadata",void 0),(0,s.Z)(this,"backend",void 0),(0,s.Z)(this,"modal",void 0),(0,s.Z)(this,"self",{}),(0,s.Z)(this,"model",{}),(0,s.Z)(this,"whereConditions",{}),(0,s.Z)(this,"targetlistname",""),this.language=e,this.metadata=t,this.backend=i,this.modal=o}closeModal(){this.self.destroy()}exportTargetList(){this.modal.openModal("SystemLoadingModal").subscribe((e=>{e.instance.messagelabel="LBL_CREATING_TARGETLIST";let t={targetlist_action:"new",targetlist_name:this.targetlistname,record:this.model.id,whereConditions:btoa(JSON.stringify(this.whereConditions))};this.backend.postRequest("module/KReports/plugins/action/ktargetlistexport/export_to_targetlist",{},t).subscribe((t=>{e.instance.self.destroy(),this.closeModal()}))}))}}return e=ReporterIntegrationTargetlistexportModal,(0,s.Z)(ReporterIntegrationTargetlistexportModal,"ɵfac",(function(t){return new(t||e)(p.Y36(Z.d),p.Y36(b.Pu),p.Y36(w.y),p.Y36(Pe.o))})),(0,s.Z)(ReporterIntegrationTargetlistexportModal,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-integration-targetlistexport-modal"]],decls:14,vars:1,consts:[["size","large"],[3,"close"],["label","LBL_EXPORT_TO_TARGETLIST_BUTTON_LABEL"],[1,"slds-form-element","slds-p-around--small"],[1,"slds-form-element__label"],[1,"slds-form-element__control"],["type","text",1,"slds-input",3,"ngModel","ngModelChange"],[1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_CANCEL"],[1,"slds-button","slds-button--brand",3,"click"],["label","LBL_OK"]],template:function(e,t){1&e&&(p.TgZ(0,"system-modal",0)(1,"system-modal-header",1),p.NdJ("close",(function(){return t.closeModal()})),p._UZ(2,"system-label",2),p.qZA(),p.TgZ(3,"system-modal-content")(4,"div",3)(5,"label",4),p._UZ(6,"system-label",2),p.qZA(),p.TgZ(7,"div",5)(8,"input",6),p.NdJ("ngModelChange",(function(e){return t.targetlistname=e})),p.qZA()()()(),p.TgZ(9,"system-modal-footer")(10,"button",7),p.NdJ("click",(function(){return t.closeModal()})),p._UZ(11,"system-label",8),p.qZA(),p.TgZ(12,"button",9),p.NdJ("click",(function(){return t.exportTargetList()})),p._UZ(13,"system-label",10),p.qZA()()()),2&e&&(p.xp6(8),p.Q6J("ngModel",t.targetlistname))},dependencies:[r.Fj,r.JJ,r.On,M._,nt.j,lt.x,at.p,dt.y],encapsulation:2})),ReporterIntegrationTargetlistexportModal})();var li=i(3917);function ai(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"li",1)(1,"a",2),p.NdJ("click",(function(){p.CHM(e);const t=p.oxw();return p.KtG(t.exportCSV())})),p._UZ(2,"system-icon",3),p.TgZ(3,"span",4),p._UZ(4,"system-label",5),p.qZA()()()}}let di=(()=>{var e;class ReporterIntegrationCSVexportButton{constructor(e,t,i,o,r,n,l,a){(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"metadata",void 0),(0,s.Z)(this,"backend",void 0),(0,s.Z)(this,"model",void 0),(0,s.Z)(this,"modal",void 0),(0,s.Z)(this,"footer",void 0),(0,s.Z)(this,"reporterconfig",void 0),(0,s.Z)(this,"toast",void 0),(0,s.Z)(this,"loadUrl",void 0),(0,s.Z)(this,"fileName",void 0),this.language=e,this.metadata=t,this.backend=i,this.model=o,this.modal=r,this.footer=n,this.reporterconfig=l,this.toast=a}get canExport(){return this.model.checkAccess("export")}exportCSV(){let e=[];for(let t of this.reporterconfig.userFilters)e.push({fieldid:t.fieldid,operator:t.operator,value:t.value,valuekey:t.valuekey,valueto:t.valueto,valuetokey:t.valuetokey});this.fileName=this.model.getField("name").replace(" ","_")+"_"+moment().format("YYYY_MM_DD_HH_mm_ss")+".csv";let t=this.modal.await(this.language.getLabel("LBL_LOADING"));this.backend.getDownloadPostRequestFile("module/KReports/plugins/action/kcsvexport/export",{record:this.model.id,dynamicoptions:JSON.stringify(e)}).subscribe({next:e=>{let i=document.createElement("a");document.body.appendChild(i),i.href=e,i.download=this.fileName,i.type="text/css",i.click(),i.remove(),t.emit(!0)},error:e=>{t.emit(!0),this.toast.sendToast(this.language.getLabel("MSG_ERROR_LOADING_FILE"),"error")}})}}return e=ReporterIntegrationCSVexportButton,(0,s.Z)(ReporterIntegrationCSVexportButton,"ɵfac",(function(t){return new(t||e)(p.Y36(Z.d),p.Y36(b.Pu),p.Y36(w.y),p.Y36(h.o),p.Y36(Pe.o),p.Y36(li.M),p.Y36(u.s),p.Y36(B.A))})),(0,s.Z)(ReporterIntegrationCSVexportButton,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-integration-csvexport-button"]],decls:1,vars:1,consts:[["class","slds-dropdown__item","role","presentation",4,"ngIf"],["role","presentation",1,"slds-dropdown__item"],["href","javascript:void(0);","role","menuitem","tabindex","0",3,"click"],["sprite","doctype","icon","csv","size","x-small"],[1,"slds-truncate"],["label","LBL_CSV_EXPORT"]],template:function(e,t){1&e&&p.YNc(0,ai,5,0,"li",0),2&e&&p.Q6J("ngIf",t.canExport)},dependencies:[o.O5,T.f,M._],encapsulation:2})),ReporterIntegrationCSVexportButton})(),ci=(()=>{var e;class ReporterNewButton{constructor(e,t,i,o){(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"metadata",void 0),(0,s.Z)(this,"model",void 0),(0,s.Z)(this,"router",void 0),this.language=e,this.metadata=t,this.model=i,this.router=o}execute(){this.hidden||this.router.navigate(["/module/KReports/designer/new"])}get hidden(){return!this.metadata.checkModuleAcl(this.model.module,"create")}}return e=ReporterNewButton,(0,s.Z)(ReporterNewButton,"ɵfac",(function(t){return new(t||e)(p.Y36(Z.d),p.Y36(b.Pu),p.Y36(h.o),p.Y36(y.F0))})),(0,s.Z)(ReporterNewButton,"ɵcmp",p.Xpm({type:e,selectors:[["ng-component"]],decls:2,vars:0,consts:[["label","LBL_NEW"]],template:function(e,t){1&e&&(p.TgZ(0,"span"),p._UZ(1,"system-label",0),p.qZA())},dependencies:[M._],encapsulation:2})),ReporterNewButton})(),pi=(()=>{var e;class ReporterFieldCategoryTree{constructor(e,t,i){(0,s.Z)(this,"config",void 0),(0,s.Z)(this,"metadata",void 0),(0,s.Z)(this,"backend",void 0),(0,s.Z)(this,"record",{}),(0,s.Z)(this,"field",void 0),(0,s.Z)(this,"categoryNodes",{}),(0,s.Z)(this,"categoryField",void 0),this.config=e,this.metadata=t,this.backend=i}get display_value(){return this.record[this.field.fieldid]?this.categoryNodes[this.record[this.field.fieldid]]?.node_name??this.record[this.field.fieldid]:""}ngOnInit(){const e=this.setCategoryField();if(!e)return;let t=this.config.getData("categories");this.setCategoryNodes(t[e]),t&&t[e]||(t||(t={}),t[e]=[],this.config.setData("categories",t),this.backend.getRequest(`configuration/spiceui/core/categorytrees/${e}/categorytreenodes`).subscribe((i=>{t[e]=i,this.setCategoryNodes(t[e]),this.config.setData("categories",t)})))}setCategoryField(){let e;const t=this.metadata.getModuleDefs(this.record.sugarRecordModule);return t?.categorytrees?(t.categorytrees.some((t=>{const i=Object.keys(t).find((e=>t[e]==this.field.fieldname));return!!i&&(e=t.syscategorytree_id,this.categoryField=i,!0)})),e):e}setCategoryNodes(e){if(!e||0==e.length)return;let t=2;const i={1:e.filter((e=>!e.parent_id))};if(this.categoryField.endsWith("1"))this.categoryNodes=window._.object(i[1].map((e=>e.node_key)),i[1]);else for(;t<=4;){if(i[t]=[],i[t-1].forEach((s=>{i[t]=i[t].concat(e.filter((e=>e.parent_id==s.id)))})),this.categoryField.endsWith(String(t))){this.categoryNodes=window._.object(i[t].map((e=>e.node_key)),i[t]);break}t++}}}return e=ReporterFieldCategoryTree,(0,s.Z)(ReporterFieldCategoryTree,"ɵfac",(function(t){return new(t||e)(p.Y36(It.C),p.Y36(b.Pu),p.Y36(w.y))})),(0,s.Z)(ReporterFieldCategoryTree,"ɵcmp",p.Xpm({type:e,selectors:[["reporter-field-category-tree"]],decls:3,vars:1,consts:[[1,"slds-truncate"],[3,"label"]],template:function(e,t){1&e&&(p.TgZ(0,"div",0)(1,"span"),p._UZ(2,"system-label",1),p.qZA()()),2&e&&(p.xp6(2),p.Q6J("label",t.display_value))},dependencies:[M._],encapsulation:2,changeDetection:0})),ReporterFieldCategoryTree})(),hi=(()=>{var e;class ModuleReports{}return e=ModuleReports,(0,s.Z)(ModuleReports,"ɵfac",(function(t){return new(t||e)})),(0,s.Z)(ModuleReports,"ɵmod",p.oAB({type:e})),(0,s.Z)(ModuleReports,"ɵinj",p.cJS({imports:[o.ez,r.u5,n.ObjectFields,l.ObjectComponents,a.SystemComponents,d.o,c._t]})),ModuleReports})();("undefined"==typeof ngJitMode||ngJitMode)&&p.kYT(hi,{declarations:[ii,ke,S,q,Ie,Te,Ze,K,ce,X.I,$.i,W.h,De.f,Je.g,Ye.i,qe.Q,Ae.W,Me.K,ot,ut,_e,ft,vt,bt,Rt,xt,Yt,Tt,Ve,Nt,Ot,zt,Qt,Et,St,Bt,Vt,pi,O,ri,si,ni,di,L,ci],imports:[o.ez,r.u5,n.ObjectFields,l.ObjectComponents,a.SystemComponents,d.o,c._t],exports:[Ve,$.i,X.I,W.h,De.f,Ae.W,Me.K,Je.g]})},4542:(e,t,i)=>{i.d(t,{s:()=>a});var s=i(1180),o=i(7579),r=i(2242),n=i(6625),l=i(4505);let a=(()=>{var e;class reporterconfig{constructor(e,t){(0,s.Z)(this,"configurationService",void 0),(0,s.Z)(this,"backend",void 0),(0,s.Z)(this,"userFilters",[]),(0,s.Z)(this,"whereFunctions",[]),(0,s.Z)(this,"defaultUserFilters",""),(0,s.Z)(this,"operatorCount",{}),(0,s.Z)(this,"operatorTypes",{}),(0,s.Z)(this,"operatorAssignments",{}),(0,s.Z)(this,"isLoading",{presentation:!1,visualization:!1}),(0,s.Z)(this,"refresh$",new o.x),this.configurationService=e,this.backend=t;let i=this.configurationService.getData("reporterConfig");i?this.parseConfifg(i):this.backend.getRequest("module/KReports/core/whereoperators/all").subscribe((e=>{this.configurationService.setData("reporterConfig",e),this.parseConfifg(e)})),this.getWhereFunctions()}getWhereFunctions(){this.backend.getRequest("module/KReports/core/wherefunctions").subscribe((e=>{this.whereFunctions=e}))}parseConfifg(e){this.operatorCount=e.operatorCount,this.operatorTypes=e.operatorTypes,this.operatorAssignments=e.operatorAssignments}refresh(){this.refresh$.next(!0)}cancelRequests(){this.refresh$.next(!1)}resetUserFilters(){this.userFilters=[],this.defaultUserFilters="[]"}addUserFilter(e){this.userFilters.push(e),this.defaultUserFilters=JSON.stringify(this.userFilters)}setDefaultUserFilter(){this.userFilters=JSON.parse(this.defaultUserFilters),this.refresh()}setSavedFilter(e){for(let t of e)this.userFilters.some((e=>{if(e.fieldid==t.fieldid)return e.operator=t.operator,e.value=t.value,e.valuekey=t.valuekey,e.valueto=t.valueto,e.valuetokey=t.valuetokey,!0}));this.refresh()}}return e=reporterconfig,(0,s.Z)(reporterconfig,"ɵfac",(function(t){return new(t||e)(r.LFG(n.C),r.LFG(l.y))})),(0,s.Z)(reporterconfig,"ɵprov",r.Yz7({token:e,factory:e.ɵfac})),reporterconfig})()}}]);