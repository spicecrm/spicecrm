/*!
 * 
 *                     SpiceCRM
 *
 *                     release: 2024.01.001
 *
 *                     date: 2024-05-28 17:40:40
 *
 *                     build: 2024.01.001.1716910840504
 *
 */
"use strict";(self.webpackChunkcore=self.webpackChunkcore||[]).push([["default-src_modules_reports_modulereports_ts"],{29325:(e,t,s)=>{s.d(t,{F:()=>f});var i=s(54438),n=s(83935),r=s(49722),o=s(53584),l=s(60177),a=s(84341),d=s(55480),c=s(79413);function h(e,t){if(1&e&&(i.j41(0,"option",7),i.EFF(1),i.k0s()),2&e){const e=t.$implicit;i.Y8G("ngValue",e.node_key),i.R7$(),i.JRh(e.node_name)}}function p(e,t){if(1&e){const e=i.RV6();i.j41(0,"div",3)(1,"div",4)(2,"select",5),i.mxI("ngModelChange",(function(t){i.eBV(e);const s=i.XpG();return i.DH7(s.value,t)||(s.value=t),i.Njj(t)})),i.DNE(3,h,2,2,"option",6),i.k0s()()()}if(2&e){const e=i.XpG();i.R7$(2),i.Y8G("disabled",e.isDisabled),i.R50("ngModel",e.value),i.R7$(),i.Y8G("ngForOf",e.categoryNodes)}}function u(e,t){if(1&e&&(i.j41(0,"div",11)(1,"system-checkbox-group-checkbox",12)(2,"span",13),i.EFF(3),i.k0s()()()),2&e){const e=i.XpG().$implicit;i.Y8G("title",e.node_name),i.R7$(),i.Y8G("value",e.node_key),i.R7$(2),i.JRh(e.node_name)}}function g(e,t){if(1&e&&(i.qex(0),i.DNE(1,u,4,3,"div",10),i.bVm()),2&e){const e=t.$implicit;i.R7$(),i.Y8G("ngIf",!!e.node_key)}}function m(e,t){if(1&e){const e=i.RV6();i.j41(0,"system-checkbox-group",8),i.mxI("ngModelChange",(function(t){i.eBV(e);const s=i.XpG();return i.DH7(s.value,t)||(s.value=t),i.Njj(t)})),i.DNE(1,g,2,1,"ng-container",9),i.k0s()}if(2&e){const e=i.XpG();i.R50("ngModel",e.value),i.R7$(),i.Y8G("ngForOf",e.categoryNodes)}}let f=(()=>{class ReporterFilterItemCategory{constructor(e,t,s){this.metadata=e,this.backend=t,this.config=s,this.field="",this.isMultiSelect=!1,this.wherecondition={},this.treeid=null,this.categoryNodes=[],this._value=[]}ngOnInit(){let e=this.wherecondition.path.split("::"),t=e.length,s=e[t-1].split(":");this.fieldName=s[1];let i=e[t-2].split(":");switch(i[0]){case"root":this.moduleName=i[1];break;case"link":let e=this.metadata.getFieldDefs(i[1],i[2]);this.moduleName=e.module}this.getCategoryptions(),this.initializeValueArray()}ngOnChanges(){this.initializeValueArray()}get isDisabled(){return 0==this.categoryNodes.length}get value(){return this._value}set value(e){this.isMultiSelect&&(this._value=e,e=e.join(",")),this.wherecondition[this.field]=e,this.wherecondition[this.field+"key"]=this.wherecondition[this.field]}initializeValueArray(){const e=this.wherecondition[this.field+"key"]?this.wherecondition[this.field+"key"]:this.wherecondition[this.field];this._value=this.isMultiSelect?e?e.split(","):[]:e}getCategoryptions(){if(this.moduleName&&this.fieldName){if(this.treeid=this.getTreeId(this.moduleName,this.fieldName),!this.treeid)return;let e=this.config.getData("categories");e[this.treeid]?this.buildOptionsFromCategories(e[this.treeid]):this.backend.getRequest(`configuration/spiceui/core/categorytrees/${this.treeid}/categorytreenodes`).subscribe((t=>{e||(e={}),e[this.treeid]=t,this.buildOptionsFromCategories(t),this.config.setData("categories",e)}))}}getTreeId(e,t){let s;const i=this.metadata.getModuleDefs(e);return i?.categorytrees?(i.categorytrees.some((e=>{const i=Object.keys(e).find((s=>e[s]==t));return!!i&&(s=e.syscategorytree_id,this.categoryField=i,!0)})),s):s}buildOptionsFromCategories(e){if(!e||0==e.length)return;let t=2;const s={1:e.filter((e=>!e.parent_id))};if(this.categoryField.endsWith("1"))this.categoryNodes=s[1].map((e=>({id:e.id,node_name:e.node_name,node_key:e.node_key}))).sort(((e,t)=>e.node_name.localeCompare(t.node_name)));else for(;t<=4;){if(s[t]=[],s[t-1].forEach((i=>{s[t]=s[t].concat(e.filter((e=>e.parent_id==i.id)))})),this.categoryField.endsWith(String(t))){this.categoryNodes=s[t].map((e=>({id:e.id,node_name:e.node_name,node_key:e.node_key}))).sort(((e,t)=>e.node_name.localeCompare(t.node_name)));break}t++}}static#e=this.ɵfac=function(e){return new(e||ReporterFilterItemCategory)(i.rXU(n.yu),i.rXU(r.H),i.rXU(o.i))};static#t=this.ɵcmp=i.VBU({type:ReporterFilterItemCategory,selectors:[["reporter-filter-item-category"]],inputs:{field:"field",isMultiSelect:"isMultiSelect",wherecondition:"wherecondition"},features:[i.OA$],decls:4,vars:2,consts:[[1,"slds-form-element"],["class","slds-form-element__control",4,"ngIf","ngIfElse"],["checkboxContainer",""],[1,"slds-form-element__control"],[1,"slds-select_container"],[1,"slds-select",3,"disabled","ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"ngValue"],[1,"slds-grid","slds-wrap",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],["class","slds-large-size--1-of-3 slds-medium-size--1-of-1 slds-truncate",3,"title",4,"ngIf"],[1,"slds-large-size--1-of-3","slds-medium-size--1-of-1","slds-truncate",3,"title"],[3,"value"],[1,"slds-m-left--xx-small"]],template:function(e,t){if(1&e&&(i.j41(0,"div",0),i.DNE(1,p,4,3,"div",1)(2,m,2,2,"ng-template",null,2,i.C5r),i.k0s()),2&e){const e=i.sdS(3);i.R7$(),i.Y8G("ngIf",!t.isMultiSelect)("ngIfElse",e)}},dependencies:[l.Sq,l.bT,a.xH,a.y7,a.wz,a.BC,a.vS,d.G,c.h],encapsulation:2})}return ReporterFilterItemCategory})()},36769:(e,t,s)=>{s.d(t,{R:()=>d});var i=s(54438),n=s(69904),r=s(35911),o=s(11618),l=s(84341),a=s(26024);let d=(()=>{class ReporterFilterItemDate{constructor(e,t,s){this.language=e,this.model=t,this.reporterconfig=s,this.field="",this.wherecondition={},this.fieldDate=new moment}ngOnInit(){this.fieldDate=new moment(this.wherecondition[this.field])}get filterValue(){return this.fieldDate}set filterValue(e){this.fieldDate=e,this.wherecondition[this.field]=e.format("YYYY-MM-DD")}static#e=this.ɵfac=function(e){return new(e||ReporterFilterItemDate)(i.rXU(n.B),i.rXU(r.g),i.rXU(o.c))};static#t=this.ɵcmp=i.VBU({type:ReporterFilterItemDate,selectors:[["reporter-filter-item-date"]],inputs:{field:"field",wherecondition:"wherecondition"},decls:2,vars:1,consts:[[1,"slds-form-element"],[3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(i.j41(0,"div",0)(1,"system-input-date",1),i.mxI("ngModelChange",(function(e){return i.DH7(t.filterValue,e)||(t.filterValue=e),e})),i.k0s()()),2&e&&(i.R7$(),i.R50("ngModel",t.filterValue))},dependencies:[l.BC,l.vS,a.M],encapsulation:2})}return ReporterFilterItemDate})()},37448:(e,t,s)=>{s.d(t,{U:()=>b});var i=s(18359),n=s(54438),r=s(83935),o=s(69904),l=s(49722),a=s(60177),d=s(84341),c=s(55480),h=s(79413);function p(e,t){if(1&e&&(n.j41(0,"option",7),n.EFF(1),n.k0s()),2&e){const e=t.$implicit;n.Y8G("ngValue",e.value),n.R7$(),n.JRh(e.display)}}function u(e,t){if(1&e){const e=n.RV6();n.j41(0,"div",3)(1,"div",4)(2,"select",5),n.mxI("ngModelChange",(function(t){n.eBV(e);const s=n.XpG();return n.DH7(s.value,t)||(s.value=t),n.Njj(t)})),n.DNE(3,p,2,2,"option",6),n.k0s()()()}if(2&e){const e=n.XpG();n.R7$(2),n.Y8G("disabled",e.isDisabled),n.R50("ngModel",e.value),n.R7$(),n.Y8G("ngForOf",e.enumOptions)}}function g(e,t){if(1&e&&(n.j41(0,"div",11)(1,"system-checkbox-group-checkbox",12)(2,"span",13),n.EFF(3),n.k0s()()()),2&e){const e=n.XpG().$implicit;n.Y8G("title",e.display),n.R7$(),n.Y8G("value",e.value),n.R7$(2),n.JRh(e.display)}}function m(e,t){if(1&e&&(n.qex(0),n.DNE(1,g,4,3,"div",10),n.bVm()),2&e){const e=t.$implicit;n.R7$(),n.Y8G("ngIf",!!e.value)}}function f(e,t){if(1&e){const e=n.RV6();n.j41(0,"system-checkbox-group",8),n.mxI("ngModelChange",(function(t){n.eBV(e);const s=n.XpG();return n.DH7(s.value,t)||(s.value=t),n.Njj(t)})),n.DNE(1,m,2,1,"ng-container",9),n.k0s()}if(2&e){const e=n.XpG();n.R50("ngModel",e.value),n.R7$(),n.Y8G("ngForOf",e.enumOptions)}}let b=(()=>{class ReporterFilterItemEnum{constructor(e,t,s){this.metadata=e,this.language=t,this.backend=s,this.field="",this.isMultiSelect=!1,this.wherecondition={},this.enumOptions=[],this._value=[],this.subscription=new i.yU,this.subscription=this.language.currentlanguage$.subscribe((()=>{this.getEnumOptions()}))}get isDisabled(){return 0==this.enumOptions.length}get value(){return this._value}set value(e){this.isMultiSelect&&(this._value=e,e=e.join(",")),this.wherecondition[this.field]=e,this.wherecondition[this.field+"key"]=this.wherecondition[this.field]}ngOnInit(){let e=this.wherecondition.path.split("::"),t=e.length,s=e[t-1].split(":");this.fieldName=s[1];let i=e[t-2].split(":");switch(i[0]){case"root":this.moduleName=i[1];break;case"link":let e=this.metadata.getFieldDefs(i[1],i[2]);this.moduleName=e.module}this.getEnumOptions(),this.initializeValueArray()}ngOnDestroy(){this.subscription.unsubscribe()}initializeValueArray(){const e=this.wherecondition[this.field+"key"]?this.wherecondition[this.field+"key"]:this.wherecondition[this.field];this._value=this.isMultiSelect?e?e.split(","):[]:e}getEnumOptions(){this.moduleName&&this.fieldName?this.enumOptions=this.language.getFieldDisplayOptions(this.moduleName,this.fieldName,!0):this.backend.getRequest("module/KReports/core/enumoptions",{path:this.wherecondition.path}).subscribe((e=>{e&&0!=e.length&&(this.enumOptions=e.map((e=>({value:e.value,display:e.text}))))}))}ngOnChanges(){this.initializeValueArray()}static#e=this.ɵfac=function(e){return new(e||ReporterFilterItemEnum)(n.rXU(r.yu),n.rXU(o.B),n.rXU(l.H))};static#t=this.ɵcmp=n.VBU({type:ReporterFilterItemEnum,selectors:[["reporter-filter-item-enum"]],inputs:{field:"field",isMultiSelect:"isMultiSelect",wherecondition:"wherecondition"},features:[n.OA$],decls:4,vars:2,consts:[[1,"slds-form-element"],["class","slds-form-element__control",4,"ngIf","ngIfElse"],["checkboxContainer",""],[1,"slds-form-element__control"],[1,"slds-select_container"],[1,"slds-select",3,"disabled","ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"ngValue"],[1,"slds-grid","slds-wrap",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],["class","slds-large-size--1-of-3 slds-medium-size--1-of-1 slds-truncate",3,"title",4,"ngIf"],[1,"slds-large-size--1-of-3","slds-medium-size--1-of-1","slds-truncate",3,"title"],[3,"value"],[1,"slds-m-left--xx-small"]],template:function(e,t){if(1&e&&(n.j41(0,"div",0),n.DNE(1,u,4,3,"div",1)(2,f,2,2,"ng-template",null,2,n.C5r),n.k0s()),2&e){const e=n.sdS(3);n.R7$(),n.Y8G("ngIf",!t.isMultiSelect)("ngIfElse",e)}},dependencies:[a.Sq,a.bT,d.xH,d.y7,d.wz,d.BC,d.vS,c.G,h.h],encapsulation:2})}return ReporterFilterItemEnum})()},2877:(e,t,s)=>{s.d(t,{X:()=>d});var i=s(54438),n=s(69904),r=s(11618),o=s(60177),l=s(84341);function a(e,t){if(1&e&&(i.j41(0,"option",5),i.EFF(1),i.k0s()),2&e){const e=t.$implicit;i.Y8G("value",e.field),i.R7$(),i.SpI(" ",e.description," ")}}let d=(()=>{class ReporterFilterItemFunction{constructor(e,t){this.language=e,this.reporterconfig=t,this.whereCondition={}}set functionField(e){this.whereCondition.value=e,this.whereCondition.valuekey=e}get functionField(){return this.whereCondition.value}static#e=this.ɵfac=function(e){return new(e||ReporterFilterItemFunction)(i.rXU(n.B),i.rXU(r.c))};static#t=this.ɵcmp=i.VBU({type:ReporterFilterItemFunction,selectors:[["reporter-filter-item-function"]],inputs:{whereCondition:"whereCondition"},decls:5,vars:2,consts:[[1,"slds-form-element"],[1,"slds-form-element__control"],[1,"slds-select_container"],[1,"slds-select",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){1&e&&(i.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"select",3),i.mxI("ngModelChange",(function(e){return i.DH7(t.functionField,e)||(t.functionField=e),e})),i.DNE(4,a,2,2,"option",4),i.k0s()()()()),2&e&&(i.R7$(3),i.R50("ngModel",t.functionField),i.R7$(),i.Y8G("ngForOf",t.reporterconfig.whereFunctions))},dependencies:[o.Sq,l.xH,l.y7,l.wz,l.BC,l.vS],encapsulation:2})}return ReporterFilterItemFunction})()},29501:(e,t,s)=>{s.d(t,{T:()=>p});var i=s(18359),n=s(54438),r=s(83935),o=s(69904),l=s(49722),a=s(35911),d=s(60177),c=s(84341);function h(e,t){if(1&e&&(n.j41(0,"option",5),n.EFF(1),n.k0s()),2&e){const e=t.$implicit;n.Y8G("value",e),n.R7$(),n.JRh(e)}}let p=(()=>{class ReporterFilterItemParent{constructor(e,t,s,n){this.metadata=e,this.language=t,this.backend=s,this.model=n,this.field="",this.wherecondition={},this.fields=[],this.subscription=new i.yU,this.getEnumOptions()}get isDisabled(){return 0==this.fields.length}get value(){return this._value}set value(e){this.wherecondition[this.field]=e,this.wherecondition[this.field+"key"]=this.wherecondition[this.field]}ngOnInit(){let e=this.wherecondition.path.split("::"),t=e.length,s=e[t-1].split(":");this.fieldName=s[1];let i=e[t-2].split(":");switch(i[0]){case"root":this.moduleName=i[1];break;case"link":let e=this.metadata.getFieldDefs(i[1],i[2]);this.moduleName=e.module}this.getEnumOptions(),this._value=this.wherecondition[this.field+"key"]?this.wherecondition[this.field+"key"]:this.wherecondition[this.field]}ngOnDestroy(){this.subscription.unsubscribe()}getEnumOptions(){this.fields=[];const e=this.model.getField("integration_params");let t=this.metadata.getModuleFields(e.kpublishing.subpanelModule);for(let e in t)this.fields.push(e);this.fields.sort()}static#e=this.ɵfac=function(e){return new(e||ReporterFilterItemParent)(n.rXU(r.yu),n.rXU(o.B),n.rXU(l.H),n.rXU(a.g))};static#t=this.ɵcmp=n.VBU({type:ReporterFilterItemParent,selectors:[["reporter-filter-item-parent"]],inputs:{field:"field",wherecondition:"wherecondition"},decls:5,vars:3,consts:[[1,"slds-form-element"],[1,"slds-form-element__control"],[1,"slds-select_container"],[1,"slds-select",3,"disabled","ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){1&e&&(n.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"select",3),n.mxI("ngModelChange",(function(e){return n.DH7(t.value,e)||(t.value=e),e})),n.DNE(4,h,2,2,"option",4),n.k0s()()()()),2&e&&(n.R7$(3),n.Y8G("disabled",t.isDisabled),n.R50("ngModel",t.value),n.R7$(),n.Y8G("ngForOf",t.fields))},dependencies:[d.Sq,c.xH,c.y7,c.wz,c.BC,c.vS],encapsulation:2})}return ReporterFilterItemParent})()},53328:(e,t,s)=>{s.d(t,{q:()=>h});var i=s(54438),n=s(69904),r=s(11618),o=s(35911),l=s(60177),a=s(84341),d=s(32062);function c(e,t){if(1&e&&(i.j41(0,"option",5),i.nrm(1,"system-label",6),i.k0s()),2&e){const e=t.$implicit;i.Y8G("value",e.reference),i.R7$(),i.Y8G("label",e.reference)}}let h=(()=>{class ReporterFilterItemReference{constructor(e,t,s){this.language=e,this.reporterConfig=t,this.model=s,this.whereCondition={}}set referenceField(e){this.whereCondition.value=e,this.whereCondition.valuekey=e}get referenceField(){return this.whereCondition.value}get referenceFields(){const e=this.model.getField("whereconditions"),t=this.reporterConfig.operatorAssignments[this.whereCondition.overrideType||this.whereCondition.type]||"varchar";return e.filter((e=>!!e.reference&&(this.reporterConfig.operatorAssignments[e.type]||"varchar")==t&&this.whereCondition.fieldid!=e.fieldid))}ngOnInit(){const e=this.whereCondition.path.split("::");let t=e[e.length-1].split(":");this.fieldName=t[1]}static#e=this.ɵfac=function(e){return new(e||ReporterFilterItemReference)(i.rXU(n.B),i.rXU(r.c),i.rXU(o.g))};static#t=this.ɵcmp=i.VBU({type:ReporterFilterItemReference,selectors:[["reporter-filter-item-reference"]],inputs:{whereCondition:"whereCondition"},decls:5,vars:2,consts:[[1,"slds-form-element"],[1,"slds-form-element__control"],[1,"slds-select_container"],[1,"slds-select",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[3,"label"]],template:function(e,t){1&e&&(i.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"select",3),i.mxI("ngModelChange",(function(e){return i.DH7(t.referenceField,e)||(t.referenceField=e),e})),i.DNE(4,c,2,2,"option",4),i.k0s()()()()),2&e&&(i.R7$(3),i.R50("ngModel",t.referenceField),i.R7$(),i.Y8G("ngForOf",t.referenceFields))},dependencies:[l.Sq,a.xH,a.y7,a.wz,a.BC,a.vS,d.W],encapsulation:2})}return ReporterFilterItemReference})()},25946:(e,t,s)=>{s.d(t,{s:()=>a});var i=s(54438),n=s(69904),r=s(35911),o=s(11618),l=s(84341);let a=(()=>{class ReporterFilterItemText{constructor(e,t,s){this.language=e,this.model=t,this.reporterconfig=s,this.field="",this.wherecondition={}}static#e=this.ɵfac=function(e){return new(e||ReporterFilterItemText)(i.rXU(n.B),i.rXU(r.g),i.rXU(o.c))};static#t=this.ɵcmp=i.VBU({type:ReporterFilterItemText,selectors:[["reporter-filter-item-text"]],inputs:{field:"field",wherecondition:"wherecondition"},decls:3,vars:1,consts:[[1,"slds-form-element"],[1,"slds-form-element__control"],["type","text",1,"slds-input",3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(i.j41(0,"div",0)(1,"div",1)(2,"input",2),i.mxI("ngModelChange",(function(e){return i.DH7(t.wherecondition[t.field],e)||(t.wherecondition[t.field]=e),e})),i.k0s()()()),2&e&&(i.R7$(2),i.R50("ngModel",t.wherecondition[t.field]))},dependencies:[l.me,l.BC,l.vS],encapsulation:2})}return ReporterFilterItemText})()},93470:(e,t,s)=>{s.d(t,{Q:()=>d});var i=s(54438),n=s(60177),r=s(4502),o=s(58410);function l(e,t){if(1&e&&i.nrm(0,"reporter-filter-item-user-single",3),2&e){const e=i.XpG();i.Y8G("whereCondition",e.whereCondition)("fieldName",e.fieldName)}}function a(e,t){if(1&e&&i.nrm(0,"reporter-filter-item-user-multiple",3),2&e){const e=i.XpG();i.Y8G("whereCondition",e.whereCondition)("fieldName",e.fieldName)}}let d=(()=>{class ReporterFilterItemUser{constructor(){this.whereCondition={}}get isMultiSelect(){switch(this.whereCondition.operator){case"oneof":case"oneofnot":case"oneofnotornull":return!0;default:return!1}}ngOnInit(){const e=this.whereCondition.path.split("::");let t=e[e.length-1].split(":");this.fieldName=t[1]}static#e=this.ɵfac=function(e){return new(e||ReporterFilterItemUser)};static#t=this.ɵcmp=i.VBU({type:ReporterFilterItemUser,selectors:[["reporter-filter-item-user"]],inputs:{whereCondition:"whereCondition"},decls:4,vars:2,consts:[[1,"slds-grid","slds-grid--vertical-align-center"],["class","slds-grid slds-grid--vertical-align-center slds-size--1-of-1",3,"whereCondition","fieldName",4,"ngIf","ngIfElse"],["multipleSelectContainer",""],[1,"slds-grid","slds-grid--vertical-align-center","slds-size--1-of-1",3,"whereCondition","fieldName"]],template:function(e,t){if(1&e&&(i.j41(0,"div",0),i.DNE(1,l,1,2,"reporter-filter-item-user-single",1)(2,a,1,2,"ng-template",null,2,i.C5r),i.k0s()),2&e){const e=i.sdS(3);i.R7$(),i.Y8G("ngIf",!t.isMultiSelect)("ngIfElse",e)}},dependencies:[n.bT,r.M,o.C],encapsulation:2})}return ReporterFilterItemUser})()},58410:(e,t,s)=>{s.d(t,{C:()=>v});var i=s(54438),n=s(69904),r=s(50531),o=s(29994),l=s(60177),a=s(84341),d=s(25863),c=s(84359),h=s(68823),p=s(32062);function u(e,t){if(1&e&&(i.j41(0,"span",23),i.EFF(1),i.k0s()),2&e){const e=i.XpG().$implicit;i.R7$(),i.SpI(" ",e," ")}}function g(e,t){if(1&e&&(i.j41(0,"span",23),i.EFF(1),i.k0s()),2&e){const e=i.XpG(3);i.R7$(),i.SpI(" ",e.activeUserName," ")}}function m(e,t){if(1&e){const e=i.RV6();i.j41(0,"li",15)(1,"span",16)(2,"span",17),i.nrm(3,"system-icon",18),i.k0s(),i.DNE(4,u,2,1,"span",19)(5,g,2,1,"ng-template",null,20,i.C5r),i.j41(7,"span",21)(8,"system-button-icon",22),i.bIt("click",(function(){const t=i.eBV(e).$implicit,s=i.XpG(2);return i.Njj(s.removeUser(t))})),i.k0s()()()()}if(2&e){const e=t.$implicit,s=i.sdS(6);i.R7$(4),i.Y8G("ngIf","current_user_id"!=e)("ngIfElse",s),i.R7$(4),i.Y8G("icon","close")}}function f(e,t){if(1&e&&(i.j41(0,"div",12)(1,"ul",13),i.DNE(2,m,9,3,"li",14),i.k0s()()),2&e){const e=i.XpG();i.R7$(2),i.Y8G("ngForOf",e.value)("ngForTrackBy",e.trackByFn)}}function b(e,t){if(1&e){const e=i.RV6();i.j41(0,"div",24)(1,"div",25)(2,"input",26),i.bIt("focus",(function(){i.eBV(e);const t=i.XpG();return i.Njj(t.searchWithModal())})),i.k0s(),i.j41(3,"button",8),i.bIt("click",(function(){i.eBV(e);const t=i.XpG();return i.Njj(t.searchWithModal())})),i.nrm(4,"system-button-icon",9),i.k0s()()()}if(2&e){const e=i.XpG();i.R7$(2),i.Y8G("placeholder",e.language.getModuleCombinedLabel("LBL_SEARCH","Users")),i.R7$(2),i.Y8G("icon","search")}}let v=(()=>{class ReporterFilterItemUserMultiple{constructor(e,t,s){this.language=e,this.modal=t,this.session=s,this.whereCondition={},this.activeUserName=""}get activeUser(){return this.whereCondition.value.indexOf("current_user_id")>-1}set activeUser(e){this.value=e?[...this.whereCondition.value,"current_user_id"]:this.whereCondition.value.filter((e=>"current_user_id"!=e)).slice()}get value(){return this.whereCondition.value}set value(e){e&&0!=e.length&&(this.whereCondition.value=e,this.whereCondition.valueinit=e.join(","))}ngOnInit(){this.activeUserName=this.session.authData.userName}trackByFn(e,t){return t}removeUser(e){this.value=this.whereCondition.value.filter((t=>t!=e)).slice()}searchWithModal(){this.modal.openModal("ObjectModalModuleLookup").subscribe((e=>{e.instance.module="Users",e.instance.multiselect=!0,e.instance.selectedItems.subscribe((e=>{e.length&&(this.value=e.map((e=>e.user_name)))}))}))}static#e=this.ɵfac=function(e){return new(e||ReporterFilterItemUserMultiple)(i.rXU(n.B),i.rXU(r.y),i.rXU(o.d))};static#t=this.ɵcmp=i.VBU({type:ReporterFilterItemUserMultiple,selectors:[["reporter-filter-item-user-multiple"]],inputs:{whereCondition:"whereCondition",fieldName:"fieldName"},decls:13,vars:4,consts:[[1,"slds-form-element","slds-grow"],[1,"slds-form-element__control","slds-size--1-of-1"],[1,"slds-combobox_container"],["role","combobox",1,"slds-combobox","slds-dropdown-trigger","slds-dropdown-trigger_click"],["role","none",1,"slds-combobox__form-element","slds-input-has-icon","slds-input-has-icon_right"],["class","slds-pill_container",4,"ngIf","ngIfElse"],["inputContainer",""],[1,"slds-grow"],[1,"slds-button","slds-button_icon","slds-input__icon","slds-input__icon_right",3,"click"],[3,"icon"],[1,"slds-m-left--x-small",3,"ngModel","ngModelChange"],["label","LBL_ACTIVE_USER"],[1,"slds-pill_container"],["role","listbox",1,"slds-listbox","slds-listbox_horizontal"],["class","slds-listbox-item","role","presentation",4,"ngFor","ngForOf","ngForTrackBy"],["role","presentation",1,"slds-listbox-item"],["role","option",1,"slds-pill"],[1,"slds-icon_container"],["module","Users","size","x-small","divClass","slds-p-right--x-small"],["class","slds-pill__label",4,"ngIf","ngIfElse"],["currentUserContainer",""],[1,"slds-icon_container","slds-pill__remove"],[3,"icon","click"],[1,"slds-pill__label"],[1,"slds-form-element__control","slds-grid","slds-box--border"],[1,"slds-input-has-icon","slds-input-has-icon--right","slds-grow"],["type","text","autocomplete","none","role","combobox",1,"slds-lookup__search-input","slds-input--bare","slds-theme--default",3,"placeholder","focus"]],template:function(e,t){if(1&e&&(i.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),i.DNE(5,f,3,2,"div",5)(6,b,5,2,"ng-template",null,6,i.C5r),i.j41(8,"div",7)(9,"button",8),i.bIt("click",(function(){return t.searchWithModal()})),i.nrm(10,"system-button-icon",9),i.k0s()()()()()()(),i.j41(11,"system-checkbox",10),i.mxI("ngModelChange",(function(e){return i.DH7(t.activeUser,e)||(t.activeUser=e),e})),i.nrm(12,"system-label",11),i.k0s()),2&e){const e=i.sdS(7);i.R7$(5),i.Y8G("ngIf",t.value.length>0)("ngIfElse",e),i.R7$(5),i.Y8G("icon","search"),i.R7$(),i.R50("ngModel",t.activeUser)}},dependencies:[l.Sq,l.bT,a.BC,a.vS,d.t,c.f,h.J,p.W],encapsulation:2})}return ReporterFilterItemUserMultiple})()},4502:(e,t,s)=>{s.d(t,{M:()=>b});var i=s(54438),n=s(69904),r=s(50531),o=s(29994),l=s(60177),a=s(84341),d=s(25863),c=s(84359),h=s(68823),p=s(32062);function u(e,t){if(1&e&&(i.j41(0,"span",18),i.EFF(1),i.k0s()),2&e){const e=i.XpG(2);i.R7$(),i.SpI(" ",e.value," ")}}function g(e,t){if(1&e&&(i.j41(0,"span",18),i.EFF(1),i.k0s()),2&e){const e=i.XpG(2);i.R7$(),i.SpI(" ",e.activeUserName," ")}}function m(e,t){if(1&e){const e=i.RV6();i.j41(0,"div",9)(1,"div",10)(2,"span",11)(3,"span",12),i.nrm(4,"system-icon",13),i.k0s(),i.DNE(5,u,2,1,"span",14)(6,g,2,1,"ng-template",null,15,i.C5r),i.j41(8,"button",16),i.bIt("click",(function(){i.eBV(e);const t=i.XpG();return i.Njj(t.clearField())})),i.nrm(9,"system-button-icon",17),i.k0s()()()()}if(2&e){const e=i.sdS(7),t=i.XpG();i.R7$(5),i.Y8G("ngIf","current_user_id"!=t.value)("ngIfElse",e),i.R7$(4),i.Y8G("icon","close")}}function f(e,t){if(1&e){const e=i.RV6();i.j41(0,"div",19)(1,"div",20)(2,"input",21),i.bIt("focus",(function(){i.eBV(e);const t=i.XpG();return i.Njj(t.searchWithModal())})),i.k0s(),i.j41(3,"button",22),i.bIt("click",(function(){i.eBV(e);const t=i.XpG();return i.Njj(t.searchWithModal())})),i.nrm(4,"system-button-icon",17),i.k0s()()()}if(2&e){const e=i.XpG();i.R7$(2),i.Y8G("placeholder",e.language.getModuleCombinedLabel("LBL_SEARCH","Users")),i.R7$(2),i.Y8G("icon","search")}}let b=(()=>{class ReporterFilterItemUserSingle{constructor(e,t,s){this.language=e,this.modal=t,this.session=s,this.whereCondition={},this.activeUserName=""}get activeUser(){return this.whereCondition.value.indexOf("current_user_id")>-1}set activeUser(e){this.value=e?["current_user_id"]:[""]}get value(){return this.whereCondition.value}set value(e){e&&0!=e.length&&(this.whereCondition.valuekey=e[0],this.whereCondition.value=e[0])}ngOnInit(){this.activeUserName=this.session.authData.userName}clearField(){this.whereCondition.value="",this.whereCondition.valuekey=""}searchWithModal(){this.modal.openModal("ObjectModalModuleLookup").subscribe((e=>{e.instance.module="Users",e.instance.multiselect=!1,e.instance.selectedItems.subscribe((e=>{e.length&&(this.value=e.map((e=>e.user_name)))}))}))}static#e=this.ɵfac=function(e){return new(e||ReporterFilterItemUserSingle)(i.rXU(n.B),i.rXU(r.y),i.rXU(o.d))};static#t=this.ɵcmp=i.VBU({type:ReporterFilterItemUserSingle,selectors:[["reporter-filter-item-user-single"]],inputs:{whereCondition:"whereCondition",fieldName:"fieldName"},decls:10,vars:3,consts:[[1,"slds-form-element","slds-grow"],[1,"slds-form-element__control","slds-size--1-of-1"],[1,"slds-combobox_container"],[1,"slds-form-element","slds-lookup"],["role","combobox",1,"slds-combobox","slds-dropdown-trigger","slds-dropdown-trigger_click"],["class","slds-form-element__control",4,"ngIf","ngIfElse"],["inputContainer",""],[1,"slds-m-left--x-small",3,"ngModel","ngModelChange"],["label","LBL_ACTIVE_USER"],[1,"slds-form-element__control"],[1,"slds-pill_container"],[1,"slds-pill","slds-size--1-of-1"],[1,"slds-icon_container","slds-icon-standard-account","slds-pill__icon_container"],["module","Users","size","small"],["class","slds-pill__label",4,"ngIf","ngIfElse"],["currentUserContainer",""],[1,"slds-button","slds-button--icon","slds-pill__remove",3,"click"],[3,"icon"],[1,"slds-pill__label"],[1,"slds-form-element__control","slds-grid","slds-box--border"],[1,"slds-input-has-icon","slds-input-has-icon--right","slds-grow"],["type","text","autocomplete","none","role","combobox",1,"slds-lookup__search-input","slds-input--bare","slds-theme--default",3,"placeholder","focus"],[1,"slds-button","slds-button_icon","slds-input__icon","slds-input__icon_right",3,"click"]],template:function(e,t){if(1&e&&(i.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),i.DNE(5,m,10,3,"div",5)(6,f,5,2,"ng-template",null,6,i.C5r),i.k0s()()()()(),i.j41(8,"system-checkbox",7),i.mxI("ngModelChange",(function(e){return i.DH7(t.activeUser,e)||(t.activeUser=e),e})),i.nrm(9,"system-label",8),i.k0s()),2&e){const e=i.sdS(7);i.R7$(5),i.Y8G("ngIf",!!t.value)("ngIfElse",e),i.R7$(3),i.R50("ngModel",t.activeUser)}},dependencies:[l.bT,a.BC,a.vS,d.t,c.f,h.J,p.W],encapsulation:2})}return ReporterFilterItemUserSingle})()},67975:(e,t,s)=>{s.r(t),s.d(t,{ModuleReports:()=>ks});var i=s(60177),n=s(84341),r=s(7745),o=s(37328),l=s(70569),a=s(71341),d=s(18039),c=s(54438),h=s(35911),p=s(11618),u=s(49969),g=s(41731),m=s(18359),f=s(40553),b=s(69904),v=s(83935),R=s(49722),y=s(57363),k=s(66031),F=s(69139),w=s(1876),I=s(44261),C=s(29895),D=s(46649),G=s(68823),x=s(44985),U=s(37263),B=s(25863),j=s(32062);const X=["actionitems"];let E=(()=>{class ReporterFilterButton{constructor(e,t){this.language=e,this.reporterconfig=t,this.whereConditions={},this.hasUserFilters=!1,this.showFilters=!1,this.filter=new c.bkB}ngOnChanges(){if(Array.isArray(this.whereConditions))for(let e of this.whereConditions)"yes"==e.usereditable&&(this.reporterconfig.addUserFilter(e),this.hasUserFilters=!0)}ngOnDestroy(){}toggleFilters(){this.showFilters=!this.showFilters,this.filter.emit(this.showFilters)}static#e=this.ɵfac=function(e){return new(e||ReporterFilterButton)(c.rXU(b.B),c.rXU(p.c))};static#t=this.ɵcmp=c.VBU({type:ReporterFilterButton,selectors:[["reporter-filter-button"]],viewQuery:function(e,t){if(1&e&&c.GBs(X,7,c.c1b),2&e){let e;c.mGM(e=c.lsd())&&(t.actionitems=e.first)}},inputs:{whereConditions:"whereConditions"},outputs:{filter:"filter"},features:[c.OA$],decls:4,vars:2,consts:[[1,"slds-button","slds-button--neutral","slds-grid","slds-grid--vertical-align-center",2,"border-top-left-radius","0","border-bottom-left-radius","0",3,"disabled","click"],["label","LBL_FILTER"],[1,"slds-p-horizontal--xxx-small",3,"icon"]],template:function(e,t){1&e&&(c.j41(0,"button",0),c.bIt("click",(function(){return t.toggleFilters()})),c.j41(1,"span"),c.nrm(2,"system-label",1),c.k0s(),c.nrm(3,"system-button-icon",2),c.k0s()),2&e&&(c.Y8G("disabled",!t.hasUserFilters),c.R7$(3),c.Y8G("icon","filterList"))},dependencies:[B.t,j.W],encapsulation:2})}return ReporterFilterButton})();var M=s(54546);const V=["actionItemsContainer"];let S=(()=>{class ReporterIntegrationExportButton{constructor(e,t,s){this.language=e,this.metadata=t,this.model=s,this.integrationParams={},this.actionComponentRefs=[]}get isDisabled(){if(!this.model.checkAccess("export"))return!1;if(this.integrationParams.activePlugins)for(let e in this.integrationParams.activePlugins)if(this.integrationParams.activePlugins.hasOwnProperty(e)&&1==this.integrationParams.activePlugins[e])switch(e){case"ktargetlistexport":case"kcsvexport":case"kexcelexport":case"kpdfexport":case"kplannerexport":if(1==this.integrationParams.activePlugins[e])return!1}return!0}ngAfterViewInit(){this.renderActionItems()}ngOnChanges(){this.renderActionItems()}renderActionItems(){if(this.actionComponentRefs.forEach((e=>e.destroy())),this.actionComponentRefs=[],this.integrationParams.activePlugins)for(let e in this.integrationParams.activePlugins)if(this.integrationParams.activePlugins.hasOwnProperty(e)&&1==this.integrationParams.activePlugins[e])switch(e){case"ktargetlistexport":1==this.integrationParams.activePlugins.ktargetlistexport&&this.renderActionItem("ReporterIntegrationTargetlistexportButton");break;case"kcsvexport":1==this.integrationParams.activePlugins.kcsvexport&&this.renderActionItem("ReporterIntegrationCSVexportButton");break;case"kexcelexport":1==this.integrationParams.activePlugins.kexcelexport&&this.renderActionItem("ReporterIntegrationXLSexportButton");break;case"kpdfexport":1==this.integrationParams.activePlugins.kpdfexport&&this.renderActionItem("ReporterIntegrationPDFexportButton");break;case"kplannerexport":1==this.integrationParams.activePlugins.kplannerexport&&this.renderActionItem("SalesPlanningReporterIntegrationExportButton")}}renderActionItem(e){this.metadata.addComponent(e,this.actionItemsContainer).subscribe((e=>{this.actionComponentRefs.push(e)}))}static#e=this.ɵfac=function(e){return new(e||ReporterIntegrationExportButton)(c.rXU(b.B),c.rXU(v.yu),c.rXU(h.g))};static#t=this.ɵcmp=c.VBU({type:ReporterIntegrationExportButton,selectors:[["reporter-integration-export-button"]],viewQuery:function(e,t){if(1&e&&c.GBs(V,7,c.c1b),2&e){let e;c.mGM(e=c.lsd())&&(t.actionItemsContainer=e.first)}},inputs:{integrationParams:"integrationParams"},features:[c.OA$],decls:9,vars:2,consts:[["system-dropdown-trigger-simple","",1,"slds-dropdown-trigger","slds-dropdown-trigger_click"],["aria-haspopup","true",1,"slds-button","slds-button--neutral",2,"border-top-right-radius","0","border-bottom-right-radius","0",3,"disabled"],["label","LBL_EXPORT"],[3,"icon"],[1,"slds-dropdown","slds-dropdown_right"],["role","menu",1,"slds-dropdown__list"],["actionItemsContainer",""]],template:function(e,t){1&e&&(c.j41(0,"div",0)(1,"button",1)(2,"span"),c.nrm(3,"system-label",2),c.k0s(),c.nrm(4,"system-button-icon",3),c.k0s(),c.j41(5,"div",4)(6,"ul",5),c.nrm(7,"div",null,6),c.k0s()()()),2&e&&(c.R7$(),c.Y8G("disabled",t.isDisabled),c.R7$(3),c.Y8G("icon","down"))},dependencies:[B.t,j.W,M.C],encapsulation:2,changeDetection:0})}return ReporterIntegrationExportButton})();const L=["actionItemsContainer"];let $=(()=>{class ReporterIntegrationToolsButton{constructor(e,t){this.language=e,this.metadata=t,this.integrationParams={},this.actionComponentRefs=[]}get isDisabled(){if(this.integrationParams.activePlugins)for(let e in this.integrationParams.activePlugins)if(this.integrationParams.activePlugins.hasOwnProperty(e))switch(e){case"kqueryanalizer":if(1==this.integrationParams.activePlugins.kqueryanalizer)return!1;case"kprocessworkflow":if(1==this.integrationParams.activePlugins.kprocessworkflow&&this.integrationParams.kprocessworkflow?.definition_id)return!1}return!0}ngOnChanges(){this.renderActionItems()}ngAfterViewInit(){this.renderActionItems()}renderActionItems(){if(this.actionComponentRefs.forEach((e=>e.destroy())),this.actionComponentRefs=[],this.integrationParams.activePlugins)for(let e in this.integrationParams.activePlugins)if(this.integrationParams.activePlugins.hasOwnProperty(e))switch(e){case"kqueryanalizer":1==this.integrationParams.activePlugins.kqueryanalizer&&this.metadata.addComponent("ReporterIntegrationQueryanalyzerButton",this.actionItemsContainer).subscribe((e=>{this.actionComponentRefs.push(e)}));break;case"kprocessworkflow":1==this.integrationParams.activePlugins.kprocessworkflow&&this.integrationParams.kprocessworkflow?.definition_id&&this.metadata.addComponent("ReporterIntegrationProcessWorkflowButton",this.actionItemsContainer).subscribe((e=>{this.actionComponentRefs.push(e)}))}}static#e=this.ɵfac=function(e){return new(e||ReporterIntegrationToolsButton)(c.rXU(b.B),c.rXU(v.yu))};static#t=this.ɵcmp=c.VBU({type:ReporterIntegrationToolsButton,selectors:[["reporter-integration-tools-button"]],viewQuery:function(e,t){if(1&e&&c.GBs(L,5,c.c1b),2&e){let e;c.mGM(e=c.lsd())&&(t.actionItemsContainer=e.first)}},inputs:{integrationParams:"integrationParams"},features:[c.OA$],decls:10,vars:2,consts:[["system-dropdown-trigger-simple","",1,"slds-dropdown-trigger","slds-dropdown-trigger_click"],["aria-haspopup","true",1,"slds-button","slds-button--neutral",2,"border-radius","0","border-left","0","border-right","0",3,"disabled"],["label","LBL_TOOLS"],[3,"icon"],[1,"slds-dropdown","slds-dropdown_right"],["role","menu",1,"slds-dropdown__list"],["actionItemsContainer",""]],template:function(e,t){1&e&&(c.j41(0,"div",0)(1,"button",1)(2,"span")(3,"span"),c.nrm(4,"system-label",2),c.k0s()(),c.nrm(5,"system-button-icon",3),c.k0s(),c.j41(6,"div",4)(7,"ul",5),c.nrm(8,"div",null,6),c.k0s()()()),2&e&&(c.R7$(),c.Y8G("disabled",t.isDisabled),c.R7$(4),c.Y8G("icon","down"))},dependencies:[B.t,j.W,M.C],encapsulation:2,changeDetection:0})}return ReporterIntegrationToolsButton})();function T(e,t){if(1&e&&(c.qex(0),c.EFF(1),c.bVm()),2&e){const e=c.XpG();c.R7$(),c.JRh(e.model.data.summary_text)}}const P=()=>({displayLabels:!1});function N(e,t){if(1&e&&c.nrm(0,"object-record-fieldset-horizontal-list",16),2&e){const e=c.XpG();c.Y8G("fieldset",e.fieldset)("system-view-provider",c.lJ4(2,P))}}let Y=(()=>{class ReporterDetailViewHeader extends w.e{constructor(e,t,s){super(s,t,e),this.metadata=e,this.model=t,this.router=s,this.whereConditions={},this.integrationParams={},this.showFilters=new c.bkB}toggleFilters(e){this.showFilters.emit(e)}static#e=this.ɵfac=function(e){return new(e||ReporterDetailViewHeader)(c.rXU(v.yu),c.rXU(h.g),c.rXU(y.Ix))};static#t=this.ɵcmp=c.VBU({type:ReporterDetailViewHeader,selectors:[["reporter-detail-view-header"]],inputs:{whereConditions:"whereConditions",integrationParams:"integrationParams"},outputs:{showFilters:"showFilters"},features:[c.Vt3],decls:19,vars:8,consts:[[1,"slds-page-header"],[1,"slds-grid"],[1,"slds-col","slds-has-flexi-truncate"],[1,"slds-media","slds-no-space","slds-grow"],[3,"module","click"],[1,"slds-media__body"],[1,"slds-text-title--caps","slds-line-height--reset"],[3,"click"],[3,"module"],[1,"slds-page-header__title","slds-m-right--small","slds-align-middle","slds-truncate"],[4,"ngIf"],[3,"fieldset","system-view-provider",4,"ngIf"],[1,"slds-m-horizontal--x-small","slds-show--medium","slds-button-group"],[3,"integrationParams"],[3,"whereConditions","filter"],[3,"actionset"],[3,"fieldset","system-view-provider"]],template:function(e,t){1&e&&(c.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"system-icon",4),c.bIt("click",(function(){return t.goToModule()})),c.k0s(),c.j41(5,"div",5)(6,"p",6)(7,"a",7),c.bIt("click",(function(){return t.goToModule()})),c.nrm(8,"system-label-modulename",8),c.k0s()(),c.j41(9,"div")(10,"h1",9),c.DNE(11,T,2,1,"ng-container",10)(12,N,1,3,"object-record-fieldset-horizontal-list",11),c.k0s()()()()(),c.j41(13,"div",12),c.nrm(14,"reporter-integration-export-button",13)(15,"reporter-integration-tools-button",13),c.j41(16,"reporter-filter-button",14),c.bIt("filter",(function(e){return t.toggleFilters(e)})),c.k0s()(),c.nrm(17,"object-action-container",15),c.k0s(),c.nrm(18,"object-page-header-tags"),c.k0s()),2&e&&(c.R7$(4),c.Y8G("module",t.moduleName),c.R7$(4),c.Y8G("module",t.moduleName),c.R7$(3),c.Y8G("ngIf",!t.fieldset),c.R7$(),c.Y8G("ngIf",t.fieldset),c.R7$(2),c.Y8G("integrationParams",t.integrationParams),c.R7$(),c.Y8G("integrationParams",t.integrationParams),c.R7$(),c.Y8G("whereConditions",t.whereConditions),c.R7$(),c.Y8G("actionset",t.actionSet))},dependencies:[i.bT,I.l,C.b,D.R,G.J,x.r,U.x,E,S,$],encapsulation:2})}return ReporterDetailViewHeader})();var z=s(41081),O=s(29994),A=s(84359),q=s(80256);function H(e,t){if(1&e&&(c.j41(0,"option",6),c.EFF(1),c.k0s()),2&e){const e=t.$implicit;c.Y8G("value",e.savedfilter_id),c.R7$(),c.JRh(e.name)}}let W=(()=>{class ReporterFilterSavedFilters{constructor(e,t,s,i,n){this.metadata=e,this.model=t,this.language=s,this.reporterconfig=i,this.backend=n,this.selectFilterChange=new c.bkB,this.reportId="",this._selectedFilterId="",this.savedFilters=[]}get selectedFilter(){return this._selectedFilterId}set selectedFilter(e){this._selectedFilterId=e,0==this._selectedFilterId.length?(this.reporterconfig.setDefaultUserFilter(),this.selectFilterChange.emit(null)):(this.selectFilterChange.emit(e),this.savedFilters.some((t=>{if(t.savedfilter_id==e)return this.reporterconfig.setSavedFilter(JSON.parse(t.selectedfilters)),!0})))}get isDisabled(){return 0==this.savedFilters.length}ngOnInit(){this.backend.getRequest(`module/KReports/${this.reportId}/savedfilters`,{assigneduserid:"own"}).subscribe((e=>{this.savedFilters=e}))}pushNewFilter(e){e.selectedfilters=JSON.stringify(e.selectedfilters),e.is_global&&(e.name="(G) "+e.name),this.savedFilters.push(e),this.selectedFilter=e.savedfilter_id}updateFilterData(){this.savedFilters.some((e=>{if(this.selectedFilter==e.savedfilter_id)return e.selectedfilters=JSON.stringify(this.reporterconfig.userFilters),!0}))}static#e=this.ɵfac=function(e){return new(e||ReporterFilterSavedFilters)(c.rXU(v.yu),c.rXU(h.g),c.rXU(b.B),c.rXU(p.c),c.rXU(R.H))};static#t=this.ɵcmp=c.VBU({type:ReporterFilterSavedFilters,selectors:[["reporter-filter-saved-filters"]],inputs:{reportId:"reportId",_selectedFilterId:"_selectedFilterId"},outputs:{selectFilterChange:"selectFilterChange"},decls:8,vars:3,consts:[[1,"slds-form-element"],[1,"slds-form-element__control"],[1,"slds-select_container"],[1,"slds-select",3,"ngModel","disabled","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){1&e&&(c.j41(0,"div")(1,"div",0)(2,"div",1)(3,"div",2)(4,"select",3),c.mxI("ngModelChange",(function(e){return c.DH7(t.selectedFilter,e)||(t.selectedFilter=e),e})),c.j41(5,"option",4),c.EFF(6,"---"),c.k0s(),c.DNE(7,H,2,2,"option",5),c.k0s()()()()()),2&e&&(c.R7$(4),c.R50("ngModel",t.selectedFilter),c.Y8G("disabled",t.isDisabled),c.R7$(3),c.Y8G("ngForOf",t.savedFilters))},dependencies:[i.Sq,n.xH,n.y7,n.wz,n.BC,n.vS],encapsulation:2})}return ReporterFilterSavedFilters})();var J=s(25946),K=s(37448),Q=s(29325),Z=s(36769);function ee(e,t){if(1&e&&(c.j41(0,"option",11),c.EFF(1),c.k0s()),2&e){const e=t.$implicit;c.Y8G("ngValue",e.value),c.R7$(),c.JRh(e.display)}}function te(e,t){if(1&e&&c.nrm(0,"reporter-filter-item-category",17),2&e){const e=c.XpG(2);c.Y8G("field","value")("wherecondition",e.wherecondition)("isMultiSelect",e.wherecondition.operator.includes("oneof"))}}function se(e,t){if(1&e&&c.nrm(0,"reporter-filter-item-enum",17),2&e){const e=c.XpG(2);c.Y8G("field","value")("wherecondition",e.wherecondition)("isMultiSelect",e.wherecondition.operator.includes("oneof"))}}function ie(e,t){if(1&e&&c.nrm(0,"reporter-filter-item-date",18),2&e){const e=c.XpG(2);c.Y8G("field","valuekey")("wherecondition",e.wherecondition)}}function ne(e,t){if(1&e&&c.nrm(0,"reporter-filter-item-text",18),2&e){const e=c.XpG(2);c.Y8G("field","value")("wherecondition",e.wherecondition)}}function re(e,t){if(1&e&&c.nrm(0,"reporter-filter-item-enum",18),2&e){const e=c.XpG(3);c.Y8G("field","valueto")("wherecondition",e.wherecondition)}}function oe(e,t){if(1&e&&c.nrm(0,"reporter-filter-item-date",18),2&e){const e=c.XpG(3);c.Y8G("field","valuetokey")("wherecondition",e.wherecondition)}}function le(e,t){if(1&e&&c.nrm(0,"reporter-filter-item-text",18),2&e){const e=c.XpG(3);c.Y8G("field","valueto")("wherecondition",e.wherecondition)}}function ae(e,t){if(1&e&&(c.j41(0,"div",19),c.DNE(1,re,1,2,"reporter-filter-item-enum",15)(2,oe,1,2,"reporter-filter-item-date",15)(3,le,1,2,"reporter-filter-item-text",15),c.k0s()),2&e){const e=c.XpG(2);c.Y8G("ngSwitch",e.itemType),c.R7$(),c.Y8G("ngSwitchCase","enum"),c.R7$(),c.Y8G("ngSwitchCase","date"),c.R7$(),c.Y8G("ngSwitchCase","text")}}const de=(e,t,s)=>({"slds-size--1-of-1":e,"slds-size--1-of-2":t,"slds-p-right--xxx-small":s});function ce(e,t){if(1&e&&(c.j41(0,"div",12)(1,"div",13),c.DNE(2,te,1,3,"reporter-filter-item-category",14)(3,se,1,3,"reporter-filter-item-enum",14)(4,ie,1,2,"reporter-filter-item-date",15)(5,ne,1,2,"reporter-filter-item-text",15),c.k0s(),c.DNE(6,ae,4,4,"div",16),c.k0s()),2&e){const e=c.XpG();c.R7$(),c.Y8G("ngSwitch",e.itemType)("ngClass",c.sMw(7,de,!e.showValueTo,e.showValueTo,e.showValueTo)),c.R7$(),c.Y8G("ngSwitchCase","category"),c.R7$(),c.Y8G("ngSwitchCase","enum"),c.R7$(),c.Y8G("ngSwitchCase","date"),c.R7$(),c.Y8G("ngSwitchCase","text"),c.R7$(),c.Y8G("ngIf",e.showValueTo)}}let he=(()=>{class ReporterFilterItem{constructor(e,t,s){this.language=e,this.model=t,this.reporterconfig=s,this.wherecondition={}}getOperators(){let e=[];const t=this.reporterconfig.operatorAssignments[this.wherecondition.type]||"varchar";let s=this.reporterconfig.operatorTypes[t];for(let t of s)e.push({value:t,display:this.language.getLabel("LBL_OP_"+t.toUpperCase())});return e.sort(((e,t)=>e.display>t.display?1:-1)),e}get itemType(){let e="text";switch(this.wherecondition.type){case"enum":case"multienum":case"radioenum":switch(this.wherecondition.operator){case"equals":case"notequal":case"oneof":case"oneofnot":case"oneofnotornull":e="enum"}break;case"category":switch(this.wherecondition.operator){case"equals":case"notequal":case"oneof":case"oneofnot":case"oneofnotornull":e="category"}break;case"date":case"datetime":case"datetimecombo":switch(this.wherecondition.operator){case"before":case"after":case"between":case"equals":e="date"}}return e}get showValue(){return this.reporterconfig.operatorCount[this.wherecondition.operator]>0}get showValueTo(){return this.reporterconfig.operatorCount[this.wherecondition.operator]>1}changeOperator(){this.wherecondition.value="",this.wherecondition.valuekey="",this.wherecondition.valueto="",this.wherecondition.valuetokey=""}static#e=this.ɵfac=function(e){return new(e||ReporterFilterItem)(c.rXU(b.B),c.rXU(h.g),c.rXU(p.c))};static#t=this.ɵcmp=c.VBU({type:ReporterFilterItem,selectors:[["reporter-filter-item"]],inputs:{wherecondition:"wherecondition"},decls:11,vars:4,consts:[[1,"slds-p-bottom--small"],[1,"slds-text-heading--label","slds-p-bottom--xxx-small"],[3,"label"],[1,"slds-form-element","slds-p-vertical--xx-small"],[1,"slds-form-element__control"],[1,"slds-select_container"],[1,"slds-select",3,"ngModel","ngModelChange","change"],["value","ignore"],["label","LBL_OP_IGNORE"],[3,"ngValue",4,"ngFor","ngForOf"],["class","slds-grid slds-p-vertical--xx-small",4,"ngIf"],[3,"ngValue"],[1,"slds-grid","slds-p-vertical--xx-small"],[3,"ngSwitch","ngClass"],[3,"field","wherecondition","isMultiSelect",4,"ngSwitchCase"],[3,"field","wherecondition",4,"ngSwitchCase"],["class","slds-size--1-of-2 slds-p-left--xxx-small",3,"ngSwitch",4,"ngIf"],[3,"field","wherecondition","isMultiSelect"],[3,"field","wherecondition"],[1,"slds-size--1-of-2","slds-p-left--xxx-small",3,"ngSwitch"]],template:function(e,t){1&e&&(c.j41(0,"div",0)(1,"div",1),c.nrm(2,"system-label",2),c.k0s(),c.j41(3,"div",3)(4,"div",4)(5,"div",5)(6,"select",6),c.mxI("ngModelChange",(function(e){return c.DH7(t.wherecondition.operator,e)||(t.wherecondition.operator=e),e})),c.bIt("change",(function(){return t.changeOperator()})),c.j41(7,"option",7),c.nrm(8,"system-label",8),c.k0s(),c.DNE(9,ee,2,2,"option",9),c.k0s()()()(),c.DNE(10,ce,7,11,"div",10),c.k0s()),2&e&&(c.R7$(2),c.Y8G("label",t.wherecondition.label?t.wherecondition.label:t.wherecondition.name),c.R7$(4),c.R50("ngModel",t.wherecondition.operator),c.R7$(3),c.Y8G("ngForOf",t.getOperators()),c.R7$(),c.Y8G("ngIf",t.showValue))},dependencies:[i.YU,i.Sq,i.bT,i.ux,i.e1,n.xH,n.y7,n.wz,n.BC,n.vS,j.W,J.s,K.U,Q.F,Z.R],encapsulation:2})}return ReporterFilterItem})();const pe=["popover"],ue=["savedFiltersContainer"];function ge(e,t){if(1&e){const e=c.RV6();c.j41(0,"div",28)(1,"reporter-filter-saved-filters",29,30),c.bIt("selectFilterChange",(function(t){c.eBV(e);const s=c.XpG();return c.Njj(s.setSelectedFilterId(t))})),c.k0s()()}if(2&e){const e=c.XpG();c.R7$(),c.Y8G("reportId",e.model.id)}}function me(e,t){if(1&e&&c.nrm(0,"reporter-filter-item",31),2&e){const e=t.$implicit;c.Y8G("wherecondition",e)}}function fe(e,t){if(1&e){const e=c.RV6();c.j41(0,"div",45)(1,"system-checkbox",46),c.mxI("ngModelChange",(function(t){c.eBV(e);const s=c.XpG(2);return c.DH7(s.filter.is_global,t)||(s.filter.is_global=t),c.Njj(t)})),c.nrm(2,"system-label",47),c.k0s()()}if(2&e){const e=c.XpG(2);c.R7$(),c.R50("ngModel",e.filter.is_global)}}function be(e,t){if(1&e){const e=c.RV6();c.j41(0,"div",32)(1,"div",33)(2,"fieldset",34)(3,"div",35)(4,"label",36),c.nrm(5,"system-label",37),c.k0s(),c.j41(6,"div",38)(7,"input",39),c.mxI("ngModelChange",(function(t){c.eBV(e);const s=c.XpG();return c.DH7(s.filter.name,t)||(s.filter.name=t),c.Njj(t)})),c.k0s()()(),c.DNE(8,fe,3,1,"div",40),c.k0s(),c.j41(9,"div",41)(10,"button",42),c.bIt("click",(function(){c.eBV(e);const t=c.XpG();return c.Njj(t.confirmSave())})),c.nrm(11,"system-label",19),c.k0s(),c.j41(12,"button",43),c.bIt("click",(function(){c.eBV(e);const t=c.XpG();return c.Njj(t.closePopover())})),c.nrm(13,"system-label",44),c.k0s()()()()}if(2&e){const e=c.XpG();c.Y8G("@animatepopover",void 0),c.R7$(7),c.R50("ngModel",e.filter.name),c.R7$(),c.Y8G("ngIf",e.isAdmin)}}const ve=[(0,u.hZ)("animatepopover",[(0,u.kY)(":enter",[(0,u.iF)({opacity:0}),(0,u.i0)(".25s",(0,u.iF)({opacity:1}))]),(0,u.kY)(":leave",[(0,u.iF)({opacity:"1"}),(0,u.i0)(".25s",(0,u.iF)({opacity:0}))])])];let Re=(()=>{class ReporterFilterPanel{constructor(e,t,s,i,n,r,o){this.model=e,this.language=t,this.elementRef=s,this.toast=i,this.backend=n,this.session=r,this.reporterconfig=o,this.filterapplied=new c.bkB,this.integrationparams={},this.showPopover=!1,this.filter={}}get isAdmin(){return!!this.session.authData.admin}get whereConditions(){return this.reporterconfig.userFilters}get popoverStyle(){let e=this.elementRef.nativeElement.getBoundingClientRect(),t=this.popover.element.nativeElement.getBoundingClientRect();return{position:"fixed",top:e.top+(e.height-t.height)/2+"px",left:e.left-t.width+"px"}}get displaySavedFilters(){return!!this.integrationparams.activePlugins&&!!this.integrationparams.activePlugins.ksavedfilters}openPopover(){this.showPopover=!0,this.initializeFilter()}closePopover(){this.showPopover=!1,this.initializeFilter()}initializeFilter(){this.filter={savedfilter_id:this.model.generateGuid(),name:"",isNew:!0,is_global:!1}}applyFilter(){this.filterapplied.emit(!0),this.reporterconfig.refresh()}setSelectedFilterId(e){this.selectedFilterId=e}handleSave(){if(!this.selectedFilterId)return this.openPopover();this.saveFilter(this.selectedFilterId)}saveFilter(e,t){let s={selectedfilters:{...this.reporterconfig.userFilters}};s&&(s={...t,...s}),this.backend.postRequest(`module/KReports/${this.model.id}/savedfilter/${e}`,[],s).subscribe((e=>{e&&e.success?(this.toast.sendToast(this.language.getLabel("LBL_DATA_SAVED"),"success"),this.savedFiltersComponent&&(t?this.savedFiltersComponent.pushNewFilter(s):this.savedFiltersComponent.updateFilterData())):this.toast.sendToast(this.language.getLabel("ERR_FAILED_TO_EXECUTE"),"error")}))}saveFilterAs(){this.selectedFilterId&&this.openPopover()}confirmSave(){this.selectedFilterId=void 0,this.saveFilter(this.filter.savedfilter_id,this.filter),this.closePopover()}static#e=this.ɵfac=function(e){return new(e||ReporterFilterPanel)(c.rXU(h.g),c.rXU(b.B),c.rXU(c.aKT),c.rXU(z.o),c.rXU(R.H),c.rXU(O.d),c.rXU(p.c))};static#t=this.ɵcmp=c.VBU({type:ReporterFilterPanel,selectors:[["reporter-filter-panel"]],viewQuery:function(e,t){if(1&e&&(c.GBs(pe,7,c.c1b),c.GBs(ue,5)),2&e){let e;c.mGM(e=c.lsd())&&(t.popover=e.first),c.mGM(e=c.lsd())&&(t.savedFiltersComponent=e.first)}},inputs:{integrationparams:"integrationparams"},outputs:{filterapplied:"filterapplied"},decls:30,vars:8,consts:[[1,"slds-panel","slds-grid","slds-grid_vertical","slds-nowrap","slds-panel_filters","slds-height_full",2,"width","500px","box-shadow","0 10px 10px #888"],[1,"slds-form","slds-form_stacked","slds-grow","slds-scrollable_y","slds-grid","slds-grid_vertical"],[1,"slds-filters"],[1,"slds-filters__header","slds-grid","slds-has-divider_bottom-space"],[1,"slds-align-middle","slds-text-heading_small"],["label","LBL_FILTER"],[1,"slds-button-group","slds-col_bump-left"],[1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_APPLY"],["system-dropdown-trigger","",1,"slds-dropdown-trigger","slds-dropdown-trigger_click","slds-button_last"],["aria-haspopup","true",1,"slds-button","slds-button_icon","slds-button_icon-border-filled",3,"disabled","title"],["icon","down"],[1,"slds-assistive-text"],["label","LBL_MORE"],[1,"slds-dropdown","slds-dropdown_right","slds-dropdown_actions"],["role","menu",1,"slds-dropdown__list"],["role","presentation",1,"slds-dropdown__item"],["href","javascript:void(0);","role","menuitem","tabindex","0",3,"click"],[1,"slds-truncate"],["label","LBL_SAVE"],["href","javascript:void(0);","role","menuitem","tabindex","-1",3,"click"],["label","LBL_SAVE_AS"],["class","slds-filters__header slds-has-divider_bottom-space",4,"ngIf"],[1,"slds-filters__body"],[3,"wherecondition",4,"ngFor","ngForOf"],[3,"ngStyle"],["popover",""],["class","slds-popover slds-nubbin--right","role","dialog",4,"ngIf"],[1,"slds-filters__header","slds-has-divider_bottom-space"],[3,"reportId","selectFilterChange"],["savedFiltersContainer",""],[3,"wherecondition"],["role","dialog",1,"slds-popover","slds-nubbin--right"],[1,"slds-popover__body"],[1,"slds-form--stacked"],[1,"slds-form-element"],[1,"slds-form-element__label"],["label","LBL_NAME"],[1,"slds-form-element__control"],["type","text",1,"slds-input",3,"ngModel","ngModelChange"],["class","slds-m-top--small",4,"ngIf"],[1,"slds-text-align--right","slds-p-top--x-small"],["type","button",1,"slds-button","slds-button--brand","slds-button-space-left",3,"click"],["type","button",1,"slds-button","slds-button--neutral","slds-button-space-left",3,"click"],["label","LBL_CLOSE"],[1,"slds-m-top--small"],[3,"ngModel","ngModelChange"],["label","LBL_GLOBAL"]],template:function(e,t){1&e&&(c.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),c.nrm(5,"system-label",5),c.k0s(),c.j41(6,"div",6)(7,"button",7),c.bIt("click",(function(){return t.applyFilter()})),c.nrm(8,"system-label",8),c.k0s(),c.j41(9,"div",9)(10,"button",10),c.nrm(11,"system-button-icon",11),c.j41(12,"span",12),c.nrm(13,"system-label",13),c.k0s()(),c.j41(14,"div",14)(15,"ul",15)(16,"li",16)(17,"a",17),c.bIt("click",(function(){return t.handleSave()})),c.j41(18,"span",18),c.nrm(19,"system-label",19),c.k0s()()(),c.j41(20,"li",16)(21,"a",20),c.bIt("click",(function(){return t.saveFilterAs()})),c.j41(22,"span",18),c.nrm(23,"system-label",21),c.k0s()()()()()()()(),c.DNE(24,ge,3,1,"div",22),c.j41(25,"div",23),c.DNE(26,me,1,1,"reporter-filter-item",24),c.k0s()()()(),c.j41(27,"div",25,26),c.DNE(29,be,14,3,"div",27),c.k0s()),2&e&&(c.R7$(10),c.Y8G("disabled",!t.displaySavedFilters)("title",t.language.getLabel("LBL_MORE")),c.R7$(12),c.AVh("slds-disabled-text",!t.selectedFilterId),c.R7$(2),c.Y8G("ngIf",t.displaySavedFilters),c.R7$(2),c.Y8G("ngForOf",t.whereConditions),c.R7$(),c.Y8G("ngStyle",t.popoverStyle),c.R7$(2),c.Y8G("ngIf",t.showPopover))},dependencies:[i.Sq,i.bT,i.B3,n.me,n.BC,n.vS,B.t,A.f,j.W,q.q,W,he],encapsulation:2,data:{animation:ve}})}return ReporterFilterPanel})();var ye=s(32130);const _e=["vizcontainer"];function ke(e,t){if(1&e){const e=c.RV6();c.j41(0,"div",3)(1,"div",4),c.bIt("click",(function(){c.eBV(e);const t=c.XpG();return c.Njj(t.openReport())})),c.EFF(2),c.k0s(),c.j41(3,"button",5),c.bIt("click",(function(){c.eBV(e);const t=c.XpG();return c.Njj(t.reload())})),c.nrm(4,"system-button-icon",6),c.k0s()()}if(2&e){const e=c.XpG();c.R7$(2),c.JRh(e.model.data.name)}}let Fe=(()=>{class ReporterDetailVisualization{constructor(e,t,s,i,n,r){this.reporterconfig=e,this.metadata=t,this.model=s,this.toast=i,this.backend=n,this.cdRef=r,this.httpRequestsRefID=window._.uniqueId("reporter_visualization_http_ref_"),this.parentModule="",this.parentId="",this.displayEmbedded=!1,this.loading=!0,this.vizData={},this.subscriptions=new m.yU,this.subscriptions.add(this.reporterconfig.refresh$.subscribe({next:e=>{e?this.getVisualization():this.handleCancel()}}))}ngAfterViewInit(){this.getVisualization()}ngOnDestroy(){this.subscriptions.unsubscribe(),this.backend.cancelPendingRequests([this.httpRequestsRefID])}reload(){this.chartComponent&&(this.chartComponent.destroy(),this.chartComponent=null),this.getVisualization()}getVisualization(){this.loading=!0,this.reporterconfig.isLoading.visualization=!0,this.cdRef.detectChanges();let e={};this.parentModule&&this.parentId&&(e.parentbeanId=this.parentId,e.parentbeanModule=this.parentModule);let t=[];for(let e of this.reporterconfig.userFilters)t.push({fieldid:e.fieldid,operator:e.operator,value:e.value,valuekey:e.valuekey,valueto:e.valueto,valuetokey:e.valuetokey});e.whereConditions=JSON.stringify(t),this.backend.cancelPendingRequests([this.httpRequestsRefID]),this.backend.getRequest("module/KReports/"+this.model.id+"/visualization",e,this.httpRequestsRefID).subscribe({next:e=>{this.vizData=e,this.loading=!1,this.reporterconfig.isLoading.visualization=!1,this.cdRef.detectChanges(),this.renderVisualization()},error:()=>{this.toast.sendToast("ERR_LOADING_RECORD","error"),this.loading=!1,this.reporterconfig.isLoading.visualization=!1,this.cdRef.detectChanges()}})}get visualizationStyle(){return{height:this.displayEmbedded?"calc(100% - 36px)":"100%"}}renderVisualization(){this.chartComponent&&(this.chartComponent.destroy(),this.chartComponent=null);for(let e of this.vizData){let t="";switch(e.plugin){case"highcharts":t="ReporterDetailVisualizationHighcharts";break;case"googlecharts":t="ReporterDetailVisualizationGooglecharts";break;case"googlemaps":t="ReporterDetailVisualizationGoogleMaps"}""!=t&&this.metadata.addComponent(t,this.vizcontainer).subscribe((t=>{this.chartComponent=t,t.instance.vizdata=e,t.changeDetectorRef.detectChanges()}))}}openReport(){this.model.goDetail()}handleCancel(){this.loading=!1,this.reporterconfig.isLoading.visualization=!1,this.cdRef.detectChanges(),this.backend.cancelPendingRequests([this.httpRequestsRefID])}static#e=this.ɵfac=function(e){return new(e||ReporterDetailVisualization)(c.rXU(p.c),c.rXU(v.yu),c.rXU(h.g),c.rXU(z.o),c.rXU(R.H),c.rXU(c.gRc))};static#t=this.ɵcmp=c.VBU({type:ReporterDetailVisualization,selectors:[["reporter-detail-visualization"]],viewQuery:function(e,t){if(1&e&&c.GBs(_e,7,c.c1b),2&e){let e;c.mGM(e=c.lsd())&&(t.vizcontainer=e.first)}},inputs:{parentModule:"parentModule",parentId:"parentId",displayEmbedded:"displayEmbedded"},decls:4,vars:4,consts:[["class","slds-grid slds-grid--align-spread slds-p-horizontal--xx-small slds-p-vertical--x-small",4,"ngIf"],[1,"slds-is-relative","slds-size--1-of-1",3,"ngStyle","cancellable","system-overlay-loading-spinner","onCancel"],["vizcontainer",""],[1,"slds-grid","slds-grid--align-spread","slds-p-horizontal--xx-small","slds-p-vertical--x-small"],[1,"slds-text-heading_small","slds-text-link_faux",3,"click"],[1,"slds-button","slds-button--icon",3,"click"],["icon","refresh"]],template:function(e,t){1&e&&(c.DNE(0,ke,5,1,"div",0),c.j41(1,"div",1),c.bIt("onCancel",(function(){return t.handleCancel()})),c.nrm(2,"div",null,2),c.k0s()),2&e&&(c.Y8G("ngIf",t.displayEmbedded),c.R7$(),c.Y8G("ngStyle",t.visualizationStyle)("cancellable",!0)("system-overlay-loading-spinner",t.loading))},dependencies:[i.bT,i.B3,B.t,ye.M],encapsulation:2,changeDetection:0})}return ReporterDetailVisualization})();const we=["presentationContainer"];function Ie(e,t){if(1&e&&(c.j41(0,"div",7),c.nrm(1,"reporter-detail-visualization"),c.k0s()),2&e){const e=c.XpG();c.xc7("height",e.visualizationHeight,"px")}}function Ce(e,t){if(1&e){const e=c.RV6();c.j41(0,"reporter-filter-panel",8),c.bIt("filterapplied",(function(){c.eBV(e);const t=c.XpG();return c.Njj(t.filterApplied())})),c.k0s()}if(2&e){const e=c.XpG();c.Y8G("@displayfilter",void 0)("integrationparams",e.integrationParams)}}const De=[(0,u.hZ)("displayfilter",[(0,u.kY)(":enter",[(0,u.iF)({width:"0px",overflow:"hidden"}),(0,u.i0)(".5s",(0,u.iF)({width:"*"})),(0,u.iF)({overflow:"unset"})]),(0,u.kY)(":leave",[(0,u.iF)({overflow:"hidden"}),(0,u.i0)(".5s",(0,u.iF)({width:"0px"}))])])];let Ge=(()=>{class ReporterDetailView{constructor(e,t,s,i,n,r,o,l,a,d,c,h){this.broadcast=e,this.language=t,this.metadata=s,this.injector=i,this.model=n,this.backend=r,this.activatedRoute=o,this.navigationtab=l,this.router=a,this.reporterconfig=d,this.cdRef=c,this.view=h,this.presentationComponentRef=void 0,this.hasVisualization=!1,this.visualizationHeight=0,this.whereConditions={},this.integrationParams={},this.showFilters=!1,this.subscriptions=new m.yU,this.subscribeToBroadcast()}ngOnInit(){this.setNavigationTabInfos(this.language.getModuleName(this.model.module)),this.setModelData(),this.view.isEditable=this.metadata.checkModuleAcl(this.model.module,"edit")}ngOnDestroy(){this.subscriptions.unsubscribe()}subscribeToBroadcast(){this.subscriptions.add(this.broadcast.message$.subscribe((e=>{"model.save"==e.messagetype&&e.messagedata.module==this.model.module&&e.messagedata.id==this.model.id&&(this.showFilters=!1,this.reporterconfig.resetUserFilters(),this.whereConditions=e.messagedata.data.whereconditions,this.setIntegrationParams(e.messagedata.data.integration_params),this.setVisualizationProperties(e.messagedata.data.visualization_params),this.renderPresentation(e.messagedata.data.presentation_params),this.reporterconfig.refresh(),this.cdRef.detectChanges())})))}setNavigationTabInfos(e){this.navigationtab.setTabInfo({displayname:e,displaymodule:this.model.module})}setModelData(){this.model.module=this.navigationtab.activeRoute.params.module,this.model.id=this.navigationtab.activeRoute.params.id,this.model.getData(!0,"detailview",!0,!0).subscribe((e=>{this.setNavigationTabInfos(e.summary_text),this.setVisualizationProperties(e.visualization_params),this.reporterconfig.resetUserFilters(),this.whereConditions=e.whereconditions,this.renderPresentation(e.presentation_params),this.setIntegrationParams(e.integration_params),this.cdRef.detectChanges()}))}setIntegrationParams(e){this.integrationParams=void 0,e&&(this.integrationParams=e)}setVisualizationProperties(e){this.hasVisualization=!1,e&&e&&e.layout&&"-"!=e.layout&&(this.hasVisualization=!0,this.visualizationHeight=e.chartheight?e.chartheight:300)}renderPresentation(e){if(this.presentationComponentRef&&(this.presentationComponentRef.destroy(),this.presentationComponentRef=void 0),!e)return;let t="";switch(e.plugin){case"standard":t="ReporterDetailPresentationStandard";break;case"grouped":t="ReporterDetailPresentationGrouped";break;case"standardws":t="ReporterDetailPresentationStandardWS";break;case"tree":t="ReporterDetailPresentationTree";break;case"pivot":t="ReporterDetailPresentationPivot"}""!=t&&this.metadata.addComponent(t,this.presentationContainer).subscribe((e=>{this.presentationComponentRef=e,this.presentationComponentRef.changeDetectorRef.detectChanges()}))}toggleFilters(e){this.showFilters=e}filterApplied(){this.showFilters=!1}static#e=this.ɵfac=function(e){return new(e||ReporterDetailView)(c.rXU(f.m),c.rXU(b.B),c.rXU(v.yu),c.rXU(c.zZn),c.rXU(h.g),c.rXU(R.H),c.rXU(y.nX),c.rXU(k._),c.rXU(y.Ix),c.rXU(p.c),c.rXU(c.gRc),c.rXU(g.U))};static#t=this.ɵcmp=c.VBU({type:ReporterDetailView,selectors:[["reporter-detilview"]],viewQuery:function(e,t){if(1&e&&c.GBs(we,7,c.c1b),2&e){let e;c.mGM(e=c.lsd())&&(t.presentationContainer=e.first)}},features:[c.Jv_([g.U,h.g,p.c])],decls:9,vars:4,consts:[[1,"slds-grid","slds-grid--vertical"],[3,"integrationParams","whereConditions","showFilters"],[1,"slds-is-relative","slds-grow",2,"min-height","0"],["class","slds-size--1-of-1",3,"height",4,"ngIf"],["system-to-bottom-noscroll",""],["presentationContainer",""],["class","slds-is-absolute","style","z-index: 100; right: 0; top: 0; bottom: 0",3,"integrationparams","filterapplied",4,"ngIf"],[1,"slds-size--1-of-1"],[1,"slds-is-absolute",2,"z-index","100","right","0","top","0","bottom","0",3,"integrationparams","filterapplied"]],template:function(e,t){1&e&&(c.j41(0,"div",0)(1,"div")(2,"reporter-detail-view-header",1),c.bIt("showFilters",(function(e){return t.toggleFilters(e)})),c.k0s()(),c.j41(3,"div",2),c.DNE(4,Ie,2,2,"div",3),c.j41(5,"div",4),c.nrm(6,"div",null,5),c.k0s(),c.DNE(8,Ce,1,2,"reporter-filter-panel",6),c.k0s()()),2&e&&(c.R7$(2),c.Y8G("integrationParams",t.integrationParams)("whereConditions",t.whereConditions),c.R7$(2),c.Y8G("ngIf",t.hasVisualization),c.R7$(4),c.Y8G("ngIf",t.showFilters))},dependencies:[i.bT,F.p,Y,Re,Fe],encapsulation:2,data:{animation:De},changeDetection:0})}return ReporterDetailView})(),xe=(()=>{class ReporterDetailViewRefreshButton{constructor(e,t){this.language=e,this.reporterconfig=t,this.subscription=new m.yU}ngOnDestroy(){this.subscription.unsubscribe()}execute(){this.reporterconfig.isLoading.visualization||this.reporterconfig.isLoading.presentation?this.reporterconfig.cancelRequests():this.reporterconfig.refresh()}static#e=this.ɵfac=function(e){return new(e||ReporterDetailViewRefreshButton)(c.rXU(b.B),c.rXU(p.c))};static#t=this.ɵcmp=c.VBU({type:ReporterDetailViewRefreshButton,selectors:[["reporter-detail-view-refresh-button"]],decls:2,vars:1,consts:[[3,"label"]],template:function(e,t){1&e&&(c.j41(0,"span"),c.nrm(1,"system-label",0),c.k0s()),2&e&&(c.R7$(),c.Y8G("label",t.reporterconfig.isLoading.visualization||t.reporterconfig.isLoading.presentation?"LBL_CANCEL":"LBL_REFRESH"))},dependencies:[j.W],encapsulation:2})}return ReporterDetailViewRefreshButton})(),Ue=(()=>{class ReporterDetailViewEditButton{constructor(e,t,s){this.language=e,this.router=t,this.model=s}execute(){this.disabled||this.router.navigate(["/module/KReports/designer/"+this.model.id])}get disabled(){return!this.model.checkAccess("edit")||(this.model.isEditing||this.model.isSaving)}static#e=this.ɵfac=function(e){return new(e||ReporterDetailViewEditButton)(c.rXU(b.B),c.rXU(y.Ix),c.rXU(h.g))};static#t=this.ɵcmp=c.VBU({type:ReporterDetailViewEditButton,selectors:[["reporter-detail-view-edit-button"]],decls:2,vars:0,consts:[["label","LBL_EDIT"]],template:function(e,t){1&e&&(c.j41(0,"span"),c.nrm(1,"system-label",0),c.k0s())},dependencies:[j.W],encapsulation:2})}return ReporterDetailViewEditButton})();var Be=s(93470),je=s(29501),Xe=s(53328),Ee=s(2877),Me=s(4502),Ve=s(58410),Se=s(87395),Le=s(50531),$e=s(49380),Te=s(18521),Pe=s(22465),Ne=s(10650),Ye=s(33325);const ze=(e,t)=>({record:e,field:t});function Oe(e,t){if(1&e&&(c.qex(0),c.j41(1,"div",2),c.nrm(2,"system-dynamic-component",3),c.k0s(),c.bVm()),2&e){const e=c.XpG();c.R7$(),c.Y8G("module",e.recordModule)("id",e.recordId),c.R7$(),c.Y8G("component",e.fieldType)("componentattributes",c.l_i(4,ze,e.record,e.field))}}function Ae(e,t){if(1&e&&c.nrm(0,"system-dynamic-component",3),2&e){const e=c.XpG();c.Y8G("component",e.fieldType)("componentattributes",c.l_i(2,ze,e.record,e.field))}}let qe=(()=>{class ReporterFieldContainer{constructor(e){this.metadata=e,this.record={},this.value="",this.field={}}ngOnInit(){this.initializeRecord(),this.buildLinkInfo(),this.determineFieldType()}initializeRecord(){this.value&&_.isEmpty(this.record)&&(this.record={},this.record[this.field.fieldid]=this.value,this.record[this.field.fieldid+"_val"]=this.value)}buildLinkInfo(){if("yes"==this.field.link&&this.record)if(this.field.linkinfo&&this.field.linkinfo[this.record.unionid?this.record.unionid:"root"])this.recordModule=this.field.linkinfo[this.record.unionid?this.record.unionid:"root"].module,this.recordId=this.record[this.field.linkinfo[this.record.unionid?this.record.unionid:"root"].idfield];else if(this.hasPathField){let e=this.fieldPathInfo.path.split("::").pop().split(":"),t=this.metadata.getFieldDefs(e[1],e[2]);this.recordModule=t.module,this.recordId=this.fieldPathInfo.id}else this.recordModule=this.record.sugarRecordModule,this.recordId=this.record.sugarRecordId}get fieldPathInfo(){let e=this.field.path.split("::");e.pop();let t,s=e.join("::");for(let e in this.record)if(this.record.hasOwnProperty(e)&&this.record[e]==s){t={},t.path=s,t.id=this.record[e.replace("path","id")];break}return t}get hasPathField(){let e=this.field.path.split("::");if(e.pop(),1==e.length)return!1;let t=e.join("::");for(let e in this.record)if(this.record.hasOwnProperty(e)&&this.record[e]==t)return!0;return!1}determineFieldType(){if(this.field.component)this.fieldType=this.field.component;else switch(this.field.type){case"percentage":this.fieldType="ReporterFieldPercentage";break;case"currency":case"currencyint":this.fieldType="ReporterFieldCurrency";break;case"enum":case"multienum":case"radioenum":this.fieldType="ReporterFieldEnum";break;case"datetimecombo":case"datetime":this.fieldType="ReporterFieldDateTime";break;case"date":this.fieldType="ReporterFieldDate";break;case"text":this.fieldType="ReporterFieldText";break;case"category":this.fieldType="ReporterFieldCategoryTree";break;case"number":case"float":this.fieldType="ReporterFieldNumber";break;case"int":this.fieldType="ReporterFieldInteger";break;default:this.fieldType="ReporterFieldStandard"}}static#e=this.ɵfac=function(e){return new(e||ReporterFieldContainer)(c.rXU(v.yu))};static#t=this.ɵcmp=c.VBU({type:ReporterFieldContainer,selectors:[["reporter-field-container"]],inputs:{record:"record",value:"value",field:"field"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["nolink",""],["system-model-popover","",1,"slds-text-link_reset",3,"module","id"],[3,"component","componentattributes"]],template:function(e,t){if(1&e&&c.DNE(0,Oe,3,7,"ng-container",0)(1,Ae,1,5,"ng-template",null,1,c.C5r),2&e){const e=c.sdS(2);c.Y8G("ngIf","yes"==t.field.link)("ngIfElse",e)}},dependencies:[i.bT,Ne.s,Ye.j],encapsulation:2,changeDetection:0})}return ReporterFieldContainer})();function He(e,t){if(1&e&&c.nrm(0,"system-utility-icon",15),2&e){const e=c.XpG(3);c.xc7("transform","desc"==e.sortData.sortDirection?"rotate(180deg)":"none")}}function We(e,t){if(1&e){const e=c.RV6();c.j41(0,"a",11),c.bIt("click",(function(){c.eBV(e);const t=c.XpG().$implicit,s=c.XpG();return c.Njj(s.toggleSort(t))})),c.j41(1,"div",12),c.nrm(2,"system-label",13),c.k0s(),c.DNE(3,He,1,2,"system-utility-icon",14),c.k0s()}if(2&e){const e=c.XpG().$implicit,t=c.XpG();c.Y8G("ngClass",t.fieldsDisplayClasses[e.fieldid]),c.R7$(2),c.Y8G("label",e.name),c.R7$(),c.Y8G("ngIf",!!t.sortData.sortDirection)}}function Je(e,t){if(1&e&&c.nrm(0,"system-utility-icon",15),2&e){const e=c.XpG(2).$implicit;c.xc7("transform","desc"==e.sort?"rotate(180deg)":"none")}}function Ke(e,t){if(1&e&&(c.j41(0,"div",16)(1,"div",17),c.nrm(2,"system-label",13),c.k0s(),c.DNE(3,Je,1,2,"system-utility-icon",14),c.k0s()),2&e){const e=c.XpG().$implicit;c.R7$(2),c.Y8G("label",e.name),c.R7$(),c.Y8G("ngIf",!!e.sort&&"-"!=e.sort)}}function Qe(e,t){if(1&e){const e=c.RV6();c.j41(0,"th",8),c.bIt("system-resize",(function(){c.eBV(e);const t=c.XpG();return c.Njj(t.onresize())})),c.DNE(1,We,4,3,"a",9)(2,Ke,4,2,"ng-template",null,10,c.C5r),c.k0s()}if(2&e){const e=t.$implicit,s=c.sdS(3),i=c.XpG();c.xc7("width",i.fieldsData[e.fieldid].width,"%"),c.Y8G("ngClass",i.fieldsDisplayClasses[e.fieldid])("resizeid",e.fieldid),c.R7$(),c.Y8G("ngIf",!!e.sort&&"sortable"==e.sort)("ngIfElse",s)}}function Ze(e,t){if(1&e&&(c.j41(0,"td",21),c.nrm(1,"reporter-field-container",22),c.k0s()),2&e){const e=t.$implicit,s=c.XpG().$implicit;c.R7$(),c.Y8G("field",e)("record",s)}}function et(e,t){if(1&e&&(c.j41(0,"tr",19),c.DNE(1,Ze,2,2,"td",20),c.k0s()),2&e){const e=c.XpG(2);c.R7$(),c.Y8G("ngForOf",e.displayFields)("ngForTrackBy",e.trackByFn)}}function tt(e,t){if(1&e&&(c.qex(0),c.DNE(1,et,2,2,"tr",18),c.bVm()),2&e){const e=c.XpG();c.R7$(),c.Y8G("ngForOf",e.presData.records)("ngForTrackBy",e.trackByFn)}}function st(e,t){1&e&&(c.j41(0,"div",23)(1,"h2",24),c.nrm(2,"system-label",25),c.k0s()())}function it(e,t){if(1&e){const e=c.RV6();c.j41(0,"button",36),c.bIt("click",(function(){c.eBV(e);const t=c.XpG(2);return c.Njj(t.saveLayout())})),c.nrm(1,"system-button-icon",37),c.k0s()}}function nt(e,t){if(1&e){const e=c.RV6();c.j41(0,"div",26)(1,"div",27),c.EFF(2),c.k0s(),c.j41(3,"div",27)(4,"button",28),c.bIt("click",(function(){c.eBV(e);const t=c.XpG();return c.Njj(t.firstPage())})),c.nrm(5,"system-custom-icon",29),c.k0s(),c.j41(6,"button",28),c.bIt("click",(function(){c.eBV(e);const t=c.XpG();return c.Njj(t.prevPage())})),c.nrm(7,"system-button-icon",30),c.k0s(),c.j41(8,"button",28),c.bIt("click",(function(){c.eBV(e);const t=c.XpG();return c.Njj(t.nextPage())})),c.nrm(9,"system-button-icon",31),c.k0s(),c.j41(10,"button",28),c.bIt("click",(function(){c.eBV(e);const t=c.XpG();return c.Njj(t.lastPage())})),c.nrm(11,"system-custom-icon",32),c.k0s(),c.j41(12,"button",33),c.bIt("click",(function(){c.eBV(e);const t=c.XpG();return c.Njj(t.selectFields())})),c.nrm(13,"system-button-icon",34),c.k0s(),c.DNE(14,it,2,0,"button",35),c.k0s()()}if(2&e){const e=c.XpG();c.R7$(2),c.Lme(" ",e.displayRecords," of ",e.presData.count," "),c.R7$(2),c.Y8G("disabled",e.prevDisabled),c.R7$(2),c.Y8G("disabled",e.prevDisabled),c.R7$(2),c.Y8G("disabled",e.nextDisabled),c.R7$(2),c.Y8G("disabled",e.nextDisabled),c.R7$(4),c.Y8G("ngIf",e.canSave)}}let rt=(()=>{class ReporterDetailPresentationStandard{constructor(e,t,s,i,n,r,o,l){this.language=e,this.model=t,this.modal=s,this.injector=i,this.backend=n,this.reporterconfig=r,this.cdRef=o,this.toast=l,this.httpRequestsRefID=window._.uniqueId("reporter_presentation_http_ref_"),this.presParams={},this.presData={},this.fieldsData={},this.fieldsDisplayClasses={},this.totalWidth=0,this.showFooter=!0,this.isLoading=!0,this.sortData={sortField:"",sortDirection:""},this.displayFields=[],this.currentPage=1,this.subscriptions=new m.yU,this.subscriptions.add(this.reporterconfig.refresh$.subscribe({next:e=>{e?this.getPresentation():this.handleCancel()}}))}get listEntries(){try{return this.presParams.pluginData.standardViewProperties.listEntries}catch(e){return 25}}get displayRecords(){let e=(this.currentPage-1)*this.listEntries+1,t=this.currentPage*this.listEntries;return e+" - "+(t>this.presData.count?this.presData.count:t)}get canSave(){return this.model.checkAccess("edit")}get prevDisabled(){return this.currentPage<=1}get nextDisabled(){return this.currentPage*this.listEntries>=this.presData.count}ngOnInit(){this.presParams=this.model.getField("presentation_params")}ngAfterViewInit(){this.getPresentation()}ngOnDestroy(){this.subscriptions.unsubscribe(),this.backend.cancelPendingRequests([this.httpRequestsRefID])}getPresentation(){this.isLoading=!0,this.reporterconfig.isLoading.presentation=!0,this.cdRef.detectChanges();let e=[];for(let t of this.reporterconfig.userFilters)e.push({fieldid:t.fieldid,operator:t.operator,value:t.value,valuekey:t.valuekey,valueto:t.valueto,valuetokey:t.valuetokey});let t={start:(this.currentPage-1)*this.listEntries,limit:this.listEntries,whereConditions:JSON.stringify(e),parentbeanId:this.model.parentBeanId,parentbeanModule:this.model.parentBeanModule,sort:void 0};this.sortData.sortField&&(t.sort=JSON.stringify([{direction:this.sortData.sortDirection.toUpperCase(),property:this.sortData.sortField}])),this.backend.cancelPendingRequests([this.httpRequestsRefID]),this.backend.postRequest(`module/KReports/${this.model.id}/presentation/dynamicoptions`,{},t,this.httpRequestsRefID).subscribe({next:e=>{if(this.presData=[],this.cdRef.detectChanges(),e){if(0==this.totalWidth)for(let t of e.reportmetadata.fields)this.fieldsData[t.fieldid]=t,this.fieldsDisplayClasses[t.fieldid]=this.generateFieldDisplayClass(t),this.totalWidth+=t.width;this.presData=e,this.setDisplayFields(),this.processPresData(),this.isLoading=!1,this.reporterconfig.isLoading.presentation=!1,this.cdRef.detectChanges()}},error:()=>{this.toast.sendToast("ERR_LOADING_RECORD","error"),this.isLoading=!1,this.reporterconfig.isLoading.presentation=!1,this.cdRef.detectChanges()}})}processPresData(){}trackByFn(e,t){return t.id}setDisplayFields(){this.displayFields=[],this.cdRef.detectChanges(),this.presData.reportmetadata&&this.presData.reportmetadata.fields&&(this.displayFields=this.presData.reportmetadata.fields.filter((e=>"yes"==e.display)).sort(((e,t)=>e.sequence&&t.sequence?parseInt(e.sequence,10)>parseInt(t.sequence,10)?1:-1:0)),this.cdRef.detectChanges())}generateFieldDisplayClass(e){let t=[];switch(e.sort&&"-"!=e.sort&&(t.push("slds-is-sortable"),e.fieldid==this.sortData.sortField&&(t.push("slds-is-sorted"),"asc"==this.sortData.sortDirection&&t.push("slds-is-sorted_asc"))),e.type){case"currency":case"currencyint":t.push("slds-grid--align-end");break;case"enum":case"multienum":case"radioenum":t.push("slds-grid--align-center")}return t.join(" ")}toggleSort(e){"sortable"==e.sort&&(this.sortData.sortField==e.fieldid?("asc"==this.sortData.sortDirection?this.sortData.sortDirection="desc":(this.sortData.sortField="",this.sortData.sortDirection=""),this.getPresentation()):(this.sortData.sortField=e.fieldid,this.sortData.sortDirection="asc",this.getPresentation()))}onresize(){let e={},t=0;this.resizeElements.forEach((s=>{let i=s.getElementWidth();t+=i,e[s.resizeid]=s.getElementWidth()}));for(let s in this.fieldsData)this.fieldsData.hasOwnProperty(s)&&(this.fieldsData[s].width=Math.round(e[s]/t*100));this.totalWidth=100}saveLayout(){if(this.model.checkAccess("edit")){let e=[];for(let t of this.model.getField("listfields").filter((e=>"hidden"!=e.display)))e.push({dataIndex:t.fieldid,width:this.fieldsData[t.fieldid].width,sequence:parseInt(this.fieldsData[t.fieldid].sequence,10),isHidden:"yes"!=this.fieldsData[t.fieldid].display});this.backend.postRequest("module/KReports/"+this.model.id+"/layout",{},{layout:e}).subscribe((e=>{e.success&&this.toast.sendToast("Layout saved")}))}}firstPage(){this.currentPage=1,this.getPresentation()}prevPage(){this.currentPage--,this.getPresentation()}nextPage(){this.currentPage++,this.getPresentation()}lastPage(){this.currentPage=Math.ceil(this.presData.count/this.listEntries),this.getPresentation()}selectFields(){this.modal.openModal("ReporterDetailSelectFieldsModal",!0,this.injector).subscribe((e=>{e.instance.presentationFields=this.presData.reportmetadata.fields,e.instance.dataChanged$.subscribe((e=>{e&&this.setDisplayFields()}))}))}handleCancel(){this.isLoading=!1,this.reporterconfig.isLoading.presentation=!1,this.backend.cancelPendingRequests([this.httpRequestsRefID]),this.cdRef.detectChanges()}static#e=this.ɵfac=function(e){return new(e||ReporterDetailPresentationStandard)(c.rXU(b.B),c.rXU(h.g),c.rXU(Le.y),c.rXU(c.zZn),c.rXU(R.H),c.rXU(p.c),c.rXU(c.gRc),c.rXU(z.o))};static#t=this.ɵcmp=c.VBU({type:ReporterDetailPresentationStandard,selectors:[["reporter-detail-presentation-standard"]],viewQuery:function(e,t){if(1&e&&c.GBs(Se.T,5),2&e){let e;c.mGM(e=c.lsd())&&(t.resizeElements=e)}},decls:11,vars:7,consts:[[1,"slds-height_full","slds-grid","slds-grid--vertical"],[1,"slds-scrollable--y","slds-grow","slds-grid","slds-grid--vertical",2,"min-height","0",3,"cancellable","system-overlay-loading-spinner","onCancel"],[1,"slds-table","slds-table_bordered","slds-table--fixed-layout","slds-table--header-fixed"],[1,"slds-text-title--caps"],["scope","col","class","slds-resizable",3,"ngClass","width","resizeid","system-resize",4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],["class","slds-p-around--medium slds-align--absolute-center slds-grow","style","min-height: 0",4,"ngIf"],["class","slds-p-vertical--x-small slds-grid slds-grid_vertical-align-center slds-grid_align-spread",4,"ngIf"],["scope","col",1,"slds-resizable",3,"ngClass","resizeid","system-resize"],["href","javascript:void(0);","class","slds-th__action slds-text-link--reset slds-grid",3,"ngClass","click",4,"ngIf","ngIfElse"],["notsortable",""],["href","javascript:void(0);",1,"slds-th__action","slds-text-link--reset","slds-grid",3,"ngClass","click"],[1,"slds-truncate","slds-p-vertical--xx-small"],[3,"label"],["icon","arrowdown","size","x-small",3,"transform",4,"ngIf"],["icon","arrowdown","size","x-small"],[1,"slds-th__action","slds-grid"],[1,"slds-truncate"],["style","vertical-align: top;",4,"ngFor","ngForOf","ngForTrackBy"],[2,"vertical-align","top"],["scope","row",4,"ngFor","ngForOf","ngForTrackBy"],["scope","row"],[3,"field","record"],[1,"slds-p-around--medium","slds-align--absolute-center","slds-grow",2,"min-height","0"],[1,"slds-text-heading--small"],["label","LBL_NO_ENTRIES"],[1,"slds-p-vertical--x-small","slds-grid","slds-grid_vertical-align-center","slds-grid_align-spread"],[1,"slds-p-horizontal--medium"],[1,"slds-button","slds-button_icon",3,"disabled","click"],["icon","chevrondoubleleft","size","x-small"],["icon","chevronleft"],["icon","chevronright"],["icon","chevrondoubleright","size","x-small"],["system-title","LBL_CHOOSE_FIELDS",1,"slds-button","slds-button_icon",3,"click"],["icon","settings"],["class","slds-button slds-button_icon","system-title","LBL_SAVE_LAYOUT",3,"click",4,"ngIf"],["system-title","LBL_SAVE_LAYOUT",1,"slds-button","slds-button_icon",3,"click"],["icon","save"]],template:function(e,t){1&e&&(c.j41(0,"div",0)(1,"div",1),c.bIt("onCancel",(function(){return t.handleCancel()})),c.j41(2,"table",2)(3,"thead")(4,"tr",3),c.DNE(5,Qe,4,6,"th",4),c.k0s()(),c.j41(6,"tbody"),c.DNE(7,tt,2,2,"ng-container",5),c.k0s()(),c.DNE(8,st,3,0,"div",6),c.k0s(),c.j41(9,"div"),c.DNE(10,nt,15,7,"div",7),c.k0s()()),2&e&&(c.R7$(),c.Y8G("cancellable",!0)("system-overlay-loading-spinner",t.isLoading),c.R7$(4),c.Y8G("ngForOf",t.displayFields)("ngForTrackBy",t.trackByFn),c.R7$(2),c.Y8G("ngIf",(null==t.presData||null==t.presData.records?null:t.presData.records.length)>0),c.R7$(),c.Y8G("ngIf",!t.isLoading&&0==(null==t.presData.records?null:t.presData.records.length)),c.R7$(2),c.Y8G("ngIf",t.showFooter))},dependencies:[i.YU,i.Sq,i.bT,B.t,$e.k,j.W,Te.B,ye.M,Se.T,Pe.L,qe],encapsulation:2,changeDetection:0})}return ReporterDetailPresentationStandard})();var ot=s(84412),lt=s(40713),at=s(25028),dt=s(88418),ct=s(83524);function ht(e,t){if(1&e&&(c.j41(0,"div",16)(1,"span",17),c.nrm(2,"system-label",18),c.k0s()()),2&e){const e=t.$implicit;c.Y8G("cdkDragData",e),c.R7$(2),c.Y8G("label",e.name)}}function pt(e,t){if(1&e&&(c.j41(0,"div",16)(1,"span",17),c.nrm(2,"system-label",18),c.k0s()()),2&e){const e=t.$implicit;c.Y8G("cdkDragData",e),c.R7$(2),c.Y8G("label",e.name)}}const ut=e=>[e];let gt=(()=>{class ReporterDetailSelectFieldsModal{constructor(e,t){this.metadata=e,this.language=t,this.dataChanged$=new ot.t(!1),this.presentationFields=[],this.self={},this.availableFields=[],this.displayFields=[]}ngOnInit(){this.availableFields=this.presentationFields.filter((e=>"no"==e.display)),this.displayFields=this.presentationFields.filter((e=>"yes"==e.display)),this.availableFields.length>0&&this.sortAvailableFields(),this.displayFields.sort(((e,t)=>e.sequence&&t.sequence?parseInt(e.sequence,10)>parseInt(t.sequence,10)?1:-1:0))}sortAvailableFields(){this.availableFields=this.availableFields.sort(((e,t)=>this.language.getLabel(e.name).toLowerCase()>this.language.getLabel(t.name).toLowerCase()?1:-1))}close(){this.self.destroy()}canSet(){return this.displayFields.length>0}set(){if(this.canSet()){let e=1;for(let t of this.displayFields)t.display="yes",t.sequence=e,t.width||(t.width=25),e++;for(let t of this.availableFields)t.display="no",t.sequence=e,e++;this.presentationFields.sort(((e,t)=>e.sequence&&t.sequence?parseInt(e.sequence,10)>parseInt(t.sequence,10)?1:-1:0)),this.dataChanged$.next(!0),this.dataChanged$.complete(),this.close()}}onFieldDrop(e){let t=e.previousContainer.data.splice(e.previousIndex,1);e.container.data.splice(e.currentIndex,0,t[0])}static#e=this.ɵfac=function(e){return new(e||ReporterDetailSelectFieldsModal)(c.rXU(v.yu),c.rXU(b.B))};static#t=this.ɵcmp=c.VBU({type:ReporterDetailSelectFieldsModal,selectors:[["ng-component"]],decls:22,vars:11,consts:[[3,"close"],["label","LBL_SETFIELDS"],[1,"slds-grid"],[1,"slds-form-element","slds-p-horizontal--small","slds-size--1-of-2"],[1,"slds-form-element__label"],["label","LBL_AVAILABLE_FIELDS"],["cdkDropList","",1,"slds-picklist","slds-picklist__options","slds-size--1-of-1",2,"height","50vh",3,"cdkDropListData","cdkDropListConnectedTo","cdkDropListDropped"],["listOne","cdkDropList"],["cdkDrag","","class","slds-drag--preview slds-picklist__item","role","option",3,"cdkDragData",4,"ngFor","ngForOf"],["label","LBL_SELECTED_FIELDS"],["cdkDropList","",1,"slds-picklist","slds-picklist__options","slds-size--1-of-1","cdk-drag",2,"height","50vh",3,"cdkDropListData","cdkDropListConnectedTo","cdkDropListDropped"],["listTwo","cdkDropList"],[1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_CANCEL"],[1,"slds-button","slds-button--brand",3,"disabled","click"],["label","LBL_SET"],["cdkDrag","","role","option",1,"slds-drag--preview","slds-picklist__item",3,"cdkDragData"],[1,"slds-truncate"],[3,"label"]],template:function(e,t){if(1&e&&(c.j41(0,"system-modal")(1,"system-modal-header",0),c.bIt("close",(function(){return t.close()})),c.nrm(2,"system-label",1),c.k0s(),c.j41(3,"system-modal-content")(4,"div",2)(5,"div",3)(6,"span",4),c.nrm(7,"system-label",5),c.k0s(),c.j41(8,"div",6,7),c.bIt("cdkDropListDropped",(function(e){return t.onFieldDrop(e)})),c.DNE(10,ht,3,2,"div",8),c.k0s()(),c.j41(11,"div",3)(12,"span",4),c.nrm(13,"system-label",9),c.k0s(),c.j41(14,"div",10,11),c.bIt("cdkDropListDropped",(function(e){return t.onFieldDrop(e)})),c.DNE(16,pt,3,2,"div",8),c.k0s()()()(),c.j41(17,"system-modal-footer")(18,"button",12),c.bIt("click",(function(){return t.close()})),c.nrm(19,"system-label",13),c.k0s(),c.j41(20,"button",14),c.bIt("click",(function(){return t.set()})),c.nrm(21,"system-label",15),c.k0s()()()),2&e){const e=c.sdS(9),s=c.sdS(15);c.R7$(8),c.Y8G("cdkDropListData",t.availableFields)("cdkDropListConnectedTo",c.eq3(7,ut,s)),c.R7$(2),c.Y8G("ngForOf",t.availableFields),c.R7$(4),c.Y8G("cdkDropListData",t.displayFields)("cdkDropListConnectedTo",c.eq3(9,ut,e)),c.R7$(2),c.Y8G("ngForOf",t.displayFields),c.R7$(4),c.Y8G("disabled",!t.canSet())}},dependencies:[i.Sq,j.W,lt.D,at.I,dt.Q,ct.C,d.O7,d.T1],encapsulation:2,changeDetection:0})}return ReporterDetailSelectFieldsModal})();var mt=s(82802);let ft=(()=>{class ReporterDetailVisualizationGooglecharts{constructor(e,t,s,i,n){this.renderer=e,this.elementRef=t,this.metadata=s,this.zone=i,this.libloader=n,this.vizdata={},this.wrapper=void 0,this.resizeHandler={},this.resizeHandler=this.renderer.listen("window","resize",(()=>this.onResize()))}ngAfterViewInit(){this.loadGoogleChart()}loadGoogleChart(){this.vizdata.data.options.height||(this.vizdata.data.options.height=this.elementRef.nativeElement.height),this.libloader.loadLib("googlecharts").subscribe((e=>{this.zone.runOutsideAngular((()=>{google.charts.load("current",{packages:["corechart"]}),google.charts.setOnLoadCallback((()=>{this.drawchart()}))}))}))}ngOnDestroy(){this.resizeHandler()}drawchart(){this.wrapper=new google.visualization.ChartWrapper(this.vizdata.data),this.wrapper.draw()}onResize(){this.wrapper&&this.zone.runOutsideAngular((()=>{this.wrapper.draw()}))}static#e=this.ɵfac=function(e){return new(e||ReporterDetailVisualizationGooglecharts)(c.rXU(c.sFG),c.rXU(c.aKT),c.rXU(v.yu),c.rXU(c.SKi),c.rXU(mt.b))};static#t=this.ɵcmp=c.VBU({type:ReporterDetailVisualizationGooglecharts,selectors:[["reporter-detail-visualization-googlecharts"]],decls:2,vars:2,consts:[[1,"slds-is-absolute","slds-box--border","slds-p-vertical--small","slds-p-horizontal--small",3,"ngStyle"],[2,"width","100%","height","100%",3,"id"]],template:function(e,t){1&e&&(c.j41(0,"div",0),c.nrm(1,"div",1),c.k0s()),2&e&&(c.Y8G("ngStyle",null==t.vizdata?null:t.vizdata.layout),c.R7$(),c.Y8G("id",t.vizdata.uid))},dependencies:[i.B3],encapsulation:2,changeDetection:0})}return ReporterDetailVisualizationGooglecharts})();function bt(e,t){if(1&e&&c.nrm(0,"reporter-detail-visualization",1),2&e){const e=c.XpG();c.Y8G("parentId",e.parentId)("parentModule",e.parentModule)("displayEmbedded",!0)}}let vt=(()=>{class ReporterVisualizationDashlet{constructor(e,t){this.model=e,this.reporterconfig=t,this.id="",this.config=void 0,this.parentModule="",this.parentId="",this.componentconfig={},this.hasVisualization=!1,this.noAccess=new c.bkB}ngOnInit(){this.config&&(this.componentconfig=this.config)}ngAfterViewInit(){""!==this.componentconfig.reportid&&(this.model.module="KReports",this.model.id=this.componentconfig.reportid,this.model.getData().subscribe((e=>{""!=e.visualization_params&&(this.hasVisualization=!0)}),(e=>{"403"!=e.status&&"404"!=e.status||this.noAccess.emit(!0)})))}static#e=this.ɵfac=function(e){return new(e||ReporterVisualizationDashlet)(c.rXU(h.g),c.rXU(p.c))};static#t=this.ɵcmp=c.VBU({type:ReporterVisualizationDashlet,selectors:[["reporter-visualization-dashlet"]],inputs:{id:"id",config:"config",parentModule:"parentModule",parentId:"parentId"},outputs:{noAccess:"noAccess"},features:[c.Jv_([h.g,p.c])],decls:1,vars:1,consts:[[3,"parentId","parentModule","displayEmbedded",4,"ngIf"],[3,"parentId","parentModule","displayEmbedded"]],template:function(e,t){1&e&&c.DNE(0,bt,1,3,"reporter-detail-visualization",0),2&e&&c.Y8G("ngIf",t.hasVisualization)},dependencies:[i.bT,Fe],encapsulation:2})}return ReporterVisualizationDashlet})();const Rt=e=>({"slds-hide":e});let yt=(()=>{class ReporterVisualizationContainer{constructor(e){this.model=e,this.componentconfig={},this.isHidden=!1}noAccess(e){this.isHidden=e}static#e=this.ɵfac=function(e){return new(e||ReporterVisualizationContainer)(c.rXU(h.g))};static#t=this.ɵcmp=c.VBU({type:ReporterVisualizationContainer,selectors:[["reporter-visualization-container"]],decls:2,vars:6,consts:[[1,"slds-card","slds-m-bottom--medium",2,"height","300px","width","100%",3,"ngClass"],[3,"config","parentModule","parentId","noAccess"]],template:function(e,t){1&e&&(c.j41(0,"div",0)(1,"reporter-visualization-dashlet",1),c.bIt("noAccess",(function(e){return t.noAccess(e)})),c.k0s()()),2&e&&(c.Y8G("ngClass",c.eq3(4,Rt,t.isHidden)),c.R7$(),c.Y8G("config",t.componentconfig)("parentModule",t.model.module)("parentId",t.model.id))},dependencies:[i.YU,vt],styles:["\n\n\n\n\n\n\n\n\n\n\n[_nghost-%COMP%]{height:300px;width:100%}"]})}return ReporterVisualizationContainer})();var _t=s(21413);const kt=["presentationcontainer"];function Ft(e,t){if(1&e){const e=c.RV6();c.j41(0,"h2",3),c.bIt("click",(function(){c.eBV(e);const t=c.XpG();return c.Njj(t.openReport())})),c.j41(1,"span",4),c.EFF(2),c.k0s()()}if(2&e){const e=c.XpG();c.R7$(2),c.JRh(e.model.data.name)}}let wt=(()=>{class ReporterPresentationDashlet{constructor(e,t,s,i,n,r){this.model=e,this.metadata=t,this.elementRef=s,this.toast=i,this.language=n,this.reporterconfig=r,this.parentModule="",this.parentId="",this.displayheader=!0,this.componentconfig={},this.refreshReport=new _t.B,this.dashletTitle=new c.bkB,this.presComponent=void 0,this.noAccess=new c.bkB}ngAfterViewInit(){""!==this.componentconfig.reportid&&(this.model.module="KReports",this.model.id=this.componentconfig.reportid,this.parentId&&this.parentModule&&(this.model.parentBeanId=this.parentId,this.model.parentBeanModule=this.parentModule),this.model.getData().subscribe({next:e=>{this.dashletTitle.emit(this.model.getField("name")),this.renderPresentation()},error:e=>{"403"==e.status||"404"==e.status?this.noAccess.emit(!0):this.toast.sendToast(this.language.getLabel("LBL_ERROR_LOADING_DATA"),"error")}}))}ngOnInit(){this.refreshReport.subscribe((e=>{e&&this.reporterconfig.refresh()}))}get containerstyle(){this.presentationcontainer.element.nativeElement.getBoundingClientRect();return{height:"calc(100% - "+this.presentationcontainer.element.nativeElement.offsetTop+"px)"}}openReport(){this.model.goDetail()}renderPresentation(){this.presComponent&&(this.presComponent.destroy(),this.presComponent=void 0);let e="";switch(this.model.getField("presentation_params").plugin){case"standard":e="ReporterDetailPresentationStandard";break;case"grouped":e="ReporterDetailPresentationGrouped";break;case"standardws":e="ReporterDetailPresentationStandardWS";break;case"tree":e="ReporterDetailPresentationTree";break;case"pivot":e="ReporterDetailPresentationPivot"}""!=e&&this.metadata.addComponent(e,this.presentationcontainer).subscribe((e=>{e.instance.showFooter=!1,this.presComponent=e}))}static#e=this.ɵfac=function(e){return new(e||ReporterPresentationDashlet)(c.rXU(h.g),c.rXU(v.yu),c.rXU(c.aKT),c.rXU(z.o),c.rXU(b.B),c.rXU(p.c))};static#t=this.ɵcmp=c.VBU({type:ReporterPresentationDashlet,selectors:[["reporter-presentation-dashlet"]],viewQuery:function(e,t){if(1&e&&c.GBs(kt,7,c.c1b),2&e){let e;c.mGM(e=c.lsd())&&(t.presentationcontainer=e.first)}},inputs:{parentModule:"parentModule",parentId:"parentId",displayheader:"displayheader",componentconfig:"componentconfig",refreshReport:"refreshReport"},outputs:{dashletTitle:"dashletTitle",noAccess:"noAccess"},features:[c.Jv_([h.g,p.c])],decls:4,vars:2,consts:[["class","slds-text-heading--medium slds-p-around--medium",3,"click",4,"ngIf"],[1,"slds-scrollable--y",3,"ngStyle"],["presentationcontainer",""],[1,"slds-text-heading--medium","slds-p-around--medium",3,"click"],[1,"slds-text-link_faux"]],template:function(e,t){1&e&&(c.DNE(0,Ft,3,1,"h2",0),c.j41(1,"div",1),c.nrm(2,"div",null,2),c.k0s()),2&e&&(c.Y8G("ngIf",t.displayheader),c.R7$(),c.Y8G("ngStyle",t.containerstyle))},dependencies:[i.bT,i.B3],styles:["\n\n\n\n\n\n\n\n\n\n\n[_nghost-%COMP%]{height:100%;width:100%}"]})}return ReporterPresentationDashlet})();const It=e=>({"slds-hide":e});function Ct(e,t){if(1&e){const e=c.RV6();c.j41(0,"div",1)(1,"div",2)(2,"header",3),c.nrm(3,"system-icon",4),c.j41(4,"div",5)(5,"h2",6),c.EFF(6),c.k0s()()()(),c.j41(7,"reporter-presentation-dashlet",7),c.bIt("dashletTitle",(function(t){c.eBV(e);const s=c.XpG();return c.Njj(s.dashletTitle=t)}))("noAccess",(function(t){c.eBV(e);const s=c.XpG();return c.Njj(s.noAccess(t))})),c.k0s(),c.j41(8,"footer",8)(9,"div",9)(10,"div",10)(11,"button",11),c.bIt("click",(function(){c.eBV(e);const t=c.XpG();return c.Njj(t.execute())})),c.nrm(12,"system-button-icon",12),c.k0s()()()()()}if(2&e){const e=c.XpG();c.Y8G("ngClass",c.eq3(8,It,e.isHidden)),c.R7$(3),c.Y8G("size","small"),c.R7$(3),c.JRh(e.title),c.R7$(),c.Y8G("refreshReport",e.refreshReport)("componentconfig",e.componentconfig)("parentModule",e.model.module)("parentId",e.model.id)("displayheader",!1)}}let Dt=(()=>{class ReporterPresentationContainer{constructor(e,t,s){this.model=e,this.language=t,this.reporterconfig=s,this.componentconfig={},this.isHidden=!1,this.refreshReport=new _t.B}get title(){return this.dashletTitle?this.dashletTitle:this.language.getModuleName("KReports")}get hidden(){return this.componentconfig.requiredmodelstate&&!this.model.checkModelState(this.componentconfig.requiredmodelstate)}noAccess(e){this.isHidden=e}execute(){this.refreshReport.next(!0)}static#e=this.ɵfac=function(e){return new(e||ReporterPresentationContainer)(c.rXU(h.g),c.rXU(b.B),c.rXU(p.c))};static#t=this.ɵcmp=c.VBU({type:ReporterPresentationContainer,selectors:[["reporter-presentation-container"]],features:[c.Jv_([p.c])],decls:1,vars:1,consts:[["class","slds-card slds-card_boundary slds-m-bottom--medium",3,"ngClass",4,"ngIf"],[1,"slds-card","slds-card_boundary","slds-m-bottom--medium",3,"ngClass"],[1,"slds-card__header","slds-grid","slds-grid--vertical-align-center"],[1,"slds-media","slds-media--center","slds-has-flexi-truncate"],["module","KReports",3,"size"],[1,"slds-media__body","slds-truncate","slds-grid","slds-grid--vertical-align-center"],[1,"slds-text-heading--small"],[3,"refreshReport","componentconfig","parentModule","parentId","displayheader","dashletTitle","noAccess"],[1,"slds-card__footer"],[1,"slds-grid","slds-grid_align-end"],[1,"slds-text-align--right"],[1,"slds-button","slds-button_icon",3,"click"],["icon","refresh"]],template:function(e,t){1&e&&c.DNE(0,Ct,13,10,"div",0),2&e&&c.Y8G("ngIf",!t.hidden)},dependencies:[i.YU,i.bT,B.t,G.J,wt],encapsulation:2})}return ReporterPresentationContainer})();var Gt=s(65245),xt=s(75103),Ut=s(53584);let Bt=(()=>{class ReporterCockpitTile{constructor(e,t){this.backend=e,this.router=t,this.report={}}navigateDetail(){this.router.navigate(["/module/KReports/"+this.report.id])}static#e=this.ɵfac=function(e){return new(e||ReporterCockpitTile)(c.rXU(R.H),c.rXU(y.Ix))};static#t=this.ɵcmp=c.VBU({type:ReporterCockpitTile,selectors:[["reporter-cockpit-tile"]],hostAttrs:[1,"slds-tile","slds-media","slds-p-vertical--small","slds-card__tile","slds-p-horizontal--small","slds-size--1-of-3","slds-hint-parent"],inputs:{report:"report"},decls:9,vars:4,consts:[[1,"slds-media__figure","slds-m-right--none","slds-p-top--xxx-small"],[3,"module"],[1,"slds-media__body","slds-truncate"],[1,"slds-grid","slds-grid--align-spread","slds-has-flexi-truncate"],[1,"slds-truncate"],["href","javascript:void(0);",3,"click"],[1,"slds-tile__detail","slds-text-body--small",3,"title"],[1,"slds-item--detail","slds-truncate",3,"innerHtml"]],template:function(e,t){1&e&&(c.j41(0,"div",0),c.nrm(1,"system-icon",1),c.k0s(),c.j41(2,"div",2)(3,"div",3)(4,"h3",4)(5,"a",5),c.bIt("click",(function(){return t.navigateDetail()})),c.EFF(6),c.k0s()()(),c.j41(7,"div",6),c.nrm(8,"dd",7),c.k0s()()),2&e&&(c.R7$(),c.Y8G("module",t.report.report_module),c.R7$(5),c.SpI(" ",t.report.name," "),c.R7$(),c.Y8G("title",t.report.description),c.R7$(),c.Y8G("innerHtml",t.report.description,c.npT))},dependencies:[G.J],encapsulation:2})}return ReporterCockpitTile})();function jt(e,t){if(1&e&&c.nrm(0,"reporter-cockpit-tile",12),2&e){const e=t.$implicit;c.Y8G("report",e)}}function Xt(e,t){if(1&e){const e=c.RV6();c.j41(0,"div",13)(1,"div"),c.EFF(2),c.nrm(3,"system-label",14),c.EFF(4),c.k0s(),c.j41(5,"div",15)(6,"a",16),c.bIt("click",(function(){c.eBV(e);const t=c.XpG(2).$implicit,s=c.XpG();return c.Njj(s.loadMore(t.bucket))})),c.nrm(7,"system-label",17),c.k0s()()()}if(2&e){const e=c.XpG(2).$implicit;c.R7$(2),c.SpI(" ",e.items," "),c.R7$(2),c.SpI(" ",e.total," ")}}function Et(e,t){if(1&e&&(c.j41(0,"article",3)(1,"div",4)(2,"header",5)(3,"div",6)(4,"h2")(5,"span",7),c.EFF(6),c.k0s()()()()(),c.j41(7,"div",8)(8,"div",9),c.DNE(9,jt,1,1,"reporter-cockpit-tile",10),c.k0s()(),c.DNE(10,Xt,8,2,"div",11),c.k0s()),2&e){const e=c.XpG().$implicit,t=c.XpG();c.R7$(6),c.Lme("",e.bucket," (",e.items,")"),c.R7$(3),c.Y8G("ngForOf",t.getCategoryReports(e.bucket)),c.R7$(),c.Y8G("ngIf",e.items<e.total)}}function Mt(e,t){if(1&e&&(c.qex(0),c.DNE(1,Et,11,4,"article",2),c.bVm()),2&e){const e=t.$implicit;c.R7$(),c.Y8G("ngIf",(null==e?null:e.items)>0)}}let Vt=(()=>{class ReporterCockpit{constructor(e,t,s,i,n){this.backend=e,this.modellist=t,this.language=s,this.configuration=i,this.metadata=n,this.componentconfig={},this.subscriptions=new m.yU,this.allFields=[]}get sortField(){return this.componentconfig.sortfield}get sortDirection(){return this.componentconfig.sortdirection?this.componentconfig.sortdirection:"ASC"}ngOnInit(){this.initialize()}initialize(){this.componentconfig=this.metadata.getComponentConfig("ReporterCockpit",this.modellist.module),this.modellist.loadlimit=15,this.loadCategories(),this.sortField&&this.modellist.setSortField(this.sortField,this.sortDirection),this.subscriptions.add(this.modellist.listType$.pipe((0,Gt.i)(1)).subscribe((e=>this.handleListTypeChange(e))))}handleListTypeChange(e){"ReporterCockpit"==e.listcomponent&&this.modellist.reLoadList()}loadCategories(){const e=this.configuration.getData("reportcategories");this.setBuckets(e),this.modellist.getListData()}setBuckets(e){this.modellist.buckets={bucketfield:"category_name",buckettotal:[],bucketitems:e.map((e=>({bucket:e.name,values:{},items:0,hidden:!1})))}}ngOnDestroy(){this.modellist.buckets={}}loadMore(e){this.modellist.loadMoreBucketList(e)}getCategoryReports(e){return this.modellist.listData.list.filter((t=>t.category_name==e))}static#e=this.ɵfac=function(e){return new(e||ReporterCockpit)(c.rXU(R.H),c.rXU(xt.K),c.rXU(b.B),c.rXU(Ut.i),c.rXU(v.yu))};static#t=this.ɵcmp=c.VBU({type:ReporterCockpit,selectors:[["reporter-cockpit"]],decls:2,vars:2,consts:[[1,"slds-scrollable",2,"height","100%",3,"system-overlay-loading-spinner"],[4,"ngFor","ngForOf"],["class","slds-card slds-m-around--medium",4,"ngIf"],[1,"slds-card","slds-m-around--medium"],[1,"slds-card__header","slds-grid"],[1,"slds-media","slds-media--center","slds-has-flexi-truncate"],[1,"slds-media__body"],[1,"slds-text-heading--medium"],[1,"slds-card__body","slds-card__body_inner"],[1,"slds-card__body--inner","slds-grid","slds-wrap","slds-grid--pull-padded"],[3,"report",4,"ngFor","ngForOf"],["class","slds-card__footer slds-grid",4,"ngIf"],[3,"report"],[1,"slds-card__footer","slds-grid"],["label","LBL_OF"],[1,"slds-grow"],["href","javascript:void(0);",3,"click"],["label","LBL_MORE"]],template:function(e,t){1&e&&(c.j41(0,"div",0),c.DNE(1,Mt,2,1,"ng-container",1),c.k0s()),2&e&&(c.Y8G("system-overlay-loading-spinner",t.modellist.isLoading),c.R7$(),c.Y8G("ngForOf",null==t.modellist.buckets?null:t.modellist.buckets.bucketitems))},dependencies:[i.Sq,i.bT,j.W,ye.M,Bt],encapsulation:2})}return ReporterCockpit})();function St(e,t){if(1&e&&(c.j41(0,"div",1),c.EFF(1),c.k0s()),2&e){const e=c.XpG();c.R7$(),c.SpI(" ",e.record[e.field.fieldid],"\n")}}let Lt=(()=>{class ReporterFieldStandard{constructor(){this.record={},this.field={}}static#e=this.ɵfac=function(e){return new(e||ReporterFieldStandard)};static#t=this.ɵcmp=c.VBU({type:ReporterFieldStandard,selectors:[["reporter-field-standard"]],decls:1,vars:1,consts:[["class","slds-truncate",4,"ngIf"],[1,"slds-truncate"]],template:function(e,t){1&e&&c.DNE(0,St,2,1,"div",0),2&e&&c.Y8G("ngIf",t.record)},dependencies:[i.bT],encapsulation:2,changeDetection:0})}return ReporterFieldStandard})();var $t=s(345);let Tt=(()=>{class ReporterFieldText{constructor(e){this.sanitizer=e,this.record={},this.field={},this.value=""}ngOnInit(){this.setFormattedFieldValue()}setFormattedFieldValue(){this.record[this.field.fieldid]&&(this.value=this.sanitizer.bypassSecurityTrustHtml(this.record[this.field.fieldid].replace(/(?:\r\n|\r|\n)/g,"<br>")))}static#e=this.ɵfac=function(e){return new(e||ReporterFieldText)(c.rXU($t.up))};static#t=this.ɵcmp=c.VBU({type:ReporterFieldText,selectors:[["reporter-field-text"]],decls:1,vars:1,consts:[[1,"slds-truncate",2,"white-space","normal",3,"innerHTML"]],template:function(e,t){1&e&&c.nrm(0,"div",0),2&e&&c.Y8G("innerHTML",t.value,c.npT)},encapsulation:2,changeDetection:0})}return ReporterFieldText})();var Pt=s(88421),Nt=s(48849);let Yt=(()=>{class ReporterFieldCurrency{constructor(e,t){this.currency=e,this.userpreferences=t,this.record={},this.field={},this.value="",this.currencySymbol=""}ngOnInit(){this.setCurrencySymbol(),this.setFormattedFieldValue()}setCurrencySymbol(){if(!this.record[this.field.fieldid])return;let e=-99;const t=this.field.fieldid+"_curid",s=this.currency.getCurrencies()||[];t&&(e=this.record[t]);const i=s.find((t=>t.id==e));this.currencySymbol=i?i.symbol:""}setFormattedFieldValue(){this.record[this.field.fieldid]?this.value=this.userpreferences.formatMoney(parseFloat(this.record[this.field.fieldid])):this.value=""}static#e=this.ɵfac=function(e){return new(e||ReporterFieldCurrency)(c.rXU(Pt.G),c.rXU(Nt.S))};static#t=this.ɵcmp=c.VBU({type:ReporterFieldCurrency,selectors:[["reporter-field-currency"]],decls:5,vars:2,consts:[[1,"slds-grid","slds-grid--align-end"],[1,"slds-text-align--right"]],template:function(e,t){1&e&&(c.j41(0,"div",0)(1,"div"),c.EFF(2),c.k0s(),c.j41(3,"div",1),c.EFF(4),c.k0s()()),2&e&&(c.R7$(2),c.SpI(" ",t.currencySymbol," "),c.R7$(2),c.SpI(" ",t.value," "))},encapsulation:2,changeDetection:0})}return ReporterFieldCurrency})();var zt=s(38431);function Ot(e,t){if(1&e&&(c.j41(0,"div",1),c.nrm(1,"system-display-number",2),c.EFF(2,"%\n"),c.k0s()),2&e){const e=c.XpG();c.R7$(),c.Y8G("number",e.record[e.field.fieldid])}}let At=(()=>{class ReporterFieldPercentage{constructor(){this.record={},this.field={}}static#e=this.ɵfac=function(e){return new(e||ReporterFieldPercentage)};static#t=this.ɵcmp=c.VBU({type:ReporterFieldPercentage,selectors:[["ng-component"]],decls:1,vars:1,consts:[["class","slds-text-align--center",4,"ngIf"],[1,"slds-text-align--center"],["precision","2",3,"number"]],template:function(e,t){1&e&&c.DNE(0,Ot,3,1,"div",0),2&e&&c.Y8G("ngIf",t.record[t.field.fieldid])},dependencies:[i.bT,zt.B],encapsulation:2,changeDetection:0})}return ReporterFieldPercentage})(),qt=(()=>{class ReporterFieldEnum{constructor(e,t){this.language=e,this.metadata=t,this.record={},this.field={},this.value=""}ngOnInit(){this.setFormattedFieldValue()}setFormattedFieldValue(){let e=this.field.path.split("::"),t=e.length;const s=e[t-1].split(":")[1];let i,n=e[t-2].split(":");switch(n[0]){case"root":i=n[1];break;case"link":i=this.metadata.getFieldDefs(n[1],n[2]).module}this.value=s&&i?this.language.getFieldDisplayOptionValue(i,s,this.record[this.field.fieldid+"_val"]):this.record[this.field.fieldid]}static#e=this.ɵfac=function(e){return new(e||ReporterFieldEnum)(c.rXU(b.B),c.rXU(v.yu))};static#t=this.ɵcmp=c.VBU({type:ReporterFieldEnum,selectors:[["reporter-field-enum"]],decls:2,vars:1,consts:[[1,"slds-truncate","slds-text-align--center"]],template:function(e,t){1&e&&(c.j41(0,"div",0),c.EFF(1),c.k0s()),2&e&&(c.R7$(),c.SpI(" ",t.value,"\n"))},encapsulation:2,changeDetection:0})}return ReporterFieldEnum})(),Ht=(()=>{class ReporterFieldDate{constructor(e){this.userpreferences=e,this.record={},this.field={},this.value=""}ngOnInit(){this.setFormattedFieldValue()}setFormattedFieldValue(){if(this.record[this.field.fieldid]){let e=new moment.utc(this.record[this.field.fieldid]);e.isValid()&&(this.value=e.format(this.userpreferences.getDateFormat()))}}static#e=this.ɵfac=function(e){return new(e||ReporterFieldDate)(c.rXU(Nt.S))};static#t=this.ɵcmp=c.VBU({type:ReporterFieldDate,selectors:[["reporter-field-date"]],decls:2,vars:1,consts:[[1,"slds-truncate"]],template:function(e,t){1&e&&(c.j41(0,"div",0),c.EFF(1),c.k0s()),2&e&&(c.R7$(),c.SpI(" ",t.value,"\n"))},encapsulation:2,changeDetection:0})}return ReporterFieldDate})(),Wt=(()=>{class ReporterFieldDateTime{constructor(e,t,s,i){this.userpreferences=e,this.session=t,this.cdRef=s,this.broadcast=i,this.record={},this.field={},this.value="",this.subscription=new m.yU,this.subscribeToTimezoneChange()}ngOnInit(){this.setFormattedFieldValue()}ngOnDestroy(){this.subscription.unsubscribe()}subscribeToTimezoneChange(){this.subscription.add(this.broadcast.message$.subscribe((e=>{"timezone.changed"==e.messagetype&&(this.setFormattedFieldValue(),this.cdRef.detectChanges())})))}setFormattedFieldValue(){if(this.record[this.field.fieldid]){let e=new moment.utc(this.record[this.field.fieldid]).tz(this.session.getSessionData("timezone")||moment.tz.guess(!0));e.isValid()&&(this.value=this.userpreferences.formatDateTime(e))}}static#e=this.ɵfac=function(e){return new(e||ReporterFieldDateTime)(c.rXU(Nt.S),c.rXU(O.d),c.rXU(c.gRc),c.rXU(f.m))};static#t=this.ɵcmp=c.VBU({type:ReporterFieldDateTime,selectors:[["reporter-field-date-time"]],decls:2,vars:1,consts:[[1,"slds-truncate"]],template:function(e,t){1&e&&(c.j41(0,"div",0),c.EFF(1),c.k0s()),2&e&&(c.R7$(),c.SpI(" ",t.value,"\n"))},encapsulation:2,changeDetection:0})}return ReporterFieldDateTime})(),Jt=(()=>{class ReporterFieldColor{constructor(){this.record={},this.field={}}static#e=this.ɵfac=function(e){return new(e||ReporterFieldColor)};static#t=this.ɵcmp=c.VBU({type:ReporterFieldColor,selectors:[["reporter-field-Color"]],decls:3,vars:1,consts:[[1,"slds-align--absolute-center"],["height","16","width","16"],["cx","8","cy","8","r","6","stroke","grey","stroke-width","1"]],template:function(e,t){1&e&&(c.j41(0,"div",0),c.qSk(),c.j41(1,"svg",1),c.nrm(2,"circle",2),c.k0s()()),2&e&&(c.R7$(2),c.BMQ("fill",t.record[t.field.fieldid]))},encapsulation:2})}return ReporterFieldColor})();var Kt=s(13921),Qt=s(766),Zt=s(66935),es=s(89166);function ts(e,t){if(1&e&&c.nrm(0,"field-label",3),2&e){const e=c.XpG();c.Y8G("fieldname",e.fieldname)("fieldconfig",e.fieldconfig)}}function ss(e,t){if(1&e&&(c.j41(0,"option",9),c.EFF(1),c.k0s()),2&e){const e=t.$implicit;c.Y8G("value",e.id),c.R7$(),c.SpI(" ",e.name," ")}}function is(e,t){if(1&e&&(c.j41(0,"field-generic-display",4)(1,"div",5)(2,"div",6)(3,"select",7),c.nrm(4,"option"),c.DNE(5,ss,2,2,"option",8),c.k0s()()()()),2&e){const e=c.XpG();c.Y8G("fielddisplayclass",e.fielddisplayclass)("editable",e.isEditable())("fieldconfig",e.fieldconfig)("fieldid",e.fieldid),c.R7$(3),c.Y8G("ngModel",e.valueId)("disabled",!0),c.R7$(2),c.Y8G("ngForOf",e.categories)}}function ns(e,t){if(1&e&&(c.j41(0,"option",9),c.EFF(1),c.k0s()),2&e){const e=t.$implicit;c.Y8G("value",e.id),c.R7$(),c.SpI(" ",e.name," ")}}function rs(e,t){if(1&e){const e=c.RV6();c.j41(0,"div",10)(1,"div",5)(2,"div",6)(3,"select",11),c.mxI("ngModelChange",(function(t){c.eBV(e);const s=c.XpG();return c.DH7(s.valueId,t)||(s.valueId=t),c.Njj(t)})),c.nrm(4,"option"),c.DNE(5,ns,2,2,"option",8),c.k0s()()(),c.nrm(6,"field-messages",12),c.k0s()}if(2&e){const e=c.XpG();c.Y8G("ngClass",e.getFieldClass()),c.R7$(3),c.R50("ngModel",e.valueId),c.R7$(2),c.Y8G("ngForOf",e.categories),c.R7$(),c.Y8G("fieldname",e.fieldname)}}let os=(()=>{class FieldReportCategory extends Kt.s{constructor(e,t,s,i,n,r,o){super(o,s,e,r,t),this.language=e,this.router=t,this.view=s,this.backend=i,this.configuration=n,this.metadata=r,this.model=o,this.categories=[],this.loadCategories()}set valueId(e){this.model.setField("category_id",e)}get valueId(){return this.model.getField("category_id")}loadCategories(){const e=this.configuration.getData("reportcategories");e?this.categories=e:this.backend.getRequest("module/KReports/categoriesmanager/categories").subscribe((e=>{e&&(this.categories=e)}))}static#e=this.ɵfac=function(e){return new(e||FieldReportCategory)(c.rXU(b.B),c.rXU(y.Ix),c.rXU(g.U),c.rXU(R.H),c.rXU(Ut.i),c.rXU(v.yu),c.rXU(h.g))};static#t=this.ɵcmp=c.VBU({type:FieldReportCategory,selectors:[["field-report-category"]],features:[c.Vt3],decls:3,vars:3,consts:[[3,"fieldname","fieldconfig",4,"ngIf"],[3,"fielddisplayclass","editable","fieldconfig","fieldid",4,"ngIf"],["class","slds-form-element",3,"ngClass",4,"ngIf"],[3,"fieldname","fieldconfig"],[3,"fielddisplayclass","editable","fieldconfig","fieldid"],[1,"slds-form-element__control","slds-p-vertical--xx-small"],[1,"slds-select_container"],[1,"slds-select",3,"ngModel","disabled"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"slds-form-element",3,"ngClass"],[1,"slds-select",3,"ngModel","ngModelChange"],[3,"fieldname"]],template:function(e,t){1&e&&c.DNE(0,ts,1,2,"field-label",0)(1,is,6,7,"field-generic-display",1)(2,rs,7,4,"div",2),2&e&&(c.Y8G("ngIf",t.displayLabel),c.R7$(),c.Y8G("ngIf",!t.isEditMode()),c.R7$(),c.Y8G("ngIf",t.isEditable()&&t.isEditMode()))},dependencies:[i.YU,i.Sq,i.bT,n.xH,n.y7,n.wz,n.BC,n.vS,Qt.b,Zt.K,es.A],encapsulation:2})}return FieldReportCategory})(),ls=(()=>{class ReporterIntegrationTargetlistexportButton{constructor(e,t,s,i,n){this.language=e,this.metadata=t,this.model=s,this.modal=i,this.reporterconfig=n}showModal(){let e=[];for(let t of this.reporterconfig.userFilters)e.push({fieldid:t.fieldid,operator:t.operator,value:t.value,valuekey:t.valuekey,valueto:t.valueto,valuetokey:t.valuetokey});this.modal.openModal("ReporterIntegrationTargetlistexportModal").subscribe((t=>{t.instance.model=this.model,t.instance.whereConditions=e}))}static#e=this.ɵfac=function(e){return new(e||ReporterIntegrationTargetlistexportButton)(c.rXU(b.B),c.rXU(v.yu),c.rXU(h.g),c.rXU(Le.y),c.rXU(p.c))};static#t=this.ɵcmp=c.VBU({type:ReporterIntegrationTargetlistexportButton,selectors:[["reporter-integration-targetlistexport-button"]],decls:5,vars:1,consts:[["role","presentation",1,"slds-dropdown__item",3,"click"],["href","javascript:void(0);","role","menuitem","tabindex","0"],["module","ProspectLists","size","x-small"],[1,"slds-truncate"],["module","ProspectLists",3,"singular"]],template:function(e,t){1&e&&(c.j41(0,"li",0),c.bIt("click",(function(){return t.showModal()})),c.j41(1,"a",1),c.nrm(2,"system-icon",2),c.j41(3,"span",3),c.nrm(4,"system-label-modulename",4),c.k0s()()()),2&e&&(c.R7$(4),c.Y8G("singular",!0))},dependencies:[G.J,x.r],encapsulation:2})}return ReporterIntegrationTargetlistexportButton})();var as=s(48717);let ds=(()=>{class ReporterIntegrationExportMask{constructor(e){this.language=e}static#e=this.ɵfac=function(e){return new(e||ReporterIntegrationExportMask)(c.rXU(b.B))};static#t=this.ɵcmp=c.VBU({type:ReporterIntegrationExportMask,selectors:[["ng-component"]],decls:4,vars:0,consts:[[1,"slds-modal","slds-fade-in-open","slds-align--absolute-center",2,"width","100%","height","100vh"],[1,"slds-box","slds-theme--default"],[1,"slds-backdrop","slds-backdrop--open"]],template:function(e,t){1&e&&(c.j41(0,"div",0)(1,"div",1),c.nrm(2,"system-spinner"),c.k0s()(),c.nrm(3,"div",2))},dependencies:[as.P],encapsulation:2})}return ReporterIntegrationExportMask})();var cs=s(66589),hs=s(13957);function ps(e,t){if(1&e){const e=c.RV6();c.j41(0,"div",3)(1,"label",14),c.nrm(2,"system-label",15),c.k0s(),c.j41(3,"div",16)(4,"input",17),c.mxI("ngModelChange",(function(t){c.eBV(e);const s=c.XpG();return c.DH7(s.targetlistname,t)||(s.targetlistname=t),c.Njj(t)})),c.k0s()()()}if(2&e){const e=c.XpG();c.R7$(4),c.R50("ngModel",e.targetlistname)}}function us(e,t){if(1&e){const e=c.RV6();c.j41(0,"div")(1,"label",14),c.nrm(2,"system-label",18),c.k0s(),c.j41(3,"div",19)(4,"table",20)(5,"tbody")(6,"tr")(7,"td")(8,"system-input-radio",21),c.mxI("ngModelChange",(function(t){c.eBV(e);const s=c.XpG();return c.DH7(s.targetlist_update_action,t)||(s.targetlist_update_action=t),c.Njj(t)})),c.nrm(9,"system-label",22),c.k0s()(),c.j41(10,"td"),c.nrm(11,"system-label",23),c.k0s()(),c.j41(12,"tr")(13,"td")(14,"system-input-radio",24),c.mxI("ngModelChange",(function(t){c.eBV(e);const s=c.XpG();return c.DH7(s.targetlist_update_action,t)||(s.targetlist_update_action=t),c.Njj(t)})),c.nrm(15,"system-label",25),c.k0s()(),c.j41(16,"td"),c.nrm(17,"system-label",26),c.k0s()(),c.j41(18,"tr")(19,"td")(20,"system-input-radio",27),c.mxI("ngModelChange",(function(t){c.eBV(e);const s=c.XpG();return c.DH7(s.targetlist_update_action,t)||(s.targetlist_update_action=t),c.Njj(t)})),c.nrm(21,"system-label",28),c.k0s()(),c.j41(22,"td"),c.nrm(23,"system-label",29),c.k0s()()()()(),c.j41(24,"label",14),c.nrm(25,"system-label",30),c.k0s(),c.j41(26,"div",16)(27,"system-input-relate",31),c.mxI("ngModelChange",(function(t){c.eBV(e);const s=c.XpG();return c.DH7(s.targetlist_update_id,t)||(s.targetlist_update_id=t),c.Njj(t)})),c.k0s()()()}if(2&e){const e=c.XpG();c.R7$(8),c.Y8G("name","targetlist_update_action"),c.R50("ngModel",e.targetlist_update_action),c.R7$(6),c.Y8G("name","targetlist_update_action"),c.R50("ngModel",e.targetlist_update_action),c.R7$(6),c.Y8G("name","targetlist_update_action"),c.R50("ngModel",e.targetlist_update_action),c.R7$(7),c.R50("ngModel",e.targetlist_update_id)}}let gs=(()=>{class ReporterIntegrationTargetlistexportModal{constructor(e,t,s,i,n,r){this.language=e,this.metadata=t,this.backend=s,this.modal=i,this.prospectListModel=n,this.toast=r,this.self={},this.model={},this.whereConditions={},this.targetlist_action="new",this.targetlistname="",this.targetlist_update_action="",this.targetlist_update_id=""}closeModal(){this.self.destroy()}exportTargetList(){this.modal.openModal("SystemLoadingModal").subscribe((e=>{e.instance.messagelabel="LBL_EXPORTING";let t={};switch(this.targetlist_action){case"new":t={targetlist_action:"new",targetlist_name:this.targetlistname,record:this.model.id,whereConditions:window.btoa(JSON.stringify(this.whereConditions))};break;case"update":t={targetlist_action:"update",targetlist_id:this.targetlist_update_id.split("::")[0],targetlist_update_action:this.targetlist_update_action,targetlist_update_action_now:!0,record:this.model.id,whereConditions:window.btoa(JSON.stringify(this.whereConditions))}}this.backend.postRequest("module/KReports/plugins/action/ktargetlistexport/export_to_targetlist",{},t).subscribe({next:t=>{this.toast.sendToast(this.language.getLabel("LBL_SUCCESS"),"success"),this.resetParameters(),e.instance.self.destroy(),this.closeModal()},error:t=>{this.toast.sendToast(this.language.getLabel("LBL_ERROR"),"error"),this.resetParameters(),e.instance.self.destroy(),this.closeModal()}})}))}canExport(){let e=!0;switch(this.targetlist_action){case"new":this.targetlistname.length<=0&&(e=!1);break;case"update":(this.targetlist_update_id.length<=0||this.targetlist_update_action.length<=0)&&(e=!1)}return!e}resetParameters(){this.targetlistname="",this.targetlist_update_id="",this.targetlist_update_action=""}static#e=this.ɵfac=function(e){return new(e||ReporterIntegrationTargetlistexportModal)(c.rXU(b.B),c.rXU(v.yu),c.rXU(R.H),c.rXU(Le.y),c.rXU(h.g),c.rXU(z.o))};static#t=this.ɵcmp=c.VBU({type:ReporterIntegrationTargetlistexportModal,selectors:[["reporter-integration-targetlistexport-modal"]],features:[c.Jv_([h.g])],decls:16,vars:7,consts:[["size","large"],[3,"close"],["label","LBL_EXPORT_TO_TARGETLIST_BUTTON_LABEL"],[1,"slds-form-element","slds-p-around--small"],["value","new",3,"name","ngModel","ngModelChange"],["label","LBL_NEW"],["value","update",3,"name","ngModel","ngModelChange"],["label","LBL_UPDATE"],["class","slds-form-element slds-p-around--small",4,"ngIf"],[4,"ngIf"],[1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_CANCEL"],[1,"slds-button","slds-button--brand",3,"disabled","click"],["label","LBL_EXPORT"],[1,"slds-form-element__label"],["label","LBL_TARGETLIST_NAME"],[1,"slds-form-element__control"],["type","text",1,"slds-input",3,"ngModel","ngModelChange"],["label","LBL_ACTION"],[1,"slds-grid","slds-grid--vertical"],[1,"slds-table","slds-table_bordered","slds-table_cell-buffer"],["value","rep",1,"slds-p-vertical--xx-small",3,"name","ngModel","ngModelChange"],["label","LBL_UPDATE_TARGET_LIST_WITH_REPORT"],["label","LBL_UPDATE_TARGET_LIST_WITH_REPORT","length","long"],["value","add",1,"slds-p-vertical--xx-small",3,"name","ngModel","ngModelChange"],["label","LBL_ADD_TARGET_LIST_WITH_REPORT"],["label","LBL_ADD_TARGET_LIST_WITH_REPORT","length","long"],["value","sub",1,"slds-p-vertical--xx-small",3,"name","ngModel","ngModelChange"],["label","LBL_SUB_TARGET_LIST_WITH_REPORT"],["label","LBL_SUB_TARGET_LIST_WITH_REPORT","length","long"],["label","LBL_PROSPECTLIST"],["module","ProspectLists",1,"slds-grow",2,"display","block","margin","0 -5px",3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(c.j41(0,"system-modal",0)(1,"system-modal-header",1),c.bIt("close",(function(){return t.closeModal()})),c.nrm(2,"system-label",2),c.k0s(),c.j41(3,"system-modal-content")(4,"div",3)(5,"system-input-radio",4),c.mxI("ngModelChange",(function(e){return c.DH7(t.targetlist_action,e)||(t.targetlist_action=e),e})),c.bIt("ngModelChange",(function(){return t.resetParameters()})),c.nrm(6,"system-label",5),c.k0s(),c.j41(7,"system-input-radio",6),c.mxI("ngModelChange",(function(e){return c.DH7(t.targetlist_action,e)||(t.targetlist_action=e),e})),c.bIt("ngModelChange",(function(){return t.resetParameters()})),c.nrm(8,"system-label",7),c.k0s()(),c.DNE(9,ps,5,1,"div",8)(10,us,28,7,"div",9),c.k0s(),c.j41(11,"system-modal-footer")(12,"button",10),c.bIt("click",(function(){return t.closeModal()})),c.nrm(13,"system-label",11),c.k0s(),c.j41(14,"button",12),c.bIt("click",(function(){return t.exportTargetList()})),c.nrm(15,"system-label",13),c.k0s()()()),2&e&&(c.R7$(5),c.Y8G("name","exportAction"),c.R50("ngModel",t.targetlist_action),c.R7$(2),c.Y8G("name","exportAction"),c.R50("ngModel",t.targetlist_action),c.R7$(2),c.Y8G("ngIf","new"==t.targetlist_action),c.R7$(),c.Y8G("ngIf","update"==t.targetlist_action),c.R7$(4),c.Y8G("disabled",t.canExport()))},dependencies:[i.bT,n.me,n.BC,n.vS,cs.J,hs.$,j.W,lt.D,at.I,dt.Q,ct.C],encapsulation:2})}return ReporterIntegrationTargetlistexportModal})();var ms=s(4921);function fs(e,t){if(1&e){const e=c.RV6();c.j41(0,"li",1)(1,"a",2),c.bIt("click",(function(){c.eBV(e);const t=c.XpG();return c.Njj(t.exportCSV())})),c.nrm(2,"system-icon",3),c.j41(3,"span",4),c.nrm(4,"system-label",5),c.k0s()()()}}let bs=(()=>{class ReporterIntegrationCSVexportButton{constructor(e,t,s,i,n,r,o,l){this.language=e,this.metadata=t,this.backend=s,this.model=i,this.modal=n,this.footer=r,this.reporterconfig=o,this.toast=l,this.loadUrl=void 0,this.fileName=void 0}get canExport(){return this.model.checkAccess("export")}exportCSV(){let e=[];for(let t of this.reporterconfig.userFilters)e.push({fieldid:t.fieldid,operator:t.operator,value:t.value,valuekey:t.valuekey,valueto:t.valueto,valuetokey:t.valuetokey});this.fileName=this.model.getField("name").replace(" ","_")+"_"+moment().format("YYYY_MM_DD_HH_mm_ss")+".csv";let t=this.modal.await(this.language.getLabel("LBL_LOADING"));this.backend.getDownloadPostRequestFile("module/KReports/plugins/action/kcsvexport/export",{record:this.model.id,dynamicoptions:JSON.stringify(e)}).subscribe({next:e=>{let s=document.createElement("a");document.body.appendChild(s),s.href=e,s.download=this.fileName,s.type="text/csv",s.click(),s.remove(),t.emit(!0)},error:e=>{t.emit(!0),this.toast.sendToast(this.language.getLabel("MSG_ERROR_LOADING_FILE"),"error")}})}static#e=this.ɵfac=function(e){return new(e||ReporterIntegrationCSVexportButton)(c.rXU(b.B),c.rXU(v.yu),c.rXU(R.H),c.rXU(h.g),c.rXU(Le.y),c.rXU(ms.q),c.rXU(p.c),c.rXU(z.o))};static#t=this.ɵcmp=c.VBU({type:ReporterIntegrationCSVexportButton,selectors:[["reporter-integration-csvexport-button"]],decls:1,vars:1,consts:[["class","slds-dropdown__item","role","presentation",4,"ngIf"],["role","presentation",1,"slds-dropdown__item"],["href","javascript:void(0);","role","menuitem","tabindex","0",3,"click"],["sprite","doctype","icon","csv","size","x-small"],[1,"slds-truncate"],["label","LBL_CSV_EXPORT"]],template:function(e,t){1&e&&c.DNE(0,fs,5,0,"li",0),2&e&&c.Y8G("ngIf",t.canExport)},dependencies:[i.bT,G.J,j.W],encapsulation:2})}return ReporterIntegrationCSVexportButton})(),vs=(()=>{class ReporterNewButton{constructor(e,t,s,i){this.language=e,this.metadata=t,this.model=s,this.router=i}execute(){this.hidden||this.router.navigate(["/module/KReports/designer/new"])}get hidden(){return!this.metadata.checkModuleAcl(this.model.module,"create")}static#e=this.ɵfac=function(e){return new(e||ReporterNewButton)(c.rXU(b.B),c.rXU(v.yu),c.rXU(h.g),c.rXU(y.Ix))};static#t=this.ɵcmp=c.VBU({type:ReporterNewButton,selectors:[["ng-component"]],decls:2,vars:0,consts:[["label","LBL_NEW"]],template:function(e,t){1&e&&(c.j41(0,"span"),c.nrm(1,"system-label",0),c.k0s())},dependencies:[j.W],encapsulation:2})}return ReporterNewButton})(),Rs=(()=>{class ReporterFieldCategoryTree{constructor(e,t,s){this.config=e,this.metadata=t,this.backend=s,this.record={},this.categoryNodes={}}get display_value(){return this.record[this.field.fieldid]?this.categoryNodes[this.record[this.field.fieldid]]?.node_name??this.record[this.field.fieldid]:""}ngOnInit(){let e=this.field.path.split("::"),t=e.length,s=e[t-1].split(":");this.fieldName=s[1];let i=e[t-2].split(":");switch(i[0]){case"root":this.moduleName=i[1];break;case"link":let e=this.metadata.getFieldDefs(i[1],i[2]);this.moduleName=e.module}const n=this.setCategoryField();if(!n)return;let r=this.config.getData("categories");this.setCategoryNodes(r[n]),r&&r[n]||(r||(r={}),r[n]=[],this.config.setData("categories",r),this.backend.getRequest(`configuration/spiceui/core/categorytrees/${n}/categorytreenodes`).subscribe((e=>{r[n]=e,this.setCategoryNodes(r[n]),this.config.setData("categories",r)})))}setCategoryField(){let e;const t=this.metadata.getModuleDefs(this.moduleName);return t?.categorytrees?(t.categorytrees.some((t=>{const s=Object.keys(t).find((e=>t[e]==this.fieldName));return!!s&&(e=t.syscategorytree_id,this.categoryField=s,!0)})),e):e}setCategoryNodes(e){if(!e||0==e.length)return;let t=2;const s={1:e.filter((e=>!e.parent_id))};if(this.categoryField.endsWith("1"))this.categoryNodes=window._.object(s[1].map((e=>e.node_key)),s[1]);else for(;t<=4;){if(s[t]=[],s[t-1].forEach((i=>{s[t]=s[t].concat(e.filter((e=>e.parent_id==i.id)))})),this.categoryField.endsWith(String(t))){this.categoryNodes=window._.object(s[t].map((e=>e.node_key)),s[t]);break}t++}}static#e=this.ɵfac=function(e){return new(e||ReporterFieldCategoryTree)(c.rXU(Ut.i),c.rXU(v.yu),c.rXU(R.H))};static#t=this.ɵcmp=c.VBU({type:ReporterFieldCategoryTree,selectors:[["reporter-field-category-tree"]],decls:3,vars:1,consts:[[1,"slds-truncate"],[3,"label"]],template:function(e,t){1&e&&(c.j41(0,"div",0)(1,"span"),c.nrm(2,"system-label",1),c.k0s()()),2&e&&(c.R7$(2),c.Y8G("label",t.display_value))},dependencies:[j.W],encapsulation:2,changeDetection:0})}return ReporterFieldCategoryTree})(),ys=(()=>{class ReporterFieldNumber{constructor(){this.record={},this.field={}}static#e=this.ɵfac=function(e){return new(e||ReporterFieldNumber)};static#t=this.ɵcmp=c.VBU({type:ReporterFieldNumber,selectors:[["ng-component"]],decls:2,vars:1,consts:[[1,"slds-text-align--center"],[3,"number"]],template:function(e,t){1&e&&(c.j41(0,"div",0),c.nrm(1,"system-display-number",1),c.k0s()),2&e&&(c.R7$(),c.Y8G("number",t.record[t.field.fieldid]))},dependencies:[zt.B],encapsulation:2})}return ReporterFieldNumber})(),_s=(()=>{class ReporterFieldInteger{constructor(){this.record={},this.field={}}static#e=this.ɵfac=function(e){return new(e||ReporterFieldInteger)};static#t=this.ɵcmp=c.VBU({type:ReporterFieldInteger,selectors:[["ng-component"]],decls:2,vars:1,consts:[[1,"slds-text-align--center"],["precision","0",3,"number"]],template:function(e,t){1&e&&(c.j41(0,"div",0),c.nrm(1,"system-display-number",1),c.k0s()),2&e&&(c.R7$(),c.Y8G("number",t.record[t.field.fieldid]))},dependencies:[zt.B],encapsulation:2})}return ReporterFieldInteger})(),ks=(()=>{class ModuleReports{static#e=this.ɵfac=function(e){return new(e||ModuleReports)};static#t=this.ɵmod=c.$C({type:ModuleReports});static#s=this.ɵinj=c.G2t({imports:[i.MD,n.YN,r.ObjectFields,o.ObjectComponents,l.SystemComponents,a.h,d.ad]})}return ModuleReports})();("undefined"==typeof ngJitMode||ngJitMode)&&c.Obh(ks,{declarations:[os,Ge,Y,E,xe,Ue,Re,W,he,J.s,K.U,Q.F,Z.R,Be.Q,je.T,Me.M,Ve.C,Xe.q,Ee.X,rt,gt,Fe,ft,vt,yt,Dt,wt,Vt,Bt,qe,Lt,Tt,Yt,At,qt,Ht,Wt,Jt,Rs,ys,_s,S,ds,ls,gs,bs,$,vs],imports:[i.MD,n.YN,r.ObjectFields,o.ObjectComponents,l.SystemComponents,a.h,d.ad],exports:[qe,K.U,J.s,Z.R,Be.Q,Xe.q,Ee.X,je.T,Q.F]})},11618:(e,t,s)=>{s.d(t,{c:()=>l});var i=s(21413),n=s(54438),r=s(53584),o=s(49722);let l=(()=>{class reporterconfig{constructor(e,t){this.configurationService=e,this.backend=t,this.userFilters=[],this.whereFunctions=[],this.defaultUserFilters="",this.operatorCount={},this.operatorTypes={},this.operatorAssignments={},this.isLoading={presentation:!1,visualization:!1},this.refresh$=new i.B;let s=this.configurationService.getData("reporterConfig");s?this.parseConfifg(s):this.backend.getRequest("module/KReports/core/whereoperators/all").subscribe((e=>{this.configurationService.setData("reporterConfig",e),this.parseConfifg(e)})),this.getWhereFunctions()}getWhereFunctions(){this.backend.getRequest("module/KReports/core/wherefunctions").subscribe((e=>{this.whereFunctions=e}))}parseConfifg(e){this.operatorCount=e.operatorCount,this.operatorTypes=e.operatorTypes,this.operatorAssignments=e.operatorAssignments}refresh(){this.refresh$.next(!0)}cancelRequests(){this.refresh$.next(!1)}resetUserFilters(){this.userFilters=[],this.defaultUserFilters="[]"}addUserFilter(e){this.userFilters.push(e),this.defaultUserFilters=JSON.stringify(this.userFilters)}setDefaultUserFilter(){this.userFilters=JSON.parse(this.defaultUserFilters),this.refresh()}setSavedFilter(e){for(let t of e)this.userFilters.some((e=>{if(e.fieldid==t.fieldid)return e.operator=t.operator,e.value=t.value,e.valuekey=t.valuekey,e.valueto=t.valueto,e.valuetokey=t.valuetokey,!0}));this.refresh()}static#e=this.ɵfac=function(e){return new(e||reporterconfig)(n.KVO(r.i),n.KVO(o.H))};static#t=this.ɵprov=n.jDH({token:reporterconfig,factory:reporterconfig.ɵfac})}return reporterconfig})()}}]);