/*!
 * 
 *                     aacService
 *
 *                     release: 2023.03.001
 *
 *                     date: 2024-01-09 16:51:03
 *
 *                     build: 2023.03.001.1704815463270
 *
 */
"use strict";(self.webpackChunkcore=self.webpackChunkcore||[]).push([["src_include_spicetexts_spicetexts_ts"],{5388:(e,t,s)=>{s.r(t),s.d(t,{SpiceTextsModule:()=>X});var l=s(66550),i=s(3144),a=s(95030),n=s(57239),d=s(34826),o=s(19784),r=s(53190),g=s(84357),c=s(66040),u=s(62242),p=s(55710),m=s(55329),h=s(14505),x=s(75920),f=s(4154),T=s(44755),b=s(83463),y=s(94664),v=s(78859),M=s(46438),Z=s(7763),F=s(44044),S=s(26625),J=s(93333);let A=(()=>{class SpiceTextsAddButton{model;modal;configurationService;language;metadata;relatedModels;parent;spiceTexts=[];constructor(e,t,s,l,i,a){this.model=e,this.modal=t,this.configurationService=s,this.language=l,this.metadata=i,this.relatedModels=a,this.model.module="SpiceTexts"}get sysTextIds(){let e=this.configurationService.getData("systextids");return e?_.values(e).filter((e=>e.module==this.parent.module)):[]}get canAdd(){return this.metadata.checkModuleAcl("SpiceTexts","create")&&!this.allTranslated}get allTranslated(){return this.relatedModels.isloading||0==this.sysTextIds.length||this.spiceTexts.length>=this.sysTextIds.length*this.language.getAvialableLanguages().length}addModel(){this.parent&&!this.allTranslated&&this.modal.openModal("SpiceTextsAddModal",!0).subscribe((e=>{e&&(e.instance.spiceTexts=this.spiceTexts,e.instance.sysTextIds=this.sysTextIds,e.instance.parent=this.parent,e.instance.response.subscribe((e=>{e&&"object"==typeof e&&this.relatedModels.items.push(e)})))}))}static ɵfac=function(e){return new(e||SpiceTextsAddButton)(u.Y36(p.o),u.Y36(F.o),u.Y36(S.C),u.Y36(m.d),u.Y36(f.Pu),u.Y36(c.j))};static ɵcmp=u.Xpm({type:SpiceTextsAddButton,selectors:[["spice-texts-add-button"]],inputs:{parent:"parent",spiceTexts:"spiceTexts"},features:[u._Bn([p.o])],decls:3,vars:2,consts:[["title","add item",1,"slds-button","slds-button--neutral",3,"disabled","click"],["label","LBL_ADD"],["module","SpiceTexts",3,"singular"]],template:function(e,t){1&e&&(u.TgZ(0,"button",0),u.NdJ("click",(function(){return t.addModel()})),u._UZ(1,"system-label",1)(2,"system-label-modulename",2),u.qZA()),2&e&&(u.Q6J("disabled",!t.canAdd),u.xp6(2),u.Q6J("singular",!0))},dependencies:[b._,J.M],encapsulation:2})}return SpiceTextsAddButton})();function L(e,t){if(1&e&&(u.TgZ(0,"option",19),u._uU(1),u.qZA()),2&e){const e=t.$implicit,s=u.oxw();u.Q6J("value",e.language),u.xp6(1),u.hij(" ",s.language.getLabel(null==e?null:e.text)," ")}}function k(e,t){1&e&&(u.TgZ(0,"div",20),u._UZ(1,"system-spinner"),u.qZA())}const B=function(e,t){return{module:"SpiceTexts",id:e,data:t}};function C(e,t){if(1&e&&(u.TgZ(0,"div",21)(1,"div",22),u._UZ(2,"object-record-details"),u.qZA()()),2&e){const e=t.$implicit;u.xp6(1),u.Q6J("system-model-provider",u.WLB(1,B,e.id,e))}}function Y(e,t){1&e&&(u.TgZ(0,"div",20),u._UZ(1,"system-label",23),u.qZA())}let Q=(()=>{class SpiceTexts{model;language;backend;session;metadata;relatedModels;searchTerm="";languageFilter="all";constructor(e,t,s,l,i,a){this.model=e,this.language=t,this.backend=s,this.session=l,this.metadata=i,this.relatedModels=a}get moduleTexts(){return this.relatedModels.items.filter((e=>{let t=e.name.toLowerCase(),s=e.description.toLowerCase(),l=this.searchTerm.toLowerCase(),i=0==this.searchTerm.length||t.includes(l)||s.includes(l),a=this.languageFilter==e.text_language;return i&&("all"==this.languageFilter||a)}))}get sysLanguages(){return this.language.getAvialableLanguages()}ngOnInit(){this.loadModuleTexts()}loadModuleTexts(){this.relatedModels.id=this.model.id,this.relatedModels.module=this.model.module,this.relatedModels.loaditems=-1,this.relatedModels.relatedModule="SpiceTexts",this.relatedModels.getData()}trackByFn(e,t){return t.id}static ɵfac=function(e){return new(e||SpiceTexts)(u.Y36(p.o),u.Y36(m.d),u.Y36(h.y),u.Y36(x.n),u.Y36(f.Pu),u.Y36(c.j))};static ɵcmp=u.Xpm({type:SpiceTexts,selectors:[["ng-component"]],features:[u._Bn([c.j])],decls:20,vars:11,consts:[[1,"slds-grid","slds-grid--vertical-align-center","slds-p-around--x-small"],["for","searchField",1,"slds-item_label"],["label","LBL_SEARCH"],[1,"slds-col","slds-form-element","slds-m-left--x-small"],[1,"slds-form-element__control","slds-input-has-icon","slds-input-has-icon_right"],["icon","search","addclasses","slds-input__icon slds-input__icon--right"],["id","searchField","type","text","placeholder","search by",1,"slds-input",3,"ngModel","ngModelChange"],["for","languageFilter",1,"slds-item_label","slds-m-left--small","slds-m-right--xx-small"],["label","LBL_FILTER"],[1,"slds-form-element","slds-m-right--small"],[1,"slds-form-element__control"],[1,"slds-select_container"],["id","languageFilter",1,"slds-select",3,"ngModel","disabled","ngModelChange"],["value","all"],["label","LBL_ALL"],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],[3,"parent","spiceTexts"],["class","slds-align--absolute-center slds-m-top--large",4,"ngIf"],["class","slds-m-vertical--small",4,"ngFor","ngForOf","ngForTrackBy"],[3,"value"],[1,"slds-align--absolute-center","slds-m-top--large"],[1,"slds-m-vertical--small"],[1,"slds-box--border",2,"padding","0 .50rem",3,"system-model-provider"],["label","MSG_NO_RECORDS_FOUND"]],template:function(e,t){1&e&&(u.TgZ(0,"div",0)(1,"label",1),u._UZ(2,"system-label",2),u.qZA(),u.TgZ(3,"div",3)(4,"div",4),u._UZ(5,"system-utility-icon",5),u.TgZ(6,"input",6),u.NdJ("ngModelChange",(function(e){return t.searchTerm=e})),u.qZA()()(),u.TgZ(7,"label",7),u._UZ(8,"system-label",8),u.qZA(),u.TgZ(9,"div",9)(10,"div",10)(11,"div",11)(12,"select",12),u.NdJ("ngModelChange",(function(e){return t.languageFilter=e})),u.TgZ(13,"option",13),u._UZ(14,"system-label",14),u.qZA(),u.YNc(15,L,2,2,"option",15),u.qZA()()()(),u._UZ(16,"spice-texts-add-button",16),u.qZA(),u.YNc(17,k,2,0,"div",17),u.YNc(18,C,3,4,"div",18),u.YNc(19,Y,2,0,"div",17)),2&e&&(u.xp6(6),u.Q6J("ngModel",t.searchTerm),u.xp6(6),u.Q6J("ngModel",t.languageFilter)("disabled",0==(null==t.sysLanguages?null:t.sysLanguages.length)),u.xp6(3),u.Q6J("ngForOf",t.sysLanguages)("ngForTrackBy",t.trackByFn),u.xp6(1),u.Q6J("parent",t.model)("spiceTexts",t.relatedModels.items),u.xp6(1),u.Q6J("ngIf",t.relatedModels.isloading),u.xp6(1),u.Q6J("ngForOf",t.moduleTexts)("ngForTrackBy",t.trackByFn),u.xp6(1),u.Q6J("ngIf",!t.relatedModels.isloading&&0==(null==t.relatedModels.items?null:t.relatedModels.items.length)))},dependencies:[T.sg,T.O5,a.YN,a.Kr,a.Fj,a.EJ,a.JJ,a.On,b._,y.W,v.r,M.F,Z.u,A],encapsulation:2})}return SpiceTexts})();var q=s(77579),U=s(32294),I=s(59621),N=s(83499),O=s(75767),w=s(1916),j=s(66367),D=s(33634),E=s(55638);function z(e,t){if(1&e&&(u.TgZ(0,"option",22),u._UZ(1,"system-label",23),u.qZA()),2&e){const e=t.$implicit;u.Q6J("value",e.text_id),u.xp6(1),u.Q6J("label",e.label)}}function R(e,t){1&e&&u._UZ(0,"system-spinner",24)}function $(e,t){if(1&e&&(u.TgZ(0,"option",22),u._uU(1),u.qZA()),2&e){const e=t.$implicit;u.Q6J("value",e.language),u.xp6(1),u.hij(" ",e.text," ")}}function G(e,t){1&e&&u._UZ(0,"system-spinner",24)}const P=function(){return{required:!0}};let W=(()=>{class SpiceTextsAddModal{model;configurationService;view;backend;language;spiceTexts=[];sysTextIds=[];parent={};response=new q.x;self={};saveTriggered=!1;loading="";constructor(e,t,s,l,i){this.model=e,this.configurationService=t,this.view=s,this.backend=l,this.language=i,this.model.module="SpiceTexts"}get textId(){return this.model.getField("text_id")}set textId(e){this.model.setField("text_id",e),this.model.resetFieldMessages("text_id","error","validation"),this.loading="text_language",window.setTimeout((()=>this.loading=""),500)}get textLanguage(){return this.model.getField("text_language")}set textLanguage(e){this.model.setField("text_language",e),this.model.resetFieldMessages("text_language","error","validation"),this.loading="text_id",window.setTimeout((()=>this.loading=""),500)}get availableSysLanguages(){return this.language.getAvialableLanguages().filter((e=>{let t=_.groupBy(this.spiceTexts,"text_id"),s=0;for(let l in t)if(t.hasOwnProperty(l)){s+=t[l].find((t=>t.text_language==e.language))?1:0}let l=this.spiceTexts.find((t=>t.text_id==this.textId&&t.text_language==e.language));return s<this.sysTextIds.length&&!l}))}get availableSysTexts(){return this.sysTextIds.filter((e=>{let t=this.spiceTexts.filter((t=>t.text_id==e.text_id)),s=this.spiceTexts.find((t=>t.text_id==e.text_id&&t.text_language==this.textLanguage));return t.length<this.language.getAvialableLanguages().length&&!s}))}get isDisabledText(){return!this.availableSysTexts||0==this.availableSysTexts.length||"text_id"==this.loading}get isDisabledLang(){return!this.availableSysLanguages||0==this.availableSysLanguages.length||"text_language"==this.loading}ngOnInit(){this.initializeModel(),this.view.isEditable=!0,this.view.setEditMode()}getFieldStyle(e){return this.model.getFieldMessages(e,"error")?"slds-has-error":""}initializeModel(){this.model.initialize(),this.model.setFields({parent_id:this.parent.id,parent_type:this.parent.module})}trackByFn(e,t){return t.id}isLoading(e){return this.loading==e}save(){if(this.saveTriggered=!0,!this.model.validate())return this.saveTriggered=!1;let e=this.model.getField("description").slice(0,100);this.model.setField("name",e),this.model.save(!0).subscribe((e=>{this.response.next(e),this.response.complete(),this.self.destroy()}),(e=>{this.cancel()})),this.saveTriggered=!1}cancel(){this.response.next(!1),this.response.complete(),this.self.destroy()}static ɵfac=function(e){return new(e||SpiceTextsAddModal)(u.Y36(p.o),u.Y36(S.C),u.Y36(U.e),u.Y36(h.y),u.Y36(m.d))};static ɵcmp=u.Xpm({type:SpiceTextsAddModal,selectors:[["ng-component"]],features:[u._Bn([p.o,U.e])],decls:29,vars:17,consts:[["size","large"],[3,"close"],["module","SpiceTexts",3,"singular"],[1,"slds-grid"],[1,"slds-size--1-of-2","slds-p-right--small"],["fieldname","text_id",3,"fieldconfig"],[1,"slds-form-element",3,"ngClass"],[1,"slds-form-element__control"],[1,"slds-select_container"],["id","text_id",1,"slds-select",3,"ngModel","disabled","ngModelChange"],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],["fieldname","text_id"],["class","slds-is-absolute","size","15","style","right: 25px; top: 8px",4,"ngIf"],[1,"slds-size--1-of-2"],["fieldname","text_language",3,"fieldconfig"],["id","text_language",1,"slds-select",3,"ngModel","disabled","ngModelChange"],["fieldname","text_language"],["field","description","fielddisplayclass","slds-truncate"],[1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_CANCEL"],[1,"slds-button","slds-button--brand",3,"click"],["label","LBL_SAVE"],[3,"value"],[3,"label"],["size","15",1,"slds-is-absolute",2,"right","25px","top","8px"]],template:function(e,t){1&e&&(u.TgZ(0,"system-modal",0)(1,"system-modal-header",1),u.NdJ("close",(function(){return t.cancel()})),u._UZ(2,"system-label-modulename",2),u.qZA(),u.TgZ(3,"system-modal-content")(4,"div",3)(5,"div",4),u._UZ(6,"field-label",5),u.TgZ(7,"div",6)(8,"div",7)(9,"div",8)(10,"select",9),u.NdJ("ngModelChange",(function(e){return t.textId=e})),u.YNc(11,z,2,2,"option",10),u.qZA()()(),u._UZ(12,"field-messages",11),u.YNc(13,R,1,0,"system-spinner",12),u.qZA()(),u.TgZ(14,"div",13),u._UZ(15,"field-label",14),u.TgZ(16,"div",6)(17,"div",7)(18,"div",8)(19,"select",15),u.NdJ("ngModelChange",(function(e){return t.textLanguage=e})),u.YNc(20,$,2,2,"option",10),u.qZA()()(),u._UZ(21,"field-messages",16),u.YNc(22,G,1,0,"system-spinner",12),u.qZA()()(),u._UZ(23,"field-container",17),u.qZA(),u.TgZ(24,"system-modal-footer")(25,"button",18),u.NdJ("click",(function(){return t.cancel()})),u._UZ(26,"system-label",19),u.qZA(),u.TgZ(27,"button",20),u.NdJ("click",(function(){return t.save()})),u._UZ(28,"system-label",21),u.qZA()()()),2&e&&(u.xp6(2),u.Q6J("singular",!0),u.xp6(4),u.Q6J("fieldconfig",u.DdM(15,P)),u.xp6(1),u.Q6J("ngClass",t.getFieldStyle("text_id")),u.xp6(3),u.Q6J("ngModel",t.textId)("disabled",t.isDisabledText),u.xp6(1),u.Q6J("ngForOf",t.availableSysTexts)("ngForTrackBy",t.trackByFn),u.xp6(2),u.Q6J("ngIf",t.isLoading("text_id")),u.xp6(2),u.Q6J("fieldconfig",u.DdM(16,P)),u.xp6(1),u.Q6J("ngClass",t.getFieldStyle("text_language")),u.xp6(3),u.Q6J("ngModel",t.textLanguage)("disabled",t.isDisabledLang),u.xp6(1),u.Q6J("ngForOf",t.availableSysLanguages)("ngForTrackBy",t.trackByFn),u.xp6(2),u.Q6J("ngIf",t.isLoading("text_language")))},dependencies:[T.mk,T.sg,T.O5,a.YN,a.Kr,a.EJ,a.JJ,a.On,b._,J.M,I.j,N.x,O.p,w.y,y.W,j.q,D.j,E.a],encapsulation:2})}return SpiceTextsAddModal})(),X=(()=>{class SpiceTextsModule{static ɵfac=function(e){return new(e||SpiceTextsModule)};static ɵmod=u.oAB({type:SpiceTextsModule});static ɵinj=u.cJS({imports:[l.b2,i.JF,a.u5,n.SystemComponents,d.GlobalComponents,o.ObjectComponents,r.ObjectFields,g.o]})}return SpiceTextsModule})();("undefined"==typeof ngJitMode||ngJitMode)&&u.kYT(X,{declarations:[Q,A,W],imports:[l.b2,i.JF,a.u5,n.SystemComponents,d.GlobalComponents,o.ObjectComponents,r.ObjectFields,g.o]})}}]);