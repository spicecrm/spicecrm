/*!
 * 
 *                     aacService
 *
 *                     release: 2023.02.001
 *
 *                     date: 2023-08-15 08:39:15
 *
 *                     build: 2023.02.001.1692081555935
 *
 */
"use strict";(self.webpackChunkcore=self.webpackChunkcore||[]).push([["src_include_spicetexts_spicetexts_ts"],{5388:(e,t,s)=>{s.r(t),s.d(t,{SpiceTextsModule:()=>K});var i=s(1180),l=s(6550),n=s(3144),a=s(5030),d=s(3735),o=s(4826),r=s(6490),g=s(3190),c=s(4357),u=s(6040),h=s(2242),p=s(5710),m=s(5329),x=s(4505),f=s(5920),T=s(4154),Z=s(4755),v=s(3463),b=s(4664),y=s(8859),M=s(6438),F=s(7763),S=s(4044),A=s(6625),J=s(3333);let L=(()=>{var e;class SpiceTextsAddButton{constructor(e,t,s,l,n,a){(0,i.Z)(this,"model",void 0),(0,i.Z)(this,"modal",void 0),(0,i.Z)(this,"configurationService",void 0),(0,i.Z)(this,"language",void 0),(0,i.Z)(this,"metadata",void 0),(0,i.Z)(this,"relatedModels",void 0),(0,i.Z)(this,"parent",void 0),(0,i.Z)(this,"spiceTexts",[]),this.model=e,this.modal=t,this.configurationService=s,this.language=l,this.metadata=n,this.relatedModels=a,this.model.module="SpiceTexts"}get sysTextIds(){let e=this.configurationService.getData("systextids");return e?_.values(e).filter((e=>e.module==this.parent.module)):[]}get canAdd(){return this.metadata.checkModuleAcl("SpiceTexts","create")&&!this.allTranslated}get allTranslated(){return this.relatedModels.isloading||0==this.sysTextIds.length||this.spiceTexts.length>=this.sysTextIds.length*this.language.getAvialableLanguages().length}addModel(){this.parent&&!this.allTranslated&&this.modal.openModal("SpiceTextsAddModal",!0).subscribe((e=>{e&&(e.instance.spiceTexts=this.spiceTexts,e.instance.sysTextIds=this.sysTextIds,e.instance.parent=this.parent,e.instance.response.subscribe((e=>{e&&"object"==typeof e&&this.relatedModels.items.push(e)})))}))}}return e=SpiceTextsAddButton,(0,i.Z)(SpiceTextsAddButton,"ɵfac",(function(t){return new(t||e)(h.Y36(p.o),h.Y36(S.o),h.Y36(A.C),h.Y36(m.d),h.Y36(T.Pu),h.Y36(u.j))})),(0,i.Z)(SpiceTextsAddButton,"ɵcmp",h.Xpm({type:e,selectors:[["spice-texts-add-button"]],inputs:{parent:"parent",spiceTexts:"spiceTexts"},features:[h._Bn([p.o])],decls:3,vars:2,consts:[["title","add item",1,"slds-button","slds-button--neutral",3,"disabled","click"],["label","LBL_ADD"],["module","SpiceTexts",3,"singular"]],template:function(e,t){1&e&&(h.TgZ(0,"button",0),h.NdJ("click",(function(){return t.addModel()})),h._UZ(1,"system-label",1)(2,"system-label-modulename",2),h.qZA()),2&e&&(h.Q6J("disabled",!t.canAdd),h.xp6(2),h.Q6J("singular",!0))},dependencies:[v._,J.M],encapsulation:2})),SpiceTextsAddButton})();function k(e,t){if(1&e&&(h.TgZ(0,"option",19),h._uU(1),h.qZA()),2&e){const e=t.$implicit,s=h.oxw();h.Q6J("value",e.language),h.xp6(1),h.hij(" ",s.language.getLabel(null==e?null:e.text)," ")}}function B(e,t){1&e&&(h.TgZ(0,"div",20),h._UZ(1,"system-spinner"),h.qZA())}const C=function(e,t){return{module:"SpiceTexts",id:e,data:t}};function Y(e,t){if(1&e&&(h.TgZ(0,"div",21)(1,"div",22),h._UZ(2,"object-record-details"),h.qZA()()),2&e){const e=t.$implicit;h.xp6(1),h.Q6J("system-model-provider",h.WLB(1,C,e.id,e))}}function Q(e,t){1&e&&(h.TgZ(0,"div",20),h._UZ(1,"system-label",23),h.qZA())}let q=(()=>{var e;class SpiceTexts{constructor(e,t,s,l,n,a){(0,i.Z)(this,"model",void 0),(0,i.Z)(this,"language",void 0),(0,i.Z)(this,"backend",void 0),(0,i.Z)(this,"session",void 0),(0,i.Z)(this,"metadata",void 0),(0,i.Z)(this,"relatedModels",void 0),(0,i.Z)(this,"searchTerm",""),(0,i.Z)(this,"languageFilter","all"),this.model=e,this.language=t,this.backend=s,this.session=l,this.metadata=n,this.relatedModels=a}get moduleTexts(){return this.relatedModels.items.filter((e=>{let t=e.name.toLowerCase(),s=e.description.toLowerCase(),i=this.searchTerm.toLowerCase(),l=0==this.searchTerm.length||t.includes(i)||s.includes(i),n=this.languageFilter==e.text_language;return l&&("all"==this.languageFilter||n)}))}get sysLanguages(){return this.language.getAvialableLanguages()}ngOnInit(){this.loadModuleTexts()}loadModuleTexts(){this.relatedModels.id=this.model.id,this.relatedModels.module=this.model.module,this.relatedModels.loaditems=-1,this.relatedModels.relatedModule="SpiceTexts",this.relatedModels.getData()}trackByFn(e,t){return t.id}}return e=SpiceTexts,(0,i.Z)(SpiceTexts,"ɵfac",(function(t){return new(t||e)(h.Y36(p.o),h.Y36(m.d),h.Y36(x.y),h.Y36(f.n),h.Y36(T.Pu),h.Y36(u.j))})),(0,i.Z)(SpiceTexts,"ɵcmp",h.Xpm({type:e,selectors:[["ng-component"]],features:[h._Bn([u.j])],decls:20,vars:11,consts:[[1,"slds-grid","slds-grid--vertical-align-center","slds-p-around--x-small"],["for","searchField",1,"slds-item_label"],["label","LBL_SEARCH"],[1,"slds-col","slds-form-element","slds-m-left--x-small"],[1,"slds-form-element__control","slds-input-has-icon","slds-input-has-icon_right"],["icon","search","addclasses","slds-input__icon slds-input__icon--right"],["id","searchField","type","text","placeholder","search by",1,"slds-input",3,"ngModel","ngModelChange"],["for","languageFilter",1,"slds-item_label","slds-m-left--small","slds-m-right--xx-small"],["label","LBL_FILTER"],[1,"slds-form-element","slds-m-right--small"],[1,"slds-form-element__control"],[1,"slds-select_container"],["id","languageFilter",1,"slds-select",3,"ngModel","disabled","ngModelChange"],["value","all"],["label","LBL_ALL"],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],[3,"parent","spiceTexts"],["class","slds-align--absolute-center slds-m-top--large",4,"ngIf"],["class","slds-m-vertical--small",4,"ngFor","ngForOf","ngForTrackBy"],[3,"value"],[1,"slds-align--absolute-center","slds-m-top--large"],[1,"slds-m-vertical--small"],[1,"slds-box--border",2,"padding","0 .50rem",3,"system-model-provider"],["label","MSG_NO_RECORDS_FOUND"]],template:function(e,t){1&e&&(h.TgZ(0,"div",0)(1,"label",1),h._UZ(2,"system-label",2),h.qZA(),h.TgZ(3,"div",3)(4,"div",4),h._UZ(5,"system-utility-icon",5),h.TgZ(6,"input",6),h.NdJ("ngModelChange",(function(e){return t.searchTerm=e})),h.qZA()()(),h.TgZ(7,"label",7),h._UZ(8,"system-label",8),h.qZA(),h.TgZ(9,"div",9)(10,"div",10)(11,"div",11)(12,"select",12),h.NdJ("ngModelChange",(function(e){return t.languageFilter=e})),h.TgZ(13,"option",13),h._UZ(14,"system-label",14),h.qZA(),h.YNc(15,k,2,2,"option",15),h.qZA()()()(),h._UZ(16,"spice-texts-add-button",16),h.qZA(),h.YNc(17,B,2,0,"div",17),h.YNc(18,Y,3,4,"div",18),h.YNc(19,Q,2,0,"div",17)),2&e&&(h.xp6(6),h.Q6J("ngModel",t.searchTerm),h.xp6(6),h.Q6J("ngModel",t.languageFilter)("disabled",0==(null==t.sysLanguages?null:t.sysLanguages.length)),h.xp6(3),h.Q6J("ngForOf",t.sysLanguages)("ngForTrackBy",t.trackByFn),h.xp6(1),h.Q6J("parent",t.model)("spiceTexts",t.relatedModels.items),h.xp6(1),h.Q6J("ngIf",t.relatedModels.isloading),h.xp6(1),h.Q6J("ngForOf",t.moduleTexts)("ngForTrackBy",t.trackByFn),h.xp6(1),h.Q6J("ngIf",!t.relatedModels.isloading&&0==(null==t.relatedModels.items?null:t.relatedModels.items.length)))},dependencies:[Z.sg,Z.O5,a.YN,a.Kr,a.Fj,a.EJ,a.JJ,a.On,v._,b.W,y.r,M.F,F.u,L],encapsulation:2})),SpiceTexts})();var U=s(7579),I=s(2294),N=s(9621),O=s(3499),w=s(5767),j=s(1916),D=s(6367),E=s(3634),z=s(5638);function R(e,t){if(1&e&&(h.TgZ(0,"option",22),h._UZ(1,"system-label",23),h.qZA()),2&e){const e=t.$implicit;h.Q6J("value",e.text_id),h.xp6(1),h.Q6J("label",e.label)}}function $(e,t){1&e&&h._UZ(0,"system-spinner",24)}function G(e,t){if(1&e&&(h.TgZ(0,"option",22),h._uU(1),h.qZA()),2&e){const e=t.$implicit;h.Q6J("value",e.language),h.xp6(1),h.hij(" ",e.text," ")}}function P(e,t){1&e&&h._UZ(0,"system-spinner",24)}const W=function(){return{required:!0}};let X=(()=>{var e;class SpiceTextsAddModal{constructor(e,t,s,l,n){(0,i.Z)(this,"model",void 0),(0,i.Z)(this,"configurationService",void 0),(0,i.Z)(this,"view",void 0),(0,i.Z)(this,"backend",void 0),(0,i.Z)(this,"language",void 0),(0,i.Z)(this,"spiceTexts",[]),(0,i.Z)(this,"sysTextIds",[]),(0,i.Z)(this,"parent",{}),(0,i.Z)(this,"response",new U.x),(0,i.Z)(this,"self",{}),(0,i.Z)(this,"saveTriggered",!1),(0,i.Z)(this,"loading",""),this.model=e,this.configurationService=t,this.view=s,this.backend=l,this.language=n,this.model.module="SpiceTexts"}get textId(){return this.model.getField("text_id")}set textId(e){this.model.setField("text_id",e),this.model.resetFieldMessages("text_id","error","validation"),this.loading="text_language",window.setTimeout((()=>this.loading=""),500)}get textLanguage(){return this.model.getField("text_language")}set textLanguage(e){this.model.setField("text_language",e),this.model.resetFieldMessages("text_language","error","validation"),this.loading="text_id",window.setTimeout((()=>this.loading=""),500)}get availableSysLanguages(){return this.language.getAvialableLanguages().filter((e=>{let t=_.groupBy(this.spiceTexts,"text_id"),s=0;for(let i in t)if(t.hasOwnProperty(i)){s+=t[i].find((t=>t.text_language==e.language))?1:0}let i=this.spiceTexts.find((t=>t.text_id==this.textId&&t.text_language==e.language));return s<this.sysTextIds.length&&!i}))}get availableSysTexts(){return this.sysTextIds.filter((e=>{let t=this.spiceTexts.filter((t=>t.text_id==e.text_id)),s=this.spiceTexts.find((t=>t.text_id==e.text_id&&t.text_language==this.textLanguage));return t.length<this.language.getAvialableLanguages().length&&!s}))}get isDisabledText(){return!this.availableSysTexts||0==this.availableSysTexts.length||"text_id"==this.loading}get isDisabledLang(){return!this.availableSysLanguages||0==this.availableSysLanguages.length||"text_language"==this.loading}ngOnInit(){this.initializeModel(),this.view.isEditable=!0,this.view.setEditMode()}getFieldStyle(e){return this.model.getFieldMessages(e,"error")?"slds-has-error":""}initializeModel(){this.model.initialize(),this.model.setFields({parent_id:this.parent.id,parent_type:this.parent.module})}trackByFn(e,t){return t.id}isLoading(e){return this.loading==e}save(){if(this.saveTriggered=!0,!this.model.validate())return this.saveTriggered=!1;let e=this.model.getField("description").slice(0,100);this.model.setField("name",e),this.model.save(!0).subscribe((e=>{this.response.next(e),this.response.complete(),this.self.destroy()}),(e=>{this.cancel()})),this.saveTriggered=!1}cancel(){this.response.next(!1),this.response.complete(),this.self.destroy()}}return e=SpiceTextsAddModal,(0,i.Z)(SpiceTextsAddModal,"ɵfac",(function(t){return new(t||e)(h.Y36(p.o),h.Y36(A.C),h.Y36(I.e),h.Y36(x.y),h.Y36(m.d))})),(0,i.Z)(SpiceTextsAddModal,"ɵcmp",h.Xpm({type:e,selectors:[["ng-component"]],features:[h._Bn([p.o,I.e])],decls:29,vars:17,consts:[["size","large"],[3,"close"],["module","SpiceTexts",3,"singular"],[1,"slds-grid"],[1,"slds-size--1-of-2","slds-p-right--small"],["fieldname","text_id",3,"fieldconfig"],[1,"slds-form-element",3,"ngClass"],[1,"slds-form-element__control"],[1,"slds-select_container"],["id","text_id",1,"slds-select",3,"ngModel","disabled","ngModelChange"],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],["fieldname","text_id"],["class","slds-is-absolute","size","15","style","right: 25px; top: 8px",4,"ngIf"],[1,"slds-size--1-of-2"],["fieldname","text_language",3,"fieldconfig"],["id","text_language",1,"slds-select",3,"ngModel","disabled","ngModelChange"],["fieldname","text_language"],["field","description","fielddisplayclass","slds-truncate"],[1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_CANCEL"],[1,"slds-button","slds-button--brand",3,"click"],["label","LBL_SAVE"],[3,"value"],[3,"label"],["size","15",1,"slds-is-absolute",2,"right","25px","top","8px"]],template:function(e,t){1&e&&(h.TgZ(0,"system-modal",0)(1,"system-modal-header",1),h.NdJ("close",(function(){return t.cancel()})),h._UZ(2,"system-label-modulename",2),h.qZA(),h.TgZ(3,"system-modal-content")(4,"div",3)(5,"div",4),h._UZ(6,"field-label",5),h.TgZ(7,"div",6)(8,"div",7)(9,"div",8)(10,"select",9),h.NdJ("ngModelChange",(function(e){return t.textId=e})),h.YNc(11,R,2,2,"option",10),h.qZA()()(),h._UZ(12,"field-messages",11),h.YNc(13,$,1,0,"system-spinner",12),h.qZA()(),h.TgZ(14,"div",13),h._UZ(15,"field-label",14),h.TgZ(16,"div",6)(17,"div",7)(18,"div",8)(19,"select",15),h.NdJ("ngModelChange",(function(e){return t.textLanguage=e})),h.YNc(20,G,2,2,"option",10),h.qZA()()(),h._UZ(21,"field-messages",16),h.YNc(22,P,1,0,"system-spinner",12),h.qZA()()(),h._UZ(23,"field-container",17),h.qZA(),h.TgZ(24,"system-modal-footer")(25,"button",18),h.NdJ("click",(function(){return t.cancel()})),h._UZ(26,"system-label",19),h.qZA(),h.TgZ(27,"button",20),h.NdJ("click",(function(){return t.save()})),h._UZ(28,"system-label",21),h.qZA()()()),2&e&&(h.xp6(2),h.Q6J("singular",!0),h.xp6(4),h.Q6J("fieldconfig",h.DdM(15,W)),h.xp6(1),h.Q6J("ngClass",t.getFieldStyle("text_id")),h.xp6(3),h.Q6J("ngModel",t.textId)("disabled",t.isDisabledText),h.xp6(1),h.Q6J("ngForOf",t.availableSysTexts)("ngForTrackBy",t.trackByFn),h.xp6(2),h.Q6J("ngIf",t.isLoading("text_id")),h.xp6(2),h.Q6J("fieldconfig",h.DdM(16,W)),h.xp6(1),h.Q6J("ngClass",t.getFieldStyle("text_language")),h.xp6(3),h.Q6J("ngModel",t.textLanguage)("disabled",t.isDisabledLang),h.xp6(1),h.Q6J("ngForOf",t.availableSysLanguages)("ngForTrackBy",t.trackByFn),h.xp6(2),h.Q6J("ngIf",t.isLoading("text_language")))},dependencies:[Z.mk,Z.sg,Z.O5,a.YN,a.Kr,a.EJ,a.JJ,a.On,v._,J.M,N.j,O.x,w.p,j.y,b.W,D.q,E.j,z.a],encapsulation:2})),SpiceTextsAddModal})(),K=(()=>{var e;class SpiceTextsModule{}return e=SpiceTextsModule,(0,i.Z)(SpiceTextsModule,"ɵfac",(function(t){return new(t||e)})),(0,i.Z)(SpiceTextsModule,"ɵmod",h.oAB({type:e})),(0,i.Z)(SpiceTextsModule,"ɵinj",h.cJS({imports:[l.b2,n.JF,a.u5,d.SystemComponents,o.GlobalComponents,r.ObjectComponents,g.ObjectFields,c.o]})),SpiceTextsModule})();("undefined"==typeof ngJitMode||ngJitMode)&&h.kYT(K,{declarations:[q,L,X],imports:[l.b2,n.JF,a.u5,d.SystemComponents,o.GlobalComponents,r.ObjectComponents,g.ObjectFields,c.o]})}}]);