/** 
 * © 2015 - 2021 aac services k.s. All rights reserved.
 * release: 2021.02.001
 * date: 2021-07-16 09:05:07
 * build: 2021.02.001.1626419107136
 **/
"use strict";var __extends=this&&this.__extends||function(){var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),__decorate=this&&this.__decorate||function(e,t,i,s){var a,o=arguments.length,l=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,i,s);else for(var n=e.length-1;0<=n;n--)(a=e[n])&&(l=(o<3?a(l):3<o?a(t,i,l):a(t,i))||l);return 3<o&&l&&Object.defineProperty(t,i,l),l},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param=this&&this.__param||function(i,s){return function(e,t){s(e,t,i)}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ModuleActivities=exports.fieldActivityDate=exports.ActivityTimelineSummaryAggregates=exports.ActivityTimelineSummaryButton=exports.ActivityTimelineSummaryItemView=exports.ActivityTimelineAggregates=exports.ActivityTimelineSummary=exports.ActivityTimelineAddEmail=exports.ActivityTimelineAddItem=exports.ActivityTimelineAddContainer=exports.ActivityTimelineStencil=exports.ActivityTimelineItem=exports.ActivityTimelineAddTabContainer=exports.ActivityTimelineItemContainer=exports.ActivityTimelineContainer=exports.ActivityTimelineFilter=exports.ActivityTimelineDropZoneWrapper=exports.ActivityTimelineTabbed=exports.ActivityTimeline=exports.fieldActivityCurrentUserParticipationStatus=exports.fieldActivityParticipationStatus=exports.ActivityParticipationStatus=exports.ActivityParticipationPanelParticipant=exports.ActivityParticipationPanelHeader=exports.fieldActivityParticipationPanel=exports.ActivityParticipationPanel=exports.fieldActivityReminder=exports.fieldActivitiesTaskWithCloseCheckbox=exports.fieldActivitiesAddActionsButton=exports.fieldActivitiesAddActions=exports.ActivitiesPopoverAddBarButton=exports.ActivitiesPopoverAddBar=exports.ActivityCloseCreateModal=exports.ActivityCloseModal=exports.ActionActivityCloseCreateButton=exports.ActionActivityCloseButton=exports.ActivityTimelineSaveButton=exports.TasksAssitantTileClose=exports.TasksManagerTaskDetails=exports.TasksManagerTask=exports.TasksManagerTasks=exports.TasksManagerView=void 0;var common_1=require("@angular/common"),core_1=require("@angular/core"),forms_1=require("@angular/forms"),objectfields_1=require("../../objectfields/objectfields"),globalcomponents_1=require("../../globalcomponents/globalcomponents"),objectcomponents_1=require("../../objectcomponents/objectcomponents"),systemcomponents_1=require("../../systemcomponents/systemcomponents"),directives_1=require("../../directives/directives"),services_1=require("../../services/services"),rxjs_1=require("rxjs"),router_1=require("@angular/router"),TasksManagerView=function(){function TasksManagerView(e,t,i,s,a){var o=this;this.broadcast=e,this.navigation=t,this.elementRef=i,this.model=s,this.modellist=a,this.modellistsubscribe={},this.focus=null,this.modellistsubscribe=this.modellist.listType$.subscribe(function(e){return o.handleListTypeChange(e)}),this.loadList()}return TasksManagerView.prototype.ngOnDestroy=function(){this.modellistsubscribe.unsubscribe()},TasksManagerView.prototype.handleListTypeChange=function(e){"TasksManagerView"==e.listcomponent&&this.loadList()},TasksManagerView.prototype.loadList=function(){this.focus=null,this.modellist.setSortField("date_due","ASC"),this.modellist.getListData()},TasksManagerView.prototype.taskSelected=function(e){this.focus=e},__decorate([core_1.Component({template:'<div class="slds-grid slds-height_full"><ng-container *ngIf="modellist.isLoading || modellist.listData.totalcount > 0; else noitems"><tasks-manager-tasks class="slds-size--1-of-2" (taskselected)="taskSelected($event)"></tasks-manager-tasks><tasks-manager-task-details class="slds-size--1-of-2" [focusid]="focus"></tasks-manager-task-details></ng-container><ng-template #noitems><div class="slds-height_full slds-align--absolute-center"><system-illustration-no-task></system-illustration-no-task></div></ng-template></div>'}),__metadata("design:paramtypes",[services_1.broadcast,services_1.navigation,core_1.ElementRef,services_1.model,services_1.modellist])],TasksManagerView)}();exports.TasksManagerView=TasksManagerView;var TasksManagerTasks=function(){function e(e,t){this.language=e,this.modellist=t,this.taskselected=new core_1.EventEmitter,this.focus=""}return e.prototype.selectTask=function(e){this.focus=e,this.taskselected.emit(e)},e.prototype.handleScroll=function(){this.modellist.loadMoreList()},__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],e.prototype,"taskselected",void 0),__decorate([core_1.Component({selector:"tasks-manager-tasks",template:'<div (system-to-bottom)="handleScroll()"><tasks-manager-task *ngFor="let task of modellist.listData.list" [task]="task" [focus]="focus" (taskselected)="selectTask($event)" [ngClass]="{\'slds-theme_shade\': focus == task.id }"></tasks-manager-task><div *ngIf="modellist.isLoading" class="slds-p-around--medium slds-align--absolute-center"><system-spinner></system-spinner></div></div>'}),__metadata("design:paramtypes",[services_1.language,services_1.modellist])],e)}();exports.TasksManagerTasks=TasksManagerTasks;var TasksManagerTask=function(){function e(e,t,i,s,a){this.language=e,this.metadata=t,this.model=i,this.modelutilities=s,this.view=a,this.task={},this.focus="",this.taskselected=new core_1.EventEmitter,this.fielsetFields=[];a=this.metadata.getComponentConfig("TasksManagerTask","Tasks");a.fieldset&&(this.fielsetFields=this.metadata.getFieldSetItems(a.fieldset)),this.view.displayLabels=!1}return e.prototype.ngOnInit=function(){this.model.module="Tasks",this.model.id=this.task.id,this.model.data=this.modelutilities.backendModel2spice("Tasks",this.task)},Object.defineProperty(e.prototype,"isCompleted",{get:function(){return"Completed"==this.model.data.status},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canEdit",{get:function(){return this.model.checkAccess("edit")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nameStyle",{get:function(){var e={};return this.isCompleted&&(e["text-decoration"]="line-through"),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"focusClass",{get:function(){return this.model.id==this.focus?"slds-theme--shade slds-border--right":""},enumerable:!1,configurable:!0}),e.prototype.completeTask=function(){this.model.data.status="Completed",this.model.save()},e.prototype.selectTask=function(){this.taskselected.emit(this.model.id)},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"task",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"focus",void 0),__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],e.prototype,"taskselected",void 0),__decorate([core_1.Component({selector:"tasks-manager-task",template:'<div class="slds-p-horizontal--medium slds-p-vertical--medium slds-border--bottom" [ngClass]="focusClass"><div class="slds-grid slds-grid--align-spread" (click)="selectTask()" style="cursor: pointer;"><div class="slds-grid"><div class="slds-form-element"><span class="slds-checkbox"><input type="checkbox" [disabled]="isCompleted || !canEdit" [checked]="isCompleted" [id]="model.id" (click)="completeTask()"> <label class="slds-checkbox__label" [attr.for]="model.id"><span class="slds-checkbox_faux"></span></label></span></div><div><div class="slds-text-title_caps" [ngStyle]="nameStyle">{{model.data.name}}</div><div class="slds-grid"><ng-container *ngFor="let field of fielsetFields; let i = index;"><ng-container *ngIf="model.data[field.field]"><field-container [field]="field.field" [fieldconfig]="field.fieldconfig" [fielddisplayclass]="\'slds-truncate\'"></field-container><span *ngIf="i < fielsetFields.length - 1">&nbsp;•&nbsp;</span></ng-container></ng-container></div></div></div><div><field-container [field]="\'date_due\'" [fieldconfig]="{highlightpast: true}" [fielddisplayclass]="\'slds-truncate\'"></field-container></div></div></div>',providers:[services_1.model,services_1.view]}),__metadata("design:paramtypes",[services_1.language,services_1.metadata,services_1.model,services_1.modelutilities,services_1.view])],e)}();exports.TasksManagerTask=TasksManagerTask;var TasksManagerTaskDetails=function(){function e(e,t,i,s,a,o){var l=this;this.view=e,this.language=t,this.elementRef=i,this.metadata=s,this.model=a,this.broadcast=o,this.focusid="",this.viewComponent=null,this.modelSubscription=null,this.model.module="Tasks",this.modelSubscription=this.broadcast.message$.subscribe(function(e){l.handleMessage(e)}),this.view.displayLabels=!1}return e.prototype.handleMessage=function(e){if(e.messagedata.module===this.model.module)switch(e.messagetype){case"model.delete":break;case"model.save":this.model.id===e.messagedata.id&&(this.model.data=e.messagedata.data)}},e.prototype.ngOnChanges=function(){var t=this;this.focusid?this.viewComponent||this.metadata.addComponent("ObjectRecordDetails",this.detailscontent).subscribe(function(e){t.viewComponent=e}):this.viewComponent&&(this.viewComponent.destroy(),this.viewComponent=null),this.focusid&&this.focusid!=this.model.id&&(this.model.id=this.focusid,this.model.getData())},e.prototype.ngOnDestroy=function(){this.modelSubscription.unsubscribe()},Object.defineProperty(e.prototype,"nameStyle",{get:function(){var e={};return this.isCompleted&&(e["text-decoration"]="line-through"),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCompleted",{get:function(){return"Completed"==this.model.data.status},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canEdit",{get:function(){try{return this.model.checkAccess("edit")}catch(e){return!1}},enumerable:!1,configurable:!0}),e.prototype.completeTask=function(){this.model.data.status="Completed",this.model.save()},__decorate([core_1.ViewChild("detailscontent",{read:core_1.ViewContainerRef,static:!0}),__metadata("design:type",core_1.ViewContainerRef)],e.prototype,"detailscontent",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"focusid",void 0),__decorate([core_1.Component({selector:"tasks-manager-task-details",template:'<div class="slds-scrollable--y"><div *ngIf="focusid" class="slds-m-around--x-small slds-p-around--x-small slds-grid slds-grid_vertical-align-center"><div class="slds-form-element__control"><span class="slds-checkbox"><input type="checkbox" id="closetask" [disabled]="isCompleted || !canEdit" [checked]="isCompleted" (click)="completeTask()"> <label class="slds-checkbox__label" for="closetask"><span class="slds-checkbox_faux"></span></label></span></div><div class="slds-text-heading--small slds-p-left--small"><field-container [field]="\'name\'" [fielddisplayclass]="\'slds-text-heading--small\'"></field-container></div></div><div class="slds-m-around--x-small slds-p-around--x-small" [ngClass]="{\'slds-theme--default\' : focusid}"><div #detailscontent></div></div><div *ngIf="!focusid" class="slds-align--absolute-center" style="height:100%"><system-label label="LBL_MAKE_SELECTION"></system-label></div></div>',host:{class:"slds-theme--shade"},providers:[services_1.model,services_1.view]}),__metadata("design:paramtypes",[services_1.view,services_1.language,core_1.ElementRef,services_1.metadata,services_1.model,services_1.broadcast])],e)}();exports.TasksManagerTaskDetails=TasksManagerTaskDetails;var TasksAssitantTileClose=function(){function TasksAssitantTileClose(e,t,i,s){this.model=e,this.language=t,this.helper=i,this.broadcast=s}return TasksAssitantTileClose.prototype.doAction=function(){var t=this;this.helper.confirm(this.language.getLabel("LBL_COMPLETE_TASK"),this.language.getLabel("MSG_COMPLETE_TASK")).subscribe(function(e){e&&(t.model.data.status="Completed",t.model.save(),t.broadcast.broadcastMessage("assistant.complete",{id:t.model.id,module:"Assistant",data:t.model.data}))})},__decorate([core_1.Component({selector:"tasks-assistant-tile-close",template:'<li class="slds-dropdown__item" role="presentation" (click)="doAction()"><a href="javascript:void(0);" role="menuitem"><span class="slds-truncate"><system-label label="LBL_CLOSE"></system-label></span></a></li>'}),__metadata("design:paramtypes",[services_1.model,services_1.language,services_1.helper,services_1.broadcast])],TasksAssitantTileClose)}();exports.TasksAssitantTileClose=TasksAssitantTileClose;var ActivityTimelineSaveButton=function(){function ActivityTimelineSaveButton(e,t,i,s){this.language=e,this.metadata=t,this.model=i,this.view=s,this.actionconfig={},this.actionemitter=new core_1.EventEmitter,this.parent={},this.module="",this.saving=!1}return Object.defineProperty(ActivityTimelineSaveButton.prototype,"buttonLabel",{get:function(){return this.actionconfig.label||"LBL_SAVE"},enumerable:!1,configurable:!0}),ActivityTimelineSaveButton.prototype.execute=function(){var t=this;this.saving||this.model.validate()&&(this.saving=!0,this.model.save(!0).subscribe(function(e){t.actionemitter.emit("save"),t.model.endEdit()}))},__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],ActivityTimelineSaveButton.prototype,"actionemitter",void 0),__decorate([core_1.Component({selector:"activity-timeline-save-button",template:'<span><system-label [label]="buttonLabel"></system-label></span>'}),__metadata("design:paramtypes",[services_1.language,services_1.metadata,services_1.model,services_1.view])],ActivityTimelineSaveButton)}();exports.ActivityTimelineSaveButton=ActivityTimelineSaveButton;var ActionActivityCloseButton=function(){function ActionActivityCloseButton(e,t,i,s,a){this.language=e,this.metadata=t,this.model=i,this.modal=s,this.viewContainerRef=a,this.hidden=!1,this.displayasicon=!1,this.disabled=!0,this.subscriptions=new rxjs_1.Subscription}return ActionActivityCloseButton.prototype.ngOnInit=function(){var t=this;this.componentconfig=this.metadata.getComponentConfig("ActionActivityCloseButton",this.model.module),this.model.data[this.componentconfig.statusField]==this.componentconfig.statusValues&&this.handleDisabled("display"),this.handleDisabled(this.model.isEditing?"edit":"display"),this.subscriptions.add(this.model.mode$.subscribe(function(e){t.handleDisabled(e)})),this.subscriptions.add(this.model.data$.subscribe(function(e){t.handleDisabled(t.model.isEditing?"edit":"display")}))},ActionActivityCloseButton.prototype.ngOnDestroy=function(){this.subscriptions.unsubscribe()},ActionActivityCloseButton.prototype.execute=function(){var t=this,i=this.componentconfig.componentset,s=this.componentconfig.actionset;this.modal.openModal("ActivityCloseModal",!0,this.viewContainerRef.injector).subscribe(function(e){e&&(i&&""!=i&&(e.instance.componentSet=i),s&&""!=s&&(e.instance.actionSet=s),t.model.startEdit())})},ActionActivityCloseButton.prototype.handleDisabled=function(e){!this.model.data.acl||this.model.checkAccess("edit")?this.disabled="edit"==e:this.disabled=!0},__decorate([core_1.Component({selector:"action-activity-close-button",template:'<system-button-icon *ngIf="displayasicon" icon="close"></system-button-icon><span *ngIf="!displayasicon"><system-label label="LBL_CLOSE"></system-label></span>'}),__metadata("design:paramtypes",[services_1.language,services_1.metadata,services_1.model,services_1.modal,core_1.ViewContainerRef])],ActionActivityCloseButton)}();exports.ActionActivityCloseButton=ActionActivityCloseButton;var ActionActivityCloseCreateButton=function(){function ActionActivityCloseCreateButton(e,t,i,s,a,o){this.language=e,this.metadata=t,this.model=i,this.modal=s,this.injector=a,this.modalwindow=o,this.saving=!1,this.canCreate=!1}return ActionActivityCloseCreateButton.prototype.ngOnInit=function(){var e=this.metadata.getComponentConfig("ActivityCloseCreateModal",this.model.module).newBeanModules;if(e)for(var t=0,i=e.split(",");t<i.length;t++){var s=i[t];if(this.metadata.checkModuleAcl(s,"create")){this.canCreate=!0;break}}},Object.defineProperty(ActionActivityCloseCreateButton.prototype,"disabled",{get:function(){return!this.model.checkAccess("edit")},enumerable:!1,configurable:!0}),ActionActivityCloseCreateButton.prototype.execute=function(){var i=this;this.saving||(this.actionconfig.statusfield&&this.actionconfig.statusvalue&&this.model.getField(this.actionconfig.statusfield)!=this.actionconfig.statusvalue&&(this.model.isEditing||this.model.startEdit(),this.model.setField(this.actionconfig.statusfield,this.actionconfig.statusvalue)),this.model.validate()?(this.saving=!0,this.modal.openModal("SystemLoadingModal").subscribe(function(t){t.instance.messagelabel="LBL_SAVING_DATA",i.model.save().subscribe(function(e){i.saving=!1,t.instance.self.destroy(),i.modalwindow&&i.modalwindow.self.destroy(),i.modal.openModal("ActivityCloseCreateModal",!0,i.injector).subscribe(function(e){e&&(e.instance.parent=i.model)})})})):this.modalwindow||this.model.edit(!1))},Object.defineProperty(ActionActivityCloseCreateButton.prototype,"actionlabel",{get:function(){return this.model.getField(this.actionconfig.statusfield)!=this.actionconfig.statusvalue&&this.model.getField(this.actionconfig.statusfield)!=this.actionconfig.statusvalue?"LBL_CLOSE_AND_NEW":this.model.isEditing?"LBL_SAVE_AND_NEW":"LBL_NEW"},enumerable:!1,configurable:!0}),__decorate([core_1.Component({selector:"action-activity-close-create-button",template:'<span><system-label [label]="actionlabel"></system-label></span>'}),__param(5,core_1.Optional()),__metadata("design:paramtypes",[services_1.language,services_1.metadata,services_1.model,services_1.modal,core_1.Injector,services_1.modalwindow])],ActionActivityCloseCreateButton)}();exports.ActionActivityCloseCreateButton=ActionActivityCloseCreateButton;var ActivityCloseModal=function(){function ActivityCloseModal(e,t,i,s,a,o,l){this.router=e,this.language=t,this.model=i,this.view=s,this.metadata=a,this.modal=o,this.toast=l,this.componentconfig={},this.actionSetItems=[],this.newValueFields=[],this.actionSubject=new rxjs_1.Subject,this.action$=new rxjs_1.Observable,this.preventGoingToRecord=!1,this.self={},this.view.isEditable=!0,this.view.setEditMode(),this.action$=this.actionSubject.asObservable()}return ActivityCloseModal.prototype.ngOnInit=function(){this.componentconfig=this.metadata.getComponentConfig(this.constructor.name,this.model.module),this.actionSetItems=this.metadata.getActionSetItems(this.componentconfig.actionset),this.newValueFields=this.componentconfig.newValueFields,this.setNewValues()},ActivityCloseModal.prototype.emitaction=function(e){e&&this.toast.sendToast(this.language.getLabel("LBL_DATA_SAVED")+".","success"),this.self.destroy()},ActivityCloseModal.prototype.closeModal=function(){this.model.cancelEdit(),this.actionSubject.next(!1),this.actionSubject.complete(),this.self.destroy()},ActivityCloseModal.prototype.setNewValues=function(){this.newValueFields=JSON.parse(this.newValueFields);for(var e=0,t=this.newValueFields;e<t.length;e++){var i=t[e];this.model.setField(i.name,i.value)}},__decorate([core_1.ViewChild("modalContent",{read:core_1.ViewContainerRef,static:!0}),__metadata("design:type",core_1.ViewContainerRef)],ActivityCloseModal.prototype,"modalContent",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],ActivityCloseModal.prototype,"preventGoingToRecord",void 0),__decorate([core_1.Component({template:'<system-modal size="large"><system-modal-header (close)="closeModal()"><system-label label="LBL_CLOSE"></system-label></system-modal-header><system-modal-content margin="none" #modalContent><div class="slds-grid"><div class="slds-grid--vertical slds-grow"><object-edit-modal-dialog-container [module]="model.module" [componentSet]="componentSet"></object-edit-modal-dialog-container></div></div></system-modal-content><system-modal-footer><div class="slds-grid slds-grid--vertical-align-center slds-grid--align-spread"><div class="slds-col"></div><div class="slds-col"><object-action-container [actionset]="actionSet" (actionemitter)="emitaction($event)"></object-action-container></div></div></system-modal-footer></system-modal>',providers:[services_1.view]}),__metadata("design:paramtypes",[router_1.Router,services_1.language,services_1.model,services_1.view,services_1.metadata,services_1.modal,services_1.toast])],ActivityCloseModal)}();exports.ActivityCloseModal=ActivityCloseModal;var ActivityCloseCreateModal=function(){function ActivityCloseCreateModal(e,t,i){this.language=e,this.model=t,this.metadata=i,this.componentconfig={},this.newBeanModules=[],this.parent={},this.self={},this.value=""}return ActivityCloseCreateModal.prototype.ngOnInit=function(){this.componentconfig=this.metadata.getComponentConfig(this.constructor.name,this.parent.module);var e=this.componentconfig.newBeanModules;if(e)for(var t=0,i=e.split(",");t<i.length;t++){var s=i[t];this.metadata.checkModuleAcl(s,"create")&&this.newBeanModules.push(this.metadata.getModuleDefs(s))}},ActivityCloseCreateModal.prototype.closeModal=function(){this.self.destroy()},ActivityCloseCreateModal.prototype.create=function(){this.model.module=this.value,this.model.addModel("",this.parent),this.self.destroy()},__decorate([core_1.Input(),__metadata("design:type",Object)],ActivityCloseCreateModal.prototype,"parent",void 0),__decorate([core_1.Component({template:'<system-modal size="x-small"><system-modal-header (close)="closeModal()"><system-label label="LBL_CREATE"></system-label></system-modal-header><system-modal-content margin="none"><div class="slds-m-left_x-small slds-m-vertical_large"><div class="slds-form-element"><div class="slds-form-element__control"><system-input-radio *ngFor="let o of newBeanModules" name="module" [value]="o.module" [(ngModel)]="value">{{language.getLabel(o.singular_label)}}</system-input-radio></div></div></div></system-modal-content><system-modal-footer><button class="slds-button slds-button--neutral" (click)="closeModal()"><system-label label="LBL_CANCEL"></system-label></button> <button class="slds-button slds-button--brand" (click)="create()"><system-label label="LBL_CREATE"></system-label></button></system-modal-footer></system-modal>',providers:[services_1.model]}),__metadata("design:paramtypes",[services_1.language,services_1.model,services_1.metadata])],ActivityCloseCreateModal)}();exports.ActivityCloseCreateModal=ActivityCloseCreateModal;var ActivitiesPopoverAddBar=function(){function ActivitiesPopoverAddBar(e,t,i){this.model=e,this.language=t,this.metadata=i,this.modules=[]}return ActivitiesPopoverAddBar.prototype.ngOnInit=function(){if(this.componentconfig.modules)for(var e=0,t=this.componentconfig.modules.split(",");e<t.length;e++){var i=t[e];this.metadata.checkModuleAcl(i,"create")&&this.modules.push(i)}},__decorate([core_1.Component({template:'<div *ngIf="modules.length > 0" class="slds-grid slds-p-vertical--x-small"><div *ngFor="let module of modules" class="slds-p-horizontal--xx-small"><activities-popover-addbar-button [module]="module" [parent]="model"></activities-popover-addbar-button></div></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.language,services_1.metadata])],ActivitiesPopoverAddBar)}();exports.ActivitiesPopoverAddBar=ActivitiesPopoverAddBar;var ActivitiesPopoverAddBarButton=function(){function e(e,t,i,s){this.model=e,this.language=t,this.metadata=i,this.relatedmodels=s,this.module=""}return e.prototype.addModel=function(){this.model.module=this.module;var e=[this.parent];this.relatedmodels&&this.relatedmodels.model&&e.push(this.relatedmodels.model),this.model.addModel("",e)},__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"module",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"parent",void 0),__decorate([core_1.Component({selector:"activities-popover-addbar-button",template:'<button class="slds-button slds-button_icon slds-button_icon-border" [title]="this.language.getModuleCombinedLabel(\'LBL_ADD\', module)" (click)="addModel()"><system-button-icon [module]="module" size="large"></system-button-icon></button>',providers:[services_1.model]}),__param(3,core_1.Optional()),__metadata("design:paramtypes",[services_1.model,services_1.language,services_1.metadata,services_1.relatedmodels])],e)}();exports.ActivitiesPopoverAddBarButton=ActivitiesPopoverAddBarButton;var fieldActivitiesAddActions=function(){function fieldActivitiesAddActions(e,t,i){this.model=e,this.language=t,this.metadata=i,this.fieldconfig={},this.modules=[]}return fieldActivitiesAddActions.prototype.ngOnInit=function(){if(this.fieldconfig.modules)for(var e=0,t=this.fieldconfig.modules.split(",");e<t.length;e++){var i=t[e];this.metadata.checkModuleAcl(i,"create")&&this.modules.push(i)}},__decorate([core_1.Input(),__metadata("design:type",Object)],fieldActivitiesAddActions.prototype,"fieldconfig",void 0),__decorate([core_1.Component({template:'<div *ngIf="modules.length > 0" class="slds-button-group" role="group"><button field-activities-addactions-button style="height: 24px; width:24px;" *ngFor="let module of modules" class="slds-button slds-button_icon slds-button_icon-border" [title]="this.language.getModuleCombinedLabel(\'LBL_ADD\', module)" [module]="module" [parent]="model"></button></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.language,services_1.metadata])],fieldActivitiesAddActions)}();exports.fieldActivitiesAddActions=fieldActivitiesAddActions;var fieldActivitiesAddActionsButton=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),__decorate([core_1.Component({selector:"[field-activities-addactions-button]",template:'<system-button-icon [module]="module" size="large"></system-button-icon>',providers:[services_1.model],host:{"(click)":"addModel()"}})],t)}(ActivitiesPopoverAddBarButton);exports.fieldActivitiesAddActionsButton=fieldActivitiesAddActionsButton;var fieldActivitiesTaskWithCloseCheckbox=function(l){function fieldActivitiesTaskWithCloseCheckbox(e,t,i,s,a){var o=l.call(this,e,t,i,s,a)||this;return o.model=e,o.view=t,o.language=i,o.metadata=s,o.router=a,o}return __extends(fieldActivitiesTaskWithCloseCheckbox,l),Object.defineProperty(fieldActivitiesTaskWithCloseCheckbox.prototype,"canComplete",{get:function(){return"Completed"!==this.model.data.status&&"Deferred"!==this.model.data.status||!this.model.checkAccess("edit")},enumerable:!1,configurable:!0}),Object.defineProperty(fieldActivitiesTaskWithCloseCheckbox.prototype,"completed",{get:function(){return"Completed"==this.model.getField("status")},set:function(e){e&&this.canComplete&&(this.model.startEdit(),this.model.setField("status","Completed"),this.model.save())},enumerable:!1,configurable:!0}),__decorate([core_1.Component({template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig" [fieldid]="fieldid"><div class="slds-grid slds-grid_vertical-align-center"><system-checkbox *ngIf="canComplete" [(ngModel)]="completed"></system-checkbox><div system-model-popover>{{value}}</div></div></field-generic-display>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],fieldActivitiesTaskWithCloseCheckbox)}(objectfields_1.fieldGeneric);exports.fieldActivitiesTaskWithCloseCheckbox=fieldActivitiesTaskWithCloseCheckbox;var fieldActivityReminder=function(m){function fieldActivityReminder(e,t,i,s,a,o,l,n,d,r){var c=m.call(this,e,t,s,a,o)||this;return c.model=e,c.view=t,c.broadcast=i,c.language=s,c.metadata=a,c.router=o,c.elementRef=l,c.renderer=n,c.modal=d,c.userpreferences=r,c.options=[{value:"-1",label:"LBL_REMINDER_NONE"},{value:"60",label:"LBL_REMINDER_1MINUTE"},{value:"300",label:"LBL_REMINDER_5MINUTES"},{value:"600",label:"LBL_REMINDER_10MINUTES"},{value:"900",label:"LBL_REMINDER_15MINUTES"},{value:"1800",label:"LBL_REMINDER_30MINUTES"},{value:"3600",label:"LBL_REMINDER_1HOUR"},{value:"7200",label:"LBL_REMINDER_2HOURS"},{value:"10800",label:"LBL_REMINDER_3HOURS"},{value:"18000",label:"LBL_REMINDER_5HOURS"},{value:"86400",label:"LBL_REMINDER_1DAY"}],c}return __extends(fieldActivityReminder,m),Object.defineProperty(fieldActivityReminder.prototype,"display",{get:function(){var t=this;return this.options.find(function(e){return e.value==t.value}).label},enumerable:!1,configurable:!0}),Object.defineProperty(fieldActivityReminder.prototype,"value",{get:function(){var e=this.model.getField(this.fieldname);return e||"-1"},set:function(e){this.model.setField(this.fieldname,e)},enumerable:!1,configurable:!0}),__decorate([core_1.Component({selector:"field-activity-reminder",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig" [fieldid]="fieldid"><system-label [label]="display"></system-label></field-generic-display><div *ngIf="isEditMode()" class="slds-form-element"><div class="slds-form-element__control" [ngClass]="getFieldClass()"><div class="slds-select_container slds-m-vertical--xx-small"><select #focus class="slds-select" [(ngModel)]="value"><option *ngFor="let option of options" [value]="option.value"><system-label [label]="option.label"></system-label></option></select></div><field-messages [fieldname]="fieldname"></field-messages></div></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.broadcast,services_1.language,services_1.metadata,router_1.Router,core_1.ElementRef,core_1.Renderer2,services_1.modal,services_1.userpreferences])],fieldActivityReminder)}(objectfields_1.fieldGeneric);exports.fieldActivityReminder=fieldActivityReminder;var ActivityParticipationPanel=function(){function e(e,t,i,s){this.model=e,this.metadata=t,this.view=i,this.language=s,this.participants=[],this.editmode=!1,this.remove=new core_1.EventEmitter,this.view.isEditable=!1,this.view.displayLabels=!1}return e.prototype.removeParticipant=function(e){this.remove.emit(e)},e.prototype.participantid=function(e,t){return t.id},__decorate([core_1.Input(),__metadata("design:type",Array)],e.prototype,"participants",void 0),__decorate([core_1.Input(),__metadata("design:type",Boolean)],e.prototype,"editmode",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"fieldset",void 0),__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],e.prototype,"remove",void 0),__decorate([core_1.Component({selector:"activity-participation-panel",template:'<div class="slds-size--1-of-1 slds-scrollable--y"><table class="slds-table slds-table_bordered"><thead><tr class="slds-line-height_reset" activity-participation-panel-header [fieldset]="fieldset"></tr></thead><tbody><tr activity-participation-panel-participant *ngFor="let participant of participants; trackBy:participantid;" [participant]="participant" [editmode]="editmode" [fieldset]="fieldset" (remove)="removeParticipant(participant)"></tr></tbody></table></div>',providers:[services_1.view]}),__metadata("design:paramtypes",[services_1.model,services_1.metadata,services_1.view,services_1.language])],e)}();exports.ActivityParticipationPanel=ActivityParticipationPanel;var fieldActivityParticipationPanel=function(c){function fieldActivityParticipationPanel(e,t,i,s,a,o,l,n,d){var r=c.call(this,e,t,s,a,o)||this;return r.model=e,r.view=t,r.broadcast=i,r.language=s,r.metadata=a,r.router=o,r.elementRef=l,r.renderer=n,r.modal=d,r.lookupType=0,r.lookuplinks=[],r.lookuplinkSelectOpen=!1,r.lookupSearchOpen=!1,r.lookupSearchTerm="",r.participants=[],r.subscriptions.add(r.broadcast.message$.subscribe(function(e){return r.handleMessage(e)})),r.subscriptions.add(r.model.data$.subscribe(function(e){0<r.lookuplinks.length&&r.setParticipants(),r.updateRelateFilter()})),r}return __extends(fieldActivityParticipationPanel,c),Object.defineProperty(fieldActivityParticipationPanel.prototype,"lookupTypeName",{get:function(){var e;return this.language.getModuleName(null===(e=this.lookuplinks[this.lookupType])||void 0===e?void 0:e.module)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldActivityParticipationPanel.prototype,"relateFilterActive",{get:function(){var e;return"Users"!=(null===(e=this.lookuplinks[this.lookupType])||void 0===e?void 0:e.module)},enumerable:!1,configurable:!0}),fieldActivityParticipationPanel.prototype.ngOnInit=function(){this.lookuplinks=this.getLookuplinks(),this.setParticipants(),this.fieldconfig.fieldset?this.fieldset=this.fieldconfig.fieldset:this.fieldset=this.metadata.getComponentConfig("fieldActivityParticipationPanel").fieldset,this.fieldconfig.relatefilterfield&&this.createRelateFilter()},fieldActivityParticipationPanel.prototype.ngOnDestroy=function(){this.subscriptions.unsubscribe()},fieldActivityParticipationPanel.prototype.onClick=function(e){this.elementRef.nativeElement.contains(e.target)||this.closePopups()},fieldActivityParticipationPanel.prototype.handleRelateFIlterField=function(){var t=this;this.fieldconfig.relatefilterfield&&(this.createRelateFilter(),this.subscriptions.add(this.model.data$.subscribe(function(e){t.updateRelateFilter()})))},fieldActivityParticipationPanel.prototype.createRelateFilter=function(){var e,t=this.metadata.getFieldDefs(this.model.module,this.fieldconfig.relatefilterfield);t&&(e="parent"==t.type?this.model.getField(t.type_name):t.module,this.relateFilter={module:e,relationship:this.fieldconfig.relatefilterrelationship,id:this.model.getField(t.id_name),display:this.model.getField(this.fieldconfig.relatefilterfield),active:!!this.model.getField(t.id_name),required:!1})},fieldActivityParticipationPanel.prototype.removeRelateFilter=function(){this.relateFilter=void 0},fieldActivityParticipationPanel.prototype.updateRelateFilter=function(){var e;!this.relateFilterActive||(e=this.metadata.getFieldDefs(this.model.module,this.fieldconfig.relatefilterfield))&&(this.relateFilter.id=this.model.getField(e.id_name),this.relateFilter.display=this.model.getField(this.fieldconfig.relatefilterfield),this.relateFilter.active=!!this.relateFilter.id)},fieldActivityParticipationPanel.prototype.getLookuplinks=function(){for(var e=[],t=[],i=0,s=e=0==(e=this.fieldconfig.linknames?this.fieldconfig.linknames.split(","):e).length?["contacts","users","consumers"]:e;i<s.length;i++){var a=(a=s[i]).trim();this.metadata.getFieldDefs(this.model.module,a)&&t.push({name:a,module:this.metadata.getFieldDefs(this.model.module,a).module})}return t},fieldActivityParticipationPanel.prototype.setParticipants=function(){for(var e=0,t=this.lookuplinks;e<t.length;e++){var i=t[e];if(this.model.data[i.name]&&this.model.data[i.name].beans){var s,a=this;for(s in this.model.data[i.name].beans)!function(e){var t=a.model.data[i.name].beans[e];if("Users"==i.module&&!a.displayAssignedUser&&e==a.model.data.assigned_user_id)return;a.participants.findIndex(function(e){return e.id==t.id})<0&&a.participants.push({module:i.module,id:t.id,data:t,link:i.name})}(s)}}},fieldActivityParticipationPanel.prototype.addItem=function(e){this.model.data[this.lookuplinks[this.lookupType].name]||(this.model.data[this.lookuplinks[this.lookupType].name]={beans:{}}),this.model.data[this.lookuplinks[this.lookupType].name].beans[e.id]=e.data,this.lookupSearchOpen=!1,this.setParticipants()},fieldActivityParticipationPanel.prototype.handleMessage=function(e){e.messagedata.reference&&"model.save"===e.messagetype&&this.fieldid===e.messagedata.reference&&(this.lookupSearchTerm="",this.addItem({id:e.messagedata.data.id,text:e.messagedata.data.summary_text}))},fieldActivityParticipationPanel.prototype.closePopups=function(){this.lookupSearchOpen=!1,this.lookuplinkSelectOpen=!1,this.clickListener()},fieldActivityParticipationPanel.prototype.toggleLookupTypeSelect=function(){this.lookuplinkSelectOpen=!this.lookuplinkSelectOpen,this.lookupSearchOpen=!1},fieldActivityParticipationPanel.prototype.setLookupType=function(e){this.lookupSearchTerm="",this.lookupType=e,this.lookuplinkSelectOpen=!1,this.relateFilterActive?this.createRelateFilter():this.removeRelateFilter()},fieldActivityParticipationPanel.prototype.removeItem=function(t){this.model.data[t.link].beans_relations_to_delete||(this.model.data[t.link].beans_relations_to_delete={}),this.model.data[t.link].beans_relations_to_delete[t.id]=t,delete this.model.data[t.link].beans[t.id],this.participants=this.participants.filter(function(e){return e.id!=t.id})},fieldActivityParticipationPanel.prototype.onFocus=function(){this.openSearchDropDown()},fieldActivityParticipationPanel.prototype.openSearchDropDown=function(){var t=this;this.lookuplinkSelectOpen=!1,this.lookupSearchOpen=!0,this.clickListener=this.renderer.listen("document","click",function(e){return t.onClick(e)})},fieldActivityParticipationPanel.prototype.searchWithModal=function(){var t=this;this.modal.openModal("ObjectModalModuleLookup").subscribe(function(e){e.instance.module=t.lookuplinks[t.lookupType].module,e.instance.multiselect=!1,t.relateFilter&&(e.instance.relatefilter=t.relateFilter),e.instance.selectedItems.subscribe(function(e){t.addItem({id:e[0].id,text:e[0].summary_text,data:e[0]})}),e.instance.usedSearchTerm.subscribe(function(e){t.lookupSearchTerm=e}),e.instance.searchTerm=t.lookupSearchTerm})},__decorate([core_1.Component({template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><activity-participation-panel [fieldset]="fieldset" [participants]="participants" [editmode]="isEditMode()" (remove)="removeItem($event)"></activity-participation-panel><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control"><div class="slds-combobox-group slds-p-vertical--xx-small"><div *ngIf="lookuplinks.length > 1" class="slds-combobox_object-switcher slds-combobox-addon_start"><div class="slds-combobox_container"><div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click" [ngClass]="{\'slds-is-open\': lookuplinkSelectOpen}" role="combobox"><div class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon--right" (click)="toggleLookupTypeSelect()"><input type="text" readonly class="slds-input slds-combobox__input slds-combobox__input-value" autoComplete="off" role="textbox" [value]="lookupTypeName"><system-icon icon="down" sprite="utility" addclasses="slds-input__icon slds-input__icon_right"></system-icon></div><div class="slds-dropdown slds-dropdown_length-5 slds-dropdown_x-small slds-dropdown_left" role="listbox"><ul class="slds-listbox slds-listbox_vertical" role="group" aria-label="Suggested for you"><li *ngFor="let lookuplink of lookuplinks; index as i" role="presentation" class="slds-listbox__item" (click)="setLookupType(i)"><div class="slds-media slds-listbox__option slds-listbox__option_plain slds-media_small" role="option"><div class="slds-grid slds-grid--vertical-align-center"><system-icon [module]="lookuplink.module" size="x-small"></system-icon><div class="slds-truncate"><system-label-modulename [module]="lookuplink.module"></system-label-modulename></div></div></div></li></ul></div></div></div></div><div class="slds-combobox_container slds-combobox-addon_end"><div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click" [ngClass]="{\'slds-is-open\': lookupSearchOpen}" role="combobox"><div class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right" role="none"><input type="text" class="slds-input" [ngClass]="{\'slds-combobox__input\':lookuplinks.length > 1}" aria-autocomplete="list" (click)="onFocus()" (focus)="onFocus()" autoComplete="off" role="textbox" [(ngModel)]="lookupSearchTerm" [placeholder]="language.getModuleCombinedLabel(\'LBL_SEARCH\', lookuplinks[lookupType]?.module)"> <button (click)="searchWithModal()" class="slds-button slds-button_icon slds-input__icon slds-input__icon_right"><system-button-icon [icon]="\'search\'"></system-button-icon></button></div><div class="slds-dropdown slds-dropdown_length-with-icon-7 slds-dropdown_fluid" role="listbox"><field-lookup-recent *ngIf="lookupSearchOpen && lookupSearchTerm === \'\'" [module]="lookuplinks[lookupType].module" (selectedObject)="addItem($event)"></field-lookup-recent><field-lookup-search *ngIf="lookupSearchOpen && lookupSearchTerm !== \'\'" [module]="lookuplinks[lookupType].module" [relatefilter]="relateFilter" (selectedObject)="addItem($event)" (searchWithModal)="searchWithModal()" [searchterm]="lookupSearchTerm"></field-lookup-search></div></div></div></div></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.broadcast,services_1.language,services_1.metadata,router_1.Router,core_1.ElementRef,core_1.Renderer2,services_1.modal])],fieldActivityParticipationPanel)}(objectfields_1.fieldGeneric);exports.fieldActivityParticipationPanel=fieldActivityParticipationPanel;var ActivityParticipationPanelHeader=function(){function e(e,t,i){this.model=e,this.metadata=t,this.view=i,this.fieldsetfields=[],this.model.module="Contacts"}return e.prototype.ngOnInit=function(){this.fieldsetfields=this.metadata.getFieldSetFields(this.fieldset)},__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"fieldset",void 0),__decorate([core_1.Component({selector:"[activity-participation-panel-header]",template:'<th class="slds-cell-shrink" scope="col"></th><th scope="col" *ngFor="let fieldsetfield of fieldsetfields"><field-label [fieldname]="fieldsetfield.field" [fieldconfig]="fieldsetfield.fieldconfig"></field-label></th>',providers:[services_1.model]}),__metadata("design:paramtypes",[services_1.model,services_1.metadata,services_1.view])],e)}();exports.ActivityParticipationPanelHeader=ActivityParticipationPanelHeader;var ActivityParticipationPanelParticipant=function(){function e(e,t,i,s){this.model=e,this.parent=t,this.metadata=i,this.view=s,this.participant={},this.editmode=!1,this.fieldsetfields=[],this.remove=new core_1.EventEmitter}return e.prototype.ngOnInit=function(){this.model.module=this.participant.module,this.model.id=this.participant.id,this.model.data=this.model.utils.backendModel2spice(this.module,this.participant.data),this.model.parentmodel=this.parent,this.fieldsetfields=this.metadata.getFieldSetFields(this.fieldset)},e.prototype.removeItem=function(e){e.stopPropagation(),this.editmode&&this.remove.emit(!0)},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"participant",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"module",void 0),__decorate([core_1.Input(),__metadata("design:type",Boolean)],e.prototype,"editmode",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"fieldset",void 0),__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],e.prototype,"remove",void 0),__decorate([core_1.Component({selector:"[activity-participation-panel-participant]",template:'<td><div class="slds-grid slds-grid--vertical-align-center"><system-utility-icon *ngIf="editmode" class="slds-m-right--xx-small" icon="close" size="xx-small" (click)="removeItem($event)"></system-utility-icon><system-icon [module]="model.module" size="xx-small"></system-icon></div></td><td *ngFor="let fieldsetfield of fieldsetfields"><field-container [field]="fieldsetfield.field" [fieldconfig]="fieldsetfield.fieldconfig" fielddisplayclass="slds-truncate slds-p-horizontal--x-small"></field-container></td>',providers:[services_1.model]}),__param(1,core_1.SkipSelf()),__metadata("design:paramtypes",[services_1.model,services_1.model,services_1.metadata,services_1.view])],e)}();exports.ActivityParticipationPanelParticipant=ActivityParticipationPanelParticipant;var ActivityParticipationStatus=function(){function e(e,t,i,s,a){this.view=e,this.session=t,this.cdRef=i,this.backend=s,this.toast=a,this.status="none",this.updating=!1}var t=e;return Object.defineProperty(e.prototype,"disabled",{get:function(){return!(!this.view.isEditMode()&&!this.updating&&"Users"==this.model.module&&this.model.id==this.session.authData.userId&&this.parent&&"Planned"==this.parent.getField("status"))},enumerable:!1,configurable:!0}),e.prototype.accept=function(){this.setStatus("accept")},e.prototype.decline=function(){this.setStatus("decline")},e.prototype.tentative=function(){this.setStatus("tentative")},e.prototype.setStatus=function(t){var i=this;this.updating=!0,this.backend.postRequest("module/"+this.parent.module+"/"+this.parent.id+"/status/"+this.model.id+"/"+t).subscribe(function(e){i.status=t,i.onChange(i.status),i.updating=!1},function(e){i.toast.sendToast("Error Updating","error"),i.updating=!1})},e.prototype.registerOnChange=function(e){this.onChange=e},e.prototype.registerOnTouched=function(e){this.onTouched=e},e.prototype.writeValue=function(e){this.status=e||"none",this.cdRef.detectChanges()},__decorate([core_1.Input(),__metadata("design:type",services_1.model)],e.prototype,"parent",void 0),__decorate([core_1.Input(),__metadata("design:type",services_1.model)],e.prototype,"model",void 0),t=__decorate([core_1.Component({selector:"activity-participation-status",template:'<div class="slds-button-group" role="group"><button class="slds-button slds-button-icon slds-button_icon-border-filled" (click)="accept()" style="height: 22px; width:22px;" [disabled]="disabled" [ngClass]="{\'slds-is-selected\': status == \'accept\'}"><system-button-icon icon="check" size="xx-small"></system-button-icon></button> <button class="slds-button slds-button-icon slds-button_icon-border-filled" (click)="tentative()" style="height: 22px; width:22px;" [disabled]="disabled" [ngClass]="{\'slds-is-selected\': status == \'tentative\'}"><system-button-icon icon="question_mark"></system-button-icon></button> <button class="slds-button slds-button-icon slds-button_icon-border-filled" (click)="decline()" style="height: 22px; width:22px;" [disabled]="disabled" [ngClass]="{\'slds-is-selected\': status == \'decline\'}"><system-button-icon icon="error"></system-button-icon></button></div>',providers:[{provide:forms_1.NG_VALUE_ACCESSOR,useExisting:core_1.forwardRef(function(){return t}),multi:!0}]}),__metadata("design:paramtypes",[services_1.view,services_1.session,core_1.ChangeDetectorRef,services_1.backend,services_1.toast])],e)}();exports.ActivityParticipationStatus=ActivityParticipationStatus;var fieldActivityParticipationStatus=function(m){function fieldActivityParticipationStatus(e,t,i,s,a,o,l,n,d,r){var c=m.call(this,e,t,s,a,o)||this;return c.model=e,c.view=t,c.broadcast=i,c.language=s,c.metadata=a,c.router=o,c.elementRef=l,c.renderer=n,c.modal=d,c.session=r,c}return __extends(fieldActivityParticipationStatus,m),Object.defineProperty(fieldActivityParticipationStatus.prototype,"disabled",{get:function(){return"Users"!=this.model.module||this.model.getField("id")!=this.session.authData.userId||!this.model.parentmodel||"Planned"!=this.model.parentmodel.getField("status")},enumerable:!1,configurable:!0}),__decorate([core_1.Component({template:'<activity-participation-status [model]="model" [(ngModel)]="value" [parent]="model.parentmodel"></activity-participation-status>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.broadcast,services_1.language,services_1.metadata,router_1.Router,core_1.ElementRef,core_1.Renderer2,services_1.modal,services_1.session])],fieldActivityParticipationStatus)}(objectfields_1.fieldGeneric);exports.fieldActivityParticipationStatus=fieldActivityParticipationStatus;var fieldActivityCurrentUserParticipationStatus=function(m){function fieldActivityCurrentUserParticipationStatus(e,t,i,s,a,o,l,n,d,r){var c=m.call(this,e,t,s,a,o)||this;return c.model=e,c.view=t,c.broadcast=i,c.language=s,c.metadata=a,c.router=o,c.elementRef=l,c.renderer=n,c.modal=d,c.session=r,c.partcipationRecord=void 0,c.subscriptions.add(c.model.data$.subscribe(function(e){c.setParticipation()})),c}return __extends(fieldActivityCurrentUserParticipationStatus,m),Object.defineProperty(fieldActivityCurrentUserParticipationStatus.prototype,"disabled",{get:function(){return!(this.partcipationRecord&&!this.isEditMode()&&"Planned"==this.model.getField("status"))},enumerable:!1,configurable:!0}),Object.defineProperty(fieldActivityCurrentUserParticipationStatus.prototype,"value",{get:function(){return this.partcipationRecord?this.partcipationRecord.activity_accept_status:"none"},set:function(e){this.partcipationRecord.activity_accept_status=e},enumerable:!1,configurable:!0}),fieldActivityCurrentUserParticipationStatus.prototype.setParticipation=function(){if(this.partcipationRecord=void 0,this.model.getField("assigned_user_id")!=this.session.authData.userId&&this.model.data.users)for(var e in this.model.data.users.beans)this.model.data.users.beans[e].id==this.session.authData.userId&&(this.partcipationRecord=this.model.data.users.beans[e])},__decorate([core_1.Component({template:'<activity-participation-status *ngIf="partcipationRecord" [model]="{id:partcipationRecord.id, module: \'Users\'}" [(ngModel)]="value" [parent]="model"></activity-participation-status>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.broadcast,services_1.language,services_1.metadata,router_1.Router,core_1.ElementRef,core_1.Renderer2,services_1.modal,services_1.session])],fieldActivityCurrentUserParticipationStatus)}(objectfields_1.fieldGeneric);exports.fieldActivityCurrentUserParticipationStatus=fieldActivityCurrentUserParticipationStatus;var ActivityTimeline=function(){function ActivityTimeline(e,t,i,s,a,o,l,n,d){this.model=e,this.router=t,this.language=i,this.activitiytimeline=s,this.metadata=a,this.utils=o,this.layout=l,this.navigationtab=n,this.injector=d,this.componentconfig={},this.displayaggregates={Activities:!1,History:!1}}return ActivityTimeline.prototype.ngOnInit=function(){this.activitiytimeline.parent=this.model,this.componentconfig.usefts&&(this.activitiytimeline.usefts=!0),this.componentconfig.defaultentries&&(this.activitiytimeline.defaultLimit=this.componentconfig.defaultentries)},Object.defineProperty(ActivityTimeline.prototype,"ftsSearchTerm",{get:function(){return this.activitiytimeline.filters.searchterm},set:function(e){this.activitiytimeline.filters.searchterm=e,this.activitiytimeline.reload()},enumerable:!1,configurable:!0}),Object.defineProperty(ActivityTimeline.prototype,"displayAddContainer",{get:function(){return!this.componentconfig.hideaddcontainer},enumerable:!1,configurable:!0}),Object.defineProperty(ActivityTimeline.prototype,"displayActivitiesContainer",{get:function(){return!this.componentconfig.hideactivitiescontainer},enumerable:!1,configurable:!0}),ActivityTimeline.prototype.ngOnDestroy=function(){this.activitiytimeline.stopSubscriptions()},ActivityTimeline.prototype.reload=function(){this.displayActivitiesContainer&&this.activitiytimeline.getTimeLineData("Activities"),this.activitiytimeline.getTimeLineData("History")},ActivityTimeline.prototype.toggleAggregates=function(e,t){t.stopPropagation(),this.displayaggregates[e]=!this.displayaggregates[e]},ActivityTimeline.prototype.loadMore=function(e){this.activitiytimeline.getMoreTimeLineData(e,this.componentconfig.defaultentries)},ActivityTimeline.prototype.toggleOpen=function(){this.activitiytimeline.openness=!this.activitiytimeline.openness},Object.defineProperty(ActivityTimeline.prototype,"isSmall",{get:function(){return"small"==this.layout.screenwidth},enumerable:!1,configurable:!0}),__decorate([core_1.Component({template:'<activitytimeline-add-container *ngIf="displayAddContainer"></activitytimeline-add-container><div class="slds-grid slds-grid--align-spread slds-p-top--small slds-grid--vertical-align-center"><div class="slds-grid slds-grid--vertical-align-center"><div class="slds-p-vertical--xx-small slds-text-heading--small"><system-label label="LBL_ACTIVITIES"></system-label></div></div><div class="slds-grid slds-grid--vertical-align-center"><system-input-delayed *ngIf="activitiytimeline.usefts" [placeholder]="language.getLabel(\'LBL_SEARCH\')" delay="1000" [(ngModel)]="ftsSearchTerm" class="slds-p-horizontal--xx-small"></system-input-delayed><activity-timeline-filter class="slds-p-horizontal--xxx-small"></activity-timeline-filter><button class="slds-button slds-button--icon" [title]="language.getLabel(\'LBL_RELOAD\')" (click)="reload()"><system-button-icon class="slds-p-horizontal--xxx-small slds-icon-text-default" icon="refresh"></system-button-icon></button> <button class="slds-button slds-button--icon" [title]="language.getLabel(\'LBL_OPEN_ALL\')" (click)="toggleOpen()"><system-button-icon class="slds-p-horizontal--xxx-small" [icon]="activitiytimeline.openness ? \'chevronup\' : \'chevrondown\'"></system-button-icon></button></div></div><div class="slds-p-top--x-small activities-activity"><ng-container *ngIf="displayActivitiesContainer"><div class="slds-is-relative spiceActivitiyTimelineHeader"><div class="slds-p-vertical--xx-small slds-text-heading--x-small"><span>{{activitiytimeline.activities.Activities.totalcount}}</span> <span class="slds-p-horizontal--xx-small"><system-label label="LBL_NEXT_STEPS"></system-label></span><system-utility-icon *ngIf="activitiytimeline.usefts && activitiytimeline.activities.Activities.totalcount>0" [icon]="displayaggregates.Activities?\'up\':\'down\'" size="x-small" (click)="toggleAggregates(\'Activities\', $event)"></system-utility-icon></div><button *ngIf="activitiytimeline.canLoadMore(\'Activities\')" class="slds-button slds-button--neutral slds-is-absolute" style="right:.5rem; top:-3px;" type="button" (click)="loadMore(\'Activities\')"><span><system-label label="LBL_MORE"></system-label></span></button></div><activitytimeline-container module="Activities" [displayaggregates]="displayaggregates.Activities"></activitytimeline-container></ng-container><div class="slds-is-relative spiceActivitiyTimelineHeader"><div class="slds-p-vertical--xx-small slds-text-heading--x-small"><span>{{activitiytimeline.activities.History.totalcount}}</span> <span class="slds-p-horizontal--xx-small"><system-label label="LBL_PAST_ACTIVITIES"></system-label></span><system-utility-icon *ngIf="activitiytimeline.usefts && activitiytimeline.activities.History.totalcount > 0" [icon]="displayaggregates.History?\'up\':\'down\'" size="x-small" (click)="toggleAggregates(\'History\', $event)"></system-utility-icon></div><activitytimeline-summary-button></activitytimeline-summary-button></div><activity-timeline-drop-zone-wrapper><activitytimeline-container module="History" [displayaggregates]="displayaggregates.History"></activitytimeline-container></activity-timeline-drop-zone-wrapper><div class="slds-grid slds-grid_align-end"><button *ngIf="activitiytimeline.canLoadMore(\'History\')" class="slds-button slds-button--neutral" type="button" (click)="loadMore(\'History\')"><span><system-label label="LBL_MORE"></system-label></span></button></div></div>',providers:[services_1.activitiytimeline]}),__param(7,core_1.Optional()),__metadata("design:paramtypes",[services_1.model,router_1.Router,services_1.language,services_1.activitiytimeline,services_1.metadata,services_1.modelutilities,services_1.layout,services_1.navigationtab,core_1.Injector])],ActivityTimeline)}(),ActivityTimelineTabbed=function(t){function ActivityTimelineTabbed(){var e=null!==t&&t.apply(this,arguments)||this;return e.activetab="history",e}return __extends(ActivityTimelineTabbed,t),ActivityTimelineTabbed.prototype.displaySummary=function(){var e,t="";null!==(e=this.navigationtab)&&void 0!==e&&e.tabid&&(t="/tab/"+this.navigationtab.tabid),this.router.navigate([t+"/module/"+this.model.module+"/historysummary/"+this.model.id])},__decorate([core_1.Component({template:'<activitytimeline-add-container *ngIf="displayAddContainer"></activitytimeline-add-container><div class="slds-tabs_default"><div *ngIf="isSmall" class="slds-grid slds-grid--vertical-align-center slds-p-top--x-small"><system-input-delayed *ngIf="activitiytimeline.usefts" [placeholder]="language.getLabel(\'LBL_SEARCH\')" delay="1000" [(ngModel)]="ftsSearchTerm" class="slds-p-horizontal--xx-small slds-grow"></system-input-delayed><activity-timeline-filter class="slds-p-horizontal--xxx-small"></activity-timeline-filter><button class="slds-button slds-button--icon" [title]="language.getLabel(\'LBL_RELOAD\')" (click)="reload()"><system-button-icon class="slds-p-horizontal--xxx-small slds-icon-text-default" icon="refresh"></system-button-icon></button> <button class="slds-button slds-button--icon" [title]="language.getLabel(\'LBL_SUMMARY\')" (click)="displaySummary()"><system-button-icon class="slds-p-horizontal--xxx-small" icon="side_list"></system-button-icon></button> <button class="slds-button slds-button--icon" [title]="language.getLabel(\'LBL_OPEN_ALL\')" (click)="toggleOpen()"><system-button-icon class="slds-p-horizontal--xxx-small" [icon]="activitiytimeline.openness ? \'chevronup\' : \'chevrondown\'"></system-button-icon></button></div><div class="slds-grid slds-grid--vertical-align-center"><ul class="slds-tabs_default__nav slds-grow" role="tablist"><li class="slds-tabs_default__item" [ngClass]="{\'slds-is-active\': activetab == \'history\'}" role="presentation"><a class="slds-tabs_default__link" href="javascript:void(0);" role="tab" (click)="activetab = \'history\'"><system-label label="LBL_PAST_ACTIVITIES"></system-label> ({{activitiytimeline.activities.History.totalcount}})</a></li><li class="slds-tabs_default__item" [ngClass]="{\'slds-is-active\': activetab == \'planned\'}" role="presentation"><a class="slds-tabs_default__link" href="javascript:void(0);" role="tab" (click)="activetab = \'planned\'"><system-label label="LBL_NEXT_STEPS"></system-label> ({{activitiytimeline.activities.Activities.totalcount}})</a></li><li *ngIf="!isSmall" class="slds-col--bump-left slds-p-vertical--xx-small"><div class="slds-grid slds-grid--vertical-align-center"><system-input-delayed *ngIf="activitiytimeline.usefts" [placeholder]="language.getLabel(\'LBL_SEARCH\')" delay="1000" [(ngModel)]="ftsSearchTerm" class="slds-p-horizontal--xx-small"></system-input-delayed><activity-timeline-filter class="slds-p-horizontal--xxx-small"></activity-timeline-filter><button class="slds-button slds-button--icon" [title]="language.getLabel(\'LBL_RELOAD\')" (click)="reload()"><system-button-icon class="slds-p-horizontal--xxx-small slds-icon-text-default" icon="refresh"></system-button-icon></button> <button class="slds-button slds-button--icon" [title]="language.getLabel(\'LBL_SUMMARY\')" (click)="displaySummary()"><system-button-icon class="slds-p-horizontal--xxx-small" icon="side_list"></system-button-icon></button> <button class="slds-button slds-button--icon" [title]="language.getLabel(\'LBL_OPEN_ALL\')" (click)="toggleOpen()"><system-button-icon class="slds-p-horizontal--xxx-small" [icon]="activitiytimeline.openness ? \'chevronup\' : \'chevrondown\'"></system-button-icon></button></div></li></ul></div><div class="slds-tabs_default__content slds-p-top--xxx-small" [ngClass]="{\'slds-hide\': activetab != \'history\'}" role="tabpanel"><activity-timeline-drop-zone-wrapper><activitytimeline-container module="History" [displayaggregates]="false"></activitytimeline-container></activity-timeline-drop-zone-wrapper></div><div class="slds-tabs_default__content slds-p-top--xxx-small" [ngClass]="{\'slds-hide\': activetab != \'planned\'}" role="tabpanel"><activitytimeline-container module="Activities"></activitytimeline-container></div></div>',providers:[services_1.activitiytimeline,services_1.modelattachments]})],ActivityTimelineTabbed)}(exports.ActivityTimeline=ActivityTimeline);exports.ActivityTimelineTabbed=ActivityTimelineTabbed;var ActivityTimelineDropZoneWrapper=function(){function e(e,t,i,s,a,o,l,n){this.language=e,this.toast=t,this.configurationService=i,this.activitiytimeline=s,this.noteModel=a,this.model=o,this.session=l,this.helper=n,this.uploadData={fileName:"",fileIcon:{},uploading:!1,progress:void 0}}return Object.defineProperty(e.prototype,"maxSize",{get:function(){return this.configurationService.getSystemParamater("upload_maxsize")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"progressBarStyle",{get:function(){return{width:(this.uploadData.progress||0)+"%"}},enumerable:!1,configurable:!0}),e.prototype.handleDroppedFiles=function(e){var t,i=this,s=[],a=[];for(t in e)e.hasOwnProperty(t)&&(this.fileSizeExceeded(e[t])?this.toast.sendToast(this.language.getLabelFormatted("LBL_EXCEEDS_MAX_UPLOADFILESIZE",[e[t].name,this.helper.humanFileSize(this.maxSize)]),"error"):(".msg"==e[t].name.substring(e[t].name.length-4).toLowerCase()?s:a).push(e[t]));0<s.length&&(this.uploadData.uploading=!0,this.uploadFiles(s,this.model.module,this.model.id).subscribe(function(e){i.uploadData.fileName=e.fileName,i.uploadData.progress=e.progress,i.setFileIcon(e.fileName,e.fileType)},function(){i.toast.sendToast(i.language.getLabel("ERR_UPLOAD_FAILED"),"error")},function(){i.activitiytimeline.getTimeLineData("History"),i.uploadData.uploading=!1})),0<a.length&&this.addNotesFromFiles(a)},e.prototype.uploadFiles=function(e,a,t){var o=this;if(0!==e.length){for(var l=new rxjs_1.Subject,i=this,s=0,n=e;s<n.length;s++)!function(s){i.readFile(s).subscribe(function(){var i=new XMLHttpRequest;i.onreadystatechange=function(e){if(void 0===e&&(e=o),4==i.readyState)try{var t;"Notes"==a&&(t=JSON.parse(i.response),l.next({progress:100,fileName:s.name,fileType:s.type,fileMD5:t[0].filemd5})),l.complete()}catch(e){i.responseText}},i.upload.addEventListener("progress",function(e){l.next({progress:Math.round(e.loaded/e.total*100),fileName:s.name,fileType:s.type,fileMD5:s.filemd5})},!1);var e=o.configurationService.getBackendUrl()+"/common/spiceattachments";"Notes"!=a&&(e=o.configurationService.getBackendUrl()+"/module/Emails/msg"),i.open("POST",e,!0),i.setRequestHeader("OAuth-Token",o.session.authData.sessionId),i.setRequestHeader("Content-Type","application/json;charset=UTF-8");e={file:s.filecontent,filename:s.name,filemimetype:s.type||"application/octet-stream",filemd5:void 0,beanId:t,beanModule:a};i.send(JSON.stringify(e))})}(n[s]);return l.asObservable()}},e.prototype.readFile=function(e){var i=new rxjs_1.Subject,s=new FileReader;return s.file=e,s.onloadend=function(){var e=(e=s.result.toString()).substring(e.indexOf("base64,")+7),t=s.file;t.filecontent=e,i.next(t),i.complete()},s.readAsDataURL(e),i.asObservable()},e.prototype.setFileIcon=function(e,t){var i;t!=this.uploadData.fileIcon.fileType&&("unknown"==(i=this.helper.determineFileIcon(t))&&"msg"==e.split(".").splice(-1,1)[0].toLowerCase()&&(this.uploadData.fileIcon={icon:"email",sprite:"standard",fileType:t}),this.uploadData.fileIcon={icon:i,sprite:"doctype",fileType:t})},e.prototype.addNotesFromFiles=function(e){this.addNewNote(e)},e.prototype.addNewNote=function(t,i){var s=this;void 0===i&&(i=0),this.noteModel.reset(),this.noteModel.module="Notes",this.noteModel.initialize(this.activitiytimeline.parent),this.noteModel.startEdit(!1),this.noteModel.setField("name",t[i].name),this.noteModel.setField("file_name",t[i].name),this.noteModel.setField("file_mime_type",t[i].type||"application/octet-stream"),this.uploadData.uploading=!0,this.uploadFiles([t[i]],this.noteModel.module,this.noteModel.id).subscribe(function(e){s.uploadData.fileName=e.fileName,s.uploadData.progress=e.progress,s.setFileIcon(e.fileName,e.fileType),e.fileMD5&&s.noteModel.setField("file_md5",e.fileMD5)},function(){s.toast.sendToast(s.language.getLabel("ERR_UPLOAD_FAILED"),"error")},function(){s.noteModel.save().subscribe(function(e){i+1>=t.length?(s.activitiytimeline.getTimeLineData("History"),s.uploadData.uploading=!1):s.addNewNote(t,i+1)})})},e.prototype.fileSizeExceeded=function(e){return this.maxSize&&e.size>this.maxSize},__decorate([core_1.Component({selector:"activity-timeline-drop-zone-wrapper",template:'<div (system-drop-file)="handleDroppedFiles($event)"><div *ngIf="uploadData.uploading" class="slds-m-vertical--medium slds-media"><div style="width: 30px; height: 30px;" class="slds-m-right--x-small slds-align--absolute-center"><system-icon [icon]="this.uploadData.fileIcon.icon" divClass [sprite]="this.uploadData.fileIcon.sprite" size="\'small\'"></system-icon></div><div class="slds-media__body"><div class="slds-grid slds-grid_vertical-align-center slds-grid--align-spread slds-has-flexi-truncate"><h3 class="slds-truncate slds-text-heading--x-small slds-p-right--xxx-small"><a href="javascript:void(0);">{{uploadData.fileName}}</a></h3></div><div class="slds-grid slds-grid_vertical-align-center slds-grid--align-spread slds-has-flexi-truncate"><div class="slds-progress-bar"><span class="slds-progress-bar__value" [ngStyle]="progressBarStyle"><span class="slds-assistive-text">Progress: 25%</span></span></div><div class="slds-text-align--right" style="width: 50px;">{{uploadData.progress}} %</div></div></div></div><ng-content></ng-content></div>',viewProviders:[services_1.model]}),__param(5,core_1.SkipSelf()),__metadata("design:paramtypes",[services_1.language,services_1.toast,services_1.configurationService,services_1.activitiytimeline,services_1.model,services_1.model,services_1.session,services_1.helper])],e)}();exports.ActivityTimelineDropZoneWrapper=ActivityTimelineDropZoneWrapper;var ActivityTimelineFilter=function(){function e(e,t,i,s,a){this.renderer=e,this.elementRef=t,this.language=i,this.metadata=s,this.activitiytimeline=a,this.isOpen=!1,this.activityTypes=[],this.objectfilters=[],this.ownerfilter="",this.setFromService()}return e.prototype.setFromService=function(){this.objectfilters=JSON.parse(JSON.stringify(this.activitiytimeline.filters.objectfilters)),this.ownerfilter=this.activitiytimeline.filters.own},e.prototype.setToService=function(){this.activitiytimeline.filters.objectfilters=JSON.parse(JSON.stringify(this.objectfilters)),this.activitiytimeline.filters.own=this.ownerfilter,this.activitiytimeline.reload()},e.prototype.toggleOpen=function(e){var t=this;e.stopPropagation(),this.isOpen=!this.isOpen,this.isOpen?this.clickListener=this.renderer.listen("document","click",function(e){return t.onClick(e)}):this.clickListener&&this.clickListener(),this.isOpen&&this.buildTypes()},e.prototype.onClick=function(e){this.elementRef.nativeElement.contains(e.target)||(this.isOpen=!1,this.clickListener())},e.prototype.buildTypes=function(){this.activityTypes=[];for(var e=0,t=this.activitiytimeline.filterObjects;e<t.length;e++){var i=t[e];this.activityTypes.push({type:i,name:this.language.getModuleName(i)})}this.activityTypes.sort(function(e,t){return e.name>t.name?1:-1})},Object.defineProperty(e.prototype,"filterColorClass",{get:function(){return 0<this.activitiytimeline.filters.objectfilters.length||this.activitiytimeline.filters.own?"slds-icon-text-error":"slds-icon-text-default"},enumerable:!1,configurable:!0}),e.prototype.setFilter=function(e,t){e.preventDefault(),"all"==t?this.objectfilters=[]:0<=(e=this.objectfilters.indexOf(t))?this.objectfilters.splice(e,1):this.objectfilters.push(t)},e.prototype.getChecked=function(e){return"all"==e?0==this.objectfilters.length:0<=this.objectfilters.indexOf(e)},e.prototype.closeDialog=function(e){this.clickListener&&this.clickListener(),e?this.setToService():this.setFromService(),this.isOpen=!1},__decorate([core_1.Component({selector:"activity-timeline-filter",template:'<div class="slds-dropdown-trigger slds-dropdown-trigger_click slds-p-horizontal--xxx-small" [ngClass]="{\'slds-is-open\': isOpen}"><system-utility-icon icon="filterList" size="x-small" (click)="toggleOpen($event)" [colorclass]="filterColorClass" [title]="language.getLabel(\'LBL_FILTER\')"></system-utility-icon><div class="slds-is-absolute slds-dropdown slds-dropdown_right slds-nubbin_top-right" style="right:-10px;top:25px;"><div class="slds-grid"><div class="slds-p-horizontal--small slds-border--right" style="min-width: 180px"><div class="slds-p-vertical--x-small"><system-label label="LBL_TYPE"></system-label></div><div class="slds-form-element slds-p-vertical--xx-small"><div class="slds-form-element__control" (click)="setFilter($event, \'all\')"><span class="slds-checkbox"><input type="checkbox" id="alltypes" [checked]="getChecked(\'all\')"> <label class="slds-checkbox__label" for="alltypes"><span class="slds-checkbox_faux"></span> <span class="slds-form-element__label"><system-label label="LBL_ALL"></system-label></span></label></span></div></div><div class="slds-form-element slds-p-vertical--xx-small" *ngFor="let activityType of activityTypes"><div class="slds-form-element__control" (click)="setFilter($event, activityType.type)"><span class="slds-checkbox"><input type="checkbox" [id]="activityType.type" [checked]="getChecked(activityType.type)"> <label class="slds-checkbox__label" [attr.for]="activityType.type"><span class="slds-checkbox_faux"></span> <span class="slds-form-element__label">{{activityType.name}}</span></label></span></div></div></div><div class="slds-p-horizontal--small" style="min-width: 180px"><div class="slds-p-vertical--x-small"><system-label label="LBL_FILTER"></system-label></div><fieldset class="slds-form-element"><div class="slds-form-element__control"><span class="slds-radio"><input type="radio" id="ownerall" name="filters" [(ngModel)]="ownerfilter"> <label class="slds-radio__label" for="ownerall"><span class="slds-radio_faux"></span> <span class="slds-form-element__label"><system-label label="LBL_ALL"></system-label></span></label></span> <span class="slds-radio"><input type="radio" id="ownerassignedtome" name="filters" value="assigned" [(ngModel)]="ownerfilter"> <label class="slds-radio__label" for="ownerassignedtome"><span class="slds-radio_faux"></span> <span class="slds-form-element__label slds-truncate"><system-label label="LBL_ASSIGNEDTOME"></system-label></span></label></span> <span class="slds-radio"><input type="radio" id="ownercreatedbyme" name="filters" value="created" [(ngModel)]="ownerfilter"> <label class="slds-radio__label" for="ownercreatedbyme"><span class="slds-radio_faux"></span> <span class="slds-form-element__label slds-truncate"><system-label label="LBL_CREATEDBYME"></system-label></span></label></span></div></fieldset></div></div><footer class="slds-popover__footer"><div class="slds-grid"><button class="slds-col--bump-left slds-button slds-button_neutral" (click)="closeDialog(false)"><system-label label="LBL_CANCEL"></system-label></button> <button class="slds-button slds-button--brand" (click)="closeDialog(true)"><system-label label="LBL_APPLY"></system-label></button></div></footer></div></div>'}),__metadata("design:paramtypes",[core_1.Renderer2,core_1.ElementRef,services_1.language,services_1.metadata,services_1.activitiytimeline])],e)}();exports.ActivityTimelineFilter=ActivityTimelineFilter;var ActivityTimelineContainer=function(){function e(e,t){this.activitiytimeline=e,this.language=t,this.displayaggregates=!1}return e.prototype.ngOnInit=function(){this.activitiytimeline.getTimeLineData(this.module)},Object.defineProperty(e.prototype,"activities",{get:function(){return this.activitiytimeline.activities[this.module].list},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasActivities",{get:function(){return 0<this.activitiytimeline.activities[this.module].list.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"loading",{get:function(){return this.activitiytimeline.activities[this.module].loading},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"loadingmore",{get:function(){return this.activitiytimeline.activities[this.module].loadingmore},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasAggregates",{get:function(){try{return 0<this.activitiytimeline.activities[this.module].aggregates.module.length}catch(e){return!1}},enumerable:!1,configurable:!0}),e.prototype.trackByFn=function(e,t){return t.id},__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"module",void 0),__decorate([core_1.Input(),__metadata("design:type",Boolean)],e.prototype,"displayaggregates",void 0),__decorate([core_1.Component({selector:"activitytimeline-container",template:'<div *ngIf="displayaggregates && hasAggregates" class="slds-p-vertical--x-small slds-m-top--x-small"><activity-timeline-aggregates [module]="module" labellength="short"></activity-timeline-aggregates></div><ul *ngIf="hasActivities; else nocontent" [ngClass]="{\'slds-hide\': loading}" class="slds-timeline slds-p-vertical--small"><li *ngFor="let activity of activities"><activitytimeline-item-container [activity]="activity" [module]="module"></activitytimeline-item-container></li></ul><ul class="slds-timeline" *ngIf="loading || loadingmore"><li><activitytimeline-stencil></activitytimeline-stencil></li><li style="opacity: 0.6"><activitytimeline-stencil></activitytimeline-stencil></li><li style="opacity: 0.3"><activitytimeline-stencil></activitytimeline-stencil></li></ul><ng-template #nocontent><div class="slds-p-vertical--medium"><system-illustration-no-records *ngIf="!loading"><system-label label="LBL_NO_ENTRIES"></system-label></system-illustration-no-records></div></ng-template>'}),__metadata("design:paramtypes",[services_1.activitiytimeline,services_1.language])],e)}();exports.ActivityTimelineContainer=ActivityTimelineContainer;var ActivityTimelineItemContainer=function(){function ActivityTimelineItemContainer(e){this.metadata=e,this.activity={}}return ActivityTimelineItemContainer.prototype.ngOnInit=function(){var i=this,e=this.metadata.getComponentConfig("ActivityTimelineItemContainer",this.activity.module);if(e.componentset)for(var e=this.metadata.getComponentSetObjects(e.componentset),s=this,t=0,a=e;t<a.length;t++)!function(t){s.metadata.addComponent(t.component,s.container).subscribe(function(e){e.instance.activity=i.activity,e.instance.module=i.module,e.instance.componentconfig=t.componentconfig})}(a[t])},__decorate([core_1.ViewChild("container",{read:core_1.ViewContainerRef,static:!0}),__metadata("design:type",core_1.ViewContainerRef)],ActivityTimelineItemContainer.prototype,"container",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],ActivityTimelineItemContainer.prototype,"activity",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],ActivityTimelineItemContainer.prototype,"module",void 0),__decorate([core_1.Component({selector:"activitytimeline-item-container",template:"<ng-container #container></ng-container>"}),__metadata("design:paramtypes",[services_1.metadata])],ActivityTimelineItemContainer)}();exports.ActivityTimelineItemContainer=ActivityTimelineItemContainer;var ActivityTimelineAddTabContainer=function(){function e(e){this.metadata=e,this.tabcomponent="",this.componentconfig={}}return e.prototype.ngOnInit=function(){var t=this;this.metadata.addComponent(this.tabcomponent,this.container).subscribe(function(e){e.instance.componentconfig=t.componentconfig})},__decorate([core_1.ViewChild("container",{read:core_1.ViewContainerRef,static:!0}),__metadata("design:type",core_1.ViewContainerRef)],e.prototype,"container",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"tabcomponent",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"componentconfig",void 0),__decorate([core_1.Component({selector:"activitytimeline-add-tabcontainer",template:"<div #container></div>"}),__metadata("design:paramtypes",[services_1.metadata])],e)}();exports.ActivityTimelineAddTabContainer=ActivityTimelineAddTabContainer;var ActivityTimelineItem=function(){function ActivityTimelineItem(e,t,i,s,a,o,l,n,d){this.model=e,this.modelattachments=t,this.metadata=i,this.view=s,this.userpreferences=a,this.session=o,this.language=l,this.activitiytimeline=n,this.cdref=d,this.activity={},this.showtoolset=!0,this.formFieldSet="",this.isopen=!1,this.componentconfig={},this.subscriptions=new rxjs_1.Subscription,this.view.isEditable=!1,this.view.displayLabels=!0,this.isopen=!!n&&n.openness}return ActivityTimelineItem.prototype.ngOnInit=function(){this.model.id=this.activity.id,this.model.data=this.activity.data,this.model.module=this.activity.module,this.displayattachments&&(this.modelattachments.module=this.model.module,this.modelattachments.id=this.model.id);var e=this.metadata.getComponentConfig("ActivityTimelineItem",this.model.module);this.headerFieldSet=this.componentconfig.headerfieldset||e.headerfieldset,this.subheaderFieldSet=this.componentconfig.subheaderfieldset||e.subheaderfieldset,this.formFieldSet=this.componentconfig.fieldset},ActivityTimelineItem.prototype.ngAfterViewInit=function(){var t=this;this.activitiytimeline&&this.subscriptions.add(this.activitiytimeline.openness$.subscribe(function(e){t.isopen=e,t.cdref.detectChanges()})),this.subscriptions.add(this.modelattachments.loaded$.subscribe(function(e){t.cdref.detectChanges()}))},ActivityTimelineItem.prototype.ngOnDestroy=function(){this.subscriptions.unsubscribe()},Object.defineProperty(ActivityTimelineItem.prototype,"actionset",{get:function(){return this.componentconfig.actionset},enumerable:!1,configurable:!0}),Object.defineProperty(ActivityTimelineItem.prototype,"displayattachments",{get:function(){return this.componentconfig.displayattachments},enumerable:!1,configurable:!0}),Object.defineProperty(ActivityTimelineItem.prototype,"hasattachments",{get:function(){return this.componentconfig.displayattachments&&0<this.modelattachments.count},enumerable:!1,configurable:!0}),ActivityTimelineItem.prototype.attachmentsloaded=function(){this.cdref.detectChanges()},Object.defineProperty(ActivityTimelineItem.prototype,"subject",{get:function(){var e=this.model.getField("summary_text");return e||"-- no subject --"},enumerable:!1,configurable:!0}),Object.defineProperty(ActivityTimelineItem.prototype,"starttime",{get:function(){var e=new moment.utc(this.activity.date_activity).tz(this.session.getSessionData("timezone")||moment.tz.guess(!0));return e?e.format(this.userpreferences.getTimeFormat()):""},enumerable:!1,configurable:!0}),Object.defineProperty(ActivityTimelineItem.prototype,"startdate",{get:function(){var e=new moment.utc(this.activity.date_activity).tz(this.session.getSessionData("timezone")||moment.tz.guess(!0));return e?e.format(this.userpreferences.getDateFormat()):""},enumerable:!1,configurable:!0}),Object.defineProperty(ActivityTimelineItem.prototype,"activitiyDate",{get:function(){var e=new moment.utc(this.activity.date_activity).tz(this.session.getSessionData("timezone")||moment.tz.guess(!0)),t=e.format("YYYYMMDD")==(new moment).format("YYYYMMDD"),i=e.format("YYYY")==(new moment).format("YYYY");return t?e.format(this.userpreferences.getTimeFormat()):i?e.format("MMM D"):e.format(this.userpreferences.getDateFormat())},enumerable:!1,configurable:!0}),Object.defineProperty(ActivityTimelineItem.prototype,"isToday",{get:function(){var e=(new moment.utc).tz(this.session.getSessionData("timezone"));return"Activities"==this.module&&new moment.utc(this.activity.date_activity).tz(this.session.getSessionData("timezone")).isSame(e,"day")},enumerable:!1,configurable:!0}),Object.defineProperty(ActivityTimelineItem.prototype,"isPast",{get:function(){var e=(new moment.utc).tz(this.session.getSessionData("timezone"));return"Activities"==this.module&&new moment.utc(this.activity.date_activity).tz(this.session.getSessionData("timezone")).isBefore(e,"day")},enumerable:!1,configurable:!0}),Object.defineProperty(ActivityTimelineItem.prototype,"cantexpand",{get:function(){return!this.formFieldSet},enumerable:!1,configurable:!0}),Object.defineProperty(ActivityTimelineItem.prototype,"enableDetail",{get:function(){return this.model.checkAccess("detail")},enumerable:!1,configurable:!0}),ActivityTimelineItem.prototype.goDetail=function(){this.enableDetail&&this.model.goDetail()},ActivityTimelineItem.prototype.toggleexpand=function(){this.isopen=!this.isopen,this.isopen&&this.componentconfig.displayattachments&&!this.modelattachments.loaded&&this.modelattachments.getAttachments()},__decorate([core_1.Input(),__metadata("design:type",Object)],ActivityTimelineItem.prototype,"activity",void 0),__decorate([core_1.Input(),__metadata("design:type",Boolean)],ActivityTimelineItem.prototype,"showtoolset",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],ActivityTimelineItem.prototype,"module",void 0),__decorate([core_1.Component({selector:"activitytimeline-item",template:'<div class="slds-timeline__item_expandable slds-p-vertical--none" [ngClass]="{\'slds-is-open\': isopen}"><div class="slds-media"><div class="slds-media__figure"><button class="slds-button slds-button_icon" (click)="toggleexpand()" [ngClass]="{\'slds-hidden\': cantexpand}" [disabled]="cantexpand"><system-button-icon icon="switch" addclasses="slds-timeline__details-action-icon"></system-button-icon></button><system-icon [module]="model.module" [title]="language.getModuleName(model.module, true)" size="small" divClass="slds-icon_container slds-timeline__icon"></system-icon></div><div class="slds-media__body"><div class="slds-grid slds-grid_align-spread slds-timeline__trigger"><div class="slds-grow slds-grid slds-grid_vertical-align-center slds-truncate_container_75 slds-no-space slds-text-title_bold" [system-view-provider]="{displayLabels: false}"><h3 class="slds-truncate slds-grid slds-grid--vertical-align-center"><div *ngIf="displayattachments" class="slds-p-horizontal--xx-small"><system-dynamic-component *ngIf="displayattachments" component="SpiceAttachmentsCount"></system-dynamic-component></div><object-record-fieldset-horizontal-list *ngIf="headerFieldSet; else noheaderfieldset" [fieldset]="headerFieldSet"></object-record-fieldset-horizontal-list><ng-template #noheaderfieldset><div system-model-popover>{{subject}}</div></ng-template></h3></div><div style="border-radius: 10px; height: 18px;" class="slds-timeline__date slds-p-horizontal--x-small slds-theme--shade" [title]="startdate + \' \' + starttime" [ngClass]="{\'slds-theme--error\' : isPast, \'slds-theme--warning\' : isToday}"><div class="slds-align--absolute-center">{{activitiyDate}}</div></div><div class="slds-timeline__actions slds-timeline__actions_inline"><object-action-menu class="slds-show--medium" *ngIf="showtoolset" [buttonsize]="\'x-small\'" [actionset]="actionset"></object-action-menu></div></div><div class="slds-m-horizontal_xx-small" [system-view-provider]="{displayLabels: false}"><object-record-fieldset-horizontal-list *ngIf="subheaderFieldSet" [fieldset]="subheaderFieldSet"></object-record-fieldset-horizontal-list></div><article *ngIf="isopen" class="slds-box slds-timeline__item_details slds-theme_shade slds-m-top_x-small slds-m-horizontal_xx-small"><object-record-fieldset [fieldset]="formFieldSet" direction="vertical" fielddisplayclass="slds-truncate" fieldpadding="none"></object-record-fieldset><system-dynamic-component *ngIf="hasattachments" component="SpiceAttachmentsList"></system-dynamic-component></article></div></div><object-action-menu class="slds-hide--medium" *ngIf="showtoolset" [buttonsize]="\'x-small\'" [actionset]="actionset"></object-action-menu></div>',providers:[services_1.model,services_1.modelattachments,services_1.view],changeDetection:core_1.ChangeDetectionStrategy.OnPush}),__param(7,core_1.Optional()),__metadata("design:paramtypes",[services_1.model,services_1.modelattachments,services_1.metadata,services_1.view,services_1.userpreferences,services_1.session,services_1.language,services_1.activitiytimeline,core_1.ChangeDetectorRef])],ActivityTimelineItem)}();exports.ActivityTimelineItem=ActivityTimelineItem;var ActivityTimelineStencil=function(){function e(){}return __decorate([core_1.Component({selector:"activitytimeline-stencil",template:'<div class="slds-timeline__item_expandable slds-timeline__item_email"><div class="slds-media"><div class="slds-media__figure"><button class="slds-button slds-button_icon"><system-button-icon icon="switch" addclasses="slds-timeline__details-action-icon"></system-button-icon></button><system-icon icon="generic_loading" size="small" divClass="slds-icon_container slds-icon-standard-email slds-timeline__icon"></system-icon></div><div class="slds-media__body"><div class="slds-grid slds-grid_align-spread slds-timeline__trigger"><div class="slds-grid slds-grid_vertical-align-center slds-truncate_container_75 slds-no-space"><h3 class="slds-truncate"><system-stencil></system-stencil></h3></div><div class="slds-timeline__actions slds-timeline__actions_inline"><p class="slds-timeline__date"><system-stencil></system-stencil></p><button class="slds-button slds-button--icon-border-filled slds-button--icon-x-small" disabled><system-button-icon icon="down"></system-button-icon></button></div></div><p class="slds-m-horizontal_xx-small"><system-stencil></system-stencil></p></div></div></div>'})],e)}();exports.ActivityTimelineStencil=ActivityTimelineStencil;var ActivityTimelineAddContainer=function(){function ActivityTimelineAddContainer(e,t,i,s,a,o){var l=this;this.model=e,this.language=t,this.activitiytimeline=i,this.metadata=s,this.elementRef=a,this.renderer=o,this.currenttab="",this.tabs=[],this.moreOpen=!1,this.moreModules=[],this.resizeListener=this.renderer.listen("window","resize",function(e){l.handleOverflow()})}return ActivityTimelineAddContainer.prototype.ngOnInit=function(){var e=this.metadata.getComponentConfig("ActivityTimelineAddContainer",this.model.module);if(e&&e.componentset){for(var t=0,i=this.metadata.getComponentSetObjects(e.componentset);t<i.length;t++){var s=i[t];s.componentconfig.module&&this.metadata.checkModuleAcl(s.componentconfig.module,"edit")&&this.tabs.push({module:s.componentconfig.module,component:s.component,componentconfig:s.componentconfig})}this.currenttab=this.tabs[0].module}else e&&e.tabs&&0<e.tabs.length&&(this.tabs=e.tabs,this.currenttab=e.tabs[0].module)},ActivityTimelineAddContainer.prototype.ngAfterViewInit=function(){this.handleOverflow()},ActivityTimelineAddContainer.prototype.ngOnDestroy=function(){this.resizeListener()},ActivityTimelineAddContainer.prototype.handleOverflow=function(){var s=this;this.moreModules=[],this.maintabs.forEach(function(e){e.element.nativeElement.classList.remove("slds-hide"),e.element.nativeElement.classList.add("slds-hidden")}),this.moretab.element.nativeElement.classList.add("slds-hidden"),this.moretab.element.nativeElement.classList.remove("slds-hide");var a=this.elementRef.nativeElement.getBoundingClientRect().width,o=this.moretab.element.nativeElement.getBoundingClientRect().width,l=!1,n=0;this.maintabs.forEach(function(e,t){var i=e.element.nativeElement.getBoundingClientRect().width;a-o<(n+=i)&&(l||t+1<s.maintabs.length||o<i)&&(e.element.nativeElement.classList.add("slds-hide"),s.moreModules.push(e.element.nativeElement.attributes.getNamedItem("data-module").value),l=!0),e.element.nativeElement.classList.remove("slds-hidden")}),l?(this.moretab.element.nativeElement.classList.remove("slds-hidden"),this.moretabs.forEach(function(e){0<=s.moreModules.indexOf(e.element.nativeElement.attributes.getNamedItem("data-module").value)?e.element.nativeElement.classList.remove("slds-hide"):e.element.nativeElement.classList.add("slds-hide")})):(this.moretab.element.nativeElement.classList.remove("slds-hidden"),this.moretab.element.nativeElement.classList.add("slds-hide"))},ActivityTimelineAddContainer.prototype.setTab=function(e){this.currenttab=e},ActivityTimelineAddContainer.prototype.checkTab=function(e){return this.currenttab==e},Object.defineProperty(ActivityTimelineAddContainer.prototype,"moreactive",{get:function(){return 0<=this.moreModules.indexOf(this.currenttab)},enumerable:!1,configurable:!0}),ActivityTimelineAddContainer.prototype.tabClass=function(e){return this.currenttab==e.module?"slds-show":"slds-hide"},ActivityTimelineAddContainer.prototype.toggleOpen=function(){this.moreOpen=!this.moreOpen},__decorate([core_1.ViewChildren("maintabs",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.QueryList)],ActivityTimelineAddContainer.prototype,"maintabs",void 0),__decorate([core_1.ViewChildren("moretabs",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.QueryList)],ActivityTimelineAddContainer.prototype,"moretabs",void 0),__decorate([core_1.ViewChild("moretab",{read:core_1.ViewContainerRef,static:!1}),__metadata("design:type",core_1.ViewContainerRef)],ActivityTimelineAddContainer.prototype,"moretab",void 0),__decorate([core_1.Component({selector:"activitytimeline-add-container",template:'<div class="slds-tabs--scoped" [ngClass]="{\'slds-hide\': tabs.length == 0}"><ul class="slds-tabs--scoped__nav" role="tablist"><li #maintabs *ngFor="let tab of tabs" class="slds-tabs--scoped__item" [ngClass]="{\'slds-active\': checkTab(tab.module)}" role="presentation" [attr.data-module]="tab.module"><a class="slds-tabs--scoped__link" href="javascript:void(0);" role="tab" (click)="setTab(tab.module)"><system-label-modulename [module]="tab.module" [singular]="true"></system-label-modulename></a></li><li #moretab class="slds-tabs_scoped__item slds-tabs_scoped__overflow-button slds-dropdown-trigger slds-dropdown-trigger_click" [ngClass]="{\'slds-is-open\': moreOpen, \'slds-active\': moreactive}" (click)="toggleOpen()" role="presentation"><a class="slds-tabs--scoped__link" href="javascript:void(0);" role="tab"><system-label label="LBL_MORE"></system-label><system-utility-icon class="slds-p-horizontal--xx-small" icon="down" size="x-small"></system-utility-icon></a><div class="slds-dropdown slds-dropdown_right"><ul class="slds-dropdown__list slds-dropdown_length-with-icon-10" role="menu"><li #moretabs *ngFor="let tab of tabs" class="slds-dropdown__item" role="presentation" [attr.data-module]="tab.module" (click)="setTab(tab.module)"><a href="javascript:void(0);" role="menuitem"><span class="slds-truncate"><system-utility-icon icon="check" size="x-small" class="slds-p-right--xx-small" [ngClass]="{\'slds-hidden\': !checkTab(tab.module)}"></system-utility-icon><system-label-modulename [module]="tab.module" [singular]="true"></system-label-modulename></span></a></li></ul></div></li></ul><div *ngFor="let tab of tabs" class="slds-tabs--scoped__content slds-p-around--none" [ngClass]="tabClass(tab)" role="tabpanel" [hidden]="!checkTab(tab.module)"><activitytimeline-add-tabcontainer [tabcomponent]="tab.component" [componentconfig]="tab.componentconfig"></activitytimeline-add-tabcontainer></div></div><ng-template *ngIf="tabs.length == 0"><div class="slds-box slds-theme--shade slds-align--absolute-center">no actions configured</div></ng-template>'}),__metadata("design:paramtypes",[services_1.model,services_1.language,services_1.activitiytimeline,services_1.metadata,core_1.ElementRef,core_1.Renderer2])],ActivityTimelineAddContainer)}();exports.ActivityTimelineAddContainer=ActivityTimelineAddContainer;var ActivityTimelineAddItem=function(){function ActivityTimelineAddItem(e,t,i,s,a,o,l,n){this.metadata=e,this.activitiytimeline=t,this.model=i,this.view=s,this.language=a,this.modal=o,this.dockedComposer=l,this.ViewContainerRef=n,this.componentconfig={},this.headerFieldSet="",this.bodyFieldSet="",this.utilityButtonsPosition="bottom",this.isExpanded=!1,this.canExpand=!1,this.canDock=!1}return ActivityTimelineAddItem.prototype.ngOnInit=function(){var t=this;this.model.module=this.module,this.parentSubscription=this.activitiytimeline.parent.data$.subscribe(function(e){e.id==t.model.data.parent_id&&(t.model.data.parent_name=e.summary_text)}),this.view.isEditable=!0,this.view.setEditMode(),this.headerFieldSet=this.componentconfig.headerfieldset,this.bodyFieldSet=this.componentconfig.bodyfieldset,this.componentconfig.utilitybuttonsposition&&(this.utilityButtonsPosition=this.componentconfig.utilitybuttonsposition),this.checkCanExpand(),this.checkCanDock()},ActivityTimelineAddItem.prototype.ngOnDestroy=function(){this.parentSubscription&&this.parentSubscription.unsubscribe()},Object.defineProperty(ActivityTimelineAddItem.prototype,"module",{get:function(){return this.componentconfig.module},enumerable:!1,configurable:!0}),Object.defineProperty(ActivityTimelineAddItem.prototype,"actionset",{get:function(){return this.componentconfig.actionset},enumerable:!1,configurable:!0}),Object.defineProperty(ActivityTimelineAddItem.prototype,"allowattachments",{get:function(){return!0===this.componentconfig.allowattachments},enumerable:!1,configurable:!0}),ActivityTimelineAddItem.prototype.initializeModule=function(){this.model.module=this.module,this.model.id=void 0,this.model.initializeModel(this.activitiytimeline.parent)},ActivityTimelineAddItem.prototype.onHeaderClick=function(){this.isExpanded||(this.isExpanded=!0,this.initializeModule(),this.model.startEdit(!1))},ActivityTimelineAddItem.prototype.checkCanExpand=function(){this.canExpand=!_.isEmpty(this.metadata.getComponentConfig("GlobalDockedComposerModal",this.model.module))},ActivityTimelineAddItem.prototype.expand=function(){this.dockedComposer.addComposer(this.model.module,this.model,!0),this.isExpanded=!1,this.initializeModule()},ActivityTimelineAddItem.prototype.checkCanDock=function(){this.canDock=!_.isEmpty(this.metadata.getComponentConfig("GlobalDockedComposer",this.model.module))},ActivityTimelineAddItem.prototype.dock=function(){this.dockedComposer.addComposer(this.model.module,this.model),this.isExpanded=!1,this.initializeModule()},ActivityTimelineAddItem.prototype.cancel=function(){this.model.cancelEdit(),this.isExpanded=!1,this.initializeModule()},ActivityTimelineAddItem.prototype.handleaction=function(e){this.initializeModule(),this.view.setEditMode(),this.isExpanded=!1},__decorate([core_1.Component({selector:"activitytimeline-add-item",template:'<div><div class="slds-p-horizontal--xx-small slds-float_right" *ngIf="isExpanded && utilityButtonsPosition==\'top\'"><button class="slds-button slds-button_icon" (click)="cancel()" [title]="language.getLabel(\'LBL_CANCEL\')"><system-button-icon icon="close" size="medium"></system-button-icon><span class="slds-assistive-text"><system-label label="LBL_CANCEL"></system-label></span></button> <button class="slds-button slds-button_icon" [disabled]="!canExpand" (click)="expand()" [title]="language.getLabel(\'LBL_EXPAND\')"><system-button-icon icon="expand"></system-button-icon><span class="slds-assistive-text"><system-label label="LBL_EXPAND"></system-label></span></button> <button class="slds-button slds-button_icon" [disabled]="!canDock" (click)="dock()" [title]="language.getLabel(\'LBL_DOCK\')"><system-button-icon icon="dock_panel"></system-button-icon><span class="slds-assistive-text"><system-label label="LBL_DOCK"></system-label></span></button></div><div class="slds-p-horizontal--xx-small" (click)="onHeaderClick()"><object-record-fieldset [fieldset]="headerFieldSet"></object-record-fieldset></div><div class="slds-p-horizontal--xx-small" *ngIf="isExpanded"><object-record-fieldset [fieldset]="bodyFieldSet" [direction]="\'vertical\'"></object-record-fieldset><system-dynamic-component *ngIf="allowattachments" component="SpiceAttachmentsPanel"></system-dynamic-component><div class="slds-p-vertical--x-small slds-grid"><div class="slds-button-group" role="group" *ngIf="utilityButtonsPosition!=\'top\'"><button class="slds-button slds-button--neutral" (click)="cancel()" [title]="language.getLabel(\'LBL_CANCEL\')"><system-button-icon icon="close"></system-button-icon><span class="slds-assistive-text"><system-label label="LBL_CANCEL"></system-label></span></button> <button class="slds-button slds-button--neutral" [disabled]="!canExpand" (click)="expand()" [title]="language.getLabel(\'LBL_EXPAND\')"><system-button-icon icon="expand"></system-button-icon><span class="slds-assistive-text"><system-label label="LBL_EXPAND"></system-label></span></button> <button class="slds-button slds-button--neutral" [disabled]="!canDock" (click)="dock()" [title]="language.getLabel(\'LBL_DOCK\')"><system-button-icon icon="dock_panel"></system-button-icon><span class="slds-assistive-text"><system-label label="LBL_DOCK"></system-label></span></button></div><div class="slds-col--bump-left slds-grid slds-grid--vertical-align-center"><object-record-messages-badge side="right"></object-record-messages-badge><object-action-container [actionset]="actionset" (actionemitter)="handleaction($event)"></object-action-container></div></div></div></div>',providers:[services_1.model,services_1.view]}),__metadata("design:paramtypes",[services_1.metadata,services_1.activitiytimeline,services_1.model,services_1.view,services_1.language,services_1.modal,services_1.dockedComposer,core_1.ViewContainerRef])],ActivityTimelineAddItem)}(),ActivityTimelineAddEmail=function(m){function ActivityTimelineAddEmail(e,t,i,s,a,o,l,n,d,r){var c=m.call(this,e,t,i,s,a,o,l,n)||this;return c.metadata=e,c.activitiytimeline=t,c.model=i,c.view=s,c.language=a,c.modal=o,c.dockedComposer=l,c.ViewContainerRef=n,c.backend=d,c.session=r,c.formFields=[],c.formFieldSet="",c}return __extends(ActivityTimelineAddEmail,m),Object.defineProperty(ActivityTimelineAddEmail.prototype,"canSend",{get:function(){var e=this.model.getField("recipient_addresses");return!!e&&e.some(function(e){return"to"==e.address_type})},enumerable:!1,configurable:!0}),ActivityTimelineAddEmail.prototype.ngOnInit=function(){this.model.module="Emails",this.setEditMode(),this.subscribeParent(),this.getFieldsetFields()},ActivityTimelineAddEmail.prototype.initializeEmail=function(){this.model.id=this.model.generateGuid(),this.model.initializeModel(),this.model.startEdit(),this.model.data.parent_type=this.activitiytimeline.parent.module,this.model.data.parent_id=this.activitiytimeline.parent.id,this.model.data.parent_name=this.activitiytimeline.parent.data.summary_text,this.model.data.type="out",this.model.data.status="created",this.model.data.recipient_addresses=[],this.model.data.from_addr_name=this.session.authData.email},ActivityTimelineAddEmail.prototype.subscribeParent=function(){var i=this;this.activitiytimeline.parent.data$.subscribe(function(e){var t;0==(null===(t=i.model.data.recipient_addresses)||void 0===t?void 0:t.length)&&i.determineRecipientAddress(),e.id==i.model.data.parent_id&&(i.model.data.parent_name=e.summary_text)})},ActivityTimelineAddEmail.prototype.setEditMode=function(){this.view.isEditable=!0,this.view.setEditMode()},ActivityTimelineAddEmail.prototype.getFieldsetFields=function(){var e=this.metadata.getComponentConfig("ActivityTimelineAddEmail",this.model.module);this.formFieldSet=e.fieldset,this.formFields=this.metadata.getFieldSetItems(e.fieldset)},ActivityTimelineAddEmail.prototype.onFocus=function(){this.isExpanded||(this.isExpanded=!0,this.initializeEmail(),this.determineRecipientAddress(),this.setEditMode())},ActivityTimelineAddEmail.prototype.determineRecipientAddress=function(){this.activitiytimeline.parent.data.email1&&(this.model.data.recipient_addresses=[{parent_type:this.activitiytimeline.parent.module,parent_id:this.activitiytimeline.parent.id,email_address:this.activitiytimeline.parent.data.email1,id:this.model.generateGuid(),address_type:"to"}])},ActivityTimelineAddEmail.prototype.send=function(){var t=this;this.canSend&&(this.model.getField("name")||this.model.getField("body")?this.save():this.modal.prompt("confirm",this.language.getLabel("LBL_EMAIL_SEND_EMPTY",null,"long"),this.language.getLabel("LBL_EMAIL_SEND_EMPTY")).subscribe(function(e){e&&t.save()}))},ActivityTimelineAddEmail.prototype.save=function(){var e=this;this.model.data.to_be_sent=!0,this.model.save().subscribe(function(){e.isExpanded=!1,e.model.data.to_be_sent=!1,e.initializeEmail(),e.determineRecipientAddress(),e.model.endEdit()})},__decorate([core_1.Component({selector:"activitytimeline-add-email",template:'<div class="slds-p-around--xx-small" [system-overlay-loading-spinner]="model.isSaving"><div class="slds-form-element slds-p-horizontal--xx-small" (click)="onFocus()"><field-container field="name"></field-container></div><ng-container *ngIf="isExpanded"><object-record-fieldset [fieldset]="formFieldSet" [direction]="\'vertical\'"></object-record-fieldset><system-dynamic-component component="SpiceAttachmentsPanel"></system-dynamic-component><div class="slds-p-vertical--x-small slds-grid"><div class="slds-button-group" role="group"><button class="slds-button slds-button--neutral" (click)="cancel()" [title]="language.getLabel(\'LBL_CANCEL\')"><system-button-icon icon="close"></system-button-icon><span class="slds-assistive-text"><system-label label="LBL_CANCEL"></system-label></span></button> <button class="slds-button slds-button--neutral" (click)="expand()" [title]="language.getLabel(\'LBL_EXPAND\')"><system-button-icon icon="expand"></system-button-icon><span class="slds-assistive-text"><system-label label="LBL_EXPAND"></system-label></span></button> <button class="slds-button slds-button--neutral" (click)="dock()" [title]="language.getLabel(\'LBL_DOCK\')"><system-button-icon icon="dock_panel"></system-button-icon><span class="slds-assistive-text"><system-label label="LBL_DOCK"></system-label></span></button></div><div class="slds-col--bump-left slds-grid slds-grid--vertical-align-center"><object-record-messages-badge side="right"></object-record-messages-badge><button class="slds-button slds-button--brand .slds-button-space-left slds-float--right" [disabled]="!canSend" (click)="send()"><system-label label="LBL_SEND"></system-label></button></div></div></ng-container></div>',providers:[services_1.model,services_1.view]}),__metadata("design:paramtypes",[services_1.metadata,services_1.activitiytimeline,services_1.model,services_1.view,services_1.language,services_1.modal,services_1.dockedComposer,core_1.ViewContainerRef,services_1.backend,services_1.session])],ActivityTimelineAddEmail)}(exports.ActivityTimelineAddItem=ActivityTimelineAddItem);exports.ActivityTimelineAddEmail=ActivityTimelineAddEmail;var ActivityTimelineSummary=function(){function ActivityTimelineSummary(e,t,i,s,a,o){var l=this;this.metadata=e,this.parent=t,this.language=i,this.activitiytimeline=s,this.navigationtab=a,this.layout=o,this.componentconfig=this.metadata.getComponentConfig("ActivityTimelineSummary"),this.componentconfig.usefts&&(this.activitiytimeline.usefts=!0),this.subscription=this.activitiytimeline.loading$.subscribe(function(e){return l.clearActivitiy()})}return ActivityTimelineSummary.prototype.ngOnInit=function(){this.initialize(this.navigationtab.activeRoute.params)},ActivityTimelineSummary.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},Object.defineProperty(ActivityTimelineSummary.prototype,"activities",{get:function(){return this.activitiytimeline.activities.History.list},enumerable:!1,configurable:!0}),Object.defineProperty(ActivityTimelineSummary.prototype,"displayDetailsPane",{get:function(){return"small"!=this.layout.screenwidth},enumerable:!1,configurable:!0}),Object.defineProperty(ActivityTimelineSummary.prototype,"searchterm",{get:function(){return this.activitiytimeline.filters.searchterm},set:function(e){this.activitiytimeline.filters.searchterm=e,this.activitiytimeline.reload()},enumerable:!1,configurable:!0}),ActivityTimelineSummary.prototype.reload=function(){this.activitiytimeline.reload()},ActivityTimelineSummary.prototype.initialize=function(e){var t=this;this.parent.module=e.module,this.parent.id=e.id,this.parent.getData(!0,"",!0).subscribe(function(e){t.navigationtab.setTabInfo({displayname:t.parent.getField("summary_text")+" • "+t.language.getModuleName("History"),displaymodule:"History"})}),this.activitiytimeline.parent=this.parent,this.activitiytimeline.defaultLimit=25,this.activitiytimeline.modules=["History"],this.activitiytimeline.reload()},ActivityTimelineSummary.prototype.onScroll=function(e){var t=this.listContainer.element.nativeElement;t.scrollTop+t.clientHeight+50>t.scrollHeight&&this.activitiytimeline.canLoadMore("History")&&this.activitiytimeline.getMoreTimeLineData("History",20)},ActivityTimelineSummary.prototype.setActivitiy=function(e){this.activitymodule=e.module,this.activityid=e.id,this.activitydata=e.data},ActivityTimelineSummary.prototype.clearActivitiy=function(){this.activitymodule="",this.activityid="",this.activitydata=""},ActivityTimelineSummary.prototype.goModel=function(){this.parent.goDetail()},ActivityTimelineSummary.prototype.goModule=function(){this.parent.goModule()},__decorate([core_1.ViewChild("listContainer",{read:core_1.ViewContainerRef,static:!0}),__metadata("design:type",core_1.ViewContainerRef)],ActivityTimelineSummary.prototype,"listContainer",void 0),__decorate([core_1.Component({template:'<div class="slds-page-header slds-grid slds-grid--align-spread"><div class="slds-col"><nav role="navigation" aria-label="Breadcrumbs"><ol class="slds-breadcrumb slds-list_horizontal slds-wrap"><li class="slds-breadcrumb__item slds-text-title_caps"><a href="javascript:void(0);" (click)="goModule()"><system-label-modulename [module]="parent.module"></system-label-modulename></a></li><li class="slds-breadcrumb__item slds-text-title_caps"><a href="javascript:void(0);" (click)="goModel()">{{parent.data.summary_text}}</a></li><li class="slds-breadcrumb__item slds-text-title_caps"><span class="slds-p-horizontal--x-small"><system-label-modulename [module]="\'History\'"></system-label-modulename></span></li></ol></nav><div class="slds-col slds-align-bottom slds-p-top--xxx-small"><activity-timeline-summary-aggregates module="History"></activity-timeline-summary-aggregates></div></div><div class="slds-page-header__col-actions slds-grid"><system-input-delayed *ngIf="componentconfig.usefts" [(ngModel)]="searchterm" delay="1000"></system-input-delayed><div class="slds-page-header__controls"><div class="slds-page-header__control"><activity-timeline-filter class="slds-align--absolute-center slds-button slds-button--icon slds-button--icon-border-filled"></activity-timeline-filter></div></div><div class="slds-page-header__controls"><div class="slds-page-header__control"><button class="slds-button slds-button--icon slds-button--icon-border-filled"><system-button-icon icon="refresh" (click)="reload()"></system-button-icon></button></div></div></div></div><div class="slds-grid"><div #listContainer system-to-bottom class="slds-size--1-of-1 slds-medium-size--1-of-3 slds-border--right slds-scrollable" (scroll)="onScroll($event)"><ul class="slds-timeline" [ngClass]="{\'slds-hide\': activitiytimeline.activities.History.loading}"><li class="slds-p-around--x-small" *ngFor="let activity of activities" (click)="setActivitiy(activity)" [ngClass]="{\'slds-theme--default slds-border--bottom slds-border--top\' : activity.id == activityid}"><activitytimeline-item-container [activity]="activity"></activitytimeline-item-container></li></ul><ul class="slds-timeline" *ngIf="activitiytimeline.activities.History.loading"><li class="slds-p-around--x-small"><activitytimeline-stencil></activitytimeline-stencil></li><li style="opacity: 0.8" class="slds-p-around--x-small"><activitytimeline-stencil></activitytimeline-stencil></li><li style="opacity: 0.6" class="slds-p-around--x-small"><activitytimeline-stencil></activitytimeline-stencil></li><li style="opacity: 0.4" class="slds-p-around--x-small"><activitytimeline-stencil></activitytimeline-stencil></li><li style="opacity: 0.2" class="slds-p-around--x-small"><activitytimeline-stencil></activitytimeline-stencil></li></ul></div><div *ngIf="displayDetailsPane" class="slds-size--2-of-3" system-to-bottom><activity-timeline-summary-item-view *ngIf="activitymodule" [module]="activitymodule" [id]="activityid" [data]="activitydata"></activity-timeline-summary-item-view></div></div>',providers:[services_1.activitiytimeline,services_1.model]}),__metadata("design:paramtypes",[services_1.metadata,services_1.model,services_1.language,services_1.activitiytimeline,services_1.navigationtab,services_1.layout])],ActivityTimelineSummary)}();exports.ActivityTimelineSummary=ActivityTimelineSummary;var ActivityTimelineAggregates=function(){function e(e,t,i){this.metadata=e,this.language=t,this.activitiytimeline=i,this.labellength="default"}return Object.defineProperty(e.prototype,"moduleaggregates",{get:function(){return this.module&&this.activitiytimeline.activities[this.module].aggregates.module?this.activitiytimeline.activities[this.module].aggregates.module:[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"yearaggregates",{get:function(){return this.module&&this.activitiytimeline.activities[this.module].aggregates.year?this.activitiytimeline.activities[this.module].aggregates.year:[]},enumerable:!1,configurable:!0}),e.prototype.getElementStyle=function(e){if(!this.activitiytimeline.checkModuleActive(e))return{filter:"grayscale(100%)",opacity:"0.5"}},e.prototype.toggleModuleFilter=function(e){this.activitiytimeline.toggleModuleFilter(e),this.metadata.getModuleDefs(e).ftsactivities.Activities&&this.activitiytimeline.getTimeLineData("Activities"),this.metadata.getModuleDefs(e).ftsactivities.History&&this.activitiytimeline.getTimeLineData("History")},__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"module",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"labellength",void 0),__decorate([core_1.Component({selector:"activity-timeline-aggregates",template:'<div class="slds-grid slds-box--border"><div class="slds-size--1-of-2 slds-p-around--x-small slds-border--right"><div *ngFor="let aggregate of moduleaggregates" class="slds-grid slds-grid--vertical-align-center slds-p-vertical--xxx-small slds-gutters_direct-xxx-small" [ngStyle]="getElementStyle(aggregate.module)" (click)="toggleModuleFilter(aggregate.module)"><div class="slds-p-right--small"><system-icon [title]="language.getModuleName(aggregate.module)" [module]="aggregate.module" size="xx-small" divClass="slds-align--absolute-center"></system-icon></div><div class="slds-p-right--small">{{aggregate.count}}</div><div><system-label-modulename [module]="aggregate.module"></system-label-modulename></div></div></div><div class="slds-size--1-of-2 slds-p-around--x-small"><div *ngFor="let aggregate of yearaggregates" class="slds-grid slds-grid--vertical-align-center slds-p-vertical--xxx-small slds-gutters_direct-xxx-small"><div class="slds-p-right--small">{{aggregate.year}}:</div><div>{{aggregate.count}}</div></div></div></div>'}),__metadata("design:paramtypes",[services_1.metadata,services_1.language,services_1.activitiytimeline])],e)}();exports.ActivityTimelineAggregates=ActivityTimelineAggregates;var ActivityTimelineSummaryItemView=function(){function e(e,t,i,s,a,o){this.metadata=e,this.parent=t,this.model=i,this.language=s,this.activitiytimeline=a,this.activatedRoute=o,this.componentRefs=[]}return e.prototype.ngOnChanges=function(){var i=this;this.model.module=this.module,this.model.id=this.id,this.model.data=this.data;for(var e=0,t=this.componentRefs;e<t.length;e++)t[e].destroy();var s=this.metadata.getComponentConfig("ActivityTimelineSummary",this.module);if(s&&s.componentsets)for(var a=0,o=s.componentsets;a<o.length;a++)for(var l=o[a],n=this,d=0,r=this.metadata.getComponentSetObjects(l);d<r.length;d++)!function(t){n.metadata.addComponent(t.component,n.detailContainer).subscribe(function(e){e.instance.componentconfig=t.componentconfig,i.componentRefs.push(e)})}(r[d])},__decorate([core_1.ViewChild("detailContainer",{read:core_1.ViewContainerRef,static:!0}),__metadata("design:type",core_1.ViewContainerRef)],e.prototype,"detailContainer",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"module",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"id",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"data",void 0),__decorate([core_1.Component({selector:"activity-timeline-summary-item-view",template:'<div class="slds-border_bottom slds-p-around--medium slds-theme--shade"><div class="slds-grid"><div class="slds-col slds-has-flexi-truncate"><div class="slds-media slds-no-space slds-grow"><system-icon [module]="model.module"></system-icon><div class="slds-media__body"><p class="slds-text-title--caps slds-line-height--reset"><system-label-modulename [module]="model.module"></system-label-modulename></p><div><h1 class="slds-page-header__title slds-m-right--small slds-align-middle slds-truncate">{{model.data.name}}</h1></div></div></div></div></div></div><div class="slds-p-around--xx-small"><div #detailContainer></div></div>',providers:[services_1.model]}),__metadata("design:paramtypes",[services_1.metadata,services_1.model,services_1.model,services_1.language,services_1.activitiytimeline,router_1.ActivatedRoute])],e)}();exports.ActivityTimelineSummaryItemView=ActivityTimelineSummaryItemView;var ActivityTimelineSummaryButton=function(){function e(e,t,i,s){this.model=e,this.language=t,this.router=i,this.navigationtab=s}return e.prototype.displaySummary=function(){var e,t="";null!==(e=this.navigationtab)&&void 0!==e&&e.tabid&&(t="/tab/"+this.navigationtab.tabid),this.router.navigate([t+"/module/"+this.model.module+"/historysummary/"+this.model.id])},__decorate([core_1.Component({selector:"activitytimeline-summary-button",template:'<button class="slds-button slds-button--neutral slds-is-absolute" style="right:.5rem; top:-3px;" type="button" (click)="displaySummary()"><system-label label="LBL_SUMMARY"></system-label></button>'}),__param(3,core_1.Optional()),__metadata("design:paramtypes",[services_1.model,services_1.language,router_1.Router,services_1.navigationtab])],e)}();exports.ActivityTimelineSummaryButton=ActivityTimelineSummaryButton;var ActivityTimelineSummaryAggregates=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),__decorate([core_1.Component({selector:"activity-timeline-summary-aggregates",template:'<ul class="slds-list_horizontal slds-has-dividers_right"><li *ngFor="let aggregate of moduleaggregates" class="slds-item slds-grid slds-grid--vertical-align-center" [ngStyle]="getElementStyle(aggregate.module)" (click)="toggleModuleFilter(aggregate.module)"><div class="slds-p-right--xxx-small"><system-icon [title]="language.getModuleName(aggregate.module)" [module]="aggregate.module" size="xx-small" divClass="slds-align--absolute-center"></system-icon></div><div class="slds-p-right--xxx-small">{{aggregate.count}}</div><div><system-label-modulename [module]="aggregate.module"></system-label-modulename></div></li><li *ngFor="let aggregate of yearaggregates" class="slds-item slds-grid slds-grid--vertical-align-center"><div class="slds-p-right--xxx-small">{{aggregate.year}}:</div><div>{{aggregate.count}}</div></li></ul>'})],t)}(ActivityTimelineAggregates);exports.ActivityTimelineSummaryAggregates=ActivityTimelineSummaryAggregates;var fieldActivityDate=function(m){function fieldActivityDate(e,t,i,s,a,o,l,n,d,r){var c=m.call(this,e,t,s,a,o)||this;return c.model=e,c.view=t,c.broadcast=i,c.language=s,c.metadata=a,c.router=o,c.elementRef=l,c.renderer=n,c.modal=d,c.userpreferences=r,c.subscribeToDataChange(),c}return __extends(fieldActivityDate,m),fieldActivityDate.prototype.ngOnInit=function(){m.prototype.ngOnInit.call(this),this.setFormattedValue()},fieldActivityDate.prototype.subscribeToDataChange=function(){var i=this;this.subscriptions.add(this.model.data$.subscribe(function(e){var t;e[i.fieldname]&&!moment(null===(t=i.cachedValue)||void 0===t?void 0:t.raw).isSame(e[i.fieldname])&&i.setFormattedValue()}))},fieldActivityDate.prototype.setFormattedValue=function(){var e,t,i;this.value&&(this.cachedValue={raw:this.value},e=new moment(this.value),t=moment(e.format("YYYY M D")).isSame((new moment).format("YYYY M D")),i=e.isSame(new moment,"year"),this.cachedValue.formatted=t?e.format(this.userpreferences.getTimeFormat()):i?e.format("MMM D"):e.format(this.userpreferences.getDateFormat()))},__decorate([core_1.Component({selector:"field-activity-date",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig">{{cachedValue.formatted}}</field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control slds-p-around--xx-small" [ngClass]="css_classes"><div class="slds-grid"><system-input-date [(ngModel)]="value" class="slds-size--1-of-2 slds-p-right--xxx-small"></system-input-date><system-input-time [(ngModel)]="value" class="slds-size--1-of-2 slds-p-left--xxx-small"></system-input-time></div><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.broadcast,services_1.language,services_1.metadata,router_1.Router,core_1.ElementRef,core_1.Renderer2,services_1.modal,services_1.userpreferences])],fieldActivityDate)}(objectfields_1.fieldGeneric);exports.fieldActivityDate=fieldActivityDate;var ModuleActivities=function(){function ModuleActivities(){}return __decorate([core_1.NgModule({imports:[common_1.CommonModule,forms_1.FormsModule,objectfields_1.ObjectFields,globalcomponents_1.GlobalComponents,objectcomponents_1.ObjectComponents,systemcomponents_1.SystemComponents,directives_1.DirectivesModule],declarations:[TasksManagerView,TasksManagerTasks,TasksManagerTask,TasksManagerTaskDetails,TasksAssitantTileClose,ActivityTimelineSaveButton,ActionActivityCloseButton,ActionActivityCloseCreateButton,ActivityCloseModal,ActivityCloseCreateModal,ActivitiesPopoverAddBar,ActivitiesPopoverAddBarButton,fieldActivitiesAddActions,fieldActivitiesAddActionsButton,fieldActivitiesTaskWithCloseCheckbox,fieldActivityParticipationPanel,fieldActivityReminder,ActivityParticipationPanel,ActivityParticipationPanelHeader,ActivityParticipationPanelParticipant,ActivityParticipationStatus,fieldActivityParticipationStatus,fieldActivityCurrentUserParticipationStatus,ActivityTimeline,ActivityTimelineTabbed,ActivityTimelineDropZoneWrapper,ActivityTimelineFilter,ActivityTimelineContainer,ActivityTimelineItemContainer,ActivityTimelineAddTabContainer,ActivityTimelineItem,ActivityTimelineStencil,ActivityTimelineAddContainer,ActivityTimelineAddItem,ActivityTimelineAddEmail,ActivityTimelineSummary,ActivityTimelineAggregates,ActivityTimelineSummaryItemView,ActivityTimelineSummaryButton,ActivityTimelineSummaryAggregates,fieldActivityDate],exports:[ActivityTimelineItemContainer,ActivityTimelineStencil]})],ModuleActivities)}();exports.ModuleActivities=ModuleActivities;