/** 
 * Â© 2015 - 2021 aac services k.s. All rights reserved.
 * release: 2021.02.001
 * date: 2021-07-16 09:05:07
 * build: 2021.02.001.1626419107136
 **/
"use strict";var __decorate=this&&this.__decorate||function(e,t,s,i){var a,o=arguments.length,n=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,s,i);else for(var r=e.length-1;0<=r;r--)(a=e[r])&&(n=(o<3?a(n):3<o?a(t,s,n):a(t,s))||n);return 3<o&&n&&Object.defineProperty(t,s,n),n},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ModuleHome=exports.HomeDashboardSetContainer=exports.HomeDashboard=exports.HomeAssistantFilter=exports.HomeAssistantTile=exports.HomeAssistant=exports.Home=void 0;var common_1=require("@angular/common"),core_1=require("@angular/core"),forms_1=require("@angular/forms"),objectfields_1=require("../../objectfields/objectfields"),globalcomponents_1=require("../../globalcomponents/globalcomponents"),objectcomponents_1=require("../../objectcomponents/objectcomponents"),systemcomponents_1=require("../../systemcomponents/systemcomponents"),directives_1=require("../../directives/directives"),moduleactivities_1=require("../../modules/activities/moduleactivities"),services_1=require("../../services/services"),rxjs_1=require("rxjs"),Home=function(){function Home(e,t,s,i){var a=this;this.broadcast=e,this.navigation=t,this.metadata=s,this.userpreferences=i,this.hasDashboardSet=!1,this.userpreferences.loadPreferences().subscribe(function(e){return a.hasDashboardSet=e.home_dashboardset&&0<e.home_dashboardset.length}),this.navigation.setActiveModule("Home")}return Object.defineProperty(Home.prototype,"displayHomeAssistant",{get:function(){var e=!this.userpreferences.toUse.home_assistant||"hidden"==this.userpreferences.toUse.home_assistant;return 1024<window.innerWidth&&!e},enumerable:!1,configurable:!0}),__decorate([core_1.Component({template:'<div *ngIf="displayHomeAssistant" class="slds-grid"><div class="slds-col slds-large-size--3-of-4 slds-medium-size--1-of-2"><ng-container *ngIf="hasDashboardSet; else homeDashboardContainer"><home-dashboardset-container></home-dashboardset-container></ng-container></div><div class="slds-col slds-large-size--1-of-4 slds-medium-size--1-of-2"><home-assistant></home-assistant></div></div><div *ngIf="!displayHomeAssistant" class="slds-grid"><div class="slds-col slds-size--1-of-1"><ng-container *ngIf="hasDashboardSet; else homeDashboardContainer"><home-dashboardset-container></home-dashboardset-container></ng-container></div></div><ng-template #homeDashboardContainer><home-dashboard></home-dashboard></ng-template>'}),__metadata("design:paramtypes",[services_1.broadcast,services_1.navigation,services_1.metadata,services_1.userpreferences])],Home)}();exports.Home=Home;var HomeAssistant=function(){function HomeAssistant(e,t,s){this.assistant=e,this.navigationtab=t,this.language=s,this.navigationtab.setTabInfo({displayname:this.language.getLabel("LBL_ASSISTANT"),displaymodule:"Home"})}return HomeAssistant.prototype.reload=function(e){e.stopPropagation(),this.assistant.loadItems()},Object.defineProperty(HomeAssistant.prototype,"loading",{get:function(){return this.assistant.loading},enumerable:!1,configurable:!0}),Object.defineProperty(HomeAssistant.prototype,"noActivities",{get:function(){return!this.assistant.loading&&0==this.assistant.assitantItems.length},enumerable:!1,configurable:!0}),HomeAssistant.prototype.trackByFn=function(e,t){return t.id},__decorate([core_1.Component({selector:"home-assistant",template:'<div class="slds-grid slds-theme--default slds-grid--vertical slds-nowrap slds-border--left slds-border--right"><div class="slds-p-around--small"><div class="slds-grid slds-grid--align-spread slds-has-flexi-truncate slds-grid--vertical-align-center"><h1 class="slds-page-header__title slds-m-right--small slds-align-middle slds-truncate"><system-label label="LBL_ASSISTANT"></system-label></h1><div class="slds-shrink-none"><home-assistant-filter></home-assistant-filter><system-utility-icon [icon]="\'refresh\'" [size]="\'xx-small\'" (click)="reload($event)" [title]="language.getLabel(\'LBL_REFRESH\')"></system-utility-icon></div></div></div><div system-to-bottom><div *ngIf="noActivities" class="slds-align--absolute-center slds-height_full"><system-illustration-no-task class="slds-p-around--medium"></system-illustration-no-task></div><ul class="slds-timeline"><li *ngFor="let item of assistant.filteredItems" class="slds-p-around--xx-small"><activitytimeline-item-container module="Activities" [activity]="item"></activitytimeline-item-container></li></ul><ul *ngIf="loading" class="slds-timeline"><li class="slds-p-around--xx-small"><activitytimeline-stencil></activitytimeline-stencil></li><li style="opacity: 0.8" class="slds-p-around--xx-small"><activitytimeline-stencil></activitytimeline-stencil></li><li style="opacity: 0.6" class="slds-p-around--xx-small"><activitytimeline-stencil></activitytimeline-stencil></li><li style="opacity: 0.4" class="slds-p-around--xx-small"><activitytimeline-stencil></activitytimeline-stencil></li><li style="opacity: 0.2" class="slds-p-around--xx-small"><activitytimeline-stencil></activitytimeline-stencil></li></ul></div></div>'}),__metadata("design:paramtypes",[services_1.assistant,services_1.navigationtab,services_1.language])],HomeAssistant)}();exports.HomeAssistant=HomeAssistant;var HomeAssistantTile=function(){function HomeAssistantTile(e,t,s,i){this.language=e,this.model=t,this.view=s,this.metadata=i,this.item={},this.tileFields=[],this.actionset="",s.isEditable=!1}return HomeAssistantTile.prototype.ngOnInit=function(){var e=this.metadata.getComponentConfig("HomeAssistantTile",this.item.module);e&&e.fieldset&&(this.tileFields=this.metadata.getFieldSetFields(e.fieldset)),e&&e.actionset&&(this.actionset=e.actionset),this.model.module=this.item.module,this.model.id=this.item.id,this.model.data=this.item.data},HomeAssistantTile.prototype.goDetail=function(){this.model.goDetail()},__decorate([core_1.Input(),__metadata("design:type",Object)],HomeAssistantTile.prototype,"item",void 0),__decorate([core_1.Component({selector:"home-assistant-tile",template:'<article class="slds-tile slds-media slds-p-around--x-small slds-border--bottom"><system-icon [module]="item.module" [size]="\'small\'"></system-icon><div class="slds-media__body"><div class="slds-grid slds-grid_align-spread slds-has-flexi-truncate slds-p-bottom--xx-small"><h3 class="slds-tile__title slds-truncate" system-model-popover><a href="javascript:void(0);" (click)="goDetail()">{{item.data.summary_text}}</a></h3><div class="slds-shrink-none"><object-actionset-menu [buttonsize]="\'x-small\'" [actionset]="actionset"></object-actionset-menu></div></div><div class="slds-tile__detail"><dl class="slds-list_horizontal slds-wrap"><ng-container *ngFor="let tileField of tileFields"><dt class="slds-item--label slds-text-color--weak slds-truncate"><system-label-fieldname [module]="model.module" [field]="tileField.field"></system-label-fieldname></dt><dd class="slds-item--detail slds-truncate"><field-container [field]="tileField.field" [fieldconfig]="tileField.fieldconfig" [fielddisplayclass]="\'slds-truncate\'"></field-container></dd></ng-container></dl></div></div></article>',providers:[services_1.model,services_1.view]}),__metadata("design:paramtypes",[services_1.language,services_1.model,services_1.view,services_1.metadata])],HomeAssistantTile)}();exports.HomeAssistantTile=HomeAssistantTile;var HomeAssistantFilter=function(){function e(e,t,s,i,a){this.renderer=e,this.elementRef=t,this.language=s,this.metadata=i,this.assistant=a,this.isOpen=!1}return Object.defineProperty(e.prototype,"activityTypes",{get:function(){return this.assistant.activityTypes},enumerable:!1,configurable:!0}),e.prototype.toggleOpen=function(e){var t=this;e.stopPropagation(),this.isOpen=!this.isOpen,this.isOpen?this.clickListener=this.renderer.listen("document","click",function(e){return t.onClick(e)}):this.clickListener&&this.clickListener()},e.prototype.onClick=function(e){this.elementRef.nativeElement.contains(e.target)||(this.isOpen=!1,this.clickListener())},Object.defineProperty(e.prototype,"filterColorClass",{get:function(){return 0<this.assistant.assistantFilters.objectfilters.length||"all"!=this.assistant.assistantFilters.timefilter?"slds-icon-text-error":"slds-icon-text-default"},enumerable:!1,configurable:!0}),e.prototype.setFilter=function(e,t){"all"==e?this.assistant.assistantFilters.objectfilters=[]:t?this.assistant.assistantFilters.objectfilters.push(e):(e=this.assistant.assistantFilters.objectfilters.indexOf(e),this.assistant.assistantFilters.objectfilters.splice(e,1))},e.prototype.getChecked=function(e){return"all"==e?0==this.assistant.assistantFilters.objectfilters.length:0<=this.assistant.assistantFilters.objectfilters.indexOf(e)},e.prototype.closeDialog=function(){this.clickListener&&this.clickListener(),this.isOpen=!1},__decorate([core_1.Component({selector:"home-assistant-filter",template:'<div class="slds-dropdown-trigger slds-dropdown-trigger_click slds-p-horizontal--xxx-small" [ngClass]="{\'slds-is-open\': isOpen}"><system-utility-icon icon="filterList" size="xx-small" (click)="toggleOpen($event)" [colorclass]="filterColorClass" [title]="language.getLabel(\'LBL_FILTER\')"></system-utility-icon><div class="slds-is-absolute slds-dropdown slds-dropdown_right slds-nubbin_top-right" style="right:-15px;top:25px;"><div class="slds-grid"><div class="slds-p-horizontal--small slds-border--right" style="min-width: 120px"><div class="slds-p-vertical--x-small"><system-label label="LBL_TYPE"></system-label></div><div class="slds-form-element slds-p-vertical--xx-small"><system-checkbox [disabled]="getChecked(\'all\')" [ngModel]="getChecked(\'all\')" (ngModelChange)="setFilter(\'all\', $event)"><system-label label="LBL_ALL"></system-label></system-checkbox></div><div class="slds-form-element slds-p-vertical--xx-small" *ngFor="let activityType of activityTypes"><system-checkbox [ngModel]="getChecked(activityType)" (ngModelChange)="setFilter(activityType, $event)"><system-label-modulename [module]="activityType"></system-label-modulename></system-checkbox></div></div><div class="slds-p-horizontal--small" style="min-width: 120px"><div class="slds-p-vertical--x-small"><system-label label="LBL_FILTER"></system-label></div><fieldset class="slds-form-element"><div class="slds-form-element__control"><system-input-radio name="filters" value="all" [(ngModel)]="assistant.assistantFilters.timefilter"><system-label label="LBL_ALL"></system-label></system-input-radio><system-input-radio name="filters" value="overdue" [(ngModel)]="assistant.assistantFilters.timefilter"><system-label label="LBL_OVERDUE"></system-label></system-input-radio><system-input-radio name="filters" value="today" [(ngModel)]="assistant.assistantFilters.timefilter"><system-label label="LBL_TODAY"></system-label></system-input-radio></div></fieldset></div></div></div></div>'}),__metadata("design:paramtypes",[core_1.Renderer2,core_1.ElementRef,services_1.language,services_1.metadata,services_1.assistant])],e)}();exports.HomeAssistantFilter=HomeAssistantFilter;var HomeDashboard=function(){function HomeDashboard(e,t,s,i){var a=this;this.broadcast=e,this.metadata=t,this.language=s,this.userpreferences=i,this.componentSubscriptions=[],this.dashboardid="",this.dashboardcontainercomponent=void 0,this.componentSubscriptions.push(this.broadcast.message$.subscribe(function(e){a.handleMessage(e)})),this.loadDashboardConfig()}return HomeDashboard.prototype.handleMessage=function(e){"applauncher.setrole"===e.messagetype&&this.loadDashboardConfig()},HomeDashboard.prototype.loadDashboardConfig=function(){var e=this.userpreferences.toUse.home_dashboard||void 0,t=this.metadata.getActiveRole();this.dashboardid=e||t.default_dashboard||"",this.dashboardcontainercomponent&&(this.dashboardcontainercomponent.instance.dashboardid=this.dashboardid)},HomeDashboard.prototype.ngAfterViewInit=function(){var t=this;this.metadata.addComponent("DashboardContainer",this.dashboardcontainer).subscribe(function(e){e.instance.dashboardid=t.dashboardid,e.instance.context="Home",t.dashboardcontainercomponent=e})},HomeDashboard.prototype.ngOnDestroy=function(){for(var e=0,t=this.componentSubscriptions;e<t.length;e++)t[e].unsubscribe()},__decorate([core_1.ViewChild("dashboardcontainer",{read:core_1.ViewContainerRef,static:!0}),__metadata("design:type",core_1.ViewContainerRef)],HomeDashboard.prototype,"dashboardcontainer",void 0),__decorate([core_1.Component({selector:"home-dashboard",template:'<div class="slds-theme--shade"><div #dashboardcontainer></div></div>'}),__metadata("design:paramtypes",[services_1.broadcast,services_1.metadata,services_1.language,services_1.userpreferences])],HomeDashboard)}();exports.HomeDashboard=HomeDashboard;var HomeDashboardSetContainer=function(){function e(e,t,s,i,a,o,n,r){this.broadcast=e,this.metadata=t,this.language=s,this.renderer=i,this.backend=a,this.elementRef=o,this.cdr=n,this.userpreferences=r,this.subscriptions=new rxjs_1.Subscription,this.dashboardsList=[],this.isLoading=!1,this._activeDashboardId="",this.subscribeToBroadcast(),this.loadDashboardConfig()}return Object.defineProperty(e.prototype,"activeDashboardId",{get:function(){return this._activeDashboardId},set:function(e){this._activeDashboardId=e,this.renderView()},enumerable:!1,configurable:!0}),e.prototype.ngOnDestroy=function(){this.subscriptions.unsubscribe(),this.resetView()},e.prototype.ngAfterViewInit=function(){this.loadDashboards()},e.prototype.subscribeToBroadcast=function(){var t=this;this.subscriptions.add(this.broadcast.message$.subscribe(function(e){t.handleBroadcastSubscription(e)}))},e.prototype.loadDashboards=function(){var t=this;this.isLoading=!0,this.cdr.detectChanges(),this.loadDashboardSetDashboards().subscribe(function(e){t.isLoading=!1,e&&(t.dashboardsList=_.toArray(e).map(function(e){return{label:e.name,value:e.id}}),0<t.dashboardsList.length&&(t.activeDashboardId=t.dashboardsList[0].value),t.cdr.detectChanges())})},e.prototype.handleBroadcastSubscription=function(e){"applauncher.setrole"===e.messagetype&&this.loadDashboardConfig()},e.prototype.loadDashboardConfig=function(){var e=this.userpreferences.toUse.home_dashboard||void 0,t=this.metadata.getActiveRole();this.activeDashboardId=e||t.default_dashboard||"",this.dashboardContainerComponentRef&&(this.dashboardContainerComponentRef.instance.dashboardid=this.activeDashboardId)},e.prototype.renderView=function(){var t=this;this.resetView(),this.activeDashboardContainer&&this.metadata.addComponent("DashboardContainer",this.activeDashboardContainer).subscribe(function(e){e.instance.dashboardid=t.activeDashboardId,e.instance.context="Home",t.dashboardContainerComponentRef=e})},e.prototype.resetView=function(){this.dashboardContainerComponentRef&&(this.dashboardContainerComponentRef.destroy(),this.dashboardContainerComponentRef=void 0)},e.prototype.loadDashboardSetDashboards=function(){var e=this.userpreferences.toUse.home_dashboardset,t={limit:-99,modulefilter:this.metadata.getComponentConfig("HomeDashboardSetContainer","Home").moduleFilter,sort:{sortfield:"dashboardsets_dashboard_sequence",sortdirection:"ASC"}};return this.backend.getRequest("module/DashboardSets/"+e+"/related/dashboards",t)},__decorate([core_1.ViewChildren("maintabs",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.QueryList)],e.prototype,"maintabs",void 0),__decorate([core_1.ViewChildren("moreTabItems",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.QueryList)],e.prototype,"moreTabItems",void 0),__decorate([core_1.ViewChild("moreTab",{read:core_1.ViewContainerRef,static:!1}),__metadata("design:type",core_1.ViewContainerRef)],e.prototype,"moreTab",void 0),__decorate([core_1.ViewChild("activeDashboardContainer",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.ViewContainerRef)],e.prototype,"activeDashboardContainer",void 0),__decorate([core_1.Component({selector:"home-dashboardset-container",template:'<div><div class="slds-p-around--xx-small slds-scrollable--x slds-border--bottom"><div *ngIf="!isLoading; else isLoadingContainer"><system-input-radio-button-group [inputOptions]="dashboardsList" [(ngModel)]="activeDashboardId"></system-input-radio-button-group></div><ng-template #isLoadingContainer><div class="slds-grid"><div class="slds-p-right--xx-small"><system-stencil style="line-height: 1.6rem"></system-stencil></div><div class="slds-p-right--xx-small"><system-stencil style="line-height: 1.6rem"></system-stencil></div><div class="slds-p-right--xx-small"><system-stencil style="line-height: 1.6rem"></system-stencil></div><div><system-stencil style="line-height: 1.6rem"></system-stencil></div></div></ng-template></div><div #activeDashboardContainer></div></div>'}),__metadata("design:paramtypes",[services_1.broadcast,services_1.metadata,services_1.language,core_1.Renderer2,services_1.backend,core_1.ElementRef,core_1.ChangeDetectorRef,services_1.userpreferences])],e)}();exports.HomeDashboardSetContainer=HomeDashboardSetContainer;var ModuleHome=function(){function ModuleHome(){}return __decorate([core_1.NgModule({imports:[common_1.CommonModule,forms_1.FormsModule,objectfields_1.ObjectFields,globalcomponents_1.GlobalComponents,objectcomponents_1.ObjectComponents,systemcomponents_1.SystemComponents,directives_1.DirectivesModule,moduleactivities_1.ModuleActivities],declarations:[Home,HomeAssistant,HomeAssistantTile,HomeAssistantFilter,HomeDashboard,HomeDashboardSetContainer]})],ModuleHome)}();exports.ModuleHome=ModuleHome;