/** 
 * Â© 2015 - 2021 aac services k.s. All rights reserved.
 * release: 2021.02.001
 * date: 2021-07-16 09:05:07
 * build: 2021.02.001.1626419107136
 **/
"use strict";var __extends=this&&this.__extends||function(){var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,i=1,s=arguments.length;i<s;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},__decorate=this&&this.__decorate||function(e,t,i,s){var r,o=arguments.length,n=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;0<=a;a--)(r=e[a])&&(n=(o<3?r(n):3<o?r(t,i,n):r(t,i))||n);return 3<o&&n&&Object.defineProperty(t,i,n),n},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__spreadArray=this&&this.__spreadArray||function(e,t){for(var i=0,s=t.length,r=e.length;i<s;i++,r++)e[r]=t[i];return e};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ModuleReports=exports.ReporterNewButton=exports.ReporterIntegrationToolsButton=exports.ReporterIntegrationCSVexportButton=exports.ReporterIntegrationTargetlistexportModal=exports.ReporterIntegrationExportMask=exports.ReporterIntegrationTargetlistexportButton=exports.ReporterIntegrationExportButton=exports.FieldReportCategory=exports.ReporterFieldColor=exports.ReporterFieldDateTime=exports.ReporterFieldDate=exports.ReporterFieldEnum=exports.ReporterFieldPercentage=exports.ReporterFieldCurrency=exports.ReporterFieldText=exports.ReporterFieldStandard=exports.ReporterFieldContainer=exports.ReporterCockpitTile=exports.ReporterCockpit=exports.ReporterPresentationDashlet=exports.ReporterPresentationContainer=exports.ReporterVisualizationContainer=exports.ReporterVisualizationDashlet=exports.ReporterDetailVisualizationGooglecharts=exports.ReporterDetailVisualization=exports.ReporterDetailSelectFieldsModal=exports.ReporterDetailPresentationStandard=exports.ReporterFilterItemUserMultiple=exports.ReporterFilterItemUserSingle=exports.ReporterFilterItemFunction=exports.ReporterFilterItemReference=exports.ReporterFilterItemParent=exports.ReporterFilterItemUser=exports.ReporterFilterItemDate=exports.ReporterFilterItemEnum=exports.ReporterFilterItemText=exports.ReporterFilterItem=exports.ReporterFilterSavedFilters=exports.ReporterFilterPanel=exports.ReporterDetailViewEditButton=exports.ReporterDetailViewRefreshButton=exports.ReporterFilterButton=exports.ReporterDetailViewHeader=exports.ReporterDetailView=exports.reporterconfig=void 0;var common_1=require("@angular/common"),core_1=require("@angular/core"),forms_1=require("@angular/forms"),objectfields_1=require("../../objectfields/objectfields"),objectcomponents_1=require("../../objectcomponents/objectcomponents"),systemcomponents_1=require("../../systemcomponents/systemcomponents"),directives_1=require("../../directives/directives"),drag_drop_1=require("@angular/cdk/drag-drop"),services_1=require("../../services/services"),router_1=require("@angular/router"),animations_1=require("@angular/animations"),rxjs_1=require("rxjs"),operators_1=require("rxjs/operators"),platform_browser_1=require("@angular/platform-browser"),reporterconfig=function(){function e(e,t){var i=this;this.configurationService=e,this.backend=t,this.userFilters=[],this.whereFunctions=[],this.defaultUserFilters="",this.operatorCount={},this.operatorTypes={},this.operatorAssignments={},this.refresh$=new core_1.EventEmitter;t=this.configurationService.getData("reporterConfig");t?this.parseConfifg(t):this.backend.getRequest("module/KReports/core/whereoperators/all").subscribe(function(e){i.configurationService.setData("reporterConfig",e),i.parseConfifg(e)}),this.getWhereFunctions()}return e.prototype.getWhereFunctions=function(){var t=this;this.backend.getRequest("module/KReports/core/wherefunctions").subscribe(function(e){t.whereFunctions=e})},e.prototype.parseConfifg=function(e){this.operatorCount=e.operatorCount,this.operatorTypes=e.operatorTypes,this.operatorAssignments=e.operatorAssignments},e.prototype.refresh=function(){this.refresh$.emit(!0)},e.prototype.resetUserFilters=function(){this.userFilters=[],this.defaultUserFilters="[]"},e.prototype.addUserFilter=function(e){this.userFilters.push(e),this.defaultUserFilters=JSON.stringify(this.userFilters)},e.prototype.setDefaultUserFilter=function(){this.userFilters=JSON.parse(this.defaultUserFilters),this.refresh()},e.prototype.setSavedFilter=function(e){for(var i=this,t=0,s=e;t<s.length;t++)!function(t){i.userFilters.some(function(e){if(e.fieldid==t.fieldid)return e.operator=t.operator,e.value=t.value,e.valuekey=t.valuekey,e.valueto=t.valueto,e.valuetokey=t.valuetokey,!0})}(s[t]);this.refresh()},__decorate([core_1.Injectable(),__metadata("design:paramtypes",[services_1.configurationService,services_1.backend])],e)}();exports.reporterconfig=reporterconfig;var REPORTERDETAILVIEWANIMATIONS=[animations_1.trigger("displayfilter",[animations_1.transition(":enter",[animations_1.style({width:"0px",overflow:"hidden"}),animations_1.animate(".5s",animations_1.style({width:"*"})),animations_1.style({overflow:"unset"})]),animations_1.transition(":leave",[animations_1.style({overflow:"hidden"}),animations_1.animate(".5s",animations_1.style({width:"0px"}))])])],ReporterDetailView=function(){function ReporterDetailView(e,t,i,s,r,o,n,a,l,d,c,p){this.broadcast=e,this.language=t,this.metadata=i,this.injector=s,this.model=r,this.backend=o,this.activatedRoute=n,this.navigationtab=a,this.router=l,this.reporterconfig=d,this.cdRef=c,this.view=p,this.presentationComponentRef=void 0,this.hasVisualization=!1,this.visualizationHeight=0,this.whereConditions={},this.integrationParams={},this.showFilters=!1,this.subscriptions=new rxjs_1.Subscription,this.subscribeToBroadcast()}return ReporterDetailView.prototype.ngOnInit=function(){this.setNavigationTabInfos(this.language.getModuleName(this.model.module)),this.setModelData(),this.view.isEditable=this.metadata.checkModuleAcl(this.model.module,"edit")},ReporterDetailView.prototype.ngOnDestroy=function(){this.subscriptions.unsubscribe()},ReporterDetailView.prototype.subscribeToBroadcast=function(){var t=this;this.subscriptions.add(this.broadcast.message$.subscribe(function(e){"model.save"==e.messagetype&&e.messagedata.module==t.model.module&&e.messagedata.id==t.model.id&&(t.showFilters=!1,t.reporterconfig.resetUserFilters(),t.whereConditions=e.messagedata.data.whereconditions,t.setIntegrationParams(e.messagedata.data.integration_params),t.setVisualizationProperties(e.messagedata.data.visualization_params),t.renderPresentation(e.messagedata.data.presentation_params),t.reporterconfig.refresh(),t.cdRef.detectChanges())}))},ReporterDetailView.prototype.setNavigationTabInfos=function(e){this.navigationtab.setTabInfo({displayname:e,displaymodule:this.model.module})},ReporterDetailView.prototype.setModelData=function(){var t=this;this.model.module=this.navigationtab.activeRoute.params.module,this.model.id=this.navigationtab.activeRoute.params.id,this.model.getData(!0,"detailview",!0,!0).subscribe(function(e){t.setNavigationTabInfos(e.summary_text),t.setVisualizationProperties(e.visualization_params),t.reporterconfig.resetUserFilters(),t.whereConditions=e.whereconditions,t.renderPresentation(e.presentation_params),t.setIntegrationParams(e.integration_params),t.cdRef.detectChanges()})},ReporterDetailView.prototype.setIntegrationParams=function(e){this.integrationParams=void 0,e&&(this.integrationParams=e)},ReporterDetailView.prototype.setVisualizationProperties=function(e){this.hasVisualization=!1,e&&e&&e.layout&&"-"!=e.layout&&(this.hasVisualization=!0,this.visualizationHeight=e.chartheight||300)},ReporterDetailView.prototype.renderPresentation=function(e){var t=this;if(this.presentationComponentRef&&(this.presentationComponentRef.destroy(),this.presentationComponentRef=void 0),e){var i="";switch(e.plugin){case"standard":i="ReporterDetailPresentationStandard";break;case"grouped":i="ReporterDetailPresentationGrouped";break;case"standardws":i="ReporterDetailPresentationStandardWS";break;case"tree":i="ReporterDetailPresentationTree";break;case"pivot":i="ReporterDetailPresentationPivot"}""!=i&&this.metadata.addComponent(i,this.presentationContainer).subscribe(function(e){t.presentationComponentRef=e,t.presentationComponentRef.changeDetectorRef.detectChanges()})}},ReporterDetailView.prototype.toggleFilters=function(e){this.showFilters=e},ReporterDetailView.prototype.filterApplied=function(){this.showFilters=!1},__decorate([core_1.ViewChild("presentationContainer",{read:core_1.ViewContainerRef,static:!0}),__metadata("design:type",core_1.ViewContainerRef)],ReporterDetailView.prototype,"presentationContainer",void 0),__decorate([core_1.Component({selector:"reporter-detilview",template:'<div class="slds-grid slds-grid--vertical"><div><reporter-detail-view-header [integrationParams]="integrationParams" [whereConditions]="whereConditions" (showFilters)="toggleFilters($event)"></reporter-detail-view-header></div><div class="slds-is-relative slds-grow" style="min-height: 0"><div *ngIf="hasVisualization" class="slds-size--1-of-1" [style.height.px]="visualizationHeight"><reporter-detail-visualization></reporter-detail-visualization></div><div system-to-bottom-noscroll><div #presentationContainer></div></div><reporter-filter-panel @displayfilter *ngIf="showFilters" class="slds-is-absolute" style="z-index: 100; right: 0; top: 0; bottom: 0" [integrationparams]="integrationParams" (filterapplied)="filterApplied()"></reporter-filter-panel></div></div>',providers:[services_1.view,services_1.model,reporterconfig],animations:REPORTERDETAILVIEWANIMATIONS,changeDetection:core_1.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[services_1.broadcast,services_1.language,services_1.metadata,core_1.Injector,services_1.model,services_1.backend,router_1.ActivatedRoute,services_1.navigationtab,router_1.Router,reporterconfig,core_1.ChangeDetectorRef,services_1.view])],ReporterDetailView)}();exports.ReporterDetailView=ReporterDetailView;var ReporterDetailViewHeader=function(o){function e(e,t,i,s){var r=o.call(this,e,s,i,t)||this;return r.language=e,r.metadata=t,r.model=i,r.router=s,r.whereConditions={},r.integrationParams={},r.showFilters=new core_1.EventEmitter,r}return __extends(e,o),e.prototype.toggleFilters=function(e){this.showFilters.emit(e)},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"whereConditions",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"integrationParams",void 0),__decorate([core_1.Output(),__metadata("design:type",Object)],e.prototype,"showFilters",void 0),__decorate([core_1.Component({selector:"reporter-detail-view-header",template:'<div class="slds-page-header"><div class="slds-grid"><div class="slds-col slds-has-flexi-truncate"><div class="slds-media slds-no-space slds-grow"><system-icon [module]="moduleName" (click)="goToModule()"></system-icon><div class="slds-media__body"><p class="slds-text-title--caps slds-line-height--reset"><a (click)="goToModule()"><system-label-modulename [module]="moduleName"></system-label-modulename></a></p><div><h1 class="slds-page-header__title slds-m-right--small slds-align-middle slds-truncate"><ng-container *ngIf="!fieldset">{{model.data.summary_text}}</ng-container><div *ngIf="fieldset" class="slds-grid" [system-view-provider]="{displayLabels: false, editable: false}"><field-container *ngFor="let fieldsetitem of fieldsetitems" [field]="fieldsetitem.field" [fieldconfig]="fieldsetitem.fieldconfig" fielddisplayclass="slds-p-right--small"></field-container></div></h1></div></div></div></div><div class="slds-m-horizontal--x-small slds-show--medium slds-button-group"><reporter-integration-export-button [integrationParams]="integrationParams"></reporter-integration-export-button><reporter-integration-tools-button [integrationParams]="integrationParams"></reporter-integration-tools-button><reporter-filter-button [whereConditions]="whereConditions" (filter)="toggleFilters($event)"></reporter-filter-button></div><object-action-container [actionset]="actionSet"></object-action-container></div><object-page-header-tags></object-page-header-tags></div>'}),__metadata("design:paramtypes",[services_1.language,services_1.metadata,services_1.model,router_1.Router])],e)}(objectcomponents_1.ObjectPageHeader);exports.ReporterDetailViewHeader=ReporterDetailViewHeader;var ReporterFilterButton=function(){function e(e,t){this.language=e,this.reporterconfig=t,this.whereConditions={},this.hasUserFilters=!1,this.showFilters=!1,this.filter=new core_1.EventEmitter}return e.prototype.ngOnChanges=function(){for(var e=0,t=this.whereConditions;e<t.length;e++){var i=t[e];"yes"==i.usereditable&&(this.reporterconfig.addUserFilter(i),this.hasUserFilters=!0)}},e.prototype.ngOnDestroy=function(){},e.prototype.toggleFilters=function(){this.showFilters=!this.showFilters,this.filter.emit(this.showFilters)},__decorate([core_1.ViewChild("actionitems",{read:core_1.ViewContainerRef,static:!0}),__metadata("design:type",core_1.ViewContainerRef)],e.prototype,"actionitems",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"whereConditions",void 0),__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],e.prototype,"filter",void 0),__decorate([core_1.Component({selector:"reporter-filter-button",template:'<button class="slds-button slds-button--neutral slds-grid slds-grid--vertical-align-center" [disabled]="!hasUserFilters" (click)="toggleFilters()" style="border-top-left-radius: 0;border-bottom-left-radius: 0;"><span><system-label label="LBL_FILTER"></system-label></span><system-button-icon class="slds-p-horizontal--xxx-small" [icon]="\'filterList\'"></system-button-icon></button>'}),__metadata("design:paramtypes",[services_1.language,reporterconfig])],e)}();exports.ReporterFilterButton=ReporterFilterButton;var ReporterDetailViewRefreshButton=function(){function ReporterDetailViewRefreshButton(e,t){this.language=e,this.reporterconfig=t}return ReporterDetailViewRefreshButton.prototype.execute=function(){this.reporterconfig.refresh()},__decorate([core_1.Component({selector:"reporter-detail-view-refresh-button",template:'<span><system-label label="LBL_REFRESH"></system-label></span>'}),__metadata("design:paramtypes",[services_1.language,reporterconfig])],ReporterDetailViewRefreshButton)}();exports.ReporterDetailViewRefreshButton=ReporterDetailViewRefreshButton;var ReporterDetailViewEditButton=function(){function ReporterDetailViewEditButton(e,t,i){this.language=e,this.router=t,this.model=i}return ReporterDetailViewEditButton.prototype.execute=function(){this.disabled||this.router.navigate(["/module/KReports/designer/"+this.model.id])},Object.defineProperty(ReporterDetailViewEditButton.prototype,"disabled",{get:function(){return!(!this.model.data.acl||this.model.checkAccess("edit"))||(this.model.isEditing||this.model.isSaving)},enumerable:!1,configurable:!0}),__decorate([core_1.Component({selector:"reporter-detail-view-edit-button",template:'<span><system-label label="LBL_EDIT"></system-label></span>'}),__metadata("design:paramtypes",[services_1.language,router_1.Router,services_1.model])],ReporterDetailViewEditButton)}();exports.ReporterDetailViewEditButton=ReporterDetailViewEditButton;var REPORTERFILTERPANELANIMATIONS=[animations_1.trigger("animatepopover",[animations_1.transition(":enter",[animations_1.style({opacity:0}),animations_1.animate(".25s",animations_1.style({opacity:1}))]),animations_1.transition(":leave",[animations_1.style({opacity:"1"}),animations_1.animate(".25s",animations_1.style({opacity:0}))])])],ReporterFilterPanel=function(){function e(e,t,i,s,r,o,n){this.model=e,this.language=t,this.elementRef=i,this.toast=s,this.backend=r,this.session=o,this.reporterconfig=n,this.filterapplied=new core_1.EventEmitter,this.integrationparams={},this.showPopover=!1,this.filter={}}return Object.defineProperty(e.prototype,"isAdmin",{get:function(){return!!this.session.authData.admin},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"whereConditions",{get:function(){return this.reporterconfig.userFilters},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"popoverStyle",{get:function(){var e=this.elementRef.nativeElement.getBoundingClientRect(),t=this.popover.element.nativeElement.getBoundingClientRect();return{position:"fixed",top:e.top+(e.height-t.height)/2+"px",left:e.left-t.width+"px"}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"displaySavedFilters",{get:function(){return!!this.integrationparams.activePlugins&&!!this.integrationparams.activePlugins.ksavedfilters},enumerable:!1,configurable:!0}),e.prototype.openPopover=function(){this.showPopover=!0,this.initializeFilter()},e.prototype.closePopover=function(){this.showPopover=!1,this.initializeFilter()},e.prototype.initializeFilter=function(){this.filter={savedfilter_id:this.model.generateGuid(),name:"",isNew:!0,is_global:!1}},e.prototype.applyFilter=function(){this.filterapplied.emit(!0),this.reporterconfig.refresh()},e.prototype.setSelectedFilterId=function(e){this.selectedFilterId=e},e.prototype.handleSave=function(){if(!this.selectedFilterId)return this.openPopover();this.saveFilter(this.selectedFilterId)},e.prototype.saveFilter=function(e,t){var i=this,s=(s={selectedfilters:__assign({},this.reporterconfig.userFilters)})&&__assign(__assign({},t),s);this.backend.postRequest("module/KReports/"+this.model.id+"/savedfilter/"+e,[],s).subscribe(function(e){e&&e.success?(i.toast.sendToast(i.language.getLabel("LBL_DATA_SAVED"),"success"),i.savedFiltersComponent&&(t?i.savedFiltersComponent.pushNewFilter(s):i.savedFiltersComponent.updateFilterData())):i.toast.sendToast(i.language.getLabel("ERR_FAILED_TO_EXECUTE"),"error")})},e.prototype.saveFilterAs=function(){this.selectedFilterId&&this.openPopover()},e.prototype.confirmSave=function(){this.selectedFilterId=void 0,this.saveFilter(this.filter.savedfilter_id,this.filter),this.closePopover()},__decorate([core_1.ViewChild("popover",{read:core_1.ViewContainerRef,static:!0}),__metadata("design:type",core_1.ViewContainerRef)],e.prototype,"popover",void 0),__decorate([core_1.ViewChild("savedFiltersContainer",{static:!1}),__metadata("design:type",Object)],e.prototype,"savedFiltersComponent",void 0),__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],e.prototype,"filterapplied",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"integrationparams",void 0),__decorate([core_1.Component({selector:"reporter-filter-panel",template:'<div class="slds-panel slds-grid slds-grid_vertical slds-nowrap slds-panel_filters slds-height_full" style="width: 500px; box-shadow: 0 10px 10px #888;"><div class="slds-form slds-form_stacked slds-grow slds-scrollable_y slds-grid slds-grid_vertical"><div class="slds-filters"><div class="slds-filters__header slds-grid slds-has-divider_bottom-space"><h2 class="slds-align-middle slds-text-heading_small"><system-label label="LBL_FILTER"></system-label></h2><div class="slds-button-group slds-col_bump-left"><button class="slds-button slds-button--neutral" (click)="applyFilter()"><system-label label="LBL_APPLY"></system-label></button><div class="slds-dropdown-trigger slds-dropdown-trigger_click slds-button_last" system-dropdown-trigger><button class="slds-button slds-button_icon slds-button_icon-border-filled" aria-haspopup="true" [disabled]="!displaySavedFilters" [title]="language.getLabel(\'LBL_MORE\')"><system-button-icon icon="down"></system-button-icon><span class="slds-assistive-text"><system-label label="LBL_MORE"></system-label></span></button><div class="slds-dropdown slds-dropdown_right slds-dropdown_actions"><ul class="slds-dropdown__list" role="menu"><li class="slds-dropdown__item" role="presentation"><a href="javascript:void(0);" role="menuitem" tabindex="0" (click)="handleSave()"><span class="slds-truncate"><system-label label="LBL_SAVE"></system-label></span></a></li><li class="slds-dropdown__item" role="presentation"><a href="javascript:void(0);" role="menuitem" tabindex="-1" (click)="saveFilterAs()"><span class="slds-truncate" [class.slds-disabled-text]="!selectedFilterId"><system-label label="LBL_SAVE_AS"></system-label></span></a></li></ul></div></div></div></div><div *ngIf="displaySavedFilters" class="slds-filters__header slds-has-divider_bottom-space"><reporter-filter-saved-filters #savedFiltersContainer [reportId]="model.id" (selectFilterChange)="setSelectedFilterId($event)"></reporter-filter-saved-filters></div><div class="slds-filters__body"><reporter-filter-item *ngFor="let whereCondition of whereConditions" [wherecondition]="whereCondition"></reporter-filter-item></div></div></div></div><div #popover [ngStyle]="popoverStyle"><div *ngIf="showPopover" @animatepopover class="slds-popover slds-nubbin--right" role="dialog"><div class="slds-popover__body"><fieldset class="slds-form--stacked"><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_NAME"></system-label></label><div class="slds-form-element__control"><input type="text" [(ngModel)]="filter.name" class="slds-input"></div></div><div *ngIf="isAdmin" class="slds-m-top--small"><system-checkbox [(ngModel)]="filter.is_global"><system-label label="LBL_GLOBAL"></system-label></system-checkbox></div></fieldset><div class="slds-text-align--right slds-p-top--x-small"><button type="button" class="slds-button slds-button--brand slds-button-space-left" (click)="confirmSave()"><system-label label="LBL_SAVE"></system-label></button> <button type="button" class="slds-button slds-button--neutral slds-button-space-left" (click)="closePopover()"><system-label label="LBL_CLOSE"></system-label></button></div></div></div></div>',animations:REPORTERFILTERPANELANIMATIONS}),__metadata("design:paramtypes",[services_1.model,services_1.language,core_1.ElementRef,services_1.toast,services_1.backend,services_1.session,reporterconfig])],e)}();exports.ReporterFilterPanel=ReporterFilterPanel;var ReporterFilterSavedFilters=function(){function e(e,t,i,s,r){this.metadata=e,this.model=t,this.language=i,this.reporterconfig=s,this.backend=r,this.selectFilterChange=new core_1.EventEmitter,this.reportId="",this._selectedFilterId="",this.savedFilters=[]}return Object.defineProperty(e.prototype,"selectedFilter",{get:function(){return this._selectedFilterId},set:function(t){var i=this;this._selectedFilterId=t,0==this._selectedFilterId.length?(this.reporterconfig.setDefaultUserFilter(),this.selectFilterChange.emit(null)):(this.selectFilterChange.emit(t),this.savedFilters.some(function(e){if(e.savedfilter_id==t)return i.reporterconfig.setSavedFilter(JSON.parse(e.selectedfilters)),!0}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDisabled",{get:function(){return 0==this.savedFilters.length},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){var t=this;this.backend.getRequest("module/KReports/"+this.reportId+"/savedfilters",{assigneduserid:"own"}).subscribe(function(e){t.savedFilters=e})},e.prototype.pushNewFilter=function(e){e.selectedfilters=JSON.stringify(e.selectedfilters),e.is_global&&(e.name="(G) "+e.name),this.savedFilters.push(e),this.selectedFilter=e.savedfilter_id},e.prototype.updateFilterData=function(){var t=this;this.savedFilters.some(function(e){if(t.selectedFilter==e.savedfilter_id)return e.selectedfilters=JSON.stringify(t.reporterconfig.userFilters),!0})},__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],e.prototype,"selectFilterChange",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"reportId",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"_selectedFilterId",void 0),__decorate([core_1.Component({selector:"reporter-filter-saved-filters",template:'<div><div class="slds-form-element"><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="selectedFilter" [disabled]="isDisabled"><option>---</option><option *ngFor="let savedFilter of savedFilters" [value]="savedFilter.savedfilter_id">{{savedFilter.name}}</option></select></div></div></div></div>'}),__metadata("design:paramtypes",[services_1.metadata,services_1.model,services_1.language,reporterconfig,services_1.backend])],e)}();exports.ReporterFilterSavedFilters=ReporterFilterSavedFilters;var ReporterFilterItem=function(){function e(e,t,i){this.language=e,this.model=t,this.reporterconfig=i,this.wherecondition={}}return e.prototype.getOperators=function(){for(var e=[],t=this.reporterconfig.operatorAssignments[this.wherecondition.type]||"varchar",i=0,s=this.reporterconfig.operatorTypes[t];i<s.length;i++){var r=s[i];e.push({value:r,display:this.language.getLabel("LBL_OP_"+r.toUpperCase())})}return e.sort(function(e,t){return e.display>t.display?1:-1}),e},Object.defineProperty(e.prototype,"itemType",{get:function(){var e="text";switch(this.wherecondition.type){case"enum":case"multienum":case"radioenum":switch(this.wherecondition.operator){case"equals":case"notequal":case"oneof":case"oneofnot":case"oneofnotornull":e="enum"}break;case"date":case"datetime":case"datetimecombo":switch(this.wherecondition.operator){case"before":case"after":case"between":e="date"}}return e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"showValue",{get:function(){return 0<this.reporterconfig.operatorCount[this.wherecondition.operator]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"showValueTo",{get:function(){return 1<this.reporterconfig.operatorCount[this.wherecondition.operator]},enumerable:!1,configurable:!0}),e.prototype.changeOperator=function(){this.wherecondition.value="",this.wherecondition.valuekey="",this.wherecondition.valueto="",this.wherecondition.valuetokey=""},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"wherecondition",void 0),__decorate([core_1.Component({selector:"reporter-filter-item",template:'<div class="slds-p-bottom--small"><div class="slds-text-heading--label slds-p-bottom--xxx-small"><system-label [label]="wherecondition.name"></system-label></div><div class="slds-form-element slds-p-vertical--xx-small"><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="wherecondition.operator" (change)="changeOperator()"><option value="ignore"><system-label label="LBL_OP_IGNORE"></system-label></option><option *ngFor="let operator of getOperators()" [value]="operator.value">{{operator.display}}</option></select></div></div></div><div class="slds-grid slds-p-vertical--xx-small" *ngIf="showValue"><div [ngSwitch]="itemType" [ngClass]="{\'slds-size--1-of-1\': !showValueTo, \'slds-size--1-of-2\': showValueTo, \'slds-p-right--xxx-small\': showValueTo}"><reporter-filter-item-enum *ngSwitchCase="\'enum\' || \'multienum\' || \'radioenum\'" [field]="\'value\'" [wherecondition]="wherecondition" [isMultiSelect]="wherecondition.operator.includes(\'oneof\')"></reporter-filter-item-enum><reporter-filter-item-date *ngSwitchCase="\'date\'" [field]="\'valuekey\'" [wherecondition]="wherecondition"></reporter-filter-item-date><reporter-filter-item-text *ngSwitchCase="\'text\'" [field]="\'value\'" [wherecondition]="wherecondition"></reporter-filter-item-text></div><div *ngIf="showValueTo" class="slds-size--1-of-2 slds-p-left--xxx-small" [ngSwitch]="itemType"><reporter-filter-item-enum *ngSwitchCase="\'enum\' || \'multienum\' || \'radioenum\'" [field]="\'valueto\'" [wherecondition]="wherecondition"></reporter-filter-item-enum><reporter-filter-item-date *ngSwitchCase="\'date\'" [field]="\'valuetokey\'" [wherecondition]="wherecondition"></reporter-filter-item-date><reporter-filter-item-text *ngSwitchCase="\'text\'" [field]="\'valueto\'" [wherecondition]="wherecondition"></reporter-filter-item-text></div></div></div>'}),__metadata("design:paramtypes",[services_1.language,services_1.model,reporterconfig])],e)}();exports.ReporterFilterItem=ReporterFilterItem;var ReporterFilterItemText=function(){function e(e,t,i){this.language=e,this.model=t,this.reporterconfig=i,this.field="",this.wherecondition={}}return __decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"field",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"wherecondition",void 0),__decorate([core_1.Component({selector:"reporter-filter-item-text",template:'<div class="slds-form-element"><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="wherecondition[field]"></div></div>'}),__metadata("design:paramtypes",[services_1.language,services_1.model,reporterconfig])],e)}();exports.ReporterFilterItemText=ReporterFilterItemText;var ReporterFilterItemEnum=function(){function e(e,t,i){var s=this;this.metadata=e,this.language=t,this.backend=i,this.field="",this.isMultiSelect=!1,this.wherecondition={},this.enumOptions=[],this._value=[],this.subscription=new rxjs_1.Subscription,this.subscription=this.language.currentlanguage$.subscribe(function(){s.getEnumOptions()})}return Object.defineProperty(e.prototype,"isDisabled",{get:function(){return 0==this.enumOptions.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this.isMultiSelect&&(e=(this._value=e).join(",")),this.wherecondition[this.field]=e,this.wherecondition[this.field+"key"]=this.wherecondition[this.field]},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){var e=this.wherecondition.path.split("::"),t=e.length,i=e[t-1].split(":");this.fieldName=i[1];var s=e[t-2].split(":");switch(s[0]){case"root":this.moduleName=s[1];break;case"link":var r=this.metadata.getFieldDefs(s[1],s[2]);this.moduleName=r.module}this.getEnumOptions(),this.initializeValueArray()},e.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},e.prototype.initializeValueArray=function(){var e=this.wherecondition[this.field+"key"]?this.wherecondition[this.field+"key"]:this.wherecondition[this.field];this._value=this.isMultiSelect?e?e.split(","):[]:e},e.prototype.getEnumOptions=function(){var t=this;this.moduleName&&this.fieldName?this.enumOptions=this.language.getFieldDisplayOptions(this.moduleName,this.fieldName,!0):this.backend.getRequest("module/KReports/core/enumoptions",{path:this.wherecondition.path}).subscribe(function(e){e&&0!=e.length&&(t.enumOptions=e.map(function(e){return{value:e.value,display:e.text}}))})},e.prototype.ngOnChanges=function(){this.initializeValueArray()},__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"field",void 0),__decorate([core_1.Input(),__metadata("design:type",Boolean)],e.prototype,"isMultiSelect",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"wherecondition",void 0),__decorate([core_1.Component({selector:"reporter-filter-item-enum",template:'<div class="slds-form-element"><div *ngIf="!isMultiSelect; else checkboxContainer" class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [disabled]="isDisabled" [(ngModel)]="value"><option *ngFor="let enumOption of enumOptions" [value]="enumOption.value">{{enumOption.display}}</option></select></div></div><ng-template #checkboxContainer><system-checkbox-group [(ngModel)]="value" class="slds-grid slds-wrap"><ng-container *ngFor="let enumOption of enumOptions"><div *ngIf="!!enumOption.value" [title]="enumOption.display" class="slds-large-size--1-of-3 slds-medium-size--1-of-1 slds-truncate"><system-checkbox-group-checkbox [value]="enumOption.value"><span class="slds-m-left--xx-small">{{enumOption.display}}</span></system-checkbox-group-checkbox></div></ng-container></system-checkbox-group></ng-template></div>'}),__metadata("design:paramtypes",[services_1.metadata,services_1.language,services_1.backend])],e)}();exports.ReporterFilterItemEnum=ReporterFilterItemEnum;var ReporterFilterItemDate=function(){function e(e,t,i){this.language=e,this.model=t,this.reporterconfig=i,this.field="",this.wherecondition={},this.fieldDate=new moment}return e.prototype.ngOnInit=function(){this.fieldDate=new moment(this.wherecondition[this.field])},Object.defineProperty(e.prototype,"filterValue",{get:function(){return this.fieldDate},set:function(e){this.fieldDate=e,this.wherecondition[this.field]=e.format("YYYY-MM-DD")},enumerable:!1,configurable:!0}),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"field",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"wherecondition",void 0),__decorate([core_1.Component({selector:"reporter-filter-item-date",template:'<div class="slds-form-element"><system-input-date [(ngModel)]="filterValue"></system-input-date></div>'}),__metadata("design:paramtypes",[services_1.language,services_1.model,reporterconfig])],e)}();exports.ReporterFilterItemDate=ReporterFilterItemDate;var ReporterFilterItemUser=function(){function e(){this.whereCondition={}}return Object.defineProperty(e.prototype,"isMultiSelect",{get:function(){switch(this.whereCondition.operator){case"oneof":case"oneofnot":case"oneofnotornull":return!0;default:return!1}},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){var e=this.whereCondition.path.split("::"),e=e[e.length-1].split(":");this.fieldName=e[1]},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"whereCondition",void 0),__decorate([core_1.Component({selector:"reporter-filter-item-user",template:'<div class="slds-grid slds-grid--vertical-align-center"><reporter-filter-item-user-single *ngIf="!isMultiSelect; else multipleSelectContainer" [whereCondition]="whereCondition" [fieldName]="fieldName" class="slds-grid slds-grid--vertical-align-center slds-size--1-of-1"></reporter-filter-item-user-single><ng-template #multipleSelectContainer><reporter-filter-item-user-multiple [whereCondition]="whereCondition" [fieldName]="fieldName" class="slds-grid slds-grid--vertical-align-center slds-size--1-of-1"></reporter-filter-item-user-multiple></ng-template></div>'})],e)}();exports.ReporterFilterItemUser=ReporterFilterItemUser;var ReporterFilterItemParent=function(){function e(e,t,i,s){this.metadata=e,this.language=t,this.backend=i,this.model=s,this.field="",this.wherecondition={},this.fields=[],this.subscription=new rxjs_1.Subscription,this.getEnumOptions()}return Object.defineProperty(e.prototype,"isDisabled",{get:function(){return 0==this.fields.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this.wherecondition[this.field]=e,this.wherecondition[this.field+"key"]=this.wherecondition[this.field]},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){var e=this.wherecondition.path.split("::"),t=e.length,i=e[t-1].split(":");this.fieldName=i[1];var s=e[t-2].split(":");switch(s[0]){case"root":this.moduleName=s[1];break;case"link":var r=this.metadata.getFieldDefs(s[1],s[2]);this.moduleName=r.module}this.getEnumOptions(),this._value=this.wherecondition[this.field+"key"]?this.wherecondition[this.field+"key"]:this.wherecondition[this.field]},e.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},e.prototype.getEnumOptions=function(){this.fields=[];var e,t=this.model.getField("integration_params");for(e in this.metadata.getModuleFields(t.kpublishing.subpanelModule))this.fields.push(e);this.fields.sort()},__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"field",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"wherecondition",void 0),__decorate([core_1.Component({selector:"reporter-filter-item-parent",template:'<div class="slds-form-element"><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [disabled]="isDisabled" [(ngModel)]="value"><option *ngFor="let field of fields" [value]="field">{{field}}</option></select></div></div></div>'}),__metadata("design:paramtypes",[services_1.metadata,services_1.language,services_1.backend,services_1.model])],e)}();exports.ReporterFilterItemParent=ReporterFilterItemParent;var ReporterFilterItemReference=function(){function e(e,t,i){this.language=e,this.reporterConfig=t,this.model=i,this.whereCondition={}}return Object.defineProperty(e.prototype,"referenceField",{get:function(){return this.whereCondition.value},set:function(e){this.whereCondition.value=e,this.whereCondition.valuekey=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"referenceFields",{get:function(){var t=this,e=this.model.getField("whereconditions"),i=this.reporterConfig.operatorAssignments[this.whereCondition.overrideType||this.whereCondition.type]||"varchar";return e.filter(function(e){return!!e.reference&&(t.reporterConfig.operatorAssignments[e.type]||"varchar")==i&&t.whereCondition.fieldid!=e.fieldid})},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){var e=this.whereCondition.path.split("::"),e=e[e.length-1].split(":");this.fieldName=e[1]},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"whereCondition",void 0),__decorate([core_1.Component({selector:"reporter-filter-item-reference",template:'<div class="slds-form-element"><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="referenceField"><option *ngFor="let referenceField of referenceFields" [value]="referenceField.reference"><system-label [label]="referenceField.reference"></system-label></option></select></div></div></div>'}),__metadata("design:paramtypes",[services_1.language,reporterconfig,services_1.model])],e)}();exports.ReporterFilterItemReference=ReporterFilterItemReference;var ReporterFilterItemFunction=function(){function e(e,t){this.language=e,this.reporterconfig=t,this.whereCondition={}}return Object.defineProperty(e.prototype,"functionField",{get:function(){return this.whereCondition.value},set:function(e){this.whereCondition.value=e,this.whereCondition.valuekey=e},enumerable:!1,configurable:!0}),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"whereCondition",void 0),__decorate([core_1.Component({selector:"reporter-filter-item-function",template:'<div class="slds-form-element"><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="functionField"><option *ngFor="let whereFunction of reporterconfig.whereFunctions" [value]="whereFunction.field">{{whereFunction.description}}</option></select></div></div></div>'}),__metadata("design:paramtypes",[services_1.language,reporterconfig])],e)}();exports.ReporterFilterItemFunction=ReporterFilterItemFunction;var ReporterFilterItemUserSingle=function(){function e(e,t,i){this.language=e,this.modal=t,this.session=i,this.whereCondition={},this.activeUserName=""}return Object.defineProperty(e.prototype,"activeUser",{get:function(){return-1<this.whereCondition.value.indexOf("current_user_id")},set:function(e){this.value=e?["current_user_id"]:[""]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.whereCondition.value},set:function(e){e&&0!=e.length&&(this.whereCondition.valuekey=e[0],this.whereCondition.value=e[0])},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){this.activeUserName=this.session.authData.userName},e.prototype.clearField=function(){this.whereCondition.value="",this.whereCondition.valuekey=""},e.prototype.searchWithModal=function(){var t=this;this.modal.openModal("ObjectModalModuleLookup").subscribe(function(e){e.instance.module="Users",e.instance.multiselect=!1,e.instance.selectedItems.subscribe(function(e){e.length&&(t.value=e.map(function(e){return e.user_name}))})})},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"whereCondition",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"fieldName",void 0),__decorate([core_1.Component({selector:"reporter-filter-item-user-single",template:'<div class="slds-form-element slds-grow"><div class="slds-form-element__control slds-size--1-of-1"><div class="slds-combobox_container"><div class="slds-form-element slds-lookup"><div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click" role="combobox"><div *ngIf="!!value; else inputContainer" class="slds-form-element__control"><div class="slds-pill_container"><span class="slds-pill slds-size--1-of-1"><span class="slds-icon_container slds-icon-standard-account slds-pill__icon_container"><system-icon module="Users" size="small"></system-icon></span> <span *ngIf="value != \'current_user_id\'; else currentUserContainer" class="slds-pill__label">{{value}}</span><ng-template #currentUserContainer><span class="slds-pill__label">{{activeUserName}}</span></ng-template><button class="slds-button slds-button--icon slds-pill__remove" (click)="clearField()"><system-button-icon [icon]="\'close\'"></system-button-icon></button></span></div></div><ng-template #inputContainer><div class="slds-form-element__control slds-grid slds-box--border"><div class="slds-input-has-icon slds-input-has-icon--right slds-grow"><input type="text" class="slds-lookup__search-input slds-input--bare slds-theme--default" (focus)="searchWithModal()" [placeholder]="language.getModuleCombinedLabel(\'LBL_SEARCH\', \'Users\')" autocomplete="none" role="combobox"> <button (click)="searchWithModal()" class="slds-button slds-button_icon slds-input__icon slds-input__icon_right"><system-button-icon [icon]="\'search\'"></system-button-icon></button></div></div></ng-template></div></div></div></div></div><system-checkbox [(ngModel)]="activeUser" class="slds-m-left--x-small"><system-label label="LBL_ACTIVE_USER"></system-label></system-checkbox>'}),__metadata("design:paramtypes",[services_1.language,services_1.modal,services_1.session])],e)}();exports.ReporterFilterItemUserSingle=ReporterFilterItemUserSingle;var ReporterFilterItemUserMultiple=function(){function e(e,t,i){this.language=e,this.modal=t,this.session=i,this.whereCondition={},this.activeUserName=""}return Object.defineProperty(e.prototype,"activeUser",{get:function(){return-1<this.whereCondition.value.indexOf("current_user_id")},set:function(e){this.value=e?__spreadArray(__spreadArray([],this.whereCondition.value),["current_user_id"]):this.whereCondition.value.filter(function(e){return"current_user_id"!=e}).slice()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.whereCondition.value},set:function(e){e&&0!=e.length&&(this.whereCondition.value=e,this.whereCondition.valueinit=e.join(","))},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){this.activeUserName=this.session.authData.userName},e.prototype.trackByFn=function(e,t){return t},e.prototype.removeUser=function(t){this.value=this.whereCondition.value.filter(function(e){return e!=t}).slice()},e.prototype.searchWithModal=function(){var t=this;this.modal.openModal("ObjectModalModuleLookup").subscribe(function(e){e.instance.module="Users",e.instance.multiselect=!0,e.instance.selectedItems.subscribe(function(e){e.length&&(t.value=e.map(function(e){return e.user_name}))})})},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"whereCondition",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"fieldName",void 0),__decorate([core_1.Component({selector:"reporter-filter-item-user-multiple",template:'<div class="slds-form-element slds-grow"><div class="slds-form-element__control slds-size--1-of-1"><div class="slds-combobox_container"><div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click" role="combobox"><div class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right" role="none"><div *ngIf="value.length > 0; else inputContainer" class="slds-pill_container"><ul class="slds-listbox slds-listbox_horizontal" role="listbox"><li class="slds-listbox-item" role="presentation" *ngFor="let user of value; trackBy: trackByFn"><span class="slds-pill" role="option"><span class="slds-icon_container"><system-icon module="Users" size="x-small" divClass="slds-p-right--x-small"></system-icon></span> <span *ngIf="user != \'current_user_id\'; else currentUserContainer" class="slds-pill__label">{{user}}</span><ng-template #currentUserContainer><span class="slds-pill__label">{{activeUserName}}</span></ng-template><span class="slds-icon_container slds-pill__remove"><system-button-icon [icon]="\'close\'" (click)="removeUser(user)"></system-button-icon></span></span></li></ul></div><ng-template #inputContainer><div class="slds-form-element__control slds-grid slds-box--border"><div class="slds-input-has-icon slds-input-has-icon--right slds-grow"><input type="text" class="slds-lookup__search-input slds-input--bare slds-theme--default" (focus)="searchWithModal()" [placeholder]="language.getModuleCombinedLabel(\'LBL_SEARCH\', \'Users\')" autocomplete="none" role="combobox"> <button (click)="searchWithModal()" class="slds-button slds-button_icon slds-input__icon slds-input__icon_right"><system-button-icon [icon]="\'search\'"></system-button-icon></button></div></div></ng-template><div class="slds-grow"><button (click)="searchWithModal()" class="slds-button slds-button_icon slds-input__icon slds-input__icon_right"><system-button-icon [icon]="\'search\'"></system-button-icon></button></div></div></div></div></div></div><system-checkbox [(ngModel)]="activeUser" class="slds-m-left--x-small"><system-label label="LBL_ACTIVE_USER"></system-label></system-checkbox>'}),__metadata("design:paramtypes",[services_1.language,services_1.modal,services_1.session])],e)}();exports.ReporterFilterItemUserMultiple=ReporterFilterItemUserMultiple;var ReporterDetailPresentationStandard=function(){function ReporterDetailPresentationStandard(e,t,i,s,r,o,n,a){var l=this;this.language=e,this.model=t,this.modal=i,this.injector=s,this.backend=r,this.reporterconfig=o,this.cdRef=n,this.toast=a,this.presParams={},this.presData={},this.fieldsData={},this.fieldsDisplayClasses={},this.totalWidth=0,this.showFooter=!0,this.isLoading=!0,this.sortData={sortField:"",sortDirection:""},this.displayFields=[],this.currentPage=1,this.subscriptions=new rxjs_1.Subscription,this.subscriptions.add(this.reporterconfig.refresh$.subscribe(function(e){l.getPresentation()}))}return Object.defineProperty(ReporterDetailPresentationStandard.prototype,"listEntries",{get:function(){try{return this.presParams.pluginData.standardViewProperties.listEntries}catch(e){return 25}},enumerable:!1,configurable:!0}),Object.defineProperty(ReporterDetailPresentationStandard.prototype,"displayRecords",{get:function(){var e=(this.currentPage-1)*this.listEntries+1,t=this.currentPage*this.listEntries;return e+" - "+(t>this.presData.count?this.presData.count:t)},enumerable:!1,configurable:!0}),Object.defineProperty(ReporterDetailPresentationStandard.prototype,"canSave",{get:function(){return this.model.checkAccess("edit")},enumerable:!1,configurable:!0}),Object.defineProperty(ReporterDetailPresentationStandard.prototype,"prevDisabled",{get:function(){return this.currentPage<=1},enumerable:!1,configurable:!0}),Object.defineProperty(ReporterDetailPresentationStandard.prototype,"nextDisabled",{get:function(){return this.currentPage*this.listEntries>=this.presData.count},enumerable:!1,configurable:!0}),ReporterDetailPresentationStandard.prototype.ngOnInit=function(){this.presParams=this.model.getField("presentation_params")},ReporterDetailPresentationStandard.prototype.ngAfterViewInit=function(){this.getPresentation()},ReporterDetailPresentationStandard.prototype.ngOnDestroy=function(){this.subscriptions.unsubscribe()},ReporterDetailPresentationStandard.prototype.getPresentation=function(){var r=this;this.isLoading=!0,this.cdRef.detectChanges();for(var e=[],t=0,i=this.reporterconfig.userFilters;t<i.length;t++){var s=i[t];e.push({fieldid:s.fieldid,operator:s.operator,value:s.value,valuekey:s.valuekey,valueto:s.valueto,valuetokey:s.valuetokey})}var o={start:(this.currentPage-1)*this.listEntries,limit:this.listEntries,whereConditions:JSON.stringify(e),parentbeanId:this.model.parentBeanId,parentbeanModule:this.model.parentBeanModule,sort:void 0};this.sortData.sortField&&(o.sort=JSON.stringify([{direction:this.sortData.sortDirection.toUpperCase(),property:this.sortData.sortField}])),this.backend.postRequest("module/KReports/"+this.model.id+"/presentation/dynamicoptions",{},o).subscribe(function(e){if(r.presData=[],r.cdRef.detectChanges(),e){if(0==r.totalWidth)for(var t=0,i=e.reportmetadata.fields;t<i.length;t++){var s=i[t];r.fieldsData[s.fieldid]=s,r.fieldsDisplayClasses[s.fieldid]=r.generateFieldDisplayClass(s),r.totalWidth+=s.width}r.presData=e,r.setDisplayFields(),r.processPresData(),r.isLoading=!1,r.cdRef.detectChanges()}})},ReporterDetailPresentationStandard.prototype.processPresData=function(){},ReporterDetailPresentationStandard.prototype.trackByFn=function(e,t){return t.id},ReporterDetailPresentationStandard.prototype.setDisplayFields=function(){this.displayFields=[],this.cdRef.detectChanges(),this.presData.reportmetadata&&this.presData.reportmetadata.fields&&(this.displayFields=this.presData.reportmetadata.fields.filter(function(e){return"yes"==e.display}).sort(function(e,t){return e.sequence&&t.sequence?parseInt(e.sequence,10)>parseInt(t.sequence,10)?1:-1:0}),this.cdRef.detectChanges())},ReporterDetailPresentationStandard.prototype.generateFieldDisplayClass=function(e){var t=[];switch(e.sort&&"-"!=e.sort&&(t.push("slds-is-sortable"),e.fieldid==this.sortData.sortField&&(t.push("slds-is-sorted"),"asc"==this.sortData.sortDirection&&t.push("slds-is-sorted_asc"))),e.type){case"currency":case"currencyint":t.push("slds-grid--align-end");break;case"enum":case"multienum":case"radioenum":t.push("slds-grid--align-center")}return t.join(" ")},ReporterDetailPresentationStandard.prototype.toggleSort=function(e){"sortable"==e.sort&&(this.sortData.sortField==e.fieldid?"asc"==this.sortData.sortDirection?this.sortData.sortDirection="desc":(this.sortData.sortField="",this.sortData.sortDirection=""):(this.sortData.sortField=e.fieldid,this.sortData.sortDirection="asc"),this.getPresentation())},ReporterDetailPresentationStandard.prototype.onresize=function(){var e,i={},s=0;for(e in this.resizeElements.forEach(function(e){var t=e.getElementWidth();s+=t,i[e.resizeid]=e.getElementWidth()}),this.fieldsData)this.fieldsData.hasOwnProperty(e)&&(this.fieldsData[e].width=Math.round(i[e]/s*100));this.totalWidth=100},ReporterDetailPresentationStandard.prototype.saveLayout=function(){var t=this;if(this.model.checkAccess("edit")){for(var e=[],i=0,s=this.model.getField("listfields").filter(function(e){return"hidden"!=e.display});i<s.length;i++){var r=s[i];e.push({dataIndex:r.fieldid,width:this.fieldsData[r.fieldid].width,sequence:parseInt(this.fieldsData[r.fieldid].sequence,10),isHidden:"yes"!=this.fieldsData[r.fieldid].display})}this.backend.postRequest("module/KReports/"+this.model.id+"/layout",{},{layout:e}).subscribe(function(e){e.success&&t.toast.sendToast("Layout saved")})}},ReporterDetailPresentationStandard.prototype.firstPage=function(){this.currentPage=1,this.getPresentation()},ReporterDetailPresentationStandard.prototype.prevPage=function(){this.currentPage--,this.getPresentation()},ReporterDetailPresentationStandard.prototype.nextPage=function(){this.currentPage++,this.getPresentation()},ReporterDetailPresentationStandard.prototype.lastPage=function(){this.currentPage=Math.ceil(this.presData.count/this.listEntries),this.getPresentation()},ReporterDetailPresentationStandard.prototype.selectFields=function(){var t=this;this.modal.openModal("ReporterDetailSelectFieldsModal",!0,this.injector).subscribe(function(e){e.instance.presentationFields=t.presData.reportmetadata.fields,e.instance.dataChanged$.subscribe(function(e){e&&t.setDisplayFields()})})},__decorate([core_1.ViewChildren(directives_1.SystemResizeDirective),__metadata("design:type",core_1.QueryList)],ReporterDetailPresentationStandard.prototype,"resizeElements",void 0),__decorate([core_1.Component({selector:"reporter-detail-presentation-standard",template:'<div class="slds-height_full slds-grid slds-grid--vertical"><div class="slds-scrollable--y slds-grow slds-grid slds-grid--vertical" style="min-height: 0" [system-overlay-loading-spinner]="isLoading"><table class="slds-table slds-table_bordered slds-table--fixed-layout slds-table--header-fixed"><thead><tr class="slds-text-title--caps"><th *ngFor="let field of displayFields; trackBy: trackByFn" [ngClass]="fieldsDisplayClasses[field.fieldid]" scope="col" class="slds-resizable" [style.width.%]="fieldsData[field.fieldid].width" (system-resize)="onresize()" [resizeid]="field.fieldid"><a *ngIf="!!field.sort && field.sort == \'sortable\'; else notsortable" href="javascript:void(0);" class="slds-th__action slds-text-link--reset slds-grid" (click)="toggleSort(field)" [ngClass]="fieldsDisplayClasses[field.fieldid]"><div class="slds-truncate slds-p-vertical--xx-small"><system-label [label]="field.name"></system-label></div><system-utility-icon *ngIf="!!sortData.sortDirection" icon="arrowdown" [style.transform]="sortData.sortDirection == \'desc\' ? \'rotate(180deg)\' : \'none\'" size="x-small"></system-utility-icon></a><ng-template #notsortable><div class="slds-th__action slds-grid"><div class="slds-truncate"><system-label [label]="field.name"></system-label></div><system-utility-icon *ngIf="!!field.sort && field.sort != \'-\'" icon="arrowdown" [style.transform]="field.sort == \'desc\' ? \'rotate(180deg)\' : \'none\'" size="x-small"></system-utility-icon></div></ng-template></th></tr></thead><tbody><ng-container *ngIf="presData?.records?.length > 0"><tr *ngFor="let record of presData.records; trackBy: trackByFn" style="vertical-align: top;"><td scope="row" *ngFor="let field of displayFields; trackBy: trackByFn"><reporter-field-container [field]="field" [record]="record"></reporter-field-container></td></tr></ng-container></tbody></table><div *ngIf="!isLoading && presData.records?.length == 0" class="slds-p-around--medium slds-align--absolute-center slds-grow" style="min-height: 0"><h2 class="slds-text-heading--small"><system-label label="LBL_NO_ENTRIES"></system-label></h2></div></div><div><div *ngIf="showFooter" class="slds-p-vertical--x-small slds-grid slds-grid_vertical-align-center slds-grid_align-spread"><div class="slds-p-horizontal--medium">{{displayRecords}} of {{presData.count}}</div><div class="slds-p-horizontal--medium"><button class="slds-button slds-button_icon" (click)="firstPage()" [disabled]="prevDisabled"><system-custom-icon icon="chevrondoubleleft" size="x-small"></system-custom-icon></button> <button class="slds-button slds-button_icon" (click)="prevPage()" [disabled]="prevDisabled"><system-button-icon icon="chevronleft"></system-button-icon></button> <button class="slds-button slds-button_icon" (click)="nextPage()" [disabled]="nextDisabled"><system-button-icon icon="chevronright"></system-button-icon></button> <button class="slds-button slds-button_icon" (click)="lastPage()" [disabled]="nextDisabled"><system-custom-icon icon="chevrondoubleright" size="x-small"></system-custom-icon></button> <button class="slds-button slds-button_icon" (click)="selectFields()" system-title="LBL_CHOOSE_FIELDS"><system-button-icon icon="settings"></system-button-icon></button> <button class="slds-button slds-button_icon" *ngIf="canSave" (click)="saveLayout()" system-title="LBL_SAVE_LAYOUT"><system-button-icon icon="save"></system-button-icon></button></div></div></div></div>',changeDetection:core_1.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[services_1.language,services_1.model,services_1.modal,core_1.Injector,services_1.backend,reporterconfig,core_1.ChangeDetectorRef,services_1.toast])],ReporterDetailPresentationStandard)}();exports.ReporterDetailPresentationStandard=ReporterDetailPresentationStandard;var ReporterDetailSelectFieldsModal=function(){function ReporterDetailSelectFieldsModal(e,t){this.metadata=e,this.language=t,this.dataChanged$=new rxjs_1.BehaviorSubject(!1),this.presentationFields=[],this.self={},this.availableFields=[],this.displayFields=[]}return ReporterDetailSelectFieldsModal.prototype.ngOnInit=function(){this.availableFields=this.presentationFields.filter(function(e){return"no"==e.display}),this.displayFields=this.presentationFields.filter(function(e){return"yes"==e.display}),0<this.availableFields.length&&this.sortAvailableFields(),this.displayFields.sort(function(e,t){return e.sequence&&t.sequence?parseInt(e.sequence,10)>parseInt(t.sequence,10)?1:-1:0})},ReporterDetailSelectFieldsModal.prototype.sortAvailableFields=function(){var i=this;this.availableFields=this.availableFields.sort(function(e,t){return i.language.getLabel(e.name).toLowerCase()>i.language.getLabel(t.name).toLowerCase()?1:-1})},ReporterDetailSelectFieldsModal.prototype.close=function(){this.self.destroy()},ReporterDetailSelectFieldsModal.prototype.canSet=function(){return 0<this.displayFields.length},ReporterDetailSelectFieldsModal.prototype.set=function(){if(this.canSet()){for(var e=1,t=0,i=this.displayFields;t<i.length;t++){var s=i[t];s.display="yes",s.sequence=e,s.width||(s.width=25),e++}for(var r=0,o=this.availableFields;r<o.length;r++){var n=o[r];n.display="no",n.sequence=e,e++}this.presentationFields.sort(function(e,t){return e.sequence&&t.sequence?parseInt(e.sequence,10)>parseInt(t.sequence,10)?1:-1:0}),this.dataChanged$.next(!0),this.dataChanged$.complete(),this.close()}},ReporterDetailSelectFieldsModal.prototype.onFieldDrop=function(e){var t=e.previousContainer.data.splice(e.previousIndex,1);e.container.data.splice(e.currentIndex,0,t[0])},__decorate([core_1.Component({template:'<system-modal><system-modal-header (close)="close()"><system-label label="LBL_SETFIELDS"></system-label></system-modal-header><system-modal-content><div class="slds-grid"><div class="slds-form-element slds-p-horizontal--small slds-size--1-of-2"><span class="slds-form-element__label"><system-label label="LBL_AVAILABLE_FIELDS"></system-label></span><div class="slds-picklist slds-picklist__options slds-size--1-of-1" style="height: 50vh" cdkDropList #listOne="cdkDropList" [cdkDropListData]="availableFields" [cdkDropListConnectedTo]="[listTwo]" (cdkDropListDropped)="onFieldDrop($event)"><div *ngFor="let field of availableFields" cdkDrag [cdkDragData]="field" class="slds-drag--preview slds-picklist__item" role="option"><span class="slds-truncate"><system-label [label]="field.name"></system-label></span></div></div></div><div class="slds-form-element slds-p-horizontal--small slds-size--1-of-2"><span class="slds-form-element__label"><system-label label="LBL_SELECTED_FIELDS"></system-label></span><div class="slds-picklist slds-picklist__options slds-size--1-of-1 cdk-drag" style="height: 50vh" cdkDropList #listTwo="cdkDropList" [cdkDropListData]="displayFields" [cdkDropListConnectedTo]="[listOne]" (cdkDropListDropped)="onFieldDrop($event)"><div *ngFor="let field of displayFields" cdkDrag [cdkDragData]="field" class="slds-drag--preview slds-picklist__item" role="option"><span class="slds-truncate"><system-label [label]="field.name"></system-label></span></div></div></div></div></system-modal-content><system-modal-footer><button class="slds-button slds-button--neutral" (click)="close()"><system-label label="LBL_CANCEL"></system-label></button> <button class="slds-button slds-button--brand" [disabled]="!canSet()" (click)="set()"><system-label label="LBL_SET"></system-label></button></system-modal-footer></system-modal>',changeDetection:core_1.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[services_1.metadata,services_1.language])],ReporterDetailSelectFieldsModal)}();exports.ReporterDetailSelectFieldsModal=ReporterDetailSelectFieldsModal;var ReporterDetailVisualization=function(){function e(e,t,i,s,r){var o=this;this.reporterconfig=e,this.metadata=t,this.model=i,this.backend=s,this.cdRef=r,this.parentModule="",this.parentId="",this.loading=!0,this.vizData={},this.chartComponent=[],this.subscriptions=new rxjs_1.Subscription,this.subscriptions.add(this.reporterconfig.refresh$.subscribe(function(e){o.getVisualization()}))}return e.prototype.ngAfterViewInit=function(){this.getVisualization()},e.prototype.ngOnDestroy=function(){this.subscriptions.unsubscribe()},e.prototype.getVisualization=function(){var t=this;this.loading=!0,this.cdRef.detectChanges();var e={};this.parentModule&&this.parentId&&(e.parentbeanId=this.parentId,e.parentbeanModule=this.parentModule);for(var i=[],s=0,r=this.reporterconfig.userFilters;s<r.length;s++){var o=r[s];i.push({fieldid:o.fieldid,operator:o.operator,value:o.value,valuekey:o.valuekey,valueto:o.valueto,valuetokey:o.valuetokey})}e.whereConditions=JSON.stringify(i),this.backend.getRequest("module/KReports/"+this.model.id+"/visualization",e).subscribe(function(e){t.vizData=e,t.loading=!1,t.cdRef.detectChanges(),t.renderVisualization()})},e.prototype.renderVisualization=function(){var i=this;this.chartComponent.forEach(function(e){return e.destroy()}),this.chartComponent=[];for(var s=this,e=0,t=this.vizData;e<t.length;e++)!function(t){var e="";switch(t.plugin){case"highcharts":e="ReporterDetailVisualizationHighcharts";break;case"googlecharts":e="ReporterDetailVisualizationGooglecharts";break;case"googlemaps":e="ReporterDetailVisualizationGoogleMaps"}""!=e&&s.metadata.addComponent(e,s.vizcontainer).subscribe(function(e){i.chartComponent.push(e),e.instance.vizdata=t,e.changeDetectorRef.detectChanges()})}(t[e])},__decorate([core_1.ViewChild("vizcontainer",{read:core_1.ViewContainerRef,static:!0}),__metadata("design:type",core_1.ViewContainerRef)],e.prototype,"vizcontainer",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"parentModule",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"parentId",void 0),__decorate([core_1.Component({selector:"reporter-detail-visualization",template:'<div class="slds-is-relative" style="height: 100%; width: 100%;" [system-overlay-loading-spinner]="loading"><div #vizcontainer></div></div>',changeDetection:core_1.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[reporterconfig,services_1.metadata,services_1.model,services_1.backend,core_1.ChangeDetectorRef])],e)}();exports.ReporterDetailVisualization=ReporterDetailVisualization;var ReporterDetailVisualizationGooglecharts=function(){function ReporterDetailVisualizationGooglecharts(e,t,i,s,r){var o=this;this.renderer=e,this.elementRef=t,this.metadata=i,this.zone=s,this.libloader=r,this.vizdata={},this.wrapper=void 0,this.resizeHandler={},this.resizeHandler=this.renderer.listen("window","resize",function(){return o.onResize()})}return ReporterDetailVisualizationGooglecharts.prototype.ngAfterViewInit=function(){this.loadGoogleChart()},ReporterDetailVisualizationGooglecharts.prototype.loadGoogleChart=function(){var t=this;this.vizdata.data.options.height||(this.vizdata.data.options.height=this.elementRef.nativeElement.height),this.libloader.loadLib("googlecharts").subscribe(function(e){t.zone.runOutsideAngular(function(){google.charts.load("current",{packages:["corechart"]}),google.charts.setOnLoadCallback(function(){t.drawchart()})})})},ReporterDetailVisualizationGooglecharts.prototype.ngOnDestroy=function(){this.resizeHandler()},ReporterDetailVisualizationGooglecharts.prototype.drawchart=function(){this.wrapper=new google.visualization.ChartWrapper(this.vizdata.data),this.wrapper.draw()},ReporterDetailVisualizationGooglecharts.prototype.onResize=function(){var e=this;this.wrapper&&this.zone.runOutsideAngular(function(){e.wrapper.draw()})},__decorate([core_1.Component({selector:"reporter-detail-visualization-googlecharts",template:'<div [ngStyle]="vizdata?.layout" class="slds-is-absolute slds-box--border slds-p-vertical--small slds-p-horizontal--small"><div style="width: 100%; height: 100%;" [id]="vizdata.uid"></div></div>',changeDetection:core_1.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[core_1.Renderer2,core_1.ElementRef,services_1.metadata,core_1.NgZone,services_1.libloader])],ReporterDetailVisualizationGooglecharts)}();exports.ReporterDetailVisualizationGooglecharts=ReporterDetailVisualizationGooglecharts;var ReporterVisualizationDashlet=function(){function ReporterVisualizationDashlet(e,t){this.model=e,this.reporterconfig=t,this.id="",this.config=void 0,this.parentModule="",this.parentId="",this.componentconfig={},this.hasVisualization=!1,this.vizData={},this.noAccess=new core_1.EventEmitter}return ReporterVisualizationDashlet.prototype.ngOnInit=function(){this.config&&(this.componentconfig=this.config)},ReporterVisualizationDashlet.prototype.ngAfterViewInit=function(){var t=this;""!==this.componentconfig.reportid&&(this.model.module="KReports",this.model.id=this.componentconfig.reportid,this.model.getData().subscribe(function(e){""!=e.visualization_params&&(t.hasVisualization=!0)},function(e){"403"!=e.status&&"404"!=e.status||t.noAccess.emit(!0)}))},__decorate([core_1.Input(),__metadata("design:type",String)],ReporterVisualizationDashlet.prototype,"id",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],ReporterVisualizationDashlet.prototype,"config",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],ReporterVisualizationDashlet.prototype,"parentModule",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],ReporterVisualizationDashlet.prototype,"parentId",void 0),__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],ReporterVisualizationDashlet.prototype,"noAccess",void 0),__decorate([core_1.Component({selector:"reporter-visualization-dashlet",template:'<reporter-detail-visualization *ngIf="hasVisualization" [parentId]="parentId" [parentModule]="parentModule"></reporter-detail-visualization>',providers:[services_1.model,reporterconfig]}),__metadata("design:paramtypes",[services_1.model,reporterconfig])],ReporterVisualizationDashlet)}();exports.ReporterVisualizationDashlet=ReporterVisualizationDashlet;var ReporterVisualizationContainer=function(){function ReporterVisualizationContainer(e){this.model=e,this.componentconfig={},this.isHidden=!1}return ReporterVisualizationContainer.prototype.noAccess=function(e){this.isHidden=e},__decorate([core_1.Component({selector:"reporter-visualization-container",template:'<div style="height: 300px; width: 100%;" class="slds-card slds-m-bottom--medium" [ngClass]="{\'slds-hide\': isHidden}"><reporter-visualization-dashlet [config]="componentconfig" [parentModule]="model.module" [parentId]="model.id" (noAccess)="noAccess($event)"></reporter-visualization-dashlet></div>',styles:[":host {width:100%; height: 300px;}"]}),__metadata("design:paramtypes",[services_1.model])],ReporterVisualizationContainer)}();exports.ReporterVisualizationContainer=ReporterVisualizationContainer;var ReporterPresentationContainer=function(){function ReporterPresentationContainer(e,t){this.model=e,this.language=t,this.componentconfig={},this.isHidden=!1}return Object.defineProperty(ReporterPresentationContainer.prototype,"title",{get:function(){return this.dashletTitle||this.language.getModuleName("KReports")},enumerable:!1,configurable:!0}),ReporterPresentationContainer.prototype.noAccess=function(e){this.isHidden=e},__decorate([core_1.Component({selector:"reporter-presentation-container",template:'<div class="slds-card slds-card_boundary slds-p-bottom--medium slds-m-bottom--medium" [ngClass]="{\'slds-hide\': isHidden}"><div class="slds-card__header slds-grid slds-grid--vertical-align-center"><header class="slds-media slds-media--center slds-has-flexi-truncate"><system-icon module="KReports" [size]="\'small\'"></system-icon><div class="slds-media__body slds-truncate slds-grid slds-grid--vertical-align-center"><h2 class="slds-text-heading--small">{{title}}</h2></div></header></div><reporter-presentation-dashlet [componentconfig]="componentconfig" [parentModule]="model.module" [parentId]="model.id" [displayheader]="false" (dashletTitle)="dashletTitle = $event" (noAccess)="noAccess($event)"></reporter-presentation-dashlet></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.language])],ReporterPresentationContainer)}();exports.ReporterPresentationContainer=ReporterPresentationContainer;var ReporterPresentationDashlet=function(){function ReporterPresentationDashlet(e,t,i){this.model=e,this.metadata=t,this.elementRef=i,this.parentModule="",this.parentId="",this.displayheader=!0,this.componentconfig={},this.dashletTitle=new core_1.EventEmitter,this.presComponent=void 0,this.noAccess=new core_1.EventEmitter}return ReporterPresentationDashlet.prototype.ngAfterViewInit=function(){var t=this;""!==this.componentconfig.reportid&&(this.model.module="KReports",this.model.id=this.componentconfig.reportid,this.parentId&&this.parentModule&&(this.model.parentBeanId=this.parentId,this.model.parentBeanModule=this.parentModule),this.model.getData().subscribe(function(e){t.dashletTitle.emit(t.model.getField("name")),t.renderPresentation()},function(e){"403"!=e.status&&"404"!=e.status||t.noAccess.emit(!0)}))},Object.defineProperty(ReporterPresentationDashlet.prototype,"containerstyle",{get:function(){this.presentationcontainer.element.nativeElement.getBoundingClientRect();return{height:"calc(100% - "+this.presentationcontainer.element.nativeElement.offsetTop+"px)"}},enumerable:!1,configurable:!0}),ReporterPresentationDashlet.prototype.openReport=function(){this.model.goDetail()},ReporterPresentationDashlet.prototype.renderPresentation=function(){var t=this;this.presComponent&&(this.presComponent.destroy(),this.presComponent=void 0);var e="";switch(this.model.data.presentation_params.plugin){case"standard":e="ReporterDetailPresentationStandard";break;case"grouped":e="ReporterDetailPresentationGrouped";break;case"standardws":e="ReporterDetailPresentationStandardWS";break;case"tree":e="ReporterDetailPresentationTree";break;case"pivot":e="ReporterDetailPresentationPivot"}""!=e&&this.metadata.addComponent(e,this.presentationcontainer).subscribe(function(e){e.instance.showFooter=!1,t.presComponent=e})},__decorate([core_1.ViewChild("presentationcontainer",{read:core_1.ViewContainerRef,static:!0}),__metadata("design:type",core_1.ViewContainerRef)],ReporterPresentationDashlet.prototype,"presentationcontainer",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],ReporterPresentationDashlet.prototype,"parentModule",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],ReporterPresentationDashlet.prototype,"parentId",void 0),__decorate([core_1.Input(),__metadata("design:type",Boolean)],ReporterPresentationDashlet.prototype,"displayheader",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],ReporterPresentationDashlet.prototype,"componentconfig",void 0),__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],ReporterPresentationDashlet.prototype,"dashletTitle",void 0),__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],ReporterPresentationDashlet.prototype,"noAccess",void 0),__decorate([core_1.Component({selector:"reporter-presentation-dashlet",template:'<h2 *ngIf="displayheader" class="slds-text-heading--medium slds-p-around--medium" (click)="openReport()"><span class="slds-text-link_faux">{{model.data.name}}</span></h2><div class="slds-scrollable--y" [ngStyle]="containerstyle"><div #presentationcontainer></div></div>',providers:[services_1.model,reporterconfig],styles:[":host {width:100%; height: 100%;}"]}),__metadata("design:paramtypes",[services_1.model,services_1.metadata,core_1.ElementRef])],ReporterPresentationDashlet)}();exports.ReporterPresentationDashlet=ReporterPresentationDashlet;var ReporterCockpit=function(){function ReporterCockpit(e,t,i,s,r){this.backend=e,this.modellist=t,this.language=i,this.configuration=s,this.metadata=r,this.componentconfig={},this.subscriptions=new rxjs_1.Subscription,this.allFields=[]}return Object.defineProperty(ReporterCockpit.prototype,"sortField",{get:function(){return this.componentconfig.sortfield},enumerable:!1,configurable:!0}),Object.defineProperty(ReporterCockpit.prototype,"sortDirection",{get:function(){return this.componentconfig.sortdirection||"ASC"},enumerable:!1,configurable:!0}),ReporterCockpit.prototype.ngOnInit=function(){this.initialize()},ReporterCockpit.prototype.initialize=function(){var t=this;this.componentconfig=this.metadata.getComponentConfig("ReporterCockpit",this.modellist.module),this.modellist.loadlimit=15,this.loadCategories(),this.sortField&&this.modellist.setSortField(this.sortField,this.sortDirection),this.subscriptions.add(this.modellist.listType$.pipe(operators_1.skip(1)).subscribe(function(e){return t.handleListTypeChange(e)}))},ReporterCockpit.prototype.handleListTypeChange=function(e){"ReporterCockpit"==e.listcomponent&&this.modellist.reLoadList()},ReporterCockpit.prototype.loadCategories=function(){var t=this,e=this.configuration.getData("reportcategories");e?(this.setBuckets(e),this.modellist.getListData()):this.backend.getRequest("module/KReports/categoriesmanager/categories").subscribe(function(e){e&&(t.setBuckets(e),t.modellist.getListData())})},ReporterCockpit.prototype.setBuckets=function(e){this.modellist.buckets={bucketfield:"category_name",bucketitems:e.map(function(e){return{bucket:e.name,values:{},items:0}})}},ReporterCockpit.prototype.ngOnDestroy=function(){this.modellist.buckets={}},ReporterCockpit.prototype.loadMore=function(e){this.modellist.loadMoreBucketList(e)},ReporterCockpit.prototype.getCategoryReports=function(t){return this.modellist.listData.list.filter(function(e){return e.category_name==t})},__decorate([core_1.Component({selector:"reporter-cockpit",template:'<div class="slds-scrollable" style="height: 100%;" [system-overlay-loading-spinner]="modellist.isLoading"><ng-container *ngFor="let category of modellist.buckets?.bucketitems"><article *ngIf="category?.items > 0" class="slds-card slds-m-around--medium"><div class="slds-card__header slds-grid"><header class="slds-media slds-media--center slds-has-flexi-truncate"><div class="slds-media__body"><h2><span class="slds-text-heading--medium">{{category.bucket}} ({{category.items}})</span></h2></div></header></div><div class="slds-card__body"><div class="slds-card__body--inner slds-grid slds-wrap slds-grid--pull-padded"><reporter-cockpit-tile *ngFor="let report of getCategoryReports(category.bucket)" [report]="report"></reporter-cockpit-tile></div></div><div *ngIf="category.items < category.total" class="slds-card__footer slds-grid"><div>{{category.items}} <system-label label="LBL_OF"></system-label> {{category.total}}</div><div class="slds-grow"><a href="javascript:void(0);" (click)="loadMore(category.bucket)"><system-label label="LBL_MORE"></system-label></a></div></div></article></ng-container></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.modellist,services_1.language,services_1.configurationService,services_1.metadata])],ReporterCockpit)}();exports.ReporterCockpit=ReporterCockpit;var ReporterCockpitTile=function(){function e(e,t){this.backend=e,this.router=t,this.report={}}return e.prototype.navigateDetail=function(){this.router.navigate(["/module/KReports/"+this.report.id])},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"report",void 0),__decorate([core_1.Component({selector:"reporter-cockpit-tile",template:'<div class="slds-media__figure slds-m-right--none"><system-icon [module]="report.report_module"></system-icon></div><div class="slds-media__body"><div class="slds-grid slds-grid--align-spread slds-has-flexi-truncate"><h3 class="slds-truncate"><a href="javascript:void(0);" (click)="navigateDetail()">{{report.name}}</a></h3></div><div class="slds-tile__detail slds-text-body--small"><dd class="slds-item--detail slds-truncate" [innerHtml]="report.description"></dd></div></div>',host:{class:"slds-tile slds-media slds-p-vertical--small slds-card__tile slds-p-horizontal--small slds-size--1-of-3 slds-hint-parent"}}),__metadata("design:paramtypes",[services_1.backend,router_1.Router])],e)}();exports.ReporterCockpitTile=ReporterCockpitTile;var ReporterFieldContainer=function(){function ReporterFieldContainer(e){this.metadata=e,this.record={},this.value="",this.field={}}return ReporterFieldContainer.prototype.ngOnInit=function(){this.initializeRecord(),this.buildLinkInfo(),this.determineFieldType()},ReporterFieldContainer.prototype.initializeRecord=function(){this.value&&_.isEmpty(this.record)&&(this.record={},this.record[this.field.fieldid]=this.value,this.record[this.field.fieldid+"_val"]=this.value)},ReporterFieldContainer.prototype.buildLinkInfo=function(){var e;"yes"==this.field.link&&this.record&&(this.field.linkinfo&&this.field.linkinfo[this.record.unionid||"root"]?(this.recordModule=this.field.linkinfo[this.record.unionid||"root"].module,this.recordId=this.record[this.field.linkinfo[this.record.unionid||"root"].idfield]):this.hasPathField?(e=this.fieldPathInfo.path.split("::").pop().split(":"),e=this.metadata.getFieldDefs(e[1],e[2]),this.recordModule=e.module,this.recordId=this.fieldPathInfo.id):(this.recordModule=this.record.sugarRecordModule,this.recordId=this.record.sugarRecordId))},Object.defineProperty(ReporterFieldContainer.prototype,"fieldPathInfo",{get:function(){var e=this.field.path.split("::");e.pop();var t,i,s=e.join("::");for(i in this.record)if(this.record.hasOwnProperty(i)&&this.record[i]==s){(t={}).path=s,t.id=this.record[i.replace("path","id")];break}return t},enumerable:!1,configurable:!0}),Object.defineProperty(ReporterFieldContainer.prototype,"hasPathField",{get:function(){var e=this.field.path.split("::");if(e.pop(),1==e.length)return!1;var t,i=e.join("::");for(t in this.record)if(this.record.hasOwnProperty(t)&&this.record[t]==i)return!0;return!1},enumerable:!1,configurable:!0}),ReporterFieldContainer.prototype.determineFieldType=function(){if(this.field.component)this.fieldType=this.field.component;else switch(this.field.type){case"percentage":this.fieldType="ReporterFieldPercentage";break;case"currency":case"currencyint":this.fieldType="ReporterFieldCurrency";break;case"enum":case"multienum":case"radioenum":this.fieldType="ReporterFieldEnum";break;case"datetimecombo":case"datetime":this.fieldType="ReporterFieldDateTime";break;case"date":this.fieldType="ReporterFieldDate";break;case"text":this.fieldType="ReporterFieldText";break;default:this.fieldType="ReporterFieldStandard"}},__decorate([core_1.Input(),__metadata("design:type",Object)],ReporterFieldContainer.prototype,"record",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],ReporterFieldContainer.prototype,"value",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],ReporterFieldContainer.prototype,"field",void 0),__decorate([core_1.Component({selector:"reporter-field-container",template:'<ng-container *ngIf="field.link == \'yes\'; else nolink"><div class="slds-text-link_reset" system-model-popover [module]="recordModule" [id]="recordId"><system-dynamic-component [component]="fieldType" [componentattributes]="{record: record, field: field}"></system-dynamic-component></div></ng-container><ng-template #nolink><system-dynamic-component [component]="fieldType" [componentattributes]="{record: record, field: field}"></system-dynamic-component></ng-template>',changeDetection:core_1.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[services_1.metadata])],ReporterFieldContainer)}();exports.ReporterFieldContainer=ReporterFieldContainer;var ReporterFieldStandard=function(){function ReporterFieldStandard(){this.record={},this.field={}}return __decorate([core_1.Component({selector:"reporter-field-standard",template:'<div *ngIf="record" class="slds-truncate">{{record[field.fieldid]}}</div>',changeDetection:core_1.ChangeDetectionStrategy.OnPush})],ReporterFieldStandard)}();exports.ReporterFieldStandard=ReporterFieldStandard;var ReporterFieldText=function(){function ReporterFieldText(e){this.sanitizer=e,this.record={},this.field={},this.value=""}return ReporterFieldText.prototype.ngOnInit=function(){this.setFormattedFieldValue()},ReporterFieldText.prototype.setFormattedFieldValue=function(){this.record[this.field.fieldid]&&(this.value=this.sanitizer.bypassSecurityTrustHtml(this.record[this.field.fieldid].replace(/(?:\r\n|\r|\n)/g,"<br>")))},__decorate([core_1.Component({selector:"reporter-field-text",template:'<div style="white-space: normal;" class="slds-truncate" [innerHTML]="value"></div>',changeDetection:core_1.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[platform_browser_1.DomSanitizer])],ReporterFieldText)}();exports.ReporterFieldText=ReporterFieldText;var ReporterFieldCurrency=function(){function ReporterFieldCurrency(e,t){this.currency=e,this.userpreferences=t,this.record={},this.field={},this.value="",this.currencySymbol=""}return ReporterFieldCurrency.prototype.ngOnInit=function(){this.setCurrencySymbol(),this.setFormattedFieldValue()},ReporterFieldCurrency.prototype.setCurrencySymbol=function(){var t,e,i;this.record[this.field.fieldid]&&(t=-99,e=this.field.fieldid+"_curid",i=this.currency.getCurrencies()||[],e&&(t=this.record[e]),i=i.find(function(e){return e.id==t}),this.currencySymbol=i?i.symbol:"")},ReporterFieldCurrency.prototype.setFormattedFieldValue=function(){this.record[this.field.fieldid]?this.value=this.userpreferences.formatMoney(parseFloat(this.record[this.field.fieldid])):this.value=""},__decorate([core_1.Component({selector:"reporter-field-currency",template:'<div class="slds-grid slds-grid--align-end"><div>{{currencySymbol}}</div><div class="slds-text-align--right">{{value}}</div></div>',changeDetection:core_1.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[services_1.currency,services_1.userpreferences])],ReporterFieldCurrency)}();exports.ReporterFieldCurrency=ReporterFieldCurrency;var ReporterFieldPercentage=function(){function ReporterFieldPercentage(e){this.userpreferences=e,this.record={},this.field={},this.value=""}return ReporterFieldPercentage.prototype.ngOnInit=function(){this.setFormattedFieldValue()},ReporterFieldPercentage.prototype.setFormattedFieldValue=function(){this.record[this.field.fieldid]?this.value=this.userpreferences.formatMoney(parseFloat(this.record[this.field.fieldid]),2,99)+"%":this.value=""},__decorate([core_1.Component({template:'<div class="slds-text-align--center">{{value}}</div>',changeDetection:core_1.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[services_1.userpreferences])],ReporterFieldPercentage)}();exports.ReporterFieldPercentage=ReporterFieldPercentage;var ReporterFieldEnum=function(){function ReporterFieldEnum(e,t){this.language=e,this.metadata=t,this.record={},this.field={},this.value=""}return ReporterFieldEnum.prototype.ngOnInit=function(){this.setFormattedFieldValue()},ReporterFieldEnum.prototype.setFormattedFieldValue=function(){var e=this.field.path.split("::"),t=e.length,i=e[t-1].split(":")[1],s=e[t-2].split(":");switch(s[0]){case"root":r=s[1];break;case"link":var r=this.metadata.getFieldDefs(s[1],s[2]).module}this.value=i&&r?this.language.getFieldDisplayOptionValue(r,i,this.record[this.field.fieldid+"_val"]):this.record[this.field.fieldid]},__decorate([core_1.Component({selector:"reporter-field-enum",template:'<div class="slds-truncate slds-text-align--center">{{value}}</div>',changeDetection:core_1.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[services_1.language,services_1.metadata])],ReporterFieldEnum)}();exports.ReporterFieldEnum=ReporterFieldEnum;var ReporterFieldDate=function(){function ReporterFieldDate(e){this.userpreferences=e,this.record={},this.field={},this.value=""}return ReporterFieldDate.prototype.ngOnInit=function(){this.setFormattedFieldValue()},ReporterFieldDate.prototype.setFormattedFieldValue=function(){var e;!this.record[this.field.fieldid]||(e=new moment.utc(this.record[this.field.fieldid])).isValid()&&(this.value=e.format(this.userpreferences.getDateFormat()))},__decorate([core_1.Component({selector:"reporter-field-date",template:'<div class="slds-truncate">{{value}}</div>',changeDetection:core_1.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[services_1.userpreferences])],ReporterFieldDate)}();exports.ReporterFieldDate=ReporterFieldDate;var ReporterFieldDateTime=function(){function ReporterFieldDateTime(e,t,i,s){this.userpreferences=e,this.session=t,this.cdRef=i,this.broadcast=s,this.record={},this.field={},this.value="",this.subscription=new rxjs_1.Subscription,this.subscribeToTimezoneChange()}return ReporterFieldDateTime.prototype.ngOnInit=function(){this.setFormattedFieldValue()},ReporterFieldDateTime.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},ReporterFieldDateTime.prototype.subscribeToTimezoneChange=function(){var t=this;this.subscription.add(this.broadcast.message$.subscribe(function(e){"timezone.changed"==e.messagetype&&(t.setFormattedFieldValue(),t.cdRef.detectChanges())}))},ReporterFieldDateTime.prototype.setFormattedFieldValue=function(){var e;!this.record[this.field.fieldid]||(e=new moment.utc(this.record[this.field.fieldid]).tz(this.session.getSessionData("timezone")||moment.tz.guess(!0))).isValid()&&(this.value=this.userpreferences.formatDateTime(e))},__decorate([core_1.Component({selector:"reporter-field-date-time",template:'<div class="slds-truncate">{{value}}</div>',changeDetection:core_1.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[services_1.userpreferences,services_1.session,core_1.ChangeDetectorRef,services_1.broadcast])],ReporterFieldDateTime)}();exports.ReporterFieldDateTime=ReporterFieldDateTime;var ReporterFieldColor=function(){function ReporterFieldColor(){this.record={},this.field={}}return __decorate([core_1.Component({selector:"reporter-field-Color",template:'<div class="slds-align--absolute-center"><svg height="16" width="16"><circle cx="8" cy="8" r="6" stroke="grey" stroke-width="1" [attr.fill]="record[field.fieldid]"></circle></svg></div>'})],ReporterFieldColor)}();exports.ReporterFieldColor=ReporterFieldColor;var FieldReportCategory=function(l){function FieldReportCategory(e,t,i,s,r,o,n){var a=l.call(this,n,i,e,o,t)||this;return a.language=e,a.router=t,a.view=i,a.backend=s,a.configuration=r,a.metadata=o,a.model=n,a.categories=[],a.loadCategories(),a}return __extends(FieldReportCategory,l),Object.defineProperty(FieldReportCategory.prototype,"valueId",{get:function(){return this.model.getField("category_id")},set:function(e){this.model.setField("category_id",e)},enumerable:!1,configurable:!0}),FieldReportCategory.prototype.loadCategories=function(){var t=this,e=this.configuration.getData("reportcategories");e?this.categories=e:this.backend.getRequest("module/KReports/categoriesmanager/categories").subscribe(function(e){e&&(t.categories=e)})},__decorate([core_1.Component({selector:"field-report-category",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig" [fieldid]="fieldid"><div class="slds-form-element__control slds-p-vertical--xx-small"><div class="slds-select_container"><select class="slds-select" [ngModel]="valueId" [disabled]="true"><option></option><option *ngFor="let category of categories" [value]="category.id">{{category.name}}</option></select></div></div></field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element" [ngClass]="getFieldClass()"><div class="slds-form-element__control slds-p-vertical--xx-small"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="valueId"><option></option><option *ngFor="let category of categories" [value]="category.id">{{category.name}}</option></select></div></div><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.language,router_1.Router,services_1.view,services_1.backend,services_1.configurationService,services_1.metadata,services_1.model])],FieldReportCategory)}(objectfields_1.fieldGeneric);exports.FieldReportCategory=FieldReportCategory;var ReporterIntegrationExportButton=function(){function e(e,t,i){this.language=e,this.metadata=t,this.model=i,this.integrationParams={},this.actionComponentRefs=[]}return Object.defineProperty(e.prototype,"isDisabled",{get:function(){if(!this.model.checkAccess("export"))return!1;if(this.integrationParams.activePlugins)for(var e in this.integrationParams.activePlugins)if(this.integrationParams.activePlugins.hasOwnProperty(e)&&1==this.integrationParams.activePlugins[e])switch(e){case"ktargetlistexport":case"kcsvexport":case"kexcelexport":case"kpdfexport":case"kplannerexport":if(1==this.integrationParams.activePlugins[e])return!1}return!0},enumerable:!1,configurable:!0}),e.prototype.ngAfterViewInit=function(){this.renderActionItems()},e.prototype.ngOnChanges=function(){this.renderActionItems()},e.prototype.renderActionItems=function(){if(this.actionComponentRefs.forEach(function(e){return e.destroy()}),this.actionComponentRefs=[],this.integrationParams.activePlugins)for(var e in this.integrationParams.activePlugins)if(this.integrationParams.activePlugins.hasOwnProperty(e)&&1==this.integrationParams.activePlugins[e])switch(e){case"ktargetlistexport":1==this.integrationParams.activePlugins.ktargetlistexport&&this.renderActionItem("ReporterIntegrationTargetlistexportButton");break;case"kcsvexport":1==this.integrationParams.activePlugins.kcsvexport&&this.renderActionItem("ReporterIntegrationCSVexportButton");break;case"kexcelexport":1==this.integrationParams.activePlugins.kexcelexport&&this.renderActionItem("ReporterIntegrationXLSexportButton");break;case"kpdfexport":1==this.integrationParams.activePlugins.kpdfexport&&this.renderActionItem("ReporterIntegrationPDFexportButton");break;case"kplannerexport":1==this.integrationParams.activePlugins.kplannerexport&&this.renderActionItem("SalesPlanningReporterIntegrationExportButton")}},e.prototype.renderActionItem=function(e){var t=this;this.metadata.addComponent(e,this.actionItemsContainer).subscribe(function(e){t.actionComponentRefs.push(e)})},__decorate([core_1.ViewChild("actionItemsContainer",{read:core_1.ViewContainerRef,static:!0}),__metadata("design:type",core_1.ViewContainerRef)],e.prototype,"actionItemsContainer",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"integrationParams",void 0),__decorate([core_1.Component({selector:"reporter-integration-export-button",template:'<div class="slds-dropdown-trigger slds-dropdown-trigger_click" system-dropdown-trigger-simple><button class="slds-button slds-button--neutral" aria-haspopup="true" [disabled]="isDisabled" style="border-top-right-radius: 0;border-bottom-right-radius: 0;"><span><system-label label="LBL_EXPORT"></system-label></span><system-button-icon [icon]="\'down\'"></system-button-icon></button><div class="slds-dropdown slds-dropdown_right"><ul class="slds-dropdown__list" role="menu"><div #actionItemsContainer></div></ul></div></div>',changeDetection:core_1.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[services_1.language,services_1.metadata,services_1.model])],e)}();exports.ReporterIntegrationExportButton=ReporterIntegrationExportButton;var ReporterIntegrationTargetlistexportButton=function(){function ReporterIntegrationTargetlistexportButton(e,t,i,s,r){this.language=e,this.metadata=t,this.model=i,this.modal=s,this.reporterconfig=r}return ReporterIntegrationTargetlistexportButton.prototype.showModal=function(){for(var t=this,i=[],e=0,s=this.reporterconfig.userFilters;e<s.length;e++){var r=s[e];i.push({fieldid:r.fieldid,operator:r.operator,value:r.value,valuekey:r.valuekey,valueto:r.valueto,valuetokey:r.valuetokey})}this.modal.openModal("ReporterIntegrationTargetlistexportModal").subscribe(function(e){e.instance.model=t.model,e.instance.whereConditions=i})},__decorate([core_1.Component({selector:"reporter-integration-targetlistexport-button",template:'<li class="slds-dropdown__item" role="presentation" (click)="showModal()"><a href="javascript:void(0);" role="menuitem" tabindex="0"><system-icon module="ProspectLists" size="x-small"></system-icon><span class="slds-truncate"><system-label-modulename module="ProspectLists" [singular]="true"></system-label-modulename></span></a></li>'}),__metadata("design:paramtypes",[services_1.language,services_1.metadata,services_1.model,services_1.modal,reporterconfig])],ReporterIntegrationTargetlistexportButton)}();exports.ReporterIntegrationTargetlistexportButton=ReporterIntegrationTargetlistexportButton;var ReporterIntegrationExportMask=function(){function ReporterIntegrationExportMask(e){this.language=e}return __decorate([core_1.Component({template:'<div class="slds-modal slds-fade-in-open slds-align--absolute-center" style="width: 100%; height: 100vh;"><div class="slds-box slds-theme--default"><system-spinner></system-spinner></div></div><div class="slds-backdrop slds-backdrop--open"></div>'}),__metadata("design:paramtypes",[services_1.language])],ReporterIntegrationExportMask)}();exports.ReporterIntegrationExportMask=ReporterIntegrationExportMask;var ReporterIntegrationTargetlistexportModal=function(){function ReporterIntegrationTargetlistexportModal(e,t,i,s){this.language=e,this.metadata=t,this.backend=i,this.modal=s,this.self={},this.model={},this.whereConditions={},this.targetlistname=""}return ReporterIntegrationTargetlistexportModal.prototype.closeModal=function(){this.self.destroy()},ReporterIntegrationTargetlistexportModal.prototype.exportTargetList=function(){var i=this;this.modal.openModal("SystemLoadingModal").subscribe(function(t){t.instance.messagelabel="LBL_CREATING_TARGETLIST";var e={targetlist_action:"new",targetlist_name:i.targetlistname,record:i.model.id,whereConditions:btoa(JSON.stringify(i.whereConditions))};i.backend.postRequest("module/KReports/plugins/action/ktargetlistexport/export_to_targetlist",{},e).subscribe(function(e){t.instance.self.destroy(),i.closeModal()})})},__decorate([core_1.Component({selector:"reporter-integration-targetlistexport-modal",template:'<system-modal size="large"><system-modal-header (close)="closeModal()"><system-label label="LBL_EXPORT_TO_TARGETLIST_BUTTON_LABEL"></system-label></system-modal-header><system-modal-content><div class="slds-form-element slds-p-around--small"><label class="slds-form-element__label"><system-label label="LBL_EXPORT_TO_TARGETLIST_BUTTON_LABEL"></system-label></label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="targetlistname"></div></div></system-modal-content><system-modal-footer><button class="slds-button slds-button--neutral" (click)="closeModal()"><system-label label="LBL_CANCEL"></system-label></button> <button class="slds-button slds-button--brand" (click)="exportTargetList()"><system-label label="LBL_OK"></system-label></button></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[services_1.language,services_1.metadata,services_1.backend,services_1.modal])],ReporterIntegrationTargetlistexportModal)}();exports.ReporterIntegrationTargetlistexportModal=ReporterIntegrationTargetlistexportModal;var ReporterIntegrationCSVexportButton=function(){function ReporterIntegrationCSVexportButton(e,t,i,s,r,o,n,a){this.language=e,this.metadata=t,this.backend=i,this.model=s,this.modal=r,this.footer=o,this.reporterconfig=n,this.toast=a,this.loadUrl=void 0,this.fileName=void 0}return Object.defineProperty(ReporterIntegrationCSVexportButton.prototype,"canExport",{get:function(){return this.model.checkAccess("export")},enumerable:!1,configurable:!0}),ReporterIntegrationCSVexportButton.prototype.exportCSV=function(){for(var i=this,e=[],t=0,s=this.reporterconfig.userFilters;t<s.length;t++){var r=s[t];e.push({fieldid:r.fieldid,operator:r.operator,value:r.value,valuekey:r.valuekey,valueto:r.valueto,valuetokey:r.valuetokey})}this.fileName=this.model.data.name.replace(" ","_")+"_"+moment().format("YYYY_MM_DD_HH_mm_ss")+".csv";var o=this.modal.await(this.language.getLabel("LBL_LOADING"));this.backend.getDownloadPostRequestFile("module/KReports/plugins/action/kcsvexport/export",{record:this.model.id,dynamicoptions:JSON.stringify(e)}).subscribe(function(e){var t=document.createElement("a");document.body.appendChild(t),t.href=e,t.download=i.fileName,t.type="text/css",t.click(),t.remove(),o.emit(!0)},function(e){o.emit(!0),i.toast.sendToast("Error Loading File","error")})},__decorate([core_1.Component({selector:"reporter-integration-csvexport-button",template:'<li *ngIf="canExport" class="slds-dropdown__item" role="presentation"><a href="javascript:void(0);" role="menuitem" tabindex="0" (click)="exportCSV()"><system-icon sprite="doctype" icon="csv" size="x-small"></system-icon><span class="slds-truncate"><system-label label="LBL_CSV_EXPORT"></system-label></span></a></li>'}),__metadata("design:paramtypes",[services_1.language,services_1.metadata,services_1.backend,services_1.model,services_1.modal,services_1.footer,reporterconfig,services_1.toast])],ReporterIntegrationCSVexportButton)}();exports.ReporterIntegrationCSVexportButton=ReporterIntegrationCSVexportButton;var ReporterIntegrationToolsButton=function(){function e(e,t){this.language=e,this.metadata=t,this.integrationParams={},this.actionComponentRefs=[]}return Object.defineProperty(e.prototype,"isDisabled",{get:function(){if(this.integrationParams.activePlugins)for(var e in this.integrationParams.activePlugins)if(this.integrationParams.activePlugins.hasOwnProperty(e)&&"kqueryanalizer"===e)if(1==this.integrationParams.activePlugins.kqueryanalizer)return!1;return!0},enumerable:!1,configurable:!0}),e.prototype.ngOnChanges=function(){this.renderActionItems()},e.prototype.ngAfterViewInit=function(){this.renderActionItems()},__decorate([core_1.ViewChild("actionItemsContainer",{read:core_1.ViewContainerRef,static:!(e.prototype.renderActionItems=function(){var t=this;if(this.actionComponentRefs.forEach(function(e){return e.destroy()}),this.actionComponentRefs=[],this.integrationParams.activePlugins)for(var e in this.integrationParams.activePlugins)this.integrationParams.activePlugins.hasOwnProperty(e)&&"kqueryanalizer"===e&&1==this.integrationParams.activePlugins.kqueryanalizer&&this.metadata.addComponent("ReporterIntegrationQueryanalyzerButton",this.actionItemsContainer).subscribe(function(e){t.actionComponentRefs.push(e)})})}),__metadata("design:type",core_1.ViewContainerRef)],e.prototype,"actionItemsContainer",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"integrationParams",void 0),__decorate([core_1.Component({selector:"reporter-integration-tools-button",template:'<div class="slds-dropdown-trigger slds-dropdown-trigger_click" system-dropdown-trigger-simple><button class="slds-button slds-button--neutral" aria-haspopup="true" [disabled]="isDisabled" style="border-radius: 0;border-left: 0;border-right: 0;"><span><span><system-label label="LBL_TOOLS"></system-label></span></span><system-button-icon [icon]="\'down\'"></system-button-icon></button><div class="slds-dropdown slds-dropdown_right"><ul class="slds-dropdown__list" role="menu"><div #actionItemsContainer></div></ul></div></div>',changeDetection:core_1.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[services_1.language,services_1.metadata])],e)}();exports.ReporterIntegrationToolsButton=ReporterIntegrationToolsButton;var ReporterNewButton=function(){function ReporterNewButton(e,t,i,s){this.language=e,this.metadata=t,this.model=i,this.router=s}return ReporterNewButton.prototype.execute=function(){this.hidden||this.router.navigate(["/module/KReports/designer/new"])},Object.defineProperty(ReporterNewButton.prototype,"hidden",{get:function(){return!this.metadata.checkModuleAcl(this.model.module,"create")},enumerable:!1,configurable:!0}),__decorate([core_1.Component({template:'<span><system-label label="LBL_NEW"></system-label></span>'}),__metadata("design:paramtypes",[services_1.language,services_1.metadata,services_1.model,router_1.Router])],ReporterNewButton)}();exports.ReporterNewButton=ReporterNewButton;var ModuleReports=function(){function ModuleReports(){}return __decorate([core_1.NgModule({imports:[common_1.CommonModule,forms_1.FormsModule,objectfields_1.ObjectFields,objectcomponents_1.ObjectComponents,systemcomponents_1.SystemComponents,directives_1.DirectivesModule,drag_drop_1.DragDropModule],declarations:[FieldReportCategory,ReporterDetailView,ReporterDetailViewHeader,ReporterFilterButton,ReporterDetailViewRefreshButton,ReporterDetailViewEditButton,ReporterFilterPanel,ReporterFilterSavedFilters,ReporterFilterItem,ReporterFilterItemText,ReporterFilterItemEnum,ReporterFilterItemDate,ReporterFilterItemUser,ReporterFilterItemParent,ReporterFilterItemUserSingle,ReporterFilterItemUserMultiple,ReporterFilterItemReference,ReporterFilterItemFunction,ReporterDetailPresentationStandard,ReporterDetailSelectFieldsModal,ReporterDetailVisualization,ReporterDetailVisualizationGooglecharts,ReporterVisualizationDashlet,ReporterVisualizationContainer,ReporterPresentationContainer,ReporterPresentationDashlet,ReporterCockpit,ReporterCockpitTile,ReporterFieldContainer,ReporterFieldStandard,ReporterFieldText,ReporterFieldCurrency,ReporterFieldPercentage,ReporterFieldEnum,ReporterFieldDate,ReporterFieldDateTime,ReporterFieldColor,ReporterIntegrationExportButton,ReporterIntegrationExportMask,ReporterIntegrationTargetlistexportButton,ReporterIntegrationTargetlistexportModal,ReporterIntegrationCSVexportButton,ReporterIntegrationToolsButton,ReporterNewButton],exports:[ReporterFieldContainer,ReporterFilterItemEnum,ReporterFilterItemText,ReporterFilterItemDate,ReporterFilterItemUser,ReporterFilterItemReference,ReporterFilterItemFunction,ReporterFilterItemParent]})],ModuleReports)}();exports.ModuleReports=ModuleReports;