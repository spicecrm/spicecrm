/*
SpiceUI 2018.10.001

Copyright (c) 2016-present, aac services.k.s - All rights reserved.
Redistribution and use in source and binary forms, without modification, are permitted provided that the following conditions are met:
- Redistributions of source code must retain this copyright and license notice, this list of conditions and the following disclaimer.
- Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
- If used the SpiceCRM Logo needs to be displayed in the upper left corner of the screen in a minimum dimension of 31x31 pixels and be clearly visible, the icon needs to provide a link to http://www.spicecrm.io
THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

*/

/** 
 * Â© 2015 - 2021 aac services k.s. All rights reserved.
 * release: 2021.03.001
 * date: 2021-11-22 14:19:12
 * build: 2021.03.001.1637587152303
 **/
"use strict";var __extends=this&&this.__extends||function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function s(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(s.prototype=t.prototype,new s)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,s=1,i=arguments.length;s<i;s++)for(var l in t=arguments[s])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e}).apply(this,arguments)},__decorate=this&&this.__decorate||function(e,t,s,i){var l,a=arguments.length,d=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)d=Reflect.decorate(e,t,s,i);else for(var n=e.length-1;0<=n;n--)(l=e[n])&&(d=(a<3?l(d):3<a?l(t,s,d):l(t,s))||d);return 3<a&&d&&Object.defineProperty(t,s,d),d},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param=this&&this.__param||function(s,i){return function(e,t){i(e,t,s)}},__awaiter=this&&this.__awaiter||function(e,d,n,o){return new(n=n||Promise)(function(s,t){function i(e){try{a(o.next(e))}catch(e){t(e)}}function l(e){try{a(o.throw(e))}catch(e){t(e)}}function a(e){var t;e.done?s(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(i,l)}a((o=o.apply(e,d||[])).next())})},__generator=this&&this.__generator||function(s,i){var l,a,d,n={label:0,sent:function(){if(1&d[0])throw d[1];return d[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(l)throw new TypeError("Generator is already executing.");for(;n;)try{if(l=1,a&&(d=2&t[0]?a.return:t[0]?a.throw||((d=a.return)&&d.call(a),0):a.next)&&!(d=d.call(a,t[1])).done)return d;switch(a=0,(t=d?[2&t[0],d.value]:t)[0]){case 0:case 1:d=t;break;case 4:return n.label++,{value:t[1],done:!1};case 5:n.label++,a=t[1],t=[0];continue;case 7:t=n.ops.pop(),n.trys.pop();continue;default:if(!(d=0<(d=n.trys).length&&d[d.length-1])&&(6===t[0]||2===t[0])){n=0;continue}if(3===t[0]&&(!d||t[1]>d[0]&&t[1]<d[3])){n.label=t[1];break}if(6===t[0]&&n.label<d[1]){n.label=d[1],d=t;break}if(d&&n.label<d[2]){n.label=d[2],n.ops.push(t);break}d[2]&&n.ops.pop(),n.trys.pop();continue}t=i.call(s,n)}catch(e){t=[6,e],a=0}finally{l=d=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},__spreadArray=this&&this.__spreadArray||function(e,t){for(var s=0,i=t.length,l=e.length;s<i;s++,l++)e[l]=t[s];return e};Object.defineProperty(exports,"__esModule",{value:!0}),exports.fieldEmail=exports.fieldUrl=exports.fieldFile=exports.fieldTitle=exports.fieldFullName=exports.fieldAddress=exports.fieldDateSpan=exports.fieldDateTimeSpan=exports.fieldDuration=exports.fieldDateTimeDuration=exports.fieldDateTime=exports.fieldTime=exports.fieldDate=exports.fieldLookup=exports.fieldModifiedBy=exports.fieldRelateList=exports.fieldRelate=exports.fieldModuleFilter=exports.fieldParent=exports.fieldBoolLabelAligned=exports.fieldBool=exports.fieldEnumRadio=exports.fieldEnumAlternate=exports.fieldMultipleEnumDropdown=exports.fieldMultienumCheckBox=exports.fieldGroupedEnum=exports.fieldMultienum=exports.fieldMailRelais=exports.fieldTextMessageTemplates=exports.fieldEmailTemplates=exports.fieldEmailTo=exports.fieldLanguage=exports.fieldEnum=exports.fieldTotalAmount=exports.fieldWeightedAmount=exports.fieldCurrency=exports.fieldFloat=exports.fieldWYSIWYGEditor=exports.fieldHtmlEditor=exports.fieldHtml=exports.fieldNumber=exports.fieldText=exports.fieldGenericDisplay=exports.fieldContainer=exports.fieldLabelPopover=exports.fieldLabel=exports.fieldBlank=exports.field=exports.fieldSet=exports.fieldGeneric=void 0,exports.fieldParentDetails=exports.fieldTags=exports.fieldQuestionnaireEvaluation=exports.fieldQuantity=exports.fieldUnitsOfMeasure=exports.fieldStylesheetID=exports.fieldIconPopover=exports.fieldTimeDifference=exports.fieldSystemLabel=exports.fieldBackendMethod=exports.fieldTextID=exports.fieldGooglePlacesSearch=exports.fieldCronInterval=exports.fieldPhoneAsterisk=exports.fieldEnumMulti=exports.fieldRichText=exports.fieldModuleIcon=exports.fieldNotAuthorized=exports.fieldBase64=exports.fieldColorEnum=exports.fieldSelectTreeTree=exports.fieldSelectTreeSearch=exports.fieldSelectTree=exports.fieldGDPR=exports.FieldEnumModulesComponent=exports.FieldModelInfoComponent=exports.fieldWorklog=exports.fieldServiceCategorySearch=exports.fieldServiceCategoryTree=exports.fieldServiceCategories=exports.FieldSignatureComponent=exports.FieldModuleLookupComponent=exports.FieldMessagesComponent=exports.fieldModelFooterPopover=exports.fieldLookupSearchAdd=exports.fieldLookupSearchItem=exports.fieldLookupSearch=exports.fieldLookupRecentItem=exports.fieldLookupRecent=exports.fieldRating=exports.fieldBarcodeRenderer=exports.fieldBarcode=exports.fieldVat=exports.fieldCompanies=exports.fieldCurrencies=exports.fieldEmailRecipientsShort=exports.fieldEmailRecipients=exports.fieldEmailEmailAddress=exports.fieldEmailEmailAddressStatus=exports.fieldEmailAddresses=void 0,exports.ObjectFields=exports.fieldIconCondition=exports.fieldCompound=exports.fieldImage=exports.fieldSlider=exports.fieldActionset=exports.fieldPhone=exports.fieldRelatedDetailsContainer=exports.fieldRelatedDetails=void 0;var common_1=require("@angular/common"),core_1=require("@angular/core"),forms_1=require("@angular/forms"),drag_drop_1=require("@angular/cdk/drag-drop"),services_1=require("../services/services"),systemcomponents_1=require("../systemcomponents/systemcomponents"),directives_1=require("../directives/directives"),router_1=require("@angular/router"),rxjs_1=require("rxjs"),platform_browser_1=require("@angular/platform-browser"),fieldGeneric=function(){function fieldGeneric(e,t,s,i,l){var a=this;this.model=e,this.view=t,this.language=s,this.metadata=i,this.router=l,this.fieldname="",this.fieldconfig={},this.fielddisplayclass="",this.fieldid="",this.fieldlength=999,this.subscriptions=new rxjs_1.Subscription,this._css_classes=[],this.fieldid=this.model.generateGuid(),this.subscriptions.add(this.view.mode$.subscribe(function(e){return a.handleViewModeChange(e)}))}return fieldGeneric.prototype.handleViewModeChange=function(e){"edit"==e&&this.view.editfieldid&&this.view.editfieldid==this.fieldid&&this.setFocus()},Object.defineProperty(fieldGeneric.prototype,"field_defs",{get:function(){return this._field_defs||(this._field_defs=this.metadata.getFieldDefs(this.model.module,this.fieldname)),this._field_defs},enumerable:!1,configurable:!0}),Object.defineProperty(fieldGeneric.prototype,"css_classes",{get:function(){return this.getStati().invalid?this.addCssClass("slds-has-error"):this.removeCssClass("slds-has-error"),this._css_classes},enumerable:!1,configurable:!0}),Object.defineProperty(fieldGeneric.prototype,"modelOptions",{get:function(){return{updateOn:"blur"}},enumerable:!1,configurable:!0}),Object.defineProperty(fieldGeneric.prototype,"value",{get:function(){return this.model.getField(this.fieldname)},set:function(e){this.model.setField(this.fieldname,e)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldGeneric.prototype,"errors",{get:function(){return this.model.getFieldMessages(this.fieldname,"error")},enumerable:!1,configurable:!0}),Object.defineProperty(fieldGeneric.prototype,"displayLabel",{get:function(){return this.view.displayLabels&&!0!==this.fieldconfig.hidelabel},enumerable:!1,configurable:!0}),fieldGeneric.prototype.ngOnInit=function(){var e=this.metadata.getFieldDefs(this.model.module,this.fieldname);e&&e.len&&(this.fieldlength=e.len)},fieldGeneric.prototype.ngAfterViewInit=function(){this.view.isEditMode()&&this.view.editfieldname&&this.view.editfieldname==this.fieldname&&this.setFocus()},fieldGeneric.prototype.setFocus=function(){var e=this;setTimeout(function(){e.focuselement&&(e.focuselement.element.nativeElement.tabIndex||(e.focuselement.element.nativeElement.tabIndex="-1"),e.focuselement.element.nativeElement.focus())})},fieldGeneric.prototype.getStati=function(e){void 0===e&&(e=this.fieldname);e=this.model.getFieldStati(e);return!e.editable||this.view.isEditable&&!this.fieldconfig.readonly||(e.editable=!1),e},fieldGeneric.prototype.isEditable=function(e){return void 0===e&&(e=this.fieldname),(this.model.checkAccess("edit")||this.model.checkAccess("create"))&&this.getStati(e).editable&&!this.getStati(e).readonly&&!this.getStati(e).disabled&&!this.getStati(e).hidden},fieldGeneric.prototype.isEditMode=function(){return this.view.isEditMode()&&this.isEditable()},fieldGeneric.prototype.displayLink=function(){try{return this.view.displayLinks&&this.fieldconfig.link&&this.model.data.acl.detail}catch(e){return!1}},fieldGeneric.prototype.setEditMode=function(){this.model.startEdit(),this.view.setEditMode()},fieldGeneric.prototype.getFieldClass=function(){return this.css_classes},fieldGeneric.prototype.fieldHasError=function(e){return this.hasFieldErrors(e)},fieldGeneric.prototype.hasFieldErrors=function(e){return void 0===e&&(e=this.fieldname),!(!this.getStati(e).invalid&&!this.errors)},fieldGeneric.prototype.goRecord=function(){this.router.navigate(["/module/"+this.model.module+"/"+this.model.id])},fieldGeneric.prototype.addCssClass=function(e){return this._css_classes.includes(e)||this._css_classes.push(e),!0},fieldGeneric.prototype.removeCssClass=function(e){return this._css_classes.includes(e)&&this._css_classes.splice(this._css_classes.indexOf(e),1),!0},fieldGeneric.prototype.toggleCssClass=function(e){return this._css_classes.includes(e)?this.removeCssClass(e):this.addCssClass(e),!0},fieldGeneric.prototype.setFieldError=function(e){return this.model.setFieldMessage("error",e,this.fieldname,this.fieldid)},fieldGeneric.prototype.clearFieldError=function(){return this.model.resetFieldMessages(this.fieldname,"error",this.fieldid)},__decorate([core_1.ViewChild("focus",{read:core_1.ViewContainerRef,static:!(fieldGeneric.prototype.ngOnDestroy=function(){this.subscriptions.unsubscribe()})}),__metadata("design:type",core_1.ViewContainerRef)],fieldGeneric.prototype,"focuselement",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],fieldGeneric.prototype,"fieldname",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],fieldGeneric.prototype,"fieldconfig",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],fieldGeneric.prototype,"fielddisplayclass",void 0),__decorate([core_1.Component({selector:"field-generic",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig" [title]="value" [fieldid]="fieldid">{{value}}</field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control slds-m-vertical--xx-small" [ngClass]="css_classes"><input #focus [placeholder]="displayLabel ? \'\' : language.getFieldDisplayName(model.module, fieldname)" type="text" class="slds-input" [(ngModel)]="value" [maxlength]="fieldlength" [autocomplete]="fieldid" [ngModelOptions]="modelOptions"><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],fieldGeneric)}();exports.fieldGeneric=fieldGeneric;var fieldSet=function(){function e(e){this.metadata=e,this.fieldset="",this.fieldsetconfig={},this.fieldsetItems=[]}return e.prototype.ngOnInit=function(){this.fieldsetItems=this.metadata.getFieldSetItems(this.fieldset)},e.prototype.getFormClass=function(){if(this.fieldsetconfig.formclass)return this.fieldsetconfig.formclass},__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"fieldset",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"fieldsetconfig",void 0),__decorate([core_1.Component({selector:"field-set",template:'<div [ngClass]="getFormClass()"><ng-container *ngFor="let item of fieldsetItems"><field *ngIf="item.field" [field]="item"></field><field-set *ngIf="!item.field" [fieldset]="item.fieldset" [fieldsetconfig]="item.fieldconfig"></field-set></ng-container></div>',host:{"[class.slds-form-element]":"true"}}),__metadata("design:paramtypes",[services_1.metadata])],e)}();exports.fieldSet=fieldSet;var field=function(){function e(){this.field={}}return __decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"field",void 0),__decorate([core_1.Component({selector:"field",template:'<div class="slds-form-element"><field-label *ngIf="field.fieldconfig.hidelabel !== true" [fieldname]="field.field" [fieldconfig]="field.fieldconfig"></field-label><div class="slds-form-element__control"><field-container [field]="field.field" [fieldconfig]="field.fieldconfig"></field-container></div></div>',host:{"[class.slds-form-element]":"true"}})],e)}();exports.field=field;var fieldBlank=function(){function fieldBlank(){}return __decorate([core_1.Component({selector:"field-blank",template:'<div class="slds-truncate"></div>'})],fieldBlank)}();exports.fieldBlank=fieldBlank;var fieldLabel=function(){function fieldLabel(e,t,s,i,l,a,d){this.model=e,this.metadata=t,this.view=s,this.userPreferences=i,this.language=l,this.footer=a,this.injector=d,this.fieldname="",this.fieldconfig={},this.addclasses="slds-form-element__label",this.showHelp=!1}return Object.defineProperty(fieldLabel.prototype,"stati",{get:function(){var e=this.model.getFieldStati(this.fieldname);return!e.editable||this.view.isEditable&&!this.fieldconfig.readonly||(e.editable=!1),this.fieldconfig.required&&(e.required=!0),e},enumerable:!1,configurable:!0}),fieldLabel.prototype.isRequired=function(){return this.stati.editable&&this.stati.required},fieldLabel.prototype.isEditable=function(){return this.stati.editable},fieldLabel.prototype.isEditMode=function(){return!(!this.view.isEditMode()||!this.isEditable())},Object.defineProperty(fieldLabel.prototype,"hidden",{get:function(){return!!this.fieldconfig.hidelabel},enumerable:!1,configurable:!0}),Object.defineProperty(fieldLabel.prototype,"label",{get:function(){if(this.fieldconfig.label){if(0<this.fieldconfig.label.indexOf(":")){var e=this.fieldconfig.label.split(":");return this.language.getLabel(e[1],e[0],this.view.labels)}return this.language.getLabel(this.fieldconfig.label,this.model.module,this.view.labels)}return this.language.getFieldDisplayName(this.model.module,this.fieldname,this.fieldconfig,this.view.labels)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldLabel.prototype,"helpText",{get:function(){if(this.userPreferences.toUse.help_icon&&"hidden"==this.userPreferences.toUse.help_icon)return!1;if(this.fieldconfig.helpText){if(0<this.fieldconfig.helpText.indexOf(":")){var e=this.fieldconfig.helpText.split(":");return this.language.getLabel(e[1],e[0],this.view.labels)}return this.language.getLabel(this.fieldconfig.helpText,this.model.module,this.view.labels)}return this.language.getFieldHelpText(this.model.module,this.fieldname,this.fieldconfig)},enumerable:!1,configurable:!0}),fieldLabel.prototype.showContext=function(e){},__decorate([core_1.Input(),__metadata("design:type",String)],fieldLabel.prototype,"fieldname",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],fieldLabel.prototype,"fieldconfig",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],fieldLabel.prototype,"addclasses",void 0),__decorate([core_1.Component({selector:"field-label",template:'<div style="display: flow-root" (contextmenu)="showContext($event)"><label class="slds-truncate slds-float_left" [ngClass]="addclasses"><abbr *ngIf="stati.editable && stati.required" class="slds-required">*</abbr> <system-label-fieldname *ngIf="!fieldconfig.label" [field]="fieldname" [fieldconfig]="fieldconfig" [module]="model.module" [length]="view.labels"></system-label-fieldname> <system-label *ngIf="fieldconfig.label" [label]="fieldconfig.label" [length]="view.labels"></system-label></label><system-icon-help-text *ngIf="helpText" [helpText]="helpText"></system-icon-help-text></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.metadata,services_1.view,services_1.userpreferences,services_1.language,services_1.footer,core_1.Injector])],fieldLabel)}();exports.fieldLabel=fieldLabel;var fieldLabelPopover=function(){function e(e,t,s,i){this.language=e,this.elementRef=t,this.renderer=s,this.model=i,this.fieldlabel="",this.fieldname="",this.fieldconfig={},this.top="0px",this.left="0px"}return e.prototype.ngOnInit=function(){var t=this;this.top=this.event.pageY-22+"px",this.left=this.event.pageX+8+"px",this.clickListener=this.renderer.listen("document","click",function(e){return t.onClick(e)})},e.prototype.ngOnDestroy=function(){this.clickListener&&this.clickListener(),this.contextmenulistener&&this.contextmenulistener()},e.prototype.onClick=function(e){this.elementRef.nativeElement.contains(e.target)||(this.clickListener&&this.clickListener(),this.contextmenulistener&&this.contextmenulistener(),this.close())},Object.defineProperty(e.prototype,"popoverStyle",{get:function(){return{top:this.top,left:this.left}},enumerable:!1,configurable:!0}),e.prototype.close=function(){this.self.destroy()},__decorate([core_1.Component({template:'<div class="slds-is-fixed slds-popover slds-nubbin_left-top" role="dialog" [ngStyle]="popoverStyle"><button class="slds-button slds-button_icon slds-button_icon-small slds-float_right slds-popover__close" (click)="close()"><system-button-icon icon="close"></system-button-icon></button><header class="slds-popover__header"><h2 class="slds-text-heading_small">{{fieldlabel}}</h2></header><div class="slds-popover__body">fieldname: {{fieldname}} fieldtype:</div></div>'}),__param(3,core_1.Optional()),__metadata("design:paramtypes",[services_1.language,core_1.ElementRef,core_1.Renderer2,services_1.model])],e)}();exports.fieldLabelPopover=fieldLabelPopover;var fieldContainer=function(){function e(e,t,s,i){this.model=e,this.language=t,this.metadata=s,this.view=i,this.fieldconfig={},this.fielddisplayclass="slds-text-body--regular slds-truncate slds-m-vertical--small spice-fieldbody"}return Object.defineProperty(e.prototype,"fieldname",{get:function(){return this.field},set:function(e){this.field=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stati",{get:function(){return this.model.getFieldStati(this.field)},enumerable:!1,configurable:!0}),e.prototype.ngAfterViewInit=function(){this.buildContainer()},e.prototype.buildContainer=function(){var t=this;this.metadata.addComponent(this.getFieldType(),this.fieldcontainer).subscribe(function(e){e.instance.fieldname=t.field,e.instance.fieldconfig=t.fieldconfig,e.instance.fielddisplayclass=t.fielddisplayclass})},e.prototype.getFieldType=function(){var e="";if(!this.model.checkFieldAccess(this.field))return"fieldNotAuthorized";e="blank"===this.field?"blank":this.fieldconfig.fieldtype||this.metadata.getFieldType(this.model.module,this.field),e=this.metadata.getFieldTypeComponent(e);return e||"fieldGeneric"},__decorate([core_1.ViewChild("fieldcontainer",{read:core_1.ViewContainerRef,static:!0}),__metadata("design:type",core_1.ViewContainerRef)],e.prototype,"fieldcontainer",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"field",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"fieldconfig",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"fielddisplayclass",void 0),__decorate([core_1.Input(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],e.prototype,"fieldname",null),__decorate([core_1.Component({selector:"field-container",template:"<div [ngClass]=\"{'slds-hidden': stati.hidden}\"><div #fieldcontainer></div></div>"}),__metadata("design:paramtypes",[services_1.model,services_1.language,services_1.metadata,services_1.view])],e)}();exports.fieldContainer=fieldContainer;var fieldGenericDisplay=function(){function e(e,t,s,i){this.model=e,this.view=t,this.language=s,this.navigationtab=i,this.editable=!1,this.fieldconfig={},this.fielddisplayclass="",this.fieldid="",this._truncate=!0}return Object.defineProperty(e.prototype,"truncate",{set:function(e){this._truncate=!1},enumerable:!1,configurable:!0}),e.prototype.isEditMode=function(){return!(!this.view.isEditMode()||!this.editable)},Object.defineProperty(e.prototype,"fieldMaxWidth",{get:function(){if(this.editable)return{"max-width":"calc(100% - 20px)"}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"link",{get:function(){try{return this.fieldconfig.link&&this.model.checkAccess("detail")}catch(e){return!1}},enumerable:!1,configurable:!0}),e.prototype.setEditMode=function(){this.editable&&(this.model.startEdit(),this.view.setEditMode(this.fieldid))},e.prototype.goRecord=function(){var e;this.link&&this.model.goDetail(null===(e=this.navigationtab)||void 0===e?void 0:e.tabid)},__decorate([core_1.Input(),__metadata("design:type",Boolean)],e.prototype,"editable",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"fieldconfig",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"fielddisplayclass",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"fieldid",void 0),__decorate([core_1.Input("field-generic-display-notruncate"),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],e.prototype,"truncate",null),__decorate([core_1.Component({selector:"field-generic-display",template:'<div [ngClass]="fielddisplayclass" (dblclick)="setEditMode()"><system-stencil *ngIf="model.isLoading || view.isLoading; else displaycontent"></system-stencil><ng-template #displaycontent><div class="slds-size--1-of-1 slds-grid slds-grid--vertical-align-center slds-grid--align-spread" style="min-height: 19px;"><div class="slds-grow" [ngClass]="{\'slds-truncate\': _truncate}" [ngStyle]="fieldMaxWidth"><span *ngIf="link;else nolink" system-model-popover><ng-container *ngTemplateOutlet="content"></ng-container></span><ng-template #nolink><ng-container *ngTemplateOutlet="content"></ng-container></ng-template></div><button *ngIf="editable" class="slds-button slds-button--icon spice-button-icon-light slds-m-left--xx-small" (click)="setEditMode()"><system-button-icon [icon]="\'edit\'"></system-button-icon></button></div></ng-template><ng-template #content><ng-content></ng-content></ng-template></div>'}),__param(3,core_1.Optional()),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.navigationtab])],e)}();exports.fieldGenericDisplay=fieldGenericDisplay;var fieldText=function(n){function fieldText(e,t,s,i,l,a){var d=n.call(this,e,t,s,i,l)||this;return d.model=e,d.view=t,d.language=s,d.metadata=i,d.router=l,d.modalservice=a,d.speechRecognition=!1,d.fieldlength=0,d}return __extends(fieldText,n),fieldText.prototype.ngOnInit=function(){n.prototype.ngOnInit.call(this),window.webkitSpeechRecognition&&(this.speechRecognition=this.fieldconfig.speechRecognition),this.getFieldLength()},fieldText.prototype.getFieldLength=function(){var e=this.metadata.getFieldDefs(this.model.module,this.fieldname);e.len&&(this.fieldlength=e.len)},Object.defineProperty(fieldText.prototype,"maxLength",{get:function(){return 0<this.fieldlength?this.fieldlength:65e3},enumerable:!1,configurable:!0}),fieldText.prototype.resize=function(e){this.fixedHeight=e.height},fieldText.prototype.getTextAreaStyle=function(){var e=this.fieldconfig.minheight?this.fieldconfig.minheight.replace("px",""):38,e={"min-height":e+"px","max-height":(this.fieldconfig.maxheight?this.fieldconfig.maxheight.replace("px",""):300)+"px",height:this.fixedHeight?this.fixedHeight+"px":e+"px"};return!this.fixedHeight&&this.textField&&this.fieldconfig.maxheight&&(e.height=(this.textField.element.nativeElement.scrollHeight+2<this.fieldconfig.maxheight?this.textField.element.nativeElement.scrollHeight+2:this.fieldconfig.maxheight)+"px"),e},Object.defineProperty(fieldText.prototype,"truncated",{get:function(){return!!this.fieldconfig.truncate},enumerable:!1,configurable:!0}),fieldText.prototype.speechRecognitionStart=function(){var t=this;this.modalservice.openModal("SpeechRecognition",!1).subscribe(function(e){e.instance.textfield=t.textField})},fieldText.prototype.change=function(e){e.target.value&&(this.value=e.target.value)},Object.defineProperty(fieldText.prototype,"textLength",{get:function(){return this.value?this.value.length:0},enumerable:!1,configurable:!0}),__decorate([core_1.ViewChild("textField",{read:core_1.ViewContainerRef,static:!1}),__metadata("design:type",core_1.ViewContainerRef)],fieldText.prototype,"textField",void 0),__decorate([core_1.Component({selector:"field-text",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig" [fieldid]="fieldid"><div *ngIf="!truncated; else truncateddisplay" style="white-space: pre-line;">{{value}}</div><ng-template #truncateddisplay><div [title]="value" style="max-width: 200px; text-overflow: ellipsis" class="slds-truncate">{{value}}</div></ng-template></field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control slds-is-relative" [ngClass]="getFieldClass()" style="position:relative;"><textarea [maxlength]="maxLength" #focus #textField class="slds-textarea slds-scrollable--y slds-m-vertical--xx-small" [(ngModel)]="value" [ngStyle]="getTextAreaStyle()" (system-resize)="resize($event)" (change)="change($event)"></textarea> <button *ngIf="speechRecognition" class="slds-button slds-button_small slds-button_icon slds-is-absolute" style="right:8px;" (click)="speechRecognitionStart()"><system-button-icon [size]="\'small\'" [icon]="\'unmuted\'"></system-button-icon></button><div class="slds-grid slds-grid--vertical-align-center slds-grid--align-spread"><field-messages class="slds-grow" [fieldname]="fieldname"></field-messages><span *ngIf="fieldlength > 0">{{textLength}}/{{fieldlength}}</span></div></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,services_1.modal])],fieldText)}(fieldGeneric);exports.fieldText=fieldText;var fieldNumber=function(d){function fieldNumber(e,t,s,i,l){var a=d.call(this,e,t,s,i,l)||this;return a.model=e,a.view=t,a.language=s,a.metadata=i,a.router=l,a}return __extends(fieldNumber,d),Object.defineProperty(fieldNumber.prototype,"min",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(fieldNumber.prototype,"max",{get:function(){return 120},enumerable:!1,configurable:!0}),__decorate([core_1.Component({selector:"field-number",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig"><div class="slds-text-align_right">{{value}}</div></field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control slds-grid slds-grid--align-spread slds-p-around--xx-small" [ngClass]="getFieldClass()"><input class="slds-input slds-text-align_right" type="number" [min]="min" [max]="max" [(ngModel)]="value"><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],fieldNumber)}(fieldGeneric);exports.fieldNumber=fieldNumber;var fieldHtml=function(r){function fieldHtml(e,t,s,i,l,a,d,n){var o=r.call(this,e,t,s,i,l)||this;return o.model=e,o.view=t,o.language=s,o.metadata=i,o.router=l,o.zone=a,o.sanitized=d,o.modal=n,o.stylesheetField="",o.stylesheetToUse="",o.fullValue="",o.stylesheets=o.metadata.getHtmlStylesheetNames(),o}return __extends(fieldHtml,r),fieldHtml.prototype.ngOnInit=function(){var e=this.metadata.getFieldDefs(this.model.module,this.fieldname);_.isEmpty(e.stylesheet_id_field)||(this.stylesheetField=e.stylesheet_id_field),this.useStylesheets=!_.isEmpty(this.stylesheetField)&&!_.isEmpty(this.stylesheets),this.useStylesheets&&(1===this.stylesheets.length?this.stylesheetToUse=this.stylesheets[0].id:_.isEmpty(this.fieldconfig.stylesheetId)?this.stylesheetToUse=this.metadata.getHtmlStylesheetToUse(this.model.module,this.fieldname):this.stylesheetToUse=this.fieldconfig.stylesheetId),this.useStylesheetSwitcher=this.useStylesheets&&_.isEmpty(this.stylesheetToUse)},Object.defineProperty(fieldHtml.prototype,"styleTag",{get:function(){return this.useStylesheets&&!_.isEmpty(this.model.data[this.stylesheetField])?"<style>"+this.metadata.getHtmlStylesheetCode(this.model.data[this.stylesheetField])+"</style>":""},enumerable:!1,configurable:!0}),Object.defineProperty(fieldHtml.prototype,"sanitizedValue",{get:function(){return this.value&&(this.value.includes("</html>")?this.fullValue=this.value:this.fullValue="<html><head>"+this.styleTag+'</head><body class="spice">'+this.value+"</body></html>"),this.fullValue!=this.fullValue_cached&&(this._sanitizedValue=this.sanitized.bypassSecurityTrustResourceUrl(this.fullValue?"data:text/html;charset=UTF-8,"+encodeURIComponent(this.fullValue):""),this.fullValue_cached=this.fullValue),this._sanitizedValue},enumerable:!1,configurable:!0}),Object.defineProperty(fieldHtml.prototype,"stylesheetId",{get:function(){return _.isEmpty(this.model.data[this.stylesheetField])?this.stylesheetId=this.stylesheetToUse:this.model.data[this.stylesheetField]},set:function(e){e&&this.model.setField(this.stylesheetField,e)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldHtml.prototype,"asiframe",{get:function(){return!(!this.fieldconfig.asiframe&&_.isEmpty(this.fieldconfig.stylesheetId)&&_.isEmpty(this.stylesheetField))},enumerable:!1,configurable:!0}),fieldHtml.prototype.updateField=function(e){this.value=e,this.zone.run(function(){})},fieldHtml.prototype.updateStylesheet=function(e){!_.isEmpty(this.stylesheetField)&&_.isString(e)&&this.model.setField(this.stylesheetField,e)},fieldHtml.prototype.expand=function(){var t=this;this.modal.openModal("SystemTinyMCEModal",!1).subscribe(function(e){e.instance.title=t.getLabel(),e.instance.content=t.value,e.instance.stylesheetId=t.stylesheetId,e.instance.updateContent.subscribe(function(e){t.value=e})})},fieldHtml.prototype.eventHandler=function(e){this.value=e.srcElement.innerHTML},fieldHtml.prototype.getLabel=function(){if(this.fieldconfig.label){if(0<this.fieldconfig.label.indexOf(":")){var e=this.fieldconfig.label.split(":");return this.language.getLabel(e[1],e[0],this.view.labels)}return this.language.getLabel(this.fieldconfig.label,this.model.module,this.view.labels)}return this.language.getFieldDisplayName(this.model.module,this.fieldname,this.fieldconfig,this.view.labels)},__decorate([core_1.ViewChild("printframe",{read:core_1.ViewContainerRef,static:!0}),__metadata("design:type",core_1.ViewContainerRef)],fieldHtml.prototype,"printframe",void 0),__decorate([core_1.Component({selector:"field-html",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><div style="position:relative"><div style="position:absolute;right:0px;top:-21px;"><iframe #printframe [src]="sanitizedValue" style="width:0;height:0;border:0"></iframe><button *ngIf="isEditable() && !isEditMode()" class="slds-button slds-button--icon" (click)="setEditMode()"><system-button-icon [icon]="\'edit\'"></system-button-icon></button> <button *ngIf="isEditMode()" class="slds-button slds-button--icon" (click)="expand()" style="z-index: 1"><system-button-icon [icon]="\'expand\'"></system-button-icon></button></div></div><div *ngIf="!isEditMode()" class="slds-scrollable--y" style="max-height: 300px;" [ngClass]="fielddisplayclass"><div *ngIf="!asiframe" class="slds-size--1-of-1 html-text" [innerHTML]="sanitized.bypassSecurityTrustHtml(value)"></div><iframe *ngIf="asiframe" [src]="sanitizedValue" style="resize: vertical;" width="100%" frameborder="0" height="100%" seamless></iframe></div><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control" [ngClass]="getFieldClass()"><field-html-editor [fieldid]="fieldid" [fieldvalue]="value" [fieldconfig]="fieldconfig" [useStylesheets]="useStylesheets" [useStylesheetSwitcher]="useStylesheetSwitcher" [(stylesheetId)]="stylesheetId" (contentchange)="updateField($event)"></field-html-editor><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,core_1.NgZone,platform_browser_1.DomSanitizer,services_1.modal])],fieldHtml)}(fieldGeneric);exports.fieldHtml=fieldHtml;var fieldHtmlEditor=function(){function e(e,t,s,i){var l=this;this.metadata=e,this.footer=t,this.configurationService=s,this.modal=i,this.fieldvalue="",this.fieldid="",this.fieldconfig={},this.editor=null,this.stylesheets=[],this.stylesheetIdValue="",this.tinymceConfig={remove_script_host:!0,relative_urls:!1,menubar:!1,statusbar:!0,resize:!0,browser_spellcheck:!0,image_advtab:!0,paste_as_text:!0,paste_filter_drop:!0,plugins:["link","code","image","lists","paste","table"],toolbar:"undo redo | formatselect | styleselect bold italic removeformat | bullist numlist | link image table | code",skin_url:"vendor/tinymce/skins/lightgray",setup:function(t){(l.editor=t).on("change",function(){var e=t.getContent();l.content=e}),t.on("init",function(){l.fieldvalue&&l.editor.setContent(l.fieldvalue)})},formats:{alignleft:{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li,table,img",classes:"align-left"},aligncenter:{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li,table,img",classes:"align-center"},alignright:{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li,table,img",classes:"align-right"},alignjustify:{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li,table,img",classes:"align-justify"},strikethrough:{inline:"del"}},style_formats:[{title:"Inline",items:[{title:"fett",icon:"bold",format:"bold"},{title:"kursiv",icon:"italic",format:"italic"},{title:"unterstrichen",icon:"underline",format:"underline"},{title:"strikethrough",icon:"strikethrough",format:"strikethrough"},{title:"hochgestellt",icon:"superscript",format:"superscript"},{title:"tiefgestellt",icon:"subscript",format:"subscript"}]},{title:"Ausrichtung",items:[{title:"links",icon:"alignleft",format:"alignleft"},{title:"mittig",icon:"aligncenter",format:"aligncenter"},{title:"rechts",icon:"alignright",format:"alignright"},{title:"Blocksatz",icon:"alignjustify",format:"alignjustify"}]}],style_formats_merge:!1,body_class:"spice"},this.oldStylesheetId="",this.contentchange=new core_1.EventEmitter,this.stylesheetIdChange=new core_1.EventEmitter,this.stylesheets=this.metadata.getHtmlStylesheetNames()}return Object.defineProperty(e.prototype,"content",{get:function(){return this.fieldvalue},set:function(e){this.fieldvalue=e,this.contentchange.emit(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"input_stylesheetId",{set:function(e){this.stylesheetIdValue=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stylesheetId",{get:function(){return this.stylesheetIdValue},set:function(e){this.stylesheetIdValue=e,this.stylesheetIdChange.emit(e)},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){this.tinymceConfig.selector="#"+this.fieldid,this.tinymceConfig.document_base_url=this.configurationService.getFrontendUrl()},e.prototype.ngAfterViewInit=function(){var t=this;this.metadata.loadLibs("tinymce").subscribe(function(e){t.useStylesheets&&t.setStylesheet(),tinymce.init(t.tinymceConfig)})},e.prototype.changeStylesheet=function(){this.editor&&tinymce.remove(this.editor),this.setStylesheet(),tinymce.init(this.tinymceConfig)},e.prototype.setStylesheet=function(){var e;if(this.oldStylesheetId=this.stylesheetId,_.isEmpty(this.stylesheetId))delete this.tinymceConfig.content_style;else{if((e=this.metadata.getHtmlFormats(this.stylesheetId)).length){var t=0;this.tinymceConfig.block_formats="",this.tinymceConfig.extended_valid_elements=[],this.tinymceConfig.custom_elements=[],this.tinymceConfig.block_formats+="Absatz=p;",this.tinymceConfig.style_formats.push({title:"Weiteres",items:[]});for(var s=0,i=e;s<i.length;s++){var l,a=i[s];_.isEmpty(a.block)?this.tinymceConfig.style_formats[2].items.push({title:a.name,inline:a.inline,classes:a.classes,styles:a.styles}):(t++,l=void 0,this.tinymceConfig.formats[l="custom_format_"+t]={title:a.name,inline:a.inline,block:a.block,classes:a.classes,styles:a.styles,wrapper:Boolean(Number(a.wrapper))},this.tinymceConfig.block_formats+=a.name+"="+l+";",this.tinymceConfig.extended_valid_elements.indexOf(a.block)&&this.tinymceConfig.extended_valid_elements.push(a.block),this.tinymceConfig.custom_elements.indexOf(a.block)&&this.tinymceConfig.custom_elements.push(a.block))}0===this.tinymceConfig.style_formats[2].items.length&&this.tinymceConfig.style_formats.splice(2,1)}this.tinymceConfig.content_style=this.metadata.getHtmlStylesheetCode(this.stylesheetId)}},e.prototype.fullScreen=function(){var t=this;this.modal.openModal("SystemTinyMCEModal").subscribe(function(e){e.instance.content=t.fieldvalue,e.instance.updateContent.subscribe(function(e){t.fieldvalue=e,t.editor.setContent(e)})})},e.prototype.ngOnDestroy=function(){tinymce.remove(this.editor)},e.prototype.ngOnChanges=function(){this.editor&&this.fieldvalue&&this.editor.getContent()!==this.fieldvalue&&this.editor.setContent(this.fieldvalue),this.oldStylesheetId.length&&this.oldStylesheetId!=this.stylesheetId&&this.changeStylesheet()},__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"fieldvalue",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"fieldid",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"fieldconfig",void 0),__decorate([core_1.Input(),__metadata("design:type",Boolean)],e.prototype,"useStylesheetSwitcher",void 0),__decorate([core_1.Input(),__metadata("design:type",Boolean)],e.prototype,"useStylesheets",void 0),__decorate([core_1.Input("stylesheetId"),__metadata("design:type",String),__metadata("design:paramtypes",[String])],e.prototype,"input_stylesheetId",null),__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],e.prototype,"contentchange",void 0),__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],e.prototype,"stylesheetIdChange",void 0),__decorate([core_1.Component({selector:"field-html-editor",template:'<div class="slds-m-vertical--xx-small"><textarea style="height:250px" class="slds-textarea slds-scrollable--y slds-m-vertical--xx-small" [id]="fieldid"></textarea><select *ngIf="useStylesheetSwitcher" class="slds-select slds-m-top--x-small" [(ngModel)]="stylesheetId" (change)="changeStylesheet()"><option></option><option *ngFor="let sheet of stylesheets" value="{{sheet.id}}">{{sheet.name}}</option></select></div>',styles:[":host >>> .mce-ico{font-size: 12px; color: #54698d;}",":host >>> .mce-text{font-size: 12px; color: #54698d;}",":host >>> .mce-btn button{font-size: 12px; color: #54698d;}",":host >>> .mce-tinymce{border-radius: 4px}",":host >>> .mce-widget{font-family: 'Titillium Web', sans-serif;}"]}),__metadata("design:paramtypes",[services_1.metadata,services_1.footer,services_1.configurationService,services_1.modal])],e)}();exports.fieldHtmlEditor=fieldHtmlEditor;var fieldWYSIWYGEditor=function(){function e(e,t,s){this.model=e,this.view=t,this.language=s,this.fieldname="",this.fieldSelection=void 0}return Object.defineProperty(e.prototype,"fieldcontent",{get:function(){return this.model.data[this.fieldname]},enumerable:!1,configurable:!0}),e.prototype.ngAfterViewInit=function(){this.editor.element.nativeElement.innerHTML=this.model.data[this.fieldname]},e.prototype.eventHandler=function(e){this.fieldSelection=window.getSelection(),this.model.data[this.fieldname]=e.srcElement.innerHTML},e.prototype.onBlur=function(e){console.log(e)},__decorate([core_1.ViewChild("editor",{read:core_1.ViewContainerRef,static:!0}),__metadata("design:type",core_1.ViewContainerRef)],e.prototype,"editor",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"fieldname",void 0),__decorate([core_1.Component({selector:"field-wysiwyg-editor",template:'<div class="demo-only" style="min-height:180px;"><div class="slds-rich-text-editor slds-form-element slds-grid slds-grid_vertical slds-nowrap"><div role="toolbar" class="slds-rich-text-editor__toolbar slds-shrink-none"><ul aria-label="Format text" class="slds-button-group-list"><li><button class="slds-button slds-button_icon slds-button_icon-border-filled" tabindex="0" title="Provide description of action"><system-button-icon [icon]="\'bold\'"></system-button-icon><span class="slds-assistive-text">Bold</span></button></li><li><button class="slds-button slds-button_icon slds-button_icon-border-filled" tabindex="-1" title="Provide description of action"><system-button-icon [icon]="\'italic\'"></system-button-icon><span class="slds-assistive-text">Italic</span></button></li><li><button class="slds-button slds-button_icon slds-button_icon-border-filled" tabindex="-1" title="Provide description of action"><system-button-icon [icon]="\'underline\'"></system-button-icon><span class="slds-assistive-text">Underline</span></button></li><li><button class="slds-button slds-button_icon slds-button_icon-border-filled" tabindex="-1" title="Provide description of action"><system-button-icon [icon]="\'strikethrough\'"></system-button-icon><span class="slds-assistive-text">Strike Through</span></button></li></ul><ul aria-label="Format body" class="slds-button-group-list"><li><button class="slds-button slds-button_icon slds-button_icon-border-filled" tabindex="-1" title="Provide description of action"><system-button-icon [icon]="\'richtextbulletedlist\'"></system-button-icon><span class="slds-assistive-text">Bulleted List</span></button></li><li><button class="slds-button slds-button_icon slds-button_icon-border-filled" tabindex="-1" title="Provide description of action"><system-button-icon [icon]="\'richtextnumberedlist\'"></system-button-icon><span class="slds-assistive-text">Numbered List</span></button></li><li><button class="slds-button slds-button_icon slds-button_icon-border-filled" tabindex="-1" title="Provide description of action"><system-button-icon [icon]="\'richtextindent\'"></system-button-icon><span class="slds-assistive-text">Indent</span></button></li><li><button class="slds-button slds-button_icon slds-button_icon-border-filled" tabindex="-1" title="Provide description of action"><system-button-icon [icon]="\'richtextoutdent\'"></system-button-icon><span class="slds-assistive-text">Outdent</span></button></li></ul><ul aria-label="Remove Formatting" class="slds-button-group-list"><li><button class="slds-button slds-button_icon slds-button_icon-border-filled" tabindex="-1" title="Provide description of action"><system-button-icon [icon]="\'remove_formatting\'"></system-button-icon><span class="slds-assistive-text">Remove Formatting</span></button></li></ul></div><div class="slds-rich-text-editor__textarea slds-grid"><div #editor aria-label="Compose text" contenteditable="true" class="slds-rich-text-area__content slds-text-color_weak slds-grow" (input)="eventHandler($event)" (change)="onBlur($event)"></div></div></div></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language])],e)}();exports.fieldWYSIWYGEditor=fieldWYSIWYGEditor;var fieldFloat=function(n){function fieldFloat(e,t,s,i,l,a){var d=n.call(this,e,t,s,i,l)||this;return d.model=e,d.view=t,d.language=s,d.metadata=i,d.router=l,d.userpreferences=a,d.textvalue="",d}return __extends(fieldFloat,n),fieldFloat.prototype.ngOnInit=function(){var e=this;this.textvalue=this.getValAsText(),this.subscriptions.add(this.model.data$.subscribe(function(){e.textvalue=e.getValAsText()}))},fieldFloat.prototype.getValAsText=function(){if(void 0===this.value)return"";var e=parseFloat(this.value);return isNaN(e)?"":this.userpreferences.formatMoney(e)},fieldFloat.prototype.checkInput=function(e){!/^[0-9.,]+$/.test(e.key)&&["ArrowRight","ArrowLeft","Backspace","Delete"].indexOf(e.key)<0&&(e.preventDefault(),console.log(e.key))},fieldFloat.prototype.changed=function(){var e=this,t=this.inputel.nativeElement.selectionEnd,s=this.textvalue;s=(s=s.split(this.userpreferences.toUse.num_grp_sep).join("")).split(this.userpreferences.toUse.dec_sep).join("."),isNaN(s=parseFloat(s))?this.value="":this.value=Math.round(s*Math.pow(10,this.userpreferences.toUse.default_currency_significant_digits))/Math.pow(10,this.userpreferences.toUse.default_currency_significant_digits),this.textvalue=this.getValAsText(),setTimeout(function(){e.inputel.nativeElement.selectionEnd=t})},__decorate([core_1.ViewChild("floatinput",{static:!1}),__metadata("design:type",core_1.ElementRef)],fieldFloat.prototype,"inputel",void 0),__decorate([core_1.Component({selector:"field-float",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [fieldconfig]="fieldconfig" [editable]="isEditable()"><div class="slds-text-align_right"><span>{{getValAsText()}}</span></div></field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control" [ngClass]="getFieldClass()"><div class="slds-form-element slds-m-vertical--xx-small"><input #floatinput class="slds-input slds-text-align--right" type="text" (keydown)="checkInput($event)" (keyup)="changed()" [(ngModel)]="textvalue"></div><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,services_1.userpreferences])],fieldFloat)}(fieldGeneric);exports.fieldFloat=fieldFloat;var fieldCurrency=function(o){function fieldCurrency(e,t,s,i,l,a,d){var n=o.call(this,e,t,s,i,l)||this;return n.model=e,n.view=t,n.language=s,n.metadata=i,n.router=l,n.currency=a,n.userpreferences=d,n.textvalue="",n.currencies=[],n.currencyidfield="",n.currencies=n.currency.getCurrencies(),n}return __extends(fieldCurrency,o),fieldCurrency.prototype.ngOnInit=function(){var e=this;this.currencyidfield=this.fieldconfig.field_currencyid,this.currencyidfield||this.metadata.getModuleFields(this.model.module).currency_id&&(this.currencyidfield="currency_id"),this.setDefaultCurrencyId(),this.textvalue=this.getValAsText(),this.subscriptions.add(this.model.data$.subscribe(function(){e.textvalue=e.getValAsText()})),this.setCurrencyFromPreferences()},fieldCurrency.prototype.setDefaultCurrencyId=function(){var e;this.currencyidfield&&(this.model.getField(this.currencyidfield)||(e=this.userpreferences.getPreference("currency"),this.currencyId=e||"-99"))},Object.defineProperty(fieldCurrency.prototype,"currencyId",{get:function(){return this.currencyidfield?this.model.getField(this.currencyidfield):-99},set:function(e){this.currencyidfield&&this.model.setField(this.currencyidfield,e)},enumerable:!1,configurable:!0}),fieldCurrency.prototype.getCurrencySymbol=function(){var t,s=-99;if(this.currencyidfield){if(!this.model.data[this.currencyidfield])return"";s=this.model.data[this.currencyidfield]}return this.currencies.some(function(e){if(e.id==s)return t=e.symbol,!0}),t},fieldCurrency.prototype.getValAsText=function(){if(void 0===this.value)return"";var e=parseFloat(this.value);return isNaN(e)?"":this.userpreferences.formatMoney(e)},fieldCurrency.prototype.checkInput=function(e){!/^[0-9.,]+$/.test(e.key)&&["ArrowRight","ArrowLeft","Backspace","Delete"].indexOf(e.key)<0&&(e.preventDefault(),console.log(e.key))},fieldCurrency.prototype.changed=function(){var e=this,t=this.inputel.nativeElement.selectionEnd,s=this.textvalue;s=(s=s.split(this.userpreferences.toUse.num_grp_sep).join("")).split(this.userpreferences.toUse.dec_sep).join("."),isNaN(s=parseFloat(s))?this.value="":this.value=Math.round(s*Math.pow(10,this.userpreferences.toUse.default_currency_significant_digits))/Math.pow(10,this.userpreferences.toUse.default_currency_significant_digits),this.textvalue=this.getValAsText(),setTimeout(function(){e.inputel.nativeElement.selectionEnd=t})},fieldCurrency.prototype.handleViewModeChange=function(e){"edit"==e&&this.setCurrencyFromPreferences(),o.prototype.handleViewModeChange.call(this,e)},__decorate([core_1.ViewChild("floatinput",{static:!(fieldCurrency.prototype.setCurrencyFromPreferences=function(){this.currencyidfield&&!this.model.data[this.currencyidfield]&&(this.model.data[this.currencyidfield]=this.userpreferences.toUse.currency)})}),__metadata("design:type",core_1.ElementRef)],fieldCurrency.prototype,"inputel",void 0),__decorate([core_1.Component({selector:"field-currency",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [fieldconfig]="fieldconfig" [editable]="isEditable()"><div class="slds-grid slds-grid--align-end"><system-display-number [number]="value" [currency_id]="currencyId"></system-display-number></div></field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control" [ngClass]="getFieldClass()"><div class="slds-grid slds-m-vertical--xx-small"><div *ngIf="currencyidfield" class="slds-form-element slds-p-right--x-small" [ngClass]="{\'slds-size--1-of-4\':!fieldconfig.currencyReadonly}"><div *ngIf="fieldconfig.currencyReadonly" class="slds-height_full slds-align--absolute-center slds-p-around--none" style="border-color:transparent">{{getCurrencySymbol()}}</div><div *ngIf="!fieldconfig.currencyReadonly" class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="currencyId"><option *ngFor="let currency of currencies" [value]="currency.id">{{currency.iso}} ({{currency.symbol}})</option></select></div></div></div><div class="slds-form-element slds-grow"><input #floatinput class="slds-input slds-text-align--right" (keydown)="checkInput($event)" (keyup)="changed()" [(ngModel)]="textvalue"></div></div><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,services_1.currency,services_1.userpreferences])],fieldCurrency)}(fieldGeneric),fieldWeightedAmount=function(o){function fieldWeightedAmount(e,t,s,i,l,a,d){var n=o.call(this,e,t,s,i,l,a,d)||this;return n.model=e,n.view=t,n.language=s,n.metadata=i,n.router=l,n.currency=a,n.userpreferences=d,n.currencies=n.currency.getCurrencies(),n}return __extends(fieldWeightedAmount,o),Object.defineProperty(fieldWeightedAmount.prototype,"amountfield",{get:function(){return this.fieldconfig.field_amount||"amount"},enumerable:!1,configurable:!0}),Object.defineProperty(fieldWeightedAmount.prototype,"probabilityfield",{get:function(){return this.fieldconfig.field_probability||"probability"},enumerable:!1,configurable:!0}),fieldWeightedAmount.prototype.getValue=function(){try{var e=this.model.getFieldValue("amount")?parseFloat(this.model.getFieldValue(this.amountfield)):0,t=this.model.getFieldValue("amount")?parseFloat(this.model.getFieldValue(this.probabilityfield)):0;return this.userpreferences.formatMoney(e*t/100)}catch(e){return 0}},__decorate([core_1.Component({selector:"field-currency",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display [fielddisplayclass]="fielddisplayclass" [fieldconfig]="fieldconfig" [editable]="false"><div class="slds-grid slds-grid--align-spread"><div>{{getCurrencySymbol()}}</div><div cass="slds-text-align--right"><span>{{getValue()}}</span></div></div></field-generic-display>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,services_1.currency,services_1.userpreferences])],fieldWeightedAmount)}(exports.fieldCurrency=fieldCurrency);exports.fieldWeightedAmount=fieldWeightedAmount;var fieldTotalAmount=function(o){function fieldTotalAmount(e,t,s,i,l,a,d){var n=o.call(this,e,t,s,i,l,a,d)||this;return n.model=e,n.view=t,n.language=s,n.metadata=i,n.router=l,n.currency=a,n.userpreferences=d,n.currencies=[],n.currencies=n.currency.getCurrencies(),n}return __extends(fieldTotalAmount,o),Object.defineProperty(fieldTotalAmount.prototype,"sumfields",{get:function(){var e=[];if(this.fieldconfig.sumfields)for(var t=0,s=this.fieldconfig.sumfields.split(",");t<s.length;t++){var i=s[t];e.push(i.trim())}return e},enumerable:!1,configurable:!0}),fieldTotalAmount.prototype.getValue=function(){for(var e=0,t=0,s=this.sumfields;t<s.length;t++){var i=s[t],i=this.model.getFieldValue(i);i&&(e+=parseFloat(i))}return this.model.data[this.fieldname]=e,this.userpreferences.formatMoney(e)},__decorate([core_1.Component({selector:"field-currency",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display [fielddisplayclass]="fielddisplayclass" [fieldconfig]="fieldconfig" [editable]="false"><div class="slds-grid slds-grid--align-spread"><div>{{getCurrencySymbol()}}</div><div cass="slds-text-align--right"><span>{{getValue()}}</span></div></div></field-generic-display>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,services_1.currency,services_1.userpreferences])],fieldTotalAmount)}(fieldCurrency);exports.fieldTotalAmount=fieldTotalAmount;var fieldEnum=function(d){function fieldEnum(e,t,s,i,l){var a=d.call(this,e,t,s,i,l)||this;return a.model=e,a.view=t,a.language=s,a.metadata=i,a.router=l,a.options=[],a.subscriptions.add(a.language.currentlanguage$.subscribe(function(e){a.getOptions()})),a}return __extends(fieldEnum,d),fieldEnum.prototype.ngOnInit=function(){d.prototype.ngOnInit.call(this),this.getOptions()},fieldEnum.prototype.getValue=function(){return this.language.getFieldDisplayOptionValue(this.model.module,this.fieldname,this.value)},fieldEnum.prototype.getOptions=function(){var e,t=[],s=this.language.getFieldDisplayOptions(this.model.module,this.fieldname);for(e in s)t.push({value:e,display:s[e]});if(this.options=t,this.fieldconfig.sortdirection)switch(this.fieldconfig.sortdirection.toLowerCase()){case"desc":this.options.sort(function(e,t){return e.display.toLowerCase()<t.display.toLowerCase()?1:-1});break;case"asc":this.options.sort(function(e,t){return e.display.toLowerCase()>t.display.toLowerCase()?1:-1})}},__decorate([core_1.Component({selector:"field-enum",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig" [fieldid]="fieldid">{{getValue()}}</field-generic-display><div *ngIf="isEditMode()" class="slds-form-element"><div class="slds-form-element__control" [ngClass]="getFieldClass()"><div class="slds-select_container slds-m-vertical--xx-small"><select #focus class="slds-select" [(ngModel)]="value"><option *ngFor="let o of options" [value]="o.value">{{o.display}}</option></select></div><field-messages [fieldname]="fieldname"></field-messages></div></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],fieldEnum)}(fieldGeneric);exports.fieldEnum=fieldEnum;var fieldLanguage=function(d){function fieldLanguage(e,t,s,i,l){var a=d.call(this,e,t,s,i,l)||this;return a.model=e,a.view=t,a.language=s,a.metadata=i,a.router=l,a.displayValue="",a.options=[],a}return __extends(fieldLanguage,d),fieldLanguage.prototype.ngOnInit=function(){d.prototype.ngOnInit.call(this),this.getOptions(),this.subscribeToDataChanges()},fieldLanguage.prototype.getOptions=function(){this.options=this.language.getAvialableLanguages().map(function(e){return{value:e.language,display:e.text}}),this.fieldconfig.canBeEmpty&&this.options.unshift({value:"",display:""})},fieldLanguage.prototype.subscribeToDataChanges=function(){var t=this;this.subscriptions.add(this.model.data$.subscribe(function(e){e[t.fieldname]&&t.value!=e[t.fieldname]&&(t.value=e[t.fieldname]),t.displayValue!=t.value&&t.setDisplayValue()}))},fieldLanguage.prototype.setDisplayValue=function(){var t=this,e=this.options.find(function(e){return e.value==t.model.data[t.fieldname]});this.displayValue=(null==e?void 0:e.display)||""},__decorate([core_1.Component({selector:"field-enum",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig">{{displayValue}}</field-generic-display><div *ngIf="isEditMode()" class="slds-form-element"><div class="slds-form-element__control" [ngClass]="getFieldClass()"><div class="slds-select_container slds-m-vertical--xx-small"><select class="slds-select" [(ngModel)]="value"><option *ngFor="let o of options" [value]="o.value">{{o.display}}</option></select></div><field-messages [fieldname]="fieldname"></field-messages></div></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],fieldLanguage)}(fieldGeneric);exports.fieldLanguage=fieldLanguage;var fieldEmailTo=function(n){function fieldEmailTo(e,t,s,i,l,a){var d=n.call(this,e,t,s,i,l)||this;return d.model=e,d.view=t,d.language=s,d.metadata=i,d.router=l,d.backend=a,d.loadingOptions=!1,d}return __extends(fieldEmailTo,n),__decorate([core_1.Component({selector:"field-email-to",template:'<div class="slds-form-element"><field-label [fieldname]="\'to_addrs_names\'"></field-label><div class="slds-form-element__control"><div class="slds-pill_container" *ngFor="let toAddr of model.data.to_addrs_names"><span class="slds-pill"><a href="javascript:void(0);" class="slds-pill__label">{{toAddr.displayname}}</a> <button class="slds-button slds-button--icon slds-pill__remove"><system-button-icon [icon]="\'close\'"></system-button-icon></button></span></div></div></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,services_1.backend])],fieldEmailTo)}(fieldGeneric);exports.fieldEmailTo=fieldEmailTo;var fieldEmailTemplates=function(r){function fieldEmailTemplates(e,t,s,i,l,a,d,n){var o=r.call(this,e,t,s,i,l)||this;return o.model=e,o.view=t,o.language=s,o.metadata=i,o.router=l,o.backend=a,o.modal=d,o.configuration=n,o.isLoaded=!1,o.availableTemplates=[],o}return __extends(fieldEmailTemplates,r),Object.defineProperty(fieldEmailTemplates.prototype,"subjectField",{get:function(){return this.fieldconfig.subject||"name"},enumerable:!1,configurable:!0}),Object.defineProperty(fieldEmailTemplates.prototype,"bodyField",{get:function(){return this.fieldconfig.body||"body"},enumerable:!1,configurable:!0}),Object.defineProperty(fieldEmailTemplates.prototype,"addtocurrentquote",{get:function(){return 1==this.fieldconfig.addtocurrentquote},enumerable:!1,configurable:!0}),Object.defineProperty(fieldEmailTemplates.prototype,"isDisabled",{get:function(){return!this.model.getFieldValue("parent_type")||""==this.model.getFieldValue("parent_type")||!this.isLoaded||0==this.availableTemplates.length},enumerable:!1,configurable:!0}),fieldEmailTemplates.prototype.getValue=function(){for(var e=0,t=this.availableTemplates;e<t.length;e++){var s=t[e];if(s.id==this.value)return s.name}},fieldEmailTemplates.prototype.ngOnInit=function(){var t=this,e=this.configuration.getData("EmailTemplates");e?(this.availableTemplates=e.filter(function(e){return"email"==e.type&&("*"==e.for_bean||e.for_bean==t.model.getFieldValue("parent_type"))}),this.isLoaded=!0):this.backend.getRequest("module/EmailTemplates",{start:0,limit:500,listid:"all"}).subscribe(function(e){t.configuration.setData("EmailTemplates",e.list),t.availableTemplates=e.list.filter(function(e){return"email"==e.type&&("*"==e.for_bean||e.for_bean==t.model.getFieldValue("parent_type"))}),t.isLoaded=!0})},fieldEmailTemplates.prototype.chooseTemplate=function(e){var i=this;""!=this.value&&this.modal.openModal("SystemLoadingModal",!1).subscribe(function(s){i.backend.getRequest("module/EmailTemplates/"+i.value+"/parse/"+i.model.getFieldValue("parent_type")+"/"+i.model.getFieldValue("parent_id")).subscribe(function(e){var t;i.model.data[i.subjectField]||i.model.setField(i.subjectField,e.subject),i.addtocurrentquote?((t=document.implementation.createHTMLDocument("Virtual Document")).documentElement.innerHTML=i.model.getFieldValue(i.bodyField),t=t.querySelectorAll(".spicecrm_quote"),i.model.setField(i.bodyField,e.body_html+t[0].outerHTML)):i.model.setField(i.bodyField,e.body_html),s.instance.self.destroy()})})},__decorate([core_1.Component({selector:"field-email-templates",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><div *ngIf="!isEditMode()"><system-stencil *ngIf="model.isLoading; else displaycontent"></system-stencil><ng-template #displaycontent><div class="slds-grid" [ngClass]="fielddisplayclass"><div class="slds-truncate">{{getValue()}}</div><button *ngIf="isEditable()" class="slds-button slds-button--icon slds-col_bump-left slds-p-left--xx-small" (click)="setEditMode()"><system-button-icon [icon]="\'edit\'"></system-button-icon></button></div></ng-template></div><div *ngIf="isEditMode()" class="slds-form-element"><div class="slds-form-element__control" [ngClass]="getFieldClass()"><div class="slds-select_container slds-m-vertical--xx-small"><select class="slds-select" [disabled]="isDisabled" [(ngModel)]="value" (change)="chooseTemplate($event)"><option></option><option *ngFor="let template of availableTemplates" [ngValue]="template.id">{{template.summary_text}}</option></select></div><field-messages [fieldname]="fieldname"></field-messages></div></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,services_1.backend,services_1.modal,services_1.configurationService])],fieldEmailTemplates)}(fieldGeneric);exports.fieldEmailTemplates=fieldEmailTemplates;var fieldTextMessageTemplates=function(r){function fieldTextMessageTemplates(e,t,s,i,l,a,d,n){var o=r.call(this,e,t,s,i,l)||this;return o.model=e,o.view=t,o.language=s,o.metadata=i,o.router=l,o.backend=a,o.modal=d,o.configuration=n,o.isLoaded=!1,o.availableTemplates=[],o}return __extends(fieldTextMessageTemplates,r),Object.defineProperty(fieldTextMessageTemplates.prototype,"bodyField",{get:function(){return this.fieldconfig.body||"description"},enumerable:!1,configurable:!0}),Object.defineProperty(fieldTextMessageTemplates.prototype,"isDisabled",{get:function(){return!this.model.getFieldValue("parent_type")||""==this.model.getFieldValue("parent_type")||!this.isLoaded||0==this.availableTemplates.length},enumerable:!1,configurable:!0}),fieldTextMessageTemplates.prototype.getValue=function(){for(var e=0,t=this.availableTemplates;e<t.length;e++){var s=t[e];if(s.id==this.value)return s.name}},fieldTextMessageTemplates.prototype.ngOnInit=function(){var t=this,e=this.configuration.getData("TextMessageTemplates");e?(this.availableTemplates=e.filter(function(e){return"*"==e.parent_type||e.parent_type==t.model.getFieldValue("parent_type")}),this.isLoaded=!0):this.backend.getRequest("module/TextMessageTemplates",{start:0,limit:500,listid:"all"}).subscribe(function(e){t.configuration.setData("TextMessageTemplates",e.list),t.availableTemplates=e.list.filter(function(e){return"*"==e.parent_type||e.parent_type==t.model.getFieldValue("parent_type")}),t.isLoaded=!0})},fieldTextMessageTemplates.prototype.chooseTemplate=function(e){var s=this;""!=this.value&&this.modal.openModal("SystemLoadingModal",!1).subscribe(function(t){s.backend.getRequest("module/TextMessageTemplates/"+s.value+"/parse/"+s.model.getFieldValue("parent_type")+"/"+s.model.getFieldValue("parent_id")).subscribe(function(e){s.model.setField(s.bodyField,e.description),t.instance.self.destroy()})})},__decorate([core_1.Component({selector:"field-textmessage-templates",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><div *ngIf="!isEditMode()"><system-stencil *ngIf="model.isLoading; else displaycontent"></system-stencil><ng-template #displaycontent><div class="slds-grid" [ngClass]="fielddisplayclass"><div class="slds-truncate">{{getValue()}}</div><button *ngIf="isEditable()" class="slds-button slds-button--icon slds-col_bump-left slds-p-left--xx-small" (click)="setEditMode()"><system-button-icon [icon]="\'edit\'"></system-button-icon></button></div></ng-template></div><div *ngIf="isEditMode()" class="slds-form-element"><div class="slds-form-element__control" [ngClass]="getFieldClass()"><div class="slds-select_container slds-m-vertical--xx-small"><select class="slds-select" [disabled]="isDisabled" [(ngModel)]="value" (change)="chooseTemplate($event)"><option *ngFor="let template of availableTemplates" [ngValue]="template.id">{{template.name}}</option></select></div><field-messages [fieldname]="fieldname"></field-messages></div></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,services_1.backend,services_1.modal,services_1.configurationService])],fieldTextMessageTemplates)}(fieldGeneric);exports.fieldTextMessageTemplates=fieldTextMessageTemplates;var fieldMailRelais=function(n){function fieldMailRelais(e,t,s,i,l,a){var d=n.call(this,e,t,s,i,l)||this;return d.model=e,d.view=t,d.language=s,d.metadata=i,d.router=l,d.backend=a,d.options=[],d.loadingOptions=!1,d}return __extends(fieldMailRelais,n),fieldMailRelais.prototype.getValue=function(){this.getOptions();for(var e=0;e<this.options.length;e++)if(this.options[e].value==this.model.data[this.fieldname])return this.options[e].display},fieldMailRelais.prototype.getOptions=function(){var t=this;if(!this.loadingOptions){if(0<this.options.length)return this.options;this.loadingOptions=!0,this.backend.getRequest("campaigns/getMailRelais").subscribe(function(e){return t.options=e,t.loadingOptions=!1,t.options})}},Object.defineProperty(fieldMailRelais.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),fieldMailRelais.prototype.getDisplay=function(){return!(this.model.data.acl&&!this.model.data.acl.edit)&&("Email"===this.model.data.campaign_type&&!this.model.isEditing)},fieldMailRelais.prototype.getEditDisplay=function(){return"Email"===this.model.data.campaign_type},__decorate([core_1.Component({selector:"field-mail-relais",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><div *ngIf="!isEditMode() && getDisplay()" [ngClass]="fielddisplayclass"><system-stencil *ngIf="model.isLoading; else displaycontent"></system-stencil><ng-template #displaycontent><span>{{getValue()}}</span> <button *ngIf="isEditable()" style="float: right" class="slds-button slds-button--icon" (click)="setEditMode()"><system-button-icon [icon]="\'edit\'"></system-button-icon></button></ng-template></div><div *ngIf="isEditMode() && isEditable() && getEditDisplay()" class="slds-form-element"><div class="slds-form-element__control" [ngClass]="getFieldClass()"><div class="slds-select_container slds-m-vertical--xx-small"><select class="slds-select" [(ngModel)]="model.data[fieldname]"><ng-container *ngFor="let o of getOptions()"><option [value]="o.value">{{o.display}}</option></ng-container></select></div><field-messages [fieldname]="fieldname"></field-messages></div></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,services_1.backend])],fieldMailRelais)}(fieldGeneric);exports.fieldMailRelais=fieldMailRelais;var fieldMultienum=function(d){function fieldMultienum(e,t,s,i,l){var a=d.call(this,e,t,s,i,l)||this;return a.model=e,a.view=t,a.language=s,a.metadata=i,a.router=l,a.options=[],a.subscriptions.add(a.language.currentlanguage$.subscribe(function(e){a.buildOptions()})),a}return __extends(fieldMultienum,d),fieldMultienum.prototype.ngOnInit=function(){this.buildOptions()},Object.defineProperty(fieldMultienum.prototype,"columns",{get:function(){return this.fieldconfig.columns?parseInt(this.fieldconfig.columns,10):4},enumerable:!1,configurable:!0}),Object.defineProperty(fieldMultienum.prototype,"displayCheckboxes",{get:function(){return!!this.fieldconfig.displaycheckboxes},enumerable:!1,configurable:!0}),fieldMultienum.prototype.getValue=function(){for(var e=[],t=0,s=this.getValueArray();t<s.length;t++){var i=s[t],i=this.language.getFieldDisplayOptionValue(this.model.module,this.fieldname,i);i&&e.push(i)}return e.join(", ")},fieldMultienum.prototype.getValueArray=function(){try{var e=this.model.getFieldValue(this.fieldname);return(e="^"==e.substr(0,1)?e.substr(1,e.length-2):e).split("^,^")}catch(e){return[]}},fieldMultienum.prototype.buildOptions=function(){this.options=[];var e,t=this.language.getFieldDisplayOptions(this.model.module,this.fieldname),s=0;for(e in t)s++;var i,l=s/this.columns,a=[];for(i in t)a.push({id:this.model.generateGuid(),value:i,display:t[i]}),a.length>=l&&(this.options.push(a),a=[]);0<a.length&&this.options.push(a)},__decorate([core_1.Component({selector:"field-multienum",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig"><span *ngIf="!displayCheckboxes">{{getValue()}}</span><div *ngIf="displayCheckboxes" class="slds-grid slds-grid--align-spread"><div class="slds-form-element__control" *ngFor="let row of options" [ngClass]="getFieldClass()"><field-multienum-checkbox disabled="true" class="slds-checkbox" *ngFor="let option of row" [fieldname]="fieldname" [option]="option"></field-multienum-checkbox></div></div></field-generic-display><div *ngIf="isEditMode()" class="slds-form-element"><div class="slds-grid slds-grid--align-spread"><div class="slds-form-element__control" *ngFor="let row of options" [ngClass]="getFieldClass()"><field-multienum-checkbox class="slds-checkbox" *ngFor="let option of row" [fieldname]="fieldname" [option]="option"></field-multienum-checkbox></div></div><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],fieldMultienum)}(fieldGeneric);exports.fieldMultienum=fieldMultienum;var fieldGroupedEnum=function(t){function fieldGroupedEnum(){var e=null!==t&&t.apply(this,arguments)||this;return e.groups=[],e.fieldconfig={},e.localValue={valueText:"",valueArray:[],valueDisplay:"",valueGroups:{}},e.columnsClass="slds-size--1-of-4",e}return __extends(fieldGroupedEnum,t),fieldGroupedEnum.prototype.ngOnInit=function(){this.setColumnsClass(),this.buildOptionGroups(),this.setLocalValues(this.value),this.subscribeToLanguage(),this.subscribeToModelChanges()},fieldGroupedEnum.prototype.setColumnsClass=function(){var e=+this.fieldconfig.columns<13&&0<+this.fieldconfig.columns?this.fieldconfig.columns:"4";this.columnsClass="slds-size--1-of-"+e},fieldGroupedEnum.prototype.subscribeToLanguage=function(){var e=this;this.subscriptions.add(this.language.currentlanguage$.subscribe(function(){return e.buildOptionGroups()}))},fieldGroupedEnum.prototype.setLocalValues=function(e){var t=this;if(!e)return this.localValue={valueText:"",valueArray:[],valueDisplay:"",valueGroups:{}};var s=this.language.getFieldDisplayOptions(this.model.module,this.fieldname),i=e.replace(/\^/g,"").split(",").map(function(e){return e.trim()});this.localValue={valueText:e,valueArray:i,valueDisplay:i.map(function(e){return s[e]}).join(", "),valueGroups:{}};var l=null!==(i=this.fieldconfig.groupSeparator)&&void 0!==i?i:"_";this.localValue.valueArray.forEach(function(e){t.localValue.valueGroups[e]=!e.includes(l)})},fieldGroupedEnum.prototype.subscribeToModelChanges=function(){var t=this;this.subscriptions.add(this.model.data$.subscribe(function(e){t.localValue.valueText!==e[t.fieldname]&&t.setLocalValues(e[t.fieldname])}))},fieldGroupedEnum.prototype.setItemValue=function(e){e=e.map(function(e){return"^"+e+"^"}).join(",");this.setLocalValues(e),this.value=e},fieldGroupedEnum.prototype.setGroupValue=function(e,t){var s=this.value;e?-1==this.localValue.valueArray.indexOf(t.value)&&(s=this.localValue.valueText+",^"+t.value+"^"):s=this.localValue.valueArray.filter(function(e){return e!==t.value}).map(function(e){return"^"+e+"^"}).join(","),this.setLocalValues(s),this.value=s},fieldGroupedEnum.prototype.trackByFn=function(e,t){return t.value},fieldGroupedEnum.prototype.buildOptionGroups=function(){var e;this.groups=[];var t=this.language.getFieldDisplayOptions(this.model.module,this.fieldname,!0),s=null!==(e=this.fieldconfig.groupSeparator)&&void 0!==e?e:"_",i=t.filter(function(e){return e.value.includes(s)});this.groups=t.filter(function(e){return!e.value.includes(s)}).map(function(t){return __assign(__assign({},t),{options:i.filter(function(e){return e.value.startsWith(t.value)})})})},__decorate([core_1.Input(),__metadata("design:type",Object)],fieldGroupedEnum.prototype,"fieldconfig",void 0),__decorate([core_1.Component({selector:"field-grouped-enum",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig"><span *ngIf="!fieldconfig.displayCheckboxes">{{localValue.valueDisplay}}</span><div *ngIf="!!fieldconfig.displayCheckboxes"><div *ngFor="let group of groups; trackBy: trackByFn" class="slds-m-bottom--medium"><div class="slds-p-vertical--xx-small slds-text-title_bold"><system-checkbox [ngModel]="group.value" [disabled]="true">{{group.display}}</system-checkbox></div><div class="slds-form-element__control" [ngClass]="css_classes"><system-checkbox-group [ngModel]="localValue.valueArray" class="slds-grid slds-wrap slds-p-vertical--xxx-small"><div *ngFor="let option of group.options; trackBy: trackByFn" class="slds-truncate" [ngClass]="columnsClass"><system-checkbox-group-checkbox [value]="option.value" [disabled]="true">{{option.display}}</system-checkbox-group-checkbox></div></system-checkbox-group></div></div></div></field-generic-display><div *ngIf="isEditMode()" class="slds-form-element"><div *ngFor="let group of groups; trackBy: trackByFn" class="slds-m-bottom--medium"><div class="slds-p-vertical--xx-small slds-text-title_bold"><system-checkbox [ngModel]="this.localValue.valueGroups[group.value]" (ngModelChange)="setGroupValue($event, group)">{{group.display}}</system-checkbox></div><div class="slds-form-element__control" [ngClass]="css_classes"><system-checkbox-group [ngModel]="localValue.valueArray" (ngModelChange)="setItemValue($event)" class="slds-grid slds-wrap slds-p-vertical--xxx-small"><div *ngFor="let option of group.options; trackBy: trackByFn" class="slds-truncate" [ngClass]="columnsClass"><system-checkbox-group-checkbox [value]="option.value">{{option.display}}</system-checkbox-group-checkbox></div></system-checkbox-group></div></div><field-messages [fieldname]="fieldname"></field-messages></div>'})],fieldGroupedEnum)}(fieldGeneric);exports.fieldGroupedEnum=fieldGroupedEnum;var fieldMultienumCheckBox=function(){function e(e,t,s,i){this.model=e,this.view=t,this.language=s,this.metadata=i,this.fieldname="",this.option="",this.disabled=!1,this.fieldid="",this.fieldid=this.model.generateGuid()}return e.prototype.getValueArray=function(){return this.model.data[this.fieldname]?this.model.data[this.fieldname].substring(1,this.model.data[this.fieldname].length-1).split("^,^"):[]},Object.defineProperty(e.prototype,"checked",{get:function(){if(this.model.data[this.fieldname]){var e=!1;return this.model.data[this.fieldname]==this.option.value&&(e=!0),e=-1<this.model.data[this.fieldname].indexOf("^"+this.option.value+"^")?!0:e}return!1},set:function(e){var t=this.getValueArray(),s=t.indexOf(this.option.value);-1===s?t.push(this.option.value):t.splice(s,1),this.model.data[this.fieldname]="^"+t.join("^,^")+"^"},enumerable:!1,configurable:!0}),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"fieldname",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"option",void 0),__decorate([core_1.Input(),__metadata("design:type",Boolean)],e.prototype,"disabled",void 0),__decorate([core_1.Component({selector:"field-multienum-checkbox",template:'<input [disabled]="disabled" type="checkbox" [id]="fieldid + option.value" [(ngModel)]="checked"> <label class="slds-checkbox__label" [attr.for]="fieldid + option.value"><span class="slds-checkbox--faux"></span> <span class="slds-form-element__label">{{option.display}}</span></label>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata])],e)}();exports.fieldMultienumCheckBox=fieldMultienumCheckBox;var fieldMultipleEnumDropdown=function(d){function fieldMultipleEnumDropdown(e,t,s,i,l){var a=d.call(this,e,t,s,i,l)||this;return a.model=e,a.view=t,a.language=s,a.metadata=i,a.router=l,a.valueArray=[],a.viewModeValueText="",a}return __extends(fieldMultipleEnumDropdown,d),fieldMultipleEnumDropdown.prototype.ngOnInit=function(){this.setSubscriptions()},fieldMultipleEnumDropdown.prototype.setSubscriptions=function(){var e=this;this.subscriptions.add(this.model.data$.subscribe(function(){e.createValueArray(),e.createViewModeValueText()})),this.subscriptions.add(this.language.currentlanguage$.subscribe(function(){e.createViewModeValueText()}))},Object.defineProperty(fieldMultipleEnumDropdown.prototype,"listItems",{get:function(){return this.language.getFieldDisplayOptions(this.model.module,this.fieldname)},enumerable:!1,configurable:!0}),fieldMultipleEnumDropdown.prototype.setFieldValue=function(e){this.value=e.map(function(e){return"^"+e+"^"}).join(","),this.createValueArray(),this.createViewModeValueText()},fieldMultipleEnumDropdown.prototype.createValueArray=function(){this.valueArray=this.value?this.value.replace(/\^/g,"").split(","):[]},fieldMultipleEnumDropdown.prototype.createViewModeValueText=function(){var t=this.language.getFieldDisplayOptions(this.model.module,this.fieldname);this.viewModeValueText=this.valueArray.map(function(e){return t[e]}).join(", ")},Object.defineProperty(fieldMultipleEnumDropdown.prototype,"grouped",{get:function(){return void 0===this.fieldconfig.grouped||!0===this.fieldconfig.grouped},enumerable:!1,configurable:!0}),fieldMultipleEnumDropdown.prototype.ngOnDestroy=function(){this.subscriptions.unsubscribe()},__decorate([core_1.Component({selector:"field-multiple-enum-dropdown",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig"><span>{{viewModeValueText}}</span></field-generic-display><system-multiple-select *ngIf="isEditMode()" [ngModel]="valueArray" (ngModelChange)="setFieldValue($event)" [listItems]="listItems" [groupSeparator]="fieldconfig.groupSeparator" [grouped]="fieldconfig.grouped" [showPills]="fieldconfig.showPills" [listHeight]="fieldconfig.listHeight"></system-multiple-select>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],fieldMultipleEnumDropdown)}(fieldGeneric);exports.fieldMultipleEnumDropdown=fieldMultipleEnumDropdown;var fieldEnumAlternate=function(e){function fieldEnumAlternate(){return null!==e&&e.apply(this,arguments)||this}return __extends(fieldEnumAlternate,e),fieldEnumAlternate.prototype.setValue=function(e){this.value=e},__decorate([core_1.Component({selector:"field-enum-alternate",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><div *ngIf="!isEditMode()" class="slds-text-body--regular slds-truncate slds-m-vertical--small spice-fieldbody"><system-stencil *ngIf="model.isLoading; else displaycontent"></system-stencil><ng-template #displaycontent><span>{{getValue()}}</span> <button *ngIf="view.isEditable" style="float: right" class="slds-button slds-button--icon" (click)="setEditMode()"><system-button-icon [icon]="\'edit\'"></system-button-icon></button></ng-template></div><div *ngIf="isEditMode()" class="slds-form-element"><div class="slds-form-element__control"><div class="slds-grid--vertical"><system-input-radio [name]="fieldid" [value]="o.value" *ngFor="let o of options" [(ngModel)]="value">{{o.display}}</system-input-radio></div></div></div>'})],fieldEnumAlternate)}(fieldEnum);exports.fieldEnumAlternate=fieldEnumAlternate;var fieldEnumRadio=function(d){function fieldEnumRadio(e,t,s,i,l){var a=d.call(this,e,t,s,i,l)||this;return a.model=e,a.view=t,a.language=s,a.metadata=i,a.router=l,a.options=[],a.subscriptions.add(a.language.currentlanguage$.subscribe(function(e){a.getOptions()})),a}return __extends(fieldEnumRadio,d),fieldEnumRadio.prototype.ngOnInit=function(){this.getOptions()},fieldEnumRadio.prototype.getValue=function(){return this.language.getFieldDisplayOptionValue(this.model.module,this.fieldname,this.value)},fieldEnumRadio.prototype.getOptions=function(){var e,t=[],s=this.language.getFieldDisplayOptions(this.model.module,this.fieldname);for(e in s)t.push({value:e,display:s[e]});this.options=t},__decorate([core_1.Component({selector:"field-enum-radio",template:'<field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig" [fieldid]="fieldid"><div class="slds-form-element__control slds-grid" [ngClass]="getFieldClass()"><div class="slds-radio" *ngFor="let o of options"><input disabled type="radio" [id]="fieldid + o.value" name="options" [value]="o.value" [(ngModel)]="value"> <label class="slds-radio__label" [attr.for]="fieldid + o.value"><span class="slds-radio_faux"></span> <span class="slds-form-element__label">{{o.display}}</span></label></div><field-messages [fieldname]="fieldname"></field-messages></div></field-generic-display><div *ngIf="isEditMode()" class="slds-form-element"><div class="slds-form-element__control slds-grid" [ngClass]="getFieldClass()"><div class="slds-radio" *ngFor="let o of options"><input type="radio" [id]="fieldid + o.value" name="options" [value]="o.value" [(ngModel)]="value"> <label class="slds-radio__label" [attr.for]="fieldid + o.value"><span class="slds-radio_faux"></span> <span class="slds-form-element__label">{{o.display}}</span></label></div><field-messages [fieldname]="fieldname"></field-messages></div></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],fieldEnumRadio)}(fieldGeneric);exports.fieldEnumRadio=fieldEnumRadio;var fieldBool=function(e){function fieldBool(){return null!==e&&e.apply(this,arguments)||this}return __extends(fieldBool,e),Object.defineProperty(fieldBool.prototype,"fieldbooldisplayclass",{get:function(){return this.fielddisplayclass.replace("slds-p-vertical--x-small","slds-p-bottom--xxx-small slds-p-top--x-small")},enumerable:!1,configurable:!0}),__decorate([core_1.Component({selector:"field-bool",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fieldbooldisplayclass" [fieldconfig]="fieldconfig" [editable]="isEditable()"><system-checkbox disabled [(ngModel)]="value"></system-checkbox></field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control" [ngClass]="getFieldClass()"><div class="slds-p-vertical--x-small"><system-checkbox [(ngModel)]="value"></system-checkbox></div><field-messages [fieldname]="fieldname"></field-messages></div>'})],fieldBool)}(fieldGeneric);exports.fieldBool=fieldBool;var fieldBoolLabelAligned=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"fieldbooldisplayclass",{get:function(){return this.fielddisplayclass.replace("slds-p-vertical--x-small","slds-p-bottom--xxx-small slds-p-top--x-small")},enumerable:!1,configurable:!0}),__decorate([core_1.Component({template:'<field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fieldbooldisplayclass" [fieldconfig]="fieldconfig" [editable]="isEditable()"><system-checkbox disabled [(ngModel)]="value"><system-label-fieldname [module]="model.module" [field]="fieldname" [fieldconfig]="fieldconfig"></system-label-fieldname></system-checkbox></field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control" [ngClass]="getFieldClass()"><div class="slds-p-vertical--x-small"><system-checkbox [(ngModel)]="value"><system-label-fieldname [module]="model.module" [field]="fieldname" [fieldconfig]="fieldconfig"></system-label-fieldname></system-checkbox></div><field-messages [fieldname]="fieldname"></field-messages></div>'})],t)}(fieldGeneric);exports.fieldBoolLabelAligned=fieldBoolLabelAligned;var fieldParent=function(c){function fieldParent(e,t,s,i,l,a,d,n,o){var r=c.call(this,e,t,i,l,a)||this;return r.model=e,r.view=t,r.broadcast=s,r.language=i,r.metadata=l,r.router=a,r.elementRef=d,r.renderer=n,r.modal=o,r.parentTypeSelectOpen=!1,r.parentSearchOpen=!1,r.parentSearchTerm="",r.recentItems=[],r.parentTypes=[],r.broadcast.message$.subscribe(function(e){return r.handleMessage(e)}),r}return __extends(fieldParent,c),Object.defineProperty(fieldParent.prototype,"parentIdField",{get:function(){return this.fieldconfig.parentIdField||"parent_id"},enumerable:!1,configurable:!0}),Object.defineProperty(fieldParent.prototype,"parentTypeField",{get:function(){return this.fieldconfig.parentTypeField||"parent_type"},enumerable:!1,configurable:!0}),Object.defineProperty(fieldParent.prototype,"parentName",{get:function(){return this.model.getField(this.fieldname)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldParent.prototype,"parentType",{get:function(){return this.model.getField(this.parentTypeField)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldParent.prototype,"parentId",{get:function(){return this.model.getField(this.parentIdField)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldParent.prototype,"displayModuleIcon",{get:function(){return!this.fieldconfig.hidemoduleicon},enumerable:!1,configurable:!0}),fieldParent.prototype.ngOnInit=function(){this.determineParentTypes(),this.model.data[this.parentTypeField]&&""!=this.model.data[this.parentTypeField]||(this.model.data[this.parentTypeField]=this.parentTypes[0])},fieldParent.prototype.determineParentTypes=function(){var s=this,e=[];this.field_defs.parent_modules?e=this.field_defs.parent_modules:this.fieldconfig.parenttypes&&(e=this.fieldconfig.parenttypes.replace(/\s/g,"").split(",")),e.sort(function(e,t){return s.language.getModuleName(e).toLowerCase()>s.language.getModuleName(t).toLowerCase()?1:-1}),this.parentTypes=e},fieldParent.prototype.handleMessage=function(e){e.messagedata.reference&&"model.save"===e.messagetype&&this.fieldid===e.messagedata.reference&&(this.parentSearchTerm="",this.model.data[this.parentIdField]=e.messagedata.data.id,this.model.data[this.fieldname]=e.messagedata.data.summary_text)},fieldParent.prototype.onClick=function(e){this.elementRef.nativeElement.contains(e.target)||this.closePopups()},fieldParent.prototype.closePopups=function(){this.model.data[this.parentIdField]&&(this.parentSearchTerm=""),this.parentSearchOpen=!1,this.parentTypeSelectOpen=!1,this.clickListener()},fieldParent.prototype.setParent=function(e){this.model.setField(this.fieldname,e.text),this.model.setField(this.parentIdField,e.id)},fieldParent.prototype.toggleParentTypeSelect=function(){this.parentTypeSelectOpen=!this.parentTypeSelectOpen,this.parentSearchOpen=!1},fieldParent.prototype.setParentType=function(e){this.parentSearchTerm="",this.model.setField(this.parentTypeField,e),this.parentTypeSelectOpen=!1},fieldParent.prototype.clearParent=function(){var t=this;this.fieldconfig.promptondelete?this.modal.confirm(this.language.getLabelFormatted("LBL_PROMPT_DELETE_RELATIONSHIP",[this.language.getFieldDisplayName(this.model.module,this.fieldname,this.fieldconfig)],"long"),this.language.getLabelFormatted("LBL_PROMPT_DELETE_RELATIONSHIP",[this.language.getFieldDisplayName(this.model.module,this.fieldname,this.fieldconfig)])).subscribe(function(e){e&&t.removeRelated()}):this.removeRelated()},fieldParent.prototype.removeRelated=function(){this.model.setField(this.fieldname,""),this.model.setField(this.parentIdField,"")},fieldParent.prototype.openParentTypes=function(){var t=this;this.parentTypeSelectOpen=!0,this.parentSearchOpen=!1,this.clickListener=this.renderer.listen("document","click",function(e){return t.onClick(e)})},fieldParent.prototype.onFocusParent=function(){var t=this;this.parentTypeSelectOpen=!1,this.parentSearchOpen=!0,this.clickListener=this.renderer.listen("document","click",function(e){return t.onClick(e)})},fieldParent.prototype.searchWithModal=function(){var t=this;this.parentSearchOpen=!1,this.modal.openModal("ObjectModalModuleLookup").subscribe(function(e){e.instance.module=t.parentType,e.instance.multiselect=!1,e.instance.selectedItems.subscribe(function(e){e.length&&t.setParent({id:e[0].id,text:e[0].summary_text,data:e[0]})}),e.instance.searchTerm=t.parentSearchTerm})},__decorate([core_1.Component({selector:"field-parent",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig" [fieldid]="fieldid"><div *ngIf="parentId" class="slds-grid slds-grid_vertical-align-center"><system-icon *ngIf="displayModuleIcon" [module]="model.data[parentTypeField]" [size]="\'x-small\'"></system-icon><span system-model-popover [module]="parentType" [id]="parentId">{{value}}</span></div></field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control" [ngClass]="getFieldClass()"><div class="slds-form-element"><div *ngIf="model.data[parentIdField]" class="slds-form-element__control slds-p-around--xx-small"><div class="slds-pill_container"><span class="slds-pill slds-size--1-of-1"><span class="slds-icon_container slds-icon-standard-account slds-pill__icon_container"><system-icon [module]="model.data[parentTypeField]" [size]="\'small\'"></system-icon></span> <span class="slds-pill__label">{{parentName}}</span> <button class="slds-button slds-button--icon slds-pill__remove" (click)="clearParent()"><system-button-icon [icon]="\'close\'"></system-button-icon></button></span></div></div><div *ngIf="!model.data[parentIdField]" class="slds-combobox-group slds-p-around--xx-small"><div *ngIf="parentTypes.length > 1" class="slds-combobox_object-switcher slds-combobox-addon_start"><div class="slds-form-element"><div class="slds-form-element__control"><div class="slds-combobox_container"><div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click" [ngClass]="{\'slds-is-open\': parentTypeSelectOpen}" role="combobox"><div class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon--right" (click)="openParentTypes()"><input type="text" readonly class="slds-input slds-combobox__input slds-combobox__input-value" autoComplete="off" role="textbox" [value]="language.getModuleName(parentType)"><system-icon icon="down" sprite="utility" addclasses="slds-input__icon slds-input__icon_right"></system-icon></div><div class="slds-dropdown slds-dropdown_length-5 slds-dropdown_x-small slds-dropdown_left" role="listbox"><ul class="slds-listbox slds-listbox_vertical" role="group" aria-label="Suggested for you"><li *ngFor="let thisParentType of parentTypes" role="presentation" class="slds-listbox__item" (click)="setParentType(thisParentType)"><div class="slds-media slds-listbox__option slds-listbox__option_plain slds-media_small" role="option"><div class="slds-grid slds-grid--vertical-align-center"><system-icon [module]="thisParentType" size="x-small"></system-icon><div class="slds-truncate"><system-label-modulename [module]="thisParentType"></system-label-modulename></div></div></div></li></ul></div></div></div></div></div></div><div class="slds-combobox_container slds-combobox-addon_end"><div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click" [ngClass]="{\'slds-is-open\': parentSearchOpen}" role="combobox"><div class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right" role="none"><input #focus type="text" class="slds-input slds-combobox__input" aria-autocomplete="list" (focus)="onFocusParent()" autoComplete="off" role="textbox" [(ngModel)]="parentSearchTerm" [placeholder]="language.getLabel(\'LBL_SEARCH\') + \' \' + language.getModuleName(parentType)"> <button (click)="searchWithModal()" class="slds-button slds-button_icon slds-input__icon slds-input__icon_right"><system-button-icon [icon]="\'search\'"></system-button-icon></button></div><div class="slds-dropdown slds-dropdown_length-with-icon-7 slds-dropdown_fluid" role="listbox"><field-lookup-recent *ngIf="parentSearchTerm === \'\'" [module]="parentType" (selectedObject)="setParent($event)"></field-lookup-recent><field-lookup-search *ngIf="parentSearchTerm !== \'\'" [module]="parentType" (selectedObject)="setParent($event)" (searchWithModal)="searchWithModal()" [searchterm]="parentSearchTerm"></field-lookup-search></div></div></div></div></div><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.broadcast,services_1.language,services_1.metadata,router_1.Router,core_1.ElementRef,core_1.Renderer2,services_1.modal])],fieldParent)}(fieldGeneric);exports.fieldParent=fieldParent;var fieldModuleFilter=function(u){function fieldModuleFilter(e,t,s,i,l,a,d,n,o,r){var c=u.call(this,e,t,l,a,d)||this;return c.model=e,c.view=t,c.popup=s,c.broadcast=i,c.language=l,c.metadata=a,c.router=d,c.elementRef=n,c.renderer=o,c.modal=r,c.moduleSelectOpen=!1,c.modules=["Contacts","Accounts","Leads","Users"],c.popup.closePopup$.subscribe(function(){return c.closePopups()}),c.broadcast.message$.subscribe(function(e){return c.handleMessage(e)}),c}return __extends(fieldModuleFilter,u),Object.defineProperty(fieldModuleFilter.prototype,"moduleFilterName",{get:function(){var e=this.metadata.getModuleFilter(this.moduleFilter);return e?e.name:""},enumerable:!1,configurable:!0}),Object.defineProperty(fieldModuleFilter.prototype,"module",{get:function(){return this.model.getField("module")||this.modules[0]},enumerable:!1,configurable:!0}),Object.defineProperty(fieldModuleFilter.prototype,"value",{get:function(){return this.moduleFilterName},enumerable:!1,configurable:!0}),Object.defineProperty(fieldModuleFilter.prototype,"moduleFilters",{get:function(){return this.metadata.getModuleFilters(this.module)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldModuleFilter.prototype,"moduleFilter",{get:function(){return this.model.getField("module_filter")},set:function(e){this.model.setField("module_filter",e)},enumerable:!1,configurable:!0}),fieldModuleFilter.prototype.ngOnInit=function(){this.setModule(this.module)},fieldModuleFilter.prototype.setModule=function(e){this.model.setField("module",e),this.moduleSelectOpen=!1},fieldModuleFilter.prototype.clearFilter=function(){this.model.setField("module_filter","")},fieldModuleFilter.prototype.handleMessage=function(e){e.messagedata.reference&&"model.save"===e.messagetype&&this.fieldid===e.messagedata.reference&&(this.model.data.module_filter=e.messagedata.data.id,this.model.data[this.fieldname]=e.messagedata.data.summary_text)},fieldModuleFilter.prototype.onClick=function(e){this.elementRef.nativeElement.contains(e.target)||this.closePopups()},fieldModuleFilter.prototype.openModules=function(){var t=this;this.moduleSelectOpen=!0,this.clickListener=this.renderer.listen("document","click",function(e){return t.onClick(e)})},fieldModuleFilter.prototype.closePopups=function(){this.model.data.module_filter,this.moduleSelectOpen=!1,this.clickListener()},__decorate([core_1.Component({selector:"field-modulefilter",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig"><a href="javascript:void(0)">{{value}}</a></field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control" [ngClass]="getFieldClass()"><div class="slds-form-element"><div *ngIf="model.data.module_filter" class="slds-form-element__control slds-p-around--xx-small"><div class="slds-pill_container"><span class="slds-pill slds-size--1-of-1"><span class="slds-icon_container slds-icon-standard-account slds-pill__icon_container"><system-icon [module]="model.data.module" [size]="\'small\'"></system-icon></span> <span class="slds-pill__label">{{moduleFilterName}}</span> <button class="slds-button slds-button--icon slds-pill__remove" (click)="clearFilter()"><system-button-icon [icon]="\'close\'"></system-button-icon></button></span></div></div><div *ngIf="!model.data.module_filter" class="slds-combobox-group slds-p-around--xx-small"><div *ngIf="modules.length > 1" class="slds-combobox_object-switcher slds-combobox-addon_start"><div class="slds-form-element"><div class="slds-form-element__control"><div class="slds-combobox_container"><div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click" [ngClass]="{\'slds-is-open\': moduleSelectOpen}" role="combobox"><div class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon--right" (click)="openModules()"><input type="text" readonly class="slds-input slds-combobox__input slds-combobox__input-value" autoComplete="off" role="textbox" [value]="language.getModuleName(module)"><system-icon icon="down" sprite="utility" addclasses="slds-input__icon slds-input__icon_right"></system-icon></div><div class="slds-dropdown slds-dropdown_length-5 slds-dropdown_x-small slds-dropdown_left" role="listbox"><ul class="slds-listbox slds-listbox_vertical" role="group" aria-label="Suggested for you"><li *ngFor="let module of modules" role="presentation" class="slds-listbox__item" (click)="setModule(module)"><div class="slds-media slds-listbox__option slds-listbox__option_plain slds-media_small" role="option"><div class="slds-grid slds-grid--vertical-align-center"><system-icon [module]="module" size="x-small"></system-icon><div class="slds-truncate"><system-label-modulename [module]="module"></system-label-modulename></div></div></div></li></ul></div></div></div></div></div></div><div class="slds-form-element slds-grow slds-m-left--small"><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [disabled]="!module || moduleFilters.length == 0" (click)="moduleSelectOpen = false" [(ngModel)]="moduleFilter"><option *ngFor="let moduleFilter of moduleFilters" [value]="moduleFilter.id">{{moduleFilter.name}}</option></select></div></div></div></div></div><field-messages [fieldname]="fieldname"></field-messages></div>',providers:[services_1.popup]}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.popup,services_1.broadcast,services_1.language,services_1.metadata,router_1.Router,core_1.ElementRef,core_1.Renderer2,services_1.modal])],fieldModuleFilter)}(fieldGeneric);exports.fieldModuleFilter=fieldModuleFilter;var fieldRelate=function(c){function fieldRelate(e,t,s,i,l,a,d,n,o){var r=c.call(this,e,t,s,i,l)||this;return r.model=e,r.view=t,r.language=s,r.metadata=i,r.router=l,r.elementRef=a,r.modal=d,r.backend=n,r.toast=o,r.relateIdField="",r.relateNameField="",r.relateType="",r.relateSearchOpen=!1,r.relateSearchTerm="",r.isAuthorized=!0,r}return __extends(fieldRelate,c),Object.defineProperty(fieldRelate.prototype,"displayicon",{get:function(){return!!this.fieldconfig.displayicon},enumerable:!1,configurable:!0}),Object.defineProperty(fieldRelate.prototype,"disableadd",{get:function(){return this.fieldconfig.disableadd},enumerable:!1,configurable:!0}),Object.defineProperty(fieldRelate.prototype,"id",{get:function(){return this.model.getField(this.relateIdField)},enumerable:!1,configurable:!0}),fieldRelate.prototype.ngOnInit=function(){var e=this.metadata.getFieldDefs(this.model.module,this.fieldname);this.relateIdField=e.id_name,this.relateNameField=this.fieldname,this.relateType=e.module,this.isAuthorized=this.metadata.checkModuleAcl(e.module,"list")||this.metadata.checkModuleAcl(e.module,"listrelated"),this.handleRelateFIlterField()},fieldRelate.prototype.handleRelateFIlterField=function(){var t=this;this.fieldconfig.relatefilterfield&&(this.createRelateFilter(),this.subscriptions.add(this.model.data$.subscribe(function(e){t.updateRelateFilter()})))},fieldRelate.prototype.createRelateFilter=function(){var e=this.metadata.getFieldDefs(this.model.module,this.fieldconfig.relatefilterfield);e&&(this.relateFilter={module:e.module,relationship:this.fieldconfig.relatefilterrelationship,id:this.model.getField(e.id_name),display:this.model.getField(this.fieldconfig.relatefilterfield),active:!!this.model.getField(e.id_name),required:!!this.fieldconfig.relatedfilterrequired})},Object.defineProperty(fieldRelate.prototype,"placeholder",{get:function(){if(this.relateFilter&&this.fieldconfig.relatedfilterrequired){var e=this.metadata.getFieldDefs(this.model.module,this.fieldconfig.relatefilterfield);if(!this.model.getField(e.id_name))return this.language.getLabelFormatted("LBL_SELECT_FIELD_FIRST",[this.language.getFieldDisplayName(this.model.module,this.fieldconfig.relatefilterfield)])}return this.language.getModuleCombinedLabel("LBL_SEARCH",this.relateType)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldRelate.prototype,"relatedfilterrequired",{get:function(){return this.fieldconfig.relatedfilterrequired},enumerable:!1,configurable:!0}),Object.defineProperty(fieldRelate.prototype,"disabled",{get:function(){if(this.relateFilter&&this.relatedfilterrequired){var e=this.metadata.getFieldDefs(this.model.module,this.fieldconfig.relatefilterfield);if(!this.model.getField(e.id_name))return!0}return!1},enumerable:!1,configurable:!0}),fieldRelate.prototype.updateRelateFilter=function(){var e=this.metadata.getFieldDefs(this.model.module,this.fieldconfig.relatefilterfield);this.relateFilter.id=this.model.getField(e.id_name),this.relateFilter.display=this.model.getField(this.fieldconfig.relatefilterfield),this.fieldconfig.relatedfilterrequired&&!this.relateFilter.id&&this.id&&this.removeRelated(),this.relateFilter.active=!!this.relateFilter.id},fieldRelate.prototype.closePopups=function(){this.model.getField(this.relateIdField)&&(this.relateSearchTerm=""),this.relateSearchOpen=!1},fieldRelate.prototype.clearField=function(){var t=this;this.fieldconfig.promptondelete?this.modal.confirm(this.language.getLabelFormatted("LBL_PROMPT_DELETE_RELATIONSHIP",[this.language.getFieldDisplayName(this.model.module,this.fieldname,this.fieldconfig)],"long"),this.language.getLabelFormatted("LBL_PROMPT_DELETE_RELATIONSHIP",[this.language.getFieldDisplayName(this.model.module,this.fieldname,this.fieldconfig)])).subscribe(function(e){e&&t.removeRelated()}):this.removeRelated()},fieldRelate.prototype.removeRelated=function(){var e={};e[this.relateNameField]="",e[this.relateIdField]="",this.model.setFields(e)},fieldRelate.prototype.onFocus=function(){this.relateSearchOpen=!0},fieldRelate.prototype.setRelated=function(t){var s=this,e={};e[this.relateIdField]=t.id,e[this.relateNameField]=t.text,this.model.setFields(e),2==this.fieldconfig.executeCopyRules?this.executeCopyRules(t.id):1==this.fieldconfig.executeCopyRules&&this.modal.confirm(this.language.getLabel("MSG_COPY_DATA","","long"),this.language.getLabel("MSG_COPY_DATA")).subscribe(function(e){return e&&s.executeCopyRules(t.id)}),this.closePopups()},fieldRelate.prototype.executeCopyRules=function(e){var t=this,s=this.modal.await("LBL_LOADING");this.backend.get(this.relateType,e).subscribe(function(e){e={module:t.relateType,id:e.id,data:e};t.model.executeCopyRulesParent(e),s.emit()},function(){t.toast.sendToast("ERR_LOADING_RECORD","error"),s.emit()})},fieldRelate.prototype.goRelated=function(){this.router.navigate(["/module/"+this.relateType+"/"+this.model.getField(this.relateIdField)])},fieldRelate.prototype.searchWithModal=function(){var t=this;this.relateSearchOpen=!1,this.modal.openModal("ObjectModalModuleLookup").subscribe(function(e){e.instance.module=t.relateType,e.instance.modulefilter=t.fieldconfig.modulefilter,e.instance.multiselect=!1,e.instance.relatefilter=t.relateFilter,t.subscriptions.add(e.instance.selectedItems.subscribe(function(e){e.length&&t.setRelated({id:e[0].id,text:e[0].summary_text,data:e[0]})})),e.instance.searchTerm=t.relateSearchTerm})},__decorate([core_1.Component({selector:"field-relate",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-not-authorized *ngIf="!isAuthorized; else fieldContainer"></field-not-authorized><ng-template #fieldContainer><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig" [fieldid]="fieldid"><div class="slds-grid slds-grid--vertical-align-center"><system-icon *ngIf="displayicon" [module]="relateType" size="x-small" divClass="slds-align--absolute-center slds-p-right--xx-small"></system-icon><span system-model-popover [module]="relateType" [id]="id">{{value}}</span></div></field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control slds-m-vertical--xx-small" [ngClass]="getFieldClass()"><div class="slds-combobox_container"><div class="slds-form-element slds-lookup"><div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click" [ngClass]="{\'slds-is-open\': relateSearchOpen}" role="combobox"><div *ngIf="id" class="slds-form-element__control"><div class="slds-pill_container"><span class="slds-pill slds-size--1-of-1"><span class="slds-icon_container slds-icon-standard-account slds-pill__icon_container"><system-icon [module]="relateType" [size]="\'small\'"></system-icon></span> <span class="slds-pill__label">{{model.data[relateNameField]}}</span> <button class="slds-button slds-button--icon slds-pill__remove" (click)="clearField()"><system-button-icon [icon]="\'close\'"></system-button-icon></button></span></div></div><div *ngIf="!model.data[relateIdField]" class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right" [ngClass]="getFieldClass()"><input #focus [disabled]="disabled" type="text" class="slds-input slds-combobox__input" [(ngModel)]="relateSearchTerm" (blur)="closePopups()" (focus)="onFocus()" [placeholder]="placeholder" [autocomplete]="fieldid" role="combobox"> <button (click)="searchWithModal()" class="slds-button slds-button_icon slds-input__icon slds-input__icon_right"><system-button-icon [icon]="\'search\'"></system-button-icon></button></div><div class="slds-dropdown slds-dropdown_fluid" role="listbox"><field-lookup-recent *ngIf="relateSearchTerm === \'\' && !fieldconfig.modulefilter && !relatedfilterrequired" [module]="relateType" (selectedObject)="setRelated($event)"></field-lookup-recent><field-lookup-search *ngIf="relateSearchTerm !== \'\' || fieldconfig.modulefilter || relatedfilterrequired" [module]="relateType" [modulefilter]="fieldconfig.modulefilter" [relatefilter]="relateFilter" [relateId]="relateFilter?.id" [disableadd]="disableadd" (selectedObject)="setRelated($event)" (searchWithModal)="searchWithModal()" [searchterm]="relateSearchTerm"></field-lookup-search></div></div></div></div><field-messages [fieldname]="fieldname"></field-messages></div></ng-template>',providers:[services_1.popup]}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,core_1.ElementRef,services_1.modal,services_1.backend,services_1.toast])],fieldRelate)}(fieldGeneric);exports.fieldRelate=fieldRelate;var fieldRelateList=function(c){function fieldRelateList(e,t,s,i,l,a,d,n,o){var r=c.call(this,e,t,s,i,l)||this;return r.model=e,r.view=t,r.language=s,r.metadata=i,r.router=l,r.elementRef=a,r.modal=d,r.backend=n,r.toast=o,r.relatedList=[],r.relateIdField="",r.relateNameField="",r.relateType="",r}return __extends(fieldRelateList,c),Object.defineProperty(fieldRelateList.prototype,"relatedFieldId",{get:function(){return this.model.getField(this.relateIdField)},set:function(t){var s=this,i=this.relatedList.find(function(e){return e.id==t});i&&(this.model.setField(this.relateIdField,i.id),this.model.setField(this.relateNameField,i.summary_text),this.relateType&&(2==this.fieldconfig.executeCopyRules?this.executeCopyRules(i.id):1==this.fieldconfig.executeCopyRules&&this.modal.confirm("Copy the data from related record?","Copy data?").subscribe(function(e){return e&&s.executeCopyRules(i.id)})))},enumerable:!1,configurable:!0}),fieldRelateList.prototype.ngOnInit=function(){this.setFieldDefs(),this.getRelatedList()},fieldRelateList.prototype.setFieldDefs=function(){var e=this.metadata.getFieldDefs(this.model.module,this.fieldname);this.relateIdField=e.id_name,this.relateNameField=this.fieldname,this.relateType=e.module},fieldRelateList.prototype.getRelatedList=function(){var e,t=this;this.relateType&&(e={limit:this.fieldconfig.limit||-1,modulefilter:this.fieldconfig.modulefilter},this.backend.getList(this.relateType,[{sortfield:"name",sortirection:"ASC"}],e).subscribe(function(e){e&&e.list&&(t.relatedList=e.list)}))},fieldRelateList.prototype.executeCopyRules=function(e){var t=this,s=this.modal.await("LBL_LOADING");this.backend.get(this.relateType,e).subscribe(function(e){e={module:t.relateType,id:e.id,data:e};t.model.executeCopyRulesParent(e),s.emit()},function(){t.toast.sendToast("ERR_LOADING_RECORD","error"),s.emit()})},fieldRelateList.prototype.trackByFn=function(e,t){return t.id},__decorate([core_1.Component({selector:"field-relate-list",template:'<field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig" [fieldid]="fieldid"><a href="javascript:void(0);" system-model-popover [module]="relateType" [id]="relatedFieldId">{{value}}</a></field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element"><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="relatedFieldId"><option></option><option *ngFor="let related of relatedList; trackBy: trackByFn" [value]="related.id">{{language.getLabel(related.summary_text)}}</option></select></div></div><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,core_1.ElementRef,services_1.modal,services_1.backend,services_1.toast])],fieldRelateList)}(fieldGeneric);exports.fieldRelateList=fieldRelateList;var fieldModifiedBy=function(u){function fieldModifiedBy(e,t,s,i,l,a,d,n,o,r){var c=u.call(this,e,t,s,i,l,a,d,n,o)||this;return c.model=e,c.view=t,c.language=s,c.metadata=i,c.router=l,c.elementRef=a,c.modal=d,c.backend=n,c.toast=o,c.userpreferences=r,c}return __extends(fieldModifiedBy,u),Object.defineProperty(fieldModifiedBy.prototype,"datefield",{get:function(){return this.fieldconfig.field_date||"date_modified"},enumerable:!1,configurable:!0}),Object.defineProperty(fieldModifiedBy.prototype,"displayDate",{get:function(){try{if(this.model.data[this.fieldname]){var e=this.model.getFieldValue(this.datefield);return e.isValid()?e.format(this.userpreferences.getDateFormat()):""}return""}catch(e){return""}},enumerable:!1,configurable:!0}),Object.defineProperty(fieldModifiedBy.prototype,"displayTime",{get:function(){try{if(this.model.data[this.fieldname]){var e=this.model.getFieldValue(this.datefield);return e.isValid()?e.format(this.userpreferences.getTimeFormat()):""}return""}catch(e){return""}},enumerable:!1,configurable:!0}),__decorate([core_1.Component({selector:"field-generic",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display [fielddisplayclass]="fielddisplayclass" [editable]="false" [fieldconfig]="fieldconfig"><div class="slds-grid slds-grid--vertical-align-center"><a href="javascript:void(0);" system-model-popover module="Users" [id]="model.data[relateIdField]">{{value}}</a> <span class="slds-p-right--xx-small">,</span> <span>{{displayDate}}</span> <span class="slds-p-left--xxx-small">{{displayTime}}</span></div></field-generic-display>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,core_1.ElementRef,services_1.modal,services_1.backend,services_1.toast,services_1.userpreferences])],fieldModifiedBy)}(fieldRelate);exports.fieldModifiedBy=fieldModifiedBy;var fieldLookup=function(c){function fieldLookup(e,t,s,i,l,a,d,n,o){var r=c.call(this,e,t,i,l,a)||this;return r.model=e,r.view=t,r.broadcast=s,r.language=i,r.metadata=l,r.router=a,r.elementRef=d,r.renderer=n,r.modal=o,r.lookuplinks=[],r.lookupType=0,r.lookuplinkSelectOpen=!1,r.lookupSearchOpen=!1,r.lookupSearchTerm="",r.pills=[],r.broadcast.message$.subscribe(function(e){return r.handleMessage(e)}),r.model.data$.subscribe(function(e){r.setPills()}),r}return __extends(fieldLookup,c),fieldLookup.prototype.ngOnInit=function(){this.lookuplinks=this.getLookuplinks()},Object.defineProperty(fieldLookup.prototype,"displayAssignedUser",{get:function(){return this.fieldconfig.displayassigneduser},enumerable:!1,configurable:!0}),Object.defineProperty(fieldLookup.prototype,"lookupTypeName",{get:function(){return this.language.getModuleName(this.lookuplinks[this.lookupType].module)},enumerable:!1,configurable:!0}),fieldLookup.prototype.getLookupmodules=function(){var e;return e=(e=this.fieldconfig.lookupmodules?this.fieldconfig.lookupmodules.replace(/\s/g,"").split(","):e)||["Contacts","Users"]},fieldLookup.prototype.getLookuplinks=function(){if(!(e=this.fieldconfig.lookuplinks?this.fieldconfig.lookuplinks.replace(/\s/g,"").split(","):e))for(var e=[],t=0,s=this.getLookupmodules();t<s.length;t++){var i=s[t];e.push(i.toLowerCase())}for(var l=[],a=0,d=e;a<d.length;a++){var n=d[a];l.push({name:n,module:this.metadata.getFieldDefs(this.model.module,n).module})}return l},fieldLookup.prototype.setPills=function(){for(var e=0,t=this.lookuplinks;e<t.length;e++){var s=t[e];if(this.model.data[s.name]&&this.model.data[s.name].beans){var i,l=this;for(i in this.model.data[s.name].beans)!function(e){var t=l.model.data[s.name].beans[e];if("Users"==s.module&&!l.displayAssignedUser&&e==l.model.data.assigned_user_id)return;l.pills.findIndex(function(e){return e.id==t.id})<0&&l.pills.push({module:s.module,id:t.id,summary_text:t.summary_text,link:s.name})}(i)}}},fieldLookup.prototype.addItem=function(e){this.model.data[this.lookuplinks[this.lookupType].name]||(this.model.data[this.lookuplinks[this.lookupType].name]={beans:{}}),this.model.data[this.lookuplinks[this.lookupType].name].beans[e.id]={id:e.id,summary_text:e.text},this.lookupSearchOpen=!1,this.setPills()},fieldLookup.prototype.handleMessage=function(e){e.messagedata.reference&&"model.save"===e.messagetype&&this.fieldid===e.messagedata.reference&&(this.lookupSearchTerm="",this.addItem({id:e.messagedata.data.id,text:e.messagedata.data.summary_text}))},fieldLookup.prototype.onClick=function(e){this.elementRef.nativeElement.contains(e.target)||this.closePopups()},fieldLookup.prototype.closePopups=function(){this.lookupSearchOpen=!1,this.lookuplinkSelectOpen=!1,this.clickListener()},fieldLookup.prototype.toggleLookupTypeSelect=function(){this.lookuplinkSelectOpen=!this.lookuplinkSelectOpen,this.lookupSearchOpen=!1},fieldLookup.prototype.setLookupType=function(e){this.lookupSearchTerm="",this.lookupType=e,this.lookuplinkSelectOpen=!1},fieldLookup.prototype.removeItem=function(t){this.model.data[t.link].beans_relations_to_delete||(this.model.data[t.link].beans_relations_to_delete={}),this.model.data[t.link].beans_relations_to_delete[t.id]=t,delete this.model.data[t.link].beans[t.id];var e=this.pills.findIndex(function(e){return e.id==t.id});this.pills.splice(e,1)},fieldLookup.prototype.onFocus=function(){this.openSearchDropDown()},fieldLookup.prototype.openSearchDropDown=function(){var t=this;this.lookuplinkSelectOpen=!1,this.lookupSearchOpen=!0,this.clickListener=this.renderer.listen("document","click",function(e){return t.onClick(e)})},fieldLookup.prototype.searchWithModal=function(){var t=this;this.modal.openModal("ObjectModalModuleLookup").subscribe(function(e){e.instance.module=t.lookuplinks[t.lookupType].module,e.instance.multiselect=!1,e.instance.selectedItems.subscribe(function(e){t.addItem({id:e[0].id,text:e[0].summary_text,data:e[0]})}),e.instance.usedSearchTerm.subscribe(function(e){t.lookupSearchTerm=e}),e.instance.searchTerm=t.lookupSearchTerm})},fieldLookup.prototype.pillid=function(e){return e.id},__decorate([core_1.Component({selector:"field-lookup",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig" [fieldid]="fieldid"><span *ngFor="let pill of pills" class="slds-pill slds-m-right--xx-small slds-p-around--xx-small"><span class="slds-icon_container slds-icon-standard-account slds-pill__icon_container"><system-icon [module]="pill.module" [size]="\'small\'"></system-icon></span> <span class="slds-pill__label">{{pill.summary_text}}</span></span></field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control" [ngClass]="getFieldClass()"><div class="slds-combobox-group slds-p-vertical--xx-small"><div *ngIf="lookuplinks.length > 1" class="slds-combobox_object-switcher slds-combobox-addon_start"><div class="slds-form-element"><div class="slds-form-element__control"><div class="slds-combobox_container"><div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click" [ngClass]="{\'slds-is-open\': lookuplinkSelectOpen}" role="combobox"><div class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon--right" (click)="toggleLookupTypeSelect()"><input type="text" readonly class="slds-input slds-combobox__input slds-combobox__input-value" autoComplete="off" role="textbox" [value]="lookupTypeName"><system-icon icon="down" sprite="utility" addclasses="slds-input__icon slds-input__icon_right"></system-icon></div><div class="slds-dropdown slds-dropdown_length-5 slds-dropdown_x-small slds-dropdown_left" role="listbox"><ul class="slds-listbox slds-listbox_vertical" role="group" aria-label="Suggested for you"><li *ngFor="let lookuplink of lookuplinks; index as i" role="presentation" class="slds-listbox__item" (click)="setLookupType(i)"><div class="slds-media slds-listbox__option slds-listbox__option_plain slds-media_small" role="option"><div class="slds-grid slds-grid--vertical-align-center"><system-icon [module]="lookuplink.module" size="x-small"></system-icon><div class="slds-truncate"><system-label-modulename [module]="lookuplink.module"></system-label-modulename></div></div></div></li></ul></div></div></div></div></div></div><div class="slds-combobox_container slds-combobox-addon_end"><div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click" [ngClass]="{\'slds-is-open\': lookupSearchOpen}" role="combobox"><div class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right" role="none"><input type="text" class="slds-input" [ngClass]="{\'slds-combobox__input\':lookuplinks.length > 1}" aria-autocomplete="list" (focus)="onFocus()" autoComplete="off" role="textbox" [(ngModel)]="lookupSearchTerm" [placeholder]="language.getModuleCombinedLabel(\'LBL_SEARCH\', lookuplinks[lookupType].module)"> <button (click)="searchWithModal()" class="slds-button slds-button_icon slds-input__icon slds-input__icon_right"><system-button-icon [icon]="\'search\'"></system-button-icon></button></div><div class="slds-dropdown slds-dropdown_length-with-icon-7 slds-dropdown_fluid" role="listbox"><field-lookup-recent *ngIf="lookupSearchOpen && lookupSearchTerm === \'\'" [module]="lookuplinks[lookupType].module" (selectedObject)="addItem($event)"></field-lookup-recent><field-lookup-search *ngIf="lookupSearchOpen && lookupSearchTerm !== \'\'" [module]="lookuplinks[lookupType].module" (selectedObject)="addItem($event)" (searchWithModal)="searchWithModal()" [searchterm]="lookupSearchTerm"></field-lookup-search></div></div></div></div><ul *ngIf="pills.length > 0" class="slds-listbox slds-listbox_horizontal" role="group"><li *ngFor="let pill of pills;trackBy:pillid" role="presentation" class="slds-listbox__item slds-p-top_xxx-small"><span class="slds-pill"><span class="slds-icon_container slds-icon-standard-account slds-pill__icon_container"><system-icon [module]="pill.module" [size]="\'small\'"></system-icon></span> <span class="slds-pill__label">{{pill.summary_text}}</span> <button class="slds-button slds-button--icon slds-pill__remove" (click)="removeItem(pill)"><system-button-icon [icon]="\'close\'"></system-button-icon></button></span></li></ul><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.broadcast,services_1.language,services_1.metadata,router_1.Router,core_1.ElementRef,core_1.Renderer2,services_1.modal])],fieldLookup)}(fieldGeneric);exports.fieldLookup=fieldLookup;var fieldDate=function(d){function fieldDate(e,t,s,i,l){var a=d.call(this,e,t,s,i,l)||this;return a.model=e,a.view=t,a.language=s,a.metadata=i,a.router=l,a}return __extends(fieldDate,d),Object.defineProperty(fieldDate.prototype,"highlightdate",{get:function(){return!!(this.fieldconfig.highlightpast&&this.value&&new moment>new moment(this.model.getField(this.fieldname)))},enumerable:!1,configurable:!0}),__decorate([core_1.Component({selector:"field-date",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig"><div *ngIf="!displayLink()" class="slds-truncate"><span [ngClass]="{\'slds-text-color_error\' : highlightdate}"><system-display-datetime [date]="value" [displayTime]="false"></system-display-datetime></span></div><div *ngIf="displayLink()" class="slds-truncate"><a href="javascript:void(0);" (click)="goRecord()"><span [ngClass]="{\'slds-text-color_error\' : highlightdate}"><system-display-datetime [date]="value" [displayTime]="false"></system-display-datetime></span></a></div></field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control slds-p-around--xx-small" [ngClass]="css_classes"><system-input-date [(ngModel)]="value"></system-input-date><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],fieldDate)}(fieldGeneric);exports.fieldDate=fieldDate;var fieldTime=function(n){function fieldTime(e,t,s,i,l,a){var d=n.call(this,e,t,s,i,l)||this;return d.model=e,d.view=t,d.language=s,d.metadata=i,d.router=l,d.userpreferences=a,d}return __extends(fieldTime,n),Object.defineProperty(fieldTime.prototype,"displayTime",{get:function(){return this.value.format(this.userpreferences.getTimeFormat())},enumerable:!1,configurable:!0}),__decorate([core_1.Component({selector:"field-time",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig"><div *ngIf="!displayLink()" class="slds-truncate"><span class="slds-p-left--x-small" style="font-style: italic">{{displayTime}}</span></div></field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control slds-p-around--xx-small" [ngClass]="getFieldClass()"><system-input-time [(ngModel)]="value"></system-input-time><field-messages fieldname="{{fieldname}}"></field-messages></div>',providers:[services_1.popup]}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,services_1.userpreferences])],fieldTime)}(fieldGeneric);exports.fieldTime=fieldTime;var fieldDateTime=function(n){function fieldDateTime(e,t,s,i,l,a){var d=n.call(this,e,t,s,i,l)||this;return d.model=e,d.view=t,d.language=s,d.metadata=i,d.router=l,d.userpreferences=a,d}return __extends(fieldDateTime,n),Object.defineProperty(fieldDateTime.prototype,"displayValue",{get:function(){try{if(this.model.getField(this.fieldname)){var e=this.model.getField(this.fieldname);return e.isValid()?this.fieldconfig.displayfromnow?e.fromNow():e.format(this.userpreferences.getDateFormat()+" "+this.userpreferences.getTimeFormat()):""}return""}catch(e){return""}},enumerable:!1,configurable:!0}),Object.defineProperty(fieldDateTime.prototype,"displaySpan",{get:function(){try{if(this.model.getField(this.fieldname)){var e=this.model.getField(this.fieldname);return e.isValid()?e.fromNow():""}return""}catch(e){return""}},enumerable:!1,configurable:!0}),Object.defineProperty(fieldDateTime.prototype,"displayDate",{get:function(){try{if(this.model.getField(this.fieldname)){var e=this.model.getField(this.fieldname);return e.isValid()?e.format(this.userpreferences.getDateFormat()):""}return""}catch(e){return""}},enumerable:!1,configurable:!0}),Object.defineProperty(fieldDateTime.prototype,"displayTime",{get:function(){try{if(this.model.getField(this.fieldname)){var e=this.model.getField(this.fieldname);return e.isValid()?e.format(this.userpreferences.getTimeFormat()):""}return""}catch(e){return""}},enumerable:!1,configurable:!0}),Object.defineProperty(fieldDateTime.prototype,"highlightdate",{get:function(){return(1==this.fieldconfig.highlightpast||!0===this.fieldconfig.highlightpast)&&new moment>new moment(this.model.getField(this.fieldname))},enumerable:!1,configurable:!0}),__decorate([core_1.Component({selector:"field-date-time",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig"><span *ngIf="fieldconfig.displayfromnow">{{displaySpan}}</span> <span *ngIf="!fieldconfig.displayfromnow">{{displayDate}}</span> <span *ngIf="!fieldconfig.displayfromnow" class="slds-p-left--x-small" style="font-style: italic">{{displayTime}}</span></field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control slds-p-around--xx-small" [ngClass]="css_classes"><div class="slds-grid"><system-input-date [(ngModel)]="value" class="slds-size--1-of-2 slds-p-right--xxx-small"></system-input-date><system-input-time [(ngModel)]="value" class="slds-size--1-of-2 slds-p-left--xxx-small"></system-input-time></div><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,services_1.userpreferences])],fieldDateTime)}(fieldGeneric);exports.fieldDateTime=fieldDateTime;var fieldDateTimeDuration=function(n){function fieldDateTimeDuration(e,t,s,i,l,a){var d=n.call(this,e,t,s,i,l)||this;return d.model=e,d.view=t,d.language=s,d.metadata=i,d.router=l,d.userpreferences=a,d.durationHours=["0","1","2","3","4","5","6","7","8","9","10","11","12"],d.durationMinutes=["0","5","10","15","20","25","30","35","40","45","50","55"],d}return __extends(fieldDateTimeDuration,n),fieldDateTimeDuration.prototype.ngOnInit=function(){var t=this;n.prototype.ngOnInit.call(this),this.subscriptions.add(this.model.data$.subscribe(function(e){t.value&&t.dateEnd&&(t.duration=moment.duration(t.dateEnd.diff(t.value)))}))},Object.defineProperty(fieldDateTimeDuration.prototype,"fieldend",{get:function(){return this.fieldconfig.field_end||"date_end"},enumerable:!1,configurable:!0}),Object.defineProperty(fieldDateTimeDuration.prototype,"value",{get:function(){return this.model.getField(this.fieldname)},set:function(e){var t={};t[this.fieldname]=e,this.duration&&(e=new moment(e).add(this.duration.asSeconds(),"s"),t[this.fieldend]=e),this.model.setFields(t)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldDateTimeDuration.prototype,"dateEnd",{get:function(){return this.model.getField(this.fieldend)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldDateTimeDuration.prototype,"currentHours",{get:function(){return this.duration?this.duration.get("hours"):0},enumerable:!1,configurable:!0}),Object.defineProperty(fieldDateTimeDuration.prototype,"currentMinutes",{get:function(){return this.duration?this.duration.get("minutes"):0},enumerable:!1,configurable:!0}),Object.defineProperty(fieldDateTimeDuration.prototype,"editDurationHours",{get:function(){return this.currentHours},set:function(e){var t=this.currentMinutes,s=new moment(this.value);s.add(e,"h").add(t,"m"),this.model.setField(this.fieldend,s)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldDateTimeDuration.prototype,"editDurationMinutes",{get:function(){return this.currentMinutes},set:function(e){var t=this.currentHours,s=new moment(this.value);s.add(t,"h").add(e,"m"),this.model.setField(this.fieldend,s)},enumerable:!1,configurable:!0}),__decorate([core_1.Component({selector:"field-date-time-duration",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig"><system-display-datetime [date]="value"></system-display-datetime><span *ngIf="dateEnd">-<system-display-datetime [date]="dateEnd" [displayDate]="false"></system-display-datetime></span></field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control slds-p-around--xx-small" [ngClass]="css_classes"><div class="slds-grid"><system-input-date [(ngModel)]="value"></system-input-date><system-input-time class="slds-p-left--x-small" [(ngModel)]="value"></system-input-time><div class="slds-form-element__control slds-p-left--x-small slds-size--1-of-6"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="editDurationHours"><option *ngFor="let duration of durationHours">{{duration}}</option></select></div></div><div class="slds-form-element__control slds-p-left--x-small slds-size--1-of-6"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="editDurationMinutes"><option *ngFor="let duration of durationMinutes">{{duration}}</option></select></div></div></div><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,services_1.userpreferences])],fieldDateTimeDuration)}(fieldGeneric);exports.fieldDateTimeDuration=fieldDateTimeDuration;var fieldDuration=function(d){function fieldDuration(e,t,s,i,l){var a=d.call(this,e,t,s,i,l)||this;return a.model=e,a.view=t,a.language=s,a.metadata=i,a.router=l,a.isValid=!0,a.durationHours=["00","01","02","03","04","05","06","07","08","09","10","11","12"],a.durationMinutes=["00","15","30","45"],a}return __extends(fieldDuration,d),Object.defineProperty(fieldDuration.prototype,"fieldminutes",{get:function(){return this.fieldconfig.field_minutes||"duration_minutes"},enumerable:!1,configurable:!0}),Object.defineProperty(fieldDuration.prototype,"fieldhours",{get:function(){return this.fieldconfig.field_hours||"duration_hours"},enumerable:!1,configurable:!0}),fieldDuration.prototype.getDisplay=function(){if(this.model.data[this.fieldminutes]||this.model.data[this.fieldhours])return("00"+this.model.data[this.fieldhours]).slice(-2)+":"+("00"+this.model.data[this.fieldminutes]).slice(-2)},Object.defineProperty(fieldDuration.prototype,"editDurationHours",{get:function(){return this.model.data[this.fieldhours]},set:function(e){this.model.setField(this.fieldhours,e)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldDuration.prototype,"editDurationMinutes",{get:function(){return this.model.data[this.fieldminutes]},set:function(e){this.model.setField(this.fieldminutes,e)},enumerable:!1,configurable:!0}),__decorate([core_1.Component({selector:"field-duration",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig">{{getDisplay()}}</field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control slds-p-around--xx-small" [ngClass]="css_classes"><div *ngIf="!fieldconfig.freeentry" class="slds-grid"><div class="slds-form-element__control slds-size--1-of-2"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="editDurationHours"><option *ngFor="let duration of durationHours">{{duration}}</option></select></div></div><div class="slds-form-element__control slds-m-left--x-small slds-size--1-of-2"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="editDurationMinutes"><option *ngFor="let duration of durationMinutes">{{duration}}</option></select></div></div></div><div *ngIf="fieldconfig.freeentry" class="slds-grid"><div class="slds-form-element slds-size--1-of-2"><div class="slds-form-element__control slds-input-has-fixed-addon"><input type="number" min="0" class="slds-input" title="hours" [(ngModel)]="editDurationHours" [ngModelOptions]="modelOptions" style="padding: 0 0.25rem 0 0.25rem"> <span class="slds-form-element__addon" id="fixed-text-addon-post">h</span></div></div><div class="slds-form-element slds-m-left--x-small slds-size--1-of-2"><div class="slds-form-element__control slds-input-has-fixed-addon"><input type="number" min="0" max="59" class="slds-input" title="minutes" [(ngModel)]="editDurationMinutes" [ngModelOptions]="modelOptions" style="padding: 0 0.25rem 0 0.25rem"> <span class="slds-form-element__addon" id="fixed-text-addon-post2">min</span></div></div></div><field-messages fieldname="{{fieldname}}"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],fieldDuration)}(fieldGeneric);exports.fieldDuration=fieldDuration;var fieldDateTimeSpan=function(d){function fieldDateTimeSpan(e,t,s,i,l){var a=d.call(this,e,t,s,i,l)||this;return a.model=e,a.view=t,a.language=s,a.metadata=i,a.router=l,a.isValid=!0,a.errorMessage="",a}return __extends(fieldDateTimeSpan,d),fieldDateTimeSpan.prototype.ngOnInit=function(){var t=this;d.prototype.ngOnInit.call(this),this.subscriptions.add(this.model.data$.subscribe(function(e){t.startDate&&t.endDate&&(t.duration=moment.duration(t.endDate.diff(t.startDate)))}))},Object.defineProperty(fieldDateTimeSpan.prototype,"vertical",{get:function(){return!0!==this.fieldconfig.horizontal},enumerable:!1,configurable:!0}),Object.defineProperty(fieldDateTimeSpan.prototype,"showToDate",{get:function(){return!this.startDate||!this.endDate||!this.startDate.isSame(this.endDate,"day")},enumerable:!1,configurable:!0}),Object.defineProperty(fieldDateTimeSpan.prototype,"fieldstart",{get:function(){return this.fieldconfig.date_start||"date_start"},enumerable:!1,configurable:!0}),Object.defineProperty(fieldDateTimeSpan.prototype,"fieldend",{get:function(){return this.fieldconfig.date_end||"date_end"},enumerable:!1,configurable:!0}),Object.defineProperty(fieldDateTimeSpan.prototype,"startDate",{get:function(){return this.model.getField(this.fieldstart)},set:function(e){var t,s={};s[this.fieldstart]=e,this.duration?(t=new moment(e).add(this.duration.asSeconds(),"s"),s[this.fieldend]=t):this.model.getField(this.fieldend)||(s[this.fieldend]=new moment(e)),this.model.setFields(s)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldDateTimeSpan.prototype,"endDate",{get:function(){return this.model.getField(this.fieldend)},set:function(e){this.model.getFieldValue(this.fieldstart)||(this.startDate=new moment(e)),e.isBefore(this.model.getFieldValue(this.fieldstart))?(this.isValid=!1,this.errorMessage="enddate cannot be before startdate",this.model.setFieldMessage("error","enddate cannot be before startdate",this.fieldname,"sequencecheck")):(this.model.resetFieldMessages(this.fieldname,"error","sequencecheck"),this.model.setField(this.fieldend,e),this.isValid=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldDateTimeSpan.prototype,"stati",{get:function(){var e=this.model.getFieldStati(this.fieldname);return!e.editable||this.view.isEditable&&!this.fieldconfig.readonly||(e.editable=!1),this.fieldconfig.required&&(e.required=!0),e},enumerable:!1,configurable:!0}),__decorate([core_1.Component({selector:"field-date-time-span",template:'<ng-container *ngIf="!isEditMode()"><field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig"><system-display-datetime [date]="startDate"></system-display-datetime>-<system-display-datetime [date]="endDate" [displayDate]="showToDate"></system-display-datetime></field-generic-display></ng-container><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control slds-p-around--xx-small" [ngClass]="css_classes"><div *ngIf="vertical; else horizontal" class="slds-grid slds-grid--vertical"><div class="slds-grid slds-gutters_xx-small"><div class="slds-form-element slds-col slds-size--1-of-2"><label class="slds-form-element__label"><abbr *ngIf="stati.editable && stati.required" class="slds-required">*</abbr><system-label label="LBL_DATE_START"></system-label></label><system-input-date [(ngModel)]="startDate"></system-input-date></div><div class="slds-form-element slds-col slds-size--1-of-2 slds-m-top--none"><label class="slds-form-element__label"><system-label label="LBL_TIME_START"></system-label></label><system-input-time [(ngModel)]="startDate"></system-input-time></div></div><div class="slds-grid slds-gutters_xx-small"><div class="slds-form-element slds-col slds-size--1-of-2"><label class="slds-form-element__label"><abbr *ngIf="stati.editable && stati.required" class="slds-required">*</abbr><system-label label="LBL_DATE_END"></system-label></label><system-input-date [(ngModel)]="endDate"></system-input-date></div><div class="slds-form-element slds-col slds-size--1-of-2 slds-m-top--none"><label class="slds-form-element__label"><system-label label="LBL_TIME_END"></system-label></label><system-input-time [(ngModel)]="endDate"></system-input-time></div></div></div><ng-template #horizontal><div class="slds-grid slds-wrap slds-gutters_xx-small"><div class="slds-grid slds-col slds-gutters_xx-small slds-size--1-of-1 slds-large-size--1-of-2"><div class="slds-form-element slds-col slds-size--1-of-2"><label class="slds-form-element__label"><abbr *ngIf="stati.editable && stati.required" class="slds-required">*</abbr><system-label label="LBL_DATE_START"></system-label></label><system-input-date [(ngModel)]="startDate"></system-input-date></div><div class="slds-form-element slds-col slds-size--1-of-2 slds-m-top--none"><label class="slds-form-element__label"><system-label label="LBL_TIME_START"></system-label></label><system-input-time [(ngModel)]="startDate"></system-input-time></div></div><div class="slds-grid slds-col slds-gutters_xx-small slds-size--1-of-1 slds-large-size--1-of-2"><div class="slds-form-element slds-col slds-size--1-of-2"><label class="slds-form-element__label"><abbr *ngIf="stati.editable && stati.required" class="slds-required">*</abbr><system-label label="LBL_DATE_END"></system-label></label><system-input-date [(ngModel)]="endDate"></system-input-date></div><div class="slds-form-element slds-col slds-size--1-of-2 slds-m-top--none"><label class="slds-form-element__label"><system-label label="LBL_TIME_END"></system-label></label><system-input-time [(ngModel)]="endDate"></system-input-time></div></div></div></ng-template><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],fieldDateTimeSpan)}(fieldGeneric);exports.fieldDateTimeSpan=fieldDateTimeSpan;var fieldDateSpan=function(d){function fieldDateSpan(e,t,s,i,l){var a=d.call(this,e,t,s,i,l)||this;return a.model=e,a.view=t,a.language=s,a.metadata=i,a.router=l,a.isValid=!0,a.errorMessage="",a}return __extends(fieldDateSpan,d),fieldDateSpan.prototype.ngOnInit=function(){var t=this;d.prototype.ngOnInit.call(this),this.subscriptions.add(this.model.data$.subscribe(function(e){t.startDate&&t.endDate&&(t.duration=moment.duration(t.endDate.diff(t.startDate)))}))},Object.defineProperty(fieldDateSpan.prototype,"fieldstart",{get:function(){return this.fieldconfig.date_start||"date_start"},enumerable:!1,configurable:!0}),Object.defineProperty(fieldDateSpan.prototype,"fieldend",{get:function(){return this.fieldconfig.date_end||"date_end"},enumerable:!1,configurable:!0}),Object.defineProperty(fieldDateSpan.prototype,"startDate",{get:function(){return this.model.getField(this.fieldstart)},set:function(e){var t={};t[this.fieldstart]=e,this.duration&&(e=new moment(e).add(this.duration.asSeconds(),"s"),t[this.fieldend]=e),this.model.setFields(t)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldDateSpan.prototype,"endDate",{get:function(){return this.model.getField(this.fieldend)},set:function(e){this.model.getFieldValue(this.fieldstart)||(this.startDate=new moment(e)),e.isBefore(this.model.getFieldValue(this.fieldstart))?(this.isValid=!1,this.errorMessage="enddate cannot be before startdate",this.model.setFieldMessage("error","enddate cannot be before startdate",this.fieldname,"sequencecheck")):(this.model.resetFieldMessages(this.fieldname,"error","sequencecheck"),this.model.setField(this.fieldend,e),this.isValid=!0)},enumerable:!1,configurable:!0}),__decorate([core_1.Component({selector:"field-date-span",template:'<ng-container *ngIf="!isEditMode()"><field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig"><system-display-datetime [date]="startDate" [displayTime]="false"></system-display-datetime>-<system-display-datetime [date]="endDate" [displayTime]="false"></system-display-datetime></field-generic-display></ng-container><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control slds-p-around--xx-small" [ngClass]="css_classes"><div class="slds-grid slds-gutters_direct-xx-small"><div class="slds-size--1-of-2 slds-col"><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_DATE_START"></system-label></label><system-input-date [(ngModel)]="startDate"></system-input-date></div></div><div class="slds-size--1-of-2 slds-col"><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_DATE_END"></system-label></label><system-input-date [(ngModel)]="endDate"></system-input-date></div></div></div><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],fieldDateSpan)}(fieldGeneric);exports.fieldDateSpan=fieldDateSpan;var fieldAddress=function(o){function fieldAddress(e,t,s,i,l,a,d){var n=o.call(this,e,t,s,i,l)||this;n.model=e,n.view=t,n.language=s,n.metadata=i,n.router=l,n.configuration=a,n.backend=d,n.strict=!1,n.config_address_format={},n.addressFormat="{street} {street_number}, {postalcode} {city}, {statename}, {countryname}";d=n.configuration.getCapabilityConfig("spiceui");return"strict"==d.addressmode&&(n.strict=!0),d.addressformat&&(n.addressFormat=d.addressformat),n.getAddressConfig(),n}return __extends(fieldAddress,o),fieldAddress.prototype.getAddressConfig=function(){this.config_address_format=JSON.parse(this.configuration.data.backendextensions.address_format.config.format)},Object.defineProperty(fieldAddress.prototype,"value",{get:function(){return this.buildAddress()},enumerable:!1,configurable:!0}),Object.defineProperty(fieldAddress.prototype,"addresskey",{get:function(){return this.fieldconfig.key?this.fieldconfig.key+"_":""},enumerable:!1,configurable:!0}),fieldAddress.prototype.buildAddress=function(){var e,t=this,s=this.addressFormat;this.strict&&this.country&&(!(e=this.configuration.getData("countries"))||(e=e.countries.find(function(e){return e.cc==t.country}))&&e.addressformat&&(s=e.addressformat));for(var i=0,l=s.match(/\{(.*?)\}/g);i<l.length;i++)var a=l[i],d=this[a.slice(1,-1)],s=s.replace(a,d||"");return s},Object.defineProperty(fieldAddress.prototype,"countryname",{get:function(){if(this.strict){var e,t=this.country;return t&&(!(e=this.configuration.getData("countries"))||(e=e.countries.find(function(e){return e.cc==t}))&&(t=this.language.getLabel(e.label))),t}return this.country},enumerable:!1,configurable:!0}),Object.defineProperty(fieldAddress.prototype,"statename",{get:function(){if(this.strict){var e,t=this.country,s=this.state;return s&&(!(e=this.configuration.getData("countries"))||(e=e.states.find(function(e){return e.cc==t&&e.sc==s}))&&(s=this.language.getLabel(e.label))),s}return this.state},enumerable:!1,configurable:!0}),fieldAddress.prototype.addressSelected=function(e){this.hidestreetnumber?this.street=e.street:(this.street=e.street_name,this.street_number=e.street_number),this.city=e.city,this.district=e.district,this.postalcode=e.postalcode,this.country=e.country,this.state=e.state,this.latitude=e.latitude,this.longitude=e.longitude},fieldAddress.prototype.getAddressLabel=function(){return this.language.getLabel(this.fieldconfig.label)},fieldAddress.prototype.fieldName=function(e){return this.addresskey+"address_"+e},Object.defineProperty(fieldAddress.prototype,"street",{get:function(){return this.model.data[this.addresskey+"address_street"]},set:function(e){this.model.setField(this.addresskey+"address_street",e)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldAddress.prototype,"street_number",{get:function(){return this.model.data[this.addresskey+"address_street_number"]},set:function(e){this.model.setField(this.addresskey+"address_street_number",e)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldAddress.prototype,"street_number_suffix",{get:function(){return this.model.data[this.addresskey+"address_street_number_suffix"]},set:function(e){this.model.setField(this.addresskey+"address_street_number_suffix",e)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldAddress.prototype,"attn",{get:function(){return this.model.data[this.addresskey+"address_attn"]},set:function(e){this.model.setField(this.addresskey+"address_attn",e)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldAddress.prototype,"city",{get:function(){return this.model.data[this.addresskey+"address_city"]},set:function(e){this.model.setField(this.addresskey+"address_city",e)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldAddress.prototype,"district",{get:function(){return this.model.data[this.addresskey+"address_district"]},set:function(e){this.model.setField(this.addresskey+"address_district",e)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldAddress.prototype,"postalcode",{get:function(){return this.model.data[this.addresskey+"address_postalcode"]},set:function(e){this.model.setField(this.addresskey+"address_postalcode",e)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldAddress.prototype,"state",{get:function(){return this.model.data[this.addresskey+"address_state"]},set:function(e){this.model.setField(this.addresskey+"address_state",e)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldAddress.prototype,"country",{get:function(){return this.model.data[this.addresskey+"address_country"]},set:function(e){this.model.setField(this.addresskey+"address_country",e)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldAddress.prototype,"latitude",{get:function(){return this.model.data[this.addresskey+"address_latitude"]},set:function(e){this.model.setField(this.addresskey+"address_latitude",e)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldAddress.prototype,"longitude",{get:function(){return this.model.data[this.addresskey+"address_longitude"]},set:function(e){this.model.setField(this.addresskey+"address_longitude",e)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldAddress.prototype,"hideattn",{get:function(){var e;return!!this.fieldconfig.hideattn||!(null===(e=this.config_address_format)||void 0===e||!e.hideattn)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldAddress.prototype,"hidestate",{get:function(){var e;return!!this.fieldconfig.hidestate||!(null===(e=this.config_address_format)||void 0===e||!e.hidestate)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldAddress.prototype,"hidestreetnumber",{get:function(){var e;return!!this.fieldconfig.hidestreetnumber||!(null===(e=this.config_address_format)||void 0===e||!e.hidestreetnumber)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldAddress.prototype,"hidedistrict",{get:function(){var e;return!!this.fieldconfig.hidedistrict||!(null===(e=this.config_address_format)||void 0===e||!e.hidedistrict)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldAddress.prototype,"hidenumbersuffix",{get:function(){var e;return!!this.fieldconfig.hidenumbersuffix||!(null===(e=this.config_address_format)||void 0===e||!e.hidenumbersuffix)},enumerable:!1,configurable:!0}),__decorate([core_1.Component({selector:"field-address",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><div *ngIf="!isEditMode()"><field-generic-display [fielddisplayclass]="fielddisplayclass" [fieldconfig]="fieldconfig" [editable]="isEditable()" [fieldid]="fieldid">{{value}}</field-generic-display></div><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control" [ngClass]="getFieldClass()"><fieldset><div class="slds-form-element__group"><system-googleplaces-autocomplete (address)="addressSelected($event)"></system-googleplaces-autocomplete><div class="slds-grid slds-gutters_direct-xx-small"><div class="slds-form-element slds-col"><field-label [fieldname]="fieldName(\'street\')" labellength="short"></field-label><div class="slds-form-element__control"><input #focus type="text" class="slds-input" [(ngModel)]="street" [ngModelOptions]="modelOptions"></div><field-messages [fieldname]="fieldName(\'street\')"></field-messages></div><div *ngIf="!hidestreetnumber" class="slds-form-element slds-col slds-size--1-of-6"><field-label [fieldname]="fieldName(\'street_number\')" labellength="short"></field-label><div class="slds-form-element__control"><input #focus type="text" class="slds-input" [(ngModel)]="street_number" [ngModelOptions]="modelOptions"></div><field-messages [fieldname]="fieldName(\'street_number\')"></field-messages></div><div *ngIf="!hidenumbersuffix" class="slds-form-element slds-col slds-size--1-of-6"><field-label [fieldname]="fieldName(\'street_number_suffix\')" labellength="short"></field-label><div class="slds-form-element__control"><input #focus type="text" class="slds-input" [(ngModel)]="street_number_suffix" [ngModelOptions]="modelOptions"></div><field-messages [fieldname]="fieldName(\'street_number_suffix\')"></field-messages></div></div><div *ngIf="!hideattn" class="slds-form-element slds-col slds-size--1-of-1"><field-label [fieldname]="fieldName(\'attn\')" labellength="short"></field-label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="attn" [ngModelOptions]="modelOptions"></div><field-messages [fieldname]="fieldName(\'attn\')"></field-messages></div><div class="slds-grid"><div class="slds-form-element slds-size--1-of-5 slds-col slds-p-right--xx-small"><field-label [fieldname]="fieldName(\'postalcode\')" labellength="short"></field-label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="postalcode" [ngModelOptions]="modelOptions"></div><field-messages [fieldname]="fieldName(\'postalcode\')"></field-messages></div><div class="slds-form-element slds-p-left--xx-small slds-col"><field-label [fieldname]="fieldName(\'city\')" labellength="short"></field-label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="city" [ngModelOptions]="modelOptions"></div><field-messages [fieldname]="fieldName(\'city\')"></field-messages></div><div *ngIf="!hidedistrict" class="slds-form-element slds-col slds-size--2-of-5 slds-p-left--xx-small"><field-label [fieldname]="fieldName(\'district\')" labellength="short"></field-label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="district" [ngModelOptions]="modelOptions"></div><field-messages [fieldname]="fieldName(\'district\')"></field-messages></div></div><div class="slds-grid"><div *ngIf="!hidestate" class="slds-form-element slds-col slds-size--1-of-2 slds-p-right--xx-small"><field-label [fieldname]="fieldName(\'state\')" labellength="short"></field-label><system-input-state [(ngModel)]="state" [country]="country"></system-input-state><field-messages [fieldname]="fieldName(\'state\')"></field-messages></div><div class="slds-form-element slds-p-left--xx-small slds-col"><label class="slds-form-element__label"><system-label label="LBL_COUNTRY"></system-label></label><system-input-country [(ngModel)]="country"></system-input-country><field-messages [fieldname]="fieldName(\'country\')"></field-messages></div></div></div></fieldset></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,services_1.configurationService,services_1.backend])],fieldAddress)}(fieldGeneric);exports.fieldAddress=fieldAddress;var fieldFullName=function(d){function fieldFullName(e,t,s,i,l){var a=d.call(this,e,t,s,i,l)||this;return a.model=e,a.view=t,a.language=s,a.metadata=i,a.router=l,a.isValid=!0,a.errorMessage="",a}return __extends(fieldFullName,d),Object.defineProperty(fieldFullName.prototype,"fieldsalutation",{get:function(){return this.fieldconfig.field_salutation||"salutation"},enumerable:!1,configurable:!0}),Object.defineProperty(fieldFullName.prototype,"fielddegree",{get:function(){return this.fieldconfig.field_degree||"degree1"},enumerable:!1,configurable:!0}),Object.defineProperty(fieldFullName.prototype,"fieldfirstname",{get:function(){return this.fieldconfig.field_firstname||"first_name"},enumerable:!1,configurable:!0}),Object.defineProperty(fieldFullName.prototype,"fieldlastname",{get:function(){return this.fieldconfig.field_lastname||"last_name"},enumerable:!1,configurable:!0}),Object.defineProperty(fieldFullName.prototype,"fieldlasttitle",{get:function(){return this.fieldconfig.field_lasttitle||"degree2"},enumerable:!1,configurable:!0}),Object.defineProperty(fieldFullName.prototype,"salutationdisplay",{get:function(){return this.language.getFieldDisplayOptionValue(this.model.module,this.fieldsalutation,this.model.data[this.fieldsalutation])},enumerable:!1,configurable:!0}),Object.defineProperty(fieldFullName.prototype,"value",{get:function(){return this.filterUndefined(this.language.getFieldDisplayOptionValue(this.model.module,this.fieldsalutation,this.model.data[this.fieldsalutation]))+" "+this.filterUndefined(this.model.data[this.fielddegree])+" "+this.filterUndefined(this.model.data[this.fieldfirstname])+" "+this.filterUndefined(this.model.data[this.fieldlastname])+" "+this.filterUndefined(this.model.data[this.fieldlasttitle])},enumerable:!1,configurable:!0}),Object.defineProperty(fieldFullName.prototype,"salutation",{get:function(){return this.model.getField(this.fieldsalutation)},set:function(e){this.model.setField(this.fieldsalutation,e)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldFullName.prototype,"degree1",{get:function(){return this.model.getField(this.fielddegree)},set:function(e){this.model.setField(this.fielddegree,e)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldFullName.prototype,"first_name",{get:function(){return this.model.getField(this.fieldfirstname)},set:function(e){this.model.setField(this.fieldfirstname,e)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldFullName.prototype,"last_name",{get:function(){return this.model.getField(this.fieldlastname)},set:function(e){this.model.setField(this.fieldlastname,e)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldFullName.prototype,"degree2",{get:function(){return this.model.getField(this.fieldlasttitle)},set:function(e){this.model.setField(this.fieldlasttitle,e)},enumerable:!1,configurable:!0}),fieldFullName.prototype.filterUndefined=function(e){return e||""},Object.defineProperty(fieldFullName.prototype,"isSimple",{get:function(){return this.fieldconfig.simple},enumerable:!1,configurable:!0}),fieldFullName.prototype.getClassesForSubField=function(e){var t="";switch(e){case this.fieldsalutation:t="small"==this.view.size?"slds-size--1-of-3 slds-order--1":this.isSimple?"slds-size--1-of-5":"slds-size--1-of-7";break;case this.fielddegree:t="small"==this.view.size?"slds-size--1-of-3 slds-order--2":"slds-size--1-of-7";break;case this.fieldlasttitle:t="small"==this.view.size?"slds-size--1-of-3 slds-order--3":"slds-size--1-of-7";break;case this.fieldfirstname:t="small"==this.view.size?"slds-size--1-of-2 slds-order--4":this.isSimple?"slds-p-left--xx-small slds-size--2-of-5":"slds-p-left--xx-small slds-size--2-of-7";break;case this.fieldlastname:t="small"==this.view.size?"slds-size--1-of-2 slds-order--5":this.isSimple?"slds-size--2-of-5":"slds-size--2-of-7"}return this.getStati(e).invalid&&(t+=" slds-has-error"),t},fieldFullName.prototype.getSalutations=function(){var e,t=[],s=this.language.getFieldDisplayOptions(this.model.module,this.fieldconfig.field_salutation||"salutation");for(e in s)t.push({value:e,display:s[e]});return t},__decorate([core_1.Component({selector:"field-full-name",template:'<ng-container *ngIf="!isEditMode()"><field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig" [title]="value" [fieldid]="fieldid">{{value}}</field-generic-display></ng-container><div *ngIf="isEditable() && isEditMode()"><div class="slds-grid slds-grid_vertical-align-center slds-wrap"><div class="slds-col slds-form-element__control slds-align-top" [ngClass]="getClassesForSubField(fieldsalutation)"><field-label [fieldname]="fieldsalutation"></field-label><div class="slds-select_container slds-p-vertical--xxx-small"><select class="slds-select" [(ngModel)]="salutation"><option *ngFor="let o of getSalutations()" [value]="o.value">{{o.display}}</option></select></div><field-messages [fieldname]="fieldsalutation"></field-messages></div><div *ngIf="!isSimple" class="slds-col slds-form-element__control slds-p-left--xx-small slds-align-top" [ngClass]="getClassesForSubField(fielddegree)"><field-label [fieldname]="fielddegree"></field-label><input class="slds-input slds-p-vertical--xxx-small" type="text" [(ngModel)]="degree1"><field-messages [fieldname]="fielddegree"></field-messages></div><div class="slds-col slds-form-element__control slds-align-top" [ngClass]="getClassesForSubField(fieldfirstname)"><field-label [fieldname]="fieldfirstname"></field-label><input class="slds-input slds-p-vertical--xxx-small" type="text" [(ngModel)]="first_name" [ngModelOptions]="{updateOn: \'blur\'}"><field-messages [fieldname]="fieldfirstname"></field-messages></div><div class="slds-col slds-form-element__control slds-p-left--xx-small slds-align-top" [ngClass]="getClassesForSubField(fieldlastname)"><field-label [fieldname]="fieldlastname"></field-label><input #focus class="slds-input slds-p-vertical--xxx-small" type="text" [(ngModel)]="last_name" [ngModelOptions]="{updateOn: \'blur\'}"><field-messages [fieldname]="fieldlastname"></field-messages></div><div *ngIf="!isSimple" class="slds-col slds-form-element__control slds-p-left--xx-small slds-align-top" [ngClass]="getClassesForSubField(fieldlasttitle)"><field-label [fieldname]="fieldlasttitle"></field-label><input class="slds-input slds-p-vertical--xxx-small" type="text" [(ngModel)]="degree2"><field-messages [fieldname]="fieldlasttitle"></field-messages></div></div></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],fieldFullName)}(fieldGeneric);exports.fieldFullName=fieldFullName;var fieldTitle=function(d){function fieldTitle(e,t,s,i,l){var a=d.call(this,e,t,s,i,l)||this;return a.model=e,a.view=t,a.language=s,a.metadata=i,a.router=l,a.isValid=!0,a.errorMessage="",a}return __extends(fieldTitle,d),Object.defineProperty(fieldTitle.prototype,"fielddd",{get:function(){return this.fieldconfig.field_dd||"title_dd"},enumerable:!1,configurable:!0}),Object.defineProperty(fieldTitle.prototype,"fieldtxt",{get:function(){return this.fieldconfig.field_txt||"title"},enumerable:!1,configurable:!0}),Object.defineProperty(fieldTitle.prototype,"titledddisplay",{get:function(){return this.language.getFieldDisplayOptionValue(this.model.module,this.fielddd,this.model.data[this.fielddd])},enumerable:!1,configurable:!0}),Object.defineProperty(fieldTitle.prototype,"value",{get:function(){return(this.model.data[this.fielddd]?this.language.getFieldDisplayOptionValue(this.model.module,this.fielddd,this.model.data[this.fielddd]):"")+(this.model.data[this.fieldtxt]?" "+this.model.data[this.fieldtxt]:"")},enumerable:!1,configurable:!0}),fieldTitle.prototype.getFieldClass=function(){var e=[];return this.isValid||e.push("slds-has-error"),e},fieldTitle.prototype.getTitles=function(){var e,t=[],s=this.language.getFieldDisplayOptions(this.model.module,this.fieldconfig.field_dd||"title_dd");for(e in s)t.push({value:e,display:s[e]});return t},__decorate([core_1.Component({selector:"field-title",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig">{{value}}</field-generic-display><div *ngIf="isEditable() && isEditMode()"><div class="slds-grid slds-p-around--xx-small"><div class="slds-col slds-form-element__control slds-size--1-of-2" [ngClass]="getFieldClass()"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="model.data[fielddd]"><option *ngFor="let o of getTitles()" [value]="o.value">{{o.display}}</option></select></div></div><div class="slds-col slds-form-element__control slds-size--1-of-2 slds-p-left--xx-small" [ngClass]="getFieldClass()"><input class="slds-input" type="text" [(ngModel)]="model.data[fieldtxt]"></div></div><div *ngIf="errorMessage !== \'\'" class="slds-form-element__help">{{errorMessage}}</div></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],fieldTitle)}(fieldGeneric);exports.fieldTitle=fieldTitle;var fieldFile=function(f){function fieldFile(e,t,s,i,l,a,d,n,o,r,c){var u=f.call(this,e,t,s,i,l)||this;return u.model=e,u.view=t,u.language=s,u.metadata=i,u.router=l,u.configurationService=a,u.session=d,u.toast=n,u.modal=o,u.backend=r,u.helper=c,u.showUploadModal=!1,u.theFile="",u.theProgress=0,u}return __extends(fieldFile,f),fieldFile.prototype.humanFileSize=function(e){var t=e;if(Math.abs(e)<1024)return t+" B";for(var s=["kB","MB","GB","TB","PB","EB","ZB","YB"],i=-1;t/=1024,++i,1024<=Math.abs(t)&&i<s.length-1;);return t.toFixed(1)+" "+s[i]},fieldFile.prototype.uploadFile=function(){var e=this.fileupload.element.nativeElement.files;this.doupload(e)},fieldFile.prototype.doupload=function(e){var t=this;this.showUploadModal=!0,this.theFile=e[0].name,this.uploadAttachmentsBase64(e).subscribe(function(e){e.progress?t.theProgress=e.progress.loaded/e.progress.total*100:e.complete&&(t.value=e.filename||t.theFile,t.model.setField("file_mime_type",e.filetype))},function(e){t.closeUploadPopup()},function(){return t.closeUploadPopup()})},fieldFile.prototype.removeFile=function(){this.value="",this.model.setField("file_mime_type","")},fieldFile.prototype.closeUploadPopup=function(){this.showUploadModal=!1},fieldFile.prototype.uploadAttachmentsBase64=function(e){var l=this;if(0!==e.length){for(var a=new rxjs_1.Subject,t=this.configurationService.getSystemParamater("upload_maxsize"),s=this,i=0,d=e;i<d.length;i++)!function(i){if(t&&i.size>t)return s.toast.sendToast(s.language.getLabelFormatted("LBL_EXCEEDS_MAX_UPLOADFILESIZE",[i.name,s.humanFileSize(t)]),"error"),a.error(!0);s.readFile(i).subscribe(function(e){var s=new XMLHttpRequest;s.onreadystatechange=function(e){if(void 0===e&&(e=l),4==s.readyState)try{var t=JSON.parse(s.response);a.next({complete:!0,filename:t.filename,filetype:t.filetype}),a.complete()}catch(e){s.responseText}},s.upload.addEventListener("progress",function(e){a.next({progress:{total:e.total,loaded:e.loaded}})},!1),s.open("POST",l.configurationService.getBackendUrl()+"/module/"+l.model.module+"/"+l.model.id+"/noteattachment",!0),s.setRequestHeader("OAuth-Token",l.session.authData.sessionId),s.setRequestHeader("Content-Type","application/json;charset=UTF-8");var t={file:i.filecontent,filename:i.name,filemimetype:i.type};s.send(JSON.stringify(t))})}(d[i]);return a.asObservable()}},fieldFile.prototype.readFile=function(e){var i=new rxjs_1.Subject,l=new FileReader;return l.file=e,l.onloadend=function(e){var t=(t=l.result.toString()).substring(t.indexOf("base64,")+7),s=l.file;s.filecontent=t,i.next(s),i.complete()},l.readAsDataURL(e),i.asObservable()},fieldFile.prototype.getBarStyle=function(){return{width:this.theProgress+"%"}},fieldFile.prototype.b64toBlob=function(e,t,s){void 0===t&&(t=""),void 0===s&&(s=512);for(var i=atob(e),l=[],a=0;a<i.length;a+=s){for(var d=i.slice(a,a+s),n=new Array(d.length),o=0;o<d.length;o++)n[o]=d.charCodeAt(o);var r=new Uint8Array(n);l.push(r)}return new Blob(l,{type:t})},fieldFile.prototype.downloadAttachment=function(){var i=this;this.backend.getRequest("module/"+this.model.module+"/"+this.model.id+"/noteattachment").subscribe(function(e){var t=i.b64toBlob(e.file,e.file_mime_type),s=URL.createObjectURL(t),t=document.createElement("a");document.body.appendChild(t),t.href=s,t.download=e.filename,t.type=e.file_mime_type,t.click(),t.remove()})},fieldFile.prototype.previewFile=function(){var s=this;if(this.model.getFieldValue("file_mime_type")){var e=this.model.getFieldValue("file_mime_type").split("/");switch(e[0]){case"image":this.modal.openModal("SystemImagePreviewModal").subscribe(function(t){t.instance.imgname=s.value,t.instance.imgtype=s.model.getFieldValue("file_mime_type"),s.backend.getRequest("module/"+s.model.module+"/"+s.model.id+"/noteattachment").subscribe(function(e){t.instance.imgsrc="data:"+s.model.getFieldValue("file_mime_type")+";base64,"+e.file})});break;case"text":case"audio":case"video":this.modal.openModal("SystemObjectPreviewModal").subscribe(function(t){t.instance.name=s.value,t.instance.type=s.model.getFieldValue("file_mime_type"),s.backend.getRequest("module/"+s.model.module+"/"+s.model.id+"/noteattachment").subscribe(function(e){t.instance.data=atob(e.file)})});break;case"application":"pdf"===e[1]?this.modal.openModal("SystemObjectPreviewModal").subscribe(function(t){t.instance.name=s.value,t.instance.type=s.model.getFieldValue("file_mime_type"),s.backend.getRequest("module/"+s.model.module+"/"+s.model.id+"/noteattachment").subscribe(function(e){t.instance.data=atob(e.file)})}):this.downloadAttachment();break;default:this.downloadAttachment()}}else this.downloadAttachment()},fieldFile.prototype.preventdefault=function(e){(1==e.dataTransfer.items.length&&"file"===e.dataTransfer.items[0].kind||0<e.dataTransfer.files.length)&&(e.preventDefault(),e.stopPropagation())},__decorate([core_1.ViewChild("fileupload",{read:core_1.ViewContainerRef,static:!(fieldFile.prototype.onDrop=function(e){this.doupload(e)})}),__metadata("design:type",core_1.ViewContainerRef)],fieldFile.prototype,"fileupload",void 0),__decorate([core_1.Component({selector:"field-file",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig" [title]="value" [fieldid]="fieldid"><div class="slds-grid slds-grid--vertical-align-center"><system-file-icon *ngIf="value" [filemimetype]="model.getField(\'file_mime_type\')" [filename]="value" divClass="slds-p-right--xx-small" size="x-small"></system-file-icon><div class="slds-truncate slds-grow"><a href="javascript:void(0);" (click)="previewFile()">{{value}}</a></div></div></field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control slds-grid slds-grid--align-spread slds-p-vertical--xx-small" [ngClass]="getFieldClass()"><div *ngIf="value" class="slds-pill slds-pill_link slds-size--1-of-1"><span class="slds-pill__icon_container"><span class="slds-icon_container slds-icon-standard-account" title="Account"><system-icon [icon]="helper.determineFileIcon(model.getField(\'file_mime_type\'))" divClass sprite="doctype" size="x-small"></system-icon></span></span> <a href="javascript:void(0);" class="slds-pill__action"><span class="slds-pill__label">{{value}}</span></a> <button class="slds-button slds-button_icon slds-button_icon slds-pill__remove" title="Remove" (click)="removeFile()"><system-button-icon icon="close"></system-button-icon></button></div><div *ngIf="!value" class="slds-file-selector slds-file-selector_files"><div class="slds-file-selector__dropzone" (system-drop-file)="onDrop($event)"><input #fileupload type="file" (click)="fileupload.value = null" class="slds-file-selector__input slds-assistive-text" [id]="fieldid" (change)="uploadFile()"> <label class="slds-file-selector__body" [attr.for]="fieldid"><span class="slds-file-selector__button slds-button slds-button_neutral"><system-button-icon [icon]="\'upload\'"></system-button-icon><system-label label="LBL_UPLOAD_FILES"></system-label></span> <span class="slds-file-selector__text slds-medium-show"><system-label label="LBL_OR"></system-label> <system-label label="LBL_DROP_FILES"></system-label></span></label></div></div><field-messages [fieldname]="fieldname"></field-messages></div><div *ngIf="showUploadModal" role="dialog" class="slds-modal slds-fade-in-open"><div class="slds-modal__container"><div class="slds-modal__header slds-modal__header--empty"></div><div class="slds-modal__content slds-p-around--medium">uploading {{theFile}} ...<div class="uploadbar"><div class="uploadprogress" [ngStyle]="getBarStyle()"></div></div></div></div></div><div *ngIf="showUploadModal" class="slds-backdrop slds-backdrop--open"></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,services_1.configurationService,services_1.session,services_1.toast,services_1.modal,services_1.backend,services_1.helper])],fieldFile)}(fieldGeneric);exports.fieldFile=fieldFile;var fieldUrl=function(d){function fieldUrl(e,t,s,i,l){var a=d.call(this,e,t,s,i,l)||this;return a.model=e,a.view=t,a.language=s,a.metadata=i,a.router=l,a}return __extends(fieldUrl,d),Object.defineProperty(fieldUrl.prototype,"url",{get:function(){return this.model.data[this.fieldname]?this.model.data[this.fieldname].replace(/https?\:\/\//,""):""},enumerable:!1,configurable:!0}),fieldUrl.prototype.navigateTo=function(){""!=this.url&&window.open("//"+this.url,"_blank")},__decorate([core_1.Component({selector:"field-url",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig" [fieldid]="fieldid"><div class="slds-grid slds-grid--vertical-align-center slds-text-link_reset" (click)="navigateTo()"><system-utility-icon *ngIf="url" class="slds-m-right--xx-small" icon="world" size="x-small"></system-utility-icon><div class="slds-truncate">{{url}}</div></div></field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control slds-grid slds-grid--align-spread" [ngClass]="getFieldClass()"><input #focus class="slds-input" type="text" [(ngModel)]="value" [ngModelOptions]="modelOptions"><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],fieldUrl)}(fieldGeneric);exports.fieldUrl=fieldUrl;var fieldEmail=function(d){function fieldEmail(e,t,s,i,l){var a=d.call(this,e,t,s,i,l)||this;return a.model=e,a.view=t,a.language=s,a.metadata=i,a.router=l,a.invalid=!1,a.validation=new RegExp('^(([^<>()\\[\\]\\\\.,;:\\s@"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@"]+)*)|(".+"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$'),a._value="",a.mark=a.model.generateGuid(),a.subscriptions.add(a.model.data$.subscribe(function(e){(!a.value||a.value&&a.value!=e.email1)&&a.setInitialFieldValue()})),a.model.observeFieldChanges("email_addresses").subscribe(function(){a.setInitialFieldValue()}),a}return __extends(fieldEmail,d),Object.defineProperty(fieldEmail.prototype,"value",{get:function(){return this._value},set:function(e){(this._value=e)&&0<e.length&&!this.validation.test(e)?(this.model.setFieldMessage("error",this.language.getLabel("LBL_INPUT_INVALID"),this.fieldname,this.mark),this.invalid=!0):(this.model.setField(this.fieldname,e||""),this.setPrimaryEmail(e),this.model.resetFieldMessages(this.fieldname,"error",this.mark),this.invalid=!1)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldEmail.prototype,"fieldClass",{get:function(){return this.invalid?__spreadArray(__spreadArray([],this.css_classes),["slds-has-error"]):this.css_classes},enumerable:!1,configurable:!0}),fieldEmail.prototype.ngOnInit=function(){this.setInitialFieldValue(),d.prototype.ngOnInit.call(this)},fieldEmail.prototype.setInitialFieldValue=function(){this._value=this.model.getField(this.fieldname);var e=this.model.getRelatedRecords("email_addresses"),e=e?e.find(function(e){return 1==e.primary_address}):void 0;this._value||(this._value=e?e.email_address:void 0)},fieldEmail.prototype.setPrimaryEmail=function(e){var t,s=e?{id:this.model.generateGuid(),primary_address:"1",email_address:e.toLowerCase(),email_address_caps:e.toUpperCase()}:void 0,e=this.model.getRelatedRecords("email_addresses");e&&0!=e.length||!s?s?(t=!1,e.forEach(function(e){s.email_address_caps==e.email_address_caps?(t=!0,e.primary_address=1):e.primary_address=0}),t||e.push(s)):e=e.filter(function(e){return 1!=e.primary_address}):e=[s],this.model.setRelatedRecords("email_addresses",e)},fieldEmail.prototype.sendEmail=function(e){e.stopPropagation(),e.preventDefault(),0<this.value.length&&window.open("mailto:"+this.value)},__decorate([core_1.Component({selector:"field-email",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [fieldconfig]="fieldconfig" [editable]="isEditable()" [title]="value"><div class="slds-grid slds-grid--vertical-align-center"><div class="slds-truncate">{{value}}</div><system-utility-icon *ngIf="value" icon="email" size="x-small" class="slds-text-link_reset slds-p-left--x-small" (click)="sendEmail($event)"></system-utility-icon></div></field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control slds-p-around--xx-small" [ngClass]="fieldClass"><input class="slds-input" type="text" [(ngModel)]="value" [ngModelOptions]="modelOptions"><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],fieldEmail)}(fieldGeneric);exports.fieldEmail=fieldEmail;var fieldEmailAddresses=function(n){function fieldEmailAddresses(e,t,s,i,l,a){var d=n.call(this,e,t,s,i,a)||this;return d.model=e,d.view=t,d.language=s,d.metadata=i,d.broadcast=l,d.router=a,d.primaryInputRadioName=_.uniqueId("field-email-address-"),d.canAdd=!1,d.isAdding=!1,d.emailAddresses=[],d.inputNewEmailAddress={primary_address:"",invalid_email:0,email_address:"",hasFocus:!0},d.subscribeToDataChange(),d}return __extends(fieldEmailAddresses,n),fieldEmailAddresses.prototype.ngOnInit=function(){this.initialize(),this.subscribeToModeChange()},fieldEmailAddresses.prototype.handleOnDelete=function(t){this.emailAddresses=this.emailAddresses.filter(function(e){return e.id!==t.id}),t.isNew?this.model.setRelatedRecords("email_addresses",this.emailAddresses):this.model.removeRelatedRecords("email_addresses",[t.id]),0==this.emailAddresses.length&&this.setEmail1Field(void 0),this.fieldconfig.singleMode&&(this.canAdd=!0,this.startAdding()),this.handleFieldInvalid()},fieldEmailAddresses.prototype.sendEmail=function(e){1!=e.invalid_email&&window.location.assign("mailto:"+e.email_address)},fieldEmailAddresses.prototype.trackByFn=function(e,t){return t.id},fieldEmailAddresses.prototype.setPrimary=function(t){var s=this;1!=t.invalid_email&&(this.emailAddresses.forEach(function(e){e.id==t.id?(e.primary_address="1",s.setEmail1Field(t)):e.primary_address="0"}),this.model.addRelatedRecords("email_addresses",this.emailAddresses))},fieldEmailAddresses.prototype.startAdding=function(){this.canAdd&&(this.isAdding=!0,this.canAdd=!1)},fieldEmailAddresses.prototype.subscribeToDataChange=function(){var t=this;this.subscriptions.add(this.broadcast.message$.subscribe(function(e){"model.loaded"==e.messagetype&&t.initialize()})),this.subscriptions.add(this.model.observeFieldChanges("email_addresses").subscribe(function(){var e=t.model.getRelatedRecords("email_addresses");t.emailAddresses=t.fieldconfig.singleMode?e.filter(function(e){return 1==e.primary_address}):e}))},fieldEmailAddresses.prototype.setEmail1Field=function(e){1!=(null==e?void 0:e.invalid_email)&&(null==e?void 0:e.email_address)!=this.model.getField("email1")&&this.model.setField("email1",null==e?void 0:e.email_address)},fieldEmailAddresses.prototype.subscribeToModeChange=function(){var e=this;this.subscriptions.add(this.view.mode$.subscribe(function(){return e.initialize()}))},fieldEmailAddresses.prototype.initialize=function(){var e=this.model.getRelatedRecords("email_addresses");this.emailAddresses=this.fieldconfig.singleMode?e.filter(function(e){return 1==e.primary_address}):e,this.isEditMode()&&(Array.isArray(this.emailAddresses)&&0!=this.emailAddresses.length?this.setCanAdd():(this.model.initializeField("email_addresses",{beans:{},beans_relations_to_delete:{}}),this.emailAddresses=[],this.canAdd=!0,this.startAdding()),this.handleFieldInvalid())},fieldEmailAddresses.prototype.setEmailAddressesField=function(){this.pushNewEmailAddress();var e=this.getUniqueCleanEmailAddresses();this.model.addRelatedRecords("email_addresses",e.unique),this.model.removeRelatedRecords("email_addresses",e.deletedIds),this.handleFieldInvalid(),this.setEmail1Field(e.unique.find(function(e){return"1"==e.primary_address})),this.setCanAdd()},fieldEmailAddresses.prototype.pushNewEmailAddress=function(){var t=this;this.isAdding&&1!=this.inputNewEmailAddress.invalid_email&&!this.emailAddresses.some(function(e){return e.email_address==t.inputNewEmailAddress.email_address})&&(0==this.emailAddresses.length&&(this.inputNewEmailAddress.primary_address=1),this.inputNewEmailAddress.id=this.model.generateGuid(),this.inputNewEmailAddress.isNew=!0,this.emailAddresses.push(__assign({},this.inputNewEmailAddress)),this.cancelAdding())},fieldEmailAddresses.prototype.handleFieldInvalid=function(){(1==this.emailAddresses.length&&this.emailAddresses[0].email_address||1<this.emailAddresses.length)&&this.emailAddresses.some(function(e){return 1==e.invalid_email})?this.setFieldError(this.language.getLabel("LBL_INPUT_INVALID")):(1==this.emailAddresses.length&&(this.emailAddresses[0].invalid_email=0),this.clearFieldError())},fieldEmailAddresses.prototype.setCanAdd=function(){this.canAdd=this.fieldconfig.singleMode?0==this.emailAddresses.length:!this.emailAddresses.some(function(e){return 1==e.invalid_email})},fieldEmailAddresses.prototype.getUniqueCleanEmailAddresses=function(){var e=[],s=this.emailAddresses.filter(function(e){return!e.email_address}).map(function(e){return e.id});return this.emailAddresses.filter(function(e){return!!e.email_address}).forEach(function(t){e.some(function(e){return e.email_address==t.email_address})?t.isNew||s.push(t.id):(delete t.hasFocus,e.push(t))}),{deletedIds:s,unique:e}},fieldEmailAddresses.prototype.cancelAdding=function(){this.inputNewEmailAddress={id:"",primary_address:"",invalid_email:0,email_address:"",hasFocus:!0},0<this.emailAddresses.length&&(this.isAdding=!1,this.setCanAdd())},__decorate([core_1.Component({selector:"field-email-addresses",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" fielddisplayclass="slds-has-divider--bottom slds-p-vertical--xx-small spice-fieldminheight" [fieldconfig]="fieldconfig" [editable]="isEditable()"><div *ngFor="let emailaddress of emailAddresses; trackBy: trackByFn" class="slds-grid slds-grid--vertical-align-center slds-size--1-of-1"><system-input-radio *ngIf="!fieldconfig.singleMode" value="1" [ngModel]="emailaddress.primary_address" [disabled]="true" system-title="LBL_PRIMARY" class="slds-truncate"></system-input-radio><div class="slds-m-bottom--xx-small slds-grow"><div class="slds-grid slds-grid--vertical-align-center"><button *ngIf="!!emailaddress.email_address" class="slds-button slds-button_icon slds-m-right--xx-small" [disabled]="emailaddress.invalid_email == \'1\'" (click)="sendEmail(emailaddress)"><system-button-icon icon="email" sprite="action"></system-button-icon></button><div class="slds-truncate" [style.text-decoration]="emailaddress.invalid_email == \'1\' ? \'line-through\' : \'initial\'">{{emailaddress.email_address}}</div></div></div><div class="slds-p-left--x-small slds-m-bottom--x-small"><field-email-emailaddress-status [status]="emailaddress.opt_in_status" class="slds-m-bottom--x-small slds-p-right--xx-small"></field-email-emailaddress-status></div></div></field-generic-display><div *ngIf="isEditMode()" class="slds-m-top--xx-small"><div *ngFor="let emailAddress of emailAddresses; trackBy: trackByFn" [class.slds-m-bottom--x-small]="emailAddresses.length > 0" class="slds-grid"><system-input-radio *ngIf="!fieldconfig.singleMode" value="1" [name]="primaryInputRadioName" [ngModel]="emailAddress.primary_address == \'1\'" (ngModelChange)="setPrimary(emailAddress)" [disabled]="emailAddress.invalid_email == 1 || !emailAddress.email_address" system-title="LBL_PRIMARY" class="slds-m-top--xx-small" style="max-width: 1.4rem"></system-input-radio><field-email-emailaddress (keyup.enter)="startAdding()" [emailAddress]="emailAddress" (onBlur)="setEmailAddressesField()" class="slds-grow"></field-email-emailaddress><field-email-emailaddress-status [status]="emailAddress.opt_in_status" class="slds-p-right--xx-small slds-p-left--x-small slds-m-top--xx-small"></field-email-emailaddress-status><button (click)="handleOnDelete(emailAddress)" [disabled]="emailAddress.primary_address == \'1\' && emailAddresses.length > 1" class="slds-button slds-button--icon slds-m-top--xxx-small" style="max-height: 1.6rem"><system-button-icon icon="clear"></system-button-icon></button></div><div *ngIf="isAdding" class="slds-grid"><system-input-radio *ngIf="!fieldconfig.singleMode" value="1" [name]="primaryInputRadioName" [ngModel]="inputNewEmailAddress.primary_address == \'1\'" (ngModelChange)="setPrimary(inputNewEmailAddress)" [disabled]="inputNewEmailAddress.invalid_email == 1 || !inputNewEmailAddress.email_address" class="slds-m-top--xx-small" style="max-width: 1.4rem"></system-input-radio><field-email-emailaddress (keyup.enter)="startAdding()" [emailAddress]="inputNewEmailAddress" (onBlur)="setEmailAddressesField()" class="slds-grow"></field-email-emailaddress><field-email-emailaddress-status [status]="inputNewEmailAddress.opt_in_status" class="slds-p-right--xx-small slds-p-left--x-small slds-m-top--xx-small"></field-email-emailaddress-status><button (click)="cancelAdding()" [disabled]="inputNewEmailAddress.primary_address == \'1\' && emailAddresses.length > 1" class="slds-button slds-button--icon slds-m-top--xxx-small" style="max-height: 1.6rem"><system-button-icon icon="clear"></system-button-icon></button></div><div *ngIf="canAdd" class="slds-grid slds-align-content-center slds-p-vertical--x-small"><button class="slds-button slds-button--icon-small slds-button--icon-border" system-title="LBL_NEW" (click)="startAdding()"><system-button-icon icon="add"></system-button-icon></button></div></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,services_1.broadcast,router_1.Router])],fieldEmailAddresses)}(fieldGeneric);exports.fieldEmailAddresses=fieldEmailAddresses;var fieldEmailEmailAddressStatus=function(){function e(){}return Object.defineProperty(e.prototype,"statusColor",{get:function(){switch(this.status){case"opted_in":return"slds-icon-text-success";case"pending":return"slds-icon-text-warning";case"opted_out":return"slds-icon-text-error";default:return"slds-icon-text-light"}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"statusIcon",{get:function(){switch(this.status){case"opted_in":return"success";case"pending":return"warning";case"opted_out":return"error";default:return"routing_offline"}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"statusLabel",{get:function(){switch(this.status){case"opted_in":return"LBL_OPTED_IN";case"pending":return"LBL_PENDING";case"opted_out":return"LBL_OPTED_OUT";default:return"LBL_OPT_IN_STATUS"}},enumerable:!1,configurable:!0}),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"status",void 0),__decorate([core_1.Component({selector:"field-email-emailaddress-status",template:'<system-utility-icon size="x-small" [icon]="statusIcon" [colorclass]="statusColor" [title]="statusLabel"></system-utility-icon>',changeDetection:core_1.ChangeDetectionStrategy.OnPush})],e)}();exports.fieldEmailEmailAddressStatus=fieldEmailEmailAddressStatus;var fieldEmailEmailAddress=function(){function e(e){this.zone=e,this.onBlur=new core_1.EventEmitter,this.emailAddress={}}return Object.defineProperty(e.prototype,"emailAddressText",{get:function(){return this.emailAddress.email_address},set:function(e){var t=this;this.emailAddress.email_address=e,this.emailAddress.email_address_caps=e.toUpperCase(),this.zone.runOutsideAngular(function(){window.clearTimeout(t.typingTimeout),t.typingTimeout=window.setTimeout(function(){return t.zone.run(function(){t.validateEmailAddress(),t.onBlur.emit()})},500)})},enumerable:!1,configurable:!0}),e.prototype.validateEmailAddress=function(){var e=new RegExp('^(([^<>()\\[\\]\\\\.,;:\\s@"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@"]+)*)|(".+"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$');this.emailAddress.invalid_email=e.test(this.emailAddress.email_address)?0:1},__decorate([core_1.Output(),__metadata("design:type",Object)],e.prototype,"onBlur",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"emailAddress",void 0),__decorate([core_1.Component({selector:"field-email-emailaddress",template:'<div class="slds-form-element slds-truncate slds-size--1-of-1" [class.slds-has-error]="emailAddress.invalid_email == 1"><div class="slds-form-element__control"><input *ngIf="!emailAddress.hasFocus; else hasFocusContainer" type="text" class="slds-input" [(ngModel)]="emailAddressText"><ng-template #hasFocusContainer><input type="text" class="slds-input" [(ngModel)]="emailAddressText" system-autofocus></ng-template></div><div *ngIf="emailAddress.invalid_email == 1" class="slds-form-element__help"><system-label label="LBL_INPUT_INVALID"></system-label></div></div>'}),__metadata("design:paramtypes",[core_1.NgZone])],e)}();exports.fieldEmailEmailAddress=fieldEmailEmailAddress;var fieldEmailRecipients=function(f){function fieldEmailRecipients(e,t,s,i,l,a,d,n,o,r,c){var u=f.call(this,e,t,s,i,l)||this;return u.model=e,u.view=t,u.language=s,u.metadata=i,u.router=l,u.modal=a,u.injector=d,u.backend=n,u.renderer=o,u.elementRef=r,u.zone=c,u.searchResults=[],u.displayValue=[],u.isInputTextVisible=!1,u.isDropdownVisible=!1,u.inputTextValue="",u.previousInputTextValue="",u.searchTimeOut=void 0,u.searchResultsLoading=!1,u.searchAllowed=!1,u.isValidEmailAddress=!1,u.subscribeToDataChanges(),u}return __extends(fieldEmailRecipients,f),Object.defineProperty(fieldEmailRecipients.prototype,"value",{get:function(){return this.model.getField("recipient_addresses")},set:function(e){this.model.setField("recipient_addresses",e),this.setDisplayValue()},enumerable:!1,configurable:!0}),fieldEmailRecipients.prototype.ngOnInit=function(){f.prototype.ngOnInit.call(this),this.setInitialFieldValue()},Object.defineProperty(fieldEmailRecipients.prototype,"hasParent",{get:function(){return!!this.model.getField("parent_id")},enumerable:!1,configurable:!0}),fieldEmailRecipients.prototype.searchParentEmailAddresses=function(){var l=this;this.modal.openModal("EmailParentAddressesModal",!0,this.injector).subscribe(function(e){e.instance.addAddresses.subscribe(function(e){for(var t=0,s=e;t<s.length;t++){var i=s[t],i={id:l.model.generateGuid(),address_type:l.fieldconfig.addresstype||"from",email_address:i.email_address,email_address_id:i.email_address_id,parent_type:i.module,parent_id:i.id};l.value=__spreadArray(__spreadArray([],l.model.data.recipient_addresses),[i])}})})},fieldEmailRecipients.prototype.validateEmail=function(e){this.isValidEmailAddress=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())},fieldEmailRecipients.prototype.subscribeToDataChanges=function(){var t=this;this.subscriptions.add(this.model.data$.subscribe(function(e){e.recipient_addresses&&Array.isArray(e.recipient_addresses)&&(JSON.stringify(t.value)!=JSON.stringify(e.recipient_addresses)&&(t.value=e.recipient_addresses),JSON.stringify(t.displayValue)!=JSON.stringify(t.value)&&t.setDisplayValue())}))},fieldEmailRecipients.prototype.setInitialFieldValue=function(){var t=this;this.model.data.recipient_addresses||(this.model.data.recipient_addresses=[]),this.setDisplayValue(),0<this.model.data.recipient_addresses.length||!0===this.fieldconfig.nodetermination||"to"!=this.fieldconfig.addresstype||!this.model.getField("parent_type")||!this.model.getField("parent_id")||this.backend.getRequest("module/"+this.model.getField("parent_type")+"/"+this.model.getField("parent_id")).subscribe(function(e){e.email1&&(t.value=[{parent_type:t.model.getField("parent_type"),parent_id:t.model.getField("parent_id"),email_address:e.email1,id:t.model.generateGuid(),address_type:"to"}])})},fieldEmailRecipients.prototype.setDisplayValue=function(){var t=this;this.displayValue=this.model.data.recipient_addresses.filter(function(e){return e.address_type==(t.fieldconfig.addresstype||"from")})},fieldEmailRecipients.prototype.onBlur=function(){this.inputTextValue||(this.isInputTextVisible=!1)},fieldEmailRecipients.prototype.onFieldClick=function(){this.isInputTextVisible=!0,this.showDropdown()},fieldEmailRecipients.prototype.removeEmailAddress=function(e,t){this.model.data.recipient_addresses&&0!=this.model.data.recipient_addresses.length&&(this.value=this.model.data.recipient_addresses.filter(function(e){return e.id!=t}),e.preventDefault(),e.stopPropagation())},fieldEmailRecipients.prototype.onKeyUp=function(e){switch(this.searchAllowed=2<this.inputTextValue.length&&-1==this.inputTextValue.indexOf("@"),this.validateEmail(this.inputTextValue),this.inputTextValue.length<3&&this.hideDropdown(),e.key){case"Enter":case",":this.searchAllowed=!1,this.addEmailAddressFromInput();break;case"Backspace":this.inputTextValue||this.previousInputTextValue||this.removeLastEmailAddress(),this.showDropdown(),this.doSearch();break;default:this.showDropdown(),this.doSearch()}this.previousInputTextValue=this.inputTextValue},fieldEmailRecipients.prototype.removeLastEmailAddress=function(){this.value&&0!=this.value.length&&(this.value=this.model.data.recipient_addresses.slice(0,this.model.data.recipient_addresses.length-1))},fieldEmailRecipients.prototype.addEmailAddressFromInput=function(){var e;this.isValidEmailAddress&&(this.searchTimeOut&&window.clearTimeout(this.searchTimeOut),e={id:this.model.generateGuid(),address_type:this.fieldconfig.addresstype||"from",email_address:this.inputTextValue},this.value=__spreadArray(__spreadArray([],this.model.data.recipient_addresses),[e]),this.hideDropdown(),this.resetInputTextValue())},fieldEmailRecipients.prototype.doSearch=function(){var t=this;this.searchAllowed&&this.previousInputTextValue!=this.inputTextValue&&this.zone.runOutsideAngular(function(){t.searchTimeOut&&window.clearTimeout(t.searchTimeOut),t.searchTimeOut=window.setTimeout(function(){t.inputTextValue&&(t.zone.run(function(){t.searchResults=[],t.searchResultsLoading=!0}),t.backend.getRequest("module/EmailAddresses/"+t.inputTextValue).subscribe(function(e){t.zone.run(function(){e&&0<e.length&&(t.searchResults=e),t.searchResultsLoading=!1})}))},1e3)})},fieldEmailRecipients.prototype.selectEmailAddress=function(e){e={id:this.model.generateGuid(),address_type:this.fieldconfig.addresstype||"from",email_address:e.email_address,email_address_id:e.email_address_id,parent_type:e.module,parent_id:e.id};this.value=__spreadArray(__spreadArray([],this.model.data.recipient_addresses),[e]),this.resetInputTextValue(),this.hideDropdown()},fieldEmailRecipients.prototype.resetInputTextValue=function(){this.inputTextValue="",this.previousInputTextValue=""},fieldEmailRecipients.prototype.addDocumentClickListener=function(){var t=this;this.clickListener=this.renderer.listen("document","click",function(e){t.elementRef.nativeElement.contains(e.target)||t.hideDropdown()})},fieldEmailRecipients.prototype.showDropdown=function(){this.inputTextValue.length<3||(this.isDropdownVisible=!0,this.clickListener||this.addDocumentClickListener())},fieldEmailRecipients.prototype.hideDropdown=function(){this.isDropdownVisible=!1,(!this.inputTextValue||this.inputTextValue.length<3)&&(this.searchResults=[]),this.clickListener&&(this.clickListener(),this.clickListener=!1)},__decorate([core_1.Component({template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [fieldconfig]="fieldconfig" [editable]="isEditable()"><div class="slds-pill_container" style="border:none;"><ul class="slds-listbox slds-listbox_horizontal slds-size--1-of-1" role="listbox"><li class="slds-pill slds-pill_link" *ngFor="let addr of displayValue"><a href="javascript:void(0);" class="slds-pill__action slds-p-horizontal--xx-small"><span class="slds-pill__label">{{addr.email_address}}</span></a></li></ul></div></field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control" [ngClass]="css_classes"><div class="slds-grid slds-grid--vertical-align-center"><div class="slds-combobox_container slds-grow"><div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click" role="combobox" [class.slds-is-open]="isDropdownVisible"><div class="slds-combobox__form-element" role="none"><div class="slds-pill_container" (click)="onFieldClick()"><ul class="slds-listbox slds-listbox_horizontal slds-size--1-of-1" role="listbox"><li *ngFor="let addr of displayValue" class="slds-listbox-item" role="presentation"><span class="slds-pill" role="option"><span *ngIf="!!addr.parent_id && !!addr.parent_type" class="slds-icon_container"><system-icon [module]="addr.parent_type" size="x-small" divClass="slds-p-right--x-small"></system-icon></span> <span class="slds-pill__label">{{addr.email_address}}</span> <span class="slds-icon_container slds-pill__remove" style="cursor: pointer"><system-button-icon [icon]="\'close\'" (click)="removeEmailAddress($event, addr.id)"></system-button-icon></span></span></li><li *ngIf="isInputTextVisible" class="slds-listbox-item slds-grow" role="presentation"><input type="text" system-autofocus [(ngModel)]="inputTextValue" (blur)="onBlur()" (keyup)="onKeyUp($event)" (keydown.,)="$event.preventDefault()" autocomplete="new-email-address" system-title="LBL_ADD_EMAILADDRESS" system-placeholder="LBL_ADD_EMAILADDRESS" class="slds-p-horizontal--x-small slds-size--1-of-1"></li></ul></div></div><div class="slds-dropdown slds-dropdown_fluid" role="listbox"><div *ngIf="!searchAllowed; else searchContainer"><div *ngIf="isValidEmailAddress; else invalidEmailAddressContainer" (click)="addEmailAddressFromInput(); hideDropdown()" class="slds-size--1-of-1 slds-grid slds-grid--vertical-align-center slds-p-around--x-small" style="cursor:pointer;"><system-label label="LBL_USE" style="display: block"></system-label><div class="slds-truncate slds-grow slds-m-left--xx-small" [title]="inputTextValue" style="font-family: sans-serif; font-weight: bold">{{inputTextValue}}</div></div><ng-template #invalidEmailAddressContainer><div class="slds-grid slds-grid--vertical-align-center slds-p-around--x-small"><system-utility-icon icon="warning" size="x-small" colorclass="slds-icon-text-warning" class="slds-m-right--xx-small" style="display: block"></system-utility-icon><div class="slds-grow slds-grid slds-grid--vertical-align-center slds-truncate" [title]="inputTextValue"><system-label label="LBL_INPUT_INVALID" style="display: block; white-space: nowrap;"></system-label><div class="slds-truncate slds-grow slds-m-left--xx-small" style="font-style: italic">"{{inputTextValue}}"</div></div></div></ng-template></div><ng-template #searchContainer><system-spinner *ngIf="searchResultsLoading" size="12" class="slds-grid slds-p-around--small"></system-spinner><ul *ngIf="searchResults?.length > 0" class="slds-listbox slds-listbox_vertical" role="presentation"><li role="presentation" class="slds-listbox__item" *ngFor="let searchResult of searchResults" (click)="selectEmailAddress(searchResult)"><div class="slds-listbox__option slds-grid slds-grid--vertical-align-center slds-p-around--x-small"><system-icon class="slds-p-right--x-small" [module]="searchResult.module" size="x-small"></system-icon><div class="slds-media__body"><span class="slds-listbox__option-text slds-listbox__option-text_entity">{{searchResult.email_address}} â¢ {{searchResult.summary_text}}</span></div></div></li></ul><div *ngIf="searchResults?.length == 0 && !searchResultsLoading" class="slds-p-around--x-small"><system-label label="MSG_NO_RECORDS_FOUND"></system-label></div></ng-template></div></div></div><button *ngIf="hasParent" system-title="LBL_SELECT_PARENT_EMAIL" class="slds-button--icon slds-button--icon-border-filled slds-m-left--xx-small" (click)="searchParentEmailAddresses()"><system-button-icon icon="record_lookup"></system-button-icon></button></div><field-messages [fieldname]="fieldname"></field-messages></div>',styles:["input, input:focus { border: none; outline: none;}"]}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,services_1.modal,core_1.Injector,services_1.backend,core_1.Renderer2,core_1.ElementRef,core_1.NgZone])],fieldEmailRecipients)}(fieldGeneric);exports.fieldEmailRecipients=fieldEmailRecipients;var fieldEmailRecipientsShort=function(r){function fieldEmailRecipientsShort(e,t,s,i,l,a,d,n){var o=r.call(this,e,t,s,i,l)||this;return o.model=e,o.view=t,o.language=s,o.metadata=i,o.router=l,o.backend=a,o.renderer=d,o.elementRef=n,o.isAdding=!1,o.addAddress="",o.searchTimeOut=void 0,o.showSearchResults=!1,o.searchResults=[],o.searchResultsLoading=!1,o}return __extends(fieldEmailRecipientsShort,r),Object.defineProperty(fieldEmailRecipientsShort.prototype,"firstAddress",{get:function(){return this.addrArray&&0<this.addrArray.length?this.addrArray[0].email_address:""},enumerable:!1,configurable:!0}),Object.defineProperty(fieldEmailRecipientsShort.prototype,"addresstype",{get:function(){return this.fieldconfig.addresstype||"from"},enumerable:!1,configurable:!0}),Object.defineProperty(fieldEmailRecipientsShort.prototype,"addrArray",{get:function(){var e=[];if(this.model.data.recipient_addresses)for(var t=0,s=this.model.data.recipient_addresses;t<s.length;t++){var i=s[t];i.address_type==this.addresstype&&"1"!=i.deleted&&e.push(i)}return e},enumerable:!1,configurable:!0}),fieldEmailRecipientsShort.prototype.onClick=function(){this.isAdding=!0},fieldEmailRecipientsShort.prototype.onBlur=function(){""==this.addAddress&&(this.isAdding=!1)},fieldEmailRecipientsShort.prototype.removeAddress=function(e,t){e.preventDefault(),e.stopPropagation();for(var s=0,i=this.model.data.recipient_addresses;s<i.length;s++){var l=i[s];if(l.id==t)return void(l.deleted="1")}},fieldEmailRecipientsShort.prototype.onKeyUp=function(e){var t=this;switch(e.key){case"ArrowDown":case"ArrowUp":break;case"Enter":this.searchTimeOut&&window.clearTimeout(this.searchTimeOut),this.validateEmail(this.addAddress)?(this.model.data.recipient_addresses||(this.model.data.recipient_addresses=[]),this.model.data.recipient_addresses.push({id:this.model.generateGuid(),address_type:this.addresstype,email_address:this.addAddress}),this.addAddress="",this.closeSearchDialog()):this.doSearch();break;default:this.searchTimeOut&&window.clearTimeout(this.searchTimeOut),this.searchTimeOut=window.setTimeout(function(){return t.doSearch()},1e3)}},fieldEmailRecipientsShort.prototype.closeSearchDialog=function(){this.clickListener(),this.searchResults=[],this.showSearchResults=!1},fieldEmailRecipientsShort.prototype.doSearch=function(){var t=this;""!==this.addAddress&&(this.searchResults=[],this.showSearchResults=!0,this.searchResultsLoading=!0,this.clickListener=this.renderer.listen("document","click",function(e){return t.handleClick(e)}),this.backend.getRequest("module/EmailAddresses/"+this.addAddress).subscribe(function(e){0<e.length?t.searchResults=e:t.closeSearchDialog(),t.searchResultsLoading=!1}))},fieldEmailRecipientsShort.prototype.handleClick=function(e){this.elementRef.nativeElement.contains(e.target)||(this.closeSearchDialog(),this.addAddress="",this.isAdding=!1)},fieldEmailRecipientsShort.prototype.selectAddress=function(e){this.model.data.recipient_addresses||(this.model.data.recipient_addresses=[]),this.model.data.recipient_addresses.push({id:this.model.generateGuid(),address_type:this.addresstype,email_address:e.email_address,email_address_id:e.email_address_id,parent_type:e.module,parent_id:e.id}),this.addAddress="",this.isAdding=!1,this.closeSearchDialog()},fieldEmailRecipientsShort.prototype.validateEmail=function(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())},__decorate([core_1.ViewChild("addAddressInput",{read:core_1.ViewContainerRef,static:!0}),__metadata("design:type",core_1.ViewContainerRef)],fieldEmailRecipientsShort.prototype,"addAddressInput",void 0),__decorate([core_1.Component({template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [fieldconfig]="fieldconfig" [editable]="isEditable()"><span>{{firstAddress}}</span></field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control slds-grid slds-grid--align-spread slds-p-around--xx-small" [ngClass]="css_classes"><div class="slds-form-element__control slds-size--1-of-1"><div class="slds-combobox_container"><div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click" role="combobox" [ngClass]="{\'slds-is-open\':showSearchResults}"><div class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right" role="none"><div class="slds-pill_container" (click)="onClick()"><ul class="slds-listbox slds-listbox_horizontal" role="listbox"><li class="slds-listbox-item" role="presentation" *ngFor="let addr of addrArray"><span class="slds-pill" role="option"><span *ngIf="addr.parent_id" class="slds-icon_container"><system-icon [module]="addr.parent_type" size="x-small" divClass="slds-p-right--x-small"></system-icon></span> <span class="slds-pill__label">{{addr.email_address}}</span> <span class="slds-icon_container slds-pill__remove"><system-button-icon [icon]="\'close\'" (click)="removeAddress($event, addr.id)"></system-button-icon></span></span></li><li class="slds-listbox-item" role="presentation"><input system-autofocus *ngIf="isAdding" type="text" style="min-width: 12rem;" class="slds-p-horizontal--x-small" [(ngModel)]="addAddress" (blur)="onBlur()" (keyup)="onKeyUp($event)" [title]="language.getLabel(\'LBL_ADD_EMAILADDRESS\')" [placeholder]="language.getLabel(\'LBL_ADD_EMAILADDRESS\')"></li></ul></div></div><div class="slds-dropdown slds-dropdown_fluid" role="listbox"><system-spinner *ngIf="searchResultsLoading" size="12"></system-spinner><ul class="slds-listbox slds-listbox_vertical" role="presentation"><li role="presentation" class="slds-listbox__item" *ngFor="let searchResult of searchResults" (click)="selectAddress(searchResult)"><div class="slds-listbox__option slds-grid slds-grid--vertical-align-center slds-p-around--x-small"><system-icon class="slds-p-right--x-small" [module]="searchResult.module" size="x-small"></system-icon><div class="slds-media__body"><span class="slds-listbox__option-text slds-listbox__option-text_entity">{{searchResult.email_address}} â¢ {{searchResult.summary_text}}</span></div></div></li></ul></div></div></div></div><field-messages [fieldname]="fieldname"></field-messages></div>',styles:["input, input:focus { border: none; outline: none;}"]}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,services_1.backend,core_1.Renderer2,core_1.ElementRef])],fieldEmailRecipientsShort)}(fieldGeneric);exports.fieldEmailRecipientsShort=fieldEmailRecipientsShort;var fieldCurrencies=function(n){function fieldCurrencies(e,t,s,i,l,a){var d=n.call(this,e,t,s,i,l)||this;return d.model=e,d.view=t,d.language=s,d.metadata=i,d.router=l,d.currency=a,d.currencies=[],d.currencies=d.currency.getCurrencies(),d}return __extends(fieldCurrencies,n),fieldCurrencies.prototype.getCurrencySymbol=function(){var e=-99;return this.model.data[this.fieldname]&&(e=this.model.data[this.fieldname]),this.currency.getCurrencySmbol(e)},__decorate([core_1.Component({selector:"field-currencies",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [fieldconfig]="fieldconfig" [editable]="isEditable()">{{getCurrencySymbol()}}</field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control" [ngClass]="getFieldClass()"><div class="slds-select_container slds-m-vertical--xx-small"><select class="slds-select" [(ngModel)]="value"><option *ngFor="let currency of currencies" [value]="currency.id">{{currency.iso}} ({{currency.symbol}})</option></select></div><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,services_1.currency])],fieldCurrencies)}(fieldGeneric);exports.fieldCurrencies=fieldCurrencies;var fieldCompanies=function(r){function fieldCompanies(e,t,s,i,l,a,d,n){var o=r.call(this,e,t,s,i,l)||this;return o.model=e,o.view=t,o.language=s,o.metadata=i,o.router=l,o.backend=a,o.configuration=d,o.userpreferences=n,o}return __extends(fieldCompanies,r),fieldCompanies.prototype.ngOnInit=function(){this.setDefault()},fieldCompanies.prototype.setDefault=function(){var e;this.view.isEditMode()&&!this.model.data[this.fieldname]&&(this.userpreferences.companyCodeId?this.value=this.userpreferences.companyCodeId:(e=this.configuration.getData("companycodes"))&&0<e.length&&(e.sort(function(e,t){return e.name>t.name?-1:1}),this.value=e[0].id))},Object.defineProperty(fieldCompanies.prototype,"companyName",{get:function(){var t=this,s="";return this.configuration.getData("companycodes").some(function(e){if(e.id==t.model.data[t.fieldname])return s=e.name,!0}),s},enumerable:!1,configurable:!0}),__decorate([core_1.Component({selector:"field-companies",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [fieldconfig]="fieldconfig" [editable]="isEditable()"><div system-model-popover module="CompanyCodes" [id]="value">{{companyName}}</div></field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-p-vertical--xx-small" [ngClass]="getFieldClass()"><system-input-companycodes [(ngModel)]="value"></system-input-companycodes><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,services_1.backend,services_1.configurationService,services_1.userpreferences])],fieldCompanies)}(fieldGeneric);exports.fieldCompanies=fieldCompanies;var fieldVat=function(o){function fieldVat(e,t,s,i,l,a,d){var n=o.call(this,e,t,s,i,l)||this;return n.model=e,n.view=t,n.language=s,n.metadata=i,n.router=l,n.backend=a,n.toast=d,n.isvalidating=!1,n}return __extends(fieldVat,o),Object.defineProperty(fieldVat.prototype,"vatDetailsField",{get:function(){return this.fieldconfig.vatdetails||"vat_details"},enumerable:!1,configurable:!0}),fieldVat.prototype.validate=function(){var t=this;this.isvalidating=!0,this.backend.getRequest("common/VIES/"+this.value).subscribe(function(e){"success"==e.status?(!0!==e.data.valid&&t.toast.sendToast(t.language.getLabel("ERR_INVALID_VAT"),"error"),t.model.data.vat_details=JSON.stringify(e.data)):t.toast.sendToast(t.language.getLabel("ERR_CHECK_VAT"),"error"),t.isvalidating=!1},function(){t.isvalidating=!1,t.toast.sendToast(t.language.getLabel("ERR_CHECK_VAT"),"error")})},Object.defineProperty(fieldVat.prototype,"cancheck",{get:function(){return this.value&&3<this.value.length},enumerable:!1,configurable:!0}),Object.defineProperty(fieldVat.prototype,"isvalid",{get:function(){return!!this.model.getField(this.vatDetailsField)&&JSON.parse(this.model.getField(this.vatDetailsField)).valid},enumerable:!1,configurable:!0}),Object.defineProperty(fieldVat.prototype,"vatInfo",{get:function(){var e=JSON.parse(this.model.getField(this.vatDetailsField));return e.name+"\n"+e.address},enumerable:!1,configurable:!0}),__decorate([core_1.Component({selector:"field-vat",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display field-generic-display-notruncate *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig" [fieldid]="fieldid"><div class="slds-size--1-of-1 slds-grid slds-grid--vertical-align-center slds-grid--align-spread"><div class="slds-grow slds-truncate"><span>{{value}}</span></div><system-tooltip class="slds-m-left--x-small" *ngIf="isvalid" [tooltiptext]="vatInfo"></system-tooltip></div></field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control slds-grid slds-grid--align-spread" [ngClass]="getFieldClass()"><div class="slds-grid slds-size--1-of-1"><ng-container *ngIf="!isvalidating; else validating"><input #focus class="slds-input" type="text" [(ngModel)]="value"><div class="slds-col_bump-left slds-grid slds-grid--vertical-align-center"><system-tooltip class="slds-m-left--x-small" *ngIf="isvalid" [tooltiptext]="vatInfo"></system-tooltip><button class="slds-button slds-button--neutral slds-m-left--x-small" [disabled]="!cancheck" (click)="validate()"><system-label label="LBL_CHECK"></system-label></button></div></ng-container><ng-template #validating><input #focus class="slds-input slds-size--1-of-1" type="text" value="{{language.getLabel(\'LBL_VALIDATING\')}}" disabled></ng-template></div><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,services_1.backend,services_1.toast])],fieldVat)}(fieldGeneric);exports.fieldVat=fieldVat;var fieldBarcode=function(d){function fieldBarcode(e,t,s,i,l){var a=d.call(this,e,t,s,i,l)||this;return a.model=e,a.view=t,a.language=s,a.metadata=i,a.router=l,a}return __extends(fieldBarcode,d),fieldBarcode.prototype.isEditMode=function(){return this.view.isEditMode()&&this.isEditable()},fieldBarcode.prototype.isEditable=function(){return this.view.isEditable&&!this.fieldconfig.readonly},__decorate([core_1.Component({selector:"field-barcode",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><div class="slds-form-element__control slds-p-top--xx-small"><div class="slds-grid slds-grid--align-spread slds-grid_vertical-align-center"><div class="slds-size--1-of-2"><input *ngIf="isEditMode()" class="slds-input" type="text" [(ngModel)]="value"><div *ngIf="!isEditMode()" class="slds-truncate">{{value}}</div></div><div class="slds-size--1-of-2 slds-text-align--right"><field-barcode-renderer [code]="value" [fieldId]="\'id_\'+fieldid"></field-barcode-renderer></div></div></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],fieldBarcode)}(fieldGeneric);exports.fieldBarcode=fieldBarcode;var fieldBarcodeRenderer=function(){function e(e,t){var s=this;this.metadata=e,this.libloader=t,this.code="",this.fieldId="",this.libloader.loadLib("js-barcode").subscribe(function(e){JsBarcode("#"+s.fieldId,s.code,{width:1,height:15,displayValue:!1})})}return e.prototype.ngOnChanges=function(){if(!this.metadata.isLibLoaded("js-barcode"))return!1;document.getElementById(this.fieldId)&&JsBarcode("#"+this.fieldId,this.code,{width:1,height:15,displayValue:!1})},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"code",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"fieldId",void 0),__decorate([core_1.Component({selector:"field-barcode-renderer",template:'<svg [id]="fieldId"></svg>'}),__metadata("design:paramtypes",[services_1.metadata,services_1.libloader])],e)}();exports.fieldBarcodeRenderer=fieldBarcodeRenderer;var fieldRating=function(d){function fieldRating(e,t,s,i,l){var a=d.call(this,e,t,s,i,l)||this;return a.model=e,a.view=t,a.language=s,a.metadata=i,a.router=l,a.options=["1","2","3","4","5"],a}return __extends(fieldRating,d),fieldRating.prototype.setRatingValue=function(e){this.value==e?this.value="":this.value=e},Object.defineProperty(fieldRating.prototype,"ratingIcon",{get:function(){return 3==parseInt(this.value,10)?"sentiment_neutral":3<parseInt(this.value,10)?"smiley_and_people":parseInt(this.value,10)<3?"sentiment_negative":void 0},enumerable:!1,configurable:!0}),__decorate([core_1.Component({selector:"field-rating",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><div *ngIf="!isEditMode()" [ngClass]="fielddisplayclass"><system-stencil *ngIf="model.isLoading; else displaycontent"></system-stencil><ng-template #displaycontent><div class="slds-grid slds-grid--vertical-align-center slds-grid--align-spread"><div *ngIf="!displayLink()" class="slds-truncate"><system-utility-icon *ngIf="value" [icon]="ratingIcon" [size]="\'x-small\'"></system-utility-icon><span *ngIf="value">({{value}})</span></div><div *ngIf="displayLink()" class="slds-truncate"><a href="javascript:void(0);" (click)="goRecord()"><system-utility-icon [icon]="ratingIcon" [size]="\'x-small\'"></system-utility-icon><span *ngIf="value">({{value}})</span></a></div><button *ngIf="isEditable()" style="float: right" class="slds-button slds-button--icon slds-m-left--xx-small" (click)="setEditMode()"><system-button-icon [icon]="\'edit\'"></system-button-icon></button></div></ng-template></div><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control slds-grid slds-grid--align-spread slds-p-around--xx-small" [ngClass]="css_classes"><div class="slds-grid slds-grid--vertical-align-center"><system-utility-icon [icon]="\'sentiment_negative\'" [size]="\'xx-small\'" class="slds-p-right--x-small"></system-utility-icon><div class="slds-form-element__control" *ngFor="let option of options"><div class="slds-radio" (click)="setRatingValue(option)"><input type="radio" id="fieldid + option" [checked]="option == value"> <label class="slds-radio__label" [attr.for]="fieldid + option"><span class="slds-radio_faux"></span></label></div></div><system-utility-icon [icon]="\'smiley_and_people\'" [size]="\'xx-small\'"></system-utility-icon></div><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],fieldRating)}(fieldGeneric);exports.fieldRating=fieldRating;var fieldLookupRecent=function(){function e(e,t,s){this.model=e,this.recent=t,this.language=s,this.module="",this.selectedObject=new core_1.EventEmitter,this.recentItems=[]}return e.prototype.ngOnChanges=function(){this.getRecent()},e.prototype.setParent=function(e,t){e.preventDefault(),this.selectedObject.emit({id:t.data.id,text:t.data.summary_text,data:t.data})},e.prototype.getRecent=function(){var t=this;this.recentItems=[];this.recent.getModuleRecent(this.module).subscribe(function(e){t.recentItems=e})},__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"module",void 0),__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],e.prototype,"selectedObject",void 0),__decorate([core_1.Component({selector:"field-lookup-recent",template:'<div class="slds-lookup__item--label slds-text-body--small">{{language.getModuleCombinedLabel(\'LBL_RECENTLYVIEWED\', module)}}</div><ul class="slds-lookup__list" role="listbox"><li *ngFor="let recentItem of recentItems" role="presentation" (mousedown)="setParent($event, recentItem)"><field-lookup-recent-item [item]="recentItem"></field-lookup-recent-item></li></ul>'}),__metadata("design:paramtypes",[services_1.model,services_1.recent,services_1.language])],e)}();exports.fieldLookupRecent=fieldLookupRecent;var fieldLookupRecentItem=function(){function e(e,t,s,i,l){this.model=e,this.router=t,this.language=s,this.metadata=i,this.view=l,this.item={},this.view.displayLabels=!1}return e.prototype.ngOnInit=function(){this.model.module=this.item.module_name,this.model.id=this.item.item_id,this.model.data=this.model.utils.backendModel2spice(this.model.module,this.item.data);var e=this.metadata.getComponentConfig("GlobalHeaderSearchResultsItem",this.model.module);e&&e.mainfieldset&&(this.mainfieldsetfields=this.metadata.getFieldSetItems(e.mainfieldset)),e&&e.subfieldset&&(this.subfieldsetfields=this.metadata.getFieldSetItems(e.subfieldset))},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"item",void 0),__decorate([core_1.Component({selector:"field-lookup-recent-item",template:'<span class="slds-lookup__item-action slds-media slds-media--center" role="option"><system-icon [module]="model.module" size="small"></system-icon><div class="slds-media__body"><div class="slds-lookup__result-text"><span *ngIf="!mainfieldsetfields">{{model.data.summary_text}}</span><ul *ngIf="mainfieldsetfields" class="slds-list_horizontal slds-has-dividers_right slds-truncate"><ng-container *ngFor="let fieldsetitem of mainfieldsetfields"><li *ngIf="model.getField(fieldsetitem.field)" class="slds-item"><field-container [field]="fieldsetitem.field" [fieldconfig]="fieldsetitem.fieldconfig" fielddisplayclass="slds-truncate"></field-container></li></ng-container></ul></div><span class="slds-lookup__result-meta slds-text-body--small"><ul class="slds-list_horizontal slds-has-dividers_right slds-truncate"><li class="slds-item"><system-label-modulename [module]="model.module" [singular]="true"></system-label-modulename></li><ng-container *ngFor="let fieldsetitem of subfieldsetfields"><li *ngIf="model.getField(fieldsetitem.field)" class="slds-item"><field-container [field]="fieldsetitem.field" [fieldconfig]="fieldsetitem.fieldconfig" fielddisplayclass="slds-truncate"></field-container></li></ng-container></ul></span></div></span>',providers:[services_1.model,services_1.view]}),__metadata("design:paramtypes",[services_1.model,router_1.Router,services_1.language,services_1.metadata,services_1.view])],e)}();exports.fieldLookupRecentItem=fieldLookupRecentItem;var fieldLookupSearch=function(){function e(e,t,s,i,l){this.metadata=e,this.model=t,this.modellist=s,this.language=i,this.modal=l,this.searchTerm="",this.searchTimeout={},this.module="",this.modulefilter="",this.disableadd=!1,this.selectedObject=new core_1.EventEmitter,this.searchWithModal=new core_1.EventEmitter,this.searchtermChange=new core_1.EventEmitter,this.subscriptions=new rxjs_1.Subscription}return Object.defineProperty(e.prototype,"searchterm",{set:function(e){var t=this;this.searchTerm=e,this.searchTimeout&&window.clearTimeout(this.searchTimeout),this.searchTimeout=window.setTimeout(function(){return t.doSearch()},500)},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){this.modellist.modulefilter=this.modulefilter,this.relatefilter&&(this.modellist.relatefilter=this.relatefilter),this.modellist.loadlimit=5,this.modellist.initialize(this.module),this.modellist.getListData()},e.prototype.ngOnChanges=function(e){e.relateId&&this.modellist.currentList&&this.modellist.getListData()},Object.defineProperty(e.prototype,"canAdd",{get:function(){return!this.disableadd&&this.metadata.checkModuleAcl(this.module,"edit")},enumerable:!1,configurable:!0}),e.prototype.doSearch=function(){""!==this.searchTerm&&this.searchTerm!==this.modellist.searchTerm&&(this.modellist.searchTerm=this.searchTerm,this.modellist.getListData())},e.prototype.setItem=function(e){this.searchTerm="",this.searchtermChange.emit(this.searchTerm),this.selectedObject.emit({id:e.id,text:e.summary_text,data:e})},e.prototype.recordAdded=function(e){this.setItem(e.data)},__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"module",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"modulefilter",void 0),__decorate([core_1.Input(),__metadata("design:type",Boolean)],e.prototype,"disableadd",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"relatefilter",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"relateId",void 0),__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],e.prototype,"selectedObject",void 0),__decorate([core_1.Output(),__metadata("design:type",Object)],e.prototype,"searchWithModal",void 0),__decorate([core_1.Output(),__metadata("design:type",Object)],e.prototype,"searchtermChange",void 0),__decorate([core_1.Input(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],e.prototype,"searchterm",null),__decorate([core_1.Component({selector:"field-lookup-search",template:'<ul class="slds-lookup__list" role="listbox"><li role="presentation"><div class="slds-p-horizontal--small slds-p-vertical--xx-small slds-grid slds-grid--vertical-align-center" role="option" (mousedown)="searchWithModal.emit()"><system-icon [icon]="\'search\'" [sprite]="\'utility\'" [size]="\'x-small\'" [addclasses]="\'slds-m-vertical--xxx-small slds-m-horizontal--xx-small\'"></system-icon><div class="slds-media__body"><div class="slds-lookup__result-text"><system-label-modulename [module]="module"></system-label-modulename> <span class="slds-p-horizontal--xx-small" *ngIf="relatefilter?.active"><system-label label="LBL_RELATED_TO"></system-label> {{relatefilter.display}}</span></div></div></div></li><li field-lookup-search-item *ngFor="let searchItem of modellist.listData.list" [module]="module" [item]="searchItem" (mousedown)="setItem(searchItem)"></li><li *ngIf="canAdd" field-lookup-search-add role="presentation" [module]="module" [parent]="model" (added)="recordAdded($event)"></li></ul>',providers:[services_1.modellist]}),__metadata("design:paramtypes",[services_1.metadata,services_1.model,services_1.modellist,services_1.language,services_1.modal])],e)}();exports.fieldLookupSearch=fieldLookupSearch;var fieldLookupSearchItem=function(){function e(e,t,s,i){this.model=e,this.view=t,this.language=s,this.metadata=i,this.item={},this.view.displayLabels=!1}return e.prototype.ngOnInit=function(){this.model.module=this.module,this.model.id=this.item.id,this.model.data=this.model.utils.backendModel2spice(this.module,this.item);var e=this.metadata.getComponentConfig("GlobalHeaderSearchResultsItem",this.model.module);e&&e.mainfieldset&&(this.mainfieldsetfields=this.metadata.getFieldSetItems(e.mainfieldset)),e&&e.subfieldset&&(this.subfieldsetfields=this.metadata.getFieldSetItems(e.subfieldset))},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"item",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"module",void 0),__decorate([core_1.Component({selector:"[field-lookup-search-item]",template:'<span class="slds-lookup__item-action slds-media slds-media--center" role="option"><system-icon [module]="model.module" size="small"></system-icon><div class="slds-media__body"><div class="slds-lookup__result-text"><span *ngIf="!mainfieldsetfields">{{model.data.summary_text}}</span><ul *ngIf="mainfieldsetfields" class="slds-list_horizontal slds-has-dividers_right slds-truncate"><ng-container *ngFor="let fieldsetitem of mainfieldsetfields"><li *ngIf="model.getField(fieldsetitem.field)" class="slds-item"><field-container [field]="fieldsetitem.field" [fieldconfig]="fieldsetitem.fieldconfig" fielddisplayclass="slds-truncate"></field-container></li></ng-container></ul></div><div class="slds-lookup__result-meta slds-text-body--small"><ul class="slds-list_horizontal slds-has-dividers_right slds-truncate"><ng-container *ngFor="let fieldsetitem of subfieldsetfields"><li *ngIf="model.getField(fieldsetitem.field)" class="slds-item"><field-container [field]="fieldsetitem.field" [fieldconfig]="fieldsetitem.fieldconfig" fielddisplayclass="slds-truncate"></field-container></li></ng-container></ul></div></div></span>',providers:[services_1.model,services_1.view]}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata])],e)}();exports.fieldLookupSearchItem=fieldLookupSearchItem;var fieldLookupSearchAdd=function(){function e(e,t){this.model=e,this.language=t,this.module="",this.added$=new core_1.EventEmitter}return e.prototype.ngOnInit=function(){this.model.module=this.module},e.prototype.addParent=function(){var t=this;this.model.addModel("",this.parent,null,!0).subscribe(function(e){t.added$.emit({id:e.id,text:e.summary_text,data:e})})},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"module",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"parent",void 0),__decorate([core_1.Output("added"),__metadata("design:type",Object)],e.prototype,"added$",void 0),__decorate([core_1.Component({selector:"[field-lookup-search-add]",template:'<div class="slds-grid slds-grid--vertical-align-center slds-p-horizontal--small slds-p-vertical--xx-small" role="option" (mousedown)="addParent()"><system-icon [icon]="\'add\'" [sprite]="\'utility\'" [size]="\'x-small\'" [addclasses]="\'slds-m-vertical--xxx-small slds-m-horizontal--xx-small\'"></system-icon><div class="slds-media__body"><div class="slds-lookup__result-text"><system-label label="LBL_CREATE"></system-label>: <system-label-modulename [module]="module" [singular]="true"></system-label-modulename></div></div></div>',providers:[services_1.model]}),__metadata("design:paramtypes",[services_1.model,services_1.language])],e)}();exports.fieldLookupSearchAdd=fieldLookupSearchAdd;var fieldModelFooterPopover=function(){function fieldModelFooterPopover(e,t,s){this.model=e,this.view=t,this.metadata=s,this.popovermodule="",this.popoverid="",this.popoverside="right",this.styles=null,this.mouseover=!1,this.hidePopoverTimeout={},this.parentElementRef=null,this.self=null,this.modelIsLoading=!1,this.fields=[]}return fieldModelFooterPopover.prototype.goDetail=function(){this.model.goDetail()},fieldModelFooterPopover.prototype.onMouseOver=function(){this.mouseover=!0,this.hidePopoverTimeout&&window.clearTimeout(this.hidePopoverTimeout)},fieldModelFooterPopover.prototype.onMouseOut=function(){this.mouseover=!1,this.self.destroy()},Object.defineProperty(fieldModelFooterPopover.prototype,"popoverStyle",{get:function(){var e=this.parentElementRef.nativeElement.getBoundingClientRect(),t=this.popover.element.nativeElement.getBoundingClientRect();return e.left<t.width?this.popoverside="right":this.popoverside="left",{top:e.top+(e.height-t.height)/2+"px",left:e.left<t.width?e.left+100+"px":e.left-t.width-15+"px"}},enumerable:!1,configurable:!0}),fieldModelFooterPopover.prototype.ngOnInit=function(){var e=this,t=this.metadata.getComponentConfig("fieldModelFooterPopover",this.popovermodule);(t.fieldset||(t=this.metadata.getComponentConfig("ObjectPageHeaderDetails",this.popovermodule)).fieldset)&&(this.fields=this.metadata.getFieldSetFields(t.fieldset)),this.modelIsLoading=!0,this.model.module=this.popovermodule,this.model.id=this.popoverid,this.model.getData().subscribe(function(){e.modelIsLoading=!1}),this.styles=this.popoverStyle},fieldModelFooterPopover.prototype.getNubbinClass=function(){return"left"==this.popoverside?"slds-nubbin--right":"slds-nubbin--left"},fieldModelFooterPopover.prototype.closePopover=function(e){var t=this;(e=void 0===e?!1:e)?this.self.destroy():this.hidePopoverTimeout=window.setTimeout(function(){return t.self.destroy()},500)},__decorate([core_1.ViewChild("popover",{read:core_1.ViewContainerRef,static:!0}),__metadata("design:type",core_1.ViewContainerRef)],fieldModelFooterPopover.prototype,"popover",void 0),__decorate([core_1.Component({selector:"field-model-footer-popover",template:'<div class="slds-popover slds-popover_large slds-popover--panel slds-is-fixed" [ngStyle]="popoverStyle" [ngClass]="getNubbinClass()" role="dialog" (mouseenter)="onMouseOver()" (mouseleave)="onMouseOut()"><button class="slds-button slds-button_icon slds-button_icon slds-button_icon-small slds-float_right slds-popover__close" (click)="closePopover(true)"><system-button-icon icon="close"></system-button-icon></button><div #popover class="slds-popover__header"><div class="slds-media slds-m-bottom--small slds-media--center"><div class="slds-media__figure"><system-icon [module]="popovermodule"></system-icon></div><div class="slds-media__body slds-truncate"><system-spinner *ngIf="modelIsLoading"></system-spinner><p class="slds-text-heading--medium slds-hyphenate"><a href="javascript:void(0);" (click)="goDetail()">{{model.data.summary_text}}</a></p></div></div><div class="slds-grid slds-wrap slds-grid--pull-padded"><div class="slds-p-horizontal--small slds-size--1-of-2 slds-p-bottom--x-small" *ngFor="let field of fields"><dl><dt><field-label [fieldname]="field.field" [fieldconfig]="field.fieldconfig"></field-label></dt><dd><field-container [field]="field.field" [fieldconfig]="field.fieldconfig" [fielddisplayclass]="\'slds-truncate\'"></field-container></dd></dl></div></div></div></div>',providers:[services_1.model,services_1.view]}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.metadata])],fieldModelFooterPopover)}();exports.fieldModelFooterPopover=fieldModelFooterPopover;var FieldMessagesComponent=function(){function e(e,t,s,i){this.model=e,this.view=t,this.language=s,this.fielderrorgroup=i,this.fieldname="",this._messages=[],this.errors=[],this.warnings=[],this.notices=[]}return e.prototype.ngOnInit=function(){var e=this;this.model.messageChange$.subscribe(function(){e.updateMessages()})},e.prototype.ngOnChanges=function(){this.updateMessages()},e.prototype.ngOnDestroy=function(){this.fielderrorgroup&&this.fielderrorgroup.setError(this.fieldname,!1)},e.prototype.updateMessages=function(){var e=0==this._messages.length&&this.fieldname?this.model.getFieldMessages(this.fieldname)||[]:this._messages;this.errors=this.filterMessages(e,"error"),this.warnings=this.filterMessages(e,"warning"),this.notices=this.filterMessages(e,"notice"),this.fielderrorgroup&&this.fielderrorgroup.setError(this.fieldname,0!==this.errors.length)},e.prototype.filterMessages=function(e,t){return e.filter(function(e){return!t||e.type==t})},__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"fieldname",void 0),__decorate([core_1.Input("messages"),__metadata("design:type",Object)],e.prototype,"_messages",void 0),__decorate([core_1.Component({selector:"field-messages",template:'<div *ngIf="errors.length > 0" class="slds-media slds-media-center slds-inline_icon_text slds-form-element__help"><div class="slds-media__figure"><span class="slds-icon_container"><system-utility-icon [icon]="\'error\'" [size]="\'x-small\'" [colorclass]="\'slds-icon-text-error\'"></system-utility-icon></span></div><div class="slds-media__body" *ngFor="let m of errors"><system-label [label]="m.message"></system-label></div></div><div *ngIf="warnings.length > 0" class="slds-media slds-media-center slds-inline_icon_text slds-inline_icon_text--warning"><div class="slds-media__figure"><span class="slds-icon_container"><system-utility-icon [icon]="\'warning\'" [size]="\'x-small\'" [colorclass]="\'slds-icon-text-warning\'"></system-utility-icon></span></div><div class="slds-media__body" *ngFor="let m of warnings"><system-label [label]="m.message"></system-label></div></div><div *ngIf="notices.length > 0" class="slds-media slds-media-center slds-inline_icon_text"><div class="slds-media__figure"><span class="slds-icon_container"><system-utility-icon [icon]="\'info\'" [size]="\'x-small\'"></system-utility-icon></span></div><div class="slds-media__body" *ngFor="let m of notices"><system-label [label]="m.message"></system-label></div></div>'}),__param(3,core_1.Optional()),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.fielderrorgrouping])],e)}();exports.FieldMessagesComponent=FieldMessagesComponent;var FieldModuleLookupComponent=function(r){function e(e,t,s,i,l,a,d,n){var o=r.call(this,e,t,i,l,a)||this;return o.model=e,o.view=t,o.popup=s,o.language=i,o.metadata=l,o.router=a,o.elementRef=d,o.renderer=n,o.relateIdField="",o.relateNameField="",o.module="",o._selected_item=null,o.show_search_results=!1,o.search_term="",o.select=new core_1.EventEmitter,o.popup.closePopup$.subscribe(function(){return o.closePopups()}),o}return __extends(e,r),e.prototype.ngOnInit=function(){var e=this.metadata.getFieldDefs(this.model.module,this.fieldname);this.relateIdField=e.id_name,this.relateNameField=this.fieldname,this.module||(this.module=e.module)},e.prototype.onClick=function(e){this.elementRef.nativeElement.contains(e.target)||this.closePopups()},e.prototype.closePopups=function(){this.clickListener(),this.model.data[this.relateIdField]&&(this.search_term=""),this.show_search_results=!1},e.prototype.onFocus=function(){var t=this;this.show_search_results=!0,this.clickListener=this.renderer.listen("document","click",function(e){return t.onClick(e)})},Object.defineProperty(e.prototype,"selected_item",{get:function(){return this._selected_item},set:function(e){e?(this._selected_item=e.data,this.relateNameField&&this.model.setField(this.relateNameField,e.text),this.relateIdField&&this.model.setField(this.relateIdField,e.id)):(this._selected_item=null,this.relateIdField&&this.model.setField(this.relateIdField,""),this.relateNameField&&this.model.setField(this.relateNameField,"")),this.select.emit(this.selected_item)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.selected_item&&this.selected_item.id?this.selected_item.id:this.relateIdField?this.model.data[this.relateIdField]:""},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"item_summary_text",{get:function(){return this.selected_item&&this.selected_item.summary_text?this.selected_item.summary_text:this.relateNameField?this.model.data[this.relateNameField]:""},enumerable:!1,configurable:!0}),e.prototype.goToDetail=function(){this.router.navigate(["/module/"+this.module+"/"+this.selected_item.id])},e.prototype.getSearchStyle=function(){if(this.show_search_results)return{width:this.elementRef.nativeElement.getBoundingClientRect().width+"px",display:"block"}},e.prototype.clear=function(){this.search_term="",this.selected_item=null},__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"module",void 0),__decorate([core_1.Output(),__metadata("design:type",Object)],e.prototype,"select",void 0),__decorate([core_1.Component({selector:"field-module-lookup",template:'<div class="slds-truncate"><div *ngIf="!isEditMode()" [ngClass]="fielddisplayclass"><system-stencil *ngIf="model.isLoading; else displaycontent"></system-stencil><ng-template #displaycontent><span><a href="javascript:void(0);" system-model-popover [module]="module" [id]="id" (click)="goToDetail()">{{value}}</a></span> <button *ngIf="isEditable()" style="float: right" class="slds-button slds-button--icon" (click)="setEditMode()"><system-button-icon [icon]="\'edit\'"></system-button-icon></button></ng-template></div><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control slds-m-vertical--xx-small" [ngClass]="getFieldClass()"><div class="slds-form-element slds-lookup"><div *ngIf="id" class="slds-form-element__control"><div class="slds-pill_container"><span class="slds-pill slds-size--1-of-1"><span class="slds-icon_container slds-icon-standard-account slds-pill__icon_container"><system-icon [module]="module" [size]="\'small\'"></system-icon></span> <span class="slds-pill__label">{{item_summary_text}}</span> <button class="slds-button slds-button--icon slds-pill__remove" (click)="clear()"><system-button-icon [icon]="\'close\'"></system-button-icon></button></span></div></div><div *ngIf="!id" class="slds-form-element__control slds-grid slds-box--border" [ngClass]="getFieldClass()"><div class="slds-input-has-icon slds-input-has-icon--right slds-grow"><system-utility-icon [icon]="\'search\'" [addclasses]="\'slds-input__icon\'"></system-utility-icon><input type="search" class="slds-lookup__search-input slds-input--bare" [(ngModel)]="search_term" (blur)="closePopups()" (focus)="onFocus()" [placeholder]="\'Search \' + language.getModuleName(module)" role="combobox"></div></div></div><div *ngIf="show_search_results" class="slds-lookup__menu" [ngStyle]="getSearchStyle()"><field-lookup-recent *ngIf="!search_term" [module]="module" (selectedObject)="selected_item = $event"></field-lookup-recent><field-lookup-search *ngIf="search_term" [module]="module" [(searchterm)]="search_term" (selectedObject)="selected_item = $event"></field-lookup-search></div><field-messages [fieldname]="fieldname"></field-messages></div></div>',providers:[services_1.popup]}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.popup,services_1.language,services_1.metadata,router_1.Router,core_1.ElementRef,core_1.Renderer2])],e)}(fieldGeneric);exports.FieldModuleLookupComponent=FieldModuleLookupComponent;var FieldSignatureComponent=function(n){function FieldSignatureComponent(e,t,s,i,l,a){var d=n.call(this,e,t,s,i,a)||this;return d.model=e,d.view=t,d.language=s,d.metadata=i,d.libloader=l,d.router=a,d.signature_height=200,d.signature_width=400,d}return __extends(FieldSignatureComponent,n),FieldSignatureComponent.prototype.ngAfterViewInit=function(){var t=this;this.config&&(0<this.config.signature_width&&(this.signature_width=this.config.signature_width),0<this.config.signature_height&&(this.signature_height=this.config.signature_height),this.display_name_field=this.config.display_name_field),this.libloader.loadLib("signature_pad").subscribe(function(e){t.pad=new SignaturePad(t.canvas.nativeElement,{backgroundColor:"rgb(255, 255, 255)"}),t.model.isLoading||!t.model.id?t.model.data$.subscribe(function(e){t.pad.fromDataURL(t.src)}):t.pad.fromDataURL(t.src)})},Object.defineProperty(FieldSignatureComponent.prototype,"config",{get:function(){return this.fieldconfig},enumerable:!1,configurable:!0}),Object.defineProperty(FieldSignatureComponent.prototype,"src",{get:function(){return this.value?"data:image/jpeg;base64,"+this.value:""},enumerable:!1,configurable:!0}),FieldSignatureComponent.prototype.undo=function(){var e=this.pad.toData();e&&(e.pop(),this.pad.fromData(e),this.convert())},FieldSignatureComponent.prototype.clear=function(){this.pad.clear(),this.convert()},FieldSignatureComponent.prototype.convert=function(){var e=this.pad.toDataURL("image/jpeg"),t=e.split("base64,");this.pad.isEmpty()?this.value="":2!=t.length?(console.warn("Failed to parse base64 code from data:",e),this.value=""):(e=t[1],this.value=e)},__decorate([core_1.ViewChild("canvas",{static:!0}),__metadata("design:type",core_1.ElementRef)],FieldSignatureComponent.prototype,"canvas",void 0),__decorate([core_1.Component({selector:"field-signature",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><div *ngIf="!isEditMode()"><div [ngStyle]="{width: signature_width+\'px\'}" class="slds-float_left"><img *ngIf="value" [src]="src"><div style="position: absolute; top: 1px; right: 1px;"><button *ngIf="isEditable()" class="slds-button slds-button--icon" (click)="setEditMode()"><system-button-icon [icon]="\'edit\'"></system-button-icon></button></div></div></div><div [ngClass]="{\'slds-hide\': !isEditMode()}"><div [ngStyle]="{width: signature_width+\'px\'}"><div class="slds-float_left"><canvas #canvas [width]="signature_width" [height]="signature_height" style="border: 1px solid;" (mouseup)="convert()" (touchend)="convert()"></canvas><div style="position: relative; bottom: 3px; right: 3px;"><button class="slds-button slds-button--icon" (click)="undo()" title="undo"><system-button-icon [icon]="\'back\'"></system-button-icon></button> <button class="slds-button slds-button--icon" (click)="clear()" title="clear"><system-button-icon [icon]="\'close\'"></system-button-icon></button></div></div><div *ngIf="display_name_field" class="slds-text-align--center">{{model.data[display_name_field]}}</div></div></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,services_1.libloader,router_1.Router])],FieldSignatureComponent)}(fieldGeneric);exports.FieldSignatureComponent=FieldSignatureComponent;var fieldServiceCategories=function(o){function fieldServiceCategories(e,t,s,i,l,a,d){var n=o.call(this,e,t,s,i,l)||this;return n.model=e,n.view=t,n.language=s,n.metadata=i,n.router=l,n.backend=a,n.config=d,n.fields=["sysservicecategory_id1","sysservicecategory_id2","sysservicecategory_id3","sysservicecategory_id4"],n.show_tree=!1,n.show_search=!1,n.categories=[],n.config.getData("service_categories")?n.categories=n.config.getData("service_categories"):(n.config.setData("service_categories",[]),n.backend.getRequest("configuration/spiceui/core/servicecategories").subscribe(function(e){n.categories=e,n.config.setData("service_categories",e)})),n}return __extends(fieldServiceCategories,o),Object.defineProperty(fieldServiceCategories.prototype,"display_value",{get:function(){for(var e="",t=0,s=this.fields;t<s.length;t++){var i=s[t];if(!this.model.data[i]||!this.categories[this.model.data[i]])break;e+=this.language.getLabel(this.categories[this.model.data[i]].name)+"\\"}return e=e.substring(0,e.length-1)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldServiceCategories.prototype,"maxlevels",{get:function(){return this.fieldconfig.maxlevels||3},enumerable:!1,configurable:!0}),fieldServiceCategories.prototype.checkUserAction=function(e){this.search?(this.show_tree=!1,this.show_search=!0):(this.show_tree=!0,this.show_search=!1)},fieldServiceCategories.prototype.chooseCategories=function(e){this.show_search=!1,this.show_tree=!1;for(var t=0;t<this.fields.length;t++)e[t]?this.model.setField(this.fields[t],e[t].id):this.model.setField(this.fields[t],"");this.search=null;for(t=e.length-1;0<=t;t--){var s=e[t];if(s.servicequeue_id){this.model.setField("servicequeue_id",s.servicequeue_id),this.model.setField("servicequeue_name",s.servicequeue_name);break}}},fieldServiceCategories.prototype.unchooseCategories=function(){for(var e=0;e<this.fields.length;e++)this.model.data[this.fields[e]]=""},__decorate([core_1.Component({selector:"field-service-categories",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [fieldconfig]="fieldconfig" [editable]="isEditable()">{{display_value}}</field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control slds-m-vertical--xx-small" [ngClass]="getFieldClass()"><div class="slds-form-element__control"><div class="slds-combobox_container slds-has-inline-listbox"><div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click slds-combobox-lookup"><div *ngIf="display_value" class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right"><div class="slds-pill_container"><span class="slds-pill slds-size--1-of-1"><span class="slds-pill__label">{{display_value}}</span> <button class="slds-button slds-button--icon slds-pill__remove" (click)="unchooseCategories()"><system-button-icon [icon]="\'close\'"></system-button-icon></button></span></div></div><div *ngIf="!display_value" class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right"><input class="slds-input slds-combobox__input" type="search" placeholder="{{language.getLabel(\'LBL_SEARCH\')}}" [(ngModel)]="search" (click)="checkUserAction($event)" (keyup)="checkUserAction($event)"></div><div *ngIf="show_tree"><field-service-category-tree [maxlevels]="maxlevels" (choose)="chooseCategories($event)"></field-service-category-tree></div><div *ngIf="show_search"><field-service-category-search [search]="search" (choose)="chooseCategories($event)"></field-service-category-search></div></div></div></div></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,services_1.backend,services_1.configurationService])],fieldServiceCategories)}(fieldGeneric);exports.fieldServiceCategories=fieldServiceCategories;var fieldServiceCategoryTree=function(){function e(e,t,s,i){var l=this;this.model=e,this.backend=t,this.config=s,this.language=i,this.category_tree=[],this.maxlevels=4,this.levels=[],this.selected_categorys=[],this.choose_emitter=new core_1.EventEmitter,this.loading=!0,this.resetLevels(),this.config.getData("service_category_tree")?(this.category_tree=this.config.getData("service_category_tree"),this.levels[0]=this.category_tree,this.loading=!1):this.backend.getRequest("configuration/spiceui/core/servicecategories/tree").subscribe(function(e){l.config.setData("service_category_tree",e),l.category_tree=e,l.levels[0]=l.category_tree,l.loading=!1})}return e.prototype.resetLevels=function(e){for(var t=e=void 0===e?0:e;t<this.maxlevels;t++)this.levels[t]=[];this.selected_categorys.splice(e,this.maxlevels-e)},e.prototype.select=function(e){(this.selected_categorys[e.level]=e).categories?(this.levels[e.level+1]=e.categories,this.resetLevels(e.level+2)):this.resetLevels(e.level+1)},e.prototype.choose=function(e){this.selected_categorys[e.level]=e,this.choose_emitter.emit(this.selected_categorys)},e.prototype.isCategorySelected=function(e){for(var t=0,s=this.selected_categorys;t<s.length;t++)if(s[t].id==e.id)return!0;return!1},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"maxlevels",void 0),__decorate([core_1.Output("choose"),__metadata("design:type",Object)],e.prototype,"choose_emitter",void 0),__decorate([core_1.Component({selector:"field-service-category-tree",template:'<div class="slds-listbox slds-listbox_vertical slds-dropdown_fluid slds-grid" role="listbox"><div *ngIf="loading" class="slds-p-around--small slds-align--absolute-center"><system-spinner></system-spinner></div><div *ngFor="let lvl of levels; let i = index" class="slds-col slds-size--1-of-{{maxlevels}}" [ngClass]="{\'slds-border--right\': i < max_levels -1}"><div *ngFor="let cat of lvl" [ngClass]="{\'slds-theme--shade\': isCategorySelected(cat)}"><div class="slds-grid slds-grid--vertical-align-center slds-p-around--xx-small" (mouseenter)="select(cat)"><span *ngIf="cat.selectable == 0 && cat.categories" class="slds-truncate" style="cursor: default;"><system-label [label]="cat.name"></system-label></span> <span *ngIf="cat.selectable == 1 || !cat.categories" (click)="choose(cat)" class="slds-truncate" style="cursor: pointer; text-decoration: underline;"><system-label [label]="cat.name"></system-label></span><system-utility-icon class="slds-m-left--small" *ngIf="cat.favorite == 1" [icon]="\'favorite\'" [size]="\'xx-small\'"></system-utility-icon><system-utility-icon class="slds-col--bump-left" *ngIf="cat.categories" [icon]="\'chevronright\'" [size]="\'xx-small\'"></system-utility-icon></div></div></div></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.backend,services_1.configurationService,services_1.language])],e)}();exports.fieldServiceCategoryTree=fieldServiceCategoryTree;var fieldServiceCategorySearch=function(){function e(e,t,s,i){var l=this;this.model=e,this.backend=t,this.config=s,this.language=i,this.categories=[],this.selected_categorys=[],this.choose_emitter=new core_1.EventEmitter,this.config.getData("service_category_tree")?this.flatteningOutCategoryTree(this.config.getData("service_category_tree")):this.backend.getRequest("configuration/spiceui/core/servicecategories/tree").subscribe(function(e){l.config.setData("service_category_tree",e),l.flatteningOutCategoryTree(e)})}return Object.defineProperty(e.prototype,"results",{get:function(){var t=this;return this.categories.filter(function(e){return e.display_name.includes(t.search)})},enumerable:!1,configurable:!0}),e.prototype.flatteningOutCategoryTree=function(e){for(var t=0,s=e;t<s.length;t++){var i=s[t];i.parents=[],this.loopThroughTree(i)}},e.prototype.loopThroughTree=function(e){if(e.display_name="",0<e.parents.length)for(var t=0,s=e.parents;t<s.length;t++){var i=s[t];e.display_name+=this.language.getLabel(i.name)+"\\"}if(e.display_name+=this.language.getLabel(e.name),this.categories.push(e),e.categories)for(var l=0,a=e.categories;l<a.length;l++){var d=a[l];d.parents=__spreadArray([],e.parents),d.parents.push(e),this.loopThroughTree(d)}},e.prototype.choose=function(e){var t=__spreadArray([],e.parents);t.push(e),this.choose_emitter.emit(t)},__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"search",void 0),__decorate([core_1.Output("choose"),__metadata("design:type",Object)],e.prototype,"choose_emitter",void 0),__decorate([core_1.Component({selector:"field-service-category-search",template:'<div role="listbox"><ul class="slds-listbox slds-dropdown_fluid" role="presentation"><li *ngFor="let cat of results" class="slds-listbox__item" role="presentation"><span class="slds-listbox__option slds-listbox__option_entity" role="option" (click)="choose(cat)"><span class="slds-p-left--medium slds-listbox__option-text slds-listbox__option-text_entity">{{language.getLabel(cat.display_name)}}</span></span></li><li *ngIf="results.length == 0" class="slds-listbox__item"><span class="slds-p-left--medium">No Matches found.</span></li></ul></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.backend,services_1.configurationService,services_1.language])],e)}();exports.fieldServiceCategorySearch=fieldServiceCategorySearch;var fieldWorklog=function(o){function fieldWorklog(e,t,s,i,l,a,d){var n=o.call(this,e,t,s,i,l)||this;return n.model=e,n.view=t,n.language=s,n.metadata=i,n.router=l,n.session=a,n.userpreferences=d,n.origin_logs=[],n.initialized=!1,n.view.isEditMode()&&n.view.mode$.subscribe(function(e){"edit"==e&&(n.origin_logs=n.logs)}),n}return __extends(fieldWorklog,o),fieldWorklog.prototype.ngOnInit=function(){var t=this;o.prototype.ngOnInit.call(this),this.view.isEditMode()&&(this.view.mode$.subscribe(function(e){"edit"==e&&(t.origin_logs=t.logs)}),this.initialized=!0)},Object.defineProperty(fieldWorklog.prototype,"logs",{get:function(){return this.value?"string"==typeof this.value?JSON.parse(this.value):this.value:[]},set:function(e){"json"!=this.field_defs.type?this.value=JSON.stringify(e):this.value=e},enumerable:!1,configurable:!0}),Object.defineProperty(fieldWorklog.prototype,"new_log_entry",{set:function(e){this._new_log_entry=e,this.initialized||this.ngOnInit();var t=__spreadArray([],this.origin_logs);t.unshift({timestamp:+new Date,user_name:this.session.authData.userName,user_id:this.session.authData.userId,text:e}),this.logs=t},enumerable:!1,configurable:!0}),Object.defineProperty(fieldWorklog.prototype,"styles",{get:function(){return{height:this.fieldconfig.height?this.fieldconfig.height+"px":"200px"}},enumerable:!1,configurable:!0}),fieldWorklog.prototype.formatTimestamp=function(e){e=moment(e);return this.userpreferences.formatDateTime(e)},__decorate([core_1.Component({selector:"field-worklog",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><div *ngIf="!isEditMode()"><div class="slds-scrollable--y" [ngStyle]="styles"><div *ngFor="let log of logs" class="slds-p-around--x-small slds-border--bottom"><div class="slds-p-around--x-small slds-theme--shade">{{log.user_name}} â¢ {{formatTimestamp(log.timestamp)}}</div><div class="slds-p-around--x-small" style="white-space: pre-line;">{{log.text}}</div></div></div></div><div *ngIf="isEditMode()"><div class="slds-grid"><div class="slds-form-element slds-size--1-of-2 slds-m-right--xx-small"><div class="slds-form-element__control"><textarea class="slds-textarea" placeholder="Write your log here..." [(ngModel)]="new_log_entry" [ngStyle]="styles"></textarea></div></div><div class="slds-size--1-of-2 slds-scrollable--y slds-m-left--xx-small" [ngStyle]="styles"><div *ngFor="let log of logs" class="slds-p-around--x-small slds-border--bottom"><div class="slds-p-around--x-small slds-theme--shade">{{log.user_name}} â¢ {{formatTimestamp(log.timestamp)}}</div><div class="slds-p-around--x-small">{{log.text}}</div></div></div></div></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,services_1.session,services_1.userpreferences])],fieldWorklog)}(fieldGeneric);exports.fieldWorklog=fieldWorklog;var FieldModelInfoComponent=function(){function FieldModelInfoComponent(e,t){this.model=e,this.language=t}return __decorate([core_1.Component({selector:"field-model-info",template:'<div class="slds-icon_container" system-model-popover><system-utility-icon [icon]="\'info\'" [size]="\'x-small\'"></system-utility-icon></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.language])],FieldModelInfoComponent)}();exports.FieldModelInfoComponent=FieldModelInfoComponent;var FieldEnumModulesComponent=function(d){function FieldEnumModulesComponent(e,t,s,i,l){var a=d.call(this,e,t,s,i,l)||this;return a.model=e,a.view=t,a.language=s,a.metadata=i,a.router=l,a}return __extends(FieldEnumModulesComponent,d),Object.defineProperty(FieldEnumModulesComponent.prototype,"displayAsterisk",{get:function(){return!!this.fieldconfig.displayAsterisk},enumerable:!1,configurable:!0}),__decorate([core_1.Component({selector:"field-enum-modules",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig" [fieldid]="fieldid">{{getValue()}}</field-generic-display><div *ngIf="isEditMode()" class="slds-form-element"><div class="slds-form-element__control" [ngClass]="getFieldClass()"><system-input-module [(ngModel)]="value" [displaytechnicalname]="false" [displayAsterisk]="displayAsterisk"></system-input-module><field-messages [fieldname]="fieldname"></field-messages></div></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],FieldEnumModulesComponent)}(fieldEnum);exports.FieldEnumModulesComponent=FieldEnumModulesComponent;var fieldGDPR=function(r){function fieldGDPR(e,t,s,i,l,a,d,n){var o=r.call(this,e,t,s,i,l)||this;return o.model=e,o.view=t,o.language=s,o.metadata=i,o.router=l,o.backend=a,o.modal=d,o.injector=n,o.gdprData={},o.loaded=!1,o}return __extends(fieldGDPR,r),fieldGDPR.prototype.ngOnInit=function(){var t=this;this.backend.getRequest("common/gdpr/"+this.model.module+"/"+this.model.id).subscribe(function(e){t.gdprData=e,t.loaded=!0})},fieldGDPR.prototype.getDataStyle=function(){if(!this.loaded)return{};if("1"==this.model.data.gdpr_data_agreement)return{"background-color":"#009900",color:"white",cursor:"pointer"};if(this.gdprData&&this.gdprData.related)for(var e=0,t=this.gdprData.related;e<t.length;e++)if("1"==t[e].gdpr_data_agreement)return{"background-color":"#009900",color:"white",cursor:"pointer"};return{"background-color":"#cc0000",color:"white",cursor:"pointer"}},fieldGDPR.prototype.getMarketingStyle=function(){if(!this.loaded)return{};if("g"==this.model.data.gdpr_marketing_agreement)return{"background-color":"#009900",color:"white",cursor:"pointer"};if("r"==this.model.data.gdpr_marketing_agreement)return{"background-color":"#cc0000",color:"white",cursor:"pointer"};if(this.gdprData.related)for(var e=0,t=this.gdprData.related;e<t.length;e++)if("1"==t[e].gdpr_marketing_agreement)return{"background-color":"#009900",color:"white",cursor:"pointer"};return{"background-color":"#cc0000",color:"white",cursor:"pointer"}},fieldGDPR.prototype.showDetails=function(){var t=this;this.modal.openModal("ObjectGDPRModal",!0,this.injector).subscribe(function(e){e.instance.gdprRelatedLog=t.gdprData.related,e.instance.gdprAuditLog=t.gdprData.audit})},__decorate([core_1.Component({selector:"field-gdpr",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><div class="slds-grid slds-grid--vertical-align-center slds-grid--align-spread slds-p-vertical--xxx-small"><span class="slds-badge" [ngStyle]="getDataStyle()" (click)="showDetails()"><system-label label="LBL_DATA"></system-label></span> <span class="slds-badge" [ngStyle]="getMarketingStyle()" (click)="showDetails()"><system-label label="LBL_MARKETING"></system-label></span></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,services_1.backend,services_1.modal,core_1.Injector])],fieldGDPR)}(fieldGeneric);exports.fieldGDPR=fieldGDPR;var fieldSelectTree=function(c){function fieldSelectTree(e,t,s,i,l,a,d,n,o){var r=c.call(this,e,t,s,i,l)||this;return r.model=e,r.view=t,r.language=s,r.metadata=i,r.router=l,r.backend=a,r.config=d,r.elementRef=n,r.renderer=o,r.fields=[],r.show_tree=!1,r.show_search=!1,r.sel_fields=[],r}return __extends(fieldSelectTree,c),fieldSelectTree.prototype.ngOnInit=function(){var t=this;this.fields.length<1&&(this.fields.push(this.fieldconfig.value1),this.fields.push(this.fieldconfig.value2),this.fields.push(this.fieldconfig.value3),this.fields.push(this.fieldconfig.value4)),this.config.getData("select_tree")?this.sel_fields=this.config.getData("select_tree"):(this.config.setData("select_tree",[]),this.backend.getRequest("configuration/spiceui/core/selecttree/list/"+this.fieldconfig.key).subscribe(function(e){t.sel_fields=e,t.config.setData("select_tree",e)}))},Object.defineProperty(fieldSelectTree.prototype,"display_value",{get:function(){for(var e="",t=0,s=this.fields;t<s.length;t++){var i=s[t];if(!this.model.data[i])break;var l,a="";for(l in this.sel_fields)this.sel_fields[l].keyname===this.model.data[i]&&(a=this.sel_fields[l].name);e+=this.language.getLabel(a)+" \\ "}return e=e.substring(0,e.length-2)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldSelectTree.prototype,"maxlevels",{get:function(){return this.fieldconfig.maxlevels||4},enumerable:!1,configurable:!0}),fieldSelectTree.prototype.checkUserAction=function(e){this.search?(this.show_tree=!1,this.show_search=!0):(this.show_tree=!0,this.show_search=!1)},fieldSelectTree.prototype.chooseSelField=function(e){this.show_search=!1,this.show_tree=!1;for(var t,s=0;s<this.fields.length;s++)e[s]?(t=""!=e[s].keyname?e[s].keyname:e[s].name,this.model.setField(this.fields[s],t)):this.model.setField(this.fields[s],"");this.search=null},fieldSelectTree.prototype.unchooseSelField=function(){for(var e=0;e<this.fields.length;e++)this.model.data[this.fields[e]]=""},fieldSelectTree.prototype.onClick=function(e){this.elementRef.nativeElement.contains(e.target)||(this.show_tree=!1)},fieldSelectTree.prototype.onFocus=function(){var t=this;this.show_tree=!0,this.clickListener=this.renderer.listen("document","click",function(e){return t.onClick(e)})},__decorate([core_1.Component({selector:"select-tree",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [fieldconfig]="fieldconfig" [editable]="isEditable()">{{display_value}}</field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control slds-m-vertical--xx-small" [ngClass]="getFieldClass()"><div class="slds-form-element__control"><div class="slds-combobox_container slds-has-inline-listbox"><div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click slds-combobox-lookup slds-size_2-of-2" aria-expanded="false" aria-haspopup="listbox" role="combobox"><div *ngIf="display_value" class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right"><div class="slds-pill_container"><span class="slds-pill slds-size--1-of-1"><span class="slds-pill__label">{{display_value}}</span> <button class="slds-button slds-button--icon slds-pill__remove" (click)="unchooseSelField()"><system-button-icon [icon]="\'close\'"></system-button-icon></button></span></div></div><div *ngIf="!display_value" class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right"><input (focus)="onFocus()" class="slds-input slds-combobox__input" type="search" placeholder="{{language.getLabel(\'LBL_SEARCH\')}}" [(ngModel)]="search" (click)="checkUserAction($event)" (keyup)="checkUserAction($event)"></div><div *ngIf="show_tree" class="slds-dropdown dropdown-trigger_click slds-dropdown_length-with-icon-1 slds-dropdown_fluid" style="display: block"><select-tree-tree [treekey]="fieldconfig.key" [maxlevels]="maxlevels" (choose)="chooseSelField($event)"></select-tree-tree></div><div *ngIf="show_search" class="slds-dropdown dropdown-trigger_click slds-dropdown_length-with-icon-1 slds-dropdown_fluid" style="display: block"><select-tree-search [treekey]="fieldconfig.key" [search]="search" (choose)="chooseSelField($event)"></select-tree-search></div></div></div></div></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,services_1.backend,services_1.configurationService,core_1.ElementRef,core_1.Renderer2])],fieldSelectTree)}(fieldGeneric);exports.fieldSelectTree=fieldSelectTree;var fieldSelectTreeSearch=function(){function e(e,t,s,i){this.model=e,this.backend=t,this.config=s,this.language=i,this.sel_fields=[],this.selected_categorys=[],this.choose_emitter=new core_1.EventEmitter}return e.prototype.ngOnInit=function(){var t=this;this.config.getData("select_tree_tree")?this.flatteningOutCategoryTree(this.config.getData("select_tree_tree")):this.backend.getRequest("configuration/spiceui/core/selecttree/tree/"+this.treekey).subscribe(function(e){t.config.setData("select_tree_tree",e),t.flatteningOutCategoryTree(e)})},Object.defineProperty(e.prototype,"results",{get:function(){var t=this;return this.sel_fields.filter(function(e){return e.display_name.includes(t.search)})},enumerable:!1,configurable:!0}),e.prototype.flatteningOutCategoryTree=function(e){for(var t=0,s=e;t<s.length;t++){var i=s[t];i.parents=[],this.loopThroughTree(i)}},e.prototype.loopThroughTree=function(e){if(e.display_name="",0<e.parents.length)for(var t=0,s=e.parents;t<s.length;t++){var i=s[t];e.display_name+=this.language.getLabel(i.name)+"\\"}if(e.display_name+=this.language.getLabel(e.name),this.sel_fields.push(e),e.childs)for(var l=0,a=e.childs;l<a.length;l++){var d=a[l];d.parents=__spreadArray([],e.parents),d.parents.push(e),this.loopThroughTree(d)}},e.prototype.choose=function(e){var t=__spreadArray([],e.parents);t.push(e),this.choose_emitter.emit(t)},__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"search",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"treekey",void 0),__decorate([core_1.Output("choose"),__metadata("design:type",Object)],e.prototype,"choose_emitter",void 0),__decorate([core_1.Component({selector:"select-tree-search",template:'<div class="slds-dropdown_fluid" role="listbox"><ul class="slds-listbox slds-dropdown_fluid" role="presentation"><li *ngFor="let cat of results" class="slds-listbox__item" role="presentation"><span class="slds-listbox__option slds-listbox__option_entity" role="option" (click)="choose(cat)"><span class="slds-p-left--medium slds-listbox__option-text slds-listbox__option-text_entity">{{language.getLabel(cat.display_name)}}</span></span></li><li *ngIf="results.length == 0" class="slds-listbox__item"><span class="slds-p-left--medium">No Matches found.</span></li></ul></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.backend,services_1.configurationService,services_1.language])],e)}();exports.fieldSelectTreeSearch=fieldSelectTreeSearch;var fieldSelectTreeTree=function(){function e(e,t,s,i){this.model=e,this.backend=t,this.config=s,this.language=i,this.select_tree=[],this.maxlevels=4,this.levels=[],this.selected_fields=[],this.choose_emitter=new core_1.EventEmitter,this.loading=!0,this.resetLevels()}return e.prototype.ngOnInit=function(){var e,t=this;this.config.getData("select_tree_tree")?((e=this.config.getData("select_tree_tree")).sort(function(e,t){e=e.name.toLowerCase(),t=t.name.toLowerCase();return e<t?-1:t<e?1:0}),this.levels[0]=e,this.loading=!1):this.backend.getRequest("configuration/spiceui/core/selecttree/tree/"+this.treekey).subscribe(function(e){t.config.setData("select_tree_tree",e),t.select_tree=e,t.select_tree.sort(function(e,t){e=e.name.toLowerCase(),t=t.name.toLowerCase();return e<t?-1:t<e?1:0}),t.levels[0]=t.select_tree,t.loading=!1})},e.prototype.resetLevels=function(e){for(var t=e=void 0===e?0:e;t<this.maxlevels;t++)this.levels[t]=[];this.selected_fields.splice(e,this.maxlevels-e)},e.prototype.select=function(e){(this.selected_fields[e.level]=e).childs?(this.levels[e.level+1]=e.childs,this.resetLevels(e.level+2)):this.resetLevels(e.level+1)},e.prototype.choose=function(e){this.selected_fields[e.level]=e,this.choose_emitter.emit(this.selected_fields)},e.prototype.isCategorySelected=function(e){for(var t=0,s=this.selected_fields;t<s.length;t++)if(s[t].id==e.id)return!0;return!1},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"maxlevels",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"treekey",void 0),__decorate([core_1.Output("choose"),__metadata("design:type",Object)],e.prototype,"choose_emitter",void 0),__decorate([core_1.Component({selector:"select-tree-tree",template:'<div class="slds-dropdown_fluid" role="listbox"><div *ngIf="loading" class="slds-p-around--small slds-align--absolute-center"><system-spinner></system-spinner></div><div *ngFor="let lvl of levels; let i = index" class="slds-col slds-size--1-of-{{maxlevels}}" [ngClass]="{\'slds-border--right\': i < maxlevels -1}"><div *ngFor="let cat of lvl" [ngClass]="{\'slds-theme--shade\': isCategorySelected(cat)}"><div class="slds-grid slds-grid--vertical-align-center slds-p-around--xx-small" (mouseenter)="select(cat)"><span *ngIf="cat.selectable == 0 && cat.childs" class="slds-truncate" style="cursor: default;"><system-label [label]="cat.name"></system-label></span> <span *ngIf="cat.selectable == 1 || !cat.childs" (click)="choose(cat)" class="slds-truncate" style="cursor: pointer; text-decoration: underline;"><system-label [label]="cat.name"></system-label></span><system-utility-icon class="slds-m-left--small" *ngIf="cat.favorite == 1" [icon]="\'favorite\'" [size]="\'xx-small\'"></system-utility-icon><system-utility-icon class="slds-col--bump-left" *ngIf="cat.childs" [icon]="\'chevronright\'" [size]="\'xx-small\'"></system-utility-icon></div></div></div></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.backend,services_1.configurationService,services_1.language])],e)}();exports.fieldSelectTreeTree=fieldSelectTreeTree;var fieldColorEnum=function(d){function fieldColorEnum(e,t,s,i,l){var a=d.call(this,e,t,s,i,l)||this;return a.model=e,a.view=t,a.language=s,a.metadata=i,a.router=l,a.longOptions=[],a.options=[],a.colors=[],a.acolor={"background-color":""},a}return __extends(fieldColorEnum,d),fieldColorEnum.prototype.ngOnInit=function(){this.getOptions()},fieldColorEnum.prototype.getOptions=function(){this.longOptions=this.language.getFieldDisplayOptions(this.model.module,this.fieldname);var e,t=this.longOptions;t&&!this.fieldconfig.useShort||(t=this.language.getDisplayOptions(this.fieldconfig.shortEnum)),this.colors=this.language.getDisplayOptions(this.fieldconfig.colorEnum),void 0!==this.colors&&(e="",void 0!==(e=this.colors[this.value])&&"#"!=e.substring(0,1)&&(e="#"+e),this.acolor["background-color"]=e);var s,i=[];for(s in t){var l=void 0!==this.colors&&void 0!==this.colors[s]?"#"!=this.colors[s].substring(0,1)?"#"+this.colors[s]:this.colors[s]:"",a=void 0!==this.longOptions?this.longOptions[s]:"";i.push({value:s,color:l,display:t[s],long:a})}this.options=i},Object.defineProperty(fieldColorEnum.prototype,"getColor",{get:function(){var e="";return void 0!==this.colors&&((e=this.colors[this.value])&&"#"!=e.substring(0,1)&&(e="#"+e),this.acolor["background-color"]=e),this.acolor},enumerable:!1,configurable:!0}),fieldColorEnum.prototype.getValue=function(){for(var e=0,t=this.options;e<t.length;e++){var s=t[e];if(s.value==this.value)return s.display}},fieldColorEnum.prototype.changed=function(){var e="";void 0!==(e=this.colors[this.value])&&"#"!=e.substring(0,1)&&(e="#"+e),this.acolor["background-color"]=e},__decorate([core_1.Component({selector:"field-enum",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig"><div style="float: left; width: 10px; height: 10px; border-radius: 5px; margin-top: 5px; margin-right: 5px;" [ngStyle]="getColor"></div>{{getValue()}}</field-generic-display><div *ngIf="isEditMode()" class="slds-form-element"><div class="slds-form-element__control" [ngClass]="getFieldClass()"><div class="slds-select_container slds-m-vertical--xx-small"><select class="slds-select" [(ngModel)]="value" (change)="changed(value)"><ng-container *ngFor="let o of options"><option [value]="o.value">{{o.long}}</option></ng-container></select></div><field-messages [fieldname]="fieldname"></field-messages></div></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],fieldColorEnum)}(fieldGeneric);exports.fieldColorEnum=fieldColorEnum;var fieldBase64=function(n){function fieldBase64(e,t,s,i,l,a){var d=n.call(this,e,t,s,i,l)||this;return d.model=e,d.view=t,d.language=s,d.metadata=i,d.router=l,d.footer=a,d}return __extends(fieldBase64,n),Object.defineProperty(fieldBase64.prototype,"minHeight",{get:function(){return this.fieldconfig.minheight||150},enumerable:!1,configurable:!0}),Object.defineProperty(fieldBase64.prototype,"maxHeight",{get:function(){return this.fieldconfig.maxheight||500},enumerable:!1,configurable:!0}),Object.defineProperty(fieldBase64.prototype,"truncated",{get:function(){return!!this.fieldconfig.truncate},enumerable:!1,configurable:!0}),Object.defineProperty(fieldBase64.prototype,"displayValue",{get:function(){try{return decodeURIComponent(window.atob(this.value))}catch(e){return""}},enumerable:!1,configurable:!0}),__decorate([core_1.Component({selector:"field-base64",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig" [fieldid]="fieldid"><div *ngIf="!truncated; else truncatedDisplay" style="white-space: pre-line;">{{displayValue}}</div><ng-template #truncatedDisplay><div [title]="displayValue" style="max-width: 200px; text-overflow: ellipsis" class="slds-truncate">{{displayValue}}</div></ng-template></field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control" [ngClass]="getFieldClass()" style="position:relative;"><system-input-base64 [(ngModel)]="value" [minHeight]="minHeight" [maxHeight]="maxHeight"></system-input-base64><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,services_1.footer])],fieldBase64)}(fieldGeneric);exports.fieldBase64=fieldBase64;var fieldNotAuthorized=function(d){function fieldNotAuthorized(e,t,s,i,l){var a=d.call(this,e,t,s,i,l)||this;return a.model=e,a.view=t,a.language=s,a.metadata=i,a.router=l,a}return __extends(fieldNotAuthorized,d),__decorate([core_1.Component({selector:"field-not-authorized",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display [fielddisplayclass]="fielddisplayclass"><span class="slds-text-color_inverse-weak"><system-label label="LBL_NOTAUTHORIZED"></system-label></span></field-generic-display>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],fieldNotAuthorized)}(fieldGeneric);exports.fieldNotAuthorized=fieldNotAuthorized;var fieldModuleIcon=function(d){function fieldModuleIcon(e,t,s,i,l){var a=d.call(this,e,t,s,i,l)||this;return a.model=e,a.view=t,a.language=s,a.metadata=i,a.router=l,a}return __extends(fieldModuleIcon,d),__decorate([core_1.Component({selector:"field-module-icon",template:'<div [ngClass]="fielddisplayclass"><system-stencil *ngIf="model.isLoading; else displaycontent"></system-stencil><ng-template #displaycontent><system-icon [module]="value" size="xx-small"></system-icon></ng-template></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],fieldModuleIcon)}(fieldGeneric);exports.fieldModuleIcon=fieldModuleIcon;var fieldRichText=function(m){function fieldRichText(e,t,s,i,l,a,d,n,o,r,c,u,f){var p=m.call(this,e,t,s,i,d)||this;return p.model=e,p.view=t,p.language=s,p.metadata=i,p.backend=l,p.toast=a,p.router=d,p.injector=n,p.broadcast=o,p.configurationService=r,p.modal=c,p.cdRef=u,p.sanitized=f,p.selectedSignatureId="",p.signatures=[],p.parsedHtml="",p.fullValue="",p.stylesheetField="",p.stylesheetToUse="",p.signaturePreviousPosition=-1,p.stylesheets=p.metadata.getHtmlStylesheetNames(),p}return __extends(fieldRichText,m),Object.defineProperty(fieldRichText.prototype,"heightStyle",{get:function(){return{height:this.fieldconfig.height||"500px"}},enumerable:!1,configurable:!0}),Object.defineProperty(fieldRichText.prototype,"styleTag",{get:function(){return this.stylesheetId?"<style>"+this.metadata.getHtmlStylesheetCode(this.stylesheetId)+"</style>":""},enumerable:!1,configurable:!0}),Object.defineProperty(fieldRichText.prototype,"stylesheetId",{get:function(){return _.isEmpty(this.model.data[this.stylesheetField])?this.stylesheetId=this.stylesheetToUse:this.model.data[this.stylesheetField]},set:function(e){e&&this.model.setField(this.stylesheetField,e)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldRichText.prototype,"value",{get:function(){return this.model.getField(this.fieldname)},set:function(e){this.model.setField(this.fieldname,e),this.setHtmlValue()},enumerable:!1,configurable:!0}),fieldRichText.prototype.ngOnInit=function(){var t;return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return this.setStylesheetField(),this.setStylesheetsToUse(),this.setHtmlValue(),null!==(t=this.fieldconfig)&&void 0!==t&&t.useSignature?[4,this.loadMailboxSignature()]:[3,2];case 1:e.sent(),this.loadUserSignature(),e.label=2;case 2:return this.modelChangesSubscriber(),[2]}})})},fieldRichText.prototype.renderSelectedSignature=function(){var e,t=this;this.clearSignature(),this.selectedSignatureId&&(this.value||(this.value=""),e='<div data-signature="" style="margin: 10px 0">'+this.signatures.find(function(e){return e.id==t.selectedSignatureId}).content+"</div>",-1<this.signaturePreviousPosition?this.value=this.value.slice(0,this.signaturePreviousPosition)+" "+e+" "+this.value.slice(e.length+this.signaturePreviousPosition):this.value="<p><br></p> "+e+" "+this.value)},fieldRichText.prototype.setEditMode=function(){this.model.startEdit(),this.view.setEditMode(),this.cdRef.detectChanges()},fieldRichText.prototype.encodeHtml=function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},fieldRichText.prototype.loadMailboxSignature=function(){var t=this;if(this.isEditMode()){var s=this.model.getField("mailbox_id");if(s){var e=this.configurationService.getData("mailbox_signature_"+s);if(!e)return this.backend.get("Mailboxes",s).toPromise().then(function(e){e.email_signature&&(t.configurationService.setData("mailbox_signature_"+s,e.email_signature),t.addSignature(s,e.email_signature,"LBL_MAILBOX"),t.selectedSignatureId=s,t.renderSelectedSignature())});this.addSignature(s,e,"LBL_MAILBOX"),this.selectedSignatureId=s,this.renderSelectedSignature()}}},fieldRichText.prototype.addSignature=function(t,e,s){var i=this.signatures.find(function(e){return e.id==t});i?i.content=e:this.signatures.push({id:t,content:e,label:s})},fieldRichText.prototype.loadUserSignature=function(){var e,t;!this.isEditMode()||(e=this.configurationService.getData("usersignature"))&&(t=0==this.signatures.length,this.addSignature("user",e,"LBL_MY_SIGNATURE"),t&&(this.selectedSignatureId="user",this.renderSelectedSignature()))},fieldRichText.prototype.clearSignature=function(){var t,s=this;this.value&&((t=document.createElement("div")).innerHTML=this.value,Array.from(t.querySelectorAll("div[data-signature]")).forEach(function(e){s.signaturePreviousPosition=t.innerHTML.indexOf(e.outerHTML),e.parentNode.removeChild(e)}),this.value=t.innerHTML)},fieldRichText.prototype.setStylesheetField=function(){var e=this.metadata.getFieldDefs(this.model.module,this.fieldname);_.isEmpty(e.stylesheet_id_field)||(this.stylesheetField=e.stylesheet_id_field)},fieldRichText.prototype.setStylesheetsToUse=function(){this.useStylesheets=!_.isEmpty(this.stylesheetField)&&!_.isEmpty(this.stylesheets),this.useStylesheets&&(1===this.stylesheets.length?this.stylesheetToUse=this.stylesheets[0].id:_.isEmpty(this.fieldconfig.stylesheetId)?this.stylesheetToUse=this.metadata.getHtmlStylesheetToUse(this.model.module,this.fieldname):this.stylesheetToUse=this.fieldconfig.stylesheetId)},fieldRichText.prototype.setSanitizedValue=function(){return this.value&&(this.value.includes("</html>")?this.fullValue=this.value:this.fullValue='<html><head><base target="_blank">'+this.styleTag+'</head><body class="spice">'+this.value+"</body></html>"),this.fullValue!=this.fullValue_cached&&(this.sanitizedValue=this.sanitized.bypassSecurityTrustResourceUrl(this.fullValue?"data:text/html;charset=UTF-8,"+encodeURIComponent(this.fullValue):""),this.fullValue_cached=this.fullValue),this.sanitizedValue},fieldRichText.prototype.modelChangesSubscriber=function(){var s=this;this.subscriptions.add(this.model.observeFieldChanges(this.fieldname).subscribe(function(e){s.setHtmlValue()})),this.subscriptions.add(this.model.observeFieldChanges("mailbox_id").subscribe(function(t){var e;null!==(e=s.fieldconfig)&&void 0!==e&&e.useSignature&&t&&!s.signatures.some(function(e){return e.id==t})&&s.loadMailboxSignature()}))},fieldRichText.prototype.setHtmlValue=function(){for(var e=/<code>[\s\S]*?<\/code>/g,t=e.exec(this.value);null!=t;)this.value=this.value.replace(t,this.encodeHtml(t)).replace("&lt;code&gt;","<code>").replace("&lt;/code&gt;","</code>"),t=e.exec(this.value);this.parsedHtml=this.sanitized.bypassSecurityTrustHtml(this.value),this.setSanitizedValue()},fieldRichText.prototype.save=function(e){var t=this,s=((s={date_modified:this.model.data.date_modified})[this.fieldname]=e,s);this.backend.save(this.model.module,this.model.id,s).subscribe(function(e){t.model.endEdit(),t.model.data.date_modified=e.date_modified,t.value=e[t.fieldname],t.model.startEdit(),t.toast.sendToast(t.language.getLabel("LBL_DATA_SAVED")+".","success")},function(e){return t.toast.sendToast(t.language.getLabel("LBL_ERROR")+" "+e.status,"error",e.error.error.message)})},__decorate([core_1.Component({selector:"field-richtext",template:'<div class="slds-grid slds-grid--vertical-align-center slds-grid--align-spread"><div><field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label></div><button *ngIf="!isEditMode() && isEditable()" class="slds-button slds-button--icon slds-m-left--xx-small spice-hover-button" (click)="setEditMode()"><system-button-icon [icon]="\'edit\'"></system-button-icon></button></div><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="false" [fieldconfig]="fieldconfig"><div *ngIf="!fieldconfig.asiframe" class="slds-size--1-of-1 slds-rich-text-editor__output" [innerHTML]="parsedHtml" style="white-space: normal; resize: vertical; overflow-y: auto;"></div><iframe *ngIf="fieldconfig.asiframe" [src]="sanitizedValue" style="resize: vertical;" [ngStyle]="heightStyle" width="100%" frameborder="0" seamless></iframe></field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control" [ngClass]="getFieldClass()"><system-richtext-editor [(ngModel)]="value" (save$)="save($event)" [extendedmode]="!fieldconfig.simplemode" [innerheight]="fieldconfig.innerheight" [useMedialFile]="metadata.checkModuleAcl(\'MediaFiles\', \'list\') && metadata.checkModuleAcl(\'MediaFiles\', \'view\')"><li *ngIf="fieldconfig?.useSignature"><div class="slds-form-element slds-grid"><label class="slds-form-element__label"><system-label label="LBL_SIGNATURE"></system-label>:</label><div class="slds-form-element__control"><div class="slds-select_container"><select [(ngModel)]="selectedSignatureId" (ngModelChange)="renderSelectedSignature()" [disabled]="signatures?.length == 0" class="slds-select"><option><system-label label="LBL_NONE"></system-label></option><option *ngFor="let signature of signatures" [value]="signature.id"><system-label [label]="signature.label"></system-label></option></select></div></div></div></li></system-richtext-editor><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,services_1.backend,services_1.toast,router_1.Router,core_1.Injector,services_1.broadcast,services_1.configurationService,services_1.modal,core_1.ChangeDetectorRef,platform_browser_1.DomSanitizer])],fieldRichText)}(fieldGeneric);exports.fieldRichText=fieldRichText;var fieldEnumMulti=function(o){function fieldEnumMulti(e,t,s,i,l,a,d){var n=o.call(this,e,t,s,i,l)||this;return n.model=e,n.view=t,n.language=s,n.metadata=i,n.router=l,n.elementRef=a,n.renderer=d,n.options=[],n.selectedValues=[],n.showSelect=!1,n}return __extends(fieldEnumMulti,o),fieldEnumMulti.prototype.ngOnInit=function(){var t=this;this.model.data$.subscribe(function(e){t.buildOptions()})},fieldEnumMulti.prototype.getValue=function(){for(var e=[],t=0,s=this.selectedValues;t<s.length;t++){var i=s[t];e.push(this.options[i])}return e.join(", ")},fieldEnumMulti.prototype.getValues=function(){var e,t=[];this.getValueArray();for(e in this.options){for(var s=!1,i=0,l=this.selectedValues;i<l.length;i++)e==l[i]&&(s=!0);t.push({id:this.model.generateGuid(),value:e,display:this.options[e],selected:s})}return t},fieldEnumMulti.prototype.getValueArray=function(){try{return this.model.data[this.fieldname].substring(1,this.model.data[this.fieldname].length-1).split("^,^")}catch(e){return[]}},fieldEnumMulti.prototype.buildOptions=function(){this.options=[],this.selectedValues=this.getValueArray(),this.options=this.language.getFieldDisplayOptions(this.model.module,this.fieldname)},fieldEnumMulti.prototype.clickedItem=function(e,t){t.stopPropagation(),""==this.selectedValues[0]&&(this.selectedValues=[]);t=this.selectedValues.indexOf(e.value);-1==t?0<this.selectedValues.length?this.selectedValues.push(e.value):this.selectedValues=[e.value]:this.selectedValues.splice(t,1);e=Object.assign([],this.selectedValues),t="";0<e.length&&(t="^"+e.join("^,^")+"^"),this.model.setField(this.fieldname,t)},__decorate([core_1.Component({selector:"field-enummulti",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig"><span>{{getValue()}}</span></field-generic-display><div *ngIf="isEditMode()" class="slds-form-element"><div class="slds-form-element__control"><div class="slds-combobox_container"><div tabindex="-1" class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click" system-dropdown-trigger aria-expanded="true" aria-haspopup="listbox" role="combobox"><div class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right" role="none"><input type="text" class="slds-input slds-combobox__input-value" role="textbox" placeholder="Select an Option" [value]="getValue()"><system-icon icon="down" sprite="utility" addclasses="slds-input__icon slds-input__icon_right"></system-icon></div><div class="slds-dropdown slds-dropdown_length-5 slds-dropdown_fluid" role="listbox"><ul class="slds-listbox slds-listbox_vertical" role="presentation"><li *ngFor="let val of getValues()" (click)="clickedItem(val, $event)" role="presentation" class="slds-listbox__item"><div id="option1" class="slds-media slds-listbox__option slds-listbox__option_plain slds-media_small slds-is-selected" role="option"><span *ngIf="val.selected" class="slds-media__figure slds-listbox__option-icon"><span class="slds-icon_container slds-icon-utility-check slds-current-color"><system-icon icon="check" size="xx-small" sprite="utility" addclasses="slds-input__icon slds-input__icon_right"></system-icon></span></span> <span class="slds-media__body"><span class="slds-truncate" title="Accounts"><span class="slds-assistive-text"></span> {{val.display}}</span></span></div></li></ul></div></div></div></div></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,core_1.ElementRef,core_1.Renderer2])],fieldEnumMulti)}(fieldGeneric);exports.fieldEnumMulti=fieldEnumMulti;var fieldPhoneAsterisk=function(n){function fieldPhoneAsterisk(e,t,s,i,l,a){var d=n.call(this,e,t,s,i,l)||this;return d.model=e,d.view=t,d.l=s,d.metadata=i,d.router=l,d.backend=a,d.invalid=!1,d}return __extends(fieldPhoneAsterisk,n),fieldPhoneAsterisk.prototype.makeCall=function(){""!=this.model.data[this.fieldname]&&this.backend.postRequest("asterisk/outgoingcall",{},{msisdn:this.value}).subscribe(function(e){console.log(e)})},__decorate([core_1.Component({selector:"field-phone-asterisk",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [fieldconfig]="fieldconfig" [editable]="isEditable()"><div class="slds-grid slds-grid--vertical-align-center"><div class="slds-truncate"><a [href]="\'tel:\'+value">{{value}}</a></div><system-icon class="slds-text-link_reset slds-p-left--x-small" *ngIf="value" [icon]="\'call\'" [sprite]="\'utility\'" [size]="\'x-small\'" (click)="makeCall()"></system-icon></div></field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control slds-p-around--xx-small" [ngClass]="css_classes"><input type="text" class="slds-input" [(ngModel)]="value" required minlength="3" [maxlength]="fieldlength" [ngModelOptions]="modelOptions"><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,services_1.backend])],fieldPhoneAsterisk)}(fieldGeneric);exports.fieldPhoneAsterisk=fieldPhoneAsterisk;var fieldCronInterval=function(n){function fieldCronInterval(e,t,s,i,l,a){var d=n.call(this,e,t,s,l,a)||this;return d.model=e,d.view=t,d.language=s,d.userPreferences=i,d.metadata=l,d.router=a,d.weekdays=[],d.months=[],d.everyLabels={minutes:"LBL_MINUTE{s}",hours:"LBL_HOUR{s}",days:"LBL_DAY{s}",months:"LBL_MONTH{s}",weekdays:"LBL_WEEKDAY{s}",daysAt:"LBL_DAY{s}_AT",monthsAt:"LBL_MONTH{s}_AT"},d.recurrenceLabels={daily:"LBL_DAILY",weekly:"LBL_WEEKLY",monthly:"LBL_MONTHLY",annually:"LBL_ANNUALLY",everyWeekday:"LBL_EVERY_WEEKDAY"},d}return __extends(fieldCronInterval,n),fieldCronInterval.prototype.ngOnInit=function(){this.setSelectOptionsFromMoment(),this.initializeValue(),this.setLocalValue(this.value),this.subscribeToFieldChanges(),this.subscribeToLanguageChanges()},fieldCronInterval.prototype.resetEveryAtValue=function(){this.expression.everyAtValue=void 0},fieldCronInterval.prototype.resetEveryQuantity=function(){this.expression.everyQuantity=void 0},fieldCronInterval.prototype.onRecurrenceSet=function(){"custom"!=this.expression.recurrence&&"cron"!=this.expression.recurrence?(this.setDefaultRecurrenceEveryAtValue(),this.setFieldValue()):this.expression.every="minutes",this.resetEveryQuantity()},fieldCronInterval.prototype.onEverySet=function(){this.resetEveryAtValue(),"weekdays"==this.expression.every&&(this.resetEveryQuantity(),this.expression.everyAtValue||(this.expression.everyAtValue={})),"daysAt"==this.expression.every&&(this.expression.everyAtValue=moment().hour(0).minute(0).tz(this.userPreferences.toUse.timezone)),null!=this.expression.everyQuantity&&"daysAt"!=this.expression.every&&"monthsAt"!=this.expression.every&&this.setFieldValue()},fieldCronInterval.prototype.setDefaultRecurrenceEveryAtValue=function(){switch(this.expression.recurrence){case"daily":this.expression.everyAtValue=moment(moment().utc().hour(0).minute(0));break;case"weekly":this.expression.everyAtValue="0";break;case"monthly":case"annually":this.expression.everyAtValue="1"}},fieldCronInterval.prototype.subscribeToLanguageChanges=function(){var e=this;this.subscriptions.add(this.language.currentlanguage$.subscribe(function(){e.setSelectOptionsFromMoment(),e.setDisplayValue()}))},fieldCronInterval.prototype.setSelectOptionsFromMoment=function(){this.weekdays=moment.weekdays(),this.months=moment.months()},fieldCronInterval.prototype.subscribeToFieldChanges=function(){var t=this;this.subscriptions.add(this.model.observeFieldChanges(this.fieldname).subscribe(function(e){return t.setLocalValue(e)})),this.subscriptions.add(this.model.canceledit$.subscribe(function(){return t.setLocalValue(t.value)}))},fieldCronInterval.prototype.setFieldValue=function(){switch(this.resetExpressionProperties(),this.expression.recurrence){case"custom":this.setCustomExpression();break;case"cron":break;default:this.setExpressionByRecurrenceUnit()}this.expression.stringValue=this.expression.minutes+"::",this.expression.stringValue+=this.expression.hours+"::",this.expression.stringValue+=this.expression.monthDay+"::",this.expression.stringValue+=this.expression.month+"::",this.expression.stringValue+=""+this.expression.weekDay,this.value=this.expression.stringValue,this.setDisplayValue()},fieldCronInterval.prototype.setCustomExpression=function(){if(!isNaN(this.expression.everyQuantity)||"weekdays"==this.expression.every)switch(this.expression.everyQuantity<1&&(this.expression.everyQuantity=1),this.expression.every){case"minutes":59<this.expression.everyQuantity&&(this.expression.everyQuantity=59),this.expression.minutes="*/"+this.expression.everyQuantity;break;case"hours":23<this.expression.everyQuantity&&(this.expression.everyQuantity=23),this.expression.minutes="0",this.expression.hours="*/"+this.expression.everyQuantity;break;case"days":31<this.expression.everyQuantity&&(this.expression.everyQuantity=31),this.expression.minutes="0",this.expression.hours="0",this.expression.monthDay="*/"+this.expression.everyQuantity;break;case"daysAt":if(!moment.isMoment(this.expression.everyAtValue))break;31<this.expression.everyQuantity&&(this.expression.everyQuantity=31),this.expression.hours=""+this.expression.everyAtValue.utc().hour(),this.expression.minutes=""+this.expression.everyAtValue.utc().minute(),this.expression.monthDay="*/"+this.expression.everyQuantity;break;case"months":12<this.expression.everyQuantity&&(this.expression.everyQuantity=12),this.expression.minutes="0",this.expression.hours="0",this.expression.month="*/"+this.expression.everyQuantity;break;case"monthsAt":this.expression.everyAtValue<1&&(this.expression.everyAtValue=1),31<this.expression.everyAtValue&&(this.expression.everyAtValue=31),12<this.expression.everyQuantity&&(this.expression.everyQuantity=12),this.expression.minutes="0",this.expression.hours="0",this.expression.monthDay=""+this.expression.everyAtValue,this.expression.month="*/"+this.expression.everyQuantity;break;case"weekdays":this.expression.minutes="0",this.expression.hours="0",this.expression.weekDay=this.expression.everyAtValue.join(",")}},fieldCronInterval.prototype.resetExpressionProperties=function(){this.expression.minutes="*",this.expression.hours="*",this.expression.monthDay="*",this.expression.month="*",this.expression.weekDay="*"},fieldCronInterval.prototype.setExpressionByRecurrenceUnit=function(){switch(this.expression.recurrence){case"daily":this.expression.minutes=""+this.expression.everyAtValue.utc().minute(),this.expression.hours=""+this.expression.everyAtValue.utc().hour();break;case"weekly":this.expression.minutes="0",this.expression.hours="0",this.expression.weekDay=this.expression.everyAtValue;break;case"everyWeekday":this.expression.minutes="0",this.expression.hours="0",this.expression.weekDay="1-5";break;case"monthly":this.expression.minutes="0",this.expression.hours="0",this.expression.monthDay=this.expression.everyAtValue;break;case"annually":this.expression.minutes="0",this.expression.hours="0",this.expression.month=this.expression.everyAtValue,this.expression.monthDay="1"}},fieldCronInterval.prototype.initializeValue=function(){this.model.isNew&&(this.value="*::*::*::*::*")},fieldCronInterval.prototype.setLocalValue=function(e){var t;e&&e!=(null===(t=this.expression)||void 0===t?void 0:t.stringValue)&&5==e.split("::").length&&(this.parseExpressionFromString(e),this.setDisplayValue())},fieldCronInterval.prototype.parseExpressionFromString=function(e){this.expression&&(this.expression.every=void 0,this.resetEveryAtValue(),this.resetEveryQuantity());var t=e.split("::");this.expression={minutes:t[0],hours:t[1],monthDay:t[2],month:t[3],weekDay:t[4],stringValue:e},this.setRecurrenceAtFromInput(e),"custom"==this.expression.recurrence&&this.setEveryValueFromExpression()},fieldCronInterval.prototype.setRecurrenceAtFromInput=function(e){var t=!isNaN(+(this.expression.minutes+this.expression.hours))&&e.endsWith("::*::*::*"),s=!isNaN(+(this.expression.minutes+this.expression.hours+this.expression.weekDay))&&"*"==this.expression.month&&"*"==this.expression.monthDay,i="0::0::*::*::1-5"==e,l=!isNaN(+(this.expression.minutes+this.expression.hours+this.expression.monthDay))&&e.endsWith("::*::*"),e=!isNaN(+(this.expression.minutes+this.expression.hours+this.expression.monthDay+this.expression.monthDay))&&e.endsWith("::*");t?(this.expression.recurrence="daily",this.expression.everyAtValue=moment(moment.utc().hour(+this.expression.hours).minute(+this.expression.minutes)).tz(this.userPreferences.toUse.timezone)):s?(this.expression.recurrence="weekly",this.expression.everyAtValue=this.expression.weekDay):i?this.expression.recurrence="everyWeekday":l?(this.expression.recurrence="monthly",this.expression.everyAtValue=this.expression.monthDay):e?(this.expression.recurrence="annually",this.expression.everyAtValue=this.expression.month):this.expression.recurrence="custom"},fieldCronInterval.prototype.setEveryValueFromExpression=function(){var e=this.expression.minutes,t=this.expression.hours,s=this.expression.monthDay,i=this.expression.month,l=this.expression.weekDay;"*"==i&&"*"==l?(e.startsWith("*")&&"*"==t&&"*"==s&&(this.expression.every="minutes",this.expression.everyQuantity="*"==e?1:+e.substring(2)),t.startsWith("*/")&&0==+e&&"*"==s&&(this.expression.every="hours",this.expression.everyQuantity=+t.substring(2)),s.startsWith("*/")&&0==+e&&0==+t&&(this.expression.every="days",this.expression.everyQuantity=+s.substring(2)),s.startsWith("*/")&&-1<+t&&-1<+e&&(this.expression.every="daysAt",this.expression.everyQuantity=+s.substring(2),this.expression.everyAtValue=moment(moment.utc().hour(+t).minute(+e)).tz(this.userPreferences.toUse.timezone))):(i.startsWith("*/")&&0==+e&&0==+t&&"*"==l&&("*"==s&&(this.expression.every="months"),0<+s&&(this.expression.every="monthsAt",this.expression.everyAtValue=+s),this.expression.everyQuantity=+i.substring(2)),isNaN(+l.split(",")[0])||0!=+e||0!=+t||"*"!=i||"*"!=s||(this.expression.every="weekdays",this.expression.everyAtValue=l.split(","))),null==this.expression.every&&(this.expression.recurrence="cron")},fieldCronInterval.prototype.setDisplayValue=function(){var t=this;if("cron"==this.expression.recurrence)return this.expression.displayValue=this.expression.stringValue;if("custom"==this.expression.recurrence){this.expression.displayValue=this.language.getLabel("LBL_EVERY")+" ";var e,s=this.expression.everyAtValue;this.expression.every&&"weekdays"!=this.expression.every&&(e=this.language.getLabel(this.everyLabels[this.expression.every].replace("{s}",1<this.expression.everyQuantity?"S":"")),this.expression.displayValue+=this.expression.everyQuantity+" "+e),this.expression.everyAtValue&&("monthsAt"==this.expression.every?this.expression.displayValue+=" "+this.expression.everyAtValue+this.language.getLabel(1==s||21==s||31==s?"LBL_ST_DAY":2==s||22==s?"LBL_ND_DAY":3==s||23==s?"LBL_RD_DAY":""):"daysAt"==this.expression.every&&moment.isMoment(this.expression.everyAtValue)?this.expression.displayValue+=" "+s.tz(this.userPreferences.toUse.timezone).format(this.userPreferences.getTimeFormat())+" "+this.language.getLabel("LBL_O_CLOCK"):"weekdays"==this.expression.every&&(this.expression.displayValue+=" "+this.expression.everyAtValue.map(function(e){return t.weekdays[e]}).join(", ")))}else switch(this.expression.displayValue=this.language.getLabel(this.recurrenceLabels[this.expression.recurrence])+" ",this.expression.displayValue+=this.language.getLabel("daily"==this.expression.recurrence?"LBL_AT_HOUR":"LBL_ON_DATE","","short")+" ",this.expression.recurrence){case"daily":if(!moment.isMoment(this.expression.everyAtValue))break;this.expression.displayValue+=this.expression.everyAtValue.tz(this.userPreferences.toUse.timezone).format(this.userPreferences.getTimeFormat())+" "+this.language.getLabel("LBL_O_CLOCK");break;case"monthly":this.expression.displayValue+=" "+this.expression.everyAtValue+this.language.getLabel(1==this.expression.everyAtValue||21==this.expression.everyAtValue||31==this.expression.everyAtValue?"LBL_ST_DAY":2==this.expression.everyAtValue||22==this.expression.everyAtValue?"LBL_ND_DAY":3==this.expression.everyAtValue||23==this.expression.everyAtValue?"LBL_RD_DAY":"");break;case"weekly":this.expression.displayValue+=" "+this.weekdays[this.expression.everyAtValue];break;case"annually":this.expression.displayValue+=" "+this.months[this.expression.everyAtValue-1];break;default:this.expression.displayValue+=""+this.expression.everyAtValue}},__decorate([core_1.Component({selector:"field-cron-interval",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig"><span *ngIf="expression?.displayValue">{{expression.displayValue}}</span></field-generic-display><div *ngIf="isEditMode() && !!expression" class="slds-grid"><div class="slds-form-element slds-grid slds-grid--vertical-align-center slds-grow"><label class="slds-form-element__label"><system-label label="LBL_REPEAT"></system-label></label><div class="slds-form-element__control slds-grow"><div class="slds-select_container"><select [(ngModel)]="expression.recurrence" (ngModelChange)="onRecurrenceSet()" class="slds-select"><option value="daily"><system-label label="LBL_DAILY"></system-label></option><option value="weekly"><system-label label="LBL_WEEKLY"></system-label></option><option value="monthly"><system-label label="LBL_MONTHLY"></system-label></option><option value="annually"><system-label label="LBL_ANNUALLY"></system-label></option><option value="everyWeekday"><system-label label="LBL_EVERY_WEEKDAY"></system-label></option><option value="custom"><system-label label="LBL_CUSTOM"></system-label></option><option value="cron"><system-label label="LBL_CRON_EXPRESSION"></system-label></option></select></div></div></div><label *ngIf="expression.recurrence != \'custom\' && expression.recurrence != \'cron\' && expression.recurrence != \'everyWeekday\'" class="slds-form-element__label slds-align-middle slds-m-left--small"><system-label *ngIf="expression.recurrence ==\'daily\'" label="LBL_AT_HOUR" length="short"></system-label> <system-label *ngIf="expression.recurrence !=\'daily\'" label="LBL_ON_DATE" length="short"></system-label></label><ng-container *ngIf="expression.recurrence != \'cron\'"><div *ngIf="expression.every != \'weekdays\' && expression.recurrence == \'custom\'" class="slds-form-element slds-grid slds-grid--vertical-align-center slds-m-left--xx-small slds-grow"><label class="slds-form-element__label"><system-label label="LBL_EVERY"></system-label></label><div class="slds-form-element__control slds-grow"><input type="text" [(ngModel)]="expression.everyQuantity" (ngModelChange)="setFieldValue()" size="3" maxlength="3" class="slds-input"></div></div><div *ngIf="expression.recurrence == \'custom\'" class="slds-form-element slds-grid slds-m-left--xx-small slds-grow"><div class="slds-form-element__control slds-grow"><div class="slds-select_container"><select [(ngModel)]="expression.every" (ngModelChange)="onEverySet()" class="slds-select"><option value="minutes"><system-label [label]="expression.everyQuantity > 1 ? \'LBL_MINUTES\' : \'LBL_MINUTE\'"></system-label></option><option value="hours"><system-label [label]="expression.everyQuantity > 1 ? \'LBL_HOURS\' : \'LBL_HOUR\'"></system-label></option><option value="days"><system-label [label]="expression.everyQuantity > 1 ? \'LBL_DAYS\' : \'LBL_DAY\'"></system-label></option><option value="daysAt"><system-label [label]="expression.everyQuantity > 1 ? \'LBL_DAYS_AT\' : \'LBL_DAY_AT\'"></system-label></option><option value="months"><system-label [label]="expression.everyQuantity > 1 ? \'LBL_MONTHS\' : \'LBL_MONTH\'"></system-label></option><option value="monthsAt"><system-label [label]="expression.everyQuantity > 1 ? \'LBL_MONTHS_AT\' : \'LBL_MONTH_AT\'"></system-label></option><option value="weekdays"><system-label label="LBL_WEEK_ON"></system-label></option></select></div></div></div><div *ngIf="expression.every == \'daysAt\' || expression.recurrence == \'daily\'" class="slds-form-element slds-m-left--xx-small slds-grow"><div class="slds-form-element__control slds-input-has-fixed-addon slds-grow"><system-input-time [(ngModel)]="expression.everyAtValue" (ngModelChange)="setFieldValue()" class="slds-grow slds-p-left--xxx-small"></system-input-time><span class="slds-form-element__addon" style="white-space: nowrap;"><system-label label="LBL_O_CLOCK"></system-label></span></div></div><div *ngIf="expression.every == \'monthsAt\' || expression.recurrence == \'monthly\'" class="slds-form-element slds-m-left--xx-small slds-grow"><div class="slds-form-element__control slds-input-has-fixed-addon slds-grow"><input type="text" [(ngModel)]="expression.everyAtValue" (ngModelChange)="setFieldValue()" size="3" maxlength="6" class="slds-input"> <span class="slds-form-element__addon" style="white-space: nowrap;"><ng-container *ngIf="!!expression.everyAtValue" [ngSwitch]="expression.everyAtValue"><system-label *ngSwitchCase="(expression.everyAtValue == 1 || expression.everyAtValue == 21 || expression.everyAtValue == 31) ? expression.everyAtValue : \'1\'" label="LBL_ST_DAY"></system-label> <system-label *ngSwitchCase="(expression.everyAtValue == 2 || expression.everyAtValue == 22) ? expression.everyAtValue : \'2\'" label="LBL_ND_DAY"></system-label> <system-label *ngSwitchCase="(expression.everyAtValue == 3 || expression.everyAtValue == 23) ? expression.everyAtValue : \'3\'" label="LBL_RD_DAY"></system-label> <system-label *ngSwitchDefault label="LBL_TH_DAY"></system-label></ng-container></span></div></div><div *ngIf="expression.every == \'weekdays\'" class="slds-form-element slds-m-left--xx-small slds-grid slds-grid--vertical-align-center slds-grow"><div class="slds-form-element__control slds-grow"><system-multiple-select [showPills]="false" [(ngModel)]="expression.everyAtValue" (ngModelChange)="setFieldValue()" [listItems]="{ \'0\': weekdays[0], \'1\': weekdays[1], \'2\': weekdays[2], \'3\': weekdays[3], \'4\': weekdays[4], \'5\': weekdays[5], \'6\': weekdays[6] }"></system-multiple-select></div></div><div *ngIf="expression.recurrence == \'weekly\'" class="slds-form-element slds-m-left--xx-small slds-grid slds-grid--vertical-align-center slds-grow"><div class="slds-form-element__control slds-grow"><div class="slds-select_container"><select [(ngModel)]="expression.everyAtValue" (ngModelChange)="setFieldValue()" class="slds-select"><option *ngFor="let weekDay of weekdays; let index = index" [value]="index">{{weekDay}}</option></select></div></div></div><div *ngIf="expression.recurrence == \'annually\'" class="slds-form-element slds-m-left--xx-small slds-grid slds-grid--vertical-align-center slds-grow"><div class="slds-form-element__control slds-grow"><div class="slds-select_container"><select [(ngModel)]="expression.everyAtValue" (ngModelChange)="setFieldValue()" class="slds-select"><option *ngFor="let month of months; let index = index" [value]="index + 1">{{month}}</option></select></div></div></div></ng-container><ng-container *ngIf="expression.recurrence == \'cron\'"><div class="slds-m-left--xx-small slds-grid slds-grid--vertical-align-center slds-grow"><div class="slds-form-element slds-grow"><div class="slds-form-element__control slds-grow"><input type="text" system-placeholder="LBL_MINUTES" [(ngModel)]="expression.minutes" (ngModelChange)="setFieldValue()" size="3" maxlength="6" class="slds-input"></div></div><div class="slds-m-horizontal--xx-small">::</div><div class="slds-form-element slds-grow"><div class="slds-form-element__control slds-grow"><input type="text" system-placeholder="LBL_HOURS" [(ngModel)]="expression.hours" (ngModelChange)="setFieldValue()" size="3" maxlength="6" class="slds-input"></div></div><div class="slds-m-horizontal--xx-small">::</div><div class="slds-form-element slds-grow"><div class="slds-form-element__control slds-grow"><input type="text" system-placeholder="LBL_MONTH_DAY" [(ngModel)]="expression.monthDay" (ngModelChange)="setFieldValue()" size="3" maxlength="6" class="slds-input"></div></div><div class="slds-m-horizontal--xx-small">::</div><div class="slds-form-element slds-grow"><div class="slds-form-element__control slds-grow"><input type="text" system-placeholder="LBL_MONTH" [(ngModel)]="expression.month" (ngModelChange)="setFieldValue()" size="3" maxlength="6" class="slds-input"></div></div><div class="slds-m-horizontal--xx-small">::</div><div class="slds-form-element slds-grow"><div class="slds-form-element__control slds-grow"><input type="text" system-placeholder="LBL_WEEK_DAY" [(ngModel)]="expression.weekDay" (ngModelChange)="setFieldValue()" size="3" maxlength="6" class="slds-input"></div></div></div></ng-container></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.userpreferences,services_1.metadata,router_1.Router])],fieldCronInterval)}(fieldGeneric);exports.fieldCronInterval=fieldCronInterval;var fieldGooglePlacesSearch=function(n){function fieldGooglePlacesSearch(e,t,s,i,l,a){var d=n.call(this,e,t,s,i,a)||this;return d.model=e,d.view=t,d.language=s,d.metadata=i,d.configurationService=l,d.router=a,d.options=[],d}return __extends(fieldGooglePlacesSearch,n),fieldGooglePlacesSearch.prototype.setDetails=function(e){var t={};this.fieldconfig.formatted_phone_number&&e.formatted_phone_number&&(t[this.fieldconfig.formatted_phone_number]=e.formatted_phone_number),this.fieldconfig.international_phone_number&&e.international_phone_number&&(t[this.fieldconfig.international_phone_number]=e.international_phone_number),this.fieldconfig.website&&e.website&&(t[this.fieldconfig.website]=e.website),e.address&&(this.fieldconfig.city&&e.address.city&&(t[this.fieldconfig.city]=e.address.city),this.fieldconfig.country&&e.address.country&&(t[this.fieldconfig.country]=e.address.country),this.fieldconfig.postalcode&&e.address.postalcode&&(t[this.fieldconfig.postalcode]=e.address.postalcode),this.fieldconfig.state&&e.address.state&&(t[this.fieldconfig.state]=e.address.state),this.fieldconfig.street&&e.address.street_name&&(t[this.fieldconfig.street]=e.address.street_name),!this.hideStreetNumber&&this.fieldconfig.street_number&&e.address.street_number?t[this.fieldconfig.street_number]=e.address.street_number:this.hideStreetNumber&&this.fieldconfig.street&&e.address.street_name&&e.address.street_number&&(t[this.fieldconfig.street]+=" "+e.address.street_number),this.fieldconfig.latitude&&e.address.latitude&&(t[this.fieldconfig.latitude]=e.address.latitude),this.fieldconfig.longitude&&e.address.longitude&&(t[this.fieldconfig.longitude]=e.address.longitude)),_.isEmpty(t)||this.model.setFields(t)},Object.defineProperty(fieldGooglePlacesSearch.prototype,"hideStreetNumber",{get:function(){var e=JSON.parse((null===(e=null===(e=this.configurationService.data.backendextensions.address_format)||void 0===e?void 0:e.config)||void 0===e?void 0:e.format)||"{}");return!(null==e||!e.hidestreetnumber)},enumerable:!1,configurable:!0}),__decorate([core_1.Component({selector:"field-google-places-search",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig" [title]="value" [fieldid]="fieldid">{{value}}</field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control" [ngClass]="css_classes"><system-googleplaces-search #focus [(ngModel)]="value" (details)="setDetails($event)"></system-googleplaces-search><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,services_1.configurationService,router_1.Router])],fieldGooglePlacesSearch)}(fieldGeneric);exports.fieldGooglePlacesSearch=fieldGooglePlacesSearch;var fieldTextID=function(n){function fieldTextID(e,t,s,i,l,a){var d=n.call(this,e,t,s,i,a)||this;return d.model=e,d.view=t,d.language=s,d.metadata=i,d.configurationService=l,d.router=a,d}return __extends(fieldTextID,n),Object.defineProperty(fieldTextID.prototype,"textName",{get:function(){var e=this.configurationService.getData("systextids"),e=e?e[this.value]:void 0;return e&&e.label?this.language.getLabel(e.label):this.value},enumerable:!1,configurable:!0}),__decorate([core_1.Component({selector:"field-textid",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display [editable]="false" [fielddisplayclass]="fielddisplayclass" [fieldconfig]="fieldconfig" [title]="value" [fieldid]="fieldid">{{textName}}</field-generic-display>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,services_1.configurationService,router_1.Router])],fieldTextID)}(fieldGeneric);exports.fieldTextID=fieldTextID;var fieldBackendMethod=function(d){function fieldBackendMethod(e,t,s,i,l){var a=d.call(this,e,t,s,i,l)||this;return a.model=e,a.view=t,a.language=s,a.metadata=i,a.router=l,a.classexists=!1,a.publicMethods=[],a}return __extends(fieldBackendMethod,d),Object.defineProperty(fieldBackendMethod.prototype,"className",{get:function(){return this.value?this.value.split("->")[0]:""},set:function(e){this.value=e,this.validateNamespace()},enumerable:!1,configurable:!0}),Object.defineProperty(fieldBackendMethod.prototype,"methodName",{get:function(){if(this.value&&2==this.value.split("->").length)return this.value.split("->")[1];return""},set:function(e){var t=this.value.split("->");this.value=t[0]+"->"+e},enumerable:!1,configurable:!0}),fieldBackendMethod.prototype.validateNamespace=function(){var t=this;this.model.backend.getRequest("system/checkclass/"+btoa(this.className)).subscribe(function(e){t.classexists=e.classexists,t.publicMethods=e.methods})},__decorate([core_1.Component({selector:"field-backend-method",template:'<field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig" [title]="value" [fieldid]="fieldid">{{className}}->{{methodName}}</field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control" [ngClass]="css_classes"><system-input-backend-method [(ngModel)]="value"></system-input-backend-method><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],fieldBackendMethod)}(fieldGeneric);exports.fieldBackendMethod=fieldBackendMethod;var fieldSystemLabel=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),__decorate([core_1.Component({selector:"field-system-label",template:'<field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig" [title]="value" [fieldid]="fieldid">{{value}}</field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control" [ngClass]="css_classes"><system-input-label [(ngModel)]="value"></system-input-label><field-messages [fieldname]="fieldname"></field-messages></div>'})],t)}(fieldGeneric);exports.fieldSystemLabel=fieldSystemLabel;var fieldTimeDifference=function(d){function fieldTimeDifference(e,t,s,i,l){var a=d.call(this,e,t,s,i,l)||this;return a.model=e,a.view=t,a.language=s,a.metadata=i,a.router=l,a}return __extends(fieldTimeDifference,d),Object.defineProperty(fieldTimeDifference.prototype,"timedifferenceunit",{get:function(){return this._timedifferenceunit||(this.value?this.value.split(" ")[1]:"h")},set:function(e){this._timedifferenceunit=e,this.updateModel()},enumerable:!1,configurable:!0}),Object.defineProperty(fieldTimeDifference.prototype,"timedifferencespan",{get:function(){return this._timedifferencespan||(this.value?this.value.split(" ")[0]:"")},set:function(e){this._timedifferencespan=e,this.updateModel()},enumerable:!1,configurable:!0}),fieldTimeDifference.prototype.updateModel=function(){0<this._timedifferencespan&&this.timedifferenceunit?this.value=this.timedifferencespan+" "+this._timedifferenceunit:this.value=""},__decorate([core_1.Component({selector:"field-time-difference",template:'<field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig" [title]="value" [fieldid]="fieldid">{{value}}</field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control" [ngClass]="css_classes"><div class="slds-grid slds-grid--vertical-align-center slds-gutters_direct-xx-small"><input #focus type="number" class="slds-col slds-size--1-of-2 slds-input slds-text-align--right" [(ngModel)]="timedifferencespan" [maxlength]="fieldlength" [ngModelOptions]="modelOptions"><div class="slds-col slds-size--1-of-2 slds-select_container slds-m-vertical--xx-small"><select [disabled]="!timedifferencespan" class="slds-select" [(ngModel)]="timedifferenceunit"><option value="i"><system-label label="LBL_MINUTES"></system-label></option><option value="h"><system-label label="LBL_HOURS"></system-label></option><option value="d"><system-label label="LBL_DAYS"></system-label></option><option value="w"><system-label label="LBL_WEEKS"></system-label></option><option value="M"><system-label label="LBL_MONTHS"></system-label></option><option value="y"><system-label label="LBL_YEARS"></system-label></option></select></div></div><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],fieldTimeDifference)}(fieldGeneric);exports.fieldTimeDifference=fieldTimeDifference;var fieldIconPopover=function(r){function fieldIconPopover(e,t,s,i,l,a,d,n){var o=r.call(this,e,t,l,a,d)||this;return o.model=e,o.view=t,o.popup=s,o.broadcast=i,o.language=l,o.metadata=a,o.router=d,o.elementRef=n,o.parentTypeSelectOpen=!1,o.parentSearchOpen=!1,o.parentSearchTerm="",o.recentItems=[],o.popup.closePopup$.subscribe(function(){return o.closePopups()}),o.broadcast.message$.subscribe(function(e){return o.handleMessage(e)}),o}return __extends(fieldIconPopover,r),Object.defineProperty(fieldIconPopover.prototype,"parentField",{get:function(){return this.model.getField("grpaccount_id")},enumerable:!1,configurable:!0}),Object.defineProperty(fieldIconPopover.prototype,"parentIdField",{get:function(){return this.fieldconfig.parentIdField||"parent_id"},enumerable:!1,configurable:!0}),Object.defineProperty(fieldIconPopover.prototype,"memberCount",{get:function(){return this.model.getField("grp_member_count")},enumerable:!1,configurable:!0}),Object.defineProperty(fieldIconPopover.prototype,"parentTypes",{get:function(){var e=["Contacts","Accounts","Leads"];return e=this.fieldconfig.parenttypes?this.fieldconfig.parenttypes.replace(/\s/g,"").split(","):e},enumerable:!1,configurable:!0}),fieldIconPopover.prototype.handleMessage=function(e){e.messagedata.reference&&"model.save"===e.messagetype&&this.fieldid===e.messagedata.reference&&(this.parentSearchTerm="",this.model.data[this.parentIdField]=e.messagedata.data.id,this.model.data[this.fieldname]=e.messagedata.data.summary_text)},fieldIconPopover.prototype.onClick=function(e){this.elementRef.nativeElement.contains(e.target)||this.closePopups()},fieldIconPopover.prototype.closePopups=function(){this.model.data[this.parentIdField]&&(this.parentSearchTerm=""),this.parentSearchOpen=!1,this.parentTypeSelectOpen=!1,this.clickListener()},__decorate([core_1.Component({selector:"field-icon-popover",template:'<field-generic-display [fielddisplayclass]="fielddisplayclass" [editable]="false" [fieldconfig]="fieldconfig"><div system-model-popover><system-utility-icon size="x-small" icon="info"></system-utility-icon></div></field-generic-display>',providers:[services_1.popup],host:{}}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.popup,services_1.broadcast,services_1.language,services_1.metadata,router_1.Router,core_1.ElementRef])],fieldIconPopover)}(fieldGeneric);exports.fieldIconPopover=fieldIconPopover;var fieldStylesheetID=function(d){function fieldStylesheetID(e,t,s,i,l){var a=d.call(this,e,t,s,i,l)||this;return a.model=e,a.view=t,a.language=s,a.metadata=i,a.router=l,a.stylesheets=[],a.stylesheets=a.metadata.getHtmlStylesheetNames(),a}return __extends(fieldStylesheetID,d),fieldStylesheetID.prototype.getValue=function(){var t=this;if(this.value){var e=this.stylesheets.find(function(e){return e.id==t.value});if(e)return e.name}return this.value},__decorate([core_1.Component({selector:"field-stylesheetid",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig" [fieldid]="fieldid">{{getValue()}}</field-generic-display><div *ngIf="isEditMode()" class="slds-form-element"><div class="slds-form-element__control" [ngClass]="getFieldClass()"><div class="slds-select_container slds-m-vertical--xx-small"><select #focus class="slds-select" [(ngModel)]="value"><option></option><option *ngFor="let sheet of stylesheets" value="{{sheet.id}}">{{sheet.name}}</option></select></div><field-messages [fieldname]="fieldname"></field-messages></div></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],fieldStylesheetID)}(fieldGeneric);exports.fieldStylesheetID=fieldStylesheetID;var fieldUnitsOfMeasure=function(n){function fieldUnitsOfMeasure(e,t,s,i,l,a){var d=n.call(this,e,t,s,i,l)||this;return d.model=e,d.view=t,d.language=s,d.metadata=i,d.router=l,d.configuration=a,d.uoms=[],d.uoms=d.configuration.getData("uomunits"),d}return __extends(fieldUnitsOfMeasure,n),fieldUnitsOfMeasure.prototype.getUOMLabel=function(){var t=this;if(this.value){var e=this.uoms.find(function(e){return e.id==t.value});if(e)return this.language.getLabel(e.label)}return this.value},__decorate([core_1.Component({selector:"field-units-of-measure",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [fieldconfig]="fieldconfig" [editable]="isEditable()">{{getUOMLabel()}}</field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control" [ngClass]="getFieldClass()"><system-select-uom [(ngModel)]="value"></system-select-uom><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,services_1.configurationService])],fieldUnitsOfMeasure)}(fieldGeneric);exports.fieldUnitsOfMeasure=fieldUnitsOfMeasure;var fieldQuantity=function(o){function fieldQuantity(e,t,s,i,l,a,d){var n=o.call(this,e,t,s,i,l,a)||this;return n.model=e,n.view=t,n.language=s,n.metadata=i,n.router=l,n.userpreferences=a,n.configuration=d,n.uoms=[],n.uoms=n.configuration.getData("uomunits"),n}return __extends(fieldQuantity,o),Object.defineProperty(fieldQuantity.prototype,"uomidfield",{get:function(){return this.fieldconfig.uomid_field||(this.metadata.getModuleFields(this.model.module).uom_id?"uom_id":void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldQuantity.prototype,"uomid",{get:function(){return this.model.getField(this.uomidfield)},set:function(e){this.model.setField(this.uomidfield,e)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldQuantity.prototype,"uomLabel",{get:function(){var t=this;if(this.value){var e=this.uoms.find(function(e){return e.id==t.uomid});return e?this.language.getLabel(e.label):this.uomid}return""},enumerable:!1,configurable:!0}),__decorate([core_1.Component({template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [fieldconfig]="fieldconfig" [editable]="isEditable()"><div class="slds-text-align_right"><span>{{getValAsText()}} {{uomLabel}}</span></div></field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control" [ngClass]="getFieldClass()"><div class="slds-grid slds-grid--align-spread slds-grid--vertical-align-center"><div class="slds-form-element slds-size--2-of-3"><input #floatinput class="slds-input slds-text-align--right" type="text" [(ngModel)]="textvalue" (change)="changed()"></div><system-select-uom class="slds-size--1-of-3 slds-p-left--x-small" [(ngModel)]="uomid"></system-select-uom></div><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,services_1.userpreferences,services_1.configurationService])],fieldQuantity)}(fieldFloat);exports.fieldQuantity=fieldQuantity;var fieldQuestionnaireEvaluation=function(n){function e(e,t,s,i,l,a){var d=n.call(this,e,t,s,i,l)||this;return d.model=e,d.view=t,d.language=s,d.metadata=i,d.router=l,d.backend=a,d.categories=[],d.isEvaluationAvailable=!1,d}return __extends(e,n),e.prototype.ngOnInit=function(){n.prototype.ngOnInit.call(this);var e=this.model.getRelatedRecords("questionnaireevaluation");if(e&&e[0]&&e[0].questionnaireevaluationitems&&e[0].questionnaireevaluationitems.beans){e[0].questionnaireevaluationitems.beans;for(var t in e[0].questionnaireevaluationitems.beans)this.categories.push(e[0].questionnaireevaluationitems.beans[t]);this.isEvaluationAvailable=!0}},__decorate([core_1.Component({selector:"field-questionnaire-evaluation",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display [fielddisplayclass]="fielddisplayclass" [editable]="false" [fieldconfig]="fieldconfig" [fieldid]="fieldid"><span *ngIf="isEvaluationAvailable"><span *ngFor="let category of categories; let last=last">{{category.name}}: {{category.value}}<span *ngIf="!last">â¢</span></span></span> <span *ngIf="!isEvaluationAvailable"><i><system-label label="LBL_NO_EVALUATION_AVAILABLE"></system-label></i></span></field-generic-display>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,services_1.backend])],e)}(fieldGeneric);exports.fieldQuestionnaireEvaluation=fieldQuestionnaireEvaluation;var fieldTags=function(d){function fieldTags(e,t,s,i,l){var a=d.call(this,e,t,s,i,l)||this;return a.model=e,a.view=t,a.language=s,a.metadata=i,a.router=l,a}return __extends(fieldTags,d),Object.defineProperty(fieldTags.prototype,"displayTags",{get:function(){var e,t=this.model.getField(this.fieldname);if(!t)return"";try{e=JSON.parse(t)}catch(e){return""}return e.join(", ")},enumerable:!1,configurable:!0}),Object.defineProperty(fieldTags.prototype,"objecttags",{get:function(){var e=this.model.getField("tags");if(!e||""===e)return[];try{return JSON.parse(e)}catch(e){return[]}},enumerable:!1,configurable:!0}),fieldTags.prototype.removeByIndex=function(e){var t=this.objecttags;t.splice(e,1),this.model.setField("tags",JSON.stringify(t))},fieldTags.prototype.addTag=function(e){var t;""!==e&&((t=this.objecttags).push(e),this.model.setField("tags",JSON.stringify(t)))},__decorate([core_1.Component({selector:"field-tags",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig">{{displayTags}}</field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control slds-p-around--xx-small" [ngClass]="css_classes"><div class="slds-grid slds-grid--vertical-align-end"><div class="slds-size--2-of-3"><ul *ngIf="objecttags.length" class="spice-taglist"><li *ngFor="let tag of objecttags;let i=index"><span class="slds-badge">{{tag}} <span class="slds-badge__icon slds-badge__icon_right" (click)="removeByIndex(i)"><system-utility-icon icon="close" size="xx-small"></system-utility-icon></span></span></li></ul><div *ngIf="!objecttags.length" style="font-style:italic"><system-label label="LBL_NO_TAGS_ASSIGNED"></system-label></div></div><div class="slds-size--1-of-3 slds-p-left--x-small"><system-input-tags (tagemitter)="addTag($event)"></system-input-tags></div></div><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],fieldTags)}(fieldGeneric);exports.fieldTags=fieldTags;var fieldParentDetails=function(d){function fieldParentDetails(e,t,s,i,l){var a=d.call(this,e,t,s,i,l)||this;return a.model=e,a.view=t,a.language=s,a.metadata=i,a.router=l,a.parentDefs={},a}return __extends(fieldParentDetails,d),fieldParentDetails.prototype.ngOnInit=function(){d.prototype.ngOnInit.call(this),this.getParentDefinition()},Object.defineProperty(fieldParentDetails.prototype,"module",{get:function(){return this.fieldconfig.module},enumerable:!1,configurable:!0}),Object.defineProperty(fieldParentDetails.prototype,"componentset",{get:function(){return this.fieldconfig.componentset},enumerable:!1,configurable:!0}),Object.defineProperty(fieldParentDetails.prototype,"display",{get:function(){return this.parentId&&this.module==this.parentModule},enumerable:!1,configurable:!0}),Object.defineProperty(fieldParentDetails.prototype,"parentModule",{get:function(){var e;return null!==(e=this.parentDefs)&&void 0!==e&&e.type_name?this.model.getField(this.parentDefs.type_name):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(fieldParentDetails.prototype,"parentId",{get:function(){var e;return null!==(e=this.parentDefs)&&void 0!==e&&e.id_name?this.model.getField(this.parentDefs.id_name):void 0},enumerable:!1,configurable:!0}),fieldParentDetails.prototype.getParentDefinition=function(){this.parentDefs=this.metadata.getFieldDefs(this.model.module,this.fieldname)},__decorate([core_1.Component({template:'<div *ngIf="display" class="slds-box--border"><div class="slds-p-around--xx-small slds-text-heading--label"><field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label></div><field-related-details-container *ngIf="parentId" [module]="module" [componentset]="componentset" [id]="parentId"></field-related-details-container></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],fieldParentDetails)}(fieldGeneric);exports.fieldParentDetails=fieldParentDetails;var fieldRelatedDetails=function(d){function fieldRelatedDetails(e,t,s,i,l){var a=d.call(this,e,t,s,i,l)||this;return a.model=e,a.view=t,a.language=s,a.metadata=i,a.router=l,a}return __extends(fieldRelatedDetails,d),Object.defineProperty(fieldRelatedDetails.prototype,"module",{get:function(){return this.fieldconfig.module},enumerable:!1,configurable:!0}),Object.defineProperty(fieldRelatedDetails.prototype,"componentset",{get:function(){return this.fieldconfig.componentset},enumerable:!1,configurable:!0}),__decorate([core_1.Component({template:'<div class="slds-box--border"><field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-related-details-container *ngIf="value" [module]="module" [componentset]="componentset" [id]="value"></field-related-details-container></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],fieldRelatedDetails)}(fieldGeneric);exports.fieldRelatedDetails=fieldRelatedDetails;var fieldRelatedDetailsContainer=function(){function e(e,t){this.model=e,this.view=t}return e.prototype.ngOnChanges=function(e){this.module==this.model.module&&this.id==this.model.id||(this.model.module=this.module,this.model.id=this.id,this.model.getData(!0))},__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"module",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"id",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"componentset",void 0),__decorate([core_1.Component({selector:"field-related-details-container",template:'<system-componentset [componentset]="componentset"></system-componentset>',providers:[services_1.model,services_1.view]}),__metadata("design:paramtypes",[services_1.model,services_1.view])],e)}();exports.fieldRelatedDetailsContainer=fieldRelatedDetailsContainer;var fieldPhone=function(o){function fieldPhone(e,t,s,i,l,a,d){var n=o.call(this,e,t,s,i,l)||this;return n.model=e,n.view=t,n.l=s,n.metadata=i,n.router=l,n.backend=a,n.telephony=d,n}return __extends(fieldPhone,o),Object.defineProperty(fieldPhone.prototype,"telehonyActive",{get:function(){return this.telephony.isActive},enumerable:!1,configurable:!0}),fieldPhone.prototype.initiateCall=function(e){e.stopPropagation(),this.telephony.initiateCall(this.value,{relatedid:this.model.id,relatedmodule:this.model.module,relateddata:this.model.data})},__decorate([core_1.Component({selector:"field-phone",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig" [title]="value" [fieldid]="fieldid"><div class="slds-grid slds-grid--vertical-align-center"><div *ngIf="telehonyActive && value" (click)="initiateCall($event)" class="slds-p-right--x-small slds-text-link--reset"><system-utility-icon icon="outbound_call" size="xx-small"></system-utility-icon></div><div class="slds-truncate"><a *ngIf="value && !telehonyActive" [href]="\'tel:\'+value">{{value}}</a><span *ngIf="value && telehonyActive">{{value}}</span></div></div></field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control slds-p-around--xx-small" [ngClass]="css_classes"><input #focus type="text" class="slds-input" [(ngModel)]="value" [maxlength]="fieldlength" [autocomplete]="fieldid" [ngModelOptions]="modelOptions"><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,services_1.backend,services_1.telephony])],fieldPhone)}(fieldGeneric);exports.fieldPhone=fieldPhone;var fieldActionset=function(d){function fieldActionset(e,t,s,i,l){var a=d.call(this,e,t,s,i,l)||this;return a.model=e,a.view=t,a.language=s,a.metadata=i,a.router=l,a}return __extends(fieldActionset,d),Object.defineProperty(fieldActionset.prototype,"displayValue",{get:function(){if(!this.value)return"";var e=this.metadata.getActionSet(this.value);return e?e.name:""},enumerable:!1,configurable:!0}),__decorate([core_1.Component({template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig" [fieldid]="fieldid">{{displayValue}}</field-generic-display><div *ngIf="isEditMode()" class="slds-form-element"><div class="slds-form-element__control slds-m-vertical--xx-small" [ngClass]="getFieldClass()"><system-input-actionset [(ngModel)]="value"></system-input-actionset><field-messages [fieldname]="fieldname"></field-messages></div></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],fieldActionset)}(fieldGeneric);exports.fieldActionset=fieldActionset;var fieldSlider=function(d){function fieldSlider(e,t,s,i,l){var a=d.call(this,e,t,s,i,l)||this;return a.model=e,a.view=t,a.language=s,a.metadata=i,a.router=l,a}return __extends(fieldSlider,d),Object.defineProperty(fieldSlider.prototype,"min",{get:function(){return this.fieldconfig.min?parseInt(this.fieldconfig.min,10):0},enumerable:!1,configurable:!0}),Object.defineProperty(fieldSlider.prototype,"max",{get:function(){return this.fieldconfig.max?parseInt(this.fieldconfig.max,10):100},enumerable:!1,configurable:!0}),Object.defineProperty(fieldSlider.prototype,"step",{get:function(){return this.fieldconfig.step?parseInt(this.fieldconfig.step,10):10},enumerable:!1,configurable:!0}),Object.defineProperty(fieldSlider.prototype,"value",{get:function(){var e=this.model.getField(this.fieldname);return e?"number"==typeof e?e:parseInt(e,10):0},set:function(e){this.model.setField(this.fieldname,e)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldSlider.prototype,"completion",{get:function(){return(this.value-this.min)/(this.max-this.min)*100},enumerable:!1,configurable:!0}),__decorate([core_1.Component({selector:"field-slider",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig"><div class="slds-grid slds-grid_vertical-align-center"><system-progress-bar class="slds-grow" [progress]="completion" [hideText]="true"></system-progress-bar><div class="slds-p-left--x-small">{{value}}</div></div></field-generic-display><div *ngIf="isEditable() && isEditMode()" class="slds-form-element__control slds-p-top--small" [ngClass]="getFieldClass()"><system-slider [min]="min" [max]="max" [step]="step" [(ngModel)]="value"></system-slider><field-messages [fieldname]="fieldname"></field-messages></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router])],fieldSlider)}(fieldGeneric);exports.fieldSlider=fieldSlider;var fieldImage=function(p){function fieldImage(e,t,s,i,l,a,d,n,o,r,c,u){var f=p.call(this,e,t,s,i,l)||this;return f.model=e,f.view=t,f.language=s,f.metadata=i,f.router=l,f.elementRef=a,f.renderer=d,f.backend=n,f.elRef=o,f.changeDetRef=r,f.modalservice=c,f.sanitizer=u,f.height="",f}return __extends(fieldImage,p),Object.defineProperty(fieldImage.prototype,"fieldIsEmpty",{get:function(){return!this.value},enumerable:!1,configurable:!0}),fieldImage.prototype.ngAfterViewInit=function(){this.fieldconfig.height&&(this.height="calc("+this.fieldconfig.height+" - 2px - 0.5rem )")},Object.defineProperty(fieldImage.prototype,"imageUrl",{get:function(){return this.sanitizer.bypassSecurityTrustResourceUrl("data:"+this.value)},enumerable:!1,configurable:!0}),Object.defineProperty(fieldImage.prototype,"style",{get:function(){return{height:this.height}},enumerable:!1,configurable:!0}),fieldImage.prototype.deleteImage=function(){this.value=""},fieldImage.prototype.editImage=function(s){var i=this;void 0===s&&(s=null),this.modalservice.openModal("SystemImageModal").subscribe(function(e){i.field_defs.maxWidth&&(e.instance.maxWidth=i.field_defs.maxWidth),i.field_defs.maxHeight&&(e.instance.maxHeight=i.field_defs.maxHeight);var t=(t=i.labelComponent.label)||i.language.getLabel("LBL_IMAGE");e.instance.title=t,i.value&&(e.instance.imageData=i.value),e.instance.answer.subscribe(function(e){!1!==e&&(i.value=e)}),s&&(e.instance.droppedFiles=s)})},__decorate([core_1.ViewChild(fieldLabel,{static:!(fieldImage.prototype.onDrop=function(e){this.view.setEditMode(),this.editImage(e)})}),__metadata("design:type",Object)],fieldImage.prototype,"labelComponent",void 0),__decorate([core_1.Component({selector:"field-image",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><div [ngClass]="fielddisplayclass" class="slds-is-relative slds-box--border slds-align_absolute-center" [ngStyle]="style" (system-drop-file)="onDrop($event)"><img *ngIf="!fieldIsEmpty" [src]="imageUrl" style="max-height:100%;padding:0.25rem"><ng-container *ngIf="!model.isLoading"><ng-container *ngIf="isEditMode()"><button *ngIf="fieldIsEmpty" class="slds-button slds-button_icon slds-button_icon-container slds-button_icon-border-filled slds-align--absolute-center slds-m-around--medium" [disabled]="!isEditMode()" (click)="editImage()"><system-button-icon [icon]="\'image\'"></system-button-icon></button><div *ngIf="!fieldIsEmpty" class="slds-is-absolute spice-button-group-vertical slds-is-absolute" style="bottom:0.5rem;right:0.5rem;"><button class="slds-button slds-button_icon-container slds-button_icon-border-filled slds-button--icon-small" (click)="editImage()"><system-button-icon [icon]="\'edit\'"></system-button-icon></button> <button class="slds-button slds-button_icon-container slds-button_icon-border-filled slds-button--icon-small" title="Delete" (click)="deleteImage()"><system-button-icon [icon]="\'delete\'"></system-button-icon></button></div></ng-container><ng-container *ngIf="!isEditMode()"><button class="slds-button slds-button_icon slds-is-absolute" style="bottom:0.75rem;right:0.75rem;background-color:#fff;box-shadow:0px 0px 2px 3px rgba(255,255,255,1)" (click)="setEditMode()"><system-button-icon [icon]="\'edit\'"></system-button-icon></button></ng-container></ng-container></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,router_1.Router,core_1.ElementRef,core_1.Renderer2,services_1.backend,core_1.ElementRef,core_1.ChangeDetectorRef,services_1.modal,platform_browser_1.DomSanitizer])],fieldImage)}(fieldGeneric);exports.fieldImage=fieldImage;var fieldCompound=function(e){function fieldCompound(){return null!==e&&e.apply(this,arguments)||this}return __extends(fieldCompound,e),fieldCompound.prototype.ngOnInit=function(){var t=this;e.prototype.ngOnInit.call(this),this.metadata.addComponent("ObjectRecordFieldset",this.compound).subscribe(function(e){e.instance.fieldset=t.fieldconfig.fieldset,e.instance.direction="horizontal",e.instance.fieldpadding="xxx-small"})},Object.defineProperty(fieldCompound.prototype,"label",{get:function(){if(this.fieldconfig.label){if(0<this.fieldconfig.label.indexOf(":")){var e=this.fieldconfig.label.split(":");return this.language.getLabel(e[1],e[0],this.view.labels)}return this.language.getLabel(this.fieldconfig.label,this.model.module,this.view.labels)}return this.language.getFieldDisplayName(this.model.module,this.fieldname,this.fieldconfig,this.view.labels)},enumerable:!1,configurable:!0}),__decorate([core_1.ViewChild("compound",{read:core_1.ViewContainerRef,static:!0}),__metadata("design:type",core_1.ViewContainerRef)],fieldCompound.prototype,"compound",void 0),__decorate([core_1.Component({selector:"field-compound",template:'<fieldset class="slds-form-element slds-form-element_compound slds-box slds-box_x-small slds-p-top_none"><legend *ngIf="displayLabel" class="slds-form-element__legend slds-form-element__label slds-p-left_xx-small" style="float:none">{{label}}</legend><div class="slds-form-element__control"><div #compound></div></div></fieldset>'})],fieldCompound)}(fieldGeneric);exports.fieldCompound=fieldCompound;var fieldIconCondition=function(o){function fieldIconCondition(e,t,s,i,l,a,d){var n=o.call(this,e,t,s,i,a)||this;return n.model=e,n.view=t,n.language=s,n.metadata=i,n.backend=l,n.router=a,n.cdRef=d,n.colorClass="slds-icon-text-default",n.fieldconfig={},n.subscriptions.add(n.subscribeToModelChanges()),n}return __extends(fieldIconCondition,o),fieldIconCondition.prototype.ngOnInit=function(){o.prototype.ngOnInit.call(this),this.setValues()},fieldIconCondition.prototype.subscribeToModelChanges=function(){var e=this;return this.model.data$.subscribe(function(){e.setValues()})},fieldIconCondition.prototype.setValues=function(){var e=this;window.clearTimeout(this.setterTimeout),this.setterTimeout=window.setTimeout(function(){e.fieldconfig.modulefilter?e.model.checkModuleFilterMatch(e.fieldconfig.modulefilter)?(e.icon=e.fieldconfig.matchIcon,e.label=e.fieldconfig.matchLabel,e.fieldconfig.matchColorTheme&&(e.colorClass="slds-icon-text-"+e.fieldconfig.matchColorTheme)):(e.icon=e.fieldconfig.mismatchIcon,e.label=e.fieldconfig.mismatchLabel,e.fieldconfig.mismatchColorTheme&&(e.colorClass="slds-icon-text-"+e.fieldconfig.mismatchColorTheme)):(e.icon=e.fieldconfig.icon,e.label=e.fieldconfig.label,e.fieldconfig.colorTheme&&(e.colorClass="slds-icon-text-"+e.fieldconfig.colorTheme)),e.cdRef.detectChanges()},1e3)},__decorate([core_1.Input(),__metadata("design:type",Object)],fieldIconCondition.prototype,"fieldconfig",void 0),__decorate([core_1.Component({selector:"field-icon-condition",template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display [fielddisplayclass]="fielddisplayclass" [fieldconfig]="fieldconfig"><system-utility-icon *ngIf="!!icon" [size]="fieldconfig.size" [icon]="icon" [title]="label" [colorclass]="colorClass"></system-utility-icon></field-generic-display>',changeDetection:core_1.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,services_1.backend,router_1.Router,core_1.ChangeDetectorRef])],fieldIconCondition)}(fieldGeneric);exports.fieldIconCondition=fieldIconCondition;var ObjectFields=function(){function ObjectFields(){}return __decorate([core_1.NgModule({imports:[common_1.CommonModule,forms_1.FormsModule,systemcomponents_1.SystemComponents,directives_1.DirectivesModule,drag_drop_1.DragDropModule],declarations:[fieldSet,field,fieldBlank,fieldNotAuthorized,fieldLabel,fieldLabelPopover,fieldContainer,fieldGeneric,fieldGenericDisplay,fieldText,fieldNumber,fieldHtml,fieldHtmlEditor,fieldWYSIWYGEditor,fieldFloat,fieldCurrency,fieldWeightedAmount,fieldTotalAmount,fieldCurrencies,fieldCompanies,fieldEnum,fieldLanguage,fieldEmailTo,fieldEmailTemplates,fieldTextMessageTemplates,fieldMailRelais,fieldMultienum,fieldGroupedEnum,fieldMultienumCheckBox,fieldMultipleEnumDropdown,fieldEnumAlternate,fieldEnumRadio,fieldBool,fieldBoolLabelAligned,fieldDate,fieldTime,fieldDateTime,fieldDateTimeDuration,fieldDuration,fieldDateSpan,fieldDateTimeSpan,fieldParent,fieldModuleFilter,fieldRelate,fieldRelateList,fieldModifiedBy,fieldLookup,fieldLookupRecent,fieldLookupRecentItem,fieldLookupSearch,fieldLookupSearchItem,fieldLookupSearchAdd,fieldAddress,fieldModelFooterPopover,fieldFullName,fieldTitle,fieldFile,fieldUrl,fieldEmail,fieldEmailAddresses,fieldEmailRecipients,fieldEmailRecipientsShort,fieldEmailEmailAddress,fieldEmailEmailAddressStatus,fieldVat,fieldBarcode,fieldBarcodeRenderer,fieldRating,FieldMessagesComponent,FieldModuleLookupComponent,FieldSignatureComponent,fieldServiceCategories,fieldServiceCategoryTree,fieldServiceCategorySearch,fieldWorklog,FieldModelInfoComponent,FieldEnumModulesComponent,FieldModelInfoComponent,fieldGDPR,fieldSelectTree,fieldSelectTreeSearch,fieldSelectTreeTree,fieldColorEnum,fieldBase64,fieldModuleIcon,fieldRichText,fieldEnumMulti,fieldPhoneAsterisk,fieldCronInterval,fieldGooglePlacesSearch,fieldTextID,fieldBackendMethod,fieldSystemLabel,fieldTimeDifference,fieldIconPopover,fieldStylesheetID,fieldUnitsOfMeasure,fieldQuantity,fieldQuestionnaireEvaluation,fieldTags,fieldParentDetails,fieldRelatedDetails,fieldRelatedDetailsContainer,fieldPhone,fieldActionset,fieldImage,fieldActionset,fieldSlider,fieldCompound,fieldIconCondition],exports:[fieldSet,field,fieldLabel,fieldContainer,fieldGeneric,fieldGenericDisplay,fieldHtml,FieldMessagesComponent,FieldModuleLookupComponent,fieldNotAuthorized,fieldLookup,fieldLookupRecent,fieldLookupSearch,fieldLookupSearchAdd,fieldTags]})],ObjectFields)}();exports.ObjectFields=ObjectFields;