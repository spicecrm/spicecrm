/*!
 * 
 *                     aacService
 *
 *                     release: 2022.02.001
 *
 *                     date: 2022-09-03 11:05:02
 *
 *                     build: 2022.02.001.1662195902704
 *
 */
"use strict";(self.webpackChunkcore=self.webpackChunkcore||[]).push([["default-src_modules_activities_moduleactivities_ts"],{9087:(t,e,i)=>{i.d(e,{d:()=>a});var s=i(1571),n=i(4154);const l=["container"];let a=(()=>{class ActivityTimelineItemContainer{constructor(t){this.metadata=t,this.activity={}}ngOnInit(){let t=this.metadata.getComponentConfig("ActivityTimelineItemContainer",this.activity.module);if(t.componentset){let e=this.metadata.getComponentSetObjects(t.componentset);for(let t of e)this.metadata.addComponent(t.component,this.container).subscribe((e=>{e.instance.activity=this.activity,e.instance.module=this.module,e.instance.componentconfig=t.componentconfig}))}}}return ActivityTimelineItemContainer.ɵfac=function(t){return new(t||ActivityTimelineItemContainer)(s.Y36(n.Pu))},ActivityTimelineItemContainer.ɵcmp=s.Xpm({type:ActivityTimelineItemContainer,selectors:[["activitytimeline-item-container"]],viewQuery:function(t,e){if(1&t&&s.Gf(l,7,s.s_b),2&t){let t;s.iGM(t=s.CRH())&&(e.container=t.first)}},inputs:{activity:"activity",module:"module"},decls:2,vars:0,consts:[["container",""]],template:function(t,e){1&t&&s.GkF(0,null,0)},encapsulation:2}),ActivityTimelineItemContainer})()},243:(t,e,i)=>{i.d(e,{g:()=>o});var s=i(1571),n=i(2656),l=i(4561),a=i(2803);let o=(()=>{class ActivityTimelineStencil{}return ActivityTimelineStencil.ɵfac=function(t){return new(t||ActivityTimelineStencil)},ActivityTimelineStencil.ɵcmp=s.Xpm({type:ActivityTimelineStencil,selectors:[["activitytimeline-stencil"]],decls:18,vars:0,consts:[[1,"slds-timeline__item_expandable","slds-timeline__item_email"],[1,"slds-media"],[1,"slds-media__figure"],[1,"slds-button","slds-button_icon"],["icon","switch","addclasses","slds-timeline__details-action-icon"],["icon","generic_loading","size","small","divClass","slds-icon_container slds-icon-standard-email slds-timeline__icon"],[1,"slds-media__body"],[1,"slds-grid","slds-grid_align-spread","slds-timeline__trigger"],[1,"slds-grid","slds-grid_vertical-align-center","slds-truncate_container_75","slds-no-space"],[1,"slds-truncate"],[1,"slds-timeline__actions","slds-timeline__actions_inline"],[1,"slds-timeline__date"],["disabled","",1,"slds-button","slds-button--icon-border-filled","slds-button--icon-x-small"],["icon","down"],[1,"slds-m-horizontal_xx-small"]],template:function(t,e){1&t&&(s.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),s._UZ(4,"system-button-icon",4),s.qZA(),s._UZ(5,"system-icon",5),s.qZA(),s.TgZ(6,"div",6)(7,"div",7)(8,"div",8)(9,"h3",9),s._UZ(10,"system-stencil"),s.qZA()(),s.TgZ(11,"div",10)(12,"p",11),s._UZ(13,"system-stencil"),s.qZA(),s.TgZ(14,"button",12),s._UZ(15,"system-button-icon",13),s.qZA()()(),s.TgZ(16,"p",14),s._UZ(17,"system-stencil"),s.qZA()()()())},dependencies:[n.J,l.f,a.B],encapsulation:2}),ActivityTimelineStencil})()},5743:(t,e,i)=>{i.r(e),i.d(e,{ModuleActivities:()=>_s});var s=i(6895),n=i(433),l=i(3121),a=i(3283),o=i(4518),d=i(5478),c=i(4357),r=i(1571),m=i(3369),u=i(2032),p=i(5710),g=i(2644),h=i(9016),f=i(5329),v=i(4664),y=i(1058),b=i(2294),x=i(4154),A=i(6163),Z=i(3634);function T(t,e){1&t&&(r.TgZ(0,"span"),r._uU(1," • "),r.qZA())}function k(t,e){if(1&t&&(r.ynx(0),r._UZ(1,"field-container",10),r.YNc(2,T,2,0,"span",11),r.BQk()),2&t){const t=r.oxw(),e=t.$implicit,i=t.index,s=r.oxw();r.xp6(1),r.Q6J("field",e.field)("fieldconfig",e.fieldconfig)("fielddisplayclass","slds-truncate"),r.xp6(1),r.Q6J("ngIf",i<s.fielsetFields.length-1)}}function C(t,e){if(1&t&&(r.ynx(0),r.YNc(1,k,3,4,"ng-container",11),r.BQk()),2&t){const t=e.$implicit,i=r.oxw();r.xp6(1),r.Q6J("ngIf",i.model.data[t.field])}}const w=function(){return{highlightpast:!0}};let M=(()=>{class TasksManagerTask{constructor(t,e,i,s,n){this.language=t,this.metadata=e,this.model=i,this.modelutilities=s,this.view=n,this.task={},this.focus="",this.taskselected=new r.vpe,this.fielsetFields=[];let l=this.metadata.getComponentConfig("TasksManagerTask","Tasks");l.fieldset&&(this.fielsetFields=this.metadata.getFieldSetItems(l.fieldset)),this.view.displayLabels=!1}ngOnInit(){this.model.module="Tasks",this.model.id=this.task.id,this.model.setData(this.task)}get isCompleted(){return"Completed"==this.model.getField("status")}get canEdit(){return this.model.checkAccess("edit")}get nameStyle(){let t={};return this.isCompleted&&(t["text-decoration"]="line-through"),t}get focusClass(){return this.model.id==this.focus?"slds-theme--shade slds-border--right":""}completeTask(){this.model.setField("status","Completed"),this.model.save()}selectTask(){this.taskselected.emit(this.model.id)}}return TasksManagerTask.ɵfac=function(t){return new(t||TasksManagerTask)(r.Y36(f.d),r.Y36(x.Pu),r.Y36(p.o),r.Y36(A.A),r.Y36(b.e))},TasksManagerTask.ɵcmp=r.Xpm({type:TasksManagerTask,selectors:[["tasks-manager-task"]],inputs:{task:"task",focus:"focus"},outputs:{taskselected:"taskselected"},features:[r._Bn([p.o,b.e])],decls:15,vars:12,consts:[[1,"slds-p-horizontal--medium","slds-p-vertical--medium","slds-border--bottom",3,"ngClass"],[1,"slds-grid","slds-grid--align-spread",2,"cursor","pointer",3,"click"],[1,"slds-grid"],[1,"slds-form-element"],[1,"slds-checkbox"],["type","checkbox",3,"disabled","checked","id","click"],[1,"slds-checkbox__label"],[1,"slds-checkbox_faux"],[1,"slds-text-title_caps",3,"ngStyle"],[4,"ngFor","ngForOf"],[3,"field","fieldconfig","fielddisplayclass"],[4,"ngIf"]],template:function(t,e){1&t&&(r.TgZ(0,"div",0)(1,"div",1),r.NdJ("click",(function(){return e.selectTask()})),r.TgZ(2,"div",2)(3,"div",3)(4,"span",4)(5,"input",5),r.NdJ("click",(function(){return e.completeTask()})),r.qZA(),r.TgZ(6,"label",6),r._UZ(7,"span",7),r.qZA()()(),r.TgZ(8,"div")(9,"div",8),r._uU(10),r.qZA(),r.TgZ(11,"div",2),r.YNc(12,C,2,1,"ng-container",9),r.qZA()()(),r.TgZ(13,"div"),r._UZ(14,"field-container",10),r.qZA()()()),2&t&&(r.Q6J("ngClass",e.focusClass),r.xp6(5),r.Q6J("disabled",e.isCompleted||!e.canEdit)("checked",e.isCompleted)("id",e.model.id),r.xp6(1),r.uIk("for",e.model.id),r.xp6(3),r.Q6J("ngStyle",e.nameStyle),r.xp6(1),r.Oqu(e.model.data.name),r.xp6(2),r.Q6J("ngForOf",e.fielsetFields),r.xp6(2),r.Q6J("field","date_due")("fieldconfig",r.DdM(11,w))("fielddisplayclass","slds-truncate"))},dependencies:[s.mk,s.sg,s.O5,s.PC,Z.j],encapsulation:2}),TasksManagerTask})();const J=function(t){return{"slds-theme_shade":t}};function Y(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"tasks-manager-task",3),r.NdJ("taskselected",(function(e){r.CHM(t);const i=r.oxw();return r.KtG(i.selectTask(e))})),r.qZA()}if(2&t){const t=e.$implicit,i=r.oxw();r.Q6J("task",t)("focus",i.focus)("ngClass",r.VKq(3,J,i.focus==t.id))}}function L(t,e){1&t&&(r.TgZ(0,"div",4),r._UZ(1,"system-spinner"),r.qZA())}let F=(()=>{class TasksManagerTasks{constructor(t,e){this.language=t,this.modellist=e,this.taskselected=new r.vpe,this.focus=""}selectTask(t){this.focus=t,this.taskselected.emit(t)}handleScroll(){this.modellist.loadMoreList()}}return TasksManagerTasks.ɵfac=function(t){return new(t||TasksManagerTasks)(r.Y36(f.d),r.Y36(g.t))},TasksManagerTasks.ɵcmp=r.Xpm({type:TasksManagerTasks,selectors:[["tasks-manager-tasks"]],outputs:{taskselected:"taskselected"},decls:3,vars:2,consts:[[3,"system-to-bottom"],[3,"task","focus","ngClass","taskselected",4,"ngFor","ngForOf"],["class","slds-p-around--medium slds-align--absolute-center",4,"ngIf"],[3,"task","focus","ngClass","taskselected"],[1,"slds-p-around--medium","slds-align--absolute-center"]],template:function(t,e){1&t&&(r.TgZ(0,"div",0),r.NdJ("system-to-bottom",(function(){return e.handleScroll()})),r.YNc(1,Y,1,5,"tasks-manager-task",1),r.YNc(2,L,2,0,"div",2),r.qZA()),2&t&&(r.xp6(1),r.Q6J("ngForOf",e.modellist.listData.list),r.xp6(1),r.Q6J("ngIf",e.modellist.isLoading))},dependencies:[s.mk,s.sg,s.O5,v.W,y.H,M],encapsulation:2}),TasksManagerTasks})();var S=i(3463);const N=["detailscontent"];function E(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"div",5)(1,"div",6)(2,"span",7)(3,"input",8),r.NdJ("click",(function(){r.CHM(t);const e=r.oxw();return r.KtG(e.completeTask())})),r.qZA(),r.TgZ(4,"label",9),r._UZ(5,"span",10),r.qZA()()(),r.TgZ(6,"div",11),r._UZ(7,"field-container",12),r.qZA()()}if(2&t){const t=r.oxw();r.xp6(3),r.Q6J("disabled",t.isCompleted||!t.canEdit)("checked",t.isCompleted),r.xp6(4),r.Q6J("field","name")("fielddisplayclass","slds-text-heading--small")}}function q(t,e){1&t&&(r.TgZ(0,"div",13),r._UZ(1,"system-label",14),r.qZA())}const I=function(t){return{"slds-theme--default":t}};let O=(()=>{class TasksManagerTaskDetails{constructor(t,e,i,s,n,l){this.view=t,this.language=e,this.elementRef=i,this.metadata=s,this.model=n,this.broadcast=l,this.focusid="",this.viewComponent=null,this.modelSubscription=null,this.model.module="Tasks",this.modelSubscription=this.broadcast.message$.subscribe((t=>{this.handleMessage(t)})),this.view.displayLabels=!1}handleMessage(t){if(t.messagedata.module===this.model.module)switch(t.messagetype){case"model.delete":break;case"model.save":this.model.id===t.messagedata.id&&this.model.setData(t.messagedata.data,!1)}}ngOnChanges(){this.focusid?this.viewComponent||this.metadata.addComponent("ObjectRecordDetails",this.detailscontent).subscribe((t=>{this.viewComponent=t})):this.viewComponent&&(this.viewComponent.destroy(),this.viewComponent=null),this.focusid&&this.focusid!=this.model.id&&(this.model.id=this.focusid,this.model.getData())}ngOnDestroy(){this.modelSubscription.unsubscribe()}get nameStyle(){let t={};return this.isCompleted&&(t["text-decoration"]="line-through"),t}get isCompleted(){return"Completed"==this.model.getField("status")}get canEdit(){try{return this.model.checkAccess("edit")}catch(t){return!1}}completeTask(){this.model.setField("status","Completed"),this.model.save()}}return TasksManagerTaskDetails.ɵfac=function(t){return new(t||TasksManagerTaskDetails)(r.Y36(b.e),r.Y36(f.d),r.Y36(r.SBq),r.Y36(x.Pu),r.Y36(p.o),r.Y36(m.f))},TasksManagerTaskDetails.ɵcmp=r.Xpm({type:TasksManagerTaskDetails,selectors:[["tasks-manager-task-details"]],viewQuery:function(t,e){if(1&t&&r.Gf(N,7,r.s_b),2&t){let t;r.iGM(t=r.CRH())&&(e.detailscontent=t.first)}},hostAttrs:[1,"slds-theme--shade"],inputs:{focusid:"focusid"},features:[r._Bn([p.o,b.e]),r.TTD],decls:6,vars:5,consts:[[1,"slds-scrollable--y"],["class","slds-m-around--x-small slds-p-around--x-small slds-grid slds-grid_vertical-align-center",4,"ngIf"],[1,"slds-m-around--x-small","slds-p-around--x-small",3,"ngClass"],["detailscontent",""],["class","slds-align--absolute-center","style","height:100%",4,"ngIf"],[1,"slds-m-around--x-small","slds-p-around--x-small","slds-grid","slds-grid_vertical-align-center"],[1,"slds-form-element__control"],[1,"slds-checkbox"],["type","checkbox","id","closetask",3,"disabled","checked","click"],["for","closetask",1,"slds-checkbox__label"],[1,"slds-checkbox_faux"],[1,"slds-text-heading--small","slds-p-left--small"],[3,"field","fielddisplayclass"],[1,"slds-align--absolute-center",2,"height","100%"],["label","LBL_MAKE_SELECTION"]],template:function(t,e){1&t&&(r.TgZ(0,"div",0),r.YNc(1,E,8,4,"div",1),r.TgZ(2,"div",2),r._UZ(3,"div",null,3),r.qZA(),r.YNc(5,q,2,0,"div",4),r.qZA()),2&t&&(r.xp6(1),r.Q6J("ngIf",e.focusid),r.xp6(1),r.Q6J("ngClass",r.VKq(3,I,e.focusid)),r.xp6(3),r.Q6J("ngIf",!e.focusid))},dependencies:[s.mk,s.O5,Z.j,S._],encapsulation:2}),TasksManagerTaskDetails})();function Q(t,e){if(1&t){const t=r.EpF();r.ynx(0),r.TgZ(1,"tasks-manager-tasks",3),r.NdJ("taskselected",(function(e){r.CHM(t);const i=r.oxw();return r.KtG(i.taskSelected(e))})),r.qZA(),r._UZ(2,"tasks-manager-task-details",4),r.BQk()}if(2&t){const t=r.oxw();r.xp6(2),r.Q6J("focusid",t.focus)}}function U(t,e){1&t&&(r.TgZ(0,"div",5),r._UZ(1,"system-illustration-no-task"),r.qZA())}let D=(()=>{class TasksManagerView{constructor(t,e,i,s,n){this.broadcast=t,this.navigation=e,this.elementRef=i,this.model=s,this.modellist=n,this.modellistsubscribe={},this.focus=null,this.modellistsubscribe=this.modellist.listType$.subscribe((t=>this.handleListTypeChange(t))),this.loadList()}ngOnDestroy(){this.modellistsubscribe.unsubscribe()}handleListTypeChange(t){"TasksManagerView"==t.listcomponent&&this.loadList()}loadList(){this.focus=null,this.modellist.setSortField("date_due","ASC"),this.modellist.getListData()}taskSelected(t){this.focus=t}}return TasksManagerView.ɵfac=function(t){return new(t||TasksManagerView)(r.Y36(m.f),r.Y36(u.G),r.Y36(r.SBq),r.Y36(p.o),r.Y36(g.t))},TasksManagerView.ɵcmp=r.Xpm({type:TasksManagerView,selectors:[["ng-component"]],decls:4,vars:2,consts:[[1,"slds-grid","slds-height_full"],[4,"ngIf","ngIfElse"],["noitems",""],[1,"slds-size--1-of-2",3,"taskselected"],[1,"slds-size--1-of-2",3,"focusid"],[1,"slds-height_full","slds-align--absolute-center"]],template:function(t,e){if(1&t&&(r.TgZ(0,"div",0),r.YNc(1,Q,3,1,"ng-container",1),r.YNc(2,U,2,0,"ng-template",null,2,r.W1O),r.qZA()),2&t){const t=r.MAs(3);r.xp6(1),r.Q6J("ngIf",e.modellist.isLoading||e.modellist.listData.totalcount>0)("ngIfElse",t)}},dependencies:[s.O5,h.H,F,O],encapsulation:2}),TasksManagerView})();var B=i(3441);let P=(()=>{class TasksAssitantTileClose{constructor(t,e,i,s){this.model=t,this.language=e,this.helper=i,this.broadcast=s}doAction(){this.helper.confirm(this.language.getLabel("LBL_COMPLETE_TASK"),this.language.getLabel("MSG_COMPLETE_TASK")).subscribe((t=>{t&&(this.model.setField("status","Completed"),this.model.save(),this.broadcast.broadcastMessage("assistant.complete",{id:this.model.id,module:"Assistant",data:this.model.data}))}))}}return TasksAssitantTileClose.ɵfac=function(t){return new(t||TasksAssitantTileClose)(r.Y36(p.o),r.Y36(f.d),r.Y36(B._),r.Y36(m.f))},TasksAssitantTileClose.ɵcmp=r.Xpm({type:TasksAssitantTileClose,selectors:[["tasks-assistant-tile-close"]],decls:4,vars:0,consts:[["role","presentation",1,"slds-dropdown__item",3,"click"],["href","javascript:void(0);","role","menuitem"],[1,"slds-truncate"],["label","LBL_CLOSE"]],template:function(t,e){1&t&&(r.TgZ(0,"li",0),r.NdJ("click",(function(){return e.doAction()})),r.TgZ(1,"a",1)(2,"span",2),r._UZ(3,"system-label",3),r.qZA()()())},dependencies:[S._],encapsulation:2}),TasksAssitantTileClose})(),z=(()=>{class ActivityTimelineSaveButton{constructor(t,e,i,s){this.language=t,this.metadata=e,this.model=i,this.view=s,this.actionconfig={},this.actionemitter=new r.vpe,this.parent={},this.module="",this.saving=!1}get buttonLabel(){return this.actionconfig.label?this.actionconfig.label:"LBL_SAVE"}execute(){this.saving||this.model.validate()&&(this.saving=!0,this.model.save(!0).subscribe((t=>{this.actionemitter.emit("save"),this.model.endEdit()})))}}return ActivityTimelineSaveButton.ɵfac=function(t){return new(t||ActivityTimelineSaveButton)(r.Y36(f.d),r.Y36(x.Pu),r.Y36(p.o),r.Y36(b.e))},ActivityTimelineSaveButton.ɵcmp=r.Xpm({type:ActivityTimelineSaveButton,selectors:[["activity-timeline-save-button"]],outputs:{actionemitter:"actionemitter"},decls:2,vars:1,consts:[[3,"label"]],template:function(t,e){1&t&&(r.TgZ(0,"span"),r._UZ(1,"system-label",0),r.qZA()),2&t&&(r.xp6(1),r.Q6J("label",e.buttonLabel))},dependencies:[S._],encapsulation:2}),ActivityTimelineSaveButton})();var j=i(727),H=i(4044),R=i(2656);function G(t,e){1&t&&r._UZ(0,"system-button-icon",2)}function K(t,e){1&t&&(r.TgZ(0,"span"),r._UZ(1,"system-label",3),r.qZA())}let V=(()=>{class ActionActivityCloseButton{constructor(t,e,i,s,n){this.language=t,this.metadata=e,this.model=i,this.modal=s,this.viewContainerRef=n,this.hidden=!1,this.displayasicon=!1,this.disabled=!0,this.subscriptions=new j.w0}ngOnInit(){this.componentconfig=this.metadata.getComponentConfig("ActionActivityCloseButton",this.model.module),this.model.getField(this.componentconfig.statusField)==this.componentconfig.statusValues&&this.handleDisabled("display"),this.handleDisabled(this.model.isEditing?"edit":"display"),this.subscriptions.add(this.model.mode$.subscribe((t=>{this.handleDisabled(t)}))),this.subscriptions.add(this.model.data$.subscribe((t=>{this.handleDisabled(this.model.isEditing?"edit":"display")})))}ngOnDestroy(){this.subscriptions.unsubscribe()}execute(){let t=this.componentconfig.componentset,e=this.componentconfig.actionset;this.modal.openModal("ActivityCloseModal",!0,this.viewContainerRef.injector).subscribe((i=>{i&&(t&&""!=t&&(i.instance.componentSet=t),e&&""!=e&&(i.instance.actionSet=e),this.model.startEdit())}))}handleDisabled(t){this.model.checkAccess("edit")?this.disabled="edit"==t:this.disabled=!0}}return ActionActivityCloseButton.ɵfac=function(t){return new(t||ActionActivityCloseButton)(r.Y36(f.d),r.Y36(x.Pu),r.Y36(p.o),r.Y36(H.o),r.Y36(r.s_b))},ActionActivityCloseButton.ɵcmp=r.Xpm({type:ActionActivityCloseButton,selectors:[["action-activity-close-button"]],decls:2,vars:2,consts:[["icon","close",4,"ngIf"],[4,"ngIf"],["icon","close"],["label","LBL_CLOSE"]],template:function(t,e){1&t&&(r.YNc(0,G,1,0,"system-button-icon",0),r.YNc(1,K,2,0,"span",1)),2&t&&(r.Q6J("ngIf",e.displayasicon),r.xp6(1),r.Q6J("ngIf",!e.displayasicon))},dependencies:[s.O5,R.J,S._],encapsulation:2}),ActionActivityCloseButton})();var $=i(8032);let X=(()=>{class ActionActivityCloseCreateButton{constructor(t,e,i,s,n,l){this.language=t,this.metadata=e,this.model=i,this.modal=s,this.injector=n,this.modalwindow=l,this.saving=!1,this.canCreate=!1}ngOnInit(){let t=this.metadata.getComponentConfig("ActivityCloseCreateModal",this.model.module).newBeanModules;if(t){let e=t.split(",");for(let t of e)if(this.metadata.checkModuleAcl(t,"create")){this.canCreate=!0;break}}}get disabled(){return!this.model.checkAccess("edit")}execute(){this.saving||(this.actionconfig.statusfield&&this.actionconfig.statusvalue&&this.model.getField(this.actionconfig.statusfield)!=this.actionconfig.statusvalue&&(this.model.isEditing||this.model.startEdit(),this.model.setField(this.actionconfig.statusfield,this.actionconfig.statusvalue)),this.model.validate()?(this.saving=!0,this.modal.openModal("SystemLoadingModal").subscribe((t=>{t.instance.messagelabel="LBL_SAVING_DATA",this.model.save().subscribe((e=>{this.saving=!1,t.instance.self.destroy(),this.modalwindow&&this.modalwindow.self.destroy(),this.modal.openModal("ActivityCloseCreateModal",!0,this.injector).subscribe((t=>{t&&(t.instance.parent=this.model)}))}))}))):this.modalwindow||this.model.edit(!1))}get actionlabel(){return this.model.getField(this.actionconfig.statusfield)!=this.actionconfig.statusvalue&&this.model.getField(this.actionconfig.statusfield)!=this.actionconfig.statusvalue?"LBL_CLOSE_AND_NEW":this.model.isEditing?"LBL_SAVE_AND_NEW":"LBL_NEW"}}return ActionActivityCloseCreateButton.ɵfac=function(t){return new(t||ActionActivityCloseCreateButton)(r.Y36(f.d),r.Y36(x.Pu),r.Y36(p.o),r.Y36(H.o),r.Y36(r.zs3),r.Y36($.S,8))},ActionActivityCloseCreateButton.ɵcmp=r.Xpm({type:ActionActivityCloseCreateButton,selectors:[["action-activity-close-create-button"]],decls:2,vars:1,consts:[[3,"label"]],template:function(t,e){1&t&&(r.TgZ(0,"span"),r._UZ(1,"system-label",0),r.qZA()),2&t&&(r.xp6(1),r.Q6J("label",e.actionlabel))},dependencies:[S._],encapsulation:2}),ActionActivityCloseCreateButton})();var W=i(7579),tt=i(9751),et=i(7774),it=i(3278),st=i(8861),nt=i(4663),lt=i(9621),at=i(3499),ot=i(5767),dt=i(1916);const ct=["modalContent"];let rt=(()=>{class ActivityCloseModal{constructor(t,e,i,s,n,l,a){this.router=t,this.language=e,this.model=i,this.view=s,this.metadata=n,this.modal=l,this.toast=a,this.componentconfig={},this.actionSetItems=[],this.newValueFields=[],this.actionSubject=new W.x,this.action$=new tt.y,this.preventGoingToRecord=!1,this.self={},this.view.isEditable=!0,this.view.setEditMode(),this.action$=this.actionSubject.asObservable()}ngOnInit(){this.componentconfig=this.metadata.getComponentConfig(this.constructor.name,this.model.module),this.actionSetItems=this.metadata.getActionSetItems(this.componentconfig.actionset),this.newValueFields=this.componentconfig.newValueFields,this.setNewValues()}emitaction(t){t&&this.toast.sendToast(this.language.getLabel("LBL_DATA_SAVED")+".","success"),this.self.destroy()}closeModal(){this.model.cancelEdit(),this.actionSubject.next(!1),this.actionSubject.complete(),this.self.destroy()}setNewValues(){this.newValueFields=JSON.parse(this.newValueFields);for(let t of this.newValueFields)this.model.setField(t.name,t.value)}}return ActivityCloseModal.ɵfac=function(t){return new(t||ActivityCloseModal)(r.Y36(et.F0),r.Y36(f.d),r.Y36(p.o),r.Y36(b.e),r.Y36(x.Pu),r.Y36(H.o),r.Y36(it.A))},ActivityCloseModal.ɵcmp=r.Xpm({type:ActivityCloseModal,selectors:[["ng-component"]],viewQuery:function(t,e){if(1&t&&r.Gf(ct,7,r.s_b),2&t){let t;r.iGM(t=r.CRH())&&(e.modalContent=t.first)}},inputs:{preventGoingToRecord:"preventGoingToRecord"},features:[r._Bn([b.e])],decls:13,vars:2,consts:[["size","large"],[3,"close"],["label","LBL_CLOSE"],["margin","none"],["modalContent",""],[1,"slds-grid"],[1,"slds-grid--vertical","slds-grow"],[3,"componentSet"],[1,"slds-grid","slds-grid--vertical-align-center","slds-grid--align-spread"],[1,"slds-col"],[3,"actionset","actionemitter"]],template:function(t,e){1&t&&(r.TgZ(0,"system-modal",0)(1,"system-modal-header",1),r.NdJ("close",(function(){return e.closeModal()})),r._UZ(2,"system-label",2),r.qZA(),r.TgZ(3,"system-modal-content",3,4)(5,"div",5)(6,"div",6),r._UZ(7,"object-edit-modal-dialog-container",7),r.qZA()()(),r.TgZ(8,"system-modal-footer")(9,"div",8),r._UZ(10,"div",9),r.TgZ(11,"div",9)(12,"object-action-container",10),r.NdJ("actionemitter",(function(t){return e.emitaction(t)})),r.qZA()()()()()),2&t&&(r.xp6(7),r.Q6J("componentSet",e.componentSet),r.xp6(5),r.Q6J("actionset",e.actionSet))},dependencies:[st.S,nt.Z,S._,lt.j,at.x,ot.p,dt.y],encapsulation:2}),ActivityCloseModal})();var mt=i(9901);function ut(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"system-input-radio",11),r.NdJ("ngModelChange",(function(e){r.CHM(t);const i=r.oxw();return r.KtG(i.value=e)})),r._uU(1),r.qZA()}if(2&t){const t=e.$implicit,i=r.oxw();r.Q6J("value",t.module)("ngModel",i.value),r.xp6(1),r.Oqu(i.language.getLabel(t.singular_label))}}let pt=(()=>{class ActivityCloseCreateModal{constructor(t,e,i){this.language=t,this.model=e,this.metadata=i,this.componentconfig={},this.newBeanModules=[],this.parent={},this.self={},this.value=""}ngOnInit(){this.componentconfig=this.metadata.getComponentConfig(this.constructor.name,this.parent.module);let t=this.componentconfig.newBeanModules;if(t){let e=t.split(",");for(let t of e)this.metadata.checkModuleAcl(t,"create")&&this.newBeanModules.push(this.metadata.getModuleDefs(t))}}closeModal(){this.self.destroy()}create(){this.model.module=this.value,this.model.addModel("",this.parent),this.self.destroy()}}return ActivityCloseCreateModal.ɵfac=function(t){return new(t||ActivityCloseCreateModal)(r.Y36(f.d),r.Y36(p.o),r.Y36(x.Pu))},ActivityCloseCreateModal.ɵcmp=r.Xpm({type:ActivityCloseCreateModal,selectors:[["ng-component"]],inputs:{parent:"parent"},features:[r._Bn([p.o])],decls:13,vars:1,consts:[["size","x-small"],[3,"close"],["label","LBL_CREATE"],["margin","none"],[1,"slds-m-left_x-small","slds-m-vertical_large"],[1,"slds-form-element"],[1,"slds-form-element__control"],["name","module",3,"value","ngModel","ngModelChange",4,"ngFor","ngForOf"],[1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_CANCEL"],[1,"slds-button","slds-button--brand",3,"click"],["name","module",3,"value","ngModel","ngModelChange"]],template:function(t,e){1&t&&(r.TgZ(0,"system-modal",0)(1,"system-modal-header",1),r.NdJ("close",(function(){return e.closeModal()})),r._UZ(2,"system-label",2),r.qZA(),r.TgZ(3,"system-modal-content",3)(4,"div",4)(5,"div",5)(6,"div",6),r.YNc(7,ut,2,3,"system-input-radio",7),r.qZA()()()(),r.TgZ(8,"system-modal-footer")(9,"button",8),r.NdJ("click",(function(){return e.closeModal()})),r._UZ(10,"system-label",9),r.qZA(),r.TgZ(11,"button",10),r.NdJ("click",(function(){return e.create()})),r._UZ(12,"system-label",2),r.qZA()()()),2&t&&(r.xp6(7),r.Q6J("ngForOf",e.newBeanModules))},dependencies:[s.sg,n.JJ,n.On,mt.A,S._,lt.j,at.x,ot.p,dt.y],encapsulation:2}),ActivityCloseCreateModal})();var gt=i(6040);let ht=(()=>{class ActivitiesPopoverAddBarButton{constructor(t,e,i,s){this.model=t,this.language=e,this.metadata=i,this.relatedmodels=s,this.module=""}addModel(){this.model.module=this.module;let t=[this.parent];this.relatedmodels&&this.relatedmodels.model&&t.push(this.relatedmodels.model),this.model.addModel("",t)}}return ActivitiesPopoverAddBarButton.ɵfac=function(t){return new(t||ActivitiesPopoverAddBarButton)(r.Y36(p.o),r.Y36(f.d),r.Y36(x.Pu),r.Y36(gt.j,8))},ActivitiesPopoverAddBarButton.ɵcmp=r.Xpm({type:ActivitiesPopoverAddBarButton,selectors:[["activities-popover-addbar-button"]],inputs:{module:"module",parent:"parent"},features:[r._Bn([p.o])],decls:2,vars:2,consts:[[1,"slds-button","slds-button_icon","slds-button_icon-border",3,"title","click"],["size","large",3,"module"]],template:function(t,e){1&t&&(r.TgZ(0,"button",0),r.NdJ("click",(function(){return e.addModel()})),r._UZ(1,"system-button-icon",1),r.qZA()),2&t&&(r.Q6J("title",e.language.getModuleCombinedLabel("LBL_ADD",e.module)),r.xp6(1),r.Q6J("module",e.module))},dependencies:[R.J],encapsulation:2}),ActivitiesPopoverAddBarButton})();function ft(t,e){if(1&t&&(r.TgZ(0,"div",3),r._UZ(1,"activities-popover-addbar-button",4),r.qZA()),2&t){const t=e.$implicit,i=r.oxw(2);r.xp6(1),r.Q6J("module",t)("parent",i.model)}}function vt(t,e){if(1&t&&(r.TgZ(0,"div",1),r.YNc(1,ft,2,2,"div",2),r.qZA()),2&t){const t=r.oxw();r.xp6(1),r.Q6J("ngForOf",t.modules)}}let yt=(()=>{class ActivitiesPopoverAddBar{constructor(t,e,i){this.model=t,this.language=e,this.metadata=i,this.modules=[]}ngOnInit(){if(this.componentconfig.modules){let t=this.componentconfig.modules.split(",");for(let e of t)this.metadata.checkModuleAcl(e,"create")&&this.modules.push(e)}}}return ActivitiesPopoverAddBar.ɵfac=function(t){return new(t||ActivitiesPopoverAddBar)(r.Y36(p.o),r.Y36(f.d),r.Y36(x.Pu))},ActivitiesPopoverAddBar.ɵcmp=r.Xpm({type:ActivitiesPopoverAddBar,selectors:[["ng-component"]],decls:1,vars:1,consts:[["class","slds-grid slds-p-vertical--x-small",4,"ngIf"],[1,"slds-grid","slds-p-vertical--x-small"],["class","slds-p-horizontal--xx-small",4,"ngFor","ngForOf"],[1,"slds-p-horizontal--xx-small"],[3,"module","parent"]],template:function(t,e){1&t&&r.YNc(0,vt,2,1,"div",0),2&t&&r.Q6J("ngIf",e.modules.length>0)},dependencies:[s.sg,s.O5,ht],encapsulation:2}),ActivitiesPopoverAddBar})();const bt=["field-activities-addactions-button",""];let xt=(()=>{class fieldActivitiesAddActionsButton extends ht{}return fieldActivitiesAddActionsButton.ɵfac=function(){let t;return function(e){return(t||(t=r.n5z(fieldActivitiesAddActionsButton)))(e||fieldActivitiesAddActionsButton)}}(),fieldActivitiesAddActionsButton.ɵcmp=r.Xpm({type:fieldActivitiesAddActionsButton,selectors:[["","field-activities-addactions-button",""]],hostBindings:function(t,e){1&t&&r.NdJ("click",(function(){return e.addModel()}))},features:[r._Bn([p.o]),r.qOj],attrs:bt,decls:1,vars:1,consts:[["size","large",3,"module"]],template:function(t,e){1&t&&r._UZ(0,"system-button-icon",0),2&t&&r.Q6J("module",e.module)},dependencies:[R.J],encapsulation:2}),fieldActivitiesAddActionsButton})();function _t(t,e){if(1&t&&r._UZ(0,"button",3),2&t){const t=e.$implicit,i=r.oxw(2);r.Q6J("title",i.language.getModuleCombinedLabel("LBL_ADD",t))("module",t)("parent",i.model)}}function At(t,e){if(1&t&&(r.TgZ(0,"div",1),r.YNc(1,_t,1,3,"button",2),r.qZA()),2&t){const t=r.oxw();r.xp6(1),r.Q6J("ngForOf",t.modules)}}let Zt=(()=>{class fieldActivitiesAddActions{constructor(t,e,i){this.model=t,this.language=e,this.metadata=i,this.fieldconfig={},this.modules=[]}ngOnInit(){if(this.fieldconfig.modules){let t=this.fieldconfig.modules.split(",");for(let e of t)this.metadata.checkModuleAcl(e,"create")&&this.modules.push(e)}}}return fieldActivitiesAddActions.ɵfac=function(t){return new(t||fieldActivitiesAddActions)(r.Y36(p.o),r.Y36(f.d),r.Y36(x.Pu))},fieldActivitiesAddActions.ɵcmp=r.Xpm({type:fieldActivitiesAddActions,selectors:[["ng-component"]],inputs:{fieldconfig:"fieldconfig"},decls:1,vars:1,consts:[["class","slds-button-group","role","group",4,"ngIf"],["role","group",1,"slds-button-group"],["field-activities-addactions-button","","style","height: 24px; width:24px;","class","slds-button slds-button_icon slds-button_icon-border",3,"title","module","parent",4,"ngFor","ngForOf"],["field-activities-addactions-button","",1,"slds-button","slds-button_icon","slds-button_icon-border",2,"height","24px","width","24px",3,"title","module","parent"]],template:function(t,e){1&t&&r.YNc(0,At,2,1,"div",0),2&t&&r.Q6J("ngIf",e.modules.length>0)},dependencies:[s.sg,s.O5,xt],encapsulation:2}),fieldActivitiesAddActions})();var Tt=i(7040),kt=i(6367),Ct=i(3208),wt=i(7514),Mt=i(1790);function Jt(t,e){if(1&t&&r._UZ(0,"field-label",2),2&t){const t=r.oxw();r.Q6J("fieldname",t.fieldname)("fieldconfig",t.fieldconfig)}}function Yt(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"system-checkbox",7),r.NdJ("ngModelChange",(function(e){r.CHM(t);const i=r.oxw(2);return r.KtG(i.completed=e)})),r.qZA()}if(2&t){const t=r.oxw(2);r.Q6J("ngModel",t.completed)}}function Lt(t,e){if(1&t&&(r.TgZ(0,"field-generic-display",3)(1,"div",4),r.YNc(2,Yt,1,1,"system-checkbox",5),r.TgZ(3,"div",6),r._uU(4),r.qZA()()()),2&t){const t=r.oxw();r.Q6J("fielddisplayclass",t.fielddisplayclass)("editable",t.isEditable())("fieldconfig",t.fieldconfig)("fieldid",t.fieldid),r.xp6(2),r.Q6J("ngIf",t.canComplete),r.xp6(2),r.Oqu(t.value)}}let Ft=(()=>{class fieldActivitiesTaskWithCloseCheckbox extends Tt.O{constructor(t,e,i,s,n){super(t,e,i,s,n),this.model=t,this.view=e,this.language=i,this.metadata=s,this.router=n}get canComplete(){return"Completed"!==this.model.getField("status")&&"Deferred"!==this.model.getField("status")||!this.model.checkAccess("edit")}get completed(){return"Completed"==this.model.getField("status")}set completed(t){t&&this.canComplete&&(this.model.startEdit(),this.model.setField("status","Completed"),this.model.save())}}return fieldActivitiesTaskWithCloseCheckbox.ɵfac=function(t){return new(t||fieldActivitiesTaskWithCloseCheckbox)(r.Y36(p.o),r.Y36(b.e),r.Y36(f.d),r.Y36(x.Pu),r.Y36(et.F0))},fieldActivitiesTaskWithCloseCheckbox.ɵcmp=r.Xpm({type:fieldActivitiesTaskWithCloseCheckbox,selectors:[["ng-component"]],features:[r.qOj],decls:2,vars:2,consts:[[3,"fieldname","fieldconfig",4,"ngIf"],[3,"fielddisplayclass","editable","fieldconfig","fieldid",4,"ngIf"],[3,"fieldname","fieldconfig"],[3,"fielddisplayclass","editable","fieldconfig","fieldid"],[1,"slds-grid","slds-grid_vertical-align-center"],[3,"ngModel","ngModelChange",4,"ngIf"],["system-model-popover",""],[3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(r.YNc(0,Jt,1,2,"field-label",0),r.YNc(1,Lt,5,6,"field-generic-display",1)),2&t&&(r.Q6J("ngIf",e.displayLabel),r.xp6(1),r.Q6J("ngIf",!e.isEditMode()))},dependencies:[s.O5,n.JJ,n.On,kt.q,Ct.D,wt.U,Mt.g],encapsulation:2}),fieldActivitiesTaskWithCloseCheckbox})();var St=i(2422),Nt=i(5638);function Et(t,e){if(1&t&&r._UZ(0,"field-label",3),2&t){const t=r.oxw();r.Q6J("fieldname",t.fieldname)("fieldconfig",t.fieldconfig)}}function qt(t,e){if(1&t&&(r.TgZ(0,"field-generic-display",4),r._UZ(1,"system-label",5),r.qZA()),2&t){const t=r.oxw();r.Q6J("fielddisplayclass",t.fielddisplayclass)("editable",t.isEditable())("fieldconfig",t.fieldconfig)("fieldid",t.fieldid),r.xp6(1),r.Q6J("label",t.display)}}function It(t,e){if(1&t&&(r.TgZ(0,"option",13),r._UZ(1,"system-label",5),r.qZA()),2&t){const t=e.$implicit;r.Q6J("value",t.value),r.xp6(1),r.Q6J("label",t.label)}}function Ot(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"div",6)(1,"div",7)(2,"div",8)(3,"select",9,10),r.NdJ("ngModelChange",(function(e){r.CHM(t);const i=r.oxw();return r.KtG(i.value=e)})),r.YNc(5,It,2,2,"option",11),r.qZA()(),r._UZ(6,"field-messages",12),r.qZA()()}if(2&t){const t=r.oxw();r.xp6(1),r.Q6J("ngClass",t.getFieldClass()),r.xp6(2),r.Q6J("ngModel",t.value),r.xp6(2),r.Q6J("ngForOf",t.options),r.xp6(1),r.Q6J("fieldname",t.fieldname)}}let Qt=(()=>{class fieldActivityReminder extends Tt.O{constructor(t,e,i,s,n,l,a,o,d,c){super(t,e,s,n,l),this.model=t,this.view=e,this.broadcast=i,this.language=s,this.metadata=n,this.router=l,this.elementRef=a,this.renderer=o,this.modal=d,this.userpreferences=c,this.options=[{value:"-1",label:"LBL_REMINDER_NONE"},{value:"60",label:"LBL_REMINDER_1MINUTE"},{value:"300",label:"LBL_REMINDER_5MINUTES"},{value:"600",label:"LBL_REMINDER_10MINUTES"},{value:"900",label:"LBL_REMINDER_15MINUTES"},{value:"1800",label:"LBL_REMINDER_30MINUTES"},{value:"3600",label:"LBL_REMINDER_1HOUR"},{value:"7200",label:"LBL_REMINDER_2HOURS"},{value:"10800",label:"LBL_REMINDER_3HOURS"},{value:"18000",label:"LBL_REMINDER_5HOURS"},{value:"86400",label:"LBL_REMINDER_1DAY"}]}get display(){return this.options.find((t=>t.value==this.value)).label}get value(){let t=this.model.getField(this.fieldname);return t||"-1"}set value(t){this.model.setField(this.fieldname,t)}}return fieldActivityReminder.ɵfac=function(t){return new(t||fieldActivityReminder)(r.Y36(p.o),r.Y36(b.e),r.Y36(m.f),r.Y36(f.d),r.Y36(x.Pu),r.Y36(et.F0),r.Y36(r.SBq),r.Y36(r.Qsj),r.Y36(H.o),r.Y36(St.z))},fieldActivityReminder.ɵcmp=r.Xpm({type:fieldActivityReminder,selectors:[["field-activity-reminder"]],features:[r.qOj],decls:3,vars:3,consts:[[3,"fieldname","fieldconfig",4,"ngIf"],[3,"fielddisplayclass","editable","fieldconfig","fieldid",4,"ngIf"],["class","slds-form-element",4,"ngIf"],[3,"fieldname","fieldconfig"],[3,"fielddisplayclass","editable","fieldconfig","fieldid"],[3,"label"],[1,"slds-form-element"],[1,"slds-form-element__control",3,"ngClass"],[1,"slds-select_container","slds-m-vertical--xx-small"],[1,"slds-select",3,"ngModel","ngModelChange"],["focus",""],[3,"value",4,"ngFor","ngForOf"],[3,"fieldname"],[3,"value"]],template:function(t,e){1&t&&(r.YNc(0,Et,1,2,"field-label",0),r.YNc(1,qt,2,5,"field-generic-display",1),r.YNc(2,Ot,7,4,"div",2)),2&t&&(r.Q6J("ngIf",e.displayLabel),r.xp6(1),r.Q6J("ngIf",!e.isEditMode()),r.xp6(1),r.Q6J("ngIf",e.isEditMode()))},dependencies:[s.mk,s.sg,s.O5,n.YN,n.Kr,n.EJ,n.JJ,n.On,kt.q,Ct.D,Nt.a,S._],encapsulation:2}),fieldActivityReminder})();const Ut=["activity-participation-panel-header",""];function Dt(t,e){if(1&t&&(r.TgZ(0,"th",2),r._UZ(1,"field-label",3),r.qZA()),2&t){const t=e.$implicit;r.xp6(1),r.Q6J("fieldname",t.field)("fieldconfig",t.fieldconfig)}}let Bt=(()=>{class ActivityParticipationPanelHeader{constructor(t,e,i){this.model=t,this.metadata=e,this.view=i,this.fieldsetfields=[],this.model.module="Contacts"}ngOnInit(){this.fieldsetfields=this.metadata.getFieldSetFields(this.fieldset)}}return ActivityParticipationPanelHeader.ɵfac=function(t){return new(t||ActivityParticipationPanelHeader)(r.Y36(p.o),r.Y36(x.Pu),r.Y36(b.e))},ActivityParticipationPanelHeader.ɵcmp=r.Xpm({type:ActivityParticipationPanelHeader,selectors:[["","activity-participation-panel-header",""]],inputs:{fieldset:"fieldset"},features:[r._Bn([p.o])],attrs:Ut,decls:2,vars:1,consts:[["scope","col",1,"slds-cell-shrink"],["class","","scope","col",4,"ngFor","ngForOf"],["scope","col",1,""],[3,"fieldname","fieldconfig"]],template:function(t,e){1&t&&(r._UZ(0,"th",0),r.YNc(1,Dt,2,2,"th",1)),2&t&&(r.xp6(1),r.Q6J("ngForOf",e.fieldsetfields))},dependencies:[s.sg,kt.q],encapsulation:2}),ActivityParticipationPanelHeader})();var Pt=i(4561),zt=i(8859);const jt=["activity-participation-panel-participant",""];function Ht(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"system-utility-icon",4),r.NdJ("click",(function(e){r.CHM(t);const i=r.oxw();return r.KtG(i.removeItem(e))})),r.qZA()}}function Rt(t,e){if(1&t&&(r.TgZ(0,"td"),r._UZ(1,"field-container",5),r.qZA()),2&t){const t=e.$implicit;r.xp6(1),r.Q6J("field",t.field)("fieldconfig",t.fieldconfig)}}let Gt=(()=>{class ActivityParticipationPanelParticipant{constructor(t,e,i,s){this.model=t,this.parent=e,this.metadata=i,this.view=s,this.participant={},this.editmode=!1,this.fieldsetfields=[],this.remove=new r.vpe}ngOnInit(){this.model.module=this.participant.module,this.model.id=this.participant.id,this.model.setData(this.participant.data),this.model.parentmodel=this.parent,this.fieldsetfields=this.metadata.getFieldSetFields(this.fieldset)}removeItem(t){t.stopPropagation(),this.editmode&&this.remove.emit(!0)}}return ActivityParticipationPanelParticipant.ɵfac=function(t){return new(t||ActivityParticipationPanelParticipant)(r.Y36(p.o),r.Y36(p.o,4),r.Y36(x.Pu),r.Y36(b.e))},ActivityParticipationPanelParticipant.ɵcmp=r.Xpm({type:ActivityParticipationPanelParticipant,selectors:[["","activity-participation-panel-participant",""]],inputs:{participant:"participant",module:"module",editmode:"editmode",fieldset:"fieldset"},outputs:{remove:"remove"},features:[r._Bn([p.o])],attrs:jt,decls:5,vars:3,consts:[[1,"slds-grid","slds-grid--vertical-align-center"],["class","slds-m-right--xx-small","icon","close","size","xx-small",3,"click",4,"ngIf"],["size","xx-small",3,"module"],[4,"ngFor","ngForOf"],["icon","close","size","xx-small",1,"slds-m-right--xx-small",3,"click"],["fielddisplayclass","slds-truncate slds-p-horizontal--x-small",3,"field","fieldconfig"]],template:function(t,e){1&t&&(r.TgZ(0,"td")(1,"div",0),r.YNc(2,Ht,1,0,"system-utility-icon",1),r._UZ(3,"system-icon",2),r.qZA()(),r.YNc(4,Rt,2,2,"td",3)),2&t&&(r.xp6(2),r.Q6J("ngIf",e.editmode),r.xp6(1),r.Q6J("module",e.model.module),r.xp6(1),r.Q6J("ngForOf",e.fieldsetfields))},dependencies:[s.sg,s.O5,Z.j,Pt.f,zt.r],encapsulation:2}),ActivityParticipationPanelParticipant})();function Kt(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"tr",4),r.NdJ("remove",(function(){const e=r.CHM(t).$implicit,i=r.oxw();return r.KtG(i.removeParticipant(e))})),r.qZA()}if(2&t){const t=e.$implicit,i=r.oxw();r.Q6J("participant",t)("editmode",i.editmode)("fieldset",i.fieldset)}}let Vt=(()=>{class ActivityParticipationPanel{constructor(t,e,i,s){this.model=t,this.metadata=e,this.view=i,this.language=s,this.participants=[],this.editmode=!1,this.remove=new r.vpe,this.view.isEditable=!1,this.view.displayLabels=!1}removeParticipant(t){this.remove.emit(t)}participantid(t,e){return e.id}}return ActivityParticipationPanel.ɵfac=function(t){return new(t||ActivityParticipationPanel)(r.Y36(p.o),r.Y36(x.Pu),r.Y36(b.e),r.Y36(f.d))},ActivityParticipationPanel.ɵcmp=r.Xpm({type:ActivityParticipationPanel,selectors:[["activity-participation-panel"]],inputs:{participants:"participants",editmode:"editmode",fieldset:"fieldset"},outputs:{remove:"remove"},features:[r._Bn([b.e])],decls:6,vars:3,consts:[[1,"slds-size--1-of-1","slds-scrollable--y"],[1,"slds-table","slds-table_bordered"],["activity-participation-panel-header","",1,"slds-line-height_reset",3,"fieldset"],["activity-participation-panel-participant","",3,"participant","editmode","fieldset","remove",4,"ngFor","ngForOf","ngForTrackBy"],["activity-participation-panel-participant","",3,"participant","editmode","fieldset","remove"]],template:function(t,e){1&t&&(r.TgZ(0,"div",0)(1,"table",1)(2,"thead"),r._UZ(3,"tr",2),r.qZA(),r.TgZ(4,"tbody"),r.YNc(5,Kt,1,3,"tr",3),r.qZA()()()),2&t&&(r.xp6(3),r.Q6J("fieldset",e.fieldset),r.xp6(2),r.Q6J("ngForOf",e.participants)("ngForTrackBy",e.participantid))},dependencies:[s.sg,Bt,Gt],encapsulation:2}),ActivityParticipationPanel})();var $t=i(4271),Xt=i(5957),Wt=i(3333);function te(t,e){if(1&t&&r._UZ(0,"field-label",3),2&t){const t=r.oxw();r.Q6J("fieldname",t.fieldname)("fieldconfig",t.fieldconfig)}}function ee(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"li",24),r.NdJ("click",(function(){const e=r.CHM(t).index,i=r.oxw(3);return r.KtG(i.setLookupType(e))})),r.TgZ(1,"div",25)(2,"div",26),r._UZ(3,"system-icon",27),r.TgZ(4,"div",28),r._UZ(5,"system-label-modulename",29),r.qZA()()()()}if(2&t){const t=e.$implicit;r.xp6(3),r.Q6J("module",t.module),r.xp6(2),r.Q6J("module",t.module)}}const ie=function(t){return{"slds-is-open":t}};function se(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"div",16)(1,"div",17)(2,"div",8)(3,"div",18),r.NdJ("click",(function(){r.CHM(t);const e=r.oxw(2);return r.KtG(e.toggleLookupTypeSelect())})),r._UZ(4,"input",19)(5,"system-icon",20),r.qZA(),r.TgZ(6,"div",21)(7,"ul",22),r.YNc(8,ee,6,2,"li",23),r.qZA()()()()()}if(2&t){const t=r.oxw(2);r.xp6(2),r.Q6J("ngClass",r.VKq(3,ie,t.lookuplinkSelectOpen)),r.xp6(2),r.Q6J("value",t.lookupTypeName),r.xp6(4),r.Q6J("ngForOf",t.lookuplinks)}}function ne(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"field-lookup-recent",30),r.NdJ("selectedObject",(function(e){r.CHM(t);const i=r.oxw(2);return r.KtG(i.addItem(e))})),r.qZA()}if(2&t){const t=r.oxw(2);r.Q6J("module",t.lookuplinks[t.lookupType].module)}}function le(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"field-lookup-search",31),r.NdJ("selectedObject",(function(e){r.CHM(t);const i=r.oxw(2);return r.KtG(i.addItem(e))}))("searchWithModal",(function(){r.CHM(t);const e=r.oxw(2);return r.KtG(e.searchWithModal())})),r.qZA()}if(2&t){const t=r.oxw(2);r.Q6J("module",t.lookuplinks[t.lookupType].module)("relatefilter",t.relateFilter)("searchterm",t.lookupSearchTerm)}}const ae=function(t){return{"slds-combobox__input":t}};function oe(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"div",4)(1,"div",5),r.YNc(2,se,9,5,"div",6),r.TgZ(3,"div",7)(4,"div",8)(5,"div",9)(6,"input",10),r.NdJ("click",(function(){r.CHM(t);const e=r.oxw();return r.KtG(e.onFocus())}))("focus",(function(){r.CHM(t);const e=r.oxw();return r.KtG(e.onFocus())}))("ngModelChange",(function(e){r.CHM(t);const i=r.oxw();return r.KtG(i.lookupSearchTerm=e)})),r.qZA(),r.TgZ(7,"button",11),r.NdJ("click",(function(){r.CHM(t);const e=r.oxw();return r.KtG(e.searchWithModal())})),r._UZ(8,"system-button-icon",12),r.qZA()(),r.TgZ(9,"div",13),r.YNc(10,ne,1,1,"field-lookup-recent",14),r.YNc(11,le,1,3,"field-lookup-search",15),r.qZA()()()()()}if(2&t){const t=r.oxw();r.xp6(2),r.Q6J("ngIf",t.lookuplinks.length>1),r.xp6(2),r.Q6J("ngClass",r.VKq(8,ie,t.lookupSearchOpen)),r.xp6(2),r.Q6J("ngClass",r.VKq(10,ae,t.lookuplinks.length>1))("ngModel",t.lookupSearchTerm)("placeholder",t.language.getModuleCombinedLabel("LBL_SEARCH",null==t.lookuplinks[t.lookupType]?null:t.lookuplinks[t.lookupType].module)),r.xp6(2),r.Q6J("icon","search"),r.xp6(2),r.Q6J("ngIf",t.lookupSearchOpen&&""===t.lookupSearchTerm),r.xp6(1),r.Q6J("ngIf",t.lookupSearchOpen&&""!==t.lookupSearchTerm)}}let de=(()=>{class fieldActivityParticipationPanel extends Tt.O{constructor(t,e,i,s,n,l,a,o,d){super(t,e,s,n,l),this.model=t,this.view=e,this.broadcast=i,this.language=s,this.metadata=n,this.router=l,this.elementRef=a,this.renderer=o,this.modal=d,this.lookupType=0,this.lookuplinks=[],this.lookuplinkSelectOpen=!1,this.lookupSearchOpen=!1,this.lookupSearchTerm="",this.participants=[],this.subscriptions.add(this.broadcast.message$.subscribe((t=>this.handleMessage(t)))),this.subscriptions.add(this.model.data$.subscribe((t=>{this.lookuplinks.length>0&&this.setParticipants(),this.updateRelateFilter()})))}get lookupTypeName(){return this.language.getModuleName(this.lookuplinks[this.lookupType]?.module)}get relateFilterActive(){return"Users"!=this.lookuplinks[this.lookupType]?.module}ngOnInit(){this.lookuplinks=this.getLookuplinks(),this.setParticipants(),this.fieldconfig.fieldset?this.fieldset=this.fieldconfig.fieldset:this.fieldset=this.metadata.getComponentConfig("fieldActivityParticipationPanel").fieldset,this.fieldconfig.relatefilterfield&&this.createRelateFilter()}ngOnDestroy(){this.subscriptions.unsubscribe()}onClick(t){this.elementRef.nativeElement.contains(t.target)||this.closePopups()}handleRelateFIlterField(){this.fieldconfig.relatefilterfield&&(this.createRelateFilter(),this.subscriptions.add(this.model.data$.subscribe((t=>{this.updateRelateFilter()}))))}createRelateFilter(){let t=this.metadata.getFieldDefs(this.model.module,this.fieldconfig.relatefilterfield);if(t){let e="parent"==t.type?this.model.getField(t.type_name):t.module;this.relateFilter={module:e,relationship:this.fieldconfig.relatefilterrelationship,id:this.model.getField(t.id_name),display:this.model.getField(this.fieldconfig.relatefilterfield),active:!!this.model.getField(t.id_name),required:!1}}}removeRelateFilter(){this.relateFilter=void 0}updateRelateFilter(){if(this.relateFilterActive){let t=this.metadata.getFieldDefs(this.model.module,this.fieldconfig.relatefilterfield);t&&(this.relateFilter.id=this.model.getField(t.id_name),this.relateFilter.display=this.model.getField(this.fieldconfig.relatefilterfield),this.relateFilter.active=!!this.relateFilter.id)}}getLookuplinks(){let t=[];this.fieldconfig.linknames&&(t=this.fieldconfig.linknames.split(",")),0==t.length&&(t=["contacts","users","consumers"]);let e=[];for(let i of t){i=i.trim();let t=this.metadata.getFieldDefs(this.model.module,i)?.module;t&&this.metadata.moduleDefs[t]&&e.push({name:i,module:t})}return e}setParticipants(){for(let t of this.lookuplinks)if(this.model.data[t.name]&&this.model.data[t.name].beans)for(let e in this.model.data[t.name].beans){let i=this.model.data[t.name].beans[e];("Users"!=t.module||this.displayAssignedUser||e!=this.model.data.assigned_user_id)&&(this.participants.findIndex((t=>t.id==i.id))<0&&this.participants.push({module:t.module,id:i.id,data:i,link:t.name}))}}addItem(t){this.model.data[this.lookuplinks[this.lookupType].name]||(this.model.data[this.lookuplinks[this.lookupType].name]={beans:{}}),this.model.data[this.lookuplinks[this.lookupType].name].beans[t.id]=t.data,this.lookupSearchOpen=!1,this.setParticipants()}handleMessage(t){if(t.messagedata.reference&&"model.save"===t.messagetype)this.fieldid===t.messagedata.reference&&(this.lookupSearchTerm="",this.addItem({id:t.messagedata.data.id,text:t.messagedata.data.summary_text}))}closePopups(){this.lookupSearchOpen=!1,this.lookuplinkSelectOpen=!1,this.clickListener()}toggleLookupTypeSelect(){this.lookuplinkSelectOpen=!this.lookuplinkSelectOpen,this.lookupSearchOpen=!1}setLookupType(t){this.lookupSearchTerm="",this.lookupType=t,this.lookuplinkSelectOpen=!1,this.relateFilterActive?this.createRelateFilter():this.removeRelateFilter()}removeItem(t){this.model.data[t.link].beans_relations_to_delete||(this.model.data[t.link].beans_relations_to_delete={}),this.model.data[t.link].beans_relations_to_delete[t.id]=t,delete this.model.data[t.link].beans[t.id],this.participants=this.participants.filter((e=>e.id!=t.id))}onFocus(){this.openSearchDropDown()}openSearchDropDown(){this.lookuplinkSelectOpen=!1,this.lookupSearchOpen=!0,this.clickListener=this.renderer.listen("document","click",(t=>this.onClick(t)))}searchWithModal(){this.modal.openModal("ObjectModalModuleLookup").subscribe((t=>{t.instance.module=this.lookuplinks[this.lookupType].module,t.instance.multiselect=!1,this.relateFilter&&(t.instance.relatefilter=this.relateFilter),t.instance.selectedItems.subscribe((t=>{this.addItem({id:t[0].id,text:t[0].summary_text,data:t[0]})})),t.instance.usedSearchTerm.subscribe((t=>{this.lookupSearchTerm=t})),t.instance.searchTerm=this.lookupSearchTerm}))}}return fieldActivityParticipationPanel.ɵfac=function(t){return new(t||fieldActivityParticipationPanel)(r.Y36(p.o),r.Y36(b.e),r.Y36(m.f),r.Y36(f.d),r.Y36(x.Pu),r.Y36(et.F0),r.Y36(r.SBq),r.Y36(r.Qsj),r.Y36(H.o))},fieldActivityParticipationPanel.ɵcmp=r.Xpm({type:fieldActivityParticipationPanel,selectors:[["ng-component"]],features:[r.qOj],decls:3,vars:5,consts:[[3,"fieldname","fieldconfig",4,"ngIf"],[3,"fieldset","participants","editmode","remove"],["class","slds-form-element__control",4,"ngIf"],[3,"fieldname","fieldconfig"],[1,"slds-form-element__control"],[1,"slds-combobox-group","slds-p-vertical--xx-small"],["class","slds-combobox_object-switcher slds-combobox-addon_start",4,"ngIf"],[1,"slds-combobox_container","slds-combobox-addon_end"],["role","combobox",1,"slds-combobox","slds-dropdown-trigger","slds-dropdown-trigger_click",3,"ngClass"],["role","none",1,"slds-combobox__form-element","slds-input-has-icon","slds-input-has-icon_right"],["type","text","aria-autocomplete","list","autoComplete","off","role","textbox",1,"slds-input",3,"ngClass","ngModel","placeholder","click","focus","ngModelChange"],[1,"slds-button","slds-button_icon","slds-input__icon","slds-input__icon_right",3,"click"],[3,"icon"],["role","listbox",1,"slds-dropdown","slds-dropdown_length-with-icon-7","slds-dropdown_fluid"],[3,"module","selectedObject",4,"ngIf"],[3,"module","relatefilter","searchterm","selectedObject","searchWithModal",4,"ngIf"],[1,"slds-combobox_object-switcher","slds-combobox-addon_start"],[1,"slds-combobox_container"],[1,"slds-combobox__form-element","slds-input-has-icon","slds-input-has-icon--right",3,"click"],["type","text","readonly","","autoComplete","off","role","textbox",1,"slds-input","slds-combobox__input","slds-combobox__input-value",3,"value"],["icon","down","sprite","utility","addclasses","slds-input__icon slds-input__icon_right"],["role","listbox",1,"slds-dropdown","slds-dropdown_length-5","slds-dropdown_x-small","slds-dropdown_left"],["role","group","aria-label","Suggested for you",1,"slds-listbox","slds-listbox_vertical"],["role","presentation","class","slds-listbox__item",3,"click",4,"ngFor","ngForOf"],["role","presentation",1,"slds-listbox__item",3,"click"],["role","option",1,"slds-media","slds-listbox__option","slds-listbox__option_plain","slds-media_small"],[1,"slds-grid","slds-grid--vertical-align-center"],["size","x-small",3,"module"],[1,"slds-truncate"],[3,"module"],[3,"module","selectedObject"],[3,"module","relatefilter","searchterm","selectedObject","searchWithModal"]],template:function(t,e){1&t&&(r.YNc(0,te,1,2,"field-label",0),r.TgZ(1,"activity-participation-panel",1),r.NdJ("remove",(function(t){return e.removeItem(t)})),r.qZA(),r.YNc(2,oe,12,12,"div",2)),2&t&&(r.Q6J("ngIf",e.displayLabel),r.xp6(1),r.Q6J("fieldset",e.fieldset)("participants",e.participants)("editmode",e.isEditMode()),r.xp6(1),r.Q6J("ngIf",e.isEditable()&&e.isEditMode()))},dependencies:[s.mk,s.sg,s.O5,n.Fj,n.JJ,n.On,kt.q,$t.P,Xt.$,R.J,Pt.f,Wt.M,Vt],encapsulation:2}),fieldActivityParticipationPanel})();var ce=i(5920),re=i(4505);const me=function(t){return{"slds-is-selected":t}};let ue=(()=>{class ActivityParticipationStatus{constructor(t,e,i,s,n){this.view=t,this.session=e,this.cdRef=i,this.backend=s,this.toast=n,this.status="none",this.updating=!1}get disabled(){return!(!this.view.isEditMode()&&!this.updating&&"Users"==this.model.module&&this.model.id==this.session.authData.userId&&this.parent&&"Planned"==this.parent.getField("status"))}accept(){this.setStatus("accept")}decline(){this.setStatus("decline")}tentative(){this.setStatus("tentative")}setStatus(t){this.updating=!0,this.backend.postRequest(`module/${this.parent.module}/${this.parent.id}/status/${this.model.id}/${t}`).subscribe((e=>{this.status=t,this.onChange(this.status),this.updating=!1}),(t=>{this.toast.sendToast("Error Updating","error"),this.updating=!1}))}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}writeValue(t){this.status=t||"none",this.cdRef.detectChanges()}}return ActivityParticipationStatus.ɵfac=function(t){return new(t||ActivityParticipationStatus)(r.Y36(b.e),r.Y36(ce.n),r.Y36(r.sBO),r.Y36(re.y),r.Y36(it.A))},ActivityParticipationStatus.ɵcmp=r.Xpm({type:ActivityParticipationStatus,selectors:[["activity-participation-status"]],inputs:{parent:"parent",model:"model"},features:[r._Bn([{provide:n.JU,useExisting:(0,r.Gpc)((()=>ActivityParticipationStatus)),multi:!0}])],decls:7,vars:12,consts:[["role","group",1,"slds-button-group"],[1,"slds-button","slds-button-icon","slds-button_icon-border-filled",2,"height","22px","width","22px",3,"disabled","ngClass","click"],["icon","check","size","xx-small"],["icon","question_mark"],["icon","error"]],template:function(t,e){1&t&&(r.TgZ(0,"div",0)(1,"button",1),r.NdJ("click",(function(){return e.accept()})),r._UZ(2,"system-button-icon",2),r.qZA(),r.TgZ(3,"button",1),r.NdJ("click",(function(){return e.tentative()})),r._UZ(4,"system-button-icon",3),r.qZA(),r.TgZ(5,"button",1),r.NdJ("click",(function(){return e.decline()})),r._UZ(6,"system-button-icon",4),r.qZA()()),2&t&&(r.xp6(1),r.Q6J("disabled",e.disabled)("ngClass",r.VKq(6,me,"accept"==e.status)),r.xp6(2),r.Q6J("disabled",e.disabled)("ngClass",r.VKq(8,me,"tentative"==e.status)),r.xp6(2),r.Q6J("disabled",e.disabled)("ngClass",r.VKq(10,me,"decline"==e.status)))},dependencies:[s.mk,R.J],encapsulation:2}),ActivityParticipationStatus})(),pe=(()=>{class fieldActivityParticipationStatus extends Tt.O{constructor(t,e,i,s,n,l,a,o,d,c){super(t,e,s,n,l),this.model=t,this.view=e,this.broadcast=i,this.language=s,this.metadata=n,this.router=l,this.elementRef=a,this.renderer=o,this.modal=d,this.session=c}get disabled(){return"Users"!=this.model.module||this.model.getField("id")!=this.session.authData.userId||!this.model.parentmodel||"Planned"!=this.model.parentmodel.getField("status")}}return fieldActivityParticipationStatus.ɵfac=function(t){return new(t||fieldActivityParticipationStatus)(r.Y36(p.o),r.Y36(b.e),r.Y36(m.f),r.Y36(f.d),r.Y36(x.Pu),r.Y36(et.F0),r.Y36(r.SBq),r.Y36(r.Qsj),r.Y36(H.o),r.Y36(ce.n))},fieldActivityParticipationStatus.ɵcmp=r.Xpm({type:fieldActivityParticipationStatus,selectors:[["ng-component"]],features:[r.qOj],decls:1,vars:3,consts:[[3,"model","ngModel","parent","ngModelChange"]],template:function(t,e){1&t&&(r.TgZ(0,"activity-participation-status",0),r.NdJ("ngModelChange",(function(t){return e.value=t})),r.qZA()),2&t&&r.Q6J("model",e.model)("ngModel",e.value)("parent",e.model.parentmodel)},dependencies:[n.JJ,n.On,ue],encapsulation:2}),fieldActivityParticipationStatus})();const ge=function(t){return{id:t,module:"Users"}};function he(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"activity-participation-status",1),r.NdJ("ngModelChange",(function(e){r.CHM(t);const i=r.oxw();return r.KtG(i.value=e)})),r.qZA()}if(2&t){const t=r.oxw();r.Q6J("model",r.VKq(3,ge,t.partcipationRecord.id))("ngModel",t.value)("parent",t.model)}}let fe=(()=>{class fieldActivityCurrentUserParticipationStatus extends Tt.O{constructor(t,e,i,s,n,l,a,o,d,c){super(t,e,s,n,l),this.model=t,this.view=e,this.broadcast=i,this.language=s,this.metadata=n,this.router=l,this.elementRef=a,this.renderer=o,this.modal=d,this.session=c,this.partcipationRecord=void 0,this.subscriptions.add(this.model.data$.subscribe((t=>{this.setParticipation()})))}get disabled(){return!(this.partcipationRecord&&!this.isEditMode()&&"Planned"==this.model.getField("status"))}get value(){return this.partcipationRecord?this.partcipationRecord.activity_accept_status:"none"}set value(t){this.partcipationRecord.activity_accept_status=t}setParticipation(){if(this.partcipationRecord=void 0,this.model.getField("assigned_user_id")!=this.session.authData.userId&&this.model.data.users)for(let t in this.model.data.users.beans)this.model.data.users.beans[t].id==this.session.authData.userId&&(this.partcipationRecord=this.model.data.users.beans[t])}}return fieldActivityCurrentUserParticipationStatus.ɵfac=function(t){return new(t||fieldActivityCurrentUserParticipationStatus)(r.Y36(p.o),r.Y36(b.e),r.Y36(m.f),r.Y36(f.d),r.Y36(x.Pu),r.Y36(et.F0),r.Y36(r.SBq),r.Y36(r.Qsj),r.Y36(H.o),r.Y36(ce.n))},fieldActivityCurrentUserParticipationStatus.ɵcmp=r.Xpm({type:fieldActivityCurrentUserParticipationStatus,selectors:[["ng-component"]],features:[r.qOj],decls:1,vars:1,consts:[[3,"model","ngModel","parent","ngModelChange",4,"ngIf"],[3,"model","ngModel","parent","ngModelChange"]],template:function(t,e){1&t&&r.YNc(0,he,1,5,"activity-participation-status",0),2&t&&r.Q6J("ngIf",e.partcipationRecord)},dependencies:[s.O5,n.JJ,n.On,ue],encapsulation:2}),fieldActivityCurrentUserParticipationStatus})();var ve=i(1135),ye=i(9646),be=i(6625);let xe=(()=>{class activitiytimeline{constructor(t,e,i,s,n,l){this.metadata=t,this.backend=e,this.modelutilities=i,this.configurationService=s,this.session=n,this.broadcast=l,this.serviceSubscriptions=[],this.filters={searchterm:"",objectfilters:[],own:""},this.loading$=new r.vpe,this.defaultLimit=5,this.modules=["Activities","History"],this.activeStates=["Planned","In Progress","Not Started","Pending Input"],this.activityObjects=["Tasks","Meetings","Calls","Notes","Emails"],this.sortDates={Calls:"date_start",Meetings:"date_start",Tasks:"date_due",Emails:"date_entered",Notes:"date_entered"},this.activities={Activities:{loading:!1,loadingmore:!1,list:[],totalcount:0,aggregates:[]},History:{loading:!1,loadingmore:!1,list:[],totalcount:0,aggregates:[]}},this.usefts=!1,this._openness=!1,this.serviceSubscriptions.push(this.broadcast.message$.subscribe((t=>this.handleMessage(t)))),this.openness$=new ve.X(this._openness)}get openness(){return this._openness}set openness(t){this._openness=t,this.openness$.next(t)}get filterObjects(){if(this.usefts){let t=[];for(let e in this.activities)t=t.concat(this.getAggregateObjects(e));return _.uniq(t)}return this.activityObjects}getAggregateObjects(t){try{let e=[];for(let i of this.activities[t].aggregates.module)e.push(i.module);return e}catch(t){return[]}}stopSubscriptions(){for(let t of this.serviceSubscriptions)t.unsubscribe()}handleMessage(t){let e=t.messagetype.split(".");if("model"===e[0])switch(e[1]){case"merge":this.parent&&t.messagedata.module==this.parent.module&&t.messagedata.id==this.parent.id&&(this.getTimeLineData("Activities",!0),this.getTimeLineData("History",!0));break;case"save":this.metadata.getModuleDefs(t.messagedata.module).ftsactivities.Activities&&this.getTimeLineData("Activities",!0),this.metadata.getModuleDefs(t.messagedata.module).ftsactivities.History&&this.getTimeLineData("History",!0);break;case"delete":for(let e of this.modules){let i=this.activities[e].list.findIndex((e=>e.module==t.messagedata.module&&e.id==t.messagedata.id));i>=0&&this.activities[e].list.splice(i,1)}}}checkModuleActive(t){return 0==this.filters.objectfilters.length||this.filters.objectfilters.indexOf(t)>=0}toggleModuleFilter(t){0==this.filters.objectfilters.length?(this.filters.objectfilters=this.filterObjects,this.filters.objectfilters.splice(this.filters.objectfilters.indexOf(t),1)):this.filters.objectfilters.indexOf(t)>=0?this.filters.objectfilters.splice(this.filters.objectfilters.indexOf(t),1):(this.filters.objectfilters.push(t),this.filters.objectfilters.length==this.filterObjects.length&&(this.filters.objectfilters=[]))}reload(t=!1){this.loading$.emit(!0);for(let e of this.modules)this.getTimeLineData(e,t)}getTimeLineData(t,e=!1){e||(this.activities[t].loading=!0);let i={count:!0,limit:this.defaultLimit,objects:JSON.stringify(this.filters.objectfilters),own:this.filters.own,searchterm:this.filters.searchterm};this.backend.postRequest("module/"+t+"/fts/"+this.parent.module+"/"+this.parent.id,{},i).subscribe((e=>{if(e){this.resetListData(t);for(let t of e.items)t.data=this.modelutilities.backendModel2spice(t.module,t.data);this.activities[t].list=e.items,this.activities[t].totalcount=parseInt(e.totalcount,10),this.activities[t].aggregates=e.aggregates?e.aggregates:[]}this.activities[t].loading=!1}),(e=>{this.activities[t].loading=!1}))}getMoreTimeLineData(t,e){if(!this.canLoadMore(t)||this.activities[t].loading)return(0,ye.of)(!0);let i=new W.x,s={start:this.activities[t].list.length,limit:e||this.defaultLimit,objects:JSON.stringify(this.filters.objectfilters),own:this.filters.own,searchterm:this.filters.searchterm};return this.activities[t].loadingmore=!0,this.backend.postRequest("module/"+t+"/fts/"+this.parent.module+"/"+this.parent.id,{},s).subscribe((e=>{for(let i of e.items)i.data=this.modelutilities.backendModel2spice(i.module,i.data),this.activities[t].list.push(i);this.activities[t].loadingmore=!1,i.next(!0),i.complete()}),(e=>{this.activities[t].loadingmore=!1,i.error(e),i.complete()})),i.asObservable()}resetListData(t){this.activities[t]={loading:!1,loadingmore:!1,list:[],totalcount:0}}canLoadMore(t){return this.activities[t].totalcount>this.activities[t].list.length&&!this.activities[t].loadingmore}sortListdata(t){this.activities[t].list.sort(((e,i)=>{let s=new moment(e.data[this.sortDates[e.module]]),n=new moment(i.data[this.sortDates[i.module]]);return"Activities"!==t?s.isBefore(n):s.isAfter(n)}))}}return activitiytimeline.ɵfac=function(t){return new(t||activitiytimeline)(r.LFG(x.Pu),r.LFG(re.y),r.LFG(A.A),r.LFG(be.C),r.LFG(ce.n),r.LFG(m.f))},activitiytimeline.ɵprov=r.Yz7({token:activitiytimeline,factory:activitiytimeline.ɵfac}),activitiytimeline})();var _e=i(6559),Ae=i(7017),Ze=i(7758),Te=i(9774);function ke(t,e){if(1&t&&(r.TgZ(0,"div",2)(1,"div",3),r._UZ(2,"system-icon",4),r.qZA(),r.TgZ(3,"div",5)(4,"div",6)(5,"h3",7)(6,"a",8),r._uU(7),r.qZA()()(),r.TgZ(8,"div",6)(9,"div",9)(10,"span",10)(11,"span",11),r._uU(12,"Progress: 25%"),r.qZA()()(),r.TgZ(13,"div",12),r._uU(14),r.qZA()()()()),2&t){const t=r.oxw();r.xp6(2),r.Q6J("icon",t.uploadData.fileIcon.icon)("sprite",t.uploadData.fileIcon.sprite),r.xp6(5),r.Oqu(t.uploadData.fileName),r.xp6(3),r.Q6J("ngStyle",t.progressBarStyle),r.xp6(4),r.hij(" ",t.uploadData.progress," % ")}}const Ce=["*"];let we=(()=>{class ActivityTimelineDropZoneWrapper{constructor(t,e,i,s,n,l,a,o){this.language=t,this.toast=e,this.configurationService=i,this.activitiytimeline=s,this.noteModel=n,this.model=l,this.session=a,this.helper=o,this.uploadData={fileName:"",fileIcon:{},uploading:!1,progress:void 0}}get maxSize(){return this.configurationService.getSystemParamater("upload_maxsize")}get progressBarStyle(){return{width:(this.uploadData.progress||0)+"%"}}handleDroppedFiles(t){let e=[],i=[],s=[];for(let n in t)t.hasOwnProperty(n)&&(this.fileSizeExceeded(t[n])?this.toast.sendToast(this.language.getLabelFormatted("LBL_EXCEEDS_MAX_UPLOADFILESIZE",[t[n].name,this.helper.humanFileSize(this.maxSize)]),"error"):".msg"==t[n].name.substring(t[n].name.length-4).toLowerCase()?e.push(t[n]):".eml"==t[n].name.substring(t[n].name.length-4).toLowerCase()?i.push(t[n]):s.push(t[n]));e.length>0&&(this.uploadData.uploading=!0,this.uploadFiles(e,this.model.module,this.model.id,"msg").subscribe((t=>{this.uploadData.fileName=t.fileName,this.uploadData.progress=t.progress,this.setFileIcon(t.fileName,t.fileType)}),(()=>{this.toast.sendToast(this.language.getLabel("ERR_UPLOAD_FAILED"),"error")}),(()=>{this.activitiytimeline.getTimeLineData("History"),this.uploadData.uploading=!1}))),i.length>0&&(this.uploadData.uploading=!0,this.uploadFiles(i,this.model.module,this.model.id,"eml").subscribe((t=>{this.uploadData.fileName=t.fileName,this.uploadData.progress=t.progress,this.setFileIcon(t.fileName,t.fileType)}),(()=>{this.toast.sendToast(this.language.getLabel("ERR_UPLOAD_FAILED"),"error")}),(()=>{this.activitiytimeline.getTimeLineData("History"),this.uploadData.uploading=!1}))),s.length>0&&this.addNotesFromFiles(s)}uploadFiles(t,e,i,s){if(0===t.length)return;let n=new W.x;for(let l of t)this.readFile(l).subscribe((()=>{let t=new XMLHttpRequest,a={};t.onreadystatechange=(i=this)=>{if(4==t.readyState)try{if("Notes"==e){let e=JSON.parse(t.response);n.next({progress:100,fileName:l.name,fileType:l.type,fileMD5:e[0].filemd5})}n.complete()}catch(e){a={status:"error",data:"Unknown error occurred: ["+t.responseText+"]"}}},t.upload.addEventListener("progress",(t=>{n.next({progress:Math.round(t.loaded/t.total*100),fileName:l.name,fileType:l.type,fileMD5:l.filemd5})}),!1);let o=this.configurationService.getBackendUrl()+"/common/spiceattachments";"Notes"!=e&&(o=this.configurationService.getBackendUrl()+"/module/Emails/"+s),t.open("POST",o,!0),t.setRequestHeader("OAuth-Token",this.session.authData.sessionId),t.setRequestHeader("Content-Type","application/json;charset=UTF-8");let d={file:l.filecontent,filename:l.name,filemimetype:l.type?l.type:"application/octet-stream",filemd5:void 0,beanId:i,beanModule:e};t.send(JSON.stringify(d))}));return n.asObservable()}readFile(t){let e=new W.x,i=new FileReader;return i.file=t,i.onloadend=()=>{let t=i.result.toString();t=t.substring(t.indexOf("base64,")+7);let s=i.file;s.filecontent=t,e.next(s),e.complete()},i.readAsDataURL(t),e.asObservable()}setFileIcon(t,e){if(e==this.uploadData.fileIcon.fileType)return;let i=this.helper.determineFileIcon(e);if("unknown"==i){"msg"==t.split(".").splice(-1,1)[0].toLowerCase()&&(this.uploadData.fileIcon={icon:"email",sprite:"standard",fileType:e})}this.uploadData.fileIcon={icon:i,sprite:"doctype",fileType:e}}addNotesFromFiles(t){this.addNewNote(t)}addNewNote(t,e=0){this.noteModel.reset(),this.noteModel.module="Notes",this.noteModel.initialize(this.activitiytimeline.parent),this.noteModel.startEdit(!1),this.noteModel.setField("name",t[e].name),this.noteModel.setField("file_name",t[e].name),this.noteModel.setField("file_mime_type",t[e].type?t[e].type:"application/octet-stream"),this.uploadData.uploading=!0,this.uploadFiles([t[e]],this.noteModel.module,this.noteModel.id).subscribe((t=>{this.uploadData.fileName=t.fileName,this.uploadData.progress=t.progress,this.setFileIcon(t.fileName,t.fileType),t.fileMD5&&this.noteModel.setField("file_md5",t.fileMD5)}),(()=>{this.toast.sendToast(this.language.getLabel("ERR_UPLOAD_FAILED"),"error")}),(()=>{this.noteModel.save().subscribe((i=>{e+1>=t.length?(this.activitiytimeline.getTimeLineData("History"),this.uploadData.uploading=!1):this.addNewNote(t,e+1)}))}))}fileSizeExceeded(t){return this.maxSize&&t.size>this.maxSize}}return ActivityTimelineDropZoneWrapper.ɵfac=function(t){return new(t||ActivityTimelineDropZoneWrapper)(r.Y36(f.d),r.Y36(it.A),r.Y36(be.C),r.Y36(xe),r.Y36(p.o),r.Y36(p.o,4),r.Y36(ce.n),r.Y36(B._))},ActivityTimelineDropZoneWrapper.ɵcmp=r.Xpm({type:ActivityTimelineDropZoneWrapper,selectors:[["activity-timeline-drop-zone-wrapper"]],features:[r._Bn([],[p.o])],ngContentSelectors:Ce,decls:3,vars:1,consts:[[3,"system-drop-file"],["class","slds-m-vertical--medium slds-media",4,"ngIf"],[1,"slds-m-vertical--medium","slds-media"],[1,"slds-m-right--x-small","slds-align--absolute-center",2,"width","30px","height","30px"],["divClass","","size","'small'",3,"icon","sprite"],[1,"slds-media__body"],[1,"slds-grid","slds-grid_vertical-align-center","slds-grid--align-spread","slds-has-flexi-truncate"],[1,"slds-truncate","slds-text-heading--x-small","slds-p-right--xxx-small"],["href","javascript:void(0);"],[1,"slds-progress-bar"],[1,"slds-progress-bar__value",3,"ngStyle"],[1,"slds-assistive-text"],[1,"slds-text-align--right",2,"width","50px"]],template:function(t,e){1&t&&(r.F$t(),r.TgZ(0,"div",0),r.NdJ("system-drop-file",(function(t){return e.handleDroppedFiles(t)})),r.YNc(1,ke,15,5,"div",1),r.Hsn(2),r.qZA()),2&t&&(r.xp6(1),r.Q6J("ngIf",e.uploadData.uploading))},dependencies:[s.O5,s.PC,Pt.f,Te.M],encapsulation:2}),ActivityTimelineDropZoneWrapper})();function Me(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"div",7)(1,"div",8),r.NdJ("click",(function(e){const i=r.CHM(t).$implicit,s=r.oxw();return r.KtG(s.setFilter(e,i.type))})),r.TgZ(2,"span",9),r._UZ(3,"input",36),r.TgZ(4,"label",37),r._UZ(5,"span",12),r.TgZ(6,"span",13),r._uU(7),r.qZA()()()()()}if(2&t){const t=e.$implicit,i=r.oxw();r.xp6(3),r.Q6J("id",t.type)("checked",i.getChecked(t.type)),r.xp6(1),r.uIk("for",t.type),r.xp6(3),r.Oqu(t.name)}}const Je=function(t){return{"slds-is-open":t}};let Ye=(()=>{class ActivityTimelineFilter{constructor(t,e,i,s,n){this.renderer=t,this.elementRef=e,this.language=i,this.metadata=s,this.activitiytimeline=n,this.isOpen=!1,this.activityTypes=[],this.objectfilters=[],this.ownerfilter="",this.setFromService()}setFromService(){this.objectfilters=JSON.parse(JSON.stringify(this.activitiytimeline.filters.objectfilters)),this.ownerfilter=this.activitiytimeline.filters.own}setToService(){this.activitiytimeline.filters.objectfilters=JSON.parse(JSON.stringify(this.objectfilters)),this.activitiytimeline.filters.own=this.ownerfilter,this.activitiytimeline.reload()}toggleOpen(t){t.stopPropagation(),this.isOpen=!this.isOpen,this.isOpen?this.clickListener=this.renderer.listen("document","click",(t=>this.onClick(t))):this.clickListener&&this.clickListener(),this.isOpen&&this.buildTypes()}onClick(t){this.elementRef.nativeElement.contains(t.target)||(this.isOpen=!1,this.clickListener())}buildTypes(){this.activityTypes=[];for(let t of this.activitiytimeline.filterObjects)this.activityTypes.push({type:t,name:this.language.getModuleName(t)});this.activityTypes.sort(((t,e)=>t.name>e.name?1:-1))}get filterColorClass(){return this.activitiytimeline.filters.objectfilters.length>0||this.activitiytimeline.filters.own?"slds-icon-text-error":"slds-icon-text-default"}setFilter(t,e){if(t.preventDefault(),"all"==e)this.objectfilters=[];else{let t=this.objectfilters.indexOf(e);t>=0?this.objectfilters.splice(t,1):this.objectfilters.push(e)}}getChecked(t){return"all"==t?0==this.objectfilters.length:this.objectfilters.indexOf(t)>=0}closeDialog(t){this.clickListener&&this.clickListener(),t?this.setToService():this.setFromService(),this.isOpen=!1}}return ActivityTimelineFilter.ɵfac=function(t){return new(t||ActivityTimelineFilter)(r.Y36(r.Qsj),r.Y36(r.SBq),r.Y36(f.d),r.Y36(x.Pu),r.Y36(xe))},ActivityTimelineFilter.ɵcmp=r.Xpm({type:ActivityTimelineFilter,selectors:[["activity-timeline-filter"]],decls:45,vars:10,consts:[[1,"slds-dropdown-trigger","slds-dropdown-trigger_click","slds-p-horizontal--xxx-small",3,"ngClass"],["icon","filterList","size","x-small",3,"colorclass","title","click"],[1,"slds-is-absolute","slds-dropdown","slds-dropdown_right","slds-nubbin_top-right",2,"right","-10px","top","25px"],[1,"slds-grid"],[1,"slds-p-horizontal--small","slds-border--right",2,"min-width","180px"],[1,"slds-p-vertical--x-small"],["label","LBL_TYPE"],[1,"slds-form-element","slds-p-vertical--xx-small"],[1,"slds-form-element__control",3,"click"],[1,"slds-checkbox"],["type","checkbox","id","alltypes",3,"checked"],["for","alltypes",1,"slds-checkbox__label"],[1,"slds-checkbox_faux"],[1,"slds-form-element__label"],["label","LBL_ALL"],["class","slds-form-element slds-p-vertical--xx-small",4,"ngFor","ngForOf"],[1,"slds-p-horizontal--small",2,"min-width","180px"],["label","LBL_FILTER"],[1,"slds-form-element"],[1,"slds-form-element__control"],[1,"slds-radio"],["type","radio","id","ownerall","name","filters","value","",3,"ngModel","ngModelChange"],["for","ownerall",1,"slds-radio__label"],[1,"slds-radio_faux"],["type","radio","id","ownerassignedtome","name","filters","value","assigned",3,"ngModel","ngModelChange"],["for","ownerassignedtome",1,"slds-radio__label"],[1,"slds-form-element__label","slds-truncate"],["label","LBL_ASSIGNEDTOME"],["type","radio","id","ownercreatedbyme","name","filters","value","created",3,"ngModel","ngModelChange"],["for","ownercreatedbyme",1,"slds-radio__label"],["label","LBL_CREATEDBYME"],[1,"slds-popover__footer"],[1,"slds-col--bump-left","slds-button","slds-button_neutral",3,"click"],["label","LBL_CANCEL"],[1,"slds-button","slds-button--brand",3,"click"],["label","LBL_APPLY"],["type","checkbox",3,"id","checked"],[1,"slds-checkbox__label"]],template:function(t,e){1&t&&(r.TgZ(0,"div",0)(1,"system-utility-icon",1),r.NdJ("click",(function(t){return e.toggleOpen(t)})),r.qZA(),r.TgZ(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),r._UZ(6,"system-label",6),r.qZA(),r.TgZ(7,"div",7)(8,"div",8),r.NdJ("click",(function(t){return e.setFilter(t,"all")})),r.TgZ(9,"span",9),r._UZ(10,"input",10),r.TgZ(11,"label",11),r._UZ(12,"span",12),r.TgZ(13,"span",13),r._UZ(14,"system-label",14),r.qZA()()()()(),r.YNc(15,Me,8,4,"div",15),r.qZA(),r.TgZ(16,"div",16)(17,"div",5),r._UZ(18,"system-label",17),r.qZA(),r.TgZ(19,"fieldset",18)(20,"div",19)(21,"span",20)(22,"input",21),r.NdJ("ngModelChange",(function(t){return e.ownerfilter=t})),r.qZA(),r.TgZ(23,"label",22),r._UZ(24,"span",23),r.TgZ(25,"span",13),r._UZ(26,"system-label",14),r.qZA()()(),r.TgZ(27,"span",20)(28,"input",24),r.NdJ("ngModelChange",(function(t){return e.ownerfilter=t})),r.qZA(),r.TgZ(29,"label",25),r._UZ(30,"span",23),r.TgZ(31,"span",26),r._UZ(32,"system-label",27),r.qZA()()(),r.TgZ(33,"span",20)(34,"input",28),r.NdJ("ngModelChange",(function(t){return e.ownerfilter=t})),r.qZA(),r.TgZ(35,"label",29),r._UZ(36,"span",23),r.TgZ(37,"span",26),r._UZ(38,"system-label",30),r.qZA()()()()()()(),r.TgZ(39,"footer",31)(40,"div",3)(41,"button",32),r.NdJ("click",(function(){return e.closeDialog(!1)})),r._UZ(42,"system-label",33),r.qZA(),r.TgZ(43,"button",34),r.NdJ("click",(function(){return e.closeDialog(!0)})),r._UZ(44,"system-label",35),r.qZA()()()()()),2&t&&(r.Q6J("ngClass",r.VKq(8,Je,e.isOpen)),r.xp6(1),r.Q6J("colorclass",e.filterColorClass)("title",e.language.getLabel("LBL_FILTER")),r.xp6(9),r.Q6J("checked",e.getChecked("all")),r.xp6(5),r.Q6J("ngForOf",e.activityTypes),r.xp6(7),r.Q6J("ngModel",e.ownerfilter),r.xp6(6),r.Q6J("ngModel",e.ownerfilter),r.xp6(6),r.Q6J("ngModel",e.ownerfilter))},dependencies:[s.mk,s.sg,n.Fj,n._,n.JJ,n.On,S._,zt.r],encapsulation:2}),ActivityTimelineFilter})();var Le=i(4730),Fe=i(9087),Se=i(243);function Ne(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"div",5),r.NdJ("click",(function(){const e=r.CHM(t).$implicit,i=r.oxw();return r.KtG(i.toggleModuleFilter(e.module))})),r.TgZ(1,"div",6),r._UZ(2,"system-icon",7),r.qZA(),r.TgZ(3,"div",6),r._uU(4),r.qZA(),r.TgZ(5,"div"),r._UZ(6,"system-label-modulename",8),r.qZA()()}if(2&t){const t=e.$implicit,i=r.oxw();r.Q6J("ngStyle",i.getElementStyle(t.module)),r.xp6(2),r.Q6J("title",i.language.getModuleName(t.module))("module",t.module),r.xp6(2),r.hij(" ",t.count," "),r.xp6(2),r.Q6J("module",t.module)("singular",1==t.count)}}function Ee(t,e){if(1&t&&(r.TgZ(0,"div",9)(1,"div",6),r._uU(2),r.qZA(),r.TgZ(3,"div"),r._uU(4),r.qZA()()),2&t){const t=e.$implicit;r.xp6(2),r.hij(" ",t.year,": "),r.xp6(2),r.hij(" ",t.count," ")}}let qe=(()=>{class ActivityTimelineAggregates{constructor(t,e,i){this.metadata=t,this.language=e,this.activitiytimeline=i,this.labellength="default"}get moduleaggregates(){return this.module&&this.activitiytimeline.activities[this.module].aggregates.module?this.activitiytimeline.activities[this.module].aggregates.module:[]}get yearaggregates(){return this.module&&this.activitiytimeline.activities[this.module].aggregates.year?this.activitiytimeline.activities[this.module].aggregates.year:[]}getElementStyle(t){if(!this.activitiytimeline.checkModuleActive(t))return{filter:"grayscale(100%)",opacity:"0.5"}}toggleModuleFilter(t){this.activitiytimeline.toggleModuleFilter(t),this.metadata.getModuleDefs(t).ftsactivities.Activities&&this.activitiytimeline.getTimeLineData("Activities"),this.metadata.getModuleDefs(t).ftsactivities.History&&this.activitiytimeline.getTimeLineData("History")}}return ActivityTimelineAggregates.ɵfac=function(t){return new(t||ActivityTimelineAggregates)(r.Y36(x.Pu),r.Y36(f.d),r.Y36(xe))},ActivityTimelineAggregates.ɵcmp=r.Xpm({type:ActivityTimelineAggregates,selectors:[["activity-timeline-aggregates"]],inputs:{module:"module",labellength:"labellength"},decls:5,vars:2,consts:[[1,"slds-grid","slds-box--border"],[1,"slds-size--1-of-2","slds-p-around--x-small","slds-border--right"],["class","slds-grid slds-grid--vertical-align-center slds-p-vertical--xxx-small slds-gutters_direct-xxx-small",3,"ngStyle","click",4,"ngFor","ngForOf"],[1,"slds-size--1-of-2","slds-p-around--x-small"],["class","slds-grid slds-grid--vertical-align-center slds-p-vertical--xxx-small slds-gutters_direct-xxx-small",4,"ngFor","ngForOf"],[1,"slds-grid","slds-grid--vertical-align-center","slds-p-vertical--xxx-small","slds-gutters_direct-xxx-small",3,"ngStyle","click"],[1,"slds-p-right--small"],["size","xx-small","divClass","slds-align--absolute-center",3,"title","module"],[3,"module","singular"],[1,"slds-grid","slds-grid--vertical-align-center","slds-p-vertical--xxx-small","slds-gutters_direct-xxx-small"]],template:function(t,e){1&t&&(r.TgZ(0,"div",0)(1,"div",1),r.YNc(2,Ne,7,6,"div",2),r.qZA(),r.TgZ(3,"div",3),r.YNc(4,Ee,5,2,"div",4),r.qZA()()),2&t&&(r.xp6(2),r.Q6J("ngForOf",e.moduleaggregates),r.xp6(2),r.Q6J("ngForOf",e.yearaggregates))},dependencies:[s.sg,s.PC,Pt.f,Wt.M],encapsulation:2}),ActivityTimelineAggregates})();function Ie(t,e){if(1&t&&(r.TgZ(0,"div",4),r._UZ(1,"activity-timeline-aggregates",5),r.qZA()),2&t){const t=r.oxw();r.xp6(1),r.Q6J("module",t.module)}}function Oe(t,e){if(1&t&&(r.TgZ(0,"li"),r._UZ(1,"activitytimeline-item-container",8),r.qZA()),2&t){const t=e.$implicit,i=r.oxw(2);r.xp6(1),r.Q6J("activity",t)("module",i.module)}}const Qe=function(t){return{"slds-hide":t}};function Ue(t,e){if(1&t&&(r.TgZ(0,"ul",6),r.YNc(1,Oe,2,2,"li",7),r.qZA()),2&t){const t=r.oxw();r.Q6J("ngClass",r.VKq(2,Qe,t.loading)),r.xp6(1),r.Q6J("ngForOf",t.activities)}}function De(t,e){1&t&&(r.TgZ(0,"ul",9)(1,"li"),r._UZ(2,"activitytimeline-stencil"),r.qZA(),r.TgZ(3,"li",10),r._UZ(4,"activitytimeline-stencil"),r.qZA(),r.TgZ(5,"li",11),r._UZ(6,"activitytimeline-stencil"),r.qZA()())}function Be(t,e){1&t&&(r.TgZ(0,"system-illustration-no-records"),r._UZ(1,"system-label",14),r.qZA())}function Pe(t,e){if(1&t&&(r.TgZ(0,"div",12),r.YNc(1,Be,2,0,"system-illustration-no-records",13),r.qZA()),2&t){const t=r.oxw();r.xp6(1),r.Q6J("ngIf",!t.loading)}}let ze=(()=>{class ActivityTimelineContainer{constructor(t,e){this.activitiytimeline=t,this.language=e,this.displayaggregates=!1}ngOnInit(){this.activitiytimeline.getTimeLineData(this.module)}get activities(){return this.activitiytimeline.activities[this.module].list}get hasActivities(){return this.activitiytimeline.activities[this.module].list.length>0}get loading(){return this.activitiytimeline.activities[this.module].loading}get loadingmore(){return this.activitiytimeline.activities[this.module].loadingmore}get hasAggregates(){try{return this.activitiytimeline.activities[this.module].aggregates.module.length>0}catch(t){return!1}}trackByFn(t,e){return e.id}}return ActivityTimelineContainer.ɵfac=function(t){return new(t||ActivityTimelineContainer)(r.Y36(xe),r.Y36(f.d))},ActivityTimelineContainer.ɵcmp=r.Xpm({type:ActivityTimelineContainer,selectors:[["activitytimeline-container"]],inputs:{module:"module",displayaggregates:"displayaggregates"},decls:5,vars:4,consts:[["class","slds-p-vertical--x-small slds-m-top--x-small",4,"ngIf"],["class","slds-timeline slds-p-vertical--small",3,"ngClass",4,"ngIf","ngIfElse"],["class","slds-timeline",4,"ngIf"],["nocontent",""],[1,"slds-p-vertical--x-small","slds-m-top--x-small"],["labellength","short",3,"module"],[1,"slds-timeline","slds-p-vertical--small",3,"ngClass"],[4,"ngFor","ngForOf"],[3,"activity","module"],[1,"slds-timeline"],[2,"opacity","0.6"],[2,"opacity","0.3"],[1,"slds-p-vertical--medium"],[4,"ngIf"],["label","LBL_NO_ENTRIES"]],template:function(t,e){if(1&t&&(r.YNc(0,Ie,2,1,"div",0),r.YNc(1,Ue,2,4,"ul",1),r.YNc(2,De,7,0,"ul",2),r.YNc(3,Pe,2,1,"ng-template",null,3,r.W1O)),2&t){const t=r.MAs(4);r.Q6J("ngIf",e.displayaggregates&&e.hasAggregates),r.xp6(1),r.Q6J("ngIf",e.hasActivities)("ngIfElse",t),r.xp6(1),r.Q6J("ngIf",e.loading||e.loadingmore)}},dependencies:[s.mk,s.sg,s.O5,Le.C,S._,Fe.d,Se.g,qe],encapsulation:2}),ActivityTimelineContainer})();var je=i(2995);const He=["moretab"],Re=["maintabs"],Ge=["moretabs"],Ke=function(t){return{"slds-active":t}};function Ve(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"li",13,14)(2,"a",15),r.NdJ("click",(function(){const e=r.CHM(t).$implicit,i=r.oxw();return r.KtG(i.setTab(e.module))})),r._UZ(3,"system-label-modulename",16),r.qZA()()}if(2&t){const t=e.$implicit,i=r.oxw();r.Q6J("ngClass",r.VKq(4,Ke,i.checkTab(t.module))),r.uIk("data-module",t.module),r.xp6(3),r.Q6J("module",t.module)("singular",!0)}}const $e=function(t){return{"slds-hidden":t}};function Xe(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"li",17,18),r.NdJ("click",(function(){const e=r.CHM(t).$implicit,i=r.oxw();return r.KtG(i.setTab(e.module))})),r.TgZ(2,"a",19)(3,"span",20),r._UZ(4,"system-utility-icon",21)(5,"system-label-modulename",16),r.qZA()()()}if(2&t){const t=e.$implicit,i=r.oxw();r.uIk("data-module",t.module),r.xp6(4),r.Q6J("ngClass",r.VKq(4,$e,!i.checkTab(t.module))),r.xp6(1),r.Q6J("module",t.module)("singular",!0)}}function We(t,e){if(1&t&&(r.TgZ(0,"div",22),r._UZ(1,"system-dynamic-component",23),r.qZA()),2&t){const t=e.$implicit,i=r.oxw();r.Q6J("ngClass",i.tabClass(t))("hidden",!i.checkTab(t.module)),r.xp6(1),r.Q6J("component",t.component)("componentconfig",t.componentconfig)}}function ti(t,e){1&t&&(r.TgZ(0,"div",24),r._uU(1,"no actions configured"),r.qZA())}function ei(t,e){1&t&&r.YNc(0,ti,2,0,"ng-template")}const ii=function(t){return{"slds-hide":t}},si=function(t,e){return{"slds-is-open":t,"slds-active":e}};let ni=(()=>{class ActivityTimelineAddContainer{constructor(t,e,i,s,n,l){this.model=t,this.language=e,this.activitiytimeline=i,this.metadata=s,this.elementRef=n,this.renderer=l,this.currenttab="",this.tabs=[],this.moreOpen=!1,this.moreModules=[],this.resizeListener=this.renderer.listen("window","resize",(t=>{this.handleOverflow()}))}ngOnInit(){let t=this.metadata.getComponentConfig("ActivityTimelineAddContainer",this.model.module);if(t&&t.componentset){let e=this.metadata.getComponentSetObjects(t.componentset);for(let t of e)t.componentconfig.module&&this.metadata.checkModuleAcl(t.componentconfig.module,"create")&&this.tabs.push({module:t.componentconfig.module,component:t.component,componentconfig:t.componentconfig});this.currenttab=this.tabs[0].module}else t&&t.tabs&&t.tabs.length>0&&(this.tabs=t.tabs,this.currenttab=t.tabs[0].module)}ngAfterViewInit(){this.handleOverflow()}ngOnDestroy(){this.resizeListener()}handleOverflow(){this.moreModules=[],this.maintabs.forEach((t=>{t.element.nativeElement.classList.remove("slds-hide"),t.element.nativeElement.classList.add("slds-hidden")})),this.moretab.element.nativeElement.classList.add("slds-hidden"),this.moretab.element.nativeElement.classList.remove("slds-hide");let t=this.elementRef.nativeElement.getBoundingClientRect().width,e=this.moretab.element.nativeElement.getBoundingClientRect().width,i=!1,s=0;this.maintabs.forEach(((n,l)=>{let a=n.element.nativeElement.getBoundingClientRect().width;s+=a,s>t-e&&(i||l+1<this.maintabs.length||a>e)&&(n.element.nativeElement.classList.add("slds-hide"),this.moreModules.push(n.element.nativeElement.attributes.getNamedItem("data-module").value),i=!0),n.element.nativeElement.classList.remove("slds-hidden")})),i?(this.moretab.element.nativeElement.classList.remove("slds-hidden"),this.moretabs.forEach((t=>{this.moreModules.indexOf(t.element.nativeElement.attributes.getNamedItem("data-module").value)>=0?t.element.nativeElement.classList.remove("slds-hide"):t.element.nativeElement.classList.add("slds-hide")}))):(this.moretab.element.nativeElement.classList.remove("slds-hidden"),this.moretab.element.nativeElement.classList.add("slds-hide"))}setTab(t){this.currenttab=t}checkTab(t){return this.currenttab==t}get moreactive(){return this.moreModules.indexOf(this.currenttab)>=0}tabClass(t){return this.currenttab==t.module?"slds-show":"slds-hide"}toggleOpen(){this.moreOpen=!this.moreOpen}}return ActivityTimelineAddContainer.ɵfac=function(t){return new(t||ActivityTimelineAddContainer)(r.Y36(p.o),r.Y36(f.d),r.Y36(xe),r.Y36(x.Pu),r.Y36(r.SBq),r.Y36(r.Qsj))},ActivityTimelineAddContainer.ɵcmp=r.Xpm({type:ActivityTimelineAddContainer,selectors:[["activitytimeline-add-container"]],viewQuery:function(t,e){if(1&t&&(r.Gf(He,5,r.s_b),r.Gf(Re,5,r.s_b),r.Gf(Ge,5,r.s_b)),2&t){let t;r.iGM(t=r.CRH())&&(e.moretab=t.first),r.iGM(t=r.CRH())&&(e.maintabs=t),r.iGM(t=r.CRH())&&(e.moretabs=t)}},decls:13,vars:11,consts:[[1,"slds-tabs--scoped",3,"ngClass"],["role","tablist",1,"slds-tabs--scoped__nav"],["class","slds-tabs--scoped__item","role","presentation",3,"ngClass",4,"ngFor","ngForOf"],["role","presentation",1,"slds-tabs_scoped__item","slds-tabs_scoped__overflow-button","slds-dropdown-trigger","slds-dropdown-trigger_click",3,"ngClass","click"],["moretab",""],["href","javascript:void(0);","role","tab",1,"slds-tabs--scoped__link"],["label","LBL_MORE"],["icon","down","size","x-small",1,"slds-p-horizontal--xx-small"],[1,"slds-dropdown","slds-dropdown_right"],["role","menu",1,"slds-dropdown__list","slds-dropdown_length-with-icon-10"],["class","slds-dropdown__item","role","presentation",3,"click",4,"ngFor","ngForOf"],["class","slds-tabs--scoped__content slds-p-around--none","role","tabpanel",3,"ngClass","hidden",4,"ngFor","ngForOf"],[4,"ngIf"],["role","presentation",1,"slds-tabs--scoped__item",3,"ngClass"],["maintabs",""],["href","javascript:void(0);","role","tab",1,"slds-tabs--scoped__link",3,"click"],[3,"module","singular"],["role","presentation",1,"slds-dropdown__item",3,"click"],["moretabs",""],["href","javascript:void(0);","role","menuitem"],[1,"slds-truncate"],["icon","check","size","x-small",1,"slds-p-right--xx-small",3,"ngClass"],["role","tabpanel",1,"slds-tabs--scoped__content","slds-p-around--none",3,"ngClass","hidden"],[3,"component","componentconfig"],[1,"slds-box","slds-theme--shade","slds-align--absolute-center"]],template:function(t,e){1&t&&(r.TgZ(0,"div",0)(1,"ul",1),r.YNc(2,Ve,4,6,"li",2),r.TgZ(3,"li",3,4),r.NdJ("click",(function(){return e.toggleOpen()})),r.TgZ(5,"a",5),r._UZ(6,"system-label",6)(7,"system-utility-icon",7),r.qZA(),r.TgZ(8,"div",8)(9,"ul",9),r.YNc(10,Xe,6,6,"li",10),r.qZA()()()(),r.YNc(11,We,2,4,"div",11),r.qZA(),r.YNc(12,ei,1,0,null,12)),2&t&&(r.Q6J("ngClass",r.VKq(6,ii,0==e.tabs.length)),r.xp6(2),r.Q6J("ngForOf",e.tabs),r.xp6(1),r.Q6J("ngClass",r.WLB(8,si,e.moreOpen,e.moreactive)),r.xp6(7),r.Q6J("ngForOf",e.tabs),r.xp6(1),r.Q6J("ngForOf",e.tabs),r.xp6(1),r.Q6J("ngIf",0==e.tabs.length))},dependencies:[s.mk,s.sg,s.O5,je.T,S._,Wt.M,zt.r],encapsulation:2}),ActivityTimelineAddContainer})(),li=(()=>{class ActivityTimelineSummaryButton{constructor(t,e,i,s){this.model=t,this.language=e,this.router=i,this.navigationtab=s}displaySummary(){let t="";this.navigationtab?.tabid&&(t="/tab/"+this.navigationtab.tabid),this.router.navigate([t+"/module/"+this.model.module+"/historysummary/"+this.model.id])}}return ActivityTimelineSummaryButton.ɵfac=function(t){return new(t||ActivityTimelineSummaryButton)(r.Y36(p.o),r.Y36(f.d),r.Y36(et.F0),r.Y36(Ae.d,8))},ActivityTimelineSummaryButton.ɵcmp=r.Xpm({type:ActivityTimelineSummaryButton,selectors:[["activitytimeline-summary-button"]],decls:2,vars:0,consts:[["type","button",1,"slds-button","slds-button--neutral","slds-is-absolute",2,"right",".5rem","top","-3px",3,"click"],["label","LBL_SUMMARY"]],template:function(t,e){1&t&&(r.TgZ(0,"button",0),r.NdJ("click",(function(){return e.displaySummary()})),r._UZ(1,"system-label",1),r.qZA())},dependencies:[S._],encapsulation:2}),ActivityTimelineSummaryButton})();function ai(t,e){1&t&&r._UZ(0,"activitytimeline-add-container")}function oi(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"system-input-delayed",19),r.NdJ("ngModelChange",(function(e){r.CHM(t);const i=r.oxw();return r.KtG(i.ftsSearchTerm=e)})),r.qZA()}if(2&t){const t=r.oxw();r.Q6J("placeholder",t.language.getLabel("LBL_SEARCH"))("ngModel",t.ftsSearchTerm)}}function di(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"system-utility-icon",23),r.NdJ("click",(function(e){r.CHM(t);const i=r.oxw(2);return r.KtG(i.toggleAggregates("Activities",e))})),r.qZA()}if(2&t){const t=r.oxw(2);r.Q6J("icon",t.displayaggregates.Activities?"up":"down")}}function ci(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"button",24),r.NdJ("click",(function(){r.CHM(t);const e=r.oxw(2);return r.KtG(e.loadMore("Activities"))})),r.TgZ(1,"span"),r._UZ(2,"system-label",25),r.qZA()()}}function ri(t,e){if(1&t&&(r.ynx(0),r.TgZ(1,"div",11)(2,"div",12)(3,"span"),r._uU(4),r.qZA(),r.TgZ(5,"span",13),r._UZ(6,"system-label",20),r.qZA(),r.YNc(7,di,1,1,"system-utility-icon",15),r.qZA(),r.YNc(8,ci,3,0,"button",21),r.qZA(),r._UZ(9,"activitytimeline-container",22),r.BQk()),2&t){const t=r.oxw();r.xp6(4),r.Oqu(t.activitiytimeline.activities.Activities.totalcount),r.xp6(3),r.Q6J("ngIf",t.activitiytimeline.usefts&&t.activitiytimeline.activities.Activities.totalcount>0),r.xp6(1),r.Q6J("ngIf",t.activitiytimeline.canLoadMore("Activities")),r.xp6(1),r.Q6J("displayaggregates",t.displayaggregates.Activities)}}function mi(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"system-utility-icon",23),r.NdJ("click",(function(e){r.CHM(t);const i=r.oxw();return r.KtG(i.toggleAggregates("History",e))})),r.qZA()}if(2&t){const t=r.oxw();r.Q6J("icon",t.displayaggregates.History?"up":"down")}}function ui(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"button",26),r.NdJ("click",(function(){r.CHM(t);const e=r.oxw();return r.KtG(e.loadMore("History"))})),r.TgZ(1,"span"),r._UZ(2,"system-label",25),r.qZA()()}}let pi=(()=>{class ActivityTimeline{constructor(t,e,i,s,n,l,a,o,d){this.model=t,this.router=e,this.language=i,this.activitiytimeline=s,this.metadata=n,this.utils=l,this.layout=a,this.navigationtab=o,this.injector=d,this.componentconfig={},this.displayaggregates={Activities:!1,History:!1}}ngOnInit(){this.activitiytimeline.parent=this.model,this.componentconfig.usefts&&(this.activitiytimeline.usefts=!0),this.componentconfig.defaultentries&&(this.activitiytimeline.defaultLimit=this.componentconfig.defaultentries)}get ftsSearchTerm(){return this.activitiytimeline.filters.searchterm}set ftsSearchTerm(t){this.activitiytimeline.filters.searchterm=t,this.activitiytimeline.reload()}get displayAddContainer(){return!this.componentconfig.hideaddcontainer}get displayActivitiesContainer(){return!this.componentconfig.hideactivitiescontainer}ngOnDestroy(){this.activitiytimeline.stopSubscriptions()}reload(){this.displayActivitiesContainer&&this.activitiytimeline.getTimeLineData("Activities"),this.activitiytimeline.getTimeLineData("History")}toggleAggregates(t,e){e.stopPropagation(),this.displayaggregates[t]=!this.displayaggregates[t]}loadMore(t){this.activitiytimeline.getMoreTimeLineData(t,this.componentconfig.defaultentries)}toggleOpen(){this.activitiytimeline.openness=!this.activitiytimeline.openness}get isSmall(){return"small"==this.layout.screenwidth}}return ActivityTimeline.ɵfac=function(t){return new(t||ActivityTimeline)(r.Y36(p.o),r.Y36(et.F0),r.Y36(f.d),r.Y36(xe),r.Y36(x.Pu),r.Y36(A.A),r.Y36(_e.b),r.Y36(Ae.d,8),r.Y36(r.zs3))},ActivityTimeline.ɵcmp=r.Xpm({type:ActivityTimeline,selectors:[["ng-component"]],features:[r._Bn([xe])],decls:26,vars:10,consts:[[4,"ngIf"],[1,"slds-grid","slds-grid--align-spread","slds-p-top--small","slds-grid--vertical-align-center"],[1,"slds-grid","slds-grid--vertical-align-center"],[1,"slds-p-vertical--xx-small","slds-text-heading--small"],["label","LBL_ACTIVITIES"],["delay","1000","class","slds-p-horizontal--xx-small",3,"placeholder","ngModel","ngModelChange",4,"ngIf"],[1,"slds-p-horizontal--xxx-small"],[1,"slds-button","slds-button--icon",3,"title","click"],["icon","refresh",1,"slds-p-horizontal--xxx-small","slds-icon-text-default"],[1,"slds-p-horizontal--xxx-small",3,"icon"],[1,"slds-p-top--x-small","activities-activity"],[1,"slds-is-relative","spiceActivitiyTimelineHeader"],[1,"slds-p-vertical--xx-small","slds-text-heading--x-small"],[1,"slds-p-horizontal--xx-small"],["label","LBL_PAST_ACTIVITIES"],["size","x-small",3,"icon","click",4,"ngIf"],["module","History",3,"displayaggregates"],[1,"slds-grid","slds-grid_align-end"],["class","slds-button slds-button--neutral","type","button",3,"click",4,"ngIf"],["delay","1000",1,"slds-p-horizontal--xx-small",3,"placeholder","ngModel","ngModelChange"],["label","LBL_NEXT_STEPS"],["class","slds-button slds-button--neutral slds-is-absolute","style","right:.5rem; top:-3px;","type","button",3,"click",4,"ngIf"],["module","Activities",3,"displayaggregates"],["size","x-small",3,"icon","click"],["type","button",1,"slds-button","slds-button--neutral","slds-is-absolute",2,"right",".5rem","top","-3px",3,"click"],["label","LBL_MORE"],["type","button",1,"slds-button","slds-button--neutral",3,"click"]],template:function(t,e){1&t&&(r.YNc(0,ai,1,0,"activitytimeline-add-container",0),r.TgZ(1,"div",1)(2,"div",2)(3,"div",3),r._UZ(4,"system-label",4),r.qZA()(),r.TgZ(5,"div",2),r.YNc(6,oi,1,2,"system-input-delayed",5),r._UZ(7,"activity-timeline-filter",6),r.TgZ(8,"button",7),r.NdJ("click",(function(){return e.reload()})),r._UZ(9,"system-button-icon",8),r.qZA(),r.TgZ(10,"button",7),r.NdJ("click",(function(){return e.toggleOpen()})),r._UZ(11,"system-button-icon",9),r.qZA()()(),r.TgZ(12,"div",10),r.YNc(13,ri,10,4,"ng-container",0),r.TgZ(14,"div",11)(15,"div",12)(16,"span"),r._uU(17),r.qZA(),r.TgZ(18,"span",13),r._UZ(19,"system-label",14),r.qZA(),r.YNc(20,mi,1,1,"system-utility-icon",15),r.qZA(),r._UZ(21,"activitytimeline-summary-button"),r.qZA(),r.TgZ(22,"activity-timeline-drop-zone-wrapper"),r._UZ(23,"activitytimeline-container",16),r.qZA(),r.TgZ(24,"div",17),r.YNc(25,ui,3,0,"button",18),r.qZA()()),2&t&&(r.Q6J("ngIf",e.displayAddContainer),r.xp6(6),r.Q6J("ngIf",e.activitiytimeline.usefts),r.xp6(2),r.Q6J("title",e.language.getLabel("LBL_RELOAD")),r.xp6(2),r.Q6J("title",e.language.getLabel("LBL_OPEN_ALL")),r.xp6(1),r.Q6J("icon",e.activitiytimeline.openness?"chevronup":"chevrondown"),r.xp6(2),r.Q6J("ngIf",e.displayActivitiesContainer),r.xp6(4),r.Oqu(e.activitiytimeline.activities.History.totalcount),r.xp6(3),r.Q6J("ngIf",e.activitiytimeline.usefts&&e.activitiytimeline.activities.History.totalcount>0),r.xp6(3),r.Q6J("displayaggregates",e.displayaggregates.History),r.xp6(2),r.Q6J("ngIf",e.activitiytimeline.canLoadMore("History")))},dependencies:[s.O5,n.JJ,n.On,R.J,Ze.y,S._,zt.r,we,Ye,ze,ni,li],encapsulation:2}),ActivityTimeline})();var gi=i(323);function hi(t,e){1&t&&r._UZ(0,"activitytimeline-add-container")}function fi(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"system-input-delayed",22),r.NdJ("ngModelChange",(function(e){r.CHM(t);const i=r.oxw(2);return r.KtG(i.ftsSearchTerm=e)})),r.qZA()}if(2&t){const t=r.oxw(2);r.Q6J("placeholder",t.language.getLabel("LBL_SEARCH"))("ngModel",t.ftsSearchTerm)}}function vi(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"div",15),r.YNc(1,fi,1,2,"system-input-delayed",16),r._UZ(2,"activity-timeline-filter",17),r.TgZ(3,"button",18),r.NdJ("click",(function(){r.CHM(t);const e=r.oxw();return r.KtG(e.reload())})),r._UZ(4,"system-button-icon",19),r.qZA(),r.TgZ(5,"button",18),r.NdJ("click",(function(){r.CHM(t);const e=r.oxw();return r.KtG(e.displaySummary())})),r._UZ(6,"system-button-icon",20),r.qZA(),r.TgZ(7,"button",18),r.NdJ("click",(function(){r.CHM(t);const e=r.oxw();return r.KtG(e.toggleOpen())})),r._UZ(8,"system-button-icon",21),r.qZA()()}if(2&t){const t=r.oxw();r.xp6(1),r.Q6J("ngIf",t.activitiytimeline.usefts),r.xp6(2),r.Q6J("title",t.language.getLabel("LBL_RELOAD")),r.xp6(2),r.Q6J("title",t.language.getLabel("LBL_SUMMARY")),r.xp6(2),r.Q6J("title",t.language.getLabel("LBL_OPEN_ALL")),r.xp6(1),r.Q6J("icon",t.activitiytimeline.openness?"chevronup":"chevrondown")}}function yi(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"system-input-delayed",25),r.NdJ("ngModelChange",(function(e){r.CHM(t);const i=r.oxw(2);return r.KtG(i.ftsSearchTerm=e)})),r.qZA()}if(2&t){const t=r.oxw(2);r.Q6J("placeholder",t.language.getLabel("LBL_SEARCH"))("ngModel",t.ftsSearchTerm)}}function bi(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"li",23)(1,"div",3),r.YNc(2,yi,1,2,"system-input-delayed",24),r._UZ(3,"activity-timeline-filter",17),r.TgZ(4,"button",18),r.NdJ("click",(function(){r.CHM(t);const e=r.oxw();return r.KtG(e.reload())})),r._UZ(5,"system-button-icon",19),r.qZA(),r.TgZ(6,"button",18),r.NdJ("click",(function(){r.CHM(t);const e=r.oxw();return r.KtG(e.displaySummary())})),r._UZ(7,"system-button-icon",20),r.qZA(),r.TgZ(8,"button",18),r.NdJ("click",(function(){r.CHM(t);const e=r.oxw();return r.KtG(e.toggleOpen())})),r._UZ(9,"system-button-icon",21),r.qZA()()()}if(2&t){const t=r.oxw();r.xp6(2),r.Q6J("ngIf",t.activitiytimeline.usefts),r.xp6(2),r.Q6J("title",t.language.getLabel("LBL_RELOAD")),r.xp6(2),r.Q6J("title",t.language.getLabel("LBL_SUMMARY")),r.xp6(2),r.Q6J("title",t.language.getLabel("LBL_OPEN_ALL")),r.xp6(1),r.Q6J("icon",t.activitiytimeline.openness?"chevronup":"chevrondown")}}function xi(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"button",26),r.NdJ("click",(function(){r.CHM(t);const e=r.oxw();return r.KtG(e.loadMore("History"))})),r.TgZ(1,"span"),r._UZ(2,"system-label",27),r.qZA()()}}function _i(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"button",26),r.NdJ("click",(function(){r.CHM(t);const e=r.oxw();return r.KtG(e.loadMore("Activities"))})),r.TgZ(1,"span"),r._UZ(2,"system-label",27),r.qZA()()}}const Ai=function(t){return{"slds-is-active":t}},Zi=function(t){return{"slds-hide":t}};let Ti=(()=>{class ActivityTimelineTabbed extends pi{constructor(){super(...arguments),this.activetab="history"}displaySummary(){let t="";this.navigationtab?.tabid&&(t="/tab/"+this.navigationtab.tabid),this.router.navigate([t+"/module/"+this.model.module+"/historysummary/"+this.model.id])}}return ActivityTimelineTabbed.ɵfac=function(){let t;return function(e){return(t||(t=r.n5z(ActivityTimelineTabbed)))(e||ActivityTimelineTabbed)}}(),ActivityTimelineTabbed.ɵcmp=r.Xpm({type:ActivityTimelineTabbed,selectors:[["ng-component"]],features:[r._Bn([xe,gi.H]),r.qOj],decls:23,vars:20,consts:[[4,"ngIf"],[1,"slds-tabs_default"],["class","slds-grid slds-grid--vertical-align-center slds-p-top--x-small",4,"ngIf"],[1,"slds-grid","slds-grid--vertical-align-center"],["role","tablist",1,"slds-tabs_default__nav","slds-grow"],["role","presentation",1,"slds-tabs_default__item",3,"ngClass"],["href","javascript:void(0);","role","tab",1,"slds-tabs_default__link",3,"click"],["label","LBL_PAST_ACTIVITIES"],["label","LBL_NEXT_STEPS"],["class","slds-col--bump-left slds-p-vertical--xx-small",4,"ngIf"],["role","tabpanel",1,"slds-tabs_default__content","slds-p-top--xxx-small",3,"ngClass"],["module","History",3,"displayaggregates"],[1,"slds-align--absolute-center"],["class","slds-button slds-button--neutral","type","button",3,"click",4,"ngIf"],["module","Activities"],[1,"slds-grid","slds-grid--vertical-align-center","slds-p-top--x-small"],["delay","1000","class","slds-p-horizontal--xx-small slds-grow",3,"placeholder","ngModel","ngModelChange",4,"ngIf"],[1,"slds-p-horizontal--xxx-small"],[1,"slds-button","slds-button--icon",3,"title","click"],["icon","refresh",1,"slds-p-horizontal--xxx-small","slds-icon-text-default"],["icon","side_list",1,"slds-p-horizontal--xxx-small"],[1,"slds-p-horizontal--xxx-small",3,"icon"],["delay","1000",1,"slds-p-horizontal--xx-small","slds-grow",3,"placeholder","ngModel","ngModelChange"],[1,"slds-col--bump-left","slds-p-vertical--xx-small"],["delay","1000","class","slds-p-horizontal--xx-small",3,"placeholder","ngModel","ngModelChange",4,"ngIf"],["delay","1000",1,"slds-p-horizontal--xx-small",3,"placeholder","ngModel","ngModelChange"],["type","button",1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_MORE"]],template:function(t,e){1&t&&(r.YNc(0,hi,1,0,"activitytimeline-add-container",0),r.TgZ(1,"div",1),r.YNc(2,vi,9,5,"div",2),r.TgZ(3,"div",3)(4,"ul",4)(5,"li",5)(6,"a",6),r.NdJ("click",(function(){return e.activetab="history"})),r._UZ(7,"system-label",7),r._uU(8),r.qZA()(),r.TgZ(9,"li",5)(10,"a",6),r.NdJ("click",(function(){return e.activetab="planned"})),r._UZ(11,"system-label",8),r._uU(12),r.qZA()(),r.YNc(13,bi,10,5,"li",9),r.qZA()(),r.TgZ(14,"div",10)(15,"activity-timeline-drop-zone-wrapper"),r._UZ(16,"activitytimeline-container",11),r.qZA(),r.TgZ(17,"div",12),r.YNc(18,xi,3,0,"button",13),r.qZA()(),r.TgZ(19,"div",10),r._UZ(20,"activitytimeline-container",14),r.TgZ(21,"div",12),r.YNc(22,_i,3,0,"button",13),r.qZA()()()),2&t&&(r.Q6J("ngIf",e.displayAddContainer),r.xp6(2),r.Q6J("ngIf",e.isSmall),r.xp6(3),r.Q6J("ngClass",r.VKq(12,Ai,"history"==e.activetab)),r.xp6(3),r.hij(" (",e.activitiytimeline.activities.History.totalcount,")"),r.xp6(1),r.Q6J("ngClass",r.VKq(14,Ai,"planned"==e.activetab)),r.xp6(3),r.hij(" (",e.activitiytimeline.activities.Activities.totalcount,")"),r.xp6(1),r.Q6J("ngIf",!e.isSmall),r.xp6(1),r.Q6J("ngClass",r.VKq(16,Zi,"history"!=e.activetab)),r.xp6(2),r.Q6J("displayaggregates",!1),r.xp6(2),r.Q6J("ngIf",e.activitiytimeline.canLoadMore("History")),r.xp6(1),r.Q6J("ngClass",r.VKq(18,Zi,"planned"!=e.activetab)),r.xp6(3),r.Q6J("ngIf",e.activitiytimeline.canLoadMore("Activities")))},dependencies:[s.mk,s.O5,n.JJ,n.On,R.J,Ze.y,S._,we,Ye,ze,ni],encapsulation:2}),ActivityTimelineTabbed})();var ki=i(586),Ci=i(9062),wi=i(5931),Mi=i(3814);function Ji(t,e){1&t&&r._UZ(0,"system-dynamic-component",23)}function Yi(t,e){if(1&t&&(r.TgZ(0,"div",21),r.YNc(1,Ji,1,0,"system-dynamic-component",22),r.qZA()),2&t){const t=r.oxw();r.xp6(1),r.Q6J("ngIf",t.displayattachments)}}function Li(t,e){if(1&t&&r._UZ(0,"object-record-fieldset-horizontal-list",24),2&t){const t=r.oxw();r.Q6J("fieldset",t.headerFieldSet)}}function Fi(t,e){if(1&t&&(r.TgZ(0,"div",25),r._uU(1),r.qZA()),2&t){const t=r.oxw();r.xp6(1),r.Oqu(t.subject)}}function Si(t,e){if(1&t&&r._UZ(0,"object-action-menu",26),2&t){const t=r.oxw();r.Q6J("buttonsize","x-small")("actionset",t.actionset)}}function Ni(t,e){if(1&t&&r._UZ(0,"object-record-fieldset-horizontal-list",24),2&t){const t=r.oxw();r.Q6J("fieldset",t.subheaderFieldSet)}}function Ei(t,e){1&t&&r._UZ(0,"system-dynamic-component",30)}function qi(t,e){if(1&t&&(r.TgZ(0,"article",27),r._UZ(1,"object-record-fieldset",28),r.YNc(2,Ei,1,0,"system-dynamic-component",29),r.qZA()),2&t){const t=r.oxw();r.xp6(1),r.Q6J("fieldset",t.formFieldSet),r.xp6(1),r.Q6J("ngIf",t.hasattachments)}}function Ii(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"object-action-menu",31),r.NdJ("actionemitter",(function(e){r.CHM(t);const i=r.oxw();return r.KtG(i.handleAction(e))})),r.qZA()}if(2&t){const t=r.oxw();r.Q6J("buttonsize","x-small")("actionset",t.actionset)}}const Oi=function(t){return{"slds-is-open":t}},Qi=function(t){return{"slds-hidden":t}},Ui=function(){return{displayLabels:!1}},Di=function(t,e){return{"slds-theme--error":t,"slds-theme--warning":e}};let Bi=(()=>{class ActivityTimelineItem{constructor(t,e,i,s,n,l,a,o,d){this.model=t,this.modelattachments=e,this.metadata=i,this.view=s,this.userpreferences=n,this.session=l,this.language=a,this.activitiytimeline=o,this.cdref=d,this.activity={},this.showtoolset=!0,this.formFieldSet="",this.isopen=!1,this.componentconfig={},this.subscriptions=new j.w0,this.view.isEditable=!1,this.view.displayLabels=!0,this.isopen=!!o&&o.openness}ngOnInit(){this.model.id=this.activity.id,this.model.setData(this.activity.data),this.model.module=this.activity.module,this.displayattachments&&(this.modelattachments.module=this.model.module,this.modelattachments.id=this.model.id);let t=this.metadata.getComponentConfig("ActivityTimelineItem",this.model.module);this.headerFieldSet=this.componentconfig.headerfieldset?this.componentconfig.headerfieldset:t.headerfieldset,this.subheaderFieldSet=this.componentconfig.subheaderfieldset?this.componentconfig.subheaderfieldset:t.subheaderfieldset,this.formFieldSet=this.componentconfig.fieldset}ngAfterViewInit(){this.activitiytimeline&&this.subscriptions.add(this.activitiytimeline.openness$.subscribe((t=>{this.isopen=t,this.cdref.detectChanges()}))),this.subscriptions.add(this.modelattachments.loaded$.subscribe((t=>{this.cdref.detectChanges()})))}ngOnDestroy(){this.subscriptions.unsubscribe()}get actionset(){return this.componentconfig.actionset}get displayattachments(){return this.componentconfig.displayattachments}get hasattachments(){return this.componentconfig.displayattachments&&this.modelattachments.count>0}attachmentsloaded(){this.cdref.detectChanges()}get subject(){let t=this.model.getField("summary_text");return t||"-- no subject --"}get starttime(){let t=new moment.utc(this.activity.date_activity).tz(this.session.getSessionData("timezone")||moment.tz.guess(!0));return t?t.format(this.userpreferences.getTimeFormat()):""}get startdate(){let t=new moment.utc(this.activity.date_activity).tz(this.session.getSessionData("timezone")||moment.tz.guess(!0));return t?t.format(this.userpreferences.getDateFormat()):""}get activitiyDate(){const t=new moment.utc(this.activity.date_activity).tz(this.session.getSessionData("timezone")||moment.tz.guess(!0)),e=t.format("YYYYMMDD")==(new moment).format("YYYYMMDD"),i=t.format("YYYY")==(new moment).format("YYYY");return e?t.format(this.userpreferences.getTimeFormat()):i?t.format("MMM D"):t.format(this.userpreferences.getDateFormat())}get isToday(){let t=(new moment.utc).tz(this.session.getSessionData("timezone"));return"Activities"==this.module&&new moment.utc(this.activity.date_activity).tz(this.session.getSessionData("timezone")).isSame(t,"day")}get isPast(){let t=(new moment.utc).tz(this.session.getSessionData("timezone"));return"Activities"==this.module&&new moment.utc(this.activity.date_activity).tz(this.session.getSessionData("timezone")).isBefore(t,"day")}get cantexpand(){return!this.formFieldSet}get enableDetail(){return this.model.checkAccess("detail")}handleAction(t){this.cdref.detectChanges()}goDetail(){this.enableDetail&&this.model.goDetail()}toggleexpand(){this.isopen=!this.isopen,this.isopen&&this.componentconfig.displayattachments&&!this.modelattachments.loaded&&this.modelattachments.getAttachments()}}return ActivityTimelineItem.ɵfac=function(t){return new(t||ActivityTimelineItem)(r.Y36(p.o),r.Y36(gi.H),r.Y36(x.Pu),r.Y36(b.e),r.Y36(St.z),r.Y36(ce.n),r.Y36(f.d),r.Y36(xe,8),r.Y36(r.sBO))},ActivityTimelineItem.ɵcmp=r.Xpm({type:ActivityTimelineItem,selectors:[["activitytimeline-item"]],inputs:{activity:"activity",showtoolset:"showtoolset",module:"module"},features:[r._Bn([p.o,gi.H,b.e])],decls:23,vars:26,consts:[[1,"slds-timeline__item_expandable","slds-p-vertical--none",3,"ngClass"],[1,"slds-media"],[1,"slds-media__figure"],[1,"slds-button","slds-button_icon",3,"ngClass","disabled","click"],["icon","switch","addclasses","slds-timeline__details-action-icon"],["size","small","divClass","slds-icon_container slds-timeline__icon",3,"module","title"],[1,"slds-media__body"],[1,"slds-grid","slds-grid_align-spread","slds-timeline__trigger"],[1,"slds-grow","slds-grid","slds-grid_vertical-align-center","slds-truncate_container_75","slds-no-space","slds-text-title_bold",3,"system-view-provider"],[1,"slds-truncate","slds-grid","slds-grid--vertical-align-center"],["class","slds-p-horizontal--xx-small",4,"ngIf"],[3,"fieldset",4,"ngIf","ngIfElse"],["noheaderfieldset",""],[1,"slds-timeline__date","slds-p-horizontal--x-small","slds-theme--shade",2,"border-radius","10px","height","18px",3,"title","ngClass"],[1,"slds-align--absolute-center"],[1,"slds-timeline__actions","slds-timeline__actions_inline"],["class","slds-show--medium",3,"buttonsize","actionset",4,"ngIf"],[1,"slds-m-horizontal_xx-small",3,"system-view-provider"],[3,"fieldset",4,"ngIf"],["class","slds-box slds-timeline__item_details slds-theme_shade slds-m-top_x-small slds-m-horizontal_xx-small",4,"ngIf"],["class","slds-hide--medium",3,"buttonsize","actionset","actionemitter",4,"ngIf"],[1,"slds-p-horizontal--xx-small"],["component","SpiceAttachmentsCount",4,"ngIf"],["component","SpiceAttachmentsCount"],[3,"fieldset"],["system-model-popover",""],[1,"slds-show--medium",3,"buttonsize","actionset"],[1,"slds-box","slds-timeline__item_details","slds-theme_shade","slds-m-top_x-small","slds-m-horizontal_xx-small"],["direction","vertical","fielddisplayclass","slds-truncate","fieldpadding","none",3,"fieldset"],["component","SpiceAttachmentsList",4,"ngIf"],["component","SpiceAttachmentsList"],[1,"slds-hide--medium",3,"buttonsize","actionset","actionemitter"]],template:function(t,e){if(1&t&&(r.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),r.NdJ("click",(function(){return e.toggleexpand()})),r._UZ(4,"system-button-icon",4),r.qZA(),r._UZ(5,"system-icon",5),r.qZA(),r.TgZ(6,"div",6)(7,"div",7)(8,"div",8)(9,"h3",9),r.YNc(10,Yi,2,1,"div",10),r.YNc(11,Li,1,1,"object-record-fieldset-horizontal-list",11),r.YNc(12,Fi,2,1,"ng-template",null,12,r.W1O),r.qZA()(),r.TgZ(14,"div",13)(15,"div",14),r._uU(16),r.qZA()(),r.TgZ(17,"div",15),r.YNc(18,Si,1,2,"object-action-menu",16),r.qZA()(),r.TgZ(19,"div",17),r.YNc(20,Ni,1,1,"object-record-fieldset-horizontal-list",18),r.qZA(),r.YNc(21,qi,3,2,"article",19),r.qZA()(),r.YNc(22,Ii,1,2,"object-action-menu",20),r.qZA()),2&t){const t=r.MAs(13);r.Q6J("ngClass",r.VKq(17,Oi,e.isopen)),r.xp6(3),r.Q6J("ngClass",r.VKq(19,Qi,e.cantexpand))("disabled",e.cantexpand),r.xp6(2),r.Q6J("module",e.model.module)("title",e.language.getModuleName(e.model.module,!0)),r.xp6(3),r.Q6J("system-view-provider",r.DdM(21,Ui)),r.xp6(2),r.Q6J("ngIf",e.displayattachments),r.xp6(1),r.Q6J("ngIf",e.headerFieldSet)("ngIfElse",t),r.xp6(3),r.Q6J("title",e.startdate+" "+e.starttime)("ngClass",r.WLB(22,Di,e.isPast,e.isToday)),r.xp6(2),r.Oqu(e.activitiyDate),r.xp6(2),r.Q6J("ngIf",e.showtoolset),r.xp6(1),r.Q6J("system-view-provider",r.DdM(25,Ui)),r.xp6(1),r.Q6J("ngIf",e.subheaderFieldSet),r.xp6(1),r.Q6J("ngIf",e.isopen&&!e.cantexpand),r.xp6(1),r.Q6J("ngIf",e.showtoolset)}},dependencies:[s.mk,s.O5,ki.g,Ci.d,wi.Z,R.J,je.T,Pt.f,Mt.g,Mi.V],encapsulation:2,changeDetection:0}),ActivityTimelineItem})();var Pi=i(788),zi=i(4347);function ji(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"div",5)(1,"button",6),r.NdJ("click",(function(){r.CHM(t);const e=r.oxw();return r.KtG(e.cancel())})),r._UZ(2,"system-button-icon",7),r.TgZ(3,"span",8),r._UZ(4,"system-label",9),r.qZA()(),r.TgZ(5,"button",10),r.NdJ("click",(function(){r.CHM(t);const e=r.oxw();return r.KtG(e.expand())})),r._UZ(6,"system-button-icon",11),r.TgZ(7,"span",8),r._UZ(8,"system-label",12),r.qZA()(),r.TgZ(9,"button",10),r.NdJ("click",(function(){r.CHM(t);const e=r.oxw();return r.KtG(e.dock())})),r._UZ(10,"system-button-icon",13),r.TgZ(11,"span",8),r._UZ(12,"system-label",14),r.qZA()()()}if(2&t){const t=r.oxw();r.xp6(1),r.Q6J("title",t.language.getLabel("LBL_CANCEL")),r.xp6(4),r.Q6J("disabled",!t.canExpand)("title",t.language.getLabel("LBL_EXPAND")),r.xp6(4),r.Q6J("disabled",!t.canDock)("title",t.language.getLabel("LBL_DOCK"))}}function Hi(t,e){1&t&&r._UZ(0,"system-dynamic-component",23)}function Ri(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"button",28),r.NdJ("click",(function(){r.CHM(t);const e=r.oxw(3);return r.KtG(e.expand())})),r._UZ(1,"system-button-icon",11),r.TgZ(2,"span",8),r._UZ(3,"system-label",12),r.qZA()()}if(2&t){const t=r.oxw(3);r.Q6J("disabled",!t.canExpand)("title",t.language.getLabel("LBL_EXPAND"))}}function Gi(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"button",28),r.NdJ("click",(function(){r.CHM(t);const e=r.oxw(3);return r.KtG(e.dock())})),r._UZ(1,"system-button-icon",13),r.TgZ(2,"span",8),r._UZ(3,"system-label",14),r.qZA()()}if(2&t){const t=r.oxw(3);r.Q6J("disabled",!t.canDock)("title",t.language.getLabel("LBL_DOCK"))}}function Ki(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"div",24)(1,"button",25),r.NdJ("click",(function(){r.CHM(t);const e=r.oxw(2);return r.KtG(e.cancel())})),r._UZ(2,"system-button-icon",26),r.TgZ(3,"span",8),r._UZ(4,"system-label",9),r.qZA()(),r.YNc(5,Ri,4,2,"button",27),r.YNc(6,Gi,4,2,"button",27),r.qZA()}if(2&t){const t=r.oxw(2);r.xp6(1),r.Q6J("title",t.language.getLabel("LBL_CANCEL")),r.xp6(4),r.Q6J("ngIf",!t.componentconfig.hideutilitybuttons),r.xp6(1),r.Q6J("ngIf",!t.componentconfig.hideutilitybuttons)}}function Vi(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"div",15),r._UZ(1,"object-record-fieldset",16),r.YNc(2,Hi,1,0,"system-dynamic-component",17),r.TgZ(3,"div",18),r.YNc(4,Ki,7,3,"div",19),r.TgZ(5,"div",20),r._UZ(6,"object-record-messages-badge",21),r.TgZ(7,"object-action-container",22),r.NdJ("actionemitter",(function(e){r.CHM(t);const i=r.oxw();return r.KtG(i.handleaction(e))})),r.qZA()()()()}if(2&t){const t=r.oxw();r.xp6(1),r.Q6J("fieldset",t.bodyFieldSet)("direction","vertical"),r.xp6(1),r.Q6J("ngIf",t.allowattachments),r.xp6(2),r.Q6J("ngIf","top"!=t.utilityButtonsPosition),r.xp6(3),r.Q6J("actionset",t.actionset)}}let $i=(()=>{class ActivityTimelineAddItem{constructor(t,e,i,s,n,l,a,o){this.metadata=t,this.activitiytimeline=e,this.model=i,this.view=s,this.language=n,this.modal=l,this.dockedComposer=a,this.ViewContainerRef=o,this.componentconfig={},this.headerFieldSet="",this.bodyFieldSet="",this.utilityButtonsPosition="bottom",this.isExpanded=!1,this.canExpand=!1,this.canDock=!1}ngOnInit(){this.model.module=this.module,this.model.initializeModel(),this.parentSubscription=this.activitiytimeline.parent.data$.subscribe((t=>{t.id==this.model.getField("parent_id")&&this.model.setField("parent_name",t.summary_text)})),this.view.isEditable=!0,this.view.setEditMode(),this.headerFieldSet=this.componentconfig.headerfieldset,this.bodyFieldSet=this.componentconfig.bodyfieldset,this.componentconfig.utilitybuttonsposition&&(this.utilityButtonsPosition=this.componentconfig.utilitybuttonsposition),this.checkCanExpand(),this.checkCanDock()}ngOnDestroy(){this.parentSubscription&&this.parentSubscription.unsubscribe()}get module(){return this.componentconfig.module}get actionset(){return this.componentconfig.actionset}get allowattachments(){return!0===this.componentconfig.allowattachments}initializeModule(){this.model.module=this.module,this.model.id=void 0,this.model.initializeModel(this.activitiytimeline.parent)}onHeaderClick(){this.isExpanded||(this.isExpanded=!0,this.initializeModule(),this.model.startEdit(!1))}checkCanExpand(){this.canExpand=!_.isEmpty(this.metadata.getComponentConfig("GlobalDockedComposerModal",this.model.module))}expand(){this.dockedComposer.addComposer(this.model.module,this.model,!0),this.isExpanded=!1,this.initializeModule()}checkCanDock(){this.canDock=!_.isEmpty(this.metadata.getComponentConfig("GlobalDockedComposer",this.model.module))}dock(){this.dockedComposer.addComposer(this.model.module,this.model),this.isExpanded=!1,this.initializeModule()}cancel(){this.model.cancelEdit(),this.isExpanded=!1,this.initializeModule()}handleaction(t){this.initializeModule(),this.view.setEditMode(),this.isExpanded=!1}}return ActivityTimelineAddItem.ɵfac=function(t){return new(t||ActivityTimelineAddItem)(r.Y36(x.Pu),r.Y36(xe),r.Y36(p.o),r.Y36(b.e),r.Y36(f.d),r.Y36(H.o),r.Y36(Pi.m),r.Y36(r.s_b))},ActivityTimelineAddItem.ɵcmp=r.Xpm({type:ActivityTimelineAddItem,selectors:[["activitytimeline-add-item"]],features:[r._Bn([p.o,b.e])],decls:5,vars:3,consts:[[1,""],["class","slds-p-horizontal--xx-small slds-float_right",4,"ngIf"],[1,"slds-p-horizontal--xx-small",3,"click"],[3,"fieldset"],["class","slds-p-horizontal--xx-small",4,"ngIf"],[1,"slds-p-horizontal--xx-small","slds-float_right"],[1,"slds-button","slds-button_icon",3,"title","click"],["icon","close","size","medium"],[1,"slds-assistive-text"],["label","LBL_CANCEL"],[1,"slds-button","slds-button_icon",3,"disabled","title","click"],["icon","expand"],["label","LBL_EXPAND"],["icon","dock_panel"],["label","LBL_DOCK"],[1,"slds-p-horizontal--xx-small"],[3,"fieldset","direction"],["component","SpiceAttachmentsPanel",4,"ngIf"],[1,"slds-p-vertical--x-small","slds-grid"],["class","slds-button-group","role","group",4,"ngIf"],[1,"slds-col--bump-left","slds-grid","slds-grid--vertical-align-center"],["side","right"],[3,"actionset","actionemitter"],["component","SpiceAttachmentsPanel"],["role","group",1,"slds-button-group"],[1,"slds-button","slds-button--icon-border","slds-button--neutral",3,"title","click"],["icon","close"],["class","slds-button slds-button--icon-border slds-button--neutral",3,"disabled","title","click",4,"ngIf"],[1,"slds-button","slds-button--icon-border","slds-button--neutral",3,"disabled","title","click"]],template:function(t,e){1&t&&(r.TgZ(0,"div",0),r.YNc(1,ji,13,5,"div",1),r.TgZ(2,"div",2),r.NdJ("click",(function(){return e.onHeaderClick()})),r._UZ(3,"object-record-fieldset",3),r.qZA(),r.YNc(4,Vi,8,5,"div",4),r.qZA()),2&t&&(r.xp6(1),r.Q6J("ngIf",e.isExpanded&&"top"==e.utilityButtonsPosition),r.xp6(2),r.Q6J("fieldset",e.headerFieldSet),r.xp6(1),r.Q6J("ngIf",e.isExpanded))},dependencies:[s.O5,st.S,Ci.d,zi.Z,R.J,je.T,S._],encapsulation:2}),ActivityTimelineAddItem})();var Xi=i(4021);function Wi(t,e){if(1&t){const t=r.EpF();r.ynx(0),r._UZ(1,"object-record-fieldset",4)(2,"system-dynamic-component",5),r.TgZ(3,"div",6)(4,"div",7)(5,"button",8),r.NdJ("click",(function(){r.CHM(t);const e=r.oxw();return r.KtG(e.cancel())})),r._UZ(6,"system-button-icon",9),r.TgZ(7,"span",10),r._UZ(8,"system-label",11),r.qZA()(),r.TgZ(9,"button",8),r.NdJ("click",(function(){r.CHM(t);const e=r.oxw();return r.KtG(e.expand())})),r._UZ(10,"system-button-icon",12),r.TgZ(11,"span",10),r._UZ(12,"system-label",13),r.qZA()(),r.TgZ(13,"button",8),r.NdJ("click",(function(){r.CHM(t);const e=r.oxw();return r.KtG(e.dock())})),r._UZ(14,"system-button-icon",14),r.TgZ(15,"span",10),r._UZ(16,"system-label",15),r.qZA()()(),r.TgZ(17,"div",16),r._UZ(18,"object-record-messages-badge",17),r.TgZ(19,"button",18),r.NdJ("click",(function(){r.CHM(t);const e=r.oxw();return r.KtG(e.send())})),r._UZ(20,"system-label",19),r.qZA()()(),r.BQk()}if(2&t){const t=r.oxw();r.xp6(1),r.Q6J("fieldset",t.formFieldSet)("direction","vertical"),r.xp6(4),r.Q6J("title",t.language.getLabel("LBL_CANCEL")),r.xp6(4),r.Q6J("title",t.language.getLabel("LBL_EXPAND")),r.xp6(4),r.Q6J("title",t.language.getLabel("LBL_DOCK")),r.xp6(6),r.Q6J("disabled",!t.canSend)}}let ts=(()=>{class ActivityTimelineAddEmail extends $i{constructor(t,e,i,s,n,l,a,o,d,c){super(t,e,i,s,n,l,a,o),this.metadata=t,this.activitiytimeline=e,this.model=i,this.view=s,this.language=n,this.modal=l,this.dockedComposer=a,this.ViewContainerRef=o,this.backend=d,this.session=c,this.formFields=[],this.formFieldSet="",this.headerFieldSet=""}get canSend(){let t=this.model.getField("recipient_addresses");return!!t&&t.some((t=>"to"==t.address_type))}ngOnInit(){this.model.module="Emails",this.setEditMode(),this.subscribeParent(),this.getFieldsetFields()}initializeEmail(){this.model.id=this.model.generateGuid(),this.model.initializeModel(),this.model.startEdit(),this.model.setFields({parent_type:this.activitiytimeline.parent.module,parent_id:this.activitiytimeline.parent.id,parent_name:this.activitiytimeline.parent.getField("summary_text"),type:"out",status:"created",recipient_addresses:[],from_addr_name:this.session.authData.email})}onHeaderClick(){this.isExpanded||(this.isExpanded=!0,this.initializeEmail(),this.model.startEdit(!1))}subscribeParent(){this.activitiytimeline.parent.data$.subscribe((t=>{0==this.model.getField("recipient_addresses")?.length&&this.determineRecipientAddress(),t.id==this.model.getField("parent_id")&&this.model.setField("parent_name",t.summary_text)}))}setEditMode(){this.view.isEditable=!0,this.view.setEditMode()}getFieldsetFields(){let t=this.metadata.getComponentConfig("ActivityTimelineAddEmail",this.model.module);this.formFieldSet=t.fieldset,this.headerFieldSet=t.headerfieldset,this.formFields=this.metadata.getFieldSetItems(t.fieldset)}onFocus(){this.isExpanded||(this.isExpanded=!0,this.initializeEmail(),this.determineRecipientAddress(),this.setEditMode())}determineRecipientAddress(){this.activitiytimeline.parent.getField("email1")&&this.model.setField("recipient_addresses",[{parent_type:this.activitiytimeline.parent.module,parent_id:this.activitiytimeline.parent.id,email_address:this.activitiytimeline.parent.getField("email1"),id:this.model.generateGuid(),address_type:"to"}])}send(){this.canSend&&(this.model.getField("name")||this.model.getField("body")?this.save():this.modal.prompt("confirm",this.language.getLabel("LBL_EMAIL_SEND_EMPTY",null,"long"),this.language.getLabel("LBL_EMAIL_SEND_EMPTY")).subscribe((t=>{t&&this.save()})))}save(){this.model.setField("to_be_sent",!0),this.model.save().subscribe((()=>{this.isExpanded=!1,this.model.setField("to_be_sent",!1),this.initializeEmail(),this.determineRecipientAddress(),this.model.endEdit()}))}}return ActivityTimelineAddEmail.ɵfac=function(t){return new(t||ActivityTimelineAddEmail)(r.Y36(x.Pu),r.Y36(xe),r.Y36(p.o),r.Y36(b.e),r.Y36(f.d),r.Y36(H.o),r.Y36(Pi.m),r.Y36(r.s_b),r.Y36(re.y),r.Y36(ce.n))},ActivityTimelineAddEmail.ɵcmp=r.Xpm({type:ActivityTimelineAddEmail,selectors:[["activitytimeline-add-email"]],features:[r._Bn([p.o,b.e]),r.qOj],decls:4,vars:3,consts:[[1,"slds-p-around--xx-small",3,"system-overlay-loading-spinner"],[3,"click"],[3,"fieldset"],[4,"ngIf"],[3,"fieldset","direction"],["component","SpiceAttachmentsPanel"],[1,"slds-p-vertical--x-small","slds-grid"],["role","group",1,"slds-button-group"],[1,"slds-button","slds-button--neutral",3,"title","click"],["icon","close"],[1,"slds-assistive-text"],["label","LBL_CANCEL"],["icon","expand"],["label","LBL_EXPAND"],["icon","dock_panel"],["label","LBL_DOCK"],[1,"slds-col--bump-left","slds-grid","slds-grid--vertical-align-center"],["side","right"],[1,"slds-button","slds-button--brand",".slds-button-space-left","slds-float--right",3,"disabled","click"],["label","LBL_SEND"]],template:function(t,e){1&t&&(r.TgZ(0,"div",0)(1,"div",1),r.NdJ("click",(function(){return e.onHeaderClick()})),r._UZ(2,"object-record-fieldset",2),r.qZA(),r.YNc(3,Wi,21,6,"ng-container",3),r.qZA()),2&t&&(r.Q6J("system-overlay-loading-spinner",e.model.isSaving),r.xp6(2),r.Q6J("fieldset",e.headerFieldSet),r.xp6(1),r.Q6J("ngIf",e.isExpanded))},dependencies:[s.O5,Ci.d,zi.Z,R.J,je.T,S._,Xi._],encapsulation:2}),ActivityTimelineAddEmail})();const es=["detailContainer"];let is=(()=>{class ActivityTimelineSummaryItemView{constructor(t,e,i,s,n,l){this.metadata=t,this.parent=e,this.model=i,this.language=s,this.activitiytimeline=n,this.activatedRoute=l,this.componentRefs=[]}ngOnChanges(){this.model.module=this.module,this.model.id=this.id,this.model.setData(this.data,!1);for(let t of this.componentRefs)t.destroy();let t=this.metadata.getComponentConfig("ActivityTimelineSummary",this.module);if(t&&t.componentsets)for(let e of t.componentsets)for(let t of this.metadata.getComponentSetObjects(e))this.metadata.addComponent(t.component,this.detailContainer).subscribe((e=>{e.instance.componentconfig=t.componentconfig,this.componentRefs.push(e)}))}}return ActivityTimelineSummaryItemView.ɵfac=function(t){return new(t||ActivityTimelineSummaryItemView)(r.Y36(x.Pu),r.Y36(p.o),r.Y36(p.o),r.Y36(f.d),r.Y36(xe),r.Y36(et.gz))},ActivityTimelineSummaryItemView.ɵcmp=r.Xpm({type:ActivityTimelineSummaryItemView,selectors:[["activity-timeline-summary-item-view"]],viewQuery:function(t,e){if(1&t&&r.Gf(es,7,r.s_b),2&t){let t;r.iGM(t=r.CRH())&&(e.detailContainer=t.first)}},inputs:{module:"module",id:"id",data:"data"},features:[r._Bn([p.o]),r.TTD],decls:14,vars:3,consts:[[1,"slds-border_bottom","slds-p-around--medium","slds-theme--shade"],[1,"slds-grid"],[1,"slds-col","slds-has-flexi-truncate"],[1,"slds-media","slds-no-space","slds-grow"],[3,"module"],[1,"slds-media__body"],[1,"slds-text-title--caps","slds-line-height--reset"],[1,"slds-page-header__title","slds-m-right--small","slds-align-middle","slds-truncate"],[1,"slds-p-around--xx-small"],["detailContainer",""]],template:function(t,e){1&t&&(r.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),r._UZ(4,"system-icon",4),r.TgZ(5,"div",5)(6,"p",6),r._UZ(7,"system-label-modulename",4),r.qZA(),r.TgZ(8,"div")(9,"h1",7),r._uU(10),r.qZA()()()()()()(),r.TgZ(11,"div",8),r._UZ(12,"div",null,9),r.qZA()),2&t&&(r.xp6(4),r.Q6J("module",e.model.module),r.xp6(3),r.Q6J("module",e.model.module),r.xp6(3),r.hij(" ",e.model.data.name,""))},dependencies:[Pt.f,Wt.M],encapsulation:2}),ActivityTimelineSummaryItemView})();function ss(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"li",3),r.NdJ("click",(function(){const e=r.CHM(t).$implicit,i=r.oxw();return r.KtG(i.toggleModuleFilter(e.module))})),r.TgZ(1,"div",4),r._UZ(2,"system-icon",5),r.qZA(),r.TgZ(3,"div",4),r._uU(4),r.qZA(),r.TgZ(5,"div"),r._UZ(6,"system-label-modulename",6),r.qZA()()}if(2&t){const t=e.$implicit,i=r.oxw();r.Q6J("ngStyle",i.getElementStyle(t.module)),r.xp6(2),r.Q6J("title",i.language.getModuleName(t.module))("module",t.module),r.xp6(2),r.hij(" ",t.count," "),r.xp6(2),r.Q6J("module",t.module)("singular",1==t.count)}}function ns(t,e){if(1&t&&(r.TgZ(0,"li",7)(1,"div",4),r._uU(2),r.qZA(),r.TgZ(3,"div"),r._uU(4),r.qZA()()),2&t){const t=e.$implicit;r.xp6(2),r.hij(" ",t.year,": "),r.xp6(2),r.hij(" ",t.count," ")}}let ls=(()=>{class ActivityTimelineSummaryAggregates extends qe{}return ActivityTimelineSummaryAggregates.ɵfac=function(){let t;return function(e){return(t||(t=r.n5z(ActivityTimelineSummaryAggregates)))(e||ActivityTimelineSummaryAggregates)}}(),ActivityTimelineSummaryAggregates.ɵcmp=r.Xpm({type:ActivityTimelineSummaryAggregates,selectors:[["activity-timeline-summary-aggregates"]],features:[r.qOj],decls:3,vars:2,consts:[[1,"slds-list_horizontal","slds-has-dividers_right"],["class","slds-item slds-grid slds-grid--vertical-align-center",3,"ngStyle","click",4,"ngFor","ngForOf"],["class","slds-item slds-grid slds-grid--vertical-align-center",4,"ngFor","ngForOf"],[1,"slds-item","slds-grid","slds-grid--vertical-align-center",3,"ngStyle","click"],[1,"slds-p-right--xxx-small"],["size","xx-small","divClass","slds-align--absolute-center",3,"title","module"],[3,"module","singular"],[1,"slds-item","slds-grid","slds-grid--vertical-align-center"]],template:function(t,e){1&t&&(r.TgZ(0,"ul",0),r.YNc(1,ss,7,6,"li",1),r.YNc(2,ns,5,2,"li",2),r.qZA()),2&t&&(r.xp6(1),r.Q6J("ngForOf",e.moduleaggregates),r.xp6(1),r.Q6J("ngForOf",e.yearaggregates))},dependencies:[s.sg,s.PC,Pt.f,Wt.M],encapsulation:2}),ActivityTimelineSummaryAggregates})();const as=["listContainer"];function os(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"system-input-delayed",24),r.NdJ("ngModelChange",(function(e){r.CHM(t);const i=r.oxw();return r.KtG(i.searchterm=e)})),r.qZA()}if(2&t){const t=r.oxw();r.Q6J("ngModel",t.searchterm)}}const ds=function(t){return{"slds-theme--default slds-border--bottom slds-border--top":t}};function cs(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"li",25),r.NdJ("click",(function(){const e=r.CHM(t).$implicit,i=r.oxw();return r.KtG(i.setActivitiy(e))})),r._UZ(1,"activitytimeline-item-container",26),r.qZA()}if(2&t){const t=e.$implicit,i=r.oxw();r.Q6J("ngClass",r.VKq(2,ds,t.id==i.activityid)),r.xp6(1),r.Q6J("activity",t)}}function rs(t,e){1&t&&(r.TgZ(0,"ul",27)(1,"li",28),r._UZ(2,"activitytimeline-stencil"),r.qZA(),r.TgZ(3,"li",29),r._UZ(4,"activitytimeline-stencil"),r.qZA(),r.TgZ(5,"li",30),r._UZ(6,"activitytimeline-stencil"),r.qZA(),r.TgZ(7,"li",31),r._UZ(8,"activitytimeline-stencil"),r.qZA(),r.TgZ(9,"li",32),r._UZ(10,"activitytimeline-stencil"),r.qZA()())}function ms(t,e){if(1&t&&r._UZ(0,"activity-timeline-summary-item-view",35),2&t){const t=r.oxw(2);r.Q6J("module",t.activitymodule)("id",t.activityid)("data",t.activitydata)}}function us(t,e){if(1&t&&(r.TgZ(0,"div",33),r.YNc(1,ms,1,3,"activity-timeline-summary-item-view",34),r.qZA()),2&t){const t=r.oxw();r.xp6(1),r.Q6J("ngIf",t.activitymodule)}}const ps=function(t){return{"slds-hide":t}};let gs=(()=>{class ActivityTimelineSummary{constructor(t,e,i,s,n,l){this.metadata=t,this.parent=e,this.language=i,this.activitiytimeline=s,this.navigationtab=n,this.layout=l,this.componentconfig=this.metadata.getComponentConfig("ActivityTimelineSummary"),this.componentconfig.usefts&&(this.activitiytimeline.usefts=!0),this.subscription=this.activitiytimeline.loading$.subscribe((t=>this.clearActivitiy()))}ngOnInit(){this.initialize(this.navigationtab.activeRoute.params)}ngOnDestroy(){this.subscription.unsubscribe()}get activities(){return this.activitiytimeline.activities.History.list}get displayDetailsPane(){return"small"!=this.layout.screenwidth}get searchterm(){return this.activitiytimeline.filters.searchterm}set searchterm(t){this.activitiytimeline.filters.searchterm=t,this.activitiytimeline.reload()}reload(){this.activitiytimeline.reload()}initialize(t){this.parent.module=t.module,this.parent.id=t.id,this.parent.getData(!0,"",!0).subscribe((t=>{this.navigationtab.setTabInfo({displayname:this.parent.getField("summary_text")+" • "+this.language.getModuleName("History"),displaymodule:"History"})})),this.activitiytimeline.parent=this.parent,this.activitiytimeline.defaultLimit=25,this.activitiytimeline.modules=["History"],this.activitiytimeline.reload()}onScroll(t){let e=this.listContainer.element.nativeElement;e.scrollTop+e.clientHeight+50>e.scrollHeight&&this.activitiytimeline.canLoadMore("History")&&this.activitiytimeline.getMoreTimeLineData("History",20)}setActivitiy(t){this.activitymodule=t.module,this.activityid=t.id,this.activitydata=t.data}clearActivitiy(){this.activitymodule="",this.activityid="",this.activitydata=""}goModel(){this.parent.goDetail()}goModule(){this.parent.goModule()}}return ActivityTimelineSummary.ɵfac=function(t){return new(t||ActivityTimelineSummary)(r.Y36(x.Pu),r.Y36(p.o),r.Y36(f.d),r.Y36(xe),r.Y36(Ae.d),r.Y36(_e.b))},ActivityTimelineSummary.ɵcmp=r.Xpm({type:ActivityTimelineSummary,selectors:[["ng-component"]],viewQuery:function(t,e){if(1&t&&r.Gf(as,7,r.s_b),2&t){let t;r.iGM(t=r.CRH())&&(e.listContainer=t.first)}},features:[r._Bn([xe,p.o])],decls:31,vars:10,consts:[[1,"slds-page-header","slds-grid","slds-grid--align-spread"],[1,"slds-col"],["role","navigation","aria-label","Breadcrumbs"],[1,"slds-breadcrumb","slds-list_horizontal","slds-wrap"],[1,"slds-breadcrumb__item","slds-text-title_caps"],["href","javascript:void(0);",3,"click"],[3,"module"],[1,"slds-p-horizontal--x-small"],[1,"slds-col","slds-align-bottom","slds-p-top--xxx-small"],["module","History"],[1,"slds-page-header__col-actions","slds-grid"],["delay","1000",3,"ngModel","ngModelChange",4,"ngIf"],[1,"slds-page-header__controls"],[1,"slds-page-header__control"],[1,"slds-align--absolute-center","slds-button","slds-button--icon","slds-button--icon-border-filled"],[1,"slds-button","slds-button--icon","slds-button--icon-border-filled"],["icon","refresh",3,"click"],[1,"slds-grid"],["system-to-bottom","",1,"slds-size--1-of-1","slds-medium-size--1-of-3","slds-border--right","slds-scrollable",3,"scroll"],["listContainer",""],[1,"slds-timeline",3,"ngClass"],["class","slds-p-around--x-small",3,"ngClass","click",4,"ngFor","ngForOf"],["class","slds-timeline",4,"ngIf"],["class","slds-size--2-of-3","system-to-bottom","",4,"ngIf"],["delay","1000",3,"ngModel","ngModelChange"],[1,"slds-p-around--x-small",3,"ngClass","click"],[3,"activity"],[1,"slds-timeline"],[1,"slds-p-around--x-small"],[1,"slds-p-around--x-small",2,"opacity","0.8"],[1,"slds-p-around--x-small",2,"opacity","0.6"],[1,"slds-p-around--x-small",2,"opacity","0.4"],[1,"slds-p-around--x-small",2,"opacity","0.2"],["system-to-bottom","",1,"slds-size--2-of-3"],[3,"module","id","data",4,"ngIf"],[3,"module","id","data"]],template:function(t,e){1&t&&(r.TgZ(0,"div",0)(1,"div",1)(2,"nav",2)(3,"ol",3)(4,"li",4)(5,"a",5),r.NdJ("click",(function(){return e.goModule()})),r._UZ(6,"system-label-modulename",6),r.qZA()(),r.TgZ(7,"li",4)(8,"a",5),r.NdJ("click",(function(){return e.goModel()})),r._uU(9),r.qZA()(),r.TgZ(10,"li",4)(11,"span",7),r._UZ(12,"system-label-modulename",6),r.qZA()()()(),r.TgZ(13,"div",8),r._UZ(14,"activity-timeline-summary-aggregates",9),r.qZA()(),r.TgZ(15,"div",10),r.YNc(16,os,1,1,"system-input-delayed",11),r.TgZ(17,"div",12)(18,"div",13),r._UZ(19,"activity-timeline-filter",14),r.qZA()(),r.TgZ(20,"div",12)(21,"div",13)(22,"button",15)(23,"system-button-icon",16),r.NdJ("click",(function(){return e.reload()})),r.qZA()()()()()(),r.TgZ(24,"div",17)(25,"div",18,19),r.NdJ("scroll",(function(t){return e.onScroll(t)})),r.TgZ(27,"ul",20),r.YNc(28,cs,2,4,"li",21),r.qZA(),r.YNc(29,rs,11,0,"ul",22),r.qZA(),r.YNc(30,us,2,1,"div",23),r.qZA()),2&t&&(r.xp6(6),r.Q6J("module",e.parent.module),r.xp6(3),r.Oqu(e.parent.data.summary_text),r.xp6(3),r.Q6J("module","History"),r.xp6(4),r.Q6J("ngIf",e.componentconfig.usefts),r.xp6(11),r.Q6J("ngClass",r.VKq(8,ps,e.activitiytimeline.activities.History.loading)),r.xp6(1),r.Q6J("ngForOf",e.activities),r.xp6(1),r.Q6J("ngIf",e.activitiytimeline.activities.History.loading),r.xp6(1),r.Q6J("ngIf",e.displayDetailsPane))},dependencies:[s.mk,s.sg,s.O5,n.JJ,n.On,R.J,Ze.y,Wt.M,y.H,Ye,Fe.d,Se.g,is,ls],encapsulation:2}),ActivityTimelineSummary})();var hs=i(6822),fs=i(2006);function vs(t,e){if(1&t&&r._UZ(0,"field-label",3),2&t){const t=r.oxw();r.Q6J("fieldname",t.fieldname)("fieldconfig",t.fieldconfig)}}function ys(t,e){if(1&t&&(r.TgZ(0,"field-generic-display",4),r._uU(1),r.qZA()),2&t){const t=r.oxw();r.Q6J("fielddisplayclass",t.fielddisplayclass)("editable",t.isEditable())("fieldconfig",t.fieldconfig),r.xp6(1),r.hij(" ",t.cachedValue.formatted,"\n")}}function bs(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"div",5)(1,"div",6)(2,"system-input-date",7),r.NdJ("ngModelChange",(function(e){r.CHM(t);const i=r.oxw();return r.KtG(i.value=e)})),r.qZA(),r.TgZ(3,"system-input-time",8),r.NdJ("ngModelChange",(function(e){r.CHM(t);const i=r.oxw();return r.KtG(i.value=e)})),r.qZA()(),r._UZ(4,"field-messages",9),r.qZA()}if(2&t){const t=r.oxw();r.Q6J("ngClass",t.css_classes),r.xp6(2),r.Q6J("ngModel",t.value),r.xp6(1),r.Q6J("ngModel",t.value),r.xp6(1),r.Q6J("fieldname",t.fieldname)}}let xs=(()=>{class fieldActivityDate extends Tt.O{constructor(t,e,i,s,n,l,a,o,d,c){super(t,e,s,n,l),this.model=t,this.view=e,this.broadcast=i,this.language=s,this.metadata=n,this.router=l,this.elementRef=a,this.renderer=o,this.modal=d,this.userpreferences=c,this.subscribeToDataChange()}ngOnInit(){super.ngOnInit(),this.setFormattedValue()}subscribeToDataChange(){this.subscriptions.add(this.model.data$.subscribe((t=>{t[this.fieldname]&&!moment(this.cachedValue?.raw).isSame(t[this.fieldname])&&this.setFormattedValue()})))}setFormattedValue(){if(!this.value)return;this.cachedValue={raw:this.value};const t=new moment(this.value),e=moment(t.format("YYYY M D")).isSame((new moment).format("YYYY M D")),i=t.isSame(new moment,"year");this.cachedValue.formatted=e?t.format(this.userpreferences.getTimeFormat()):i?t.format("MMM D"):t.format(this.userpreferences.getDateFormat())}}return fieldActivityDate.ɵfac=function(t){return new(t||fieldActivityDate)(r.Y36(p.o),r.Y36(b.e),r.Y36(m.f),r.Y36(f.d),r.Y36(x.Pu),r.Y36(et.F0),r.Y36(r.SBq),r.Y36(r.Qsj),r.Y36(H.o),r.Y36(St.z))},fieldActivityDate.ɵcmp=r.Xpm({type:fieldActivityDate,selectors:[["field-activity-date"]],features:[r.qOj],decls:3,vars:3,consts:[[3,"fieldname","fieldconfig",4,"ngIf"],[3,"fielddisplayclass","editable","fieldconfig",4,"ngIf"],["class","slds-form-element__control slds-p-around--xx-small",3,"ngClass",4,"ngIf"],[3,"fieldname","fieldconfig"],[3,"fielddisplayclass","editable","fieldconfig"],[1,"slds-form-element__control","slds-p-around--xx-small",3,"ngClass"],[1,"slds-grid"],[1,"slds-size--1-of-2","slds-p-right--xxx-small",3,"ngModel","ngModelChange"],[1,"slds-size--1-of-2","slds-p-left--xxx-small",3,"ngModel","ngModelChange"],[3,"fieldname"]],template:function(t,e){1&t&&(r.YNc(0,vs,1,2,"field-label",0),r.YNc(1,ys,2,4,"field-generic-display",1),r.YNc(2,bs,5,4,"div",2)),2&t&&(r.Q6J("ngIf",e.displayLabel),r.xp6(1),r.Q6J("ngIf",!e.isEditMode()),r.xp6(1),r.Q6J("ngIf",e.isEditable()&&e.isEditMode()))},dependencies:[s.mk,s.O5,n.JJ,n.On,kt.q,Ct.D,Nt.a,hs.z,fs.H],encapsulation:2}),fieldActivityDate})(),_s=(()=>{class ModuleActivities{}return ModuleActivities.ɵfac=function(t){return new(t||ModuleActivities)},ModuleActivities.ɵmod=r.oAB({type:ModuleActivities}),ModuleActivities.ɵinj=r.cJS({imports:[s.ez,n.u5,l.ObjectFields,a.GlobalComponents,o.ObjectComponents,d.SystemComponents,c.o]}),ModuleActivities})();("undefined"==typeof ngJitMode||ngJitMode)&&r.kYT(_s,{declarations:[D,F,M,O,P,z,V,X,rt,pt,yt,ht,Zt,xt,Ft,de,Qt,Vt,Bt,Gt,ue,pe,fe,pi,Ti,we,Ye,ze,Fe.d,Bi,Se.g,ni,$i,ts,gs,qe,is,li,ls,xs],imports:[s.ez,n.u5,l.ObjectFields,a.GlobalComponents,o.ObjectComponents,d.SystemComponents,c.o],exports:[Fe.d,Se.g]})}}]);