/*!
 * 
 *                     aacService
 *
 *                     release: 2023.03.001
 *
 *                     date: 2024-01-09 16:51:03
 *
 *                     build: 2023.03.001.1704815463270
 *
 */
"use strict";(self.webpackChunkcore=self.webpackChunkcore||[]).push([["src_include_spiceurls_spiceurls_ts"],{86190:(e,s,t)=>{t.r(s),t.d(s,{ModuleSpiceUrls:()=>H});var l=t(44755),i=t(95030),n=t(84357),r=t(53190),d=t(34826),o=t(19784),a=t(57239),u=t(62242),c=t(71651),m=t(55329),p=t(44044),g=t(55710),h=t(32294),f=t(13278),b=t(4154),_=t(83463),x=t(94664),v=t(69774),U=t(62422),Z=t(93441),y=t(72656),I=t(44561);function S(e,s){if(1&e){const e=u.EpF();u.TgZ(0,"div",9)(1,"button",10),u.NdJ("click",(function(){u.CHM(e);const s=u.oxw();return u.KtG(s.deleteUrl())})),u._UZ(2,"system-button-icon",11),u.qZA()()}}function T(e,s){if(1&e&&(u.TgZ(0,"div",12)(1,"ul",13)(2,"li",14),u._uU(3),u.qZA()()()),2&e){const e=u.oxw();u.xp6(3),u.Oqu(e.urlItemDate)}}function Y(e,s){if(1&e&&(u.TgZ(0,"div",3)(1,"div",15)(2,"span",16)(3,"span",17),u._uU(4,"Progress: 25%"),u.qZA()()(),u.TgZ(5,"div",18),u._uU(6),u.qZA()()),2&e){const e=u.oxw();u.xp6(2),u.Q6J("ngStyle",e.progressbarstyle),u.xp6(4),u.hij(" ",e.urlItem.uploadprogress," % ")}}let A=(()=>{class SpiceUrlItem{userpreferences;modal;toast;helper;injector;urlItem={};editmode=!0;modelurls;constructor(e,s,t,l,i){this.userpreferences=e,this.modal=s,this.toast=t,this.helper=l,this.injector=i}get urlItemDate(){return this.urlItem.date?this.urlItem.date.format(this.userpreferences.getDateFormat()):""}get uploading(){return this.urlItem.hasOwnProperty("uploadprogress")}get progressbarstyle(){return{width:this.urlItem.uploadprogress+"%"}}openUrl(e){e.preventDefault(),e.stopPropagation(),this.uploading?this.toast.sendToast("upload still in progress","info"):this.urlItem.urlItem_mime_type}deleteUrl(){this.editmode&&this.modelurls.deleteUrl(this.urlItem.id)}static ɵfac=function(e){return new(e||SpiceUrlItem)(u.Y36(U.z),u.Y36(p.o),u.Y36(f.A),u.Y36(Z._),u.Y36(u.zs3))};static ɵcmp=u.Xpm({type:SpiceUrlItem,selectors:[["spice-url-item"]],inputs:{urlItem:"urlItem",editmode:"editmode",modelurls:"modelurls"},decls:10,vars:5,consts:[[1,"slds-m-right--x-small","slds-align--absolute-center",2,"width","30px","height","30px"],["icon","share_link","size","small",3,"module"],[1,"slds-media__body"],[1,"slds-grid","slds-grid_vertical-align-center","slds-grid--align-spread","slds-has-flexi-truncate"],[1,"slds-truncate","slds-text-heading--x-small","slds-p-right--xxx-small",3,"click"],["href","javascript:void(0);"],["class","slds-shrink-none",4,"ngIf"],["class","slds-tile__detail slds-text-body--small",4,"ngIf"],["class","slds-grid slds-grid_vertical-align-center slds-grid--align-spread slds-has-flexi-truncate",4,"ngIf"],[1,"slds-shrink-none"],[1,"slds-button","slds-button--icon",3,"click"],["icon","clear"],[1,"slds-tile__detail","slds-text-body--small"],[1,"slds-list--horizontal","slds-has-dividers--left"],[1,"slds-item"],[1,"slds-progress-bar"],[1,"slds-progress-bar__value",3,"ngStyle"],[1,"slds-assistive-text"],[1,"slds-text-align--right",2,"width","50px"]],template:function(e,s){1&e&&(u.TgZ(0,"div",0),u._UZ(1,"system-icon",1),u.qZA(),u.TgZ(2,"div",2)(3,"div",3)(4,"h3",4),u.NdJ("click",(function(e){return s.openUrl(e)})),u.TgZ(5,"a",5),u._uU(6),u.qZA()(),u.YNc(7,S,3,0,"div",6),u.qZA(),u.YNc(8,T,4,1,"div",7),u.YNc(9,Y,7,2,"div",8),u.qZA()),2&e&&(u.xp6(1),u.Q6J("module","SpiceUrls"),u.xp6(5),u.Oqu(s.urlItem.urlItemName),u.xp6(1),u.Q6J("ngIf",!s.uploading&&s.editmode),u.xp6(1),u.Q6J("ngIf",!s.uploading),u.xp6(1),u.Q6J("ngIf",s.uploading))},dependencies:[l.O5,l.PC,y.J,I.f],encapsulation:2})}return SpiceUrlItem})();const C=["urlupload"];function w(e,s){if(1&e&&u._UZ(0,"spice-url-item",5),2&e){const e=s.$implicit,t=u.oxw(2);u.Q6J("modelurls",t.modelurls)("urlItem",e)("editmode",t.editing)}}function L(e,s){1&e&&(u.TgZ(0,"div",6)(1,"div",7),u._UZ(2,"system-spinner",8)(3,"system-label",9),u.qZA()())}function J(e,s){if(1&e){const e=u.EpF();u.TgZ(0,"div",1),u.NdJ("system-drop-file",(function(s){u.CHM(e);const t=u.oxw();return u.KtG(t.fileDrop(s))})),u.TgZ(1,"div")(2,"div",2),u.YNc(3,w,1,3,"spice-url-item",3),u.qZA(),u.YNc(4,L,4,0,"div",4),u.qZA()()}if(2&e){const e=u.oxw();u.xp6(3),u.Q6J("ngForOf",e.modelurls),u.xp6(1),u.Q6J("ngIf",e.modelurls.loading)}}let M=(()=>{class SpiceUrlsPanel{_modelurls;parentmodelurls;language;modal;model;view;renderer;toast;metadata;modalservice;injector;urlUpload;uploadurls=[];urlsLoaded=new u.vpe;componentconfig={};constructor(e,s,t,l,i,n,r,d,o,a,u){this._modelurls=e,this.parentmodelurls=s,this.language=t,this.modal=l,this.model=i,this.view=n,this.renderer=r,this.toast=d,this.metadata=o,this.modalservice=a,this.injector=u,this._modelurls.module=this.model.module,this._modelurls.id=this.model.id}get isHidden(){return!!this.componentconfig.requiredmodelstate&&!this.model.checkModelState(this.componentconfig.requiredmodelstate)}get modelurls(){return this.parentmodelurls&&this.parentmodelurls.module==this.model.module&&this.parentmodelurls.id==this.model.id?this.parentmodelurls:this._modelurls}get editing(){return this.model.isEditing&&(!this.view||this.view.isEditable)}loadUrl(){}setUploadUrl(e){}ngAfterViewInit(){this.parentmodelurls||setTimeout((()=>this.loadUrl()),10)}preventdefault(e){(e.dataTransfer.items.length>=1&&this.hasOneItemsFile(e.dataTransfer.items)||e.dataTransfer.urls.length>0)&&(e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy")}hasOneItemsFile(e){for(let s of e)if("url"==s.kind)return!0;return!1}onDrop(e){this.preventdefault(e);let s=e.dataTransfer.urls;s&&s.length>=1&&this.doUpload(s)}fileDrop(e){e&&e.length>=1&&this.doUpload(e)}uploadUrl(){let e=this.urlUpload.element.nativeElement.urls;this.doUpload(e)}doUpload(e){}static ɵfac=function(e){return new(e||SpiceUrlsPanel)(u.Y36(c.g),u.Y36(c.g,12),u.Y36(m.d),u.Y36(p.o),u.Y36(g.o),u.Y36(h.e,8),u.Y36(u.Qsj),u.Y36(f.A),u.Y36(b.Pu),u.Y36(p.o),u.Y36(u.zs3))};static ɵcmp=u.Xpm({type:SpiceUrlsPanel,selectors:[["spice-urls-panel"]],viewQuery:function(e,s){if(1&e&&u.Gf(C,5,u.s_b),2&e){let e;u.iGM(e=u.CRH())&&(s.urlUpload=e.first)}},outputs:{urlsLoaded:"urlsLoaded"},features:[u._Bn([c.g])],decls:1,vars:1,consts:[["class","slds-box slds-m-around--xx-small",3,"system-drop-file",4,"ngIf"],[1,"slds-box","slds-m-around--xx-small",3,"system-drop-file"],[1,"slds-card__body--inner","slds-grid","slds-wrap","slds-grid--pull-padded"],["class","slds-media slds-size--1-of-1",3,"modelurls","urlItem","editmode",4,"ngFor","ngForOf"],["class","slds-p-around--x-small slds-align--absolute-center",4,"ngIf"],[1,"slds-media","slds-size--1-of-1",3,"modelurls","urlItem","editmode"],[1,"slds-p-around--x-small","slds-align--absolute-center"],[1,"slds-grid","slds-grid--vertical-align-center"],["size","14"],["label","LBL_INITIALIZING",1,"slds-p-left--x-small"]],template:function(e,s){1&e&&u.YNc(0,J,5,2,"div",0),2&e&&u.Q6J("ngIf",!s.isHidden)},dependencies:[l.sg,l.O5,_._,x.W,v.M,A],encapsulation:2})}return SpiceUrlsPanel})();var q=t(33369);function D(e,s){if(1&e&&(u.TgZ(0,"span",3),u._uU(1),u.qZA()),2&e){const e=u.oxw();u.xp6(1),u.Oqu(e.urlcount)}}let N=(()=>{class SpiceUrlsPanelHeader{model;modelurls;language;broadcast;broadcastSubscription={};urlcount=0;constructor(e,s,t,l){this.model=e,this.modelurls=s,this.language=t,this.broadcast=l,this.broadcastSubscription=this.broadcast.message$.subscribe((e=>{this.handleMessage(e)}))}ngOnInit(){this.modelurls.module=this.model.module,this.modelurls.id=this.model.id,this.modelurls.getCount().subscribe((e=>{this.urlcount=e}))}get hasUrls(){return this.urlcount>0}handleMessage(e){if((e.messagedata.module===this.model.module||e.messagedata.id===this.model.id)&&"urls.loaded"===e.messagetype)this.urlcount=e.messagedata.urlcount}ngOnDestroy(){this.broadcastSubscription.unsubscribe()}static ɵfac=function(e){return new(e||SpiceUrlsPanelHeader)(u.Y36(g.o),u.Y36(c.g),u.Y36(m.d),u.Y36(q.f))};static ɵcmp=u.Xpm({type:SpiceUrlsPanelHeader,selectors:[["spice-urls-panel-header"]],features:[u._Bn([c.g])],decls:4,vars:1,consts:[[1,"slds-grid","slds-grid--vertical-align-center"],["label","LBL_URLS"],["class","slds-theme_warning slds-m-horizontal--xx-small slds-align--absolute-center spice-counter",4,"ngIf"],[1,"slds-theme_warning","slds-m-horizontal--xx-small","slds-align--absolute-center","spice-counter"]],template:function(e,s){1&e&&(u.TgZ(0,"div",0)(1,"span"),u._UZ(2,"system-label",1),u.qZA(),u.YNc(3,D,2,1,"span",2),u.qZA()),2&e&&(u.xp6(3),u.Q6J("ngIf",s.hasUrls))},dependencies:[l.O5,_._],encapsulation:2})}return SpiceUrlsPanelHeader})();function O(e,s){if(1&e&&u._UZ(0,"spice-url-item",3),2&e){const e=s.$implicit,t=u.oxw(2);u.Q6J("modelurls",t.modelurls)("urlItem",e)("editmode",!1)("ngClass",t.getItemClass())}}function E(e,s){if(1&e&&(u.TgZ(0,"div",1),u.YNc(1,O,1,4,"spice-url-item",2),u.qZA()),2&e){const e=u.oxw();u.Q6J("ngStyle",e.getCompStyle())("ngClass",e.componentconfig.addClasses),u.xp6(1),u.Q6J("ngForOf",e.modelurls.urls)}}let k=(()=>{class SpiceUrlsList{modelurls;language;model;cdRef;componentconfig={};constructor(e,s,t,l){this.modelurls=e,this.language=s,this.model=t,this.cdRef=l,this.modelurls.module=this.model.module,this.modelurls.id=this.model.id}loadFiles(){this.modelurls.getUrls().subscribe((e=>{this.cdRef.detectChanges()}))}ngAfterViewInit(){setTimeout((()=>this.loadFiles()),10)}getCompStyle(){return{marginRight:this.componentconfig.horizontal?"-16px":void 0,marginBottom:this.componentconfig.horizontal?"-8px":void 0}}getItemClass(){return this.componentconfig.horizontal?"slds-m-right_medium slds-m-bottom_x-small":"slds-size--1-of-1"}static ɵfac=function(e){return new(e||SpiceUrlsList)(u.Y36(c.g),u.Y36(m.d),u.Y36(g.o),u.Y36(u.sBO))};static ɵcmp=u.Xpm({type:SpiceUrlsList,selectors:[["spice-urls-list"]],features:[u._Bn([c.g])],decls:1,vars:1,consts:[["class","slds-m-vertical--xx-small slds-card__body--inner slds-grid slds-wrap slds-grid--pull-padded",3,"ngStyle","ngClass",4,"ngIf"],[1,"slds-m-vertical--xx-small","slds-card__body--inner","slds-grid","slds-wrap","slds-grid--pull-padded",3,"ngStyle","ngClass"],["class","slds-media",3,"modelurls","urlItem","editmode","ngClass",4,"ngFor","ngForOf"],[1,"slds-media",3,"modelurls","urlItem","editmode","ngClass"]],template:function(e,s){1&e&&u.YNc(0,E,2,3,"div",0),2&e&&u.Q6J("ngIf",s.modelurls.urls.length>0)},dependencies:[l.mk,l.sg,l.O5,l.PC,A],encapsulation:2,changeDetection:0})}return SpiceUrlsList})();var Q=t(26625),z=t(14505),F=t(59621),P=t(83499),B=t(75767),j=t(1916);let R=(()=>{class SpiceUrlsEditModal{configurationService;toast;language;model;backend;url={};inputData={};self={};constructor(e,s,t,l,i){this.configurationService=e,this.toast=s,this.language=t,this.model=l,this.backend=i}close(){this.self.destroy()}save(){const e={description:this.inputData.description,url_name:this.inputData.url_name?this.inputData.url_name:""};this.backend.postRequest("common/spiceurls/"+this.url.id,{},e).subscribe({next:e=>{e&&e.success?(this.inputData.description!=this.url.description&&(this.url.description=this.inputData.description),this.inputData.url_name!=this.url.url_name&&(this.url.url_name=this.inputData.url_name),this.toast.sendToast(this.language.getLabel("LBL_DATA_SAVED"),"success")):this.toast.sendToast(this.language.getLabel("ERR_FAILED_TO_EXECUTE"),"error"),this.self.destroy()},error:()=>{this.toast.sendToast(this.language.getLabel("ERR_NETWORK"),"error"),this.self.destroy()}})}static ɵfac=function(e){return new(e||SpiceUrlsEditModal)(u.Y36(Q.C),u.Y36(f.A),u.Y36(m.d),u.Y36(g.o),u.Y36(z.y))};static ɵcmp=u.Xpm({type:SpiceUrlsEditModal,selectors:[["spice-urls-edit-modal"]],inputs:{url:"url"},decls:25,vars:3,consts:[[3,"close"],["label","LBL_EDIT"],[1,"slds-form-element"],[1,"slds-form-element__label"],["label","LBL_URL"],[1,"slds-form-element__control"],["type","text","disabled","",1,"slds-input",3,"ngModel","ngModelChange"],["label","LBL_DISPLAY_NAME"],["type","text",1,"slds-input",3,"ngModel","ngModelChange"],[1,"slds-form-element","slds-p-horizontal--xx-small"],["label","LBL_DESCRIPTION"],[1,"slds-textarea","slds-scrollable--y","slds-m-vertical--xx-small",2,"height","250px",3,"ngModel","ngModelChange"],[1,"slds-grid"],[1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_CANCEL"],[1,"slds-button","slds-button--brand",3,"click"],["label","LBL_SAVE"]],template:function(e,s){1&e&&(u.TgZ(0,"system-modal")(1,"system-modal-header",0),u.NdJ("close",(function(){return s.close()})),u._UZ(2,"system-label",1),u.qZA(),u.TgZ(3,"system-modal-content")(4,"div",2)(5,"label",3),u._UZ(6,"system-label",4),u.qZA(),u.TgZ(7,"div",5)(8,"input",6),u.NdJ("ngModelChange",(function(e){return s.url.url=e})),u.qZA()()(),u.TgZ(9,"div",2)(10,"label",3),u._UZ(11,"system-label",7),u.qZA(),u.TgZ(12,"div",5)(13,"input",8),u.NdJ("ngModelChange",(function(e){return s.inputData.url_name=e})),u.qZA()()(),u.TgZ(14,"div",9)(15,"label",3),u._UZ(16,"system-label",10),u.qZA(),u.TgZ(17,"div",5)(18,"textarea",11),u.NdJ("ngModelChange",(function(e){return s.inputData.description=e})),u.qZA()()()(),u.TgZ(19,"system-modal-footer")(20,"div",12)(21,"button",13),u.NdJ("click",(function(){return s.close()})),u._UZ(22,"system-label",14),u.qZA(),u.TgZ(23,"button",15),u.NdJ("click",(function(){return s.save()})),u._UZ(24,"system-label",16),u.qZA()()()()),2&e&&(u.xp6(8),u.Q6J("ngModel",s.url.url),u.xp6(5),u.Q6J("ngModel",s.inputData.url_name),u.xp6(5),u.Q6J("ngModel",s.inputData.description))},dependencies:[i.Fj,i.JJ,i.On,_._,F.j,P.x,B.p,j.y],encapsulation:2})}return SpiceUrlsEditModal})(),H=(()=>{class ModuleSpiceUrls{static ɵfac=function(e){return new(e||ModuleSpiceUrls)};static ɵmod=u.oAB({type:ModuleSpiceUrls});static ɵinj=u.cJS({imports:[l.ez,i.u5,r.ObjectFields,d.GlobalComponents,o.ObjectComponents,a.SystemComponents,n.o]})}return ModuleSpiceUrls})();("undefined"==typeof ngJitMode||ngJitMode)&&u.kYT(H,{declarations:[M,N,A,k,R],imports:[l.ez,i.u5,r.ObjectFields,d.GlobalComponents,o.ObjectComponents,a.SystemComponents,n.o]})}}]);