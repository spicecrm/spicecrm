/*!
 * 
 *                     aacService
 *
 *                     release: 2023.02.001
 *
 *                     date: 2023-08-15 08:42:29
 *
 *                     build: 2023.02.001.1692081749029
 *
 */
"use strict";(self.webpackChunkcore=self.webpackChunkcore||[]).push([["src_modules_documents_moduledocuments_ts"],{6340:(e,t,i)=>{i.r(t),i.d(t,{ModuleDocuments:()=>G});var s=i(1180),o=i(4755),n=i(3190),l=i(4826),a=i(6490),d=i(3735),c=i(4357),u=i(5030),r=i(7040),m=i(2242),h=i(5710),p=i(2032),g=i(2294),f=i(5329),b=i(4154),v=i(3348),Z=i(4044),_=i(6040),y=i(4505),C=i(6367),Y=i(3208),D=i(2656);function R(e,t){if(1&e&&m._UZ(0,"field-label",4),2&e){const e=m.oxw();m.Q6J("fieldname",e.fieldname)("fieldconfig",e.fieldconfig)}}function T(e,t){if(1&e){const e=m.EpF();m.TgZ(0,"button",5),m.NdJ("click",(function(){m.CHM(e);const t=m.oxw();return m.KtG(t.activateRevision())})),m._UZ(1,"system-button-icon",6),m.qZA()}}let w=(()=>{var e;class fieldDocumentRevisionStatus extends r.O{constructor(e,t,i,o,n,l,a,d,c){super(e,i,o,n,l),(0,s.Z)(this,"model",void 0),(0,s.Z)(this,"navigation",void 0),(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"metadata",void 0),(0,s.Z)(this,"router",void 0),(0,s.Z)(this,"modal",void 0),(0,s.Z)(this,"relatedmodels",void 0),(0,s.Z)(this,"backend",void 0),(0,s.Z)(this,"parent",void 0),this.model=e,this.navigation=t,this.language=o,this.metadata=n,this.router=l,this.modal=a,this.relatedmodels=d,this.backend=c}ngOnInit(){super.ngOnInit(),this.parent=this.navigation.getRegisteredModel(this.model.getField("document_id"),"Documents"),this.subscriptions.add(this.parent.observeFieldChanges("status_id").subscribe((e=>{"Expired"==e&&(this.value="a")})))}getValue(){return this.language.getFieldDisplayOptionValue(this.model.module,this.fieldname,this.value)}get canActivate(){return!this.model.isEditing&&"c"==this.value&&this.model.checkAccess("edit")&&"Expired"!=this.parent.getField("status_id")}activateRevision(){this.modal.prompt("confirm",this.language.getLabel("MSG_ACTIVATE_REVISION","","long")).subscribe((e=>{e&&(this.model.startEdit(),this.value="r",this.model.save().subscribe((e=>{this.parent&&this.parent.setField("revision",this.model.getField("revision"))})))}))}}return e=fieldDocumentRevisionStatus,(0,s.Z)(fieldDocumentRevisionStatus,"ɵfac",(function(t){return new(t||e)(m.Y36(h.o),m.Y36(p.G),m.Y36(g.e),m.Y36(f.d),m.Y36(b.Pu),m.Y36(v.F0),m.Y36(Z.o),m.Y36(_.j),m.Y36(y.y))})),(0,s.Z)(fieldDocumentRevisionStatus,"ɵcmp",m.Xpm({type:e,selectors:[["ng-component"]],features:[m.qOj],decls:6,vars:7,consts:[[3,"fieldname","fieldconfig",4,"ngIf"],[3,"fielddisplayclass","editable","fieldconfig","fieldid"],[1,"slds-grid","slds-grid--vertical-align-center"],["class","slds-button slds-button--icon slds-theme--warning slds-m-left--x-small",3,"click",4,"ngIf"],[3,"fieldname","fieldconfig"],[1,"slds-button","slds-button--icon","slds-theme--warning","slds-m-left--x-small",3,"click"],["icon","light_bulb"]],template:function(e,t){1&e&&(m.YNc(0,R,1,2,"field-label",0),m.TgZ(1,"field-generic-display",1)(2,"div",2)(3,"span"),m._uU(4),m.qZA(),m.YNc(5,T,2,0,"button",3),m.qZA()()),2&e&&(m.Q6J("ngIf",t.displayLabel),m.xp6(1),m.Q6J("fielddisplayclass",t.fielddisplayclass)("editable",t.isEditable())("fieldconfig",t.fieldconfig)("fieldid",t.fieldid),m.xp6(3),m.Oqu(t.getValue()),m.xp6(1),m.Q6J("ngIf",t.canActivate))},dependencies:[o.O5,C.q,Y.D,D.J],encapsulation:2})),fieldDocumentRevisionStatus})();var M=i(727),x=i(6625),J=i(3463);let O=(()=>{var e;class DocumentCreateRevisionButton{constructor(e,t,i,o,n,l,a){(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"model",void 0),(0,s.Z)(this,"modal",void 0),(0,s.Z)(this,"backend",void 0),(0,s.Z)(this,"configuration",void 0),(0,s.Z)(this,"viewContainerRef",void 0),(0,s.Z)(this,"relatedmodels",void 0),(0,s.Z)(this,"templates",[]),(0,s.Z)(this,"forcedFormat",void 0),(0,s.Z)(this,"modalTitle",void 0),(0,s.Z)(this,"noDownload",void 0),(0,s.Z)(this,"handBack",void 0),(0,s.Z)(this,"buttonText",void 0),(0,s.Z)(this,"subscriptions",new M.w0),(0,s.Z)(this,"actionconfig",void 0),this.language=e,this.model=t,this.modal=i,this.backend=o,this.configuration=n,this.viewContainerRef=l,this.relatedmodels=a}openOutput(){this.templates.length>0?(this.templates.sort(((e,t)=>e.name>t.name?1:-1)),this.modal.openModal("DocumentCreateRevisionModal",!0,this.viewContainerRef.injector).subscribe((e=>{let t=new m.vpe;e.instance.templates=this.templates,e.instance.modalTitle="LBL_CREATE_REVISION",e.instance.handBack=t,this.subscriptions.add(t.subscribe((e=>{this.backend.postRequest(`module/Documents/${this.model.id}/revisionfrombase64`,"",{file_name:e.name+".pdf",file:e.content,file_mime_type:"application/pdf",documentrevisionstatus:"r"}).subscribe((e=>{this.relatedmodels.getData(),this.model.getData(!1,"",!0)}))})))}))):this.modal.info("No Templates Found","there are no Output templates defined for the Module")}ngOnDestroy(){this.subscriptions.unsubscribe()}execute(){let e=this.configuration.getData("OutputTemplates");e&&e[this.model.module]?(this.templates=e[this.model.module],this.openOutput()):(e={},this.modal.openModal("SystemLoadingModal",!1).subscribe((e=>{e.instance.messagelabel="Loading Templates",this.backend.getRequest("module/OutputTemplates/formodule/"+this.model.module,{}).subscribe((t=>{e.instance.self.destroy(),this.configuration.setData("OutputTemplates",t),this.templates=t,this.openOutput()}),(t=>{e.instance.self.destroy()}))})))}}return e=DocumentCreateRevisionButton,(0,s.Z)(DocumentCreateRevisionButton,"ɵfac",(function(t){return new(t||e)(m.Y36(f.d),m.Y36(h.o),m.Y36(Z.o),m.Y36(y.y),m.Y36(x.C),m.Y36(m.s_b),m.Y36(_.j))})),(0,s.Z)(DocumentCreateRevisionButton,"ɵcmp",m.Xpm({type:e,selectors:[["document-create-revision-button"]],decls:1,vars:0,consts:[["label","LBL_CREATE_REVISION"]],template:function(e,t){1&e&&m._UZ(0,"system-label",0)},dependencies:[J._],encapsulation:2})),DocumentCreateRevisionButton})();var A=i(2486),k=i(6550),E=i(3507),I=i(6163),L=i(9621),B=i(3499),q=i(5767),N=i(1916),F=i(4664);function Q(e,t){if(1&e&&(m.TgZ(0,"option",20),m._uU(1),m.qZA()),2&e){const e=t.$implicit;m.Q6J("ngValue",e),m.xp6(1),m.AsE("",e.name," (",e.language,")")}}function S(e,t){if(1&e&&m._UZ(0,"iframe",21),2&e){const e=m.oxw();m.Q6J("srcdoc",e.sanitizedTemplated,m.oJD)}}function U(e,t){if(1&e&&m._UZ(0,"object",22),2&e){const e=m.oxw();m.Q6J("data",e.blobUrl,m.uOi)}}function j(e,t){1&e&&(m.TgZ(0,"div",23),m._UZ(1,"system-spinner"),m.qZA())}function V(e,t){1&e&&(m.TgZ(0,"div",23),m._UZ(1,"system-label",24),m.qZA())}let z=(()=>{var e;class DocumentCreateRevisionModal extends A.s{constructor(e,t,i,o,n,l,a,d,c,u){super(e,t,i,o,n,l,c,a,d,u),(0,s.Z)(this,"language",void 0),(0,s.Z)(this,"model",void 0),(0,s.Z)(this,"metadata",void 0),(0,s.Z)(this,"modal",void 0),(0,s.Z)(this,"view",void 0),(0,s.Z)(this,"backend",void 0),(0,s.Z)(this,"sanitizer",void 0),(0,s.Z)(this,"viewContainerRef",void 0),(0,s.Z)(this,"outputModalService",void 0),(0,s.Z)(this,"modelutilities",void 0),this.language=e,this.model=t,this.metadata=i,this.modal=o,this.view=n,this.backend=l,this.sanitizer=a,this.viewContainerRef=d,this.outputModalService=c,this.modelutilities=u}create(){this.handBack.emit({name:this.selected_template.name,content:this.contentForHandBack}),this.close()}}return e=DocumentCreateRevisionModal,(0,s.Z)(DocumentCreateRevisionModal,"ɵfac",(function(t){return new(t||e)(m.Y36(f.d),m.Y36(h.o),m.Y36(b.Pu),m.Y36(Z.o),m.Y36(g.e),m.Y36(y.y),m.Y36(k.H7),m.Y36(m.s_b),m.Y36(E.w),m.Y36(I.A))})),(0,s.Z)(DocumentCreateRevisionModal,"ɵcmp",m.Xpm({type:e,selectors:[["object-action-output-bean-modal"]],features:[m._Bn([g.e]),m.qOj],decls:22,vars:10,consts:[["size","large"],[3,"close"],[3,"label"],["margin","none"],[1,"slds-modal__content"],[1,"slds-form-element__control","slds-grid","slds-grid--vertical-align-center","slds-p-around--small"],[1,"slds-col","slds-p-right--x-small"],["label","LBL_TEMPLATE"],[1,"slds-col","slds-select","slds-grow",3,"ngModel","disabled","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"slds-grid",2,"height","70vh"],[1,"slds-p-around--small",2,"height","100%","width","200%"],[1,"slds-m-top--small","slds-border--top","slds-border--right","slds-border--left","slds-border--bottom",2,"width","100%","height","calc(100% - 50px)"],["frameBorder","0","style","width: 100%;height: 100%;",3,"srcdoc",4,"ngIf"],["type","application/pdf","width","100%","height","100%",3,"data",4,"ngIf"],["class","slds-align--absolute-center","style","height: 100%;",4,"ngIf"],[1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_CANCEL"],[1,"slds-button","slds-button--brand",3,"disabled","click"],["label","LBL_CREATE"],[3,"ngValue"],["frameBorder","0",2,"width","100%","height","100%",3,"srcdoc"],["type","application/pdf","width","100%","height","100%",3,"data"],[1,"slds-align--absolute-center",2,"height","100%"],["label","LBL_SELECT_TEMPLATE"]],template:function(e,t){1&e&&(m.TgZ(0,"system-modal",0)(1,"system-modal-header",1),m.NdJ("close",(function(){return t.close()})),m._UZ(2,"system-label",2),m.qZA(),m.TgZ(3,"system-modal-content",3)(4,"div",4)(5,"div",5)(6,"label",6),m._UZ(7,"system-label",7),m.qZA(),m.TgZ(8,"select",8),m.NdJ("ngModelChange",(function(e){return t.selected_template=e})),m.YNc(9,Q,2,3,"option",9),m.qZA()(),m.TgZ(10,"div",10)(11,"div",11)(12,"div",12),m.YNc(13,S,1,1,"iframe",13),m.YNc(14,U,1,1,"object",14),m.YNc(15,j,2,0,"div",15),m.YNc(16,V,2,0,"div",15),m.qZA()()()()(),m.TgZ(17,"system-modal-footer")(18,"button",16),m.NdJ("click",(function(){return t.close()})),m._UZ(19,"system-label",17),m.qZA(),m.TgZ(20,"button",18),m.NdJ("click",(function(){return t.create()})),m._UZ(21,"system-label",19),m.qZA()()()),2&e&&(m.xp6(2),m.Q6J("label",t.modalTitle),m.xp6(6),m.Q6J("ngModel",t.selected_template)("disabled",0==t.templates.length),m.xp6(1),m.Q6J("ngForOf",t.templates),m.xp6(2),m.Q6J("@slideInOut",t.expanded?"open":"closed"),m.xp6(2),m.Q6J("ngIf","html"===t.selected_format&&!t.loading_output&&t.selected_template),m.xp6(1),m.Q6J("ngIf","pdf"===t.selected_format&&!t.loading_output&&t.blobUrl),m.xp6(1),m.Q6J("ngIf",t.loading_output),m.xp6(1),m.Q6J("ngIf",!t.selected_template&&!t.loading_output),m.xp6(4),m.Q6J("disabled",!t.selected_template||t.loading_output))},dependencies:[o.sg,o.O5,u.YN,u.Kr,u.EJ,u.JJ,u.On,J._,L.j,B.x,q.p,N.y,F.W],encapsulation:2})),DocumentCreateRevisionModal})(),G=(()=>{var e;class ModuleDocuments{}return e=ModuleDocuments,(0,s.Z)(ModuleDocuments,"ɵfac",(function(t){return new(t||e)})),(0,s.Z)(ModuleDocuments,"ɵmod",m.oAB({type:e})),(0,s.Z)(ModuleDocuments,"ɵinj",m.cJS({imports:[o.ez,u.u5,n.ObjectFields,l.GlobalComponents,a.ObjectComponents,d.SystemComponents,c.o]})),ModuleDocuments})();("undefined"==typeof ngJitMode||ngJitMode)&&m.kYT(G,{declarations:[w,O,z],imports:[o.ez,u.u5,n.ObjectFields,l.GlobalComponents,a.ObjectComponents,d.SystemComponents,c.o]})}}]);