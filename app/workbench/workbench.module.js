/*
SpiceUI 2018.10.001

Copyright (c) 2016-present, aac services.k.s - All rights reserved.
Redistribution and use in source and binary forms, without modification, are permitted provided that the following conditions are met:
- Redistributions of source code must retain this copyright and license notice, this list of conditions and the following disclaimer.
- Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
- If used the SpiceCRM Logo needs to be displayed in the upper left corner of the screen in a minimum dimension of 31x31 pixels and be clearly visible, the icon needs to provide a link to http://www.spicecrm.io
THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

*/

/** 
 * Â© 2015 - 2021 aac services k.s. All rights reserved.
 * release: 2021.02.001
 * date: 2021-06-24 11:36:53
 * build: 2021.02.001.1624527413323
 **/
"use strict";var __extends=this&&this.__extends||function(){var l=function(e,s){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,s){e.__proto__=s}||function(e,s){for(var t in s)Object.prototype.hasOwnProperty.call(s,t)&&(e[t]=s[t])})(e,s)};return function(e,s){if("function"!=typeof s&&null!==s)throw new TypeError("Class extends value "+String(s)+" is not a constructor or null");function t(){this.constructor=e}l(e,s),e.prototype=null===s?Object.create(s):(t.prototype=s.prototype,new t)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var s,t=1,l=arguments.length;t<l;t++)for(var i in s=arguments[t])Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i]);return e}).apply(this,arguments)},__decorate=this&&this.__decorate||function(e,s,t,l){var i,a=arguments.length,o=a<3?s:null===l?l=Object.getOwnPropertyDescriptor(s,t):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,s,t,l);else for(var n=e.length-1;0<=n;n--)(i=e[n])&&(o=(a<3?i(o):3<a?i(s,t,o):i(s,t))||o);return 3<a&&o&&Object.defineProperty(s,t,o),o},__metadata=this&&this.__metadata||function(e,s){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,s)},__spreadArray=this&&this.__spreadArray||function(e,s){for(var t=0,l=s.length,i=e.length;t<l;t++,i++)e[i]=s[t];return e};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ValidationRulesActions=exports.ValidationRulesConditions=exports.MaybeJsonPipe=exports.ValidationRulesManager=exports.ComponentsetManagerEditDialog=exports.ComponentsetManagerAddDialog=exports.ComponentsetManagerComponentsetDetails=exports.ComponentsetManager=exports.ActionsetManagerAddDialog=exports.ActionsetManagerActionDetails=exports.ActionsetManager=exports.FieldsetManagerEditDialog=exports.FieldsetManagerAddDialog=exports.FieldsetManagerFieldDetails=exports.FieldsetManagerFieldsetDetails=exports.FieldsetManager=exports.DomainManagerAddValidationValueModal=exports.DomainManagerAddValidation=exports.DomainManagerSelectValidation=exports.DomainManagerAddFieldModal=exports.DomainManagerAddDefinitionModal=exports.DomainManagerFieldValidation=exports.DomainManagerFieldDetails=exports.DomainManagerFieldTabs=exports.DomainManagerFields=exports.DomainManagerDefinitions=exports.DomainManager=exports.DictionaryManagerFields=exports.DictionaryManagerIndexDetails=exports.DictionaryManagerIndexAdd=exports.DictionaryManagerIndexes=exports.DictionaryManagerRelationshipContainerParent=exports.DictionaryManagerRelationshipAddParent=exports.DictionaryManagerRelationshipContainerManyToMany=exports.DictionaryManagerRelationshipAddManyToMany=exports.DictionaryManagerRelationshipContainerOneToMany=exports.DictionaryManagerRelationshipAddOneToMany=exports.DictionaryManagerRelationshipAdd=exports.DictionaryManagerRelationshipsDetails=exports.DictionaryManagerRelationships=exports.DictionaryManagerAddItemModal=exports.DictionaryManagerAddDefinitionModal=exports.DictionaryManagerItemDetails=exports.DictionaryManagerItems=exports.DictionaryManagerDefinitionTabs=exports.DictionaryManagerDefinitions=exports.DictionaryManager=exports.DictionaryManagerItemStatus=exports.dictionarymanager=exports.domainmanager=void 0,exports.CRMLogViewerList=exports.CRMLogViewer=exports.ObjectRepositoryExport=exports.ObjectRepositoryManagerAddModule=exports.ObjectRepositoryManagerAddRepo=exports.ObjectRepositoryManager=exports.ObjectRepositoryManagerFilter=exports.WorkbenchConfigOptionMethod=exports.WorkbenchConfigOptionLabel=exports.WorkbenchConfigOptionDefault=exports.WorkbenchConfigOptionModule=exports.WorkbenchConfigOptionComponentset=exports.WorkbenchConfigOptionBoolean=exports.WorkbenchConfigOptionActionset=exports.WorkbenchConfigOptionModulefilter=exports.WorkbenchConfigOptionFieldset=exports.FieldsetManagerCopyDialog=exports.ModuleConfigAddDialog=exports.WorkbenchConfigLabel=exports.WorkbenchConfig=exports.WorkbenchHeaderControls=exports.WorkbenchHeader=exports.ModuleConfigManager=exports.ConfigTransfer=exports.GoogleCalendarManager=exports.StyleCacheCleaner=exports.ConfigCleaner=exports.SelectTreeAddDialog=exports.SelectTreeComponent=exports.MailboxesProcessors=exports.MailboxesTransportManager=exports.MailboxesImapSmtpTrafficManager=exports.MailboxesIMAPSMTPSelectFoldersModal=exports.MailboxManagerAddDialog=exports.MailboxesEWSSelectFoldersModal=exports.MailboxesEWSTrafficManager=exports.MailboxesA1TrafficManager=exports.MailboxesA1SmsTrafficManager=exports.MailboxesTwillioTrafficManager=exports.MailboxesSendgridTrafficManager=exports.MailboxesMailgunTrafficManager=exports.MailboxesGmailTrafficManager=exports.MailboxesmanagerTestIMAPModal=exports.MailboxesmanagerTestModal=exports.MailboxesTransportsEnum=exports.MailboxesManager=exports.LanguageLabelModal=exports.SortPipe=exports.LanguageLabelManagerComponent=exports.LanguageTranslationsManager=void 0,exports.WorkbenchModule=exports.DashletGeneratorDashletDetails=exports.DashletGeneratorDashlets=exports.DashletGenerator=exports.ModuleFilterBuilderFilterDetails=exports.ModuleFilterBuilderFilters=exports.ModuleFilterBuilder=exports.APIlogViewerModal=exports.APIlogViewer=exports.CRMLogViewerListModal=exports.CRMLogViewerModal=void 0;var common_1=require("@angular/common"),core_1=require("@angular/core"),forms_1=require("@angular/forms"),systemcomponents_1=require("../systemcomponents/systemcomponents"),directives_1=require("../directives/directives"),objectfields_1=require("../objectfields/objectfields"),objectcomponents_1=require("../objectcomponents/objectcomponents"),globalcomponents_1=require("../globalcomponents/globalcomponents"),drag_drop_1=require("@angular/cdk/drag-drop"),services_1=require("../services/services"),rxjs_1=require("rxjs"),router_1=require("@angular/router"),domainmanager=function(){function e(e,s,t,l){for(var i in this.backend=e,this.metadata=s,this.language=t,this.modelutilities=l,this.domaindefinitions=[],this.domainfields=[],this.domainfieldvalidations=[],this.domainfieldvalidationvalues=[],this.languagelabels=[],this.languagetranslations=[],this.languagecustomlabels=[],this.languagecustomtranslations=[],this.dbtypes=["non-db","varchar","char","text","mediumtext","longtext","date","datetime","int","bigint","double","bool"],this.fieldtypes=[],this.loadDomains(),this.metadata.fieldTypeMappings)this.fieldtypes.push(i);this.fieldtypes.sort()}return e.prototype.loadDomains=function(){var s=this;this.backend.getRequest("dictionary/domains").subscribe(function(e){s.domaindefinitions=e.domaindefinitions,s.domainfields=e.domainfields,s.domainfieldvalidations=e.domainfieldvalidations,s.domainfieldvalidationvalues=e.domainfieldvalidationvalues,s.loaded=JSON.stringify(e)})},e.prototype.getValidationById=function(s){return this.domainfieldvalidations.find(function(e){return e.id==s})},e.prototype.getValdiationValuesdById=function(s){for(var e=this.domainfieldvalidationvalues.filter(function(e){return e.sysdomainfieldvalidation_id==s&&"c"==e.scope}),t=function(s){-1==e.findIndex(function(e){return e.enumvalue==s.enumvalue})&&e.push(s)},l=0,i=this.domainfieldvalidationvalues.filter(function(e){return e.sysdomainfieldvalidation_id==s&&"c"!=e.scope});l<i.length;l++){t(i[l])}return e},e.prototype.getStatusColor=function(e){switch(e){case"a":return"slds-icon-text-success";case"i":return"slds-icon-text-light";default:return"slds-icon-text-warning"}},e.prototype.save=function(){var e=this.determineChangedRecords();0<this.languagelabels.length&&(e.languagelabels=this.languagelabels,e.languagetranslations=this.languagetranslations),0<this.languagecustomlabels.length&&(e.languagecustomlabels=this.languagecustomlabels,e.languagecustomtranslations=this.languagecustomtranslations),this.backend.postRequest("dictionary/domains",{},e).subscribe(function(e){})},e.prototype.determineChangedRecords=function(){var t=JSON.parse(this.loaded),l={domaindefinitions:[],domainfields:[],domainfieldvalidations:[],domainfieldvalidationvalues:[]};for(var i in l)for(var e=function(s){var e=t[i].find(function(e){return e.id==s.id});(!e||e&&JSON.stringify(e)!=JSON.stringify(s))&&l[i].push(s)},s=0,a=this[i];s<a.length;s++){e(a[s])}return l},e.prototype.generateENUMSFromModules=function(){var u=this;this.backend.getRequest("dictionary/domains/appliststrings").subscribe(function(m){function e(r){function e(s){if(c[s].options&&(m.en_us.global[c[s].options]||m.en_us.custom[c[s].options])&&c[s].type.includes("enum")&&!u.domaindefinitions.find(function(e){return e.name==r.toLowerCase()+"_"+s})){var e=m.en_us.global[c[s].options]?"g":"c",t=u.modelutilities.generateGuid();u.domaindefinitions.push({id:t,name:r.toLowerCase()+"_"+s,scope:e,fieldtype:c[s].type,status:"a",deleted:0});var l=u.modelutilities.generateGuid();u.domainfieldvalidations.push({id:l,name:c[s].options,validation_type:"enum",scope:e,status:"a",deleted:0}),u.domainfields.push({id:u.modelutilities.generateGuid(),name:s,dbtype:"enum"==c[s].type?"varchar":"text",len:c[s].len?c[s].len:"255",sysdomaindefinition_id:t,sysdomainfieldvalidation_id:l,scope:e,status:"a",deleted:0});var i=u.language.languagedata.applist[c[s].options],a=0;for(var o in i){if(u.domainfieldvalidationvalues.push({id:u.modelutilities.generateGuid(),sysdomainfieldvalidation_id:l,label:o?("VAL_"+c[s].options+"_"+o).toUpperCase():"",minvalue:o,sequence:a,comment:"",scope:e,status:"a",deleted:0}),o&&!u.language.languagedata.applang[("VAL_"+c[s].options+"_"+o).toUpperCase()]){var n=u.modelutilities.generateGuid();for(var d in"g"==e?u.languagelabels.push({id:n,name:("VAL_"+c[s].options+"_"+o).toUpperCase()}):u.languagecustomlabels.push({id:n,name:("VAL_"+c[s].options+"_"+o).toUpperCase()}),m)m[d].global[c[s].options]&&m[d].global[c[s].options][o]&&(u.languagetranslations.push({id:u.modelutilities.generateGuid(),syslanguagelabel_id:n,syslanguage:d,translation_default:m[d].global[c[s].options][o]}),d==u.language.currentlanguage&&u.language.addLabel(("VAL_"+c[s].options+"_"+o).toUpperCase(),m[d].global[c[s].options][o])),m[d].custom[c[s].options]&&m[d].custom[c[s].options][o]&&(u.languagecustomtranslations.push({id:u.modelutilities.generateGuid(),syslanguagelabel_id:n,syslanguage:d,translation_default:m[d].custom[c[s].options][o]}),d==u.language.currentlanguage&&u.language.addLabel(("VAL_"+c[s].options+"_"+o).toUpperCase(),m[d].custom[c[s].options][o]))}a++}}}var c=u.metadata.fieldDefs[r];for(var s in c)e(s)}for(var s in u.metadata.fieldDefs)e(s)})},e=__decorate([core_1.Injectable(),__metadata("design:paramtypes",[services_1.backend,services_1.metadata,services_1.language,services_1.modelutilities])],e)}();exports.domainmanager=domainmanager;var dictionarymanager=function(){function e(e,s,t,l){this.backend=e,this.metadata=s,this.language=t,this.modelutilities=l,this.reservedWords=["ALL","ALTER","AND","ANY","ARRAY","AS","ASC","AT","AUTHID","AVG","BEGIN","BETWEEN","BINARY_INTEGER","BODY","BOOLEAN","BULK","BY","CHAR","CHAR_BASE","CHECK","CLOSE","CLUSTER","COALESCE","COLLECT","COMMENT","COMMIT","COMPRESS","CONNECT","CONSTANT","CREATE","CURRENT","CURRVAL","CURSOR","DAY","DECIMAL","DECLARE","DEFAULT","DELETE","DESC","DISTINCT","DO","DROP","ELSE","ELSIF","END","EXCEPTION","EXCLUSIVE","EXECUTE","EXISTS","EXIT","EXTENDS","EXTRACT","FALSE","FETCH","FLOAT","FOR","FORALL","FROM","FUNCTION","GOTO","GROUP","HAVING","HEAP","HOUR","IF","IMMEDIATE","IN","INDEX","INDICATOR","INSERT","INTEGER","INTERFACE","INTERSECT","INTERVAL","INTO","IS","ISOLATION","JAVA","LEVEL","LIKE","LIMITED","LOCK","LONG","LOOP","MAX","MIN","MINUS","MINUTE","MLSLABEL","MOD","MODE","MONTH","NATURAL","NATURALN","NEW","NEXTVAL","NOCOPY","NOT","NOWAIT","NULL","NULLIF","NUMBER","NUMBER_BASE","OCIROWID","OF","ON","OPAQUE","OPEN","OPERATOR","OPTION","OR","ORDER","ORGANIZATION","OTHERS","OUT","PARTITION","PCTFREE","PLS_INTEGER","POSITIVE","POSITIVEN","PRAGMA","PRIOR","PRIVATE","PROCEDURE","PUBLIC","RAISE","RANGE","RAW","REAL","RECORD","REF","RELEASE","RETURN","REVERSE","ROLLBACK","ROW","ROWID","ROWNUM","ROWTYPE","SAVEPOINT","SECOND","SELECT","SEPERATE","SET","SHARE","SMALLINT","SPACE","SQL","SQLCODE","SQLERRM","START","STDDEV","SUBTYPE","SUCCESSFUL","SUM","SYNONYM","SYSDATE","TABLE","THEN","TIME","TIMESTAMP","TIMEZONE_ABBR","TIMEZONE_HOUR","TIMEZONE_MINUTE","TIMEZONE_REGION","TO","TRIGGER","TRUE","TYPE","UI","UNION","UNIQUE","UPDATE","USE","USER","VALIDATE","VALUES","VARCHAR","VARCHAR2","VARIANCE","VIEW","WHEN","WHENEVER","WHERE","WHILE","WITH","WORK","WRITE","YEAR","ZONE"],this.changescope="global",this.domaindefinitions=[],this.domainfields=[],this.dictionarydefinitions=[],this.dictionaryitems=[],this.dictionaryrelationships=[],this.dictionaryrelationshipfields=[],this.dictionaryrelationshiprelatefields=[],this.dictionaryindexes=[],this.dictionaryindexitems=[],this.loadDictionaryDefinitions()}return e.prototype.loadDictionaryDefinitions=function(){var s=this;this.backend.getRequest("dictionary/definitions").subscribe(function(e){s.domaindefinitions=e.domaindefinitions,s.domainfields=e.domainfields,s.dictionarydefinitions=e.dictionarydefinitions,s.dictionaryitems=e.dictionaryitems,s.dictionaryrelationships=e.dictionaryrelationships,s.dictionaryrelationshiprelatefields=e.dictionaryrelationshiprelatefields,s.dictionaryindexes=e.dictionaryindexes,s.dictionaryindexitems=e.dictionaryindexitems,s.loaded=JSON.stringify(e)})},e.prototype.canChange=function(e){return"global"==this.changescope||"custom"==this.changescope&&"c"==e},Object.defineProperty(e.prototype,"defaultScope",{get:function(){return"global"==this.changescope?"g":"c"},enumerable:!1,configurable:!0}),e.prototype.getStatusColor=function(e){switch(e){case"a":return"slds-icon-text-success";case"i":return"slds-icon-text-light";default:return"slds-icon-text-warning"}},e.prototype.getDomainName=function(s){var e=this.domaindefinitions.find(function(e){return e.id==s});return e?e.name:s},e.prototype.getDictionaryDefinitionName=function(s){var e=this.dictionarydefinitions.find(function(e){return e.id==s});return e?e.name:s},e.prototype.getDictionaryItemName=function(s){var e=this.dictionaryitems.find(function(e){return e.id==s});return e?e.name:s},e.prototype.getDictionaryDefinitionItems=function(s){for(var e=[],t=0,l=this.dictionaryitems.filter(function(e){return e.sysdictionarydefinition_id==s&&0==e.deleted}).sort(function(e,s){return e.sequence>s.sequence?1:-1});t<l.length;t++){var i=l[t];i.sysdictionary_ref_id?e=e.concat(this.getDictionaryDefinitionItems(i.sysdictionary_ref_id)):e.push(i)}return e},e.prototype.save=function(){var e=this.determineChangedRecords();this.backend.postRequest("dictionary/definitions",{},e)},e.prototype.determineChangedRecords=function(){var t=JSON.parse(this.loaded),l={dictionarydefinitions:[],dictionaryitems:[],dictionaryrelationships:[],dictionaryrelationshiprelatefields:[],dictionaryindexes:[],dictionaryindexitems:[]};for(var i in l)for(var e=function(s){var e=t[i].find(function(e){return e.id==s.id});(!e||e&&JSON.stringify(e)!=JSON.stringify(s))&&l[i].push(s)},s=0,a=this[i];s<a.length;s++){e(a[s])}return l},e=__decorate([core_1.Injectable(),__metadata("design:paramtypes",[services_1.backend,services_1.metadata,services_1.language,services_1.modelutilities])],e)}();exports.dictionarymanager=dictionarymanager;var DictionaryManagerItemStatus=function(){function e(){this.disabled=!1}var s;return(s=e).prototype.registerOnChange=function(e){this.onChange=e},e.prototype.registerOnTouched=function(e){this.onTouched=e},e.prototype.getStatusColor=function(){switch(this.status){case"a":return"slds-icon-text-success";case"i":return"slds-icon-text-light";default:return"slds-icon-text-warning"}},e.prototype.writeValue=function(e){this.status=e},e.prototype.toggleValue=function(e){this.disabled||(e.stopPropagation(),"a"===this.status?this.status="i":this.status="a",this.onChange(this.status))},__decorate([core_1.Input(),__metadata("design:type",Boolean)],e.prototype,"disabled",void 0),e=s=__decorate([core_1.Component({selector:"dictionary-manager-item-status",template:'<system-utility-icon [colorclass]="getStatusColor()" (click)="toggleValue($event)" class="slds-p-right--xx-small" size="xx-small" icon="light_bulb"></system-utility-icon>',providers:[{provide:forms_1.NG_VALUE_ACCESSOR,useExisting:core_1.forwardRef(function(){return s}),multi:!0}]})],e)}();exports.DictionaryManagerItemStatus=DictionaryManagerItemStatus;var DictionaryManager=function(){function DictionaryManager(e,s){this.dictionarymanager=e,this.metadata=s}return DictionaryManager=__decorate([core_1.Component({template:'<workbench-header titlelabel="LBL_DICTIONARY_MANAGER"><workbench-header-controls><button class="slds-button slds-button--neutral" (click)="dictionarymanager.save()"><system-label label="LBL_SAVE"></system-label></button></workbench-header-controls></workbench-header><div class="slds-grid"><div class="slds-size--1-of-3"><dictionary-manager-definitions></dictionary-manager-definitions></div><div class="slds-size--2-of-3 slds-theme--default slds-border--left"><dictionary-manager-definition-tabs></dictionary-manager-definition-tabs></div></div>',providers:[dictionarymanager]}),__metadata("design:paramtypes",[dictionarymanager,services_1.metadata])],DictionaryManager)}();exports.DictionaryManager=DictionaryManager;var DictionaryManagerDefinitions=function(){function e(e,s,t,l,i,a){this.dictionarymanager=e,this.metadata=s,this.language=t,this.modal=l,this.injector=i,this.modelutilities=a}var s;return Object.defineProperty(e.prototype,"dictionarydefinitions",{get:function(){var s=this;return this.dictionarymanager.dictionarydefinitions.filter(function(e){return 0==e.deleted&&((!s.definitionfiltertype||e.sysdictionary_type==s.definitionfiltertype)&&(!s.definitionfilterterm||(0<=e.name.toLowerCase().indexOf(s.definitionfilterterm.toLowerCase())||0<=e.tablename.toLowerCase().indexOf(s.definitionfilterterm.toLowerCase()))))}).sort(function(e,s){return e.name.localeCompare(s.name)})},enumerable:!1,configurable:!0}),e.prototype.trackByFn=function(e,s){return s.id},e.prototype.setCurrentDictionaryDefintion=function(e){e!=this.dictionarymanager.currentDictionaryDefinition&&(this.dictionarymanager.currentDictionaryDefinition=e,this.dictionarymanager.currentDictionaryItem=null,this.dictionarymanager.currentDictionaryIndex=null,this.dictionarymanager.currentDictionaryRelationship=null)},e.prototype.addDictionaryDefinition=function(e){e.stopPropagation(),this.modal.openModal("DictionaryManagerAddDefinitionModal",!0,this.injector)},e.prototype.deleteDictionaryDefinition=function(e,s){var t=this;e.stopPropagation(),this.modal.prompt("confirm",this.language.getLabel("MSG_DELETE_RECORD","","long"),this.language.getLabel("MSG_DELETE_RECORD")).subscribe(function(e){if(e){t.dictionarymanager.dictionarydefinitions.find(function(e){return e.id==s}).deleted=1;t.dictionarymanager.currentDictionaryDefinition==s&&t.dictionarymanager.currentDictionaryDefinition}})},e=__decorate([core_1.Component({selector:"dictionary-manager-definitions",template:'<div class="slds-p-around--xx-small slds-grid slds-grid--vertical-align-center"><system-utility-icon icon="filterList" size="x-small"></system-utility-icon><system-input-text placeholder="LBL_SEARCH" class="slds-grow slds-p-horizontal--xx-small" [(ngModel)]="definitionfilterterm"></system-input-text><div class="slds-select_container"><select class="slds-select" [(ngModel)]="definitionfiltertype"><option>-</option><option value="module">module</option><option value="metadata">metadata</option><option value="template">template</option><option value="template">relationship</option></select></div></div><div class="slds-border--top" system-to-bottom><table class="slds-table slds-table_cell-buffer slds-table_bordered slds-table--header-fixed"><thead><tr class="slds-line-height_reset"><th style="width:2.5rem" scope="col"></th><th scope="col"><div class="slds-truncate slds-th__action slds-p-horizontal--x-small"><system-label label="LBL_NAME"></system-label></div></th><th scope="col"><div class="slds-truncate slds-th__action slds-p-horizontal--x-small"><system-label label="LBL_TABLE"></system-label></div></th><th scope="col"><div class="slds-truncate slds-th__action slds-p-horizontal--x-small"><system-label label="LBL_TYPE"></system-label></div></th><th style="width:2rem" scope="col"></th></tr></thead><tbody><tr class="slds-hint-parent" [ngClass]="{\'slds-is-selected\':dictionarymanager.currentDictionaryDefinition == dictionarydefinition.id}" *ngFor="let dictionarydefinition of dictionarydefinitions; trackBy: trackByFn" (click)="setCurrentDictionaryDefintion(dictionarydefinition.id)"><td><system-utility-icon class="slds-p-right--xx-small" size="xx-small" [icon]="dictionarydefinition.scope == \'g\' ? \'world\' : \'people\'"></system-utility-icon><dictionary-manager-item-status [(ngModel)]="dictionarydefinition.status"></dictionary-manager-item-status></td><td data-label="Domain"><div class="slds-truncate">{{dictionarydefinition.name}}</div></td><td data-label="Domain"><div class="slds-truncate">{{dictionarydefinition.tablename}}</div></td><td data-label="Type"><div class="slds-truncate">{{dictionarydefinition.sysdictionary_type}}</div></td><td><button class="slds-button slds-button--icon" [disabled]="!dictionarymanager.canChange(dictionarydefinition.scope)" (click)="deleteDictionaryDefinition($event, dictionarydefinition.id)"><system-button-icon size="xx-small" icon="delete"></system-button-icon></button></td></tr></tbody></table><div *ngIf="dictionarymanager.changescope != \'none\'" class="slds-align--absolute-center slds-p-around--small"><system-utility-icon (click)="addDictionaryDefinition($event)" icon="new" size="x-small"></system-utility-icon></div></div>'}),__metadata("design:paramtypes",[dictionarymanager,services_1.metadata,services_1.language,services_1.modal,"function"==typeof(s=void 0!==core_1.Injector&&core_1.Injector)?s:Object,services_1.modelutilities])],e)}();exports.DictionaryManagerDefinitions=DictionaryManagerDefinitions;var DictionaryManagerDefinitionTabs=function(){function e(e,s,t,l,i,a){this.dictionarymanager=e,this.metadata=s,this.language=t,this.modal=l,this.injector=i,this.modelutilities=a,this.scope="items"}var s;return e=__decorate([core_1.Component({selector:"dictionary-manager-definition-tabs",template:'<div class="slds-tabs_scoped"><ul class="slds-tabs_scoped__nav" role="tablist"><li class="slds-tabs_scoped__item" [ngClass]="{\'slds-is-active\': scope == \'items\'}" role="presentation" (click)="scope = \'items\'"><a class="slds-tabs_scoped__link" href="javascript:void(0);" role="tab"><system-label label="LBL_ITEMS"></system-label></a></li><li class="slds-tabs_scoped__item" [ngClass]="{\'slds-is-active\': scope == \'relationships\'}" role="presentation" (click)="scope = \'relationships\'"><a class="slds-tabs_scoped__link" href="javascript:void(0);" role="tab"><system-label label="LBL_RELATIONSHIPS"></system-label></a></li><li class="slds-tabs_scoped__item" [ngClass]="{\'slds-is-active\': scope == \'indexes\'}" role="presentation" (click)="scope = \'indexes\'"><a class="slds-tabs_scoped__link" href="javascript:void(0);" role="tab"><system-label label="LBL_INDEXES"></system-label></a></li><li class="slds-tabs_scoped__item" [ngClass]="{\'slds-is-active\': scope == \'fields\'}" role="presentation" (click)="scope = \'fields\'"><a class="slds-tabs_scoped__link" href="javascript:void(0);" role="tab"><system-label label="LBL_FIELDS"></system-label></a></li></ul><div class="slds-tabs_scoped__content slds-p-around--none" [ngClass]="{\'slds-hide\': scope != \'items\'}" role="tabpanel"><div class="slds-height_full"><dictionary-manager-items></dictionary-manager-items></div></div><div class="slds-tabs_scoped__content slds-p-around--none" [ngClass]="{\'slds-hide\': scope != \'relationships\'}" role="tabpanel"><div class="slds-height_full"><dictionary-manager-relationships></dictionary-manager-relationships></div></div><div class="slds-tabs_scoped__content slds-p-around--none" [ngClass]="{\'slds-hide\': scope != \'indexes\'}" role="tabpanel"><div class="slds-height_full"><dictionary-manager-indexes></dictionary-manager-indexes></div></div><div class="slds-tabs_scoped__content slds-p-around--none" [ngClass]="{\'slds-hide\': scope != \'fields\'}" role="tabpanel"><dictionary-manager-fields></dictionary-manager-fields></div></div>'}),__metadata("design:paramtypes",[dictionarymanager,services_1.metadata,services_1.language,services_1.modal,"function"==typeof(s=void 0!==core_1.Injector&&core_1.Injector)?s:Object,services_1.modelutilities])],e)}();exports.DictionaryManagerDefinitionTabs=DictionaryManagerDefinitionTabs;var DictionaryManagerItems=function(){function e(e,s,t,l,i,a){this.dictionarymanager=e,this.metadata=s,this.language=t,this.modal=l,this.injector=i,this.modelutilities=a}var s;return Object.defineProperty(e.prototype,"canShuffle",{get:function(){var e,s=this;return this.dictionarymanager.canChange(null===(e=this.dictionarymanager.dictionarydefinitions.find(function(e){return e.id==s.dictionarymanager.currentDictionaryDefinition}))||void 0===e?void 0:e.scope)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dictionaryitems",{get:function(){var s=this;return this.dictionarymanager.currentDictionaryDefinition?this.dictionarymanager.dictionaryitems.filter(function(e){return 0==e.deleted&&e.sysdictionarydefinition_id==s.dictionarymanager.currentDictionaryDefinition}).sort(function(e,s){return e.sequence>s.sequence?1:-1}):[]},enumerable:!1,configurable:!0}),e.prototype.addDictionaryItem=function(e){e.stopPropagation(),this.modal.openModal("DictionaryManagerAddItemModal",!0,this.injector)},e.prototype.deleteDictionaryItem=function(e,s){var t=this;e.stopPropagation(),this.modal.prompt("confirm",this.language.getLabel("MSG_DELETE_RECORD","","long"),this.language.getLabel("MSG_DELETE_RECORD")).subscribe(function(e){if(e){t.dictionarymanager.dictionaryitems.find(function(e){return e.id==s}).deleted=1;t.dictionarymanager.currentDictionaryDefinition==s&&t.dictionarymanager.currentDictionaryDefinition}})},e.prototype.drop=function(e){var s=this.dictionaryitems,t=s.splice(e.previousIndex,1);s.splice(e.currentIndex,0,t[0]);for(var l=0,i=0,a=s;i<a.length;i++){a[i].sequence=l,l++}},e.prototype.setActiveId=function(s){this.dictionarymanager.currentDictionaryItem=s,this.dictionaryitem=this.dictionarymanager.dictionaryitems.find(function(e){return e.id==s})},e=__decorate([core_1.Component({selector:"dictionary-manager-items",template:'<div system-to-bottom-noscroll><ng-container *ngIf="dictionarymanager.currentDictionaryDefinition; else selectdefinition"><div style="height: calc(100% - 350px);" class="slds-scrollable--y"><table class="slds-table slds-table_cell-buffer slds-table_bordered"><thead><tr class="slds-line-height_reset"><th style="width:2.5rem" scope="col"></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_NAME"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_DOMAIN"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_TEMPLATE"></system-label></div></th><th style="width:2rem" scope="col"><system-utility-icon icon="new" size="x-small" (click)="addDictionaryItem($event)"></system-utility-icon></th></tr></thead><tbody class="dragboundary" cdkDropList (cdkDropListDropped)="drop($event)"><tr class="slds-hint-parent" *ngFor="let dictionaryitem of dictionaryitems" (click)="setActiveId(dictionaryitem.id)" [ngClass]="{\'slds-is-selected\': dictionarymanager.currentDictionaryItem == dictionaryitem.id}" cdkDrag [cdkDragDisabled]="!canShuffle" cdkDragBoundary=".dragboundary"><td><system-utility-icon *ngIf="canShuffle" class="slds-p-right--xx-small" cdkDragHandle [icon]="\'rows\'" [size]="\'x-small\'" style="cursor:move"></system-utility-icon><system-utility-icon class="slds-p-right--xx-small" size="xx-small" [icon]="dictionaryitem.scope == \'g\' ? \'world\' : \'people\'"></system-utility-icon><dictionary-manager-item-status [(ngModel)]="dictionaryitem.status"></dictionary-manager-item-status></td><td data-label="Domain"><div class="slds-truncate">{{dictionaryitem.name}}</div></td><td data-label="Type"><div class="slds-truncate">{{dictionarymanager.getDomainName(dictionaryitem.sysdomaindefinition_id)}}</div></td><td data-label="Type"><div class="slds-truncate">{{dictionarymanager.getDictionaryDefinitionName(dictionaryitem.sysdictionary_ref_id)}}</div></td><td><button class="slds-button slds-button--icon" [disabled]="!dictionarymanager.canChange(dictionaryitem.scope)" (click)="deleteDictionaryItem($event, dictionaryitem.id)"><system-button-icon size="xx-small" icon="delete"></system-button-icon></button></td></tr></tbody></table><div *ngIf="dictionarymanager.changescope != \'none\'" class="slds-align--absolute-center slds-p-around--small"><system-utility-icon icon="new" size="x-small" (click)="addDictionaryItem($event)"></system-utility-icon></div></div><div class="slds-border--top"><dictionary-manager-item-details [dictionaryitem]="dictionaryitem"></dictionary-manager-item-details></div></ng-container><ng-template #selectdefinition><div class="slds-size--1-of-1 slds-height_full slds-align--absolute-center"><system-label label="LBL_SELECT_A_DICTIONARYDEFINITION"></system-label></div></ng-template></div>'}),__metadata("design:paramtypes",[dictionarymanager,services_1.metadata,services_1.language,services_1.modal,"function"==typeof(s=void 0!==core_1.Injector&&core_1.Injector)?s:Object,services_1.modelutilities])],e)}();exports.DictionaryManagerItems=DictionaryManagerItems;var DictionaryManagerItemDetails=function(){function e(e,s,t){this.dictionarymanager=e,this.metadata=s,this.language=t}return __decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"dictionaryitem",void 0),e=__decorate([core_1.Component({selector:"dictionary-manager-item-details",template:'<div class="slds-text-heading--small slds-p-around--x-small slds-theme--shade"><system-label label="LBL_ITEM_DETAILS"></system-label></div><div *ngIf="dictionarymanager.currentDictionaryItem; else SelectItem" system-to-bottom><div class="slds-p-around--x-small"><div class="slds-grid"><div class="slds-size--1-of-2 slds-form-element slds-m-around--xxx-small"><div class="slds-form-element__control"><label class="slds-form-element__label"><system-label label="LBL_NAME"></system-label></label> <input type="text" disabled class="slds-input" [(ngModel)]="dictionaryitem.name"></div></div><div class="slds-size--1-of-4 slds-form-element slds-m-around--xxx-small"><div *ngIf="dictionaryitem.sysdomaindefinition_id" class="slds-form-element__control"><label class="slds-form-element__label"><system-label label="LBL_DOMAIN"></system-label></label> <input type="text" disabled class="slds-input" [ngModel]="dictionarymanager.getDomainName(dictionaryitem.sysdomaindefinition_id)"></div><div *ngIf="dictionaryitem.sysdictionary_ref_id" class="slds-form-element__control"><label class="slds-form-element__label"><system-label label="LBL_TEMPLATE"></system-label></label> <input type="text" disabled class="slds-input" [ngModel]="dictionarymanager.getDictionaryDefinitionName(dictionaryitem.sysdictionary_ref_id)"></div></div><div class="slds-size--1-of-4 slds-form-element__control slds-m-around--xxx-small"><label class="slds-form-element__label"><system-label label="LBL_SCOPE"></system-label></label><div class="slds-select_container"><select disabled class="slds-select" [(ngModel)]="dictionaryitem.scope"><option value="g"><system-label label="LBL_GLOBAL"></system-label></option><option value="c"><system-label label="LBL_CUSTOM"></system-label></option></select></div></div></div><ng-container *ngIf="dictionaryitem.sysdomaindefinition_id"><div><label class="slds-form-element__label"><system-label label="LBL_LABEL"></system-label></label><system-input-label [(ngModel)]="dictionaryitem.label"></system-input-label></div><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-size--1-of-2 slds-form-element__control"><system-checkbox [(ngModel)]="dictionaryitem.required" [asinteger]="true"><system-label label="LBL_REQUIRED"></system-label></system-checkbox></div><div class="slds-size--1-of-2 slds-form-element__control"><system-checkbox [(ngModel)]="dictionaryitem.non_db" [asinteger]="true"><system-label label="LBL_NON_DB"></system-label></system-checkbox></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label"><system-label label="LBL_COMMENT"></system-label></label><div class="slds-form-element__control"><textarea class="slds-textarea" [(ngModel)]="dictionaryitem.description"></textarea></div></div></ng-container><div class="slds-grid slds-m-vertical--xxx-small slds-gutters_direct-xx-small"><div class="slds-col slds-size--1-of-2 slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_VERSION"></system-label></label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="dictionaryitem.version"></div></div><div class="slds-col slds-size--1-of-2 slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_PACKAGE"></system-label></label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="dictionaryitem.package"></div></div></div></div></div><ng-template #SelectItem><div class="slds-align--absolute-center" system-to-bottom-noscroll>select an item</div></ng-template>'}),__metadata("design:paramtypes",[dictionarymanager,services_1.metadata,services_1.language])],e)}();exports.DictionaryManagerItemDetails=DictionaryManagerItemDetails;var DictionaryManagerAddDefinitionModal=function(){function DictionaryManagerAddDefinitionModal(e,s,t){this.dictionarymanager=e,this.metadata=s,this.modelutilities=t,this.messages=[],this.dictionarydefinition={id:this.modelutilities.generateGuid(),name:"",tablename:"",sysdictionary_type:"module",scope:this.dictionarymanager.defaultScope,deleted:0,status:"d"}}return DictionaryManagerAddDefinitionModal.prototype.close=function(){this.self.destroy()},DictionaryManagerAddDefinitionModal.prototype.getMessages=function(s){return this.messages.filter(function(e){return e.field==s})},Object.defineProperty(DictionaryManagerAddDefinitionModal.prototype,"canSave",{get:function(){var s=this;return this.messages=[],this.dictionarydefinition.name||this.messages.push({field:"name",message:"name must be entered"}),this.dictionarydefinition.sysdictionary_type||this.messages.push({field:"sysdictionary_type",message:"type must be specified"}),"template"==this.dictionarydefinition.sysdictionary_type||this.dictionarydefinition.tablename||this.messages.push({field:"tablename",message:"tablename must be entered"}),this.dictionarymanager.dictionarydefinitions.find(function(e){return e.name==s.dictionarydefinition.name})&&this.messages.push({field:"name",message:"name exists already"}),this.dictionarydefinition.tablename&&this.dictionarymanager.dictionarydefinitions.find(function(e){return e.tablename==s.dictionarydefinition.tablename})&&this.messages.push({field:"tablename",message:"table exists already"}),this.dictionarydefinition.tablename&&0<=this.dictionarymanager.reservedWords.indexOf(this.dictionarydefinition.tablename.toUpperCase())&&this.messages.push({field:"tablename",message:"tablename cannot be used (reserved word)"}),0==this.messages.length},enumerable:!1,configurable:!0}),DictionaryManagerAddDefinitionModal.prototype.save=function(){this.canSave&&(this.dictionarydefinition.id=this.modelutilities.generateGuid(),this.dictionarymanager.dictionarydefinitions.push(this.dictionarydefinition),this.close())},DictionaryManagerAddDefinitionModal=__decorate([core_1.Component({template:'<system-modal><system-modal-header (close)="close()">Add Dictionary Definition</system-modal-header><system-modal-content><div class="slds-grid"><div class="slds-form-element__control slds-size--1-of-2 slds-p-right--xxx-small" [ngClass]="{\'slds-has-error\': getMessages(\'name\').length > 0}"><label class="slds-form-element__label"><abbr class="slds-required">*</abbr><system-label label="LBL_NAME"></system-label></label><system-input-text [(ngModel)]="dictionarydefinition.name"></system-input-text><div class="slds-form-element__help" *ngFor="let message of getMessages(\'name\')">{{message.message}}</div></div><div class="slds-form-element__control slds-size--1-of-2 slds-p-right--xxx-small" [ngClass]="{\'slds-has-error\': getMessages(\'tablename\').length > 0}"><label class="slds-form-element__label"><system-label label="LBL_TABLE"></system-label></label><system-input-text [(ngModel)]="dictionarydefinition.tablename"></system-input-text><div class="slds-form-element__help" *ngFor="let message of getMessages(\'tablename\')">{{message.message}}</div></div></div><div class="slds-grid"><div class="slds-form-element__control slds-size--1-of-4 slds-p-left--xxx-small"><label class="slds-form-element__label"><abbr class="slds-required">*</abbr><system-label label="LBL_SCOPE"></system-label></label><div class="slds-select_container"><select class="slds-select" [(ngModel)]="dictionarydefinition.scope"><option *ngIf="dictionarymanager.changescope == \'global\'" value="g"><system-label label="LBL_GLOBAL"></system-label></option><option value="c"><system-label label="LBL_CUSTOM"></system-label></option></select></div></div><div class="slds-large-size--1-of-4 slds-p-right--xxx-small slds-form-element__control"><label class="slds-form-element__label"><abbr class="slds-required">*</abbr><system-label label="LBL_TYPE"></system-label></label><div class="slds-select_container"><select class="slds-select" [(ngModel)]="dictionarydefinition.sysdictionary_type"><option value="module">module</option><option value="metadata">metadata</option><option value="template">template</option><option value="template">relationship</option></select></div></div><div class="slds-size--1-of-4 slds-p-right--xxx-small slds-form-element__control"><label class="slds-form-element__label"><system-label label="LBL_PACKAGE"></system-label></label><system-input-text [(ngModel)]="dictionarydefinition.package"></system-input-text></div><div class="slds-size--1-of-4 slds-p-left--xxx-small slds-form-element__control"><label class="slds-form-element__label"><system-label label="LBL_VERSION"></system-label></label><system-input-text [(ngModel)]="dictionarydefinition.version"></system-input-text></div></div><label class="slds-form-element__label"><system-label label="LBL_COMMENT"></system-label></label><system-richtext-editor [(ngModel)]="dictionarydefinition.description"></system-richtext-editor></system-modal-content><system-modal-footer><button class="slds-button slds-button--neutral" (click)="close()"><system-label label="LBL_CLOSE"></system-label></button> <button class="slds-button slds-button--brand" (click)="save()"><system-label label="LBL_SAVE"></system-label></button></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[dictionarymanager,services_1.metadata,services_1.modelutilities])],DictionaryManagerAddDefinitionModal)}();exports.DictionaryManagerAddDefinitionModal=DictionaryManagerAddDefinitionModal;var DictionaryManagerAddItemModal=function(){function DictionaryManagerAddItemModal(e,s,t){var l=this;this.dictionarymanager=e,this.metadata=s,this.modelutilities=t,this.domains=[],this.templates=[],this.itemtype="i",this.messages=[],this.dictionaryitem={id:this.modelutilities.generateGuid(),sysdictionarydefinition_id:this.dictionarymanager.currentDictionaryDefinition,name:"",non_db:0,exclude_from_audited:0,required:0,scope:this.dictionarymanager.defaultScope,deleted:0,status:"d",sequence:this.dictionarymanager.dictionaryitems.filter(function(e){return e.sysdictionarydefinition_id==l.dictionarymanager.currentDictionaryDefinition}).length};for(var i=0,a=this.dictionarymanager.domaindefinitions;i<a.length;i++){var o=a[i];this.domains.push({id:o.id,name:o.name})}this.domains.sort(function(e,s){return 0<e.name.localeCompare(s.name)?1:-1});for(var n=0,d=this.dictionarymanager.dictionarydefinitions;n<d.length;n++){var r=d[n];"template"==r.sysdictionary_type&&this.templates.push({id:r.id,name:r.name})}this.templates.sort(function(e,s){return 0<e.name.localeCompare(s.name)?1:-1}),this.currentType=this.dictionarymanager.dictionarydefinitions.find(function(e){return e.id==l.dictionarymanager.currentDictionaryDefinition}).sysdictionary_type}return DictionaryManagerAddItemModal.prototype.close=function(){this.self.destroy()},DictionaryManagerAddItemModal.prototype.getMessages=function(s){return this.messages.filter(function(e){return e.field==s})},Object.defineProperty(DictionaryManagerAddItemModal.prototype,"canSave",{get:function(){var s=this;return this.messages=[],"i"!=this.itemtype||this.dictionaryitem.name||this.messages.push({field:"name",message:"please specifiy the name"}),"i"!=this.itemtype||this.dictionaryitem.sysdomaindefinition_id||this.messages.push({field:"sysdomaindefinition_id",message:"please select a domain"}),"i"==this.itemtype&&this.dictionaryitem.name&&this.dictionarymanager.dictionaryitems.find(function(e){return e.name==s.dictionaryitem.name&&e.sysdictionarydefinition_id==s.dictionarymanager.currentDictionaryDefinition})&&this.messages.push({field:"name",message:"name already used"}),this.dictionaryitem.name&&0<=this.dictionarymanager.reservedWords.indexOf(this.dictionaryitem.name.toUpperCase())&&this.messages.push({field:"name",message:"name cannot be used (reserved word)"}),"t"!=this.itemtype||this.dictionaryitem.sysdictionary_ref_id||this.messages.push({field:"sysdictionary_ref_id",message:"no ref id defined"}),"t"==this.itemtype&&this.dictionaryitem.sysdictionary_ref_id&&this.dictionarymanager.dictionaryitems.find(function(e){return e.sysdictionary_ref_id==s.dictionaryitem.sysdictionary_ref_id&&e.sysdictionarydefinition_id==s.dictionarymanager.currentDictionaryDefinition})&&this.messages.push({field:"sysdictionary_ref_id",message:"ref id already used in dictionary definition"}),0==this.messages.length},enumerable:!1,configurable:!0}),DictionaryManagerAddItemModal.prototype.save=function(){var s=this;this.canSave&&("i"==this.itemtype?this.dictionaryitem.sysdictionary_ref_id=null:(this.dictionaryitem.name=this.templates.find(function(e){return e.id==s.dictionaryitem.sysdictionary_ref_id}).name,this.dictionaryitem.sysdomaindefinition_id=null),this.dictionaryitem.id=this.modelutilities.generateGuid(),this.dictionaryitem.sysdictionarydefinition_id=this.dictionarymanager.currentDictionaryDefinition,this.dictionarymanager.dictionaryitems.push(this.dictionaryitem),this.close())},DictionaryManagerAddItemModal=__decorate([core_1.Component({template:'<system-modal><system-modal-header (close)="close()"><system-label label="LBL_ADD_DICTIONARY_ITEM"></system-label></system-modal-header><system-modal-content><system-input-radio name="select" value="i" [(ngModel)]="itemtype">Item</system-input-radio><system-input-radio name="select" value="t" [disabled]="currentType == \'template\' && templates.length > 0" [(ngModel)]="itemtype">template</system-input-radio><div *ngIf="itemtype == \'i\'" class="slds-grid"><div class="slds-form-element__control slds-size--1-of-2 slds-p-right--xxx-small" [ngClass]="{\'slds-has-error\': getMessages(\'name\').length > 0}"><label class="slds-form-element__label"><abbr class="slds-required">*</abbr><system-label label="LBL_NAME"></system-label></label><system-input-text [(ngModel)]="dictionaryitem.name"></system-input-text><div class="slds-form-element__help" *ngFor="let message of getMessages(\'name\')">{{message.message}}</div></div><div class="slds-large-size--1-of-2 slds-p-left--xxx-small slds-form-element__control" [ngClass]="{\'slds-has-error\': getMessages(\'sysdomaindefinition_id\').length > 0}"><label class="slds-form-element__label"><abbr class="slds-required">*</abbr><system-label label="LBL_DOMAIN"></system-label></label><div class="slds-select_container"><select class="slds-select" [(ngModel)]="dictionaryitem.sysdomaindefinition_id"><option *ngFor="let domain of domains" [value]="domain.id">{{domain.name}}</option></select></div><div class="slds-form-element__help" *ngFor="let message of getMessages(\'sysdomaindefinition_id\')">{{message.message}}</div></div></div><div *ngIf="itemtype == \'t\'" class="slds-form-element__control" [ngClass]="{\'slds-has-error\': getMessages(\'sysdictionary_ref_id\').length > 0}"><label class="slds-form-element__label"><abbr class="slds-required">*</abbr><system-label label="LBL_DOMAIN"></system-label></label><div class="slds-select_container"><select class="slds-select" [(ngModel)]="dictionaryitem.sysdictionary_ref_id"><option *ngFor="let template of templates" [value]="template.id">{{template.name}}</option></select></div><div class="slds-form-element__help" *ngFor="let message of getMessages(\'sysdictionary_ref_id\')">{{message.message}}</div></div><div class="slds-grid"><div class="slds-form-element__control slds-size--1-of-2 slds-p-right--xxx-small"><label class="slds-form-element__label"><abbr class="slds-required">*</abbr><system-label label="LBL_SCOPE"></system-label></label><div class="slds-select_container"><select class="slds-select" [(ngModel)]="dictionaryitem.scope"><option *ngIf="dictionarymanager.changescope == \'global\'" value="g"><system-label label="LBL_GLOBAL"></system-label></option><option value="c"><system-label label="LBL_CUSTOM"></system-label></option></select></div></div><div class="slds-size--1-of-4 slds-p-horizontal--xxx-small slds-form-element__control"><label class="slds-form-element__label"><system-label label="LBL_PACKAGE"></system-label></label><system-input-text [(ngModel)]="dictionaryitem.package"></system-input-text></div><div class="slds-size--1-of-4 slds-p-left--xxx-small slds-form-element__control"><label class="slds-form-element__label"><system-label label="LBL_VERSION"></system-label></label><system-input-text [(ngModel)]="dictionaryitem.version"></system-input-text></div></div><label class="slds-form-element__label"><system-label label="LBL_COMMENT"></system-label></label><system-richtext-editor [(ngModel)]="dictionaryitem.description"></system-richtext-editor></system-modal-content><system-modal-footer><button class="slds-button slds-button--neutral" (click)="close()"><system-label label="LBL_CLOSE"></system-label></button> <button class="slds-button slds-button--brand" (click)="save()"><system-label label="LBL_SAVE"></system-label></button></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[dictionarymanager,services_1.metadata,services_1.modelutilities])],DictionaryManagerAddItemModal)}();exports.DictionaryManagerAddItemModal=DictionaryManagerAddItemModal;var DictionaryManagerRelationships=function(){function e(e,s,t,l,i,a){this.dictionarymanager=e,this.metadata=s,this.language=t,this.modal=l,this.injector=i,this.modelutilities=a}var s;return Object.defineProperty(e.prototype,"dictionaryrelationships",{get:function(){var s=this;return this.dictionarymanager.currentDictionaryDefinition?this.dictionarymanager.dictionaryrelationships.filter(function(e){return 0==e.deleted&&(e.lhs_sysdictionarydefinition_id==s.dictionarymanager.currentDictionaryDefinition||e.rhs_sysdictionarydefinition_id==s.dictionarymanager.currentDictionaryDefinition)}).sort(function(e,s){return e.name.localeCompare(s.name)}):[]},enumerable:!1,configurable:!0}),e.prototype.addDictionaryRelationship=function(e){e.stopPropagation(),this.modal.openModal("DictionaryManagerRelationshipAdd",!0,this.injector)},e.prototype.deleteDictionaryRelationship=function(e,s){var t=this;e.stopPropagation(),this.modal.prompt("confirm",this.language.getLabel("MSG_DELETE_RECORD","","long"),this.language.getLabel("MSG_DELETE_RECORD")).subscribe(function(e){if(e){t.dictionarymanager.dictionaryrelationships.find(function(e){return e.id==s}).deleted=1;t.dictionarymanager.currentDictionaryRelationship==s&&(t.dictionarymanager.currentDictionaryRelationship,t.currentRelationship=null)}})},e.prototype.isLeft=function(e){return e.lhs_sysdictionarydefinition_id==this.dictionarymanager.currentDictionaryDefinition},e.prototype.setActiveId=function(s){this.dictionarymanager.currentDictionaryRelationship=s,this.currentRelationship=this.dictionarymanager.dictionaryrelationships.find(function(e){return e.id==s})},e=__decorate([core_1.Component({selector:"dictionary-manager-relationships",template:'<div system-to-bottom-noscroll><div style="height: calc(100% - 450px)"><ng-container *ngIf="dictionarymanager.currentDictionaryDefinition; else selectdefinition"><table class="slds-table slds-table_cell-buffer slds-table_bordered"><thead><tr class="slds-line-height_reset"><th style="width:2.5rem" scope="col"></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_NAME"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_TYPE"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_LEFT"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_RIGHT"></system-label></div></th><th style="width:2rem" scope="col"></th></tr></thead><tbody><tr class="slds-hint-parent" *ngFor="let dictionaryrelationship of dictionaryrelationships" (click)="setActiveId(dictionaryrelationship.id)" [ngClass]="{\'slds-is-selected\': dictionarymanager.currentDictionaryRelationship == dictionaryrelationship.id}"><td><system-utility-icon class="slds-p-right--xx-small" size="xx-small" [icon]="dictionaryrelationship.scope == \'g\' ? \'world\' : \'people\'"></system-utility-icon><dictionary-manager-item-status [(ngModel)]="dictionaryrelationship.status"></dictionary-manager-item-status></td><td data-label="NAME"><div class="slds-truncate">{{dictionaryrelationship.name}} / {{dictionaryrelationship.relationship_name}}</div></td><td data-label="Type"><div class="slds-truncate"><span class="slds-p-horizontal--x-small">{{dictionaryrelationship.relationship_type}}</span></div></td><td data-label="Left"><div class="slds-truncate">{{dictionarymanager.getDictionaryDefinitionName(dictionaryrelationship.lhs_sysdictionarydefinition_id)}}&nbsp;/&nbsp;{{dictionarymanager.getDictionaryItemName(dictionaryrelationship.lhs_sysdictionaryitem_id)}}</div></td><td data-label="Right"><div class="slds-truncate">{{dictionarymanager.getDictionaryDefinitionName(dictionaryrelationship.rhs_sysdictionarydefinition_id)}}&nbsp;/&nbsp;{{dictionarymanager.getDictionaryItemName(dictionaryrelationship.rhs_sysdictionaryitem_id)}}</div></td><td class="slds-align--absolute-center" style="width: 2rem;"><system-utility-icon *ngIf="dictionarymanager.canChange(dictionaryrelationship.scope)" size="xx-small" icon="delete" (click)="deleteDictionaryRelationship($event, dictionaryrelationship.id)"></system-utility-icon></td></tr></tbody></table><div *ngIf="dictionarymanager.changescope != \'none\'" class="slds-align--absolute-center slds-p-around--small"><system-utility-icon icon="new" size="x-small" (click)="addDictionaryRelationship($event)"></system-utility-icon></div></ng-container><ng-template #selectdefinition><div class="slds-size--1-of-1 slds-height_full slds-align--absolute-center"><system-label label="LBL_SELECT_A_DICTIONARYDEFINITION"></system-label></div></ng-template></div><dictionary-manager-relationships-details [dictionaryRelationship]="currentRelationship"></dictionary-manager-relationships-details></div>'}),__metadata("design:paramtypes",[dictionarymanager,services_1.metadata,services_1.language,services_1.modal,"function"==typeof(s=void 0!==core_1.Injector&&core_1.Injector)?s:Object,services_1.modelutilities])],e)}();exports.DictionaryManagerRelationships=DictionaryManagerRelationships;var DictionaryManagerRelationshipsDetails=function(){function e(e){this.dictionarymanager=e}return __decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"dictionaryRelationship",void 0),e=__decorate([core_1.Component({selector:"dictionary-manager-relationships-details",template:'<div class="slds-text-heading--small slds-p-around--x-small slds-theme--shade"><system-label label="LBL_ITEM_DETAILS"></system-label></div><div *ngIf="dictionarymanager.currentDictionaryRelationship; else SelectItem" class="slds-p-around--x-small" system-to-bottom><ng-container [ngSwitch]="dictionaryRelationship.relationship_type"><dictionary-manager-relationship-container-onetomany [relationship]="dictionaryRelationship" *ngSwitchCase="\'one-to-many\'"></dictionary-manager-relationship-container-onetomany><dictionary-manager-relationship-container-manytomany [relationship]="dictionaryRelationship" *ngSwitchCase="\'many-to-many\'"></dictionary-manager-relationship-container-manytomany><dictionary-manager-relationship-container-parent [relationship]="dictionaryRelationship" *ngSwitchCase="\'parent\'"></dictionary-manager-relationship-container-parent></ng-container></div><ng-template #SelectItem><div class="slds-height_full slds-align--absolute-center"><system-label label="LBL_SELECT_ITEM"></system-label></div></ng-template>'}),__metadata("design:paramtypes",[dictionarymanager])],e)}();exports.DictionaryManagerRelationshipsDetails=DictionaryManagerRelationshipsDetails;var DictionaryManagerRelationshipAdd=function(){function DictionaryManagerRelationshipAdd(e,s,t){this.dictionarymanager=e,this.modal=s,this.injector=t,this.relationshipType="one-to-many",this.related_ids=[],this.related_ids=this.dictionarymanager.dictionarydefinitions.filter(function(e){return"module"==e.sysdictionary_type&&0==e.deleted}).sort(function(e,s){return e.name.localeCompare(s.name)}),this.scope=this.dictionarymanager.defaultScope}var e;return DictionaryManagerRelationshipAdd.prototype.close=function(){this.self.destroy()},DictionaryManagerRelationshipAdd.prototype.add=function(){var s=this;switch(this.relationshipType){case"one-to-many":this.modal.openModal("DictionaryManagerRelationshipAddOneToMany",!0,this.injector).subscribe(function(e){e.instance.relationship.rhs_sysdictionarydefinition_id=s.related_id,e.instance.relationship.scope=s.scope,e.instance.relationship.lhs_sysdictionarydefinition_id=s.dictionarymanager.currentDictionaryDefinition});break;case"many-to-one":this.modal.openModal("DictionaryManagerRelationshipAddOneToMany",!0,this.injector).subscribe(function(e){e.instance.relationship.lhs_sysdictionarydefinition_id=s.related_id,e.instance.relationship.scope=s.scope,e.instance.relationship.rhs_sysdictionarydefinition_id=s.dictionarymanager.currentDictionaryDefinition});break;case"many-to-many":this.modal.openModal("DictionaryManagerRelationshipAddManyToMany",!0,this.injector).subscribe(function(e){e.instance.relationship.rhs_sysdictionarydefinition_id=s.related_id,e.instance.relationship.scope=s.scope,e.instance.relationship.lhs_sysdictionarydefinition_id=s.dictionarymanager.currentDictionaryDefinition});break;case"parent":this.modal.openModal("DictionaryManagerRelationshipAddParent",!0,this.injector).subscribe(function(e){e.instance.relationship.lhs_sysdictionarydefinition_id=s.related_id,e.instance.relationship.scope=s.scope,e.instance.relationship.rhs_sysdictionarydefinition_id=s.dictionarymanager.currentDictionaryDefinition})}this.close()},DictionaryManagerRelationshipAdd=__decorate([core_1.Component({template:'<system-modal><system-modal-header (close)="close()"><system-label label="LBL_ADD_RELATIONSHIP"></system-label></system-modal-header><system-modal-content><div class="slds-p-around--small"><system-input-radio name="relationshiptype" [(ngModel)]="relationshipType" value="one-to-many"><system-label label="LBL_ONE_TO_MANY"></system-label></system-input-radio><system-input-radio name="relationshiptype" [(ngModel)]="relationshipType" value="many-to-one"><system-label label="LBL_MANY_TO_ONE"></system-label></system-input-radio><system-input-radio name="relationshiptype" [(ngModel)]="relationshipType" value="many-to-many"><system-label label="LBL_MANY_TO_MANY"></system-label></system-input-radio><system-input-radio name="relationshiptype" [(ngModel)]="relationshipType" value="parent"><system-label label="LBL_PARENT"></system-label></system-input-radio></div><div class="slds-form-element__control slds-p-around--xx-small"><label class="slds-form-element__label"><abbr class="slds-required">*</abbr><system-label label="LBL_DICTIONARYDEFINITION"></system-label></label><div class="slds-select_container"><select class="slds-size--1-of-2" [(ngModel)]="related_id"><option *ngFor="let dictionarydefinition of related_ids" [value]="dictionarydefinition.id">{{dictionarymanager.getDictionaryDefinitionName(dictionarydefinition.id)}}</option></select></div></div><div class="slds-form-element__control slds-p-around--xx-small"><label class="slds-form-element__label"><abbr class="slds-required">*</abbr><system-label label="LBL_SCOPE"></system-label></label><div class="slds-select_container"><select class="slds-select" [(ngModel)]="scope"><option *ngIf="dictionarymanager.changescope == \'global\'" value="g"><system-label label="LBL_GLOBAL"></system-label></option><option value="c"><system-label label="LBL_CUSTOM"></system-label></option></select></div></div></system-modal-content><system-modal-footer><button class="slds-button slds-button--neutral" (click)="close()"><system-label label="LBL_CANCEL"></system-label></button> <button class="slds-button slds-button--brand" [disabled]="!related_id" (click)="add()"><system-label label="LBL_ADD"></system-label></button></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[dictionarymanager,services_1.modal,"function"==typeof(e=void 0!==core_1.Injector&&core_1.Injector)?e:Object])],DictionaryManagerRelationshipAdd)}();exports.DictionaryManagerRelationshipAdd=DictionaryManagerRelationshipAdd;var DictionaryManagerRelationshipAddOneToMany=function(){function DictionaryManagerRelationshipAddOneToMany(e,s,t,l,i,a){this.dictionarymanager=e,this.metadata=s,this.language=t,this.modal=l,this.injector=i,this.modelutilities=a,this.relationship={id:this.modelutilities.generateGuid(),name:"",scope:"c",relationship_name:"",lhs_sysdictionarydefinition_id:"",lhs_sysdictionaryitem_id:"",lhs_linkname:"",lhs_linklabel:"",rhs_sysdictionarydefinition_id:"",rhs_sysdictionaryitem_id:"",rhs_linkname:"",rhs_linklabel:"",rhs_relatename:"",rhs_relatelabel:"",relationship_type:"one-to-many",deleted:0,status:"d"}}var e;return DictionaryManagerRelationshipAddOneToMany.prototype.ngOnInit=function(){this.setDefaults()},DictionaryManagerRelationshipAddOneToMany.prototype.setDefaults=function(){var s=this;this.relationship.name=this.dictionarymanager.dictionarydefinitions.find(function(e){return e.id==s.relationship.lhs_sysdictionarydefinition_id}).tablename.toLowerCase(),this.relationship.relationship_name=this.dictionarymanager.dictionarydefinitions.find(function(e){return e.id==s.relationship.lhs_sysdictionarydefinition_id}).tablename.toLowerCase()+"_"+this.dictionarymanager.dictionarydefinitions.find(function(e){return e.id==s.relationship.rhs_sysdictionarydefinition_id}).tablename.toLowerCase();var e=this.dictionarymanager.getDictionaryDefinitionItems(this.relationship.lhs_sysdictionarydefinition_id).find(function(e){return"id"==e.name});e&&(this.relationship.lhs_sysdictionaryitem_id=e.id),this.relationship.rhs_linkname=this.dictionarymanager.getDictionaryDefinitionName(this.relationship.lhs_sysdictionarydefinition_id).toLowerCase(),this.relationship.rhs_relatename=this.dictionarymanager.getDictionaryDefinitionName(this.relationship.lhs_sysdictionarydefinition_id).toLowerCase()+"_name",this.relationship.lhs_linkname=this.dictionarymanager.dictionarydefinitions.find(function(e){return e.id==s.relationship.rhs_sysdictionarydefinition_id}).tablename.toLowerCase()},DictionaryManagerRelationshipAddOneToMany.prototype.close=function(){this.self.destroy()},DictionaryManagerRelationshipAddOneToMany.prototype.add=function(){this.dictionarymanager.dictionaryrelationships.push(__assign({},this.relationship)),this.close()},DictionaryManagerRelationshipAddOneToMany=__decorate([core_1.Component({template:'<system-modal><system-modal-header (close)="close()"><system-label label="LBL_ONE_TO_MANY"></system-label></system-modal-header><system-modal-content><dictionary-manager-relationship-container-onetomany [relationship]="relationship"></dictionary-manager-relationship-container-onetomany></system-modal-content><system-modal-footer><button class="slds-button slds-button--neutral" (click)="close()"><system-label label="LBL_CANCEL"></system-label></button> <button class="slds-button slds-button--brand" (click)="add()"><system-label label="LBL_ADD"></system-label></button></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[dictionarymanager,services_1.metadata,services_1.language,services_1.modal,"function"==typeof(e=void 0!==core_1.Injector&&core_1.Injector)?e:Object,services_1.modelutilities])],DictionaryManagerRelationshipAddOneToMany)}();exports.DictionaryManagerRelationshipAddOneToMany=DictionaryManagerRelationshipAddOneToMany;var DictionaryManagerRelationshipContainerOneToMany=function(){function e(e,s,t,l,i,a){this.dictionarymanager=e,this.metadata=s,this.language=t,this.modal=l,this.injector=i,this.modelutilities=a,this.lhs_items=[],this.rhs_items=[],this.relationshiprelatefields=[]}var s;return e.prototype.ngOnInit=function(){this.loadItems(),this.loadRelationshipFields()},e.prototype.loadItems=function(){this.lhs_items=this.dictionarymanager.getDictionaryDefinitionItems(this.relationship.lhs_sysdictionarydefinition_id),this.rhs_items=this.dictionarymanager.getDictionaryDefinitionItems(this.relationship.rhs_sysdictionarydefinition_id)},e.prototype.loadRelationshipFields=function(){var s=this;this.relationshiprelatefields=this.dictionarymanager.dictionaryrelationshiprelatefields.filter(function(e){return e.relationship_id==s.relationship.id})},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"relationship",void 0),e=__decorate([core_1.Component({selector:"dictionary-manager-relationship-container-onetomany",template:'<div class="slds-grid"><div class="slds-size--1-of-2 slds-p-right--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_NAME"></system-label></label><div class="slds-form-element__control"><input class="slds-input" [(ngModel)]="relationship.name"></div></div><div class="slds-size--1-of-2 slds-p-left--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_RELATIONSHIP_NAME"></system-label></label><div class="slds-form-element__control"><input class="slds-input" [(ngModel)]="relationship.relationship_name"></div></div></div><div class="slds-grid"><div class="slds-size--1-of-2 slds-p-right--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_LHS_DICTIONARYDEFINITION"></system-label></label><div class="slds-form-element__control"><input disabled class="slds-input" [ngModel]="dictionarymanager.getDictionaryDefinitionName(relationship.lhs_sysdictionarydefinition_id)"></div></div><div class="slds-size--1-of-2 slds-p-left--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_RHS_DICTIONARYDEFINITION"></system-label></label><div class="slds-form-element__control"><input disabled class="slds-input" [ngModel]="dictionarymanager.getDictionaryDefinitionName(relationship.rhs_sysdictionarydefinition_id)"></div></div></div><div class="slds-grid"><div class="slds-size--1-of-2 slds-p-right--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_LHS_SYSDICTIONARYITEM"></system-label></label><div class="slds-select_container"><select [(ngModel)]="relationship.lhs_sysdictionaryitem_id" class="slds-select"><option *ngFor="let item of lhs_items" [value]="item.id">{{item.name}}</option></select></div></div><div class="slds-size--1-of-2 slds-p-left--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_RHS_SYSDICTIONARYITEM"></system-label></label><div class="slds-select_container"><select [(ngModel)]="relationship.rhs_sysdictionaryitem_id" class="slds-select"><option *ngFor="let item of rhs_items" [value]="item.id">{{item.name}}</option></select></div></div></div><div class="slds-grid"><div class="slds-size--1-of-2 slds-p-right--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_LHS_LINKNAME"></system-label></label><div class="slds-form-element__control"><input class="slds-input" [(ngModel)]="relationship.lhs_linkname"></div></div><div class="slds-size--1-of-2 slds-p-left--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_RHS_LINKNAME"></system-label></label><div class="slds-form-element__control"><input class="slds-input" [(ngModel)]="relationship.rhs_linkname"></div></div></div><div class="slds-grid"><div class="slds-size--1-of-2 slds-p-right--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_LHS_LINKLABEL"></system-label></label><div class="slds-form-element__control"><system-input-label [(ngModel)]="relationship.lhs_linklabel"></system-input-label></div></div><div class="slds-size--1-of-2 slds-p-left--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_RHS_LINKLABEL"></system-label></label><div class="slds-form-element__control"><system-input-label [(ngModel)]="relationship.rhs_linklabel"></system-input-label></div></div></div><div class="slds-grid"><div class="slds-size--1-of-2"></div><div class="slds-size--1-of-2"><label class="slds-form-element__label"><system-label label="LBL_RHS_RELATENAME"></system-label></label><div class="slds-form-element__control"><input class="slds-input" [(ngModel)]="relationship.rhs_relatename"></div></div></div><div class="slds-grid"><div class="slds-size--1-of-2"></div><div class="slds-size--1-of-2"><label class="slds-form-element__label"><system-label label="LBL_RHS_RELATELABEL"></system-label></label><div class="slds-form-element__control"><system-input-label [(ngModel)]="relationship.rhs_relatelabel"></system-input-label></div></div></div>'}),__metadata("design:paramtypes",[dictionarymanager,services_1.metadata,services_1.language,services_1.modal,"function"==typeof(s=void 0!==core_1.Injector&&core_1.Injector)?s:Object,services_1.modelutilities])],e)}();exports.DictionaryManagerRelationshipContainerOneToMany=DictionaryManagerRelationshipContainerOneToMany;var DictionaryManagerRelationshipAddManyToMany=function(){function DictionaryManagerRelationshipAddManyToMany(e,s,t,l,i,a){this.dictionarymanager=e,this.metadata=s,this.language=t,this.modal=l,this.injector=i,this.modelutilities=a,this.relationship={id:this.modelutilities.generateGuid(),name:"",scope:"c",relationship_name:"",lhs_sysdictionarydefinition_id:"",lhs_sysdictionaryitem_id:"",lhs_linkname:"",lhs_linklabel:"",rhs_sysdictionarydefinition_id:"",rhs_sysdictionaryitem_id:"",rhs_linkname:"",rhs_linklabel:"",rhs_relatename:"",rhs_relatelabel:"",relationship_type:"many-to-many",deleted:0,status:"d"}}var e;return DictionaryManagerRelationshipAddManyToMany.prototype.ngOnInit=function(){this.setDefaults()},DictionaryManagerRelationshipAddManyToMany.prototype.setDefaults=function(){var s=this;this.relationship.relationship_name=this.dictionarymanager.dictionarydefinitions.find(function(e){return e.id==s.relationship.lhs_sysdictionarydefinition_id}).tablename.toLowerCase()+"_"+this.dictionarymanager.dictionarydefinitions.find(function(e){return e.id==s.relationship.rhs_sysdictionarydefinition_id}).tablename.toLowerCase(),this.relationship.name=this.relationship.relationship_name;var e=this.dictionarymanager.getDictionaryDefinitionItems(this.relationship.lhs_sysdictionarydefinition_id).find(function(e){return"id"==e.name});e&&(this.relationship.lhs_sysdictionaryitem_id=e.id),this.relationship.lhs_linkname=this.dictionarymanager.dictionarydefinitions.find(function(e){return e.id==s.relationship.rhs_sysdictionarydefinition_id}).tablename.toLowerCase();var t=this.dictionarymanager.getDictionaryDefinitionItems(this.relationship.rhs_sysdictionarydefinition_id).find(function(e){return"id"==e.name});t&&(this.relationship.rhs_sysdictionaryitem_id=t.id),this.relationship.rhs_linkname=this.dictionarymanager.getDictionaryDefinitionName(this.relationship.lhs_sysdictionarydefinition_id).toLowerCase()},DictionaryManagerRelationshipAddManyToMany.prototype.close=function(){this.self.destroy()},DictionaryManagerRelationshipAddManyToMany.prototype.add=function(){this.dictionarymanager.dictionaryrelationships.push(__assign({},this.relationship)),this.close()},DictionaryManagerRelationshipAddManyToMany=__decorate([core_1.Component({template:'<system-modal><system-modal-header (close)="close()"><system-label label="LBL_MANY_TO_MANY"></system-label></system-modal-header><system-modal-content><dictionary-manager-relationship-container-manytomany [relationship]="relationship"></dictionary-manager-relationship-container-manytomany></system-modal-content><system-modal-footer><button class="slds-button slds-button--neutral" (click)="close()"><system-label label="LBL_CANCEL"></system-label></button> <button class="slds-button slds-button--brand" (click)="add()"><system-label label="LBL_ADD"></system-label></button></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[dictionarymanager,services_1.metadata,services_1.language,services_1.modal,"function"==typeof(e=void 0!==core_1.Injector&&core_1.Injector)?e:Object,services_1.modelutilities])],DictionaryManagerRelationshipAddManyToMany)}();exports.DictionaryManagerRelationshipAddManyToMany=DictionaryManagerRelationshipAddManyToMany;var DictionaryManagerRelationshipContainerManyToMany=function(){function e(e,s,t,l,i,a){this.dictionarymanager=e,this.metadata=s,this.language=t,this.modal=l,this.injector=i,this.modelutilities=a,this.lhs_items=[],this.rhs_items=[],this.join_items=[]}var s;return Object.defineProperty(e.prototype,"join_sysdictionarydefinition_id",{get:function(){return this.relationship.join_sysdictionarydefinition_id},set:function(e){e!=this.relationship.join_sysdictionarydefinition_id&&(this.relationship.join_sysdictionarydefinition_id=e,this.relationship.join_rhs_sysdictionaryitem_id=null,this.relationship.join_lhs_sysdictionaryitem_id=null,this.loadJoinItems())},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){this.loadItems(),this.loadJoinItems()},e.prototype.loadJoinItems=function(){this.relationship.join_sysdictionarydefinition_id?this.join_items=this.dictionarymanager.getDictionaryDefinitionItems(this.relationship.join_sysdictionarydefinition_id):this.join_items=[]},e.prototype.loadItems=function(){this.lhs_items=this.dictionarymanager.getDictionaryDefinitionItems(this.relationship.lhs_sysdictionarydefinition_id),this.rhs_items=this.dictionarymanager.getDictionaryDefinitionItems(this.relationship.rhs_sysdictionarydefinition_id)},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"relationship",void 0),e=__decorate([core_1.Component({selector:"dictionary-manager-relationship-container-manytomany",template:'<div class="slds-grid"><div class="slds-size--1-of-2 slds-p-right--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_NAME"></system-label></label><div class="slds-form-element__control"><input class="slds-input" [(ngModel)]="relationship.name"></div></div><div class="slds-size--1-of-2 slds-p-left--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_RELATIONSHIP_NAME"></system-label></label><div class="slds-form-element__control"><input class="slds-input" [(ngModel)]="relationship.relationship_name"></div></div></div><div class="slds-grid"><div class="slds-size--1-of-2 slds-p-right--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_LHS_DICTIONARYDEFINITION"></system-label></label><div class="slds-form-element__control"><input disabled class="slds-input" [ngModel]="dictionarymanager.getDictionaryDefinitionName(relationship.lhs_sysdictionarydefinition_id)"></div></div><div class="slds-size--1-of-2 slds-p-left--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_RHS_DICTIONARYDEFINITION"></system-label></label><div class="slds-form-element__control"><input disabled class="slds-input" [ngModel]="dictionarymanager.getDictionaryDefinitionName(relationship.rhs_sysdictionarydefinition_id)"></div></div></div><div class="slds-grid"><div class="slds-size--1-of-2 slds-p-right--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_LHS_SYSDICTIONARYITEM"></system-label></label><div class="slds-select_container"><select [(ngModel)]="relationship.lhs_sysdictionaryitem_id" class="slds-select"><option *ngFor="let item of lhs_items" [value]="item.id">{{item.name}}</option></select></div></div><div class="slds-size--1-of-2 slds-p-left--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_RHS_SYSDICTIONARYITEM"></system-label></label><div class="slds-select_container"><select [(ngModel)]="relationship.rhs_sysdictionaryitem_id" class="slds-select"><option *ngFor="let item of rhs_items" [value]="item.id">{{item.name}}</option></select></div></div></div><div class="slds-grid"><div class="slds-size--1-of-2 slds-p-right--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_LHS_LINKNAME"></system-label></label><div class="slds-form-element__control"><input class="slds-input" [(ngModel)]="relationship.lhs_linkname"></div></div><div class="slds-size--1-of-2 slds-p-left--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_RHS_LINKNAME"></system-label></label><div class="slds-form-element__control"><input class="slds-input" [(ngModel)]="relationship.rhs_linkname"></div></div></div><div class="slds-grid"><div class="slds-size--1-of-2 slds-p-right--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_LHS_LINKLABEL"></system-label></label><div class="slds-form-element__control"><system-input-label [(ngModel)]="relationship.lhs_linklabel"></system-input-label></div></div><div class="slds-size--1-of-2 slds-p-left--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_RHS_LINKLABEL"></system-label></label><div class="slds-form-element__control"><system-input-label [(ngModel)]="relationship.rhs_linklabel"></system-input-label></div></div></div><div class="slds-grid"><div class="slds-size--1-of-1 slds-p-right--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_JOIN_DICTIONARYDEFINITION_ID"></system-label></label><div class="slds-select_container"><select [(ngModel)]="join_sysdictionarydefinition_id" class="slds-select"><option *ngFor="let relationshipdefinition of dictionarymanager.dictionarydefinitions" [value]="relationshipdefinition.id">{{relationshipdefinition.name}}</option></select></div></div></div><div class="slds-grid"><div class="slds-size--1-of-2 slds-p-right--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_JOIN_LHS_SYSDICTIONARYITEM"></system-label></label><div class="slds-select_container"><select [disabled]="!join_sysdictionarydefinition_id" [(ngModel)]="relationship.join_lhs_sysdictionaryitem_id" class="slds-select"><option *ngFor="let item of join_items" [value]="item.id">{{item.name}}</option></select></div></div><div class="slds-size--1-of-2 slds-p-left--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_JOIN_RHS_SYSDICTIONARYITEM"></system-label></label><div class="slds-select_container"><select [disabled]="!join_sysdictionarydefinition_id" [(ngModel)]="relationship.join_rhs_sysdictionaryitem_id" class="slds-select"><option *ngFor="let item of join_items" [value]="item.id">{{item.name}}</option></select></div></div></div><div class="slds-grid"><div class="slds-size--1-of-2 slds-p-right--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_RELATIONSHIP_ROLE_COLUMN"></system-label></label><div class="slds-select_container"><select [disabled]="!join_sysdictionarydefinition_id" [(ngModel)]="relationship.relationship_role_column" class="slds-select"><option [value]>-</option><option *ngFor="let item of join_items" [value]="item.id">{{item.name}}</option></select></div></div><div class="slds-size--1-of-2 slds-p-left--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_RELATIONSHIP_ROLE_COLUMN_VALUE"></system-label></label><div class="slds-form-element__control"><input [disabled]="!relationship.relationship_role_column" class="slds-input" [(ngModel)]="relationship.relationship_role_column_value"></div></div></div>'}),__metadata("design:paramtypes",[dictionarymanager,services_1.metadata,services_1.language,services_1.modal,"function"==typeof(s=void 0!==core_1.Injector&&core_1.Injector)?s:Object,services_1.modelutilities])],e)}();exports.DictionaryManagerRelationshipContainerManyToMany=DictionaryManagerRelationshipContainerManyToMany;var DictionaryManagerRelationshipAddParent=function(){function e(e,s,t,l,i,a){this.dictionarymanager=e,this.metadata=s,this.language=t,this.modal=l,this.injector=i,this.modelutilities=a,this.relationship={id:this.modelutilities.generateGuid(),name:"",scope:"c",relationship_name:"",lhs_sysdictionarydefinition_id:"",lhs_sysdictionaryitem_id:"",lhs_linkname:"",lhs_linklabel:"",rhs_sysdictionarydefinition_id:"",rhs_sysdictionaryitem_id:"",rhs_linkname:"",rhs_linklabel:"",rhs_relatename:"",rhs_relatelabel:"",relationship_type:"parent",deleted:0,status:"d"}}var s;return e.prototype.ngOnInit=function(){this.setDefaults()},e.prototype.setDefaults=function(){var s=this;this.relationship.name=this.dictionarymanager.dictionarydefinitions.find(function(e){return e.id==s.relationship.lhs_sysdictionarydefinition_id}).tablename.toLowerCase(),this.relationship.relationship_name=this.dictionarymanager.dictionarydefinitions.find(function(e){return e.id==s.relationship.lhs_sysdictionarydefinition_id}).tablename.toLowerCase()+"_"+this.dictionarymanager.dictionarydefinitions.find(function(e){return e.id==s.relationship.rhs_sysdictionarydefinition_id}).tablename.toLowerCase();var e=this.dictionarymanager.getDictionaryDefinitionItems(this.relationship.lhs_sysdictionarydefinition_id).find(function(e){return"id"==e.name});e&&(this.relationship.lhs_sysdictionaryitem_id=e.id),this.relationship.rhs_linkname=this.dictionarymanager.getDictionaryDefinitionName(this.relationship.lhs_sysdictionarydefinition_id).toLowerCase(),this.relationship.lhs_linkname=this.dictionarymanager.dictionarydefinitions.find(function(e){return e.id==s.relationship.rhs_sysdictionarydefinition_id}).tablename.toLowerCase()},e.prototype.close=function(){this.self.destroy()},e.prototype.add=function(){this.dictionarymanager.dictionaryrelationships.push(__assign({},this.relationship)),this.close()},e=__decorate([core_1.Component({template:'<system-modal><system-modal-header (close)="close()"><system-label label="LBL_PARENT"></system-label></system-modal-header><system-modal-content><dictionary-manager-relationship-container-parent [relationship]="relationship"></dictionary-manager-relationship-container-parent></system-modal-content><system-modal-footer><button class="slds-button slds-button--neutral" (click)="close()"><system-label label="LBL_CANCEL"></system-label></button> <button class="slds-button slds-button--brand" (click)="add()"><system-label label="LBL_ADD"></system-label></button></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[dictionarymanager,services_1.metadata,services_1.language,services_1.modal,"function"==typeof(s=void 0!==core_1.Injector&&core_1.Injector)?s:Object,services_1.modelutilities])],e)}();exports.DictionaryManagerRelationshipAddParent=DictionaryManagerRelationshipAddParent;var DictionaryManagerRelationshipContainerParent=function(){function e(e,s,t,l,i,a){this.dictionarymanager=e,this.metadata=s,this.language=t,this.modal=l,this.injector=i,this.modelutilities=a,this.lhs_items=[],this.rhs_items=[],this.relationshiprelatefields=[]}var s;return e.prototype.ngOnInit=function(){this.loadItems(),this.loadRelationshipFields()},e.prototype.loadItems=function(){this.lhs_items=this.dictionarymanager.getDictionaryDefinitionItems(this.relationship.lhs_sysdictionarydefinition_id),this.rhs_items=this.dictionarymanager.getDictionaryDefinitionItems(this.relationship.rhs_sysdictionarydefinition_id)},e.prototype.loadRelationshipFields=function(){var s=this;this.relationshiprelatefields=this.dictionarymanager.dictionaryrelationshiprelatefields.filter(function(e){return e.relationship_id==s.relationship.id})},Object.defineProperty(e.prototype,"rhs_sysdictionaryitem_id",{get:function(){return this.relationship.rhs_sysdictionaryitem_id},set:function(s){this.relationship.rhs_sysdictionaryitem_id=s,this.relationship.rhs_relatename=this.rhs_items.find(function(e){return e.id==s}).name+"_name"},enumerable:!1,configurable:!0}),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"relationship",void 0),e=__decorate([core_1.Component({selector:"dictionary-manager-relationship-container-parent",template:'<div class="slds-grid"><div class="slds-size--1-of-2 slds-p-right--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_NAME"></system-label></label><div class="slds-form-element__control"><input class="slds-input" [(ngModel)]="relationship.name"></div></div><div class="slds-size--1-of-2 slds-p-left--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_RELATIONSHIP_NAME"></system-label></label><div class="slds-form-element__control"><input class="slds-input" [(ngModel)]="relationship.relationship_name"></div></div></div><div class="slds-grid"><div class="slds-size--1-of-2 slds-p-right--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_LHS_DICTIONARYDEFINITION"></system-label></label><div class="slds-form-element__control"><input disabled class="slds-input" [ngModel]="dictionarymanager.getDictionaryDefinitionName(relationship.lhs_sysdictionarydefinition_id)"></div></div><div class="slds-size--1-of-2 slds-p-left--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_RHS_DICTIONARYDEFINITION"></system-label></label><div class="slds-form-element__control"><input disabled class="slds-input" [ngModel]="dictionarymanager.getDictionaryDefinitionName(relationship.rhs_sysdictionarydefinition_id)"></div></div></div><div class="slds-grid"><div class="slds-size--1-of-2 slds-p-right--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_LHS_SYSDICTIONARYITEM"></system-label></label><div class="slds-select_container"><select [(ngModel)]="relationship.lhs_sysdictionaryitem_id" class="slds-select"><option *ngFor="let item of lhs_items" [value]="item.id">{{item.name}}</option></select></div></div><div class="slds-size--1-of-2 slds-p-left--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_RHS_SYSDICTIONARYITEM"></system-label></label><div class="slds-select_container"><select [(ngModel)]="rhs_sysdictionaryitem_id" class="slds-select"><option *ngFor="let item of rhs_items" [value]="item.id">{{item.name}}</option></select></div></div></div><div class="slds-grid"><div class="slds-size--1-of-2 slds-p-right--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_LHS_LINKNAME"></system-label></label><div class="slds-form-element__control"><input class="slds-input" [(ngModel)]="relationship.lhs_linkname"></div></div><div class="slds-size--1-of-2 slds-p-left--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_RHS_LINKNAME"></system-label></label><div class="slds-form-element__control"><input class="slds-input" [(ngModel)]="relationship.rhs_linkname"></div></div></div><div class="slds-grid"><div class="slds-size--1-of-2 slds-p-right--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_LHS_LINKLABEL"></system-label></label><div class="slds-form-element__control"><system-input-label [(ngModel)]="relationship.lhs_linklabel"></system-input-label></div></div><div class="slds-size--1-of-2 slds-p-left--xx-small slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_RHS_LINKLABEL"></system-label></label><div class="slds-form-element__control"><system-input-label [(ngModel)]="relationship.rhs_linklabel"></system-input-label></div></div></div><div class="slds-grid"><div class="slds-size--1-of-2"></div><div class="slds-size--1-of-2"><label class="slds-form-element__label"><system-label label="LBL_RHS_RELATENAME"></system-label></label><div class="slds-form-element__control"><input disabled class="slds-input" [(ngModel)]="relationship.rhs_relatename"></div></div></div>'}),__metadata("design:paramtypes",[dictionarymanager,services_1.metadata,services_1.language,services_1.modal,"function"==typeof(s=void 0!==core_1.Injector&&core_1.Injector)?s:Object,services_1.modelutilities])],e)}();exports.DictionaryManagerRelationshipContainerParent=DictionaryManagerRelationshipContainerParent;var DictionaryManagerIndexes=function(){function e(e,s,t,l,i,a){this.dictionarymanager=e,this.metadata=s,this.language=t,this.modal=l,this.injector=i,this.modelutilities=a}var s;return Object.defineProperty(e.prototype,"dictionaryIndexes",{get:function(){var s=this;return this.dictionarymanager.currentDictionaryDefinition?this.dictionarymanager.dictionaryindexes.filter(function(e){return 0==e.deleted&&e.sysdictionarydefinition_id==s.dictionarymanager.currentDictionaryDefinition}).sort(function(e,s){return e.name.localeCompare(s.name)?1:-1}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dictionaryIndexesForTemplates",{get:function(){for(var s=this,t=[],e=function(s){var e=l.dictionarymanager.dictionaryindexes.filter(function(e){return 0==e.deleted&&e.sysdictionarydefinition_id==s.sysdictionary_ref_id});0<e.length&&t.push({relatedTemplateId:s.sysdictionary_ref_id,indexes:e})},l=this,i=0,a=this.dictionarymanager.dictionaryitems.filter(function(e){return 0==e.deleted&&e.sysdictionary_ref_id&&e.sysdictionarydefinition_id==s.dictionarymanager.currentDictionaryDefinition});i<a.length;i++){e(a[i])}return t},enumerable:!1,configurable:!0}),e.prototype.addIndex=function(e){e.stopPropagation(),this.modal.openModal("DictionaryManagerIndexAdd",!0,this.injector)},e.prototype.deleteIndex=function(e,s){var t=this;e.stopPropagation(),this.modal.prompt("confirm",this.language.getLabel("MSG_DELETE_RECORD","","long"),this.language.getLabel("MSG_DELETE_RECORD")).subscribe(function(e){if(e)t.dictionarymanager.dictionaryindexes.find(function(e){return e.id==s}).deleted=1})},e.prototype.getIndexFields=function(s){for(var t,l=[],e=function(s){var e=null===(t=i.dictionarymanager.dictionaryitems.find(function(e){return e.id==s.sysdictionaryitem_id}))||void 0===t?void 0:t.name;e&&l.push(e)},i=this,a=0,o=this.dictionarymanager.dictionaryindexitems.filter(function(e){return e.sysdictionaryindex_id==s&&0==e.deleted}).sort(function(e,s){return e.sequence>s.sequence?1:-1});a<o.length;a++){e(o[a])}return l.join()},e.prototype.setActiveId=function(e){this.dictionarymanager.currentDictionaryIndex=e},e=__decorate([core_1.Component({selector:"dictionary-manager-indexes",template:'<div style="height: 30vh"><ng-container *ngIf="dictionarymanager.currentDictionaryDefinition; else selectdefinition"><table class="slds-table slds-table_cell-buffer slds-table_bordered"><thead><tr class="slds-line-height_reset"><th style="width:2.5rem" scope="col"></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_NAME"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_TEMPLATE"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_TYPE"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_ITEMS"></system-label></div></th><th style="width:2rem" scope="col"></th></tr></thead><tbody><tr class="slds-hint-parent" *ngFor="let dictionaryindex of dictionaryIndexes" (click)="setActiveId(dictionaryindex.id)" [ngClass]="{\'slds-is-selected\': dictionarymanager.currentDictionaryIndex == dictionaryindex.id}"><td><system-utility-icon class="slds-p-right--xx-small" size="xx-small" [icon]="dictionaryindex.scope == \'g\' ? \'world\' : \'people\'"></system-utility-icon><dictionary-manager-item-status [(ngModel)]="dictionaryindex.status"></dictionary-manager-item-status></td><td><div class="slds-truncate">{{dictionaryindex.name}}</div></td><td></td><td><div class="slds-truncate">{{dictionaryindex.indextype}}</div></td><td><div class="slds-truncate">{{getIndexFields(dictionaryindex.id)}}</div></td><td class="slds-align--absolute-center" style="width: 2rem;"><system-utility-icon size="xx-small" icon="delete" (click)="deleteIndex($event, dictionaryindex.id)"></system-utility-icon></td></tr></tbody><tbody *ngFor="let dictionaryIndexesForTemplate of dictionaryIndexesForTemplates"><tr class="slds-hint-parent" *ngFor="let dictionaryindex of dictionaryIndexesForTemplate.indexes"><td></td><td><div class="slds-truncate">{{dictionaryindex.name}}</div></td><td><div class="slds-truncate">{{dictionarymanager.getDictionaryDefinitionName(dictionaryIndexesForTemplate.relatedTemplateId)}}</div></td><td><div class="slds-truncate">{{dictionaryindex.indextype}}</div></td><td><div class="slds-truncate">{{getIndexFields(dictionaryindex.id)}}</div></td><td></td></tr></tbody></table><div *ngIf="dictionarymanager.changescope != \'none\'" class="slds-align--absolute-center slds-p-around--small"><system-utility-icon icon="new" size="x-small" (click)="addIndex($event)"></system-utility-icon></div></ng-container><ng-template #selectdefinition><div class="slds-size--1-of-1 slds-height_full slds-align--absolute-center"><system-label label="LBL_SELECT_A_DICTIONARYDEFINITION"></system-label></div></ng-template></div><dictionary-manager-index-details [indexid]="dictionarymanager.currentDictionaryIndex"></dictionary-manager-index-details>'}),__metadata("design:paramtypes",[dictionarymanager,services_1.metadata,services_1.language,services_1.modal,"function"==typeof(s=void 0!==core_1.Injector&&core_1.Injector)?s:Object,services_1.modelutilities])],e)}();exports.DictionaryManagerIndexes=DictionaryManagerIndexes;var DictionaryManagerIndexAdd=function(){function DictionaryManagerIndexAdd(e,s,t){var l=this;this.dictionarymanager=e,this.injector=s,this.modelutilities=t,this.availableDictionaryItems=[],this.indexDictionaryItems=[];var i=this.dictionarymanager.dictionarydefinitions.find(function(e){return e.id==l.dictionarymanager.currentDictionaryDefinition}).tablename;this.index={id:this.modelutilities.generateGuid(),name:"idx_"+i+"_",sysdictionarydefinition_id:this.dictionarymanager.currentDictionaryDefinition,deleted:0,status:"d",scope:this.dictionarymanager.defaultScope,indextype:"index"},this.availableDictionaryItems=this.dictionarymanager.getDictionaryDefinitionItems(this.dictionarymanager.currentDictionaryDefinition)}var e;return DictionaryManagerIndexAdd.prototype.close=function(){this.self.destroy()},DictionaryManagerIndexAdd.prototype.add=function(){this.dictionarymanager.dictionaryindexes.push(__assign({},this.index));for(var e=0,s=0,t=this.indexDictionaryItems;s<t.length;s++){var l=t[s];this.dictionarymanager.dictionaryindexitems.push({id:this.modelutilities.generateGuid(),scope:this.index.scope,status:this.index.status,sysdictionaryindex_id:this.index.id,sysdictionaryitem_id:l.id,sequence:e,deleted:0}),e++}this.close()},DictionaryManagerIndexAdd.prototype.onFieldDrop=function(e){var s=e.previousContainer.data.splice(e.previousIndex,1);e.container.data.splice(e.currentIndex,0,s[0])},DictionaryManagerIndexAdd=__decorate([core_1.Component({template:'<system-modal><system-modal-header (close)="close()"><system-label label="LBL_ADD_INDEX"></system-label></system-modal-header><system-modal-content><div class="slds-grid"><div class="slds-form-element__control slds-size--1-of-2 slds-p-right--xxx-small"><label class="slds-form-element__label"><abbr class="slds-required">*</abbr><system-label label="LBL_NAME"></system-label></label><system-input-text [(ngModel)]="index.name"></system-input-text></div><div class="slds-large-size--1-of-2 slds-p-left--xxx-small slds-form-element__control"><label class="slds-form-element__label"><abbr class="slds-required">*</abbr><system-label label="LBL_TYPE"></system-label></label><div class="slds-select_container"><select class="slds-select" [(ngModel)]="index.indextype"><option value="primary">primary</option><option value="index">index</option><option value="unique">unique</option></select></div></div></div><div class="slds-grid"><div class="slds-form-element__control slds-size--1-of-2 slds-p-right--xxx-small"><label class="slds-form-element__label"><abbr class="slds-required">*</abbr><system-label label="LBL_SCOPE"></system-label></label><div class="slds-select_container"><select class="slds-select" [(ngModel)]="index.scope"><option *ngIf="dictionarymanager.changescope == \'global\'" value="g"><system-label label="LBL_GLOBAL"></system-label></option><option value="c"><system-label label="LBL_CUSTOM"></system-label></option></select></div></div><div class="slds-size--1-of-4 slds-p-horizontal--xxx-small slds-form-element__control"><label class="slds-form-element__label"><system-label label="LBL_PACKAGE"></system-label></label><system-input-text [(ngModel)]="index.package"></system-input-text></div><div class="slds-size--1-of-4 slds-p-left--xxx-small slds-form-element__control"><label class="slds-form-element__label"><system-label label="LBL_VERSION"></system-label></label><system-input-text [(ngModel)]="index.version"></system-input-text></div></div><div class="slds-grid"><div class="slds-form-element slds-p-right--x-small slds-size--1-of-2"><span class="slds-form-element__label"><system-label label="LBL_AVAILABLE_ITEMS"></system-label></span><div class="slds-picklist slds-picklist__options slds-size--1-of-1" style="height: 50vh" cdkDropList #listOne="cdkDropList" [cdkDropListData]="availableDictionaryItems" [cdkDropListConnectedTo]="[listTwo]" (cdkDropListDropped)="onFieldDrop($event)"><div *ngFor="let domain of availableDictionaryItems" cdkDrag [cdkDragData]="domain" class="slds-drag--preview slds-picklist__item"><span class="slds-truncate">{{domain.name}}</span></div></div></div><div class="slds-form-element slds-p-left--x-small slds-size--1-of-2"><span class="slds-form-element__label"><system-label label="LBL_INDEX_ITEMS"></system-label></span><div class="slds-picklist slds-picklist__options slds-size--1-of-1 cdk-drag" style="height: 50vh" cdkDropList #listTwo="cdkDropList" [cdkDropListData]="indexDictionaryItems" [cdkDropListConnectedTo]="[listOne]" (cdkDropListDropped)="onFieldDrop($event)"><div *ngFor="let domain of indexDictionaryItems" cdkDrag [cdkDragData]="domain" class="slds-drag--preview slds-picklist__item"><span class="slds-truncate">{{domain.name}}</span></div></div></div></div></system-modal-content><system-modal-footer><button class="slds-button slds-button--neutral" (click)="close()"><system-label label="LBL_CANCEL"></system-label></button> <button class="slds-button slds-button--brand" (click)="add()"><system-label label="LBL_ADD"></system-label></button></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[dictionarymanager,"function"==typeof(e=void 0!==core_1.Injector&&core_1.Injector)?e:Object,services_1.modelutilities])],DictionaryManagerIndexAdd)}();exports.DictionaryManagerIndexAdd=DictionaryManagerIndexAdd;var DictionaryManagerIndexDetails=function(){function e(e,s,t,l,i,a){this.dictionarymanager=e,this.metadata=s,this.language=t,this.modal=l,this.injector=i,this.modelutilities=a,this.availableDictionaryItems=[],this.indexDictionaryItems=[]}var s;return e.prototype.ngOnChanges=function(e){var s=this;if(this.indexid){this.index=this.dictionarymanager.dictionaryindexes.find(function(e){return e.id==s.indexid}),this.availableDictionaryItems=this.dictionarymanager.getDictionaryDefinitionItems(this.dictionarymanager.currentDictionaryDefinition),this.indexDictionaryItems=[];for(var t=this.dictionarymanager.dictionaryindexitems.filter(function(e){return e.sysdictionaryindex_id==s.indexid&&0==e.deleted}).sort(function(e,s){return e.sequence>s.sequence?1:-1}),l=function(s){var e=i.availableDictionaryItems.findIndex(function(e){return e.id==s.sysdictionaryitem_id});i.indexDictionaryItems.push(i.availableDictionaryItems.splice(e,1)[0])},i=this,a=0,o=t;a<o.length;a++){l(o[a])}}else this.index=null},e.prototype.onFieldDrop=function(e){var s=this,t=e.previousContainer.data.splice(e.previousIndex,1);e.container.data.splice(e.currentIndex,0,t[0]);for(var l=this.dictionarymanager.dictionaryindexitems.filter(function(e){return e.sysdictionaryindex_id==s.indexid&&0==e.deleted}),i=0,a=[],o=function(s){var e=l.find(function(e){return e.sysdictionaryitem_id==s.id});if(e)e.sequence=i,a.push(e.id);else{var t=n.modelutilities.generateGuid();n.dictionarymanager.dictionaryindexitems.push({id:t,scope:n.index.scope,status:n.index.status,sysdictionaryindex_id:n.index.id,sysdictionaryitem_id:s.id,sequence:i,deleted:0}),a.push(t)}i++},n=this,d=0,r=this.indexDictionaryItems;d<r.length;d++){o(r[d])}for(var c=0,m=l;c<m.length;c++){var u=m[c];a.indexOf(u.id)<0&&(u.deleted=1)}},__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"indexid",void 0),e=__decorate([core_1.Component({selector:"dictionary-manager-index-details",template:'<div *ngIf="indexid"><div class="slds-text-heading--small slds-p-around--x-small slds-theme--shade"><system-label label="LBL_INDEX_DETAILS"></system-label></div><div system-to-bottom><div class="slds-p-around--x-small"><div class="slds-grid"><div class="slds-form-element__control slds-size--1-of-2 slds-p-right--xxx-small"><label class="slds-form-element__label"><system-label label="LBL_NAME"></system-label></label><system-input-text disabled [(ngModel)]="index.name"></system-input-text></div><div class="slds-large-size--1-of-2 slds-p-left--xxx-small slds-form-element__control"><label class="slds-form-element__label"><system-label label="LBL_TYPE"></system-label></label><div class="slds-select_container"><select disabled class="slds-select" [(ngModel)]="index.indextype"><option value="primary">primary</option><option value="index">index</option><option value="unique">unique</option></select></div></div></div><div class="slds-grid"><div class="slds-form-element__control slds-size--1-of-2 slds-p-right--xxx-small"><label class="slds-form-element__label"><system-label label="LBL_SCOPE"></system-label></label><div class="slds-select_container"><select disabled class="slds-select" [(ngModel)]="index.scope"><option *ngIf="dictionarymanager.changescope == \'global\'" value="g"><system-label label="LBL_GLOBAL"></system-label></option><option value="c"><system-label label="LBL_CUSTOM"></system-label></option></select></div></div><div class="slds-size--1-of-4 slds-p-horizontal--xxx-small slds-form-element__control"><label class="slds-form-element__label"><system-label label="LBL_PACKAGE"></system-label></label><system-input-text [(ngModel)]="index.package"></system-input-text></div><div class="slds-size--1-of-4 slds-p-left--xxx-small slds-form-element__control"><label class="slds-form-element__label"><system-label label="LBL_VERSION"></system-label></label><system-input-text [(ngModel)]="index.version"></system-input-text></div></div><div class="slds-grid"><div class="slds-form-element slds-p-right--x-small slds-size--1-of-2"><span class="slds-form-element__label"><system-label label="LBL_AVAILABLE_ITEMS"></system-label></span><div class="slds-picklist slds-picklist__options slds-size--1-of-1" cdkDropList #listOne="cdkDropList" [cdkDropListData]="availableDictionaryItems" [cdkDropListConnectedTo]="[listTwo]" (cdkDropListDropped)="onFieldDrop($event)"><div *ngFor="let domain of availableDictionaryItems" cdkDrag [cdkDragData]="domain" class="slds-drag--preview slds-picklist__item"><span class="slds-truncate">{{domain.name}}</span></div></div></div><div class="slds-form-element slds-p-left--x-small slds-size--1-of-2"><span class="slds-form-element__label"><system-label label="LBL_INDEX_ITEMS"></system-label></span><div class="slds-picklist slds-picklist__options slds-size--1-of-1 cdk-drag" cdkDropList #listTwo="cdkDropList" [cdkDropListData]="indexDictionaryItems" [cdkDropListConnectedTo]="[listOne]" (cdkDropListDropped)="onFieldDrop($event)"><div *ngFor="let domain of indexDictionaryItems" cdkDrag [cdkDragData]="domain" class="slds-drag--preview slds-picklist__item"><span class="slds-truncate">{{domain.name}}</span></div></div></div></div></div></div></div>'}),__metadata("design:paramtypes",[dictionarymanager,services_1.metadata,services_1.language,services_1.modal,"function"==typeof(s=void 0!==core_1.Injector&&core_1.Injector)?s:Object,services_1.modelutilities])],e)}();exports.DictionaryManagerIndexDetails=DictionaryManagerIndexDetails;var DictionaryManagerFields=function(){function e(e,s,t,l,i,a){this.dictionarymanager=e,this.metadata=s,this.language=t,this.modal=l,this.injector=i,this.modelutilities=a}var s;return Object.defineProperty(e.prototype,"dictionaryitems",{get:function(){return this.dictionarymanager.currentDictionaryDefinition?this.dictionarymanager.getDictionaryDefinitionItems(this.dictionarymanager.currentDictionaryDefinition):[]},enumerable:!1,configurable:!0}),e.prototype.getDomainFields=function(s,e){void 0===e&&(e=!0);var t=this.dictionarymanager.domainfields.filter(function(e){return e.sysdomaindefinition_id==s&&0==e.deleted}).sort(function(e,s){return e.sequence>s.sequence?1:-1});return t?e?t.slice(0,1):t.slice(1):[]},e.prototype.getRefDefinitionName=function(s){var e;return s!=this.dictionarymanager.currentDictionaryDefinition?null===(e=this.dictionarymanager.dictionarydefinitions.find(function(e){return e.id==s}))||void 0===e?void 0:e.name:""},e.prototype.translateDomainField=function(e,s){return e.replace("{sysdictionaryitems.name}",s.name)},e=__decorate([core_1.Component({selector:"dictionary-manager-fields",template:'<div system-to-bottom><ng-container *ngIf="dictionarymanager.currentDictionaryDefinition; else selectdefinition"><table class="slds-table slds-table_cell-buffer slds-table_bordered"><thead><tr class="slds-line-height_reset"><th scope="col"><div class="slds-truncate"><system-label label="LBL_NAME"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_DOMAIN"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_FIELD"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_TEMPLATE"></system-label></div></th></tr></thead><tbody><ng-container *ngFor="let dictionaryitem of dictionaryitems"><tr class="slds-hint-parent"><td data-label="Name"><div class="slds-truncate">{{dictionaryitem.name}}</div></td><td data-label="Domain"><div class="slds-truncate">{{dictionarymanager.getDomainName(dictionaryitem.sysdomaindefinition_id)}}</div></td><td data-label="Field"><div class="slds-truncate">{{translateDomainField(getDomainFields(dictionaryitem.sysdomaindefinition_id)[0].name, dictionaryitem)}}</div></td><td data-label="Template"><div class="slds-truncate">{{getRefDefinitionName(dictionaryitem.sysdictionarydefinition_id)}}</div></td></tr><tr class="slds-hint-parent" *ngFor="let field of getDomainFields(dictionaryitem.sysdomaindefinition_id, false)"><td data-label="Name"></td><td data-label="Domain"></td><td data-label="Field"><div class="slds-truncate">{{translateDomainField(field.name, dictionaryitem)}}</div></td><td data-label="Template"></td></tr></ng-container></tbody></table></ng-container><ng-template #selectdefinition><div class="slds-size--1-of-1 slds-height_full slds-align--absolute-center"><system-label label="LBL_SELECT_A_DICTIONARYDEFINITION"></system-label></div></ng-template></div>'}),__metadata("design:paramtypes",[dictionarymanager,services_1.metadata,services_1.language,services_1.modal,"function"==typeof(s=void 0!==core_1.Injector&&core_1.Injector)?s:Object,services_1.modelutilities])],e)}();exports.DictionaryManagerFields=DictionaryManagerFields;var DomainManager=function(){function DomainManager(e,s,t,l,i,a,o,n,d){this.domainmanager=e,this.backend=s,this.metadata=t,this.language=l,this.modelutilities=i,this.broadcast=a,this.toast=o,this.modal=n,this.injector=d}var e;return DomainManager.prototype.save=function(){this.domainmanager.save()},DomainManager=__decorate([core_1.Component({template:'<workbench-header titlelabel="LBL_DOMAIN_MANAGER"><workbench-header-controls><button class="slds-button slds-button--neutral" (click)="save()"><system-label label="LBL_SAVE"></system-label></button> <button class="slds-button slds-button--neutral" (click)="domainmanager.generateENUMSFromModules()"><system-label label="LBL_GENERATE"></system-label></button></workbench-header-controls></workbench-header><div class="slds-grid"><div class="slds-size--1-of-3"><domain-manager-definitions></domain-manager-definitions></div><div class="slds-size--2-of-3 slds-theme--default slds-border--left" system-to-bottom-noscroll><div style="height: 50%" class="slds-scrollable--y"><domain-manager-fields></domain-manager-fields></div><div style="height: 50%" class="slds-p-around--xx-small slds-scrollable--y"><domain-manager-field-tabs></domain-manager-field-tabs></div></div></div>',providers:[services_1.metadata,domainmanager]}),__metadata("design:paramtypes",[domainmanager,services_1.backend,services_1.metadata,services_1.language,services_1.modelutilities,services_1.broadcast,services_1.toast,services_1.modal,"function"==typeof(e=void 0!==core_1.Injector&&core_1.Injector)?e:Object])],DomainManager)}();exports.DomainManager=DomainManager;var DomainManagerDefinitions=function(){function e(e,s,t,l,i,a,o,n,d){this.domainmanager=e,this.backend=s,this.metadata=t,this.language=l,this.modelutilities=i,this.broadcast=a,this.toast=o,this.modal=n,this.injector=d}var s;return Object.defineProperty(e.prototype,"domaindefinitions",{get:function(){var s=this;return this.domainmanager.domaindefinitions.filter(function(e){return!e.deleted&&(!s.definitionfilterterm||0<=e.name.toLowerCase().indexOf(s.definitionfilterterm.toLowerCase()))}).sort(function(e,s){return e.name>s.name?1:-1})},enumerable:!1,configurable:!0}),e.prototype.trackByFn=function(e,s){return s.id},e.prototype.setCurrentDomainDefintion=function(e){this.domainmanager.currentDomainDefinition=e,this.domainmanager.currentDomainField=null},e.prototype.addDomainDefinition=function(e){e.stopPropagation(),this.modal.openModal("DomainManagerAddDefinitionModal",!0,this.injector)},e.prototype.deleteDomainDefinition=function(e,l){var i=this;e.stopPropagation(),this.modal.prompt("confirm",this.language.getLabel("MSG_DELETE_RECORD","","long"),this.language.getLabel("MSG_DELETE_RECORD")).subscribe(function(e){if(e){i.domainmanager.domaindefinitions.find(function(e){return e.id==l}).deleted=1;for(var s=0,t=i.domainmanager.domainfields.filter(function(e){return e.sysdomaindefinition_id==l});s<t.length;s++){t[s].deleted=1}i.domainmanager.currentDomainDefinition==l&&(i.domainmanager.currentDomainDefinition,i.domainmanager.currentDomainField)}})},e=__decorate([core_1.Component({selector:"domain-manager-definitions",template:'<div class="slds-p-around--xx-small slds-grid slds-grid--vertical-align-center slds-border--bottom"><system-utility-icon icon="filterList" size="x-small"></system-utility-icon><system-input-text placeholder="LBL_SEARCH" class="slds-grow slds-p-horizontal--xx-small" [(ngModel)]="definitionfilterterm"></system-input-text></div><div system-to-bottom><table class="slds-table slds-table_cell-buffer slds-table_bordered slds-table--header-fixed"><thead><tr class="slds-line-height_reset"><th style="width:2.5rem" scope="col"></th><th scope="col"><div class="slds-truncate slds-th__action slds-p-horizontal--x-small"><system-label label="LBL_DOMAIN"></system-label></div></th><th scope="col"><div class="slds-truncate slds-th__action slds-p-horizontal--x-small"><system-label label="LBL_TYPE"></system-label></div></th><th style="width:2rem" scope="col"></th></tr></thead><tbody><tr class="slds-hint-parent" [ngClass]="{\'slds-is-selected\':domainmanager.currentDomainDefinition == domaindefinition.id}" *ngFor="let domaindefinition of domaindefinitions; trackBy: trackByFn" (click)="setCurrentDomainDefintion(domaindefinition.id)"><td><system-utility-icon class="slds-p-right--xx-small" size="xx-small" [icon]="domaindefinition.scope == \'g\' ? \'world\' : \'people\'"></system-utility-icon><dictionary-manager-item-status [(ngModel)]="domaindefinition.status"></dictionary-manager-item-status></td><td data-label="Domain"><div class="slds-truncate">{{domaindefinition.name}}</div></td><td data-label="Type"><div class="slds-truncate">{{domaindefinition.fieldtype}}</div></td><td class="slds-align--absolute-center" style="width: 2rem;"><system-utility-icon size="xx-small" icon="delete" (click)="deleteDomainDefinition($event, domaindefinition.id)"></system-utility-icon></td></tr></tbody></table><div class="slds-align--absolute-center slds-border--top slds-p-around--small slds-theme--shade" style="position: sticky; bottom: 0;"><system-utility-icon (click)="addDomainDefinition($event)" icon="new" size="x-small" style="cursor: pointer"></system-utility-icon></div></div>'}),__metadata("design:paramtypes",[domainmanager,services_1.backend,services_1.metadata,services_1.language,services_1.modelutilities,services_1.broadcast,services_1.toast,services_1.modal,"function"==typeof(s=void 0!==core_1.Injector&&core_1.Injector)?s:Object])],e)}();exports.DomainManagerDefinitions=DomainManagerDefinitions;var DomainManagerFields=function(){function e(e,s,t,l,i,a,o,n,d){this.domainmanager=e,this.backend=s,this.metadata=t,this.language=l,this.modelutilities=i,this.broadcast=a,this.toast=o,this.modal=n,this.injector=d}var s;return Object.defineProperty(e.prototype,"domainfields",{get:function(){for(var s=this,e=this.domainmanager.domainfields.filter(function(e){return 0==e.deleted&&e.sysdomaindefinition_id==s.domainmanager.currentDomainDefinition&&"c"==e.scope}),t=function(s){-1==e.findIndex(function(e){return e.name==s.name})&&e.push(s)},l=0,i=this.domainmanager.domainfields.filter(function(e){return 0==e.deleted&&e.sysdomaindefinition_id==s.domainmanager.currentDomainDefinition&&"c"!=e.scope});l<i.length;l++){t(i[l])}return e.sort(function(e,s){return e.sequence>s.sequence?1:-1})},enumerable:!1,configurable:!0}),e.prototype.drop=function(e){var s=this.domainfields,t=s.splice(e.previousIndex,1);s.splice(e.currentIndex,0,t[0]);for(var l=0,i=0,a=s;i<a.length;i++){a[i].sequence=l,l++}},e.prototype.addDomainField=function(e){e.stopPropagation(),this.modal.openModal("DomainManagerAddFieldModal",!0,this.injector)},e.prototype.deleteDomainField=function(e,s){var t=this;e.stopPropagation(),this.modal.prompt("confirm",this.language.getLabel("MSG_DELETE_RECORD","","long"),this.language.getLabel("MSG_DELETE_RECORD")).subscribe(function(e){e&&(t.domainmanager.domainfields.find(function(e){return e.id==s}).deleted=1,t.domainmanager.currentDomainField==s&&t.domainmanager.currentDomainField)})},e.prototype.customizeDomainField=function(e,t){var l=this;e.stopPropagation(),"g"==t.scope&&this.modal.prompt("confirm","Customize the Field?","Customize").subscribe(function(e){if(e){var s=__assign({},t);s.id=l.modelutilities.generateGuid(),s.scope="c",l.domainmanager.domainfields.push(s),l.domainmanager.currentDomainField=s.id}})},e.prototype.setStatus=function(e,s){e.stopPropagation(),"d"==s.status?s.status="a":"a"==s.status?s.status="i":s.status="a"},e.prototype.trackByFn=function(e,s){return s.id},e=__decorate([core_1.Component({selector:"domain-manager-fields",template:'<ng-container *ngIf="domainmanager.currentDomainDefinition; else selectdomain"><table class="slds-table slds-table_cell-buffer slds-table_bordered"><thead><tr class="slds-line-height_reset"><th style="width: 3rem" scope="col"></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_FIELD"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_DBTYPE"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_TYPE"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_LENGTH"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_REQUIRED"></system-label></div></th><th style="width:2rem" scope="col"></th></tr></thead><tbody class="dragboundary" cdkDropList (cdkDropListDropped)="drop($event)"><tr class="slds-hint-parent" *ngFor="let domainfield of domainfields;trackBy: trackByFn" [ngClass]="{\'slds-is-selected\': domainmanager.currentDomainField == domainfield.id}" cdkDrag cdkDragBoundary=".dragboundary" (click)="domainmanager.currentDomainField = domainfield.id"><td><system-utility-icon class="slds-p-right--xx-small" cdkDragHandle [icon]="\'rows\'" [size]="\'x-small\'" style="cursor:move"></system-utility-icon><system-utility-icon (click)="customizeDomainField($event, domainfield)" class="slds-p-right--xx-small" size="xx-small" [icon]="domainfield.scope == \'g\' ? \'world\' : \'people\'"></system-utility-icon><system-utility-icon (click)="setStatus($event, domainfield)" [colorclass]="domainmanager.getStatusColor(domainfield.status)" class="slds-p-right--xx-small" size="xx-small" icon="light_bulb"></system-utility-icon></td><td data-label="Domain"><div class="slds-truncate">{{domainfield.name}}</div></td><td data-label="Type"><div class="slds-truncate">{{domainfield.dbtype}}</div></td><td data-label="Type"><div class="slds-truncate">{{domainfield.fieldtype}}</div></td><td data-label="Type"><div class="slds-truncate">{{domainfield.len}}</div></td><td data-label="Type" class="slds-p-vertical--none"><system-checkbox disabled [ngModel]="domainfield.required == \'1\'"></system-checkbox></td><td class="slds-align--absolute-center" style="width: 2rem;"><system-utility-icon size="xx-small" icon="delete" (click)="deleteDomainField($event, domainfield.id)"></system-utility-icon></td></tr></tbody></table><div class="slds-align--absolute-center slds-p-around--small"><system-utility-icon (click)="addDomainField($event)" icon="new" size="x-small"></system-utility-icon></div></ng-container><ng-template #selectdomain><div class="slds-size--1-of-1 slds-height_full slds-align--absolute-center"><system-label label="LBL_SELECT_A_DOMAIN"></system-label></div></ng-template>'}),__metadata("design:paramtypes",[domainmanager,services_1.backend,services_1.metadata,services_1.language,services_1.modelutilities,services_1.broadcast,services_1.toast,services_1.modal,"function"==typeof(s=void 0!==core_1.Injector&&core_1.Injector)?s:Object])],e)}();exports.DomainManagerFields=DomainManagerFields;var DomainManagerFieldTabs=function(){function e(e,s,t,l,i,a,o,n,d){this.domainmanager=e,this.backend=s,this.metadata=t,this.language=l,this.modelutilities=i,this.broadcast=a,this.toast=o,this.modal=n,this.injector=d,this.tabScope="details"}var s;return Object.defineProperty(e.prototype,"domainfields",{get:function(){return this.domainmanager.domainfields},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentField",{get:function(){var s=this;return this.domainfields.find(function(e){return e.id==s.domainmanager.currentDomainField})},enumerable:!1,configurable:!0}),e=__decorate([core_1.Component({selector:"domain-manager-field-tabs",template:'<div class="slds-tabs_scoped" *ngIf="domainmanager.currentDomainField; else selectfield"><ul class="slds-tabs_scoped__nav" role="tablist"><li class="slds-tabs_scoped__item" [ngClass]="{\'slds-is-active\': tabScope == \'details\'}" title="Item One" role="presentation" (click)="tabScope = \'details\'"><a class="slds-tabs_scoped__link" href="javascript:void(0);" role="tab" tabindex="0"><system-label label="LBL_DETAILS"></system-label></a></li><li class="slds-tabs_scoped__item" [ngClass]="{\'slds-is-active\': tabScope == \'validations\'}" title="Item Two" role="presentation" (click)="tabScope = \'validations\'"><a class="slds-tabs_scoped__link" href="javascript:void(0);" role="tab" tabindex="-1"><system-label label="LBL_VALIDATION"></system-label></a></li></ul><div class="slds-tabs_scoped__content slds-show slds-p-around--none" [ngClass]="{\'slds-hide\': tabScope != \'details\'}" role="tabpanel" system-to-bottom-noscroll><domainmanager-field-details [field]="currentField"></domainmanager-field-details></div><div class="slds-tabs_scoped__content slds-show slds-p-around--none" [ngClass]="{\'slds-hide\': tabScope != \'validations\'}" role="tabpanel" system-to-bottom-noscroll><domainmanager-field-validation [field]="currentField"></domainmanager-field-validation></div></div><ng-template #selectfield><div class="slds-size--1-of-1 slds-height_full slds-align--absolute-center"><system-label label="LBL_SELECT_A_FIELD"></system-label></div></ng-template>'}),__metadata("design:paramtypes",[domainmanager,services_1.backend,services_1.metadata,services_1.language,services_1.modelutilities,services_1.broadcast,services_1.toast,services_1.modal,"function"==typeof(s=void 0!==core_1.Injector&&core_1.Injector)?s:Object])],e)}();exports.DomainManagerFieldTabs=DomainManagerFieldTabs;var DomainManagerFieldDetails=function(){function e(e,s,t,l){this.backend=e,this.metadata=s,this.language=t,this.domainmanager=l,this.field={}}return Object.defineProperty(e.prototype,"required",{get:function(){return"1"==this.field.required},set:function(e){this.field.required=e?"1":"0"},enumerable:!1,configurable:!0}),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"field",void 0),e=__decorate([core_1.Component({selector:"domainmanager-field-details",template:'<div class="slds-p-around--x-small"><div class="slds-grid"><div class="slds-size--3-of-4 slds-form-element slds-m-vertical--xxx-small"><div class="slds-form-element__control"><label class="slds-form-element__label"><system-label label="LBL_NAME"></system-label></label> <input type="text" disabled class="slds-input" [(ngModel)]="field.name"></div></div><div class="slds-size--1-of-4 slds-form-element__control slds-size--1-of-4 slds-m-vertical--xxx-small slds-p-left--x-small"><label class="slds-form-element__label"><system-label label="LBL_SCOPE"></system-label></label><div class="slds-select_container"><select disabled class="slds-select" [(ngModel)]="field.scope"><option value="g"><system-label label="LBL_GLOBAL"></system-label></option><option value="c"><system-label label="LBL_CUSTOM"></system-label></option></select></div></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label"><system-label label="LBL_DBTYPE"></system-label></label><div class="slds-select_container"><select disabled class="slds-select" [(ngModel)]="field.dbtype"><option *ngFor="let dbtype of domainmanager.dbtypes" [value]="dbtype">{{dbtype}}</option></select></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label"><system-label label="LBL_TYPE"></system-label></label><div class="slds-select_container"><select class="slds-select" [(ngModel)]="field.fieldtype"><option *ngFor="let fieldtype of domainmanager.fieldtypes" [value]="fieldtype">{{fieldtype}}</option></select></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label"><system-label label="LBL_LABEL"></system-label></label><div class="slds-select_container"><system-input-label [(ngModel)]="field.label"></system-input-label></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label"><system-label label="LBL_LENGTH"></system-label></label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="field.len"></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label"><system-label label="LBL_REQUIRED"></system-label></label><div class="slds-form-element__control"><system-checkbox [asinteger]="true" [(ngModel)]="required">required</system-checkbox></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label"><system-label label="LBL_COMMENT"></system-label></label><div class="slds-form-element__control"><textarea class="slds-textarea" [(ngModel)]="field.description"></textarea></div></div><div class="slds-grid slds-m-vertical--xxx-small slds-gutters_direct-xx-small"><div class="slds-col slds-size--1-of-2 slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_VERSION"></system-label></label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="field.version"></div></div><div class="slds-col slds-size--1-of-2 slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_PACKAGE"></system-label></label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="field.package"></div></div></div></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.metadata,services_1.language,domainmanager])],e)}();exports.DomainManagerFieldDetails=DomainManagerFieldDetails;var DomainManagerFieldValidation=function(){function e(e,s,t,l,i){this.domainmanager=e,this.language=s,this.modelutilities=t,this.modal=l,this.injector=i,this.field={}}var s;return e.prototype.ngOnChanges=function(e){},Object.defineProperty(e.prototype,"validation",{get:function(){return this.domainmanager.getValidationById(this.field.sysdomainfieldvalidation_id)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"validationvalues",{get:function(){return this.domainmanager.getValdiationValuesdById(this.field.sysdomainfieldvalidation_id).sort(function(e,s){return e.sequence>s.sequence?1:-1})},enumerable:!1,configurable:!0}),e.prototype.addValidationValue=function(e){var s=this;e.stopPropagation(),this.modal.openModal("DomainManagerAddValidationValueModal",!0,this.injector).subscribe(function(e){e.instance.fieldvalidationvalue.sysdomainfieldvalidation_id=s.field.sysdomainfieldvalidation_id,e.instance.fieldvalidationvalue.sequence=s.validationvalues.length})},e.prototype.deleteValidation=function(e,s){e.preventDefault();var t=this.domainmanager.domainfieldvalidationvalues.findIndex(function(e){return e.id==s});0<=t&&this.domainmanager.domainfieldvalidationvalues.splice(t,1)},e.prototype.customizeValidationValue=function(e,t){var l=this;e.stopPropagation(),"g"==t.scope&&this.modal.prompt("confirm","Customize the Domain?","Customize").subscribe(function(e){if(e){var s=__assign({},t);s.id=l.modelutilities.generateGuid(),s.scope="c",l.domainmanager.domainfieldvalidationvalues.push(s)}})},e.prototype.drop=function(e){var s=this.validationvalues,t=s.splice(e.previousIndex,1);s.splice(e.currentIndex,0,t[0]);for(var l=0,i=0,a=s;i<a.length;i++){a[i].sequence=l,l++}},e.prototype.unlinkValidation=function(){this.field.sysdomainfieldvalidation_id=null},e.prototype.selectValidation=function(){this.modal.openModal("DomainManagerSelectValidation",!0,this.injector)},e.prototype.addValidation=function(){this.modal.openModal("DomainManagerAddValidation",!0,this.injector)},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"field",void 0),e=__decorate([core_1.Component({selector:"domainmanager-field-validation",template:'<div *ngIf="field.sysdomainfieldvalidation_id; else novalidation"><div class="slds-grid slds-gutters_direct-xx-small slds-p-around--x-small"><div class="slds-col slds-grow slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_NAME"></system-label></label><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_right"><input type="text" disabled [(ngModel)]="validation.name" class="slds-input"> <button class="slds-button slds-button_icon slds-input__icon slds-input__icon_right" (click)="unlinkValidation()"><system-button-icon icon="unlinked"></system-button-icon></button></div></div><div class="slds-col slds-size--1-of-4 slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_TYPE"></system-label></label><div class="slds-form-element__control"><input type="text" disabled [(ngModel)]="validation.validation_type" class="slds-input"></div></div><div class="slds-col slds-size--1-of-4 slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_VERSION"></system-label></label><div class="slds-form-element__control"><input type="text" [(ngModel)]="validation.version" class="slds-input"></div></div><div class="slds-col slds-size--1-of-4 slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_PACKAGE"></system-label></label><div class="slds-form-element__control"><input type="text" [(ngModel)]="validation.package" class="slds-input"></div></div></div><div system-to-bottom><table class="slds-table slds-table_cell-buffer slds-table_bordered slds-table--header-fixed"><thead><tr class="slds-line-height_reset"><th style="width:2rem" scope="col"></th><th *ngIf="validation.validation_type == \'enum\'" scope="col"><div class="slds-truncate slds-th__action slds-p-horizontal--x-small">value</div></th><th *ngIf="validation.validation_type != \'enum\'" scope="col"><div class="slds-truncate slds-th__action slds-p-horizontal--x-small">min</div></th><th *ngIf="validation.validation_type != \'enum\'" scope="col"><div class="slds-truncate slds-th__action slds-p-horizontal--x-small">max</div></th><th scope="col"><div class="slds-truncate slds-th__action slds-p-horizontal--x-small">label</div></th><th scope="col"><div class="slds-truncate slds-th__action slds-p-horizontal--x-small">comment</div></th><th scope="col"><div class="slds-truncate slds-th__action slds-p-horizontal--x-small">version</div></th><th scope="col"><div class="slds-truncate slds-th__action slds-p-horizontal--x-small">package</div></th><th style="width:2rem" scope="col"></th></tr></thead><tbody class="dragboundary" cdkDropList (cdkDropListDropped)="drop($event)"><tr class="slds-hint-parent" *ngFor="let validationvalue of validationvalues" cdkDrag cdkDragBoundary=".dragboundary"><td class="slds-grid slds-align--absolute-center" style="min-height: 40px;"><system-utility-icon class="slds-p-right--xx-small" cdkDragHandle [icon]="\'rows\'" [size]="\'x-small\'" style="cursor:move"></system-utility-icon><system-utility-icon (click)="customizeValidationValue($event, validationvalue)" class="slds-p-right--xx-small" size="xx-small" [icon]="validationvalue.scope == \'g\' ? \'world\' : \'people\'"></system-utility-icon><dictionary-manager-item-status [(ngModel)]="validationvalue.status"></dictionary-manager-item-status></td><td *ngIf="validation.validation_type == \'enum\'"><input type="text" [(ngModel)]="validationvalue.enumvalue" class="slds-input"></td><td *ngIf="validation.validation_type != \'enum\'"><input type="text" [(ngModel)]="validationvalue.minvalue" class="slds-input"></td><td *ngIf="validation.validation_type != \'enum\'"><input type="text" [(ngModel)]="validationvalue.maxvalue" class="slds-input"></td><td><system-input-label [(ngModel)]="validationvalue.label"></system-input-label></td><td><input type="text" [(ngModel)]="validationvalue.comment" class="slds-input"></td><td><input type="text" [(ngModel)]="validationvalue.version" class="slds-input"></td><td><input type="text" [(ngModel)]="validationvalue.package" class="slds-input"></td><td class="slds-align--absolute-center" style="min-height: 40px;"><system-utility-icon size="xx-small" (click)="deleteValidation($event, validationvalue.id)" icon="delete"></system-utility-icon></td></tr></tbody></table><div class="slds-align--absolute-center slds-p-around--small"><system-utility-icon (click)="addValidationValue($event)" icon="new" size="x-small"></system-utility-icon></div></div></div><ng-template #novalidation><div class="slds-align--absolute-center slds-p-around--small" system-to-bottom-noscroll><div class="slds-grid slds-grid--vertical-align-center"><button class="slds-button slds-button--neutral" (click)="addValidation()"><system-label label="LBL_ADD"></system-label></button><div class="slds-p-horizontal--x-small"><system-label label="LBL_OR"></system-label></div><button class="slds-button slds-button--neutral" (click)="selectValidation()"><system-label label="LBL_SELECT"></system-label></button></div></div></ng-template>'}),__metadata("design:paramtypes",[domainmanager,services_1.language,services_1.modelutilities,services_1.modal,"function"==typeof(s=void 0!==core_1.Injector&&core_1.Injector)?s:Object])],e)}();exports.DomainManagerFieldValidation=DomainManagerFieldValidation;var DomainManagerAddDefinitionModal=function(){function DomainManagerAddDefinitionModal(e,s,t){this.domainmanager=e,this.metadata=s,this.modelutilities=t,this.domaindefinition={name:"",fieldtype:"",scope:"g",deleted:0,status:"d"}}return DomainManagerAddDefinitionModal.prototype.close=function(){this.self.destroy()},Object.defineProperty(DomainManagerAddDefinitionModal.prototype,"canSave",{get:function(){var s=this;return this.domaindefinition.name&&this.domaindefinition.fieldtype&&!this.domainmanager.domaindefinitions.find(function(e){return e.name==s.domaindefinition.name})},enumerable:!1,configurable:!0}),DomainManagerAddDefinitionModal.prototype.save=function(){this.canSave&&(this.domaindefinition.id=this.modelutilities.generateGuid(),this.domainmanager.domaindefinitions.push(this.domaindefinition),this.close())},DomainManagerAddDefinitionModal=__decorate([core_1.Component({template:'<system-modal><system-modal-header (close)="close()">Add Domain Definition</system-modal-header><system-modal-content><div class="slds-grid"><div class="slds-form-element__control slds-size--3-of-4 slds-p-right--xxx-small"><label class="slds-form-element__label"><abbr class="slds-required">*</abbr><system-label label="LBL_NAME"></system-label></label><system-input-text [(ngModel)]="domaindefinition.name"></system-input-text></div><div class="slds-form-element__control slds-size--1-of-4 slds-p-left--xxx-small"><label class="slds-form-element__label"><abbr class="slds-required">*</abbr><system-label label="LBL_SCOPE"></system-label></label><div class="slds-select_container"><select class="slds-select" [(ngModel)]="domaindefinition.scope"><option value="g"><system-label label="LBL_GLOBAL"></system-label></option><option value="c"><system-label label="LBL_CUSTOM"></system-label></option></select></div></div></div><div class="slds-grid"><div class="slds-large-size--1-of-2 slds-p-right--xxx-small slds-form-element__control"><label class="slds-form-element__label"><abbr class="slds-required">*</abbr><system-label label="LBL_TYPE"></system-label></label><div class="slds-select_container"><select class="slds-select" [(ngModel)]="domaindefinition.fieldtype"><option *ngFor="let fieldtype of domainmanager.fieldtypes" [value]="fieldtype">{{fieldtype}}</option></select></div></div><div class="slds-size--1-of-4 slds-p-right--xxx-small slds-form-element__control"><label class="slds-form-element__label"><system-label label="LBL_PACKAGE"></system-label></label><system-input-text [(ngModel)]="domaindefinition.package"></system-input-text></div><div class="slds-size--1-of-4 slds-p-left--xxx-small slds-form-element__control"><label class="slds-form-element__label"><system-label label="LBL_VERSION"></system-label></label><system-input-text [(ngModel)]="domaindefinition.version"></system-input-text></div></div><label class="slds-form-element__label"><system-label label="LBL_COMMENT"></system-label></label><system-richtext-editor [(ngModel)]="domaindefinition.description"></system-richtext-editor></system-modal-content><system-modal-footer><button class="slds-button slds-button--neutral" (click)="close()"><system-label label="LBL_CLOSE"></system-label></button> <button class="slds-button slds-button--brand" (click)="save()" [disabled]="!canSave"><system-label label="LBL_SAVE"></system-label></button></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[domainmanager,services_1.metadata,services_1.modelutilities])],DomainManagerAddDefinitionModal)}();exports.DomainManagerAddDefinitionModal=DomainManagerAddDefinitionModal;var DomainManagerAddFieldModal=function(){function DomainManagerAddFieldModal(e,s,t){this.domainmanager=e,this.metadata=s,this.modelutilities=t,this.domainfield={name:"{sysdictionaryitems.name}",fieldtype:"",scope:"g",required:0,deleted:0,status:"d"}}return DomainManagerAddFieldModal.prototype.close=function(){this.self.destroy()},Object.defineProperty(DomainManagerAddFieldModal.prototype,"canSave",{get:function(){var s=this;return this.domainfield.name&&this.domainfield.dbtype&&!this.domainmanager.domainfields.find(function(e){return e.name==s.domainfield.name&&e.sysdomaindefinition_id==s.domainmanager.currentDomainDefinition})},enumerable:!1,configurable:!0}),DomainManagerAddFieldModal.prototype.save=function(){var s=this;this.canSave&&(this.domainfield.sequence=this.domainmanager.domainfields.filter(function(e){return e.sysdomaindefinition_id==s.domainmanager.currentDomainDefinition}).length,this.domainfield.id=this.modelutilities.generateGuid(),this.domainfield.sysdomaindefinition_id=this.domainmanager.currentDomainDefinition,this.domainmanager.domainfields.push(this.domainfield),this.close())},DomainManagerAddFieldModal=__decorate([core_1.Component({template:'<system-modal><system-modal-header (close)="close()">Add Domain Field</system-modal-header><system-modal-content><div class="slds-grid"><div class="slds-form-element__control slds-size--3-of-4 slds-p-right--xxx-small"><label class="slds-form-element__label"><abbr class="slds-required">*</abbr><system-label label="LBL_NAME"></system-label></label><system-input-text [(ngModel)]="domainfield.name"></system-input-text></div><div class="slds-form-element__control slds-size--1-of-4 slds-p-left--xxx-small"><label class="slds-form-element__label"><abbr class="slds-required">*</abbr><system-label label="LBL_SCOPE"></system-label></label><div class="slds-select_container"><select class="slds-select" [(ngModel)]="domainfield.scope"><option value="g"><system-label label="LBL_GLOBAL"></system-label></option><option value="c"><system-label label="LBL_CUSTOM"></system-label></option></select></div></div></div><div class="slds-grid"><div class="slds-large-size--1-of-4 slds-p-right--xxx-small slds-form-element__control"><label class="slds-form-element__label"><abbr class="slds-required">*</abbr><system-label label="LBL_DBTYPE"></system-label></label><div class="slds-select_container"><select class="slds-select" [(ngModel)]="domainfield.dbtype"><option *ngFor="let dbtype of domainmanager.dbtypes" [value]="dbtype">{{dbtype}}</option></select></div></div><div class="slds-form-element__control slds-size--1-of-4 slds-p-horizontal--xxx-small"><label class="slds-form-element__label"><system-label label="LBL_LENGTH"></system-label></label><system-input-text [(ngModel)]="domainfield.len"></system-input-text></div><div class="slds-large-size--1-of-4 slds-p-horizontal--xxx-small slds-form-element__control"><label class="slds-form-element__label"><system-label label="LBL_REQUIRED"></system-label></label><system-checkbox [asinteger]="true" [(ngModel)]="domainfield.required"></system-checkbox></div><div class="slds-large-size--1-of-4 slds-p-left--xxx-small slds-form-element__control"><label class="slds-form-element__label"><system-label label="LBL_TYPE"></system-label></label><div class="slds-select_container"><select class="slds-select" [(ngModel)]="domainfield.fieldtype"><option *ngFor="let fieldtype of domainmanager.fieldtypes" [value]="fieldtype">{{fieldtype}}</option></select></div></div></div><div class="slds-grid"><div class="slds-size--1-of-2 slds-p-right--xxx-small slds-form-element__control"><label class="slds-form-element__label"><system-label label="LBL_PACKAGE"></system-label></label><system-input-text [(ngModel)]="domainfield.package"></system-input-text></div><div class="slds-size--1-of-2 slds-p-left--xxx-small slds-form-element__control"><label class="slds-form-element__label"><system-label label="LBL_VERSION"></system-label></label><system-input-text [(ngModel)]="domainfield.version"></system-input-text></div></div><label class="slds-form-element__label"><system-label label="LBL_COMMENT"></system-label></label><system-richtext-editor [(ngModel)]="domainfield.description"></system-richtext-editor></system-modal-content><system-modal-footer><button class="slds-button slds-button--neutral" (click)="close()"><system-label label="LBL_CLOSE"></system-label></button> <button class="slds-button slds-button--brand" (click)="save()" [disabled]="!canSave"><system-label label="LBL_SAVE"></system-label></button></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[domainmanager,services_1.metadata,services_1.modelutilities])],DomainManagerAddFieldModal)}();exports.DomainManagerAddFieldModal=DomainManagerAddFieldModal;var DomainManagerSelectValidation=function(){function DomainManagerSelectValidation(e){this.domainmanager=e,this.validations=[],this.validations=e.domainfieldvalidations.filter(function(e){return 0==e.deleted}).sort(function(e,s){return e.name>s.name?1:-1})}return DomainManagerSelectValidation.prototype.selectValidation=function(e){var s=this;this.domainmanager.domainfields.find(function(e){return e.id==s.domainmanager.currentDomainField}).sysdomainfieldvalidation_id=e,this.close()},DomainManagerSelectValidation.prototype.close=function(){this.self.destroy()},DomainManagerSelectValidation=__decorate([core_1.Component({template:'<system-modal><system-modal-header (close)="close()"><system-label label="LBL_SELECT_VALIDATION"></system-label></system-modal-header><system-modal-content margin="none" [grow]="true"><table class="slds-table slds-table--bordered slds-table--fixed-layout slds-table--header-fixed slds-max-medium-table_stacked-horizontal"><thead><tr class="slds-text-title--caps"><th scope="col" style="width: 3rem;"></th><th scope="col"><span class="slds-th__action slds-truncate"><system-label label="LBL_NAME"></system-label></span></th><th scope="col"><span class="slds-th__action slds-truncate"><system-label label="LBL_TYPE"></system-label></span></th></tr></thead><tbody><tr *ngFor="let validation of validations" (click)="selectValidation(validation.id)"><td><system-utility-icon class="slds-p-right--xx-small" size="xx-small" [icon]="validation.scope == \'g\' ? \'world\' : \'people\'"></system-utility-icon><dictionary-manager-item-status [(ngModel)]="validation.status"></dictionary-manager-item-status></td><td>{{validation.name}}</td><td>{{validation.validation_type}}</td></tr></tbody></table></system-modal-content><system-modal-footer><button class="slds-button slds-button--neutral" (click)="close()"><system-label label="LBL_CANCEL"></system-label></button></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[domainmanager])],DomainManagerSelectValidation)}();exports.DomainManagerSelectValidation=DomainManagerSelectValidation;var DomainManagerAddValidation=function(){function DomainManagerAddValidation(e,s){this.domainmanager=e,this.modelutilities=s,this.fieldvalidation={scope:"g"}}return DomainManagerAddValidation.prototype.selectValidation=function(e){var s=this;this.domainmanager.domainfields.find(function(e){return e.id==s.domainmanager.currentDomainField}).sysdomainfieldvalidation_id=e,this.close()},DomainManagerAddValidation.prototype.add=function(){this.fieldvalidation.id=this.modelutilities.generateGuid(),this.domainmanager.domainfieldvalidations.push(this.fieldvalidation),this.selectValidation(this.fieldvalidation.id)},DomainManagerAddValidation.prototype.close=function(){this.self.destroy()},DomainManagerAddValidation=__decorate([core_1.Component({template:'<system-modal><system-modal-header (close)="close()"><system-label label="LBL_ADD_VALIDATION"></system-label></system-modal-header><system-modal-content><div class="slds-grid"><div class="slds-form-element__control slds-size--3-of-4 slds-p-right--xxx-small"><label class="slds-form-element__label"><abbr class="slds-required">*</abbr><system-label label="LBL_NAME"></system-label></label><system-input-text [(ngModel)]="fieldvalidation.name"></system-input-text></div><div class="slds-form-element__control slds-size--1-of-4 slds-p-left--xxx-small"><label class="slds-form-element__label"><abbr class="slds-required">*</abbr><system-label label="LBL_SCOPE"></system-label></label><div class="slds-select_container"><select class="slds-select" [(ngModel)]="fieldvalidation.scope"><option value="g"><system-label label="LBL_GLOBAL"></system-label></option><option value="c"><system-label label="LBL_CUSTOM"></system-label></option></select></div></div></div><div class="slds-grid"><div class="slds-large-size--1-of-2 slds-p-right--xxx-small slds-form-element__control"><label class="slds-form-element__label"><abbr class="slds-required">*</abbr><system-label label="LBL_TYPE"></system-label></label><div class="slds-select_container"><select class="slds-select" [(ngModel)]="fieldvalidation.validation_type"><option value="enum">enum</option><option value="range">range</option></select></div></div><div class="slds-size--1-of-4 slds-p-right--xxx-small slds-form-element__control"><label class="slds-form-element__label"><system-label label="LBL_PACKAGE"></system-label></label><system-input-text [(ngModel)]="fieldvalidation.package"></system-input-text></div><div class="slds-size--1-of-4 slds-p-left--xxx-small slds-form-element__control"><label class="slds-form-element__label"><system-label label="LBL_VERSION"></system-label></label><system-input-text [(ngModel)]="fieldvalidation.version"></system-input-text></div></div><label class="slds-form-element__label"><system-label label="LBL_COMMENT"></system-label></label><system-richtext-editor [(ngModel)]="fieldvalidation.description"></system-richtext-editor></system-modal-content><system-modal-footer><button class="slds-button slds-button--neutral" (click)="close()"><system-label label="LBL_CANCEL"></system-label></button> <button class="slds-button slds-button--neutral" (click)="add()"><system-label label="LBL_ADD"></system-label></button></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[domainmanager,services_1.modelutilities])],DomainManagerAddValidation)}();exports.DomainManagerAddValidation=DomainManagerAddValidation;var DomainManagerAddValidationValueModal=function(){function DomainManagerAddValidationValueModal(e,s){this.domainmanager=e,this.modelutilities=s,this.fieldvalidationvalue={scope:"g",sysdomainfieldvalidation_id:null,sequence:0,deleted:0,status:"d"}}return DomainManagerAddValidationValueModal.prototype.add=function(){this.fieldvalidationvalue.id=this.modelutilities.generateGuid(),this.domainmanager.domainfieldvalidationvalues.push(this.fieldvalidationvalue),this.close()},DomainManagerAddValidationValueModal.prototype.close=function(){this.self.destroy()},DomainManagerAddValidationValueModal=__decorate([core_1.Component({template:'<system-modal><system-modal-header (close)="close()"><system-label label="LBL_ADD_VALIDATION"></system-label></system-modal-header><system-modal-content><div class="slds-grid"><div class="slds-form-element__control slds-size--1-of-4 slds-p-right--xxx-small"><label class="slds-form-element__label"><system-label label="LBL_VALUE"></system-label></label><system-input-text [(ngModel)]="fieldvalidationvalue.enumvalue"></system-input-text></div><div class="slds-form-element__control slds-size--1-of-4 slds-p-right--xxx-small"><label class="slds-form-element__label"><system-label label="LBL_MIN"></system-label></label><system-input-text [(ngModel)]="fieldvalidationvalue.minvalue"></system-input-text></div><div class="slds-form-element__control slds-size--1-of-4 slds-p-right--xxx-small"><label class="slds-form-element__label"><system-label label="LBL_MAX"></system-label></label><system-input-text [(ngModel)]="fieldvalidationvalue.maxvalue"></system-input-text></div><div class="slds-form-element__control slds-size--1-of-4 slds-p-left--xxx-small"><label class="slds-form-element__label"><abbr class="slds-required">*</abbr><system-label label="LBL_SCOPE"></system-label></label><div class="slds-select_container"><select class="slds-select" [(ngModel)]="fieldvalidationvalue.scope"><option value="g"><system-label label="LBL_GLOBAL"></system-label></option><option value="c"><system-label label="LBL_CUSTOM"></system-label></option></select></div></div></div><div class="slds-grid"><div class="slds-size--1-of-4 slds-p-right--xxx-small slds-form-element__control"><label class="slds-form-element__label"><system-label label="LBL_PACKAGE"></system-label></label><system-input-text [(ngModel)]="fieldvalidationvalue.package"></system-input-text></div><div class="slds-size--1-of-4 slds-p-left--xxx-small slds-form-element__control"><label class="slds-form-element__label"><system-label label="LBL_VERSION"></system-label></label><system-input-text [(ngModel)]="fieldvalidationvalue.version"></system-input-text></div></div><label class="slds-form-element__label"><system-label label="LBL_COMMENT"></system-label></label><system-richtext-editor [(ngModel)]="fieldvalidationvalue.description"></system-richtext-editor></system-modal-content><system-modal-footer><button class="slds-button slds-button--neutral" (click)="close()"><system-label label="LBL_CANCEL"></system-label></button> <button class="slds-button slds-button--neutral" (click)="add()"><system-label label="LBL_ADD"></system-label></button></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[domainmanager,services_1.modelutilities])],DomainManagerAddValidationValueModal)}();exports.DomainManagerAddValidationValueModal=DomainManagerAddValidationValueModal;var FieldsetManager=function(){function FieldsetManager(e,s,t,l,i,a,o,n,d,r){var c=this;this.backend=e,this.metadata=s,this.language=t,this.modelutilities=l,this.broadcast=i,this.toast=a,this.modalservice=o,this.configurationService=n,this.view=d,this.modal=r,this.edit_mode="custom",this.allowBarButtons=!0,this.crNoneActive=!1,this.change_request_required=!1,this.sysModules=[],this.currentModule="*",this.currentFieldSet="",this.currentFieldSetItems=[],this.selectedItem={type:"",fieldset:"",id:"",isViewMode:!1},this.showFieldSetDetails=!1,this.backend.getRequest("system/spiceui/admin/modules").subscribe(function(e){c.sysModules=e}),this.checkMode()}return Object.defineProperty(FieldsetManager.prototype,"currentFieldSetName",{get:function(){return this.metadata.getFieldset(this.currentFieldSet).name},set:function(e){this.metadata.setFieldset(this.currentFieldSet,{name:e,package:this.currentFieldSetPackage})},enumerable:!1,configurable:!0}),Object.defineProperty(FieldsetManager.prototype,"currentFieldSetPackage",{get:function(){return this.metadata.getFieldset(this.currentFieldSet).package},set:function(e){this.metadata.setFieldset(this.currentFieldSet,{name:this.currentFieldSetName,package:e})},enumerable:!1,configurable:!0}),Object.defineProperty(FieldsetManager.prototype,"showDetailIcon",{get:function(){return this.showFieldSetDetails?"chevronup":"chevrondown"},enumerable:!1,configurable:!0}),FieldsetManager.prototype.toggleDetail=function(){this.showFieldSetDetails=!this.showFieldSetDetails},Object.defineProperty(FieldsetManager.prototype,"fieldSetType",{get:function(){return this.currentFieldSet?this.metadata.getFieldset(this.currentFieldSet).type:""},enumerable:!1,configurable:!0}),FieldsetManager.prototype.getFieldSets=function(e){if(void 0===e&&(e=void 0),e){for(var s=[],t=0,l=this.metadata.getFieldSets(this.currentModule);t<l.length;t++){var i=l[t];i.type==e&&s.push(i)}return s}return this.metadata.getFieldSets(this.currentModule)},FieldsetManager.prototype.checkMode=function(){var s=this;this.edit_mode=this.configurationService.getCapabilityConfig("core").edit_mode,this.change_request_required=!!this.configurationService.getCapabilityConfig("systemdeployment").change_request_required,"none"!=this.edit_mode&&"custom"!=this.edit_mode&&"all"!=this.edit_mode&&(this.edit_mode="custom"),this.change_request_required?this.backend.getRequest("module/SystemDeploymentCRs/active").subscribe(function(e){""==e.id?(s.setNoneMode(),s.crNoneActive=!0,s.toast.sendToast(s.language.getLabel("LBL_ACTIVATE_CR_WARNING"),"warning",null,3)):(s.crNoneActive=!1,"all"==s.edit_mode?s.setAllMode():"custom"==s.edit_mode?s.setCustomMode():s.setNoneMode())}):(this.crNoneActive=!1,"all"==this.edit_mode?this.setAllMode():"custom"==this.edit_mode?this.setCustomMode():this.setNoneMode())},FieldsetManager.prototype.setNoneMode=function(){this.view.setViewMode(),this.allowBarButtons=!1},FieldsetManager.prototype.setCustomMode=function(){"custom"==this.fieldSetType?this.view.setEditMode():this.view.setViewMode()},FieldsetManager.prototype.setAllMode=function(){this.view.setEditMode()},FieldsetManager.prototype.loadCurrentFieldset=function(){this.selectedItem={type:"",fieldset:"",id:""},this.checkMode(),this.currentFieldSetItems=[],this.addFieldSetItems(this.currentFieldSet,0,this.fieldSetType)},FieldsetManager.prototype.addItem=function(s){var t=this;void 0===s&&(s=""),this.modalservice.openModal("FieldsetManagerAddDialog").subscribe(function(e){e.instance.metadata=t.metadata,e.instance.module=t.currentModule,e.instance.fieldsettype=t.fieldSetType,e.instance.edit_mode=t.edit_mode,e.instance.parent=s||t.currentFieldSet,e.instance.closedialog.subscribe(function(e){e&&t.loadCurrentFieldset()})})},FieldsetManager.prototype.unlinkItem=function(e){this.metadata.removeFieldsetItem(e.fieldset,e.item)&&(this.selectedItem={type:"",fieldset:"",id:""},this.loadCurrentFieldset())},FieldsetManager.prototype.editFieldset=function(){var t=this;this.modalservice.openModal("FieldsetManagerEditDialog").subscribe(function(e){e.instance.fieldset=t.currentFieldSet,e.instance.edit_mode=t.edit_mode,e.instance.closedialog.subscribe(function(e){if(!1!==e){if(""!=t.currentFieldSet)t.metadata.setFieldset(t.currentFieldSet,{name:e.name,type:e.type});else{var s=t.modelutilities.generateGuid();t.metadata.addFieldset(s,t.currentModule,e.name,e.type),t.currentFieldSet=s}t.checkMode()}})})},FieldsetManager.prototype.addFieldset=function(){this.currentFieldSet="",this.currentFieldSetItems=[],this.editFieldset()},FieldsetManager.prototype.reset=function(){this.currentFieldSet="",this.currentFieldSetItems=[],this.selectedItem={type:"",fieldset:"",id:""}},FieldsetManager.prototype.addFieldSetItems=function(o,n,d){var r=this;void 0===n&&(n=0),void 0===d&&(d="global");var c=this.metadata.getFieldSetItems(o);c.forEach(function(e,s){var t=!1;if("custom"!=r.edit_mode||r.crNoneActive?"none"!=r.edit_mode&&!r.crNoneActive||(t=!0):"global"==d&&(t=!0),e.field){var l={level:n+1,type:"field",fieldset:o,id:e.id,name:e.field,index:s,count:c.length,item:e,parentScope:d,customModeGlobalField:t};r.currentFieldSetItems.push(l)}else if(e.fieldset){var i=!1;if("custom"!=r.edit_mode||r.crNoneActive)"none"!=r.edit_mode&&!r.crNoneActive||(i=!0);else{var a=r.metadata.getFieldset(e.fieldset);a&&"global"==a.type&&(i=!0)}l={level:n+1,type:"fieldset",fieldset:o,id:e.id,name:r.metadata.getFieldsetName(e.fieldset),index:s,count:c.length,item:e,parentScope:d,customModeGlobalField:i};r.currentFieldSetItems.push(l),r.addFieldSetItems(e.fieldset,n+1,r.getDisplayType(l))}})},FieldsetManager.prototype.getDisplayName=function(e){return"field"==e.type?e.item.field:"fieldset"==e.type?this.metadata.getFieldsetName(e.item.fieldset):void 0},FieldsetManager.prototype.getDisplayType=function(e){if("fieldset"==e.type){var s=this.metadata.getFieldset(e.item.fieldset);if(s)return s.type}},FieldsetManager.prototype.isSelected=function(e){return e==this.selectedItem.id},FieldsetManager.prototype.selectItem=function(e,s){this.selectedItem={type:e.type,fieldset:e.fieldset,id:e.id,isViewMode:e.customModeGlobalField}},FieldsetManager.prototype.moveDown=function(t){var e=this.metadata.getFieldSetItems(t.fieldset),l=0;if(e.some(function(e,s){if(e.id==t.id)return l=s,!0}),l<e.length-1){var s=e.splice(l,1);e.splice(l+1,0,s[0]);for(var i=0,a=0,o=e;a<o.length;a++){o[a].sequence=i,i++}this.loadCurrentFieldset()}},FieldsetManager.prototype.moveUp=function(t){var e=this.metadata.getFieldSetItems(t.fieldset),l=0;if(e.some(function(e,s){if(e.id==t.id)return l=s,!0}),0<l){var s=e.splice(l,1);e.splice(l-1,0,s[0]);for(var i=0,a=0,o=e;a<o.length;a++){o[a].sequence=i,i++}this.loadCurrentFieldset()}},FieldsetManager.prototype.allowEdit=function(){return""!=this.currentFieldSet},FieldsetManager.prototype.findTable=function(e){return"global"==e?{fieldsetTable:"sysuifieldsets",itemsTable:"sysuifieldsetsitems"}:{fieldsetTable:"sysuicustomfieldsets",itemsTable:"sysuicustomfieldsetsitems"}},FieldsetManager.prototype.copy=function(s,p){var b=this;void 0===s&&(s=this.currentFieldSet),void 0===p&&(p=null),this.modalservice.openModal("FieldsetManagerCopyDialog").subscribe(function(e){e.instance.fieldset=s,e.instance.sysModules=b.sysModules,e.instance.metaFieldSets=b.metadata.getAllFieldsets(),e.instance.edit_mode=b.edit_mode,e.instance.closedialog.subscribe(function(s){b.modal.openModal("SystemLoadingModal").subscribe(function(d){var r=__assign({},s.fieldset),c=s.module,m=s.type,u=s.name;"*"==c&&(c="global");var e={module:c,type:m,name:u};b.backend.getRequest("configuration/spiceui/core/fieldsetalreadyexists",e).subscribe(function(e){if(0==e){var a=b.findTable(m);"global"==(r.module=c)&&(r.module="*"),r.name=u;var s=b.modelutilities.generateGuid();r.id=s;for(var o=[],t=0,l=r.items;t<l.length;t++){var i=l[t],n=__assign({},i);n.fieldconfig=__assign({},i.fieldconfig),n.id=b.modelutilities.generateGuid(),n.fieldset_id=s,o.push(n)}delete r.items,delete r.type,delete r.fid,b.backend.postRequest("configuration/configurator/"+a.fieldsetTable+"/"+r.id,null,{config:r}).subscribe(function(e){var l=0;r.items=o,r.type=m;for(var s=function(t){b.backend.postRequest("configuration/configurator/"+a.itemsTable+"/"+t.id,null,{config:t}).subscribe(function(e){if(++l==o.length)if(p){p.item.fieldset=r.id;var s=b.findTable(p.parentScope);b.backend.postRequest("configuration/configurator/"+s.itemsTable+"/"+p.id,null,{config:p.item}).subscribe(function(e){d.instance.self.destroy(),b.toast.sendToast("saved!"),b.metadata.addFieldset(r.id,r.module,r.name,m,o)},function(e){d.instance.self.destroy(),b.toast.sendAlert("saving link failed!, "+t.id),console.error(e)})}else d.instance.self.destroy(),b.toast.sendToast("saved!"),b.currentModule=r.module,b.metadata.addFieldset(r.id,r.module,r.name,m,o),b.currentFieldSet=r.id,b.currentFieldSetItems=o,b.selectedItem={},b.currentFieldSetName=r.name,b.loadCurrentFieldset()},function(e){d.instance.self.destroy(),b.toast.sendAlert("saving failed!, "+t.id),console.error(e)})},t=0,i=o;t<i.length;t++){s(i[t])}},function(e){d.instance.self.destroy(),b.toast.sendAlert("saving failed!"),console.error(e)})}else d.instance.self.destroy(),b.toast.sendAlert("Fieldset already exists!")})})})})},FieldsetManager.prototype.saveChanges=function(){var n=this;this.modal.openModal("SystemLoadingModal").subscribe(function(o){n.backend.getRequest("configuration/spiceui/core/fieldsets").subscribe(function(e){var s=n.metadata.getRawFieldSets(),t={},l={};for(var i in s)e.fieldsets[i]?(JSON.stringify(s[i])!==JSON.stringify(e.fieldsets[i])&&(l[i]=s[i]),delete e.fieldsets[i]):t[i]=s[i];var a={add:t,update:l,delete:e.fieldsets};n.backend.postRequest("configuration/spiceui/core/fieldsets",{},a).subscribe(function(e){n.broadcast.broadcastMessage("metadata.updatefieldsets",a),o.instance.self.destroy(),n.toast.sendToast("changes saved")})})})},Object.defineProperty(FieldsetManager.prototype,"getAllowCopyButton",{get:function(){return!!this.currentFieldSet&&this.allowBarButtons},enumerable:!1,configurable:!0}),FieldsetManager=__decorate([core_1.Component({template:'<workbench-header titlelabel="LBL_FIELDSET_MANAGER"></workbench-header><div class="slds-p-around--small slds-border--bottom"><div class="slds-grid slds-grid--vertical-align-center slds-form--inline"><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_MODULE"></system-label></label><div class="slds-form-element__control" style="min-width:250px;"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="currentModule" (change)="reset()" [disabled]="sysModules.length == 0"><option value="*">*</option><option *ngFor="let sysModule of sysModules" [value]="sysModule.module">{{sysModule.module}}</option></select></div></div></div><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_FIELDSET"></system-label></label><div class="slds-form-element__control" style="min-width:250px;"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="currentFieldSet" (change)="loadCurrentFieldset()" [disabled]="getFieldSets().length == 0"><option></option><optgroup [label]="\'custom\' + language.getLabel(\'LBL_FIELDSET\')" *ngIf="getFieldSets(\'custom\').length > 0"><option *ngFor="let sysFieldset of getFieldSets(\'custom\')" [value]="sysFieldset.id">{{sysFieldset.name}}</option></optgroup><optgroup [label]="\'global\' + language.getLabel(\'LBL_FIELDSET\')" *ngIf="getFieldSets(\'global\').length > 0"><option *ngFor="let sysFieldset of getFieldSets(\'global\')" [value]="sysFieldset.id">{{sysFieldset.name}}</option></optgroup></select></div></div></div><div class="slds-form-element slds-col--bump-left"><button [disabled]="!allowBarButtons" class="slds-button slds-button--brand" (click)="copy()"><span><system-label label="LBL_COPY"></system-label></span></button> <button [disabled]="!allowBarButtons" type="button" class="slds-button slds-button_icon slds-button_icon-border-filled" (click)="addFieldset()"><system-utility-icon [icon]="\'add\'" [size]="\'x-small\'"></system-utility-icon></button></div></div></div><div *ngIf="currentFieldSet" class="slds-theme--default"><div class="slds-p-around--small slds-border--bottom slds-theme--default"><div class="slds-grid slds-grid--vertical-align-end"><div class="slds-form-element slds-p-right--x-small slds-size--1-of-4"><label class="slds-form-element__label"><system-label label="LBL_SCOPE"></system-label></label><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_left"><system-custom-icon [icon]="fieldSetType" size="x-small" addclasses="slds-input__icon slds-input__icon_left"></system-custom-icon><input type="text" disabled class="slds-input" [ngModel]="fieldSetType"></div></div><div class="slds-form-element slds-p-right--x-small slds-size--1-of-4"><label class="slds-form-element__label"><system-label label="LBL_NAME"></system-label></label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [(ngModel)]="currentFieldSetName"></div></div><div class="slds-form-element slds-p-right--x-small slds-size--1-of-4"><label class="slds-form-element__label"><system-label label="LBL_PACKAGE"></system-label></label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [(ngModel)]="currentFieldSetPackage"></div></div><div class="slds-form-element slds-p-right--x-small slds-size--1-of-4"><label class="slds-form-element__label"><system-label label="LBL_ID"></system-label></label><div class="slds-form-element__control"><input type="text" disabled class="slds-input" [ngModel]="currentFieldSet"></div></div></div></div><div class="slds-grid"><div class="slds-size--3-of-5 slds-p-horizontal--small slds-p-top--x-small slds-border--right"><div class="slds-tree_container" role="application" style="max-width: none;"><ul class="slds-tree" role="tree" aria-labelledby="treeheading"><li *ngFor="let currentFieldSetItem of currentFieldSetItems" role="treeitem" [attr.aria-level]="currentFieldSetItem.level" (click)="selectItem(currentFieldSetItem, getDisplayType(currentFieldSetItem))" [ngClass]="{\'slds-theme--shade\' : isSelected(currentFieldSetItem.id)}"><div class="slds-tree__item slds-grid slds-grid--vertical-align-center"><system-custom-icon *ngIf="getDisplayType(currentFieldSetItem) != \'\'" [icon]="getDisplayType(currentFieldSetItem)" size="x-small"></system-custom-icon><div style="white-space:nowrap;"><a href="javascript:void(0);" role="presentation" class="slds-truncate">{{getDisplayName(currentFieldSetItem)}}</a></div><div class="slds-col_bump-left"><button [disabled]="!view.isEditMode() || currentFieldSetItem.type == \'field\' || currentFieldSetItem.customModeGlobalField" class="slds-button slds-button--icon" title="add item" (click)="addItem(currentFieldSetItem.item.fieldset)"><system-button-icon [icon]="\'new\'"></system-button-icon></button> <button [disabled]="!view.isEditMode() || currentFieldSetItem.type == \'field\'" class="slds-button slds-button--icon" title="customize" (click)="copy(currentFieldSetItem.item.fieldset, currentFieldSetItem)"><system-button-icon [icon]="\'copy\'"></system-button-icon></button> <button [disabled]="!view.isEditMode() || currentFieldSetItem.customModeGlobalField" class="slds-button slds-button--icon || customModeGlobalField" title="unlink item" (click)="unlinkItem(currentFieldSetItem)"><system-button-icon [icon]="\'remove_link\'"></system-button-icon></button> <button [disabled]="!view.isEditMode() || currentFieldSetItem.index + 1 == currentFieldSetItem.count || currentFieldSetItem.customModeGlobalField" class="slds-button slds-button--icon" title="move down" (click)="moveDown(currentFieldSetItem)"><system-button-icon [icon]="\'down\'"></system-button-icon></button> <button [disabled]="!view.isEditMode() || currentFieldSetItem.index == 0 || currentFieldSetItem.customModeGlobalField" class="slds-button slds-button--icon" title="move up" (click)="moveUp(currentFieldSetItem)"><system-button-icon [icon]="\'up\'"></system-button-icon></button></div></div></li></ul></div><div class="slds-p-around--small slds-align--absolute-center slds-border--top slds-m-top--small"><button [disabled]="!view.isEditMode()" class="slds-button slds-button--icon" title="add item" (click)="addItem()"><system-button-icon [icon]="\'new\'"></system-button-icon></button></div></div><div class="slds-size--2-of-5 slds-p-horizontal--small slds-p-vertical--x-small"><fieldsetmanager-fieldset-details *ngIf="selectedItem.type == \'fieldset\'" [fieldset]="selectedItem"></fieldsetmanager-fieldset-details><fieldsetmanager-field-details *ngIf="selectedItem.type == \'field\'" [field]="selectedItem"></fieldsetmanager-field-details></div></div><div class="slds-text-align--right slds-p-around--small slds-border--top"><button [disabled]="!view.isEditMode()" type="button" class="slds-button slds-button--brand" (click)="saveChanges()"><system-label label="LBL_SAVE"></system-label></button></div></div>',providers:[services_1.view]}),__metadata("design:paramtypes",[services_1.backend,services_1.metadata,services_1.language,services_1.modelutilities,services_1.broadcast,services_1.toast,services_1.modal,services_1.configurationService,services_1.view,services_1.modal])],FieldsetManager)}();exports.FieldsetManager=FieldsetManager;var FieldsetManagerFieldsetDetails=function(){function e(e,s,t,l){this.backend=e,this.metadata=s,this.language=t,this.view=l,this.fieldset={},this.currentFieldSet={},this.currentFieldSetConfig={}}return e.prototype.ngOnChanges=function(e){var s=this;this.fieldset.isViewMode?this.view.setViewMode():this.view.setEditMode();try{this.metadata.getFieldSetItems(this.fieldset.fieldset).some(function(e){if(e.id==s.fieldset.id)return s.currentFieldSet=s.metadata.getFieldset(e.fieldset),s.currentFieldSetConfig=e.fieldconfig,!0})}catch(e){this.currentFieldSet={}}},Object.defineProperty(e.prototype,"fieldsetname",{get:function(){var s=this;try{var t;return this.metadata.getFieldSetItems(this.fieldset.fieldset).some(function(e){if(e.id==s.fieldset.id)return t=e,!0}),this.metadata.getFieldsetName(t.fieldset)}catch(e){return""}},set:function(e){},enumerable:!1,configurable:!0}),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"fieldset",void 0),e=__decorate([core_1.Component({selector:"fieldsetmanager-fieldset-details",template:'<div class="slds-form-element slds-m-bottom--x-small"><label class="slds-form-element__label"><system-label label="LBL_NAME"></system-label></label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [(ngModel)]="currentFieldSet.name"></div></div><div class="slds-form-element slds-m-bottom--x-small"><label class="slds-form-element__label">ID of Parent Fieldset</label><div class="slds-form-element__control"><input type="text" class="slds-input" [ngModel]="fieldset.fieldset" disabled></div></div><div class="slds-form-element slds-m-bottom--x-small"><label class="slds-form-element__label">ID of Parent Fieldset Element</label><div class="slds-form-element__control"><input type="text" class="slds-input" [ngModel]="fieldset.id" disabled></div></div><div class="slds-form-element slds-m-bottom--x-small"><label class="slds-form-element__label">ID of Fieldset</label><div class="slds-form-element__control"><input type="text" class="slds-input" [ngModel]="currentFieldSet.fid" disabled></div></div><div class="slds-form-element slds-m-vertical--x-small"><label class="slds-form-element__label"><system-label label="LBL_PACKAGE"></system-label></label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [(ngModel)]="currentFieldSet.package"></div></div><div class="slds-form-element slds-m-vertical--x-small"><label class="slds-form-element__label"><system-label label="LBL_FORMCLASS"></system-label></label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [(ngModel)]="currentFieldSetConfig.formclass"></div></div><div class="slds-form-element slds-m-vertical--x-small"><span class="slds-checkbox"><input [disabled]="!view.isEditMode()" name="options" id="cbDirection" value="vertical" type="checkbox" [checked]="currentFieldSetConfig.direction === \'vertical\'" (change)="currentFieldSetConfig.direction = currentFieldSetConfig.direction === \'vertical\' ? null : \'vertical\'"> <label class="slds-checkbox__label" for="cbDirection"><span class="slds-checkbox_faux"></span> <span class="slds-form-element__label"><system-label label="LBL_VERTICAL"></system-label></span></label></span></div><div class="slds-form-element slds-m-top--x-small"><label class="slds-form-element__label"><system-label label="LBL_WIDTH"></system-label> (number of parts, leave blank for 1)</label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [(ngModel)]="currentFieldSetConfig.width"></div></div>',providers:[services_1.view]}),__metadata("design:paramtypes",[services_1.backend,services_1.metadata,services_1.language,services_1.view])],e)}();exports.FieldsetManagerFieldsetDetails=FieldsetManagerFieldsetDetails;var FieldsetManagerFieldDetails=function(){function e(e,s,t,l){this.backend=e,this.metadata=s,this.language=t,this.view=l,this.field={},this.currentField={},this.fieldtypes=[],this.component="",this.configValues={},this.fieldtypes=this.metadata.getFieldTypes(),this.fieldtypes.sort(),this.fieldtypes.unshift("")}return e.prototype.ngOnChanges=function(e){var s=this;this.field.isViewMode?this.view.setViewMode():this.view.setEditMode();try{this.metadata.getFieldSetItems(this.field.fieldset).some(function(e){if(e.id==s.field.id)return s.currentField=e,s.component=s.metadata.getFieldTypeComponent(e.fieldconfig.fieldtype),s.configValues=e.fieldconfig,!0})}catch(e){this.currentField={}}},Object.defineProperty(e.prototype,"configValuesLabel",{get:function(){var e=null;return"label"in this.configValues&&null!=this.configValues.label&&(e={name:this.configValues.label}),e},set:function(e){this.configValues.label=null!=e?e.name:null},enumerable:!1,configurable:!0}),e.prototype.configValuesLabelEmit=function(e){this.configValuesLabel=e},Object.defineProperty(e.prototype,"InputConfig",{get:function(){return{option:"name",type:"label",description:""}},enumerable:!1,configurable:!0}),e.prototype.getFieldConfig=function(){if(this.configValues.fieldtype){var e=this.metadata.getFieldTypeComponent(this.configValues.fieldtype),s=this.metadata.getComponentConfigOptions(e),t=[];for(var l in s)t.push(l);return t}return[]},e.prototype.selectFieldType=function(){this.component=this.metadata.getFieldTypeComponent(this.configValues.fieldtype)},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"field",void 0),e=__decorate([core_1.Component({selector:"fieldsetmanager-field-details",template:'<div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label"><system-label label="LBL_NAME"></system-label></label><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" placeholder="name" [(ngModel)]="currentField.field"></div></div><div class="slds-form-element slds-m-bottom--x-small"><label class="slds-form-element__label">ID</label><div class="slds-form-element__control"><input type="text" class="slds-input" [ngModel]="currentField.id" disabled></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label"><system-label label="LBL_PACKAGE"></system-label></label><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" placeholder="package" [(ngModel)]="currentField.package"></div></div><div class="slds-form-element slds-m-vertical--xx-small"><label class="slds-form-element__label"><system-label label="LBL_LABEL"></system-label></label><system-input-label *ngIf="view.isEditMode()" [(ngModel)]="configValues.label"></system-input-label><input class="slds-input" disabled *ngIf="!view.isEditMode()" [(ngModel)]="configValues.label"></div><fieldset class="slds-form-element slds-m-vertical--xxx-small"><legend class="slds-form-element__legend slds-form-element__label"><system-label label="LBL_OPTIONS"></system-label></legend><div class="slds-form-element__control"><label class="slds-checkbox" for="link"><input [disabled]="!view.isEditMode()" type="checkbox" id="link" [(ngModel)]="configValues.link"> <span class="slds-checkbox--faux"></span> <span class="slds-form-element__label"><system-label label="LBL_LINK"></system-label></span></label> <label class="slds-checkbox" for="default"><input [disabled]="!view.isEditMode()" type="checkbox" id="default" [(ngModel)]="configValues.default"> <span class="slds-checkbox--faux"></span> <span class="slds-form-element__label"><system-label label="LBL_DEFAULT"></system-label></span></label> <label class="slds-checkbox" for="hidelabel"><input [disabled]="!view.isEditMode()" type="checkbox" id="hidelabel" [(ngModel)]="configValues.hidelabel"> <span class="slds-checkbox--faux"></span> <span class="slds-form-element__label"><system-label label="LBL_HIDE_LABEL"></system-label></span></label> <label class="slds-checkbox" for="readonly"><input [disabled]="!view.isEditMode()" type="checkbox" id="readonly" [(ngModel)]="configValues.readonly"> <span class="slds-checkbox--faux"></span> <span class="slds-form-element__label"><system-label label="LBL_READONLY"></system-label></span></label> <label class="slds-checkbox" for="sortable"><input [disabled]="!view.isEditMode()" type="checkbox" id="sortable" [(ngModel)]="configValues.sortable"> <span class="slds-checkbox--faux"></span> <span class="slds-form-element__label"><system-label label="LBL_SORTABLE"></system-label></span></label></div></fieldset><div *ngIf="configValues.sortable" class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label"><system-label label="LBL_SORTFIELD"></system-label></label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [(ngModel)]="configValues.sortfield"></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label"><system-label label="LBL_WIDTH"></system-label> (number of parts, leave blank for 1)</label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [(ngModel)]="configValues.width"></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label"><system-label label="LBL_FIELDTYPE"></system-label></label><div class="slds-form-element__control"><div class="slds-select_container"><select [disabled]="!view.isEditMode()" class="slds-select" [(ngModel)]="configValues.fieldtype" (change)="selectFieldType()"><option *ngFor="let fieldtype of fieldtypes">{{fieldtype}}</option></select></div></div></div><workbench-config [component]="component" [configValues]="configValues"></workbench-config>',providers:[services_1.view]}),__metadata("design:paramtypes",[services_1.backend,services_1.metadata,services_1.language,services_1.view])],e)}();exports.FieldsetManagerFieldDetails=FieldsetManagerFieldDetails;var FieldsetManagerAddDialog=function(){function FieldsetManagerAddDialog(e,s,t,l){this.backend=e,this.language=s,this.modelutilities=t,this.metadata=l,this.closedialog=new core_1.EventEmitter,this.module="*",this.parent="",this.edit_mode="",this.addType="fieldsetadd",this.addName="",this.addFieldset="",this.fieldsettype="custom",this.moduleFields=[]}var e;return FieldsetManagerAddDialog.prototype.ngOnInit=function(){this.module&&"*"!=this.module&&(this.moduleFields=this.metadata.getModuleFields(this.module))},FieldsetManagerAddDialog.prototype.closeDialog=function(){this.self.destroy()},FieldsetManagerAddDialog.prototype.onModalEscX=function(){this.closeDialog()},FieldsetManagerAddDialog.prototype.add=function(){switch(this.addType){case"fieldsetadd":var e=this.modelutilities.generateGuid();this.metadata.addFieldset(e,this.module,this.addName,this.fieldsettype),this.metadata.addFieldsetToFieldset(this.modelutilities.generateGuid(),this.parent,e);break;case"fieldsetselect":this.metadata.addFieldsetToFieldset(this.modelutilities.generateGuid(),this.parent,this.addFieldset);break;case"field":this.modelutilities.generateGuid();this.metadata.addFieldToFieldset(this.modelutilities.generateGuid(),this.parent,this.addName)}this.closedialog.emit(!0),this.self.destroy()},FieldsetManagerAddDialog.prototype.getFieldNames=function(){var e=[];for(var s in this.moduleFields)e.push(s);return e.sort(),e},Object.defineProperty(FieldsetManagerAddDialog.prototype,"fieldsets",{get:function(){return this.metadata.getFieldSets()},enumerable:!1,configurable:!0}),__decorate([core_1.Output(),__metadata("design:type","function"==typeof(e=void 0!==core_1.EventEmitter&&core_1.EventEmitter)?e:Object)],FieldsetManagerAddDialog.prototype,"closedialog",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],FieldsetManagerAddDialog.prototype,"module",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],FieldsetManagerAddDialog.prototype,"parent",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],FieldsetManagerAddDialog.prototype,"edit_mode",void 0),FieldsetManagerAddDialog=__decorate([core_1.Component({selector:"fieldsetmanager-add-dialog",template:'<div role="dialog" tabindex="-1" aria-labelledby="header43" class="slds-modal slds-fade-in-open"><div class="slds-modal__container"><div class="slds-modal__header slds-theme--shade"><button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" (click)="closeDialog()"><system-button-icon [icon]="\'close\'" [size]="\'large\'"></system-button-icon></button><h2 id="header43" class="slds-text-heading--medium"><system-label label="LBL_ADD_ITEM"></system-label></h2></div><div class="slds-modal__content slds-p-around--medium"><div class="slds-grid slds-col--bump-left"><span class="slds-radio"><input type="radio" name="addType" value="fieldsetadd" id="fieldsetaddradio" [(ngModel)]="addType"> <label class="slds-radio__label" for="fieldsetaddradio"><span class="slds-radio_faux"></span> <span class="slds-form-element__label"><system-label label="LBL_ADD_FIELDSET"></system-label></span></label></span> <span class="slds-radio"><input type="radio" name="addType" value="fieldsetselect" id="fieldsetselectradio" [(ngModel)]="addType"> <label class="slds-radio__label" for="fieldsetselectradio"><span class="slds-radio_faux"></span> <span class="slds-form-element__label"><system-label label="LBL_SELECT_FIELDSET"></system-label></span></label></span> <span class="slds-radio"><input type="radio" name="addType" value="field" id="fieldradio" [(ngModel)]="addType"> <label class="slds-radio__label" for="fieldradio"><span class="slds-radio_faux"></span> <span class="slds-form-element__label"><system-label label="LBL_FIELD"></system-label></span></label></span></div><div *ngIf="addType==\'field\'" class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_FIELDNAME"></system-label></label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="addName"><option *ngFor="let fieldname of getFieldNames()">{{fieldname}}</option></select></div></div><div class="slds-form-element slds-m-top--small"><label class="slds-form-element__label"><system-label label="LBL_ITEM_NAME"></system-label></label><div class="slds-form-element__control"><input type="text" class="slds-input" placeholder="name" [(ngModel)]="addName"></div></div></div><div *ngIf="addType==\'fieldsetadd\'" class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_SCOPE"></system-label></label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="fieldsettype"><option *ngIf="edit_mode == \'all\'" value="global"><system-label label="LBL_GLOBAL"></system-label></option><option value="custom"><system-label label="LBL_CUSTOM"></system-label></option></select></div></div><div class="slds-form-element slds-m-top--small"><label class="slds-form-element__label"><system-label label="LBL_ITEM_NAME"></system-label></label><div class="slds-form-element__control"><input type="text" class="slds-input" placeholder="name" [(ngModel)]="addName"></div></div></div><div *ngIf="addType==\'fieldsetselect\'" class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_FIELDSET"></system-label></label><div class="slds-form-element__control"><system-input-fieldset [(ngModel)]="addFieldset"></system-input-fieldset></div></div></div><div class="slds-modal__footer"><button class="slds-button slds-button--neutral" (click)="closeDialog()"><system-label label="LBL_CANCEL"></system-label></button> <button class="slds-button slds-button--brand" (click)="add()"><system-label label="LBL_ADD"></system-label></button></div></div></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.language,services_1.modelutilities,services_1.metadata])],FieldsetManagerAddDialog)}();exports.FieldsetManagerAddDialog=FieldsetManagerAddDialog;var FieldsetManagerEditDialog=function(){function FieldsetManagerEditDialog(e,s,t,l,i){this.backend=e,this.metadata=s,this.language=t,this.modelutilities=l,this.configurationService=i,this.fieldset="",this.edit_mode="",this.closedialog=new core_1.EventEmitter,this.fieldsetname="",this.fieldsettype="",this.adding=!1,this.globalEdit=!1,this.modalTitle="",this.modalTitle=this.language.getAppLanglabel("LBL_EDIT")}var e;return FieldsetManagerEditDialog.prototype.ngOnInit=function(){this.fieldset?(this.fieldsetname=this.metadata.getFieldsetName(this.fieldset),this.fieldsettype=this.metadata.getFieldset(this.fieldset).type,this.adding=!1):(this.modalTitle=this.language.getAppLanglabel("LBL_ADD"),this.fieldsettype="custom",this.adding=!0)},FieldsetManagerEditDialog.prototype.closeDialog=function(){this.self.destroy()},FieldsetManagerEditDialog.prototype.onModalEscX=function(){this.closeDialog()},FieldsetManagerEditDialog.prototype.add=function(){this.closedialog.emit({name:this.fieldsetname,type:this.fieldsettype}),this.self.destroy()},__decorate([core_1.Input(),__metadata("design:type",String)],FieldsetManagerEditDialog.prototype,"fieldset",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],FieldsetManagerEditDialog.prototype,"edit_mode",void 0),__decorate([core_1.Output(),__metadata("design:type","function"==typeof(e=void 0!==core_1.EventEmitter&&core_1.EventEmitter)?e:Object)],FieldsetManagerEditDialog.prototype,"closedialog",void 0),FieldsetManagerEditDialog=__decorate([core_1.Component({selector:"fieldsetmanager-edit-dialog",template:'<div role="dialog" tabindex="-1" aria-labelledby="header43" class="slds-modal slds-fade-in-open"><div class="slds-modal__container"><div class="slds-modal__header slds-theme--shade"><button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" (click)="closeDialog()"><system-button-icon [icon]="\'close\'" [size]="\'large\'"></system-button-icon></button><h2 id="header43" class="slds-text-heading--medium">{{modalTitle}}</h2></div><div class="slds-modal__content slds-p-around--medium"><div class="slds-form-element slds-m-top--small"><label class="slds-form-element__label"><system-label label="LBL_ITEM_NAME"></system-label></label><div class="slds-form-element__control"><input type="text" class="slds-input" placeholder="name" [(ngModel)]="fieldsetname"></div></div><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_TYPE"></system-label></label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="fieldsettype" [disabled]="!adding"><option value="global" *ngIf="edit_mode == \'all\'"><system-label label="LBL_GLOBAL"></system-label></option><option value="custom"><system-label label="LBL_CUSTOM"></system-label></option></select></div></div></div></div><div class="slds-modal__footer"><button class="slds-button slds-button--neutral" (click)="closeDialog()"><system-label label="LBL_CANCEL"></system-label></button> <button class="slds-button slds-button--brand" [disabled]="fieldsetname == \'\'" (click)="add()"><system-label label="LBL_SAVE"></system-label></button></div></div></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.metadata,services_1.language,services_1.modelutilities,services_1.configurationService])],FieldsetManagerEditDialog)}();exports.FieldsetManagerEditDialog=FieldsetManagerEditDialog;var ActionsetManager=function(){function ActionsetManager(e,s,t,l,i,a,o,n,d,r){var c=this;this.backend=e,this.metadata=s,this.language=t,this.modelutilities=l,this.broadcast=i,this.toast=a,this.modalservice=o,this.configurationService=n,this.view=d,this.modal=r,this.edit_mode="custom",this.allowBarButtons=!0,this.crNoneActive=!1,this.change_request_required=!1,this.sysModules=[],this.currentModule="*",this.currentActionSet={id:"",module:"",name:"",package:"",type:"",actions:[],isnew:!1},this.actionSetBackup="",this.selectedItem=null,this.selectedItemID="",this.showActionSetDetails=!1,this.backend.getRequest("system/spiceui/admin/modules").subscribe(function(e){c.sysModules=e}),this.checkMode()}return ActionsetManager.prototype.getActionSets=function(e){void 0===e&&(e=null);var s=[];if(e)for(var t=0,l=this.metadata.getActionSets(this.currentModule);t<l.length;t++){var i=l[t];i.type==e&&s.push(i)}else s=this.metadata.getActionSets(this.currentModule);return s},ActionsetManager.prototype.checkMode=function(){var s=this;this.edit_mode=this.configurationService.getCapabilityConfig("core").edit_mode,this.change_request_required=!!this.configurationService.getCapabilityConfig("systemdeployment").change_request_required,"none"!=this.edit_mode&&"custom"!=this.edit_mode&&"all"!=this.edit_mode&&(this.edit_mode="custom"),this.change_request_required?this.backend.getRequest("module/SystemDeploymentCRs/active").subscribe(function(e){""==e.id?(s.setNoneMode(),s.crNoneActive=!0,s.toast.sendToast(s.language.getLabel("LBL_ACTIVATE_CR_WARNING"),"warning",null,3)):(s.crNoneActive=!1,"all"==s.edit_mode?s.setAllMode():"custom"==s.edit_mode?s.setCustomMode():s.setNoneMode())}):(this.crNoneActive=!1,"all"==this.edit_mode?this.setAllMode():"custom"==this.edit_mode?this.setCustomMode():this.setNoneMode())},ActionsetManager.prototype.setNoneMode=function(){this.view.setViewMode(),this.allowBarButtons=!1},ActionsetManager.prototype.setCustomMode=function(){"custom"==this.currentActionSet.type?this.view.setEditMode():this.view.setViewMode()},ActionsetManager.prototype.setAllMode=function(){this.view.setEditMode()},Object.defineProperty(ActionsetManager.prototype,"checkForChanges",{get:function(){return this.checkForChangesFunction()},enumerable:!1,configurable:!0}),ActionsetManager.prototype.checkForChangesFunction=function(){return""!=this.currentActionSet.id&&JSON.stringify(this.currentActionSet)!=this.actionSetBackup},ActionsetManager.prototype.selectCurrentActionset=function(){var s=this;if(this.currentActionSet.id){var t=this.currentActionSet.id;""!=this.actionSetBackup?(this.currentActionSet.id=JSON.parse(this.actionSetBackup).id,JSON.stringify(this.actionSetBackup),this.checkForChangesFunction()?this.modal.confirm("LBL_ALL_CHANGES_WOULD_BE_DELETED.","LBL_ARE_YOU_SURE").subscribe(function(e){e&&(s.deleteChanges(),s.loadCurrentActionset(t))}):this.loadCurrentActionset(t)):this.loadCurrentActionset(t)}},ActionsetManager.prototype.loadCurrentActionset=function(e){this.selectedItem=null,this.checkMode(),this.currentActionSet=this.metadata.getActionSet(e),this.actionSetBackup=JSON.stringify(__assign({},this.currentActionSet)),this.currentActionSet&&this.currentActionSet.actions&&0<this.currentActionSet.actions.length&&this.selectItem(this.currentActionSet.actions[0])},ActionsetManager.prototype.addActionsetItem=function(){var e={action:"NEW",component:null,id:this.modelutilities.generateGuid(),sequence:this.currentActionSet.actions.length,singlebutton:!1,package:this.currentActionSet.package,version:this.currentActionSet.version,actionconfig:{},parentScope:this.currentActionSet.type};this.currentActionSet.actions.push(e),this.metadata.setActionSetItems(this.currentActionSet.id,this.currentActionSet.actions),this.selectItem(e)},ActionsetManager.prototype.deleteItem=function(s){var t=this;this.modal.confirm("LBL_ARE_YOU_SURE","LBL_REMOVE_ITEM").subscribe(function(e){e&&t.currentActionSet.actions.splice(t.currentActionSet.actions.map(function(e){return e.id}).indexOf(s.id),1)})},ActionsetManager.prototype.addActionset=function(){var t=this;this.modalservice.openModal("ActionsetManagerAddDialog").subscribe(function(e){e.instance.sysModules=t.sysModules,e.instance.actionsetModule=t.currentModule,e.instance.mode="add",e.instance.edit_mode=t.edit_mode,e.instance.actionsetName="",e.instance.closedialog.subscribe(function(e){if(e){var s=t.modelutilities.generateGuid();t.currentActionSet.actions=[],t.metadata.setActionSet(s,{module:e.module,name:e.name,type:e.type,actions:t.currentActionSet.actions}),t.reset(),t.currentModule=e.module,t.currentActionSet.id=s,t.currentActionSet.module=e.module,t.currentActionSet.name=e.name,t.currentActionSet.type=e.type,t.currentActionSet.actions=[],t.currentActionSet.package="",t.currentActionSet.isnew=!0}})})},ActionsetManager.prototype.selectModule=function(){var s=this,t=this.currentActionSet.module;""!=this.actionSetBackup?(this.currentActionSet.module=JSON.parse(this.actionSetBackup).module,JSON.stringify(this.actionSetBackup),this.checkForChangesFunction()?this.modal.confirm("LBL_ALL_CHANGES_WOULD_BE_DELETED.","LBL_ARE_YOU_SURE").subscribe(function(e){e&&(s.deleteChanges(),s.currentActionSet.module=t)}):this.currentActionSet.module=t):this.currentActionSet.module=t},ActionsetManager.prototype.reset=function(){this.currentActionSet={id:"",module:"",name:"",package:"",type:"",actions:[]},this.selectedItem=null,this.selectedItemID=""},ActionsetManager.prototype.getDisplayName=function(e){var s=e.action?e.action:e.component;return e.actionconfig.label?s+" ("+this.language.getLabel(e.actionconfig.label)+")":s},ActionsetManager.prototype.isSelected=function(e){return e==this.selectedItem.id},ActionsetManager.prototype.selectItem=function(e){this.selectedItemID=e.id;for(var s=0,t=this.currentActionSet.actions;s<t.length;s++){var l=t[s];l.id==e.id&&(this.selectedItem=l)}},ActionsetManager.prototype.drop=function(e){this.currentActionSet.actions.splice(e.currentIndex,0,this.currentActionSet.actions.splice(e.previousIndex,1)[0]);for(var s=0,t=0,l=this.currentActionSet.actions;t<l.length;t++){l[t].sequence=s,s++}},ActionsetManager.prototype.deleteChanges=function(){this.currentActionSet.isnew?(this.metadata.removeActionset(this.currentActionSet.id),this.reset(),this.actionSetBackup=""):(this.currentActionSet=__assign({},JSON.parse(this.actionSetBackup)),this.metadata.setActionSet(this.currentActionSet.id,this.currentActionSet),0<this.currentActionSet.actions.length&&this.selectItem(this.currentActionSet.actions[0]))},ActionsetManager.prototype.saveChanges=function(){var i=this;this.modal.openModal("SystemLoadingModal").subscribe(function(s){var e={},t={};i.currentActionSet.isnew&&(e[i.currentActionSet.id]=i.currentActionSet),i.currentActionSet.isnew||(t[i.currentActionSet.id]=i.currentActionSet);var l={add:e,update:t,delete:{}};i.backend.postRequest("configuration/spiceui/core/actionsets",{},l).subscribe(function(e){e?(i.broadcast.broadcastMessage("metadata.updateactionsets",l),s.instance.self.destroy(),i.toast.sendToast("changes saved"),i.loadCurrentActionset(i.currentActionSet.id)):(s.instance.self.destroy(),i.toast.sendToast(i.language.getLabel("ERR_FAILED_TO_EXECUTE"),"error"))})})},ActionsetManager.prototype.copy=function(){var a=this;this.modalservice.openModal("ActionsetManagerAddDialog").subscribe(function(e){e.instance.sysModules=a.sysModules,e.instance.actionsetModule=a.currentModule,e.instance.mode="copy",e.instance.edit_mode=a.edit_mode,e.instance.actionsetName=(" "+a.currentActionSet.name).slice(1),e.instance.closedialog.subscribe(function(e){if(e){var s=a.modelutilities.generateGuid(),t=JSON.parse(JSON.stringify(a.currentActionSet.actions));a.metadata.setActionSet(s,{module:e.module,name:e.name,type:e.type,actions:t});for(var l=0,i=t;l<i.length;l++){i[l].id=a.modelutilities.generateGuid()}a.reset(),a.currentModule=e.module,a.currentActionSet.id=s,a.currentActionSet.module=e.module,a.currentActionSet.name=e.name,a.currentActionSet.type=e.type,a.currentActionSet.actions=t,a.currentActionSet.isnew=!0}})})},ActionsetManager=__decorate([core_1.Component({template:'<workbench-header titlelabel="LBL_ACTIONSET_MANAGER"></workbench-header><div class="slds-p-around--small slds-border--bottom"><div class="slds-grid slds-grid--vertical-align-center slds-form--inline"><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_MODULE"></system-label></label><div class="slds-form-element__control" style="min-width:250px;"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="currentModule" (change)="selectModule()" [disabled]="sysModules.length == 0"><option value="*">*</option><option *ngFor="let sysModule of sysModules" [value]="sysModule.module">{{sysModule.module}}</option></select></div></div></div><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_ACTIONSET"></system-label></label><div class="slds-form-element__control" style="min-width:250px;"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="currentActionSet.id" (change)="selectCurrentActionset()" [disabled]="getActionSets().length == 0"><option></option><optgroup [label]="\'custom\' + language.getLabel(\'LBL_ACTIONSET\')" *ngIf="getActionSets(\'custom\').length > 0"><option *ngFor="let sysActionset of getActionSets(\'custom\')" [value]="sysActionset.id">{{sysActionset.name}}</option></optgroup><optgroup [label]="\'global\' + language.getLabel(\'LBL_ACTIONSET\')" *ngIf="getActionSets(\'global\').length > 0"><option *ngFor="let sysActionset of getActionSets(\'global\')" [value]="sysActionset.id">{{sysActionset.name}}</option></optgroup></select></div></div></div><div class="slds-form-element slds-col--bump-left"><button *ngIf="!checkForChanges && currentActionSet.id != \'\'" [disabled]="!allowBarButtons" class="slds-button slds-button--brand" (click)="copy()"><span><system-label label="LBL_COPY"></system-label></span></button> <button *ngIf="!checkForChanges" [disabled]="!allowBarButtons" type="button" class="slds-button slds-button_icon slds-button_icon-border-filled" (click)="addActionset()"><system-utility-icon [icon]="\'add\'" [size]="\'x-small\'"></system-utility-icon></button> <button *ngIf="checkForChanges && currentActionSet.id != \'\'" [disabled]="!view.isEditMode()" type="button" class="slds-button slds-button--brand" (click)="saveChanges()"><system-label label="LBL_SAVE"></system-label></button> <button *ngIf="checkForChanges && currentActionSet.id != \'\'" [disabled]="!view.isEditMode()" type="button" class="slds-button slds-button--brand" (click)="deleteChanges()"><system-label label="LBL_CANCEL"></system-label></button></div></div></div><div *ngIf="currentActionSet.id != \'\'" class="slds-theme--default"><div class="slds-p-around--small slds-border--bottom slds-theme--default"><div class="slds-grid slds-grid--vertical-align-end"><div class="slds-form-element slds-p-right--x-small slds-size--1-of-5"><label class="slds-form-element__label"><system-label label="LBL_SCOPE"></system-label></label><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_left"><system-custom-icon [icon]="currentActionSet.type" size="x-small" addclasses="slds-input__icon slds-input__icon_left"></system-custom-icon><input type="text" disabled class="slds-input" [ngModel]="currentActionSet.type"></div></div><div class="slds-form-element slds-p-right--x-small slds-size--1-of-5"><label class="slds-form-element__label"><system-label label="LBL_NAME"></system-label></label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [(ngModel)]="currentActionSet.name"></div></div><div class="slds-form-element slds-p-right--x-small slds-size--1-of-5"><label class="slds-form-element__label"><system-label label="LBL_PACKAGE"></system-label></label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [(ngModel)]="currentActionSet.package"></div></div><div class="slds-form-element slds-p-right--x-small slds-size--1-of-5"><label class="slds-form-element__label"><system-label label="LBL_VERSION"></system-label></label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [(ngModel)]="currentActionSet.version"></div></div><div class="slds-form-element slds-p-right--x-small slds-size--1-of-5"><label class="slds-form-element__label"><system-label label="LBL_ID"></system-label></label><div class="slds-form-element__control"><input type="text" disabled class="slds-input" [ngModel]="currentActionSet.id"></div></div></div></div><div class="slds-grid"><div class="slds-size--3-of-5 slds-p-horizontal--small slds-p-top--x-small slds-border--right"><div class="slds-tree_container" role="application" style="max-width: none;" cdkDropList (cdkDropListDropped)="drop($event)"><div *ngFor="let currentActionSetItem of currentActionSet.actions" class="slds-p-vertical--xx-small slds-grid slds-grid--align-spread slds-grid--vertical-align-center" (click)="selectItem(currentActionSetItem)" [ngClass]="{\'slds-theme--shade\' : currentActionSetItem.id == selectedItemID}" cdkDrag cdkDragBoundary=".dragboundary"><system-utility-icon class="slds-p-right--xx-small" cdkDragHandle [icon]="\'rows\'" [size]="\'x-small\'" style="cursor:move"></system-utility-icon><a href="javascript:void(0);" role="presentation" class="slds-truncate">{{getDisplayName(currentActionSetItem)}}</a><div class="slds-col--bump-left"><button [disabled]="!view.isEditMode()" class="slds-button slds-button--icon" title="unlink item" (click)="deleteItem(currentActionSetItem)"><system-button-icon [icon]="\'delete\'"></system-button-icon></button></div></div></div><div class="slds-p-around--small slds-align--absolute-center slds-border--top slds-m-top--small"><button [disabled]="!view.isEditMode()" class="slds-button slds-button--icon" title="add item" (click)="addActionsetItem()"><system-button-icon [icon]="\'new\'"></system-button-icon></button></div></div><div class="slds-size--2-of-5 slds-p-horizontal--small slds-p-vertical--x-small"><actionsetmanager-action-details [(action)]="selectedItem"></actionsetmanager-action-details></div></div><div class="slds-text-align--right slds-p-around--small slds-border--top"></div></div>',providers:[services_1.view]}),__metadata("design:paramtypes",[services_1.backend,services_1.metadata,services_1.language,services_1.modelutilities,services_1.broadcast,services_1.toast,services_1.modal,services_1.configurationService,services_1.view,services_1.modal])],ActionsetManager)}();exports.ActionsetManager=ActionsetManager;var ActionsetManagerActionDetails=function(){function e(e,s,t,l){this.backend=e,this.metadata=s,this.language=t,this.view=l,this.action={},this.component="",this.component_backup="",this.localcomponent="",this.systemmodule="",this.systemmodules=[],this.standardActions=[{display:"NEW",value:"NEW",component:"ObjectActionNewButton"},{display:"DUPLICATE",value:"DUPLICATE",component:"ObjectActionDuplicateButton"},{display:"NEWRELATED",value:"NEWRELATED",component:"ObjectActionNewrelatedButton"},{display:"EDIT",value:"EDIT",component:"ObjectActionEditButton"},{display:"DELETE",value:"DELETE",component:"ObjectActionDeleteButton"},{display:"AUDIT",value:"AUDIT",component:"ObjectActionAuditlogButton"},{display:"IMPORT",value:"IMPORT",component:"SpiceImporterImportButton"},{display:"MAIL",value:"MAIL",component:"ObjectActionBeanToMailButton"},{display:"PRINT",value:"PRINT",component:"ObjectActionOutputBeanButton"},{display:"ROUTE",value:"ROUTE",component:"GlobalNavigationMenuItemActionRoute"},{display:"SELECT",value:"SELECT",component:"ObjectActionSelectButton"},{display:"OPEN",value:"OPEN",component:"ObjectActionOpenButton"},{display:"CANCEL",value:"CANCEL",component:"ObjectActionCancelButton"},{display:"SAVE",value:"SAVE",component:"ObjectActionSaveButton"},{display:"SAVERELATED",value:"SAVERELATED",component:"ObjectActionSaveRelatedButton"}],this.systemmodules=this.metadata.getSystemModules()}return e.prototype.ngOnChanges=function(e){this.action&&(this.action.isViewMode?this.view.setViewMode():this.view.setEditMode(),this.localcomponent=this.action.component,this.component_backup=this.localcomponent,this.setActionComponent())},Object.defineProperty(e.prototype,"components",{get:function(){return this.metadata.getSystemComponents(this.systemmodule)},enumerable:!1,configurable:!0}),e.prototype.componentName=function(e){return e?"1"==e.deprecated?e.component+" | dep.":e.component:""},e.prototype.setActionComponent=function(){var s=this;this.action.action?this.localcomponent=this.standardActions.find(function(e){return e.value===s.action.action}).component:this.localcomponent=this.component_backup,this.systemmodule=this.metadata.getSystemModuleByComponent(this.localcomponent)},e.prototype.setComponent=function(){this.action.component=this.localcomponent},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"action",void 0),e=__decorate([core_1.Component({selector:"actionsetmanager-action-details",template:'<fieldset *ngIf="action" class="slds-form-element slds-form-element_compound"><legend class="slds-form-element__legend slds-form-element__label slds-m-vertical_small"><system-label label="LBL_COMPONENT"></system-label></legend><div class="slds-form-element__control"><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_STANDARD_ACTION"></system-label></label><div class="slds-form-element__control"><div class="slds-select_container slds-m-vertical--xx-small"><select [disabled]="!view.isEditMode()" #focus class="slds-select" [(ngModel)]="action.action" (change)="setActionComponent()"><option [value]></option><option *ngFor="let a of standardActions" [value]="a.value">{{a.display}}</option></select></div></div></div><div class="slds-grid"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-form-element__label"><system-label label="LBL_MODULE"></system-label></label><div class="slds-form-element__control"><div class="slds-select_container"><select [disabled]="!view.isEditMode() || (action.action != \'\' && action.action)" class="slds-select" [(ngModel)]="systemmodule"><option *ngFor="let module of systemmodules" [value]="module.id">{{module.module}}</option></select></div></div></div><div class="slds-form-element slds-size--1-of-2 slds-p-left--xx-small"><label class="slds-form-element__label"><system-label label="LBL_COMPONENT"></system-label></label><div class="slds-form-element__control"><div class="slds-select_container"><select [disabled]="!view.isEditMode() || (action.action != \'\' && action.action)" class="slds-select" (change)="setComponent()" [(ngModel)]="localcomponent"><option>-</option><option *ngFor="let component of components" [value]="component.component">{{componentName(component)}}</option></select></div></div></div></div></div><legend class="slds-form-element__legend slds-form-element__label slds-m-vertical_small"><system-label label="LBL_INFORMATION"></system-label></legend><div class="slds-form-element__control"><div class="slds-form-element slds-m-bottom--x-small"><label class="slds-form-element__label">ID</label><div class="slds-form-element__control"><input type="text" class="slds-input" [ngModel]="action.id" disabled></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label"><system-label label="LBL_PACKAGE"></system-label></label><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" placeholder="package" [(ngModel)]="action.package"></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label"><system-label label="LBL_VERSION"></system-label></label><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" placeholder="version" [(ngModel)]="action.version"></div></div></div><legend class="slds-form-element__legend slds-form-element__label slds-m-vertical_small"><system-label label="LBL_OPTIONS"></system-label></legend><div class="slds-form-element__control"><div class="slds-form-element slds-m-vertical--xx-small"><label class="slds-form-element__label"><system-label label="LBL_LABEL"></system-label></label><system-input-label *ngIf="view.isEditMode()" [(ngModel)]="action.actionconfig.label"></system-input-label></div><div class="slds-form-element slds-m-vertical--xx-small"><label class="slds-form-element__label"><system-label label="LBL_ADD_CLASS"></system-label></label> <input type="text" class="slds-input" [disabled]="!view.isEditMode()" [(ngModel)]="action.actionconfig.addclasses"></div><fieldset class="slds-form-element slds-m-vertical--xxx-small"><div class="slds-form-element__control"><label class="slds-checkbox" for="link"><input [disabled]="!view.isEditMode()" type="checkbox" id="link" [(ngModel)]="action.singlebutton"> <span class="slds-checkbox--faux"></span> <span class="slds-form-element__label"><system-label label="LBL_SINGLEBUTTON"></system-label></span></label></div></fieldset><workbench-config [component]="action.component" [configValues]="action.actionconfig"></workbench-config></div></fieldset>',providers:[services_1.view]}),__metadata("design:paramtypes",[services_1.backend,services_1.metadata,services_1.language,services_1.view])],e)}();exports.ActionsetManagerActionDetails=ActionsetManagerActionDetails;var ActionsetManagerAddDialog=function(){function ActionsetManagerAddDialog(e,s,t){this.backend=e,this.metadata=s,this.language=t,this.sysModules=[],this.actionsetModule="",this.mode="",this.edit_mode="",this.actionsetName="",this.closedialog=new core_1.EventEmitter,this.actionsetType="custom",this.globalEdit=!1,this.modalTitle=""}var e;return ActionsetManagerAddDialog.prototype.ngOnInit=function(){"copy"==this.mode?this.modalTitle=this.language.getLabel("LBL_COPY_ACTIONSET"):this.modalTitle=this.language.getLabel("LBL_NEW_ACTIONSET")},ActionsetManagerAddDialog.prototype.closeDialog=function(){this.self.destroy()},ActionsetManagerAddDialog.prototype.onModalEscX=function(){this.closeDialog()},ActionsetManagerAddDialog.prototype.add=function(){this.closedialog.emit({name:this.actionsetName,type:this.actionsetType,module:this.actionsetModule}),this.self.destroy()},__decorate([core_1.Input(),__metadata("design:type",Object)],ActionsetManagerAddDialog.prototype,"sysModules",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],ActionsetManagerAddDialog.prototype,"actionsetModule",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],ActionsetManagerAddDialog.prototype,"mode",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],ActionsetManagerAddDialog.prototype,"edit_mode",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],ActionsetManagerAddDialog.prototype,"actionsetName",void 0),__decorate([core_1.Output(),__metadata("design:type","function"==typeof(e=void 0!==core_1.EventEmitter&&core_1.EventEmitter)?e:Object)],ActionsetManagerAddDialog.prototype,"closedialog",void 0),ActionsetManagerAddDialog=__decorate([core_1.Component({selector:"actionsetmanager-add-dialog",template:'<div role="dialog" tabindex="-1" aria-labelledby="header43" class="slds-modal slds-fade-in-open"><div class="slds-modal__container"><div class="slds-modal__header slds-theme--shade"><button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" (click)="closeDialog()"><system-button-icon [icon]="\'close\'" [size]="\'large\'"></system-button-icon></button><h2 id="header43" class="slds-text-heading--medium">{{modalTitle}}</h2></div><div class="slds-modal__content slds-p-around--medium"><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_MODULE"></system-label></label><div class="slds-form-element__control" style="min-width:250px;"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="actionsetModule" (change)="reset()" [disabled]="sysModules.length == 0"><option value="*">*</option><option *ngFor="let sysModule of sysModules" [value]="sysModule.module">{{sysModule.module}}</option></select></div></div></div><div class="slds-form-element slds-m-top--small"><label class="slds-form-element__label"><system-label label="LBL_ITEM_NAME"></system-label></label><div class="slds-form-element__control"><input type="text" class="slds-input" placeholder="name" [(ngModel)]="actionsetName"></div></div><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_TYPE"></system-label></label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="actionsetType"><option value="global" *ngIf="edit_mode == \'all\'"><system-label label="LBL_GLOBAL"></system-label></option><option value="custom"><system-label label="LBL_CUSTOM"></system-label></option></select></div></div></div></div><div class="slds-modal__footer"><button class="slds-button slds-button--neutral" (click)="closeDialog()"><system-label label="LBL_CANCEL"></system-label></button> <button class="slds-button slds-button--brand" [disabled]="fieldsetname == \'\'" (click)="add()"><system-label label="LBL_ADD"></system-label></button></div></div></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.metadata,services_1.language])],ActionsetManagerAddDialog)}();exports.ActionsetManagerAddDialog=ActionsetManagerAddDialog;var ComponentsetManager=function(){function ComponentsetManager(e,s,t,l,i,a,o,n,d){var r=this;this.backend=e,this.metadata=s,this.language=t,this.modelutilities=l,this.broadcast=i,this.toast=a,this.modalservice=o,this.view=n,this.configurationService=d,this.edit_mode="custom",this.allowBarButtons=!0,this.change_request_required=!1,this.sysModules=[],this.currentModule="*",this.currentComponentSet="",this.currentComponentSetItems=[],this.selectedId="",this.selectedComponent={},this.showAddDialog=!1,this.showComponentsetDetails=!1,this.backend.getRequest("system/spiceui/admin/modules").subscribe(function(e){r.sysModules=e}),this.checkMode()}return ComponentsetManager.prototype.checkMode=function(){var s=this;this.edit_mode=this.configurationService.getCapabilityConfig("core").edit_mode,this.change_request_required=!!this.configurationService.getCapabilityConfig("systemdeployment").change_request_required,"none"!=this.edit_mode&&"custom"!=this.edit_mode&&"all"!=this.edit_mode&&(this.edit_mode="custom"),this.change_request_required?this.backend.getRequest("module/SystemDeploymentCRs/active").subscribe(function(e){""==e.id?(s.setNoneMode(),s.toast.sendToast(s.language.getLabel("LBL_ACTIVATE_CR_WARNING"),"warning",null,3)):"all"==s.edit_mode?s.setAllMode():"custom"==s.edit_mode?s.setCustomMode():s.setNoneMode()}):"all"==this.edit_mode?this.setAllMode():"custom"==this.edit_mode?this.setCustomMode():this.setNoneMode()},ComponentsetManager.prototype.setNoneMode=function(){this.view.setViewMode(),this.allowBarButtons=!1},ComponentsetManager.prototype.setCustomMode=function(){"custom"==this.componentSetType?this.view.setEditMode():this.view.setViewMode()},ComponentsetManager.prototype.setAllMode=function(){this.view.setEditMode()},Object.defineProperty(ComponentsetManager.prototype,"showDetailIcon",{get:function(){return this.showComponentsetDetails?"chevronup":"chevrondown"},enumerable:!1,configurable:!0}),ComponentsetManager.prototype.toggleDetail=function(){this.showComponentsetDetails=!this.showComponentsetDetails},Object.defineProperty(ComponentsetManager.prototype,"componentSetType",{get:function(){return this.currentComponentSet?this.metadata.getComponentSet(this.currentComponentSet).type:""},enumerable:!1,configurable:!0}),Object.defineProperty(ComponentsetManager.prototype,"currentComponentSetPackage",{get:function(){return this.metadata.getComponentSet(this.currentComponentSet).package},set:function(e){this.metadata.getComponentSet(this.currentComponentSet).package=e},enumerable:!1,configurable:!0}),Object.defineProperty(ComponentsetManager.prototype,"currentComponentSetName",{get:function(){return this.metadata.getComponentSet(this.currentComponentSet).name},set:function(e){this.metadata.getComponentSet(this.currentComponentSet).name=e},enumerable:!1,configurable:!0}),ComponentsetManager.prototype.componentDeprecated=function(s){return"1"==this.metadata.getSystemComponents(s.module).find(function(e){return e.component===s.component}).deprecated},ComponentsetManager.prototype.getComponentSetItemName=function(e){return e.componentconfig.name?"("+this.language.getLabel(e.componentconfig.name)+")":e.componentconfig.object?"("+this.language.getModuleName(e.componentconfig.object)+")":void 0},ComponentsetManager.prototype.getComponentSets=function(e){if(e){for(var s=[],t=0,l=this.metadata.getComponentSets(this.currentModule);t<l.length;t++){var i=l[t];i.type==e&&s.push(i)}return s}return this.metadata.getComponentSets(this.currentModule)},ComponentsetManager.prototype.getComponentSetItems=function(){return this.currentComponentSet?this.metadata.getComponentSetObjects(this.currentComponentSet):[]},ComponentsetManager.prototype.selectItem=function(e){this.selectedId=e.id,this.selectedComponent=e},ComponentsetManager.prototype.isSelected=function(e){return e==this.selectedId},ComponentsetManager.prototype.getComponentsetConfig=function(){if(this.selectedComponent.componentconfig)return JSON.stringify(this.selectedComponent.componentconfig)},ComponentsetManager.prototype.reset=function(){this.selectedId="",this.selectedComponent={},this.currentComponentSet=""},ComponentsetManager.prototype.selectComponentSet=function(){this.checkMode(),this.selectedId="",this.selectedComponent={}},ComponentsetManager.prototype.addComponent=function(){var s=this;this.showAddDialog=!0,this.modalservice.openModal("ComponentsetManagerAddDialog").subscribe(function(e){e.instance.module=s.currentModule,e.instance.parent=s.currentComponentSet})},ComponentsetManager.prototype.addComponentset=function(){this.reset(),this.editComponentset()},ComponentsetManager.prototype.editComponentset=function(){var l=this;this.modalservice.openModal("ComponentsetManagerEditDialog").subscribe(function(e){e.instance.componentset=l.currentComponentSet,e.instance.edit_mode=l.edit_mode,e.instance.closedialog.subscribe(function(e){if(!1!==e)if(""===l.currentComponentSet){var s=l.modelutilities.generateGuid();l.metadata.addComponentSet(s,l.currentModule,e.name,e.type),l.currentComponentSet=s,l.checkMode()}else{var t=l.metadata.getComponentSet(l.currentComponentSet);t.name=t.name}})})},ComponentsetManager.prototype.deleteComponent=function(s){var e=this.metadata.getComponentSetObjects(this.currentComponentSet);e.splice(e.findIndex(function(e){return e.id==s.id}),1)},ComponentsetManager.prototype.drop=function(e){var s=this.metadata.getComponentSetObjects(this.currentComponentSet);s.splice(e.currentIndex,0,s.splice(e.previousIndex,1)[0]);for(var t=0,l=0,i=s;l<i.length;l++){i[l].sequence=t,t++}},ComponentsetManager.prototype.saveChanges=function(){var o=this;this.backend.getRequest("configuration/spiceui/core/components").subscribe(function(e){var s=o.metadata.getRawComponentSets(),t={},l={};for(var i in s)e.componentsets[i]?(JSON.stringify(s[i])!==JSON.stringify(e.componentsets[i])&&(l[i]=s[i]),delete e.componentsets[i]):t[i]=s[i];var a={add:t,update:l,delete:e.componentsets};o.backend.postRequest("configuration/spiceui/core/componentsets",{},a).subscribe(function(e){o.broadcast.broadcastMessage("metadata.updatecomponentsets",a),o.toast.sendToast("changes saved")})})},ComponentsetManager=__decorate([core_1.Component({template:'<workbench-header titlelabel="LBL_COMPONENTSETSET_MANAGER"></workbench-header><div class="slds-p-around--small slds-border--bottom"><div class="slds-grid slds-grid--vertical-align-center slds-form--inline"><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_MODULE"></system-label></label><div class="slds-form-element__control"><div class="slds-select_container" style="min-width:250px;"><select class="slds-select" [(ngModel)]="currentModule" (change)="reset()" [disabled]="sysModules.length == 0"><option value="*">*</option><option *ngFor="let sysModule of sysModules" [value]="sysModule.module">{{sysModule.module}}</option></select></div></div></div><div class="slds-form-element"><label class="slds-form-element__label">Componentset</label><div class="slds-form-element__control" style="min-width:250px;"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="currentComponentSet" (change)="selectComponentSet()" [disabled]="getComponentSets() == 0"><option></option><optgroup label="custom Componentsets" *ngIf="getComponentSets(\'custom\').length > 0"><option *ngFor="let sysComponentset of getComponentSets(\'custom\')" [value]="sysComponentset.id">{{sysComponentset.name}}</option></optgroup><optgroup label="global Componentsets" *ngIf="getComponentSets(\'global\').length > 0"><option *ngFor="let sysComponentset of getComponentSets(\'global\')" [value]="sysComponentset.id">{{sysComponentset.name}}</option></optgroup></select></div></div></div><div class="slds-button-group slds-col--bump-left"><button [disabled]="!allowBarButtons" type="button" class="slds-button slds-button_icon slds-button_icon-border-filled" (click)="addComponentset()"><system-utility-icon [icon]="\'add\'" [size]="\'x-small\'"></system-utility-icon></button></div></div></div><div *ngIf="currentComponentSet" class="slds-theme--default"><div class="slds-p-around--small slds-border--bottom slds-theme--default"><div class="slds-grid slds-grid--vertical-align-end"><div class="slds-form-element slds-p-right--x-small slds-size--1-of-4"><label class="slds-form-element__label"><system-label label="LBL_SCOPE"></system-label></label><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_left"><system-custom-icon [icon]="componentSetType" size="x-small" addclasses="slds-input__icon slds-input__icon_left"></system-custom-icon><input type="text" disabled class="slds-input" [ngModel]="componentSetType"></div></div><div class="slds-form-element slds-p-right--x-small slds-size--1-of-4"><label class="slds-form-element__label"><system-label label="LBL_NAME"></system-label></label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [(ngModel)]="currentComponentSetName"></div></div><div class="slds-form-element slds-p-right--x-small slds-size--1-of-4"><label class="slds-form-element__label"><system-label label="LBL_PACKAGE"></system-label></label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [(ngModel)]="currentComponentSetPackage"></div></div><div class="slds-form-element slds-p-right--x-small slds-size--1-of-4"><label class="slds-form-element__label"><system-label label="LBL_ID"></system-label></label><div class="slds-form-element__control"><input type="text" disabled class="slds-input" [ngModel]="currentComponentSet"></div></div></div></div><div class="slds-grid"><div class="slds-size--2-of-5 slds-p-horizontal--small slds-p-top--x-small slds-border--right"><div class="slds-tree_container" role="application" style="max-width: none;" cdkDropList (cdkDropListDropped)="drop($event)"><div *ngFor="let currentComponentSetItem of getComponentSetItems()" class="slds-p-vertical--xx-small slds-grid slds-grid--align-spread slds-grid--vertical-align-center" (click)="selectItem(currentComponentSetItem)" [ngClass]="{\'slds-theme--shade\' : isSelected(currentComponentSetItem.id)}" cdkDrag cdkDragBoundary=".dragboundary"><system-utility-icon class="slds-p-right--xx-small" cdkDragHandle [icon]="\'rows\'" [size]="\'x-small\'" style="cursor:move"></system-utility-icon><a *ngIf="!componentDeprecated(currentComponentSetItem)" href="javascript:void(0);" role="presentation" class="slds-truncate">{{currentComponentSetItem.component}} {{getComponentSetItemName(currentComponentSetItem)}}</a><div *ngIf="componentDeprecated(currentComponentSetItem)" class="slds-clearfix"><a href="javascript:void(0);" role="presentation" class="slds-truncate"><system-icon [icon]="\'warning\'" [sprite]="\'utility\'" [size]="\'x-small\'" class="slds-float_left" [addclasses]="\'slds-m-vertical--xxx-small slds-m-horizontal--xx-small\'"></system-icon><del class="slds-float_left">{{currentComponentSetItem.component}} {{getComponentSetItemName(currentComponentSetItem)}}</del></a></div><div class="slds-col--bump-left"><button [disabled]="!view.isEditMode()" class="slds-button slds-button--icon" title="unlink item" (click)="deleteComponent(currentComponentSetItem)"><system-button-icon [icon]="\'delete\'"></system-button-icon></button></div></div></div><div class="slds-p-around--small slds-align--absolute-center slds-border--top slds-m-top--small"><button [disabled]="!view.isEditMode()" class="slds-button slds-button--icon" title="add item" (click)="addComponent()"><system-button-icon [icon]="\'new\'"></system-button-icon></button></div></div><div class="slds-size--3-of-5 slds-p-horizontal--small slds-p-vertical--x-small"><componentsetmanager-componentset-details *ngIf="selectedId" [component]="selectedComponent"></componentsetmanager-componentset-details></div></div><div class="slds-text-align--right slds-p-around--small slds-border--top"><button [disabled]="!view.isEditMode()" type="button" class="slds-button slds-button--brand" (click)="saveChanges()"><system-label label="LBL_SAVE"></system-label></button></div></div>',providers:[services_1.view]}),__metadata("design:paramtypes",[services_1.backend,services_1.metadata,services_1.language,services_1.modelutilities,services_1.broadcast,services_1.toast,services_1.modal,services_1.view,services_1.configurationService])],ComponentsetManager)}();exports.ComponentsetManager=ComponentsetManager;var ComponentsetManagerComponentsetDetails=function(){function e(e,s){this.view=e,this.language=s,this.component={},this.configcomponent="",this.configValues={},this.selectedComponent={}}return e.prototype.ngOnChanges=function(e){this.component.component&&(this.selectComponent(this.component),this.configcomponent=this.component.component,this.configValues=this.component.componentconfig)},e.prototype.selectComponent=function(e){e.id?this.selectedComponent=e:this.selectedComponent={}},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"component",void 0),e=__decorate([core_1.Component({selector:"componentsetmanager-componentset-details",template:'<div class="slds-grid"><div class="slds-form-element slds-size_2-of-3"><label class="slds-form-element__label"><system-label label="LBL_COMPONENT"></system-label></label><div class="slds-form-element__control"><input disabled type="text" class="slds-input" [ngModel]="component.component"></div></div><div class="slds-form-element slds-size_1-of-3 slds-p-left_x-small"><label class="slds-form-element__label"><system-label label="LBL_PACKAGE"></system-label></label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [(ngModel)]="component.package"></div></div></div><workbench-config [component]="configcomponent" [configValues]="configValues"></workbench-config>'}),__metadata("design:paramtypes",[services_1.view,services_1.language])],e)}();exports.ComponentsetManagerComponentsetDetails=ComponentsetManagerComponentsetDetails;var ComponentsetManagerAddDialog=function(){function ComponentsetManagerAddDialog(e,s,t,l){this.backend=e,this.metadata=s,this.language=t,this.modelutilities=l,this.module="",this.parent="",this.component="",this.systemmodule="",this.systemmodules=[],this.showDeprecatedWarning=!1,this.systemmodules=this.metadata.getSystemModules()}return Object.defineProperty(ComponentsetManagerAddDialog.prototype,"components",{get:function(){return this.metadata.getSystemComponents(this.systemmodule)},enumerable:!1,configurable:!0}),ComponentsetManagerAddDialog.prototype.componentName=function(e){return e?"1"==e.deprecated?e.component+" | dep.":e.component:""},ComponentsetManagerAddDialog.prototype.cancelDialog=function(){this.self.destroy()},ComponentsetManagerAddDialog.prototype.onModalEscX=function(){this.cancelDialog()},ComponentsetManagerAddDialog.prototype.add=function(){this.metadata.addComponentToComponentset(this.modelutilities.generateGuid(),this.parent,this.component),this.self.destroy()},ComponentsetManagerAddDialog.prototype.checkDep=function(s){"1"==this.components.find(function(e){return e.component===s}).deprecated?this.showDeprecatedWarning=!0:this.showDeprecatedWarning=!1},__decorate([core_1.Input(),__metadata("design:type",String)],ComponentsetManagerAddDialog.prototype,"module",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],ComponentsetManagerAddDialog.prototype,"parent",void 0),ComponentsetManagerAddDialog=__decorate([core_1.Component({selector:"componensetmanager-add-dialog",template:'<div role="dialog" tabindex="-1" aria-labelledby="header43" class="slds-modal slds-fade-in-open"><div class="slds-modal__container"><div class="slds-modal__header slds-theme--shade"><button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" (click)="cancelDialog()"><system-button-icon [icon]="\'close\'" [size]="\'large\'"></system-button-icon></button><h2 id="header43" class="slds-text-heading--medium"><system-label label="LBL_ADD_COMPONENT"></system-label></h2></div><div class="slds-modal__content slds-p-around--medium"><div class="slds-grid"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-form-element__label"><system-label label="LBL_MODULE"></system-label></label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="systemmodule"><option *ngFor="let module of systemmodules" [value]="module.id">{{module.module}}</option></select></div></div></div><div class="slds-form-element slds-size--1-of-2 slds-p-left--xx-small"><label class="slds-form-element__label"><system-label label="LBL_COMPONENT"></system-label></label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="component" (ngModelChange)="checkDep(component)"><option>-</option><option *ngFor="let component of components" [value]="component.component">{{componentName(component)}}</option></select></div></div></div></div></div><div *ngIf="showDeprecatedWarning" class="slds-notify slds-notify_alert slds-theme_alert-texture slds-theme_warning" role="alert"><span class="slds-assistive-text">warning</span> <span class="slds-icon_container slds-icon-utility-warning slds-m-right_x-small" title="Description of icon when needed"><svg class="slds-icon slds-icon_x-small" aria-hidden="true"><use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#warning"></use></svg></span><h2><system-label label="LBL_DEPRECATED_MSG"></system-label></h2></div><div class="slds-modal__footer"><button class="slds-button slds-button--neutral" (click)="cancelDialog()"><system-label label="LBL_CANCEL"></system-label></button> <button class="slds-button slds-button--brand" (click)="add()"><system-label label="LBL_ADD"></system-label></button></div></div></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.metadata,services_1.language,services_1.modelutilities])],ComponentsetManagerAddDialog)}();exports.ComponentsetManagerAddDialog=ComponentsetManagerAddDialog;var ComponentsetManagerEditDialog=function(){function ComponentsetManagerEditDialog(e,s){this.metadata=e,this.language=s,this.closedialog=new core_1.EventEmitter,this.componentset="",this.edit_mode="",this.adding=!1,this.componentsetname="",this.componentsettype=""}var e;return ComponentsetManagerEditDialog.prototype.ngOnInit=function(){if(""!==this.componentset){var e=this.metadata.getComponentSet(this.componentset);this.componentsetname=e.name,this.componentsettype=e.type,this.adding=!1}else this.adding=!0,this.componentsettype="custom"},ComponentsetManagerEditDialog.prototype.cancelDialog=function(){this.closedialog.emit(!1),this.self.destroy()},ComponentsetManagerEditDialog.prototype.onModalEscX=function(){this.cancelDialog()},ComponentsetManagerEditDialog.prototype.add=function(){this.closedialog.emit({name:this.componentsetname,type:this.componentsettype}),this.self.destroy()},__decorate([core_1.Output(),__metadata("design:type","function"==typeof(e=void 0!==core_1.EventEmitter&&core_1.EventEmitter)?e:Object)],ComponentsetManagerEditDialog.prototype,"closedialog",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],ComponentsetManagerEditDialog.prototype,"componentset",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],ComponentsetManagerEditDialog.prototype,"edit_mode",void 0),ComponentsetManagerEditDialog=__decorate([core_1.Component({selector:"componensetmanager-edit-dialog",template:'<div role="dialog" tabindex="-1" aria-labelledby="header43" class="slds-modal slds-fade-in-open"><div class="slds-modal__container"><div class="slds-modal__header slds-theme--shade"><button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" (click)="cancelDialog()"><system-button-icon [icon]="\'close\'" [size]="\'large\'"></system-button-icon></button><h2 id="header43" class="slds-text-heading--medium">Add Componentset</h2></div><div class="slds-modal__content slds-p-around--medium"><div class="slds-form-element slds-m-top--small"><label class="slds-form-element__label">Componentset Name</label><div class="slds-form-element__control"><input type="text" class="slds-input" placeholder="name" [(ngModel)]="componentsetname"></div></div><div class="slds-form-element"><label class="slds-form-element__label">type</label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="componentsettype" [disabled]="!adding"><option *ngIf="edit_mode == \'all\'" value="global">Global</option><option value="custom">Custom</option></select></div></div></div></div><div class="slds-modal__footer"><button class="slds-button slds-button--neutral" (click)="cancelDialog()"><system-label label="LBL_CANCEL"></system-label></button> <button class="slds-button slds-button--brand" [disabled]="fieldsetname == \'\'" (click)="add()"><system-label label="LBL_SAVE"></system-label></button></div></div></div>'}),__metadata("design:paramtypes",[services_1.metadata,services_1.language])],ComponentsetManagerEditDialog)}();exports.ComponentsetManagerEditDialog=ComponentsetManagerEditDialog;var ValidationRulesManager=function(){function ValidationRulesManager(e,s,t,l,i){this.backend=e,this.metadata=s,this.language=t,this.utils=l,this.toast=i,this.rules=[],this._backup_rules=[],this._current_rule_data={},this.logicoperator_options=[],this.current_tab="details",this.logicoperator_options=this.language.getDisplayOptions("logicoperators_dom",!0)}return Object.defineProperty(ValidationRulesManager.prototype,"modules",{get:function(){return this.metadata.getModules().sort()},enumerable:!1,configurable:!0}),Object.defineProperty(ValidationRulesManager.prototype,"current_module",{get:function(){return this._current_module},set:function(e){this._current_module=e,this.rules=this.metadata.getModuleValidations(e),this.copyRulesToBackup(),this.current_rule=null},enumerable:!1,configurable:!0}),Object.defineProperty(ValidationRulesManager.prototype,"current_rule",{get:function(){return this._current_rule},set:function(e){this._current_rule=e,this._current_rule_data=this.getCurrentRuleData()},enumerable:!1,configurable:!0}),Object.defineProperty(ValidationRulesManager.prototype,"current_rule_data",{get:function(){return this._current_rule_data},enumerable:!1,configurable:!0}),ValidationRulesManager.prototype.getCurrentRuleData=function(){var s=this;return this.rules?this.rules.find(function(e){return e.id==s._current_rule}):""},ValidationRulesManager.prototype.removeCurrentValidationRule=function(){var s=this;this.backend.deleteRequest("configuration/spiceui/core/modelvalidations/"+this.current_rule).subscribe(function(e){return s.toast.sendToast("rule removed"),s.removeRule(s.current_rule),!0},function(e){return s.toast.sendToast("removing rule failed!"),console.error(e),!1})},ValidationRulesManager.prototype.save=function(){var t=this,l=this.current_rule_data;this.backend.postRequest("configuration/spiceui/core/modelvalidations",{},l).subscribe(function(e){t.current_rule_data.isnewrecord=!1;var s=t._backup_rules.findIndex(function(e){return e.id==t._current_rule});t._backup_rules[s]=__assign({},l),t.toast.sendToast("changes saved")},function(e){t.toast.sendAlert("saving changes failed!"),console.error(e)})},ValidationRulesManager.prototype.cancel=function(){this.current_rule_data.isnewrecord?this.removeRule(this.current_rule):this.resetCurrentRuleData()},ValidationRulesManager.prototype.addValidationRule=function(){this.rules.push({id:this.utils.generateGuid(),module:this.current_module,active:1,actions:[],conditions:[],isnewrecord:!0}),this.current_rule=this.rules[this.rules.length-1].id},ValidationRulesManager.prototype.removeRule=function(s){void 0===s&&(s=this.current_rule);var e=this.rules.findIndex(function(e){return e.id==s});return this.rules.splice(e,1),this.current_rule==s&&(this.current_rule=null),!0},ValidationRulesManager.prototype.resetCurrentRuleData=function(){var s=this,e=this._backup_rules.find(function(e){return e.id==s._current_rule});this._current_rule_data=__assign({},e)},ValidationRulesManager.prototype.copyRulesToBackup=function(){this._backup_rules=[];for(var e=0,s=this.rules;e<s.length;e++){var t=s[e];this._backup_rules.push(__assign({},t))}},ValidationRulesManager=__decorate([core_1.Component({template:'<workbench-header titlelabel="LBL_VALIDATIONRULES_MANAGER"></workbench-header><div class="slds-grid slds-form--inline slds-p-around--small slds-border--bottom"><div class="slds-form-element"><label class="slds-form-element__label">Module</label><div class="slds-form-element__control" style="min-width:250px;"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="current_module"><option></option><option *ngFor="let m of modules" [value]="m">{{m}}</option></select></div></div></div><div *ngIf="current_module" class="slds-form-element"><label class="slds-form-element__label">Rule</label><div class="slds-form-element__control" style="min-width:250px;"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="current_rule"><option></option><option *ngFor="let r of rules" [value]="r.id">{{r.name}}</option></select></div></div></div><div *ngIf="current_module" class="slds-form-element slds-col--bump-left"><div class="slds-button-group" role="group"><button type="button" class="slds-button slds-button--neutral" (click)="addValidationRule()"><system-label label="LBL_ADD"></system-label></button> <button type="button" class="slds-button slds-button--neutral" [disabled]="!current_rule" (click)="removeCurrentValidationRule()"><system-label label="LBL_DELETE"></system-label></button> <button type="button" class="slds-button slds-button--neutral" [disabled]="!current_rule" (click)="cancel()"><system-label label="LBL_CANCEL"></system-label></button> <button type="button" class="slds-button slds-button--brand" [disabled]="!current_rule" (click)="save()"><system-label label="LBL_SAVE"></system-label></button></div></div></div><div *ngIf="current_rule" class="slds-grid"><div class="slds-tabs_default"><ul class="slds-tabs_default__nav" role="tablist"><li class="slds-tabs--default__item slds-text-title--caps" [ngClass]="{\'slds-active\': current_tab == \'details\' || !current_tab}" role="presentation" (click)="current_tab = \'details\'"><a class="slds-tabs--default__link" href="javascript:void(0);" role="tab" aria-selected="false">Details</a></li><li class="slds-tabs--default__item slds-text-title--caps" [ngClass]="{\'slds-active\': current_tab == \'conditions\'}" role="presentation" (click)="current_tab = \'conditions\'"><a class="slds-tabs--default__link" href="javascript:void(0);" role="tab" aria-selected="false">Conditions</a></li><li class="slds-tabs--default__item slds-text-title--caps" [ngClass]="{\'slds-active\': current_tab == \'actions\'}" role="presentation" (click)="current_tab = \'actions\'"><a class="slds-tabs--default__link" href="javascript:void(0);" role="tab" aria-selected="false">Actions</a></li></ul><div *ngIf="current_tab == \'details\'" id="tab-default-1" class="slds-tabs_default__content" role="tabpanel"><div class="slds-size--3-of-5 slds-p-horizontal--small slds-p-top--x-small"><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label">Name:</label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="current_rule_data.name"></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label">OnEvents:</label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="current_rule_data.onevents"></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label">Logic Operator:</label><div class="slds-form-element__control"><select class="slds-select" [(ngModel)]="current_rule_data.logicoperator"><option *ngFor="let opt of logicoperator_options" value="{{opt.value}}">{{opt.display}}</option></select></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label">Priority:</label><div class="slds-form-element__control"><input type="number" min="0" max="99" class="slds-input" [(ngModel)]="current_rule_data.prioirty"></div></div><div class="slds-form-element"><label class="slds-form-element__label">Active:</label><div class="slds-form-element__control"><system-checkbox [(ngModel)]="current_rule_data.active"></system-checkbox></div></div></div></div><div *ngIf="current_tab == \'conditions\'" id="tab-default-2" class="slds-tabs_default__content" role="tabpanel"><validationrules-conditions [data]="current_rule_data"></validationrules-conditions></div><div *ngIf="current_tab == \'actions\'" id="tab-default-3" class="slds-tabs_default__content" role="tabpanel"><validationrules-actions [data]="current_rule_data"></validationrules-actions></div></div></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.metadata,services_1.language,services_1.modelutilities,services_1.toast])],ValidationRulesManager)}();exports.ValidationRulesManager=ValidationRulesManager;var MaybeJsonPipe=function(s){function e(){return null!==s&&s.apply(this,arguments)||this}return __extends(e,s),e.prototype.transform=function(e){return e instanceof Array||e instanceof Object?s.prototype.transform.call(this,e):e},e=__decorate([core_1.Pipe({name:"maybejson"})],e)}(common_1.JsonPipe);exports.MaybeJsonPipe=MaybeJsonPipe;var ValidationRulesConditions=function(){function e(e,s,t){this.metadata=e,this.language=s,this.utils=t,this.comparator_options=[],this.fieldname_options=[]}return e.prototype.ngOnInit=function(){for(var e in this.comparator_options=this.language.getDisplayOptions("comparators_dom",!0),this.metadata.getModuleFields(this.data.module))this.fieldname_options.push(e),this.fieldname_options.sort()},Object.defineProperty(e.prototype,"conditions",{get:function(){return this.data.conditions.filter(function(e){return 1!=e.deleted})},enumerable:!1,configurable:!0}),e.prototype.addCondition=function(){return this.data.conditions.push({id:this.utils.generateGuid(),sysuimodelvalidation_id:this.data.id,isnewrecord:!0})},e.prototype.removeCondition=function(s){var e=this.data.conditions.findIndex(function(e){return e.id==s});return this.data.conditions[e]._is_new_record?this.data.conditions.splice(e,1):this.data.conditions[e].deleted=1,!0},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"data",void 0),e=__decorate([core_1.Component({selector:"validationrules-conditions",template:'<table class="slds-table slds-table--bordered slds-table--cell-buffer"><thead><tr class="slds-text-title--caps"><th scope="col" style="width:2rem;">Fieldname</th><th scope="col" style="width:1rem;">Comparator</th><th scope="col" style="width:4rem;">Valutations</th><th scope="col" style="width:2rem;">OnChange</th><th scope="col" style="width:1rem;"></th></tr></thead><tbody><tr *ngFor="let c of conditions" class="slds-theme--shade"><td><div class="slds-select_container"><select class="slds-select" [(ngModel)]="c.fieldname"><option *ngFor="let opt of fieldname_options" value="{{opt}}">{{opt}}</option></select></div></td><td><div class="slds-select_container"><select class="slds-select" [(ngModel)]="c.comparator"><option *ngFor="let opt of comparator_options" value="{{opt.value}}">{{opt.display}}</option></select></div></td><td><div class="slds-form-element__control"><textarea class="slds-textarea" [ngModel]="c.valuations | maybejson" (ngModelChange)="c.valuations=$event"></textarea></div></td><td><div class="slds-form-element__control"><span class="slds-checkbox"><input type="checkbox" name="options" [id]="c.id +\'onchange\'" [(ngModel)]="c.onchange"> <label class="slds-checkbox__label" [attr.for]="c.id +\'onchange\'"><span class="slds-checkbox_faux"></span></label></span></div></td><td><button class="slds-button slds-button--negative" (click)="removeCondition(c.id)"><system-button-icon [icon]="\'delete\'" [size]="\'small\'"></system-button-icon></button></td></tr></tbody></table><div class="slds-grid slds-grid--align-spread slds-p-around--medium"><button class="slds-button slds-button--neutral" (click)="addCondition()"><system-label label="LBL_ADD"></system-label></button></div>'}),__metadata("design:paramtypes",[services_1.metadata,services_1.language,services_1.modelutilities])],e)}();exports.ValidationRulesConditions=ValidationRulesConditions;var ValidationRulesActions=function(){function e(e,s,t){this.metadata=e,this.language=s,this.utils=t,this.action_options=["set_value","set_model_state","set_stati","set_message","error","warning","notice","hide","show","require"],this.fieldname_options=[]}return e.prototype.ngOnInit=function(){for(var e in this.metadata.getModuleFields(this.data.module))this.fieldname_options.push(e)},Object.defineProperty(e.prototype,"actions",{get:function(){return this.data.actions.filter(function(e){return 1!=e.deleted})},enumerable:!1,configurable:!0}),e.prototype.addAction=function(){return this.data.actions.push({id:this.utils.generateGuid(),sysuimodelvalidation_id:this.data.id,isnewrecord:!0})},e.prototype.removeAction=function(s){var e=this.data.actions.findIndex(function(e){return e.id==s});return this.data.actions[e].isnewrecord?this.data.actions.splice(e,1):this.data.actions[e].deleted=1,!0},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"data",void 0),e=__decorate([core_1.Component({selector:"validationrules-actions",template:'<table class="slds-table slds-table--bordered slds-table--cell-buffer"><thead><tr class="slds-text-title--caps"><th scope="col" style="width:2rem;">Fieldname</th><th scope="col" style="width:1rem;">Action</th><th scope="col" style="width:4rem;">Parameter(s)</th><th scope="col" style="width:1rem;">Priority</th><th scope="col" style="width:1rem;"></th></tr></thead><tbody><tr *ngFor="let c of actions" class="slds-theme--shade"><td><div class="slds-select_container"><select class="slds-select" [(ngModel)]="c.fieldname"><option></option><option *ngFor="let opt of fieldname_options" value="{{opt}}">{{opt}}</option></select></div></td><td><div class="slds-select_container"><select class="slds-select" [(ngModel)]="c.action"><option *ngFor="let opt of action_options" value="{{opt}}">{{opt}}</option></select></div></td><td><div class="slds-form-element__control"><textarea class="slds-textarea" [ngModel]="c.params | maybejson" (ngModelChange)="c.params=$event"></textarea></div></td><td><div class="slds-form-element__control"><input type="number" min="0" max="99" class="slds-input" [(ngModel)]="c.priority"></div></td><td><button class="slds-button slds-button--negative" (click)="removeAction(c.id)"><system-button-icon [icon]="\'delete\'" [size]="\'small\'"></system-button-icon></button></td></tr></tbody></table><div class="slds-grid slds-grid--align-spread slds-p-around--medium"><button class="slds-button slds-button--neutral" (click)="addAction()"><system-label label="LBL_ADD"></system-label></button></div>'}),__metadata("design:paramtypes",[services_1.metadata,services_1.language,services_1.modelutilities])],e)}();exports.ValidationRulesActions=ValidationRulesActions;var LanguageTranslationsManager=function(){function LanguageTranslationsManager(e,s,t,l,i){this.backend=e,this.metadata=s,this.language=t,this.utils=l,this.toast=i,this.labels=[],this.currentScope="global",this.selectedLanguage="",this.isLoading=!1}return Object.defineProperty(LanguageTranslationsManager.prototype,"scope",{get:function(){return this.currentScope},set:function(e){this.currentScope=e,this.getTranslations()},enumerable:!1,configurable:!0}),Object.defineProperty(LanguageTranslationsManager.prototype,"languages",{get:function(){var s=this;return this.language.getAvialableLanguages().filter(function(e){return e.language!=s.language.currentlanguage})},enumerable:!1,configurable:!0}),Object.defineProperty(LanguageTranslationsManager.prototype,"selectedLanguageText",{get:function(){return this.language.getLangText(this.language.currentlanguage)},enumerable:!1,configurable:!0}),LanguageTranslationsManager.prototype.save=function(s){var e,t=this,l="global"==this.scope?"global_translations":"custom_translations",i=((e={id:s.id,name:s.name,scope:this.scope})[l]=[{id:this.utils.generateGuid(),syslanguagelabel_id:s.id,syslanguage:this.selectedLanguage,translation_default:s.translation_default,translation_short:s.translation_short,translation_long:s.translation_long}],e);this.backend.postRequest("configuration/syslanguages/labels",null,[i]).subscribe(function(e){t.language.addLabel(s.name,s.translation_default,s.translation_short,s.translation_long),t.labels=t.labels.filter(function(e){return e.id!=s.id}),t.toast.sendToast(t.language.getLabel("LBL_DATA_SAVED"),"success")})},LanguageTranslationsManager.prototype.getLabelSpecificLength=function(e,s){var t=this.language.getLabel(e),l=this.language.getLabel(e,"",s);return l!=t?l:""},LanguageTranslationsManager.prototype.getTranslations=function(){var s=this;this.labels=[],0!=this.selectedLanguage.length&&(this.isLoading=!0,this.backend.getRequest("configuration/syslanguage/"+this.selectedLanguage+"/"+this.scope+"/labels/untranslated").subscribe(function(e){s.labels=e,s.isLoading=!1},function(e){return s.isLoading=!1}))},LanguageTranslationsManager.prototype.canSave=function(e){return e.translation_default&&0<e.translation_default.length},LanguageTranslationsManager.prototype.trackByFn=function(e,s){return s.id},LanguageTranslationsManager=__decorate([core_1.Component({selector:"language-translations-manager",template:'<div class="slds-border--bottom slds-form--inline slds-grid slds-grid--vertical-align-end slds-p-around--small"><div *ngIf="!isLoading && selectedLanguage?.length > 0 && labels?.length" class="slds-text-heading--label">Untranslated records: <span class="slds-text-color--error">{{labels?.length}}</span></div><div class="slds-grid slds-grid--vertical-align-center slds-col--bump-left"><div><span class="slds-radio"><input type="radio" name="translation_scope" [(ngModel)]="scope" [disabled]="isLoading" id="scope_global" value="global"> <label class="slds-radio__label" for="scope_global"><span class="slds-radio_faux"></span> <span class="slds-form-element__label"><system-label label="LBL_GLOBAL"></system-label></span></label></span> <span class="slds-radio"><input type="radio" name="translation_scope" [(ngModel)]="scope" [disabled]="isLoading" id="scope_custom" value="custom"> <label class="slds-radio__label" for="scope_custom"><span class="slds-radio_faux"></span> <span class="slds-form-element__label"><system-label label="LBL_CUSTOM"></system-label></span></label></span></div><div class="slds-form-element"><div class="slds-form-element__control"><input type="text" class="slds-input" disabled [value]="selectedLanguageText"></div></div><system-utility-icon icon="sort" size="xx-small" class="slds-m-right--x-small" addclasses="slds-path__trigger_open"></system-utility-icon><div class="slds-form-element__control slds-p-right--x-small"><div class="slds-select_container" style="min-width: 150px;"><select class="slds-select" [(ngModel)]="selectedLanguage" (change)="getTranslations()" [disabled]="isLoading"><option></option><option *ngFor="let lang of languages" [value]="lang.language">{{lang.text}}</option></select></div></div><div class="slds-form-element"><div class="slds-button-group" role="group"><button class="slds-button slds-button--icon-border" (click)="getTranslations()" [disabled]="isLoading"><system-button-icon icon="refresh"></system-button-icon></button></div></div></div></div><div system-to-bottom class="slds-size--1-of-1 spice-scrollbar"><div *ngIf="isLoading" class="slds-align_absolute-center" style="height: 100%;"><system-spinner></system-spinner></div><div *ngFor="let label of labels | slice:0:20; trackBy: trackByFn"><div class="slds-card slds-m-around--small"><div class="slds-card__header"><h2 class="slds-text-heading--small"><system-label label="LBL_LABEL"></system-label>: <span class="slds-required">{{language.getLangText(label.name)}}</span></h2></div><div class="slds-card__body slds-p-around--small" style="margin-bottom: 0;"><div class="slds-grid"><div class="slds-size--1-of-2 slds-p-right--small"><div class="slds-form-element"><label><system-label label="LBL_TEXT_SHORT"></system-label>:</label> <input type="text" class="slds-input" [value]="getLabelSpecificLength(label.name, \'short\')" disabled></div><div class="slds-form-element"><label><system-label label="LBL_DEFAULT"></system-label>:</label> <input type="text" class="slds-input" required [value]="language.getLabel(label.name)" disabled></div><div class="slds-form-element"><label><system-label label="LBL_TEXT_LONG"></system-label>:</label> <textarea class="slds-textarea" [value]="getLabelSpecificLength(label.name, \'long\')" disabled></textarea></div></div><div class="slds-size--1-of-2"><div class="slds-form-element"><label><system-label label="LBL_TEXT_SHORT"></system-label>:</label> <input type="text" class="slds-input" [(ngModel)]="label.translation_short"></div><div class="slds-form-element"><label><abbr class="slds-required">*</abbr><system-label label="LBL_DEFAULT"></system-label>:</label> <input type="text" class="slds-input" required [(ngModel)]="label.translation_default"></div><div class="slds-form-element"><label><system-label label="LBL_TEXT_LONG"></system-label>:</label> <textarea class="slds-textarea" [(ngModel)]="label.translation_long"></textarea></div></div></div><div class="slds-grid slds-p-top--x-small"><div class="slds-col--bump-left"><button type="button" class="slds-button slds-button--brand" [disabled]="!canSave(label)" (click)="save(label)"><system-label label="LBL_SAVE"></system-label></button></div></div></div></div></div><div *ngIf="!isLoading && selectedLanguage.length == 0" class="slds-align_absolute-center" style="height: 100%;"><system-label label="LBL_MAKE_SELECTION"></system-label></div><div *ngIf="!isLoading && selectedLanguage?.length > 0 && labels?.length == 0" class="slds-align_absolute-center" style="height: 100%;"><system-label label="LBL_NO_ENTRIES"></system-label></div></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.metadata,services_1.language,services_1.modelutilities,services_1.toast])],LanguageTranslationsManager)}();exports.LanguageTranslationsManager=LanguageTranslationsManager;var LanguageLabelManagerComponent=function(){function LanguageLabelManagerComponent(e,s,t,l,i,a,o,n){this.backend=e,this.metadata=s,this.language=t,this.utils=l,this.toast=i,this.footer=a,this.modalservice=o,this.sessionservice=n,this.search_term="",this.labels=[],this.languages=[],this._selected_label=null,this.is_searching=!1,this.page=1,this.translation_scope="global",this.scopes=["global","custom"],this.languages=this.language.getAvialableLanguages()}return Object.defineProperty(LanguageLabelManagerComponent.prototype,"selected_label",{get:function(){return this._selected_label},set:function(e){var t=this;if((this._selected_label=e)&&0==e[this.translation_scope+"_translations"].length){for(var s=0,l=this.scopes;s<l.length;s++){var i=l[s];if(0<e[i+"_translations"].length){this.translation_scope=i;break}}e[this.translation_scope+"_translations"].sort(function(e,s){return e.syslanguage==t.language.languagedata.languages.default||e.syslanguage<s.syslanguage?-1:e.syslanguage>s.syslanguage?1:void 0})}},enumerable:!1,configurable:!0}),LanguageLabelManagerComponent.prototype.showRefModal=function(){this.modalservice.openModal("LanguageLabelReferenceConfigModal")},Object.defineProperty(LanguageLabelManagerComponent.prototype,"translations",{get:function(){return this.selected_label[this.translation_scope+"_translations"]},enumerable:!1,configurable:!0}),LanguageLabelManagerComponent.prototype.search=function(e){var s=this;if(void 0===e&&(e=null),this.page=1,!(e=e||this.search_term))return!1;this.selected_label=null,this.is_searching=!0,this.backend.getRequest("configuration/syslanguages/labels/search/"+this.search_term).subscribe(function(e){s.labels=e,s.is_searching=!1})},LanguageLabelManagerComponent.prototype.addTranslation=function(e,s){void 0===s&&(s=null),this.selected_label[e+"_translations"]||(this.selected_label[e+"_translations"]=[]),s||(s=this.getMissingLanguages(e)[0]);this.selected_label[e+"_translations"].push({id:this.utils.generateGuid(),syslanguagelabel_id:this.selected_label.id,syslanguage:s})},LanguageLabelManagerComponent.prototype.getMissingLanguages=function(e){void 0===e&&(e=null),e=e||this.translation_scope;for(var t=[],s=function(s){l.translations.find(function(e){return e.syslanguage==s.language})||t.push(s)},l=this,i=0,a=this.languages;i<a.length;i++){s(a[i])}return t},LanguageLabelManagerComponent.prototype.addLabel=function(){var s=this,e={id:this.utils.generateGuid(),name:"",scope:"custom",custom_translations:[],global_translations:[]};e.custom_translations.push({id:this.utils.generateGuid(),syslanguagelabel_id:e.id,syslanguage:this.language.languagedata.languages.default}),this.selected_label=e,this.labels.push(e),this.modalservice.openModal("LanguageLabelModal").subscribe(function(e){e.instance.label=s.selected_label,e.instance.label$.subscribe(function(e){s.selected_label=e}),e.instance.close$.subscribe(function(e){s.closeModal(e)})})},LanguageLabelManagerComponent.prototype.deleteLabel=function(t){var l=this;this.modalservice.confirm(this.language.getLabel("LBL_DELETE_LABEL_TEXT"),this.language.getLabel("LBL_DELETE_LABEL_TITLE")).subscribe(function(e){e&&l.backend.deleteRequest("configuration/syslanguages/labels/"+t.id+"/"+t.source).subscribe(function(e){for(var s=0;s<l.labels.length;s++){l.labels[s].id==t.id&&l.labels.splice(s,1)}l.selected_label=null})})},LanguageLabelManagerComponent.prototype.save=function(){var t=this;this.backend.postRequest("configuration/syslanguages/labels",null,[this.selected_label]).subscribe(function(e){var s=t.getcurrentLanguageTranslations();t.language.addLabel(t.selected_label.name,s.default,s.short,s.long),t.toast.sendToast("Label saved!")})},LanguageLabelManagerComponent.prototype.getcurrentLanguageTranslations=function(){var s=this,e=this.translations,t={default:"",short:"",long:""};return e.some(function(e){if(e.syslanguage==s.language.currentlanguage)return t.default=e.translation_default,t.short=e.translation_short,t.long=e.translation_long,!0}),t},LanguageLabelManagerComponent.prototype.closeModal=function(e){switch(e){case"cancel":for(var s=0;s<this.labels.length;s++){var t=this.labels[s];""!=t.name&&t.id!=this.selected_label.id||this.labels.splice(s,1)}break;case"save":this.translation_scope=this.selected_label.scope}},LanguageLabelManagerComponent.prototype.sortTranslations=function(e,s){return e.syslanguage==this.language.languagedata.languages.default||e.syslanguage<s.syslanguage?-1:e.syslanguage>s.syslanguage?1:0},LanguageLabelManagerComponent.prototype.getLangText=function(e){return this.language.getLangText(e)},LanguageLabelManagerComponent.prototype.filesToDB=function(){var t=this;this.modalservice.confirm("Transfering custom labels from language files will change your database content and might destroy/overwrite existing language data in your database! Do you really want to do this?","Caution!","warning").subscribe(function(e){if(e){var s=t.modalservice.await("Transfering language data from files to database â¦");t.backend.postRequest("configuration/syslanguages/filesToDB",{},{confirmed:!0}).subscribe(function(e){s.emit(),t.modalservice.info("Language data successfully transfered ("+e.countLabels+" labels with "+e.countTranslations+" translations). Look into console for more details.","Done","success"),console.info(e)},function(e){s.emit(),t.toast.sendToast("Error transfering language data.","error")})}})},LanguageLabelManagerComponent=__decorate([core_1.Component({selector:"language-label-manager",template:'<div class="slds-grid slds-form--inline slds-p-around--small slds-border--bottom"><div class="slds-form-element"><div class="slds-form-element__control"><input type="search" class="slds-input" [(ngModel)]="search_term" placeholder="search here..." (keyup.enter)="search()"></div><button class="slds-button slds-button--neutral" [disabled]="!search_term" (click)="search()">search</button></div><div class="slds-grid slds-grid--vertical-align-center slds-m-horizontal--xx-small" style="cursor: pointer"><div class="slds-truncate slds-grow slds-align-middle"><system-label label="LBL_ENABLE_INLINE_EDIT"></system-label></div><div class="slds-form-element"><label class="slds-checkbox_toggle slds-grid"><span class="slds-form-element__label slds-m-bottom_none"></span> <input type="checkbox" [(ngModel)]="language.inlineEditEnabled"> <span class="slds-checkbox_faux_container" aria-live="assertive"><span class="slds-checkbox_faux" style="cursor: initial"></span></span></label></div></div><div *ngIf="true" class="slds-form-element slds-col--bump-left"><div class="slds-button-group" role="group"><button type="button" class="slds-button slds-button--neutral" (click)="addLabel()"><system-label label="LBL_ADD"></system-label></button></div></div><div *ngIf="sessionservice.isAdmin"><button type="button" class="slds-button slds-button--neutral" (click)="filesToDB()">Files to DB</button></div></div><system-spinner *ngIf="is_searching"></system-spinner><div *ngIf="labels.length > 0 && !is_searching" class="slds-grid"><div class="slds-size--2-of-5 slds-p-around--small"><div class="slds-grid slds-grid--vertical-align-center"><h2 class="slds-p-vertical--small slds-text-heading--small"><system-label label="LBL_LABELS"></system-label>:</h2><div class="slds-col--bump-left"><pagination-controls [(page)]="page" [limit]="20" [total_records]="labels.length" [variation]="\'short\'"></pagination-controls></div></div><article><div class="slds-card slds-m-bottom--small"><div class="slds-card__body slds-p-around--small"><ul class="slds-has-dividers_bottom-space"><li *ngFor="let lbl of labels | paginate: {page: page, limit: 20}" class="slds-item" [ngClass]="{\'slds-theme_inverse\': lbl == selected_label}" style="cursor: pointer;" (click)="selected_label = lbl"><div class="slds-grid slds-grid--vertical-align-center"><span>{{lbl.name}}</span> <span *ngIf="lbl.scope == \'custom\'" class="slds-text-color_weak">custom</span><div class="slds-col--bump-left"><system-utility-icon *ngIf="lbl == selected_label" [icon]="\'close\'" [size]="\'xx-small\'" (click)="deleteLabel(lbl)"></system-utility-icon></div></div></li></ul></div><div class="slds-card__footer"><pagination-controls [(page)]="page" [limit]="20" [total_records]="labels.length"></pagination-controls></div></div></article></div><div *ngIf="selected_label" class="slds-size--3-of-5 slds-p-around--small"><div class="slds-grid slds-grid--vertical-align-center slds-p-bottom--small"><h2 class="slds-p-vertical--small slds-text-heading--small"><system-label label="LBL_TRANSLATIONS"></system-label>:</h2><div class="slds-grid slds-col--bump-left"><span class="slds-radio"><input type="radio" name="translation_scope" [(ngModel)]="translation_scope" id="translation_scope_global" value="global" [disabled]="selected_label.scope == \'custom\'"> <label class="slds-radio__label" for="translation_scope_global"><span class="slds-radio_faux"></span> <span class="slds-form-element__label">global</span></label></span> <span class="slds-radio"><input type="radio" name="translation_scope" [(ngModel)]="translation_scope" id="translation_scope_custom" value="custom"> <label class="slds-radio__label" for="translation_scope_custom"><span class="slds-radio_faux"></span> <span class="slds-form-element__label">custom</span></label></span></div></div><article *ngFor="let trans of translations"><div class="slds-card slds-m-bottom--small"><div class="slds-card__header"><h2>{{getLangText(trans.syslanguage)}}</h2></div><div class="slds-card__body slds-p-around--small"><div class="slds-form-element"><label>short:</label> <input type="text" class="slds-input" [(ngModel)]="trans.translation_short"></div><div class="slds-form-element"><label><abbr class="slds-required">*</abbr>default:</label> <input type="text" class="slds-input" required [(ngModel)]="trans.translation_default"></div><div class="slds-form-element"><label>long:</label> <textarea class="slds-textarea" [(ngModel)]="trans.translation_long"></textarea></div></div></div></article><div class="slds-grid"><div *ngIf="languages.length > translations.length" class="slds-grid"><div class="slds-form-element__control slds-p-right--x-small"><div class="slds-select_container"><select class="slds-select" #add_translation_language><option *ngFor="let lang of getMissingLanguages()" value="{{lang.language}}">{{lang.text}}</option></select></div></div><button class="slds-button slds-button--neutral" title="{{language.getLabel(\'LBL_ADD_TRANSLATION\')}}..." (click)="addTranslation(translation_scope, add_translation_language.value)"><system-label label="LBL_ADD"></system-label></button></div><div class="slds-col--bump-left"><button type="button" class="slds-button slds-button--brand" [disabled]="labels.length < 1" (click)="save()"><system-label label="LBL_SAVE"></system-label></button></div></div></div></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.metadata,services_1.language,services_1.modelutilities,services_1.toast,services_1.footer,services_1.modal,services_1.session])],LanguageLabelManagerComponent)}();exports.LanguageLabelManagerComponent=LanguageLabelManagerComponent;var SortPipe=function(){function e(){}return e.prototype.transform=function(e,s){return void 0===s&&(s=function(e,s){return s<e?1:-1}),e.sort(s)},e=__decorate([core_1.Pipe({name:"sort"})],e)}();exports.SortPipe=SortPipe;var LanguageLabelModal=function(){function LanguageLabelModal(e,s,t){this.utils=e,this.language=s,this.backend=t,this.label={},this.label$=new core_1.EventEmitter,this.close$=new core_1.EventEmitter,this.languages=[],this.languages=this.language.getAvialableLanguages(!0)}return Object.defineProperty(LanguageLabelModal.prototype,"translations",{get:function(){return this.label[this.label.scope+"_translations"]||[]},set:function(e){this.label[this.label.scope+"_translations"]=e},enumerable:!1,configurable:!0}),Object.defineProperty(LanguageLabelModal.prototype,"name",{get:function(){return this.label?this.label.name:""},set:function(e){e=e.toUpperCase().trim().replace("-","_"),this.label.name=e},enumerable:!1,configurable:!0}),Object.defineProperty(LanguageLabelModal.prototype,"scope",{get:function(){return this.label?this.label.scope:""},set:function(e){this.label[e+"_translations"]=this.translations,this.translations=[],this.label.scope=e},enumerable:!1,configurable:!0}),LanguageLabelModal.prototype.validate=function(){if(!this.label.name)return!1;if(/[^A-Z_0-9]/.test(this.label.name))return!1;for(var e=0,s=this.translations;e<s.length;e++){if(!s[e].translation_default)return!1}return!0},LanguageLabelModal.prototype.save=function(){var t=this;if(this.label.name=this.label.name.toUpperCase(),!this.validate())return!1;this.backend.postRequest("configuration/syslanguages/labels",null,[this.label]).subscribe(function(e){t.label$.emit(t.label),t.close$.emit("save");var s=t.getcurrentLanguageTranslations();t.language.addLabel(t.label.name,s.default,s.short,s.long),t.self&&t.self.destroy()})},LanguageLabelModal.prototype.getcurrentLanguageTranslations=function(){var s=this,e=this.translations,t={default:"",short:"",long:""};return e.some(function(e){if(e.syslanguage==s.language.currentlanguage)return t.default=e.translation_default,t.short=e.translation_short,t.long=e.translation_long,!0}),t},LanguageLabelModal.prototype.cancelDialog=function(){this.label={},this.label$.emit(null),this.close$.emit("cancel"),this.self.destroy()},LanguageLabelModal.prototype.onModalEscX=function(){this.cancelDialog()},LanguageLabelModal.prototype.addTranslation=function(e){void 0===e&&(e=null),e||(e=this.getMissingLanguages()[0]);this.label[this.label.scope+"_translations"].push({id:this.utils.generateGuid(),syslanguagelabel_id:this.label.id,syslanguage:e})},LanguageLabelModal.prototype.getMissingLanguages=function(e){void 0===e&&(e=null),e=e||this.scope;for(var t=[],s=function(s){l.translations.find(function(e){return e.syslanguage==s.language})||t.push(s)},l=this,i=0,a=this.languages;i<a.length;i++){s(a[i])}return t},LanguageLabelModal.prototype.getLangText=function(e){return this.language.getLangText(e)},__decorate([core_1.Input(),__metadata("design:type",Object)],LanguageLabelModal.prototype,"label",void 0),__decorate([core_1.Output("label"),__metadata("design:type",Object)],LanguageLabelModal.prototype,"label$",void 0),__decorate([core_1.Output("close"),__metadata("design:type",Object)],LanguageLabelModal.prototype,"close$",void 0),LanguageLabelModal=__decorate([core_1.Component({selector:"language-label-modal",template:'<system-modal size="large"><system-modal-header (close)="cancelDialog()"><system-label label="LBL_EDIT"></system-label></system-modal-header><system-modal-content><div class="slds-grid"><div class="slds-form-element slds-size--3-of-4"><label><abbr class="slds-required">*</abbr><system-label label="LBL_NAME"></system-label>:</label> <input type="text" class="slds-input" [(ngModel)]="name" placeholder="only A-Z, 0-9 and _ are allowed!"></div><div class="slds-form-element slds-size--1-of-4 slds-p-around--small"><div class="slds-form-element__control"><span class="slds-radio"><input type="radio" id="radio-3" [(ngModel)]="scope" value="global"> <label class="slds-radio__label" for="radio-3"><span class="slds-radio_faux"></span> <span class="slds-form-element__label">global</span></label></span> <span class="slds-radio"><input type="radio" id="radio-4" [(ngModel)]="scope" value="custom"> <label class="slds-radio__label" for="radio-4"><span class="slds-radio_faux"></span> <span class="slds-form-element__label">custom</span></label></span></div></div></div><div><h2><system-label label="LBL_TRANSLATIONS"></system-label>:</h2><article *ngFor="let trans of translations"><div class="slds-card slds-m-bottom--small"><div class="slds-card__header"><h2>{{getLangText(trans.syslanguage)}}</h2></div><div class="slds-card__body slds-p-around--small"><div class="slds-form-element"><label>short:</label> <input type="text" class="slds-input" [(ngModel)]="trans.translation_short"></div><div class="slds-form-element"><label><abbr class="slds-required">*</abbr>default:</label> <input type="text" class="slds-input" required [(ngModel)]="trans.translation_default"></div><div class="slds-form-element"><label>long:</label> <textarea class="slds-textarea" [(ngModel)]="trans.translation_long"></textarea></div></div></div></article><div *ngIf="languages.length > translations.length" class="slds-grid"><div class="slds-form-element__control slds-p-right--x-small"><div class="slds-select_container"><select class="slds-select" #add_translation_language><option *ngFor="let lang of getMissingLanguages()" value="{{lang.language}}">{{lang.text}}</option></select></div></div><button class="slds-button slds-button--neutral" title="{{language.getLabel(\'LBL_ADD_TRANSLATION\')}}..." (click)="addTranslation(add_translation_language.value)"><system-label label="LBL_ADD"></system-label></button></div></div></system-modal-content><system-modal-footer><button class="slds-button slds-button--neutral" (click)="cancelDialog()"><system-label label="LBL_CANCEL"></system-label></button> <button class="slds-button slds-button--brand" [disabled]="!validate()" (click)="save()"><system-label label="LBL_SAVE"></system-label></button></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[services_1.modelutilities,services_1.language,services_1.backend])],LanguageLabelModal)}();exports.LanguageLabelModal=LanguageLabelModal;var MailboxesManager=function(){function MailboxesManager(e,s,t,l,i,a,o,n,d,r,c){var m=this;this.modellist=e,this.backend=s,this.footer=t,this.language=l,this.metadata=i,this.model=a,this.modelutils=o,this.modelutilities=n,this.toast=d,this.view=r,this.configuration=c,this.renderedview=[],this.modellist.initialize("Mailboxes"),this.modellist.getListData(),this.model.module="Mailboxes",this.view.isEditable=!0,this.configuration.getData("mailboxtransports")||(this.configuration.setData("mailboxtransports",[]),this.backend.getRequest("module/Mailboxes/transports").subscribe(function(e){m.configuration.setData("mailboxtransports",e)}));var u=this.metadata.getComponentConfig("MailboxesManager","Mailboxes");this.headeractionset=u.actionset}var e;return Object.defineProperty(MailboxesManager.prototype,"mailboxes",{get:function(){return this.modellist.listData.list.sort(function(e,s){return e.name.localeCompare(s.name)})},enumerable:!1,configurable:!0}),Object.defineProperty(MailboxesManager.prototype,"selected_mailbox",{get:function(){return this.model.id},set:function(s){var t=this;this.modellist.listData.list.find(function(e){return e.id==s})?(this._selected_mailbox=s,this.model.id=s,this.model.getData(),this.cleanView(),this.renderedview=[],this.metadata.addComponent("ObjectRecordDetails",this.viewcontainer).subscribe(function(e){t.renderedview.push(e)}),this.metadata.addComponent("ObjectRelateContainer",this.viewcontainer).subscribe(function(e){t.renderedview.push(e)})):(this.cleanView(),this._selected_mailbox=null,this.model.id="",this.model.initialize())},enumerable:!1,configurable:!0}),MailboxesManager.prototype.cleanView=function(){for(var e=0,s=this.renderedview;e<s.length;e++){s[e].destroy()}},MailboxesManager.prototype.reset=function(){this.view.setViewMode(),this.model.reset(),this.model.module="Mailboxes"},MailboxesManager.prototype.setAsDefault=function(){var s=this;this.backend.postRequest("module/Mailboxes/default",null,{mailbox_id:this.model.data.id}).subscribe(function(e){s.toast.sendToast(e),s.model.setField("is_default",!0)},function(e){console.log(e)})},__decorate([core_1.ViewChild("viewcontainer",{read:core_1.ViewContainerRef,static:!0}),__metadata("design:type","function"==typeof(e=void 0!==core_1.ViewContainerRef&&core_1.ViewContainerRef)?e:Object)],MailboxesManager.prototype,"viewcontainer",void 0),MailboxesManager=__decorate([core_1.Component({providers:[services_1.modellist,services_1.model,services_1.view],selector:"mailboxes-manager",template:'<div class="slds-grid slds-form--inline slds-p-around--small slds-border--bottom"><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_MAILBOX"></system-label></label><div class="slds-form-element__control" style="min-width:250px;"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="selected_mailbox"><option>--</option><option *ngFor="let mailbox of mailboxes" [value]="mailbox.id">{{mailbox.name}}</option></select></div></div></div><div class="slds-form-element slds-col--bump-left"><object-action-container [actionset]="headeractionset"></object-action-container></div></div><div system-to-bottom class="slds-p-horizontal--small"><div #viewcontainer></div></div>'}),__metadata("design:paramtypes",[services_1.modellist,services_1.backend,services_1.footer,services_1.language,services_1.metadata,services_1.model,services_1.modelutilities,services_1.modelutilities,services_1.toast,services_1.view,services_1.configurationService])],MailboxesManager)}();exports.MailboxesManager=MailboxesManager;var MailboxesTransportsEnum=function(n){function MailboxesTransportsEnum(e,s,t,l,i,a){var o=n.call(this,e,s,t,l,i)||this;return o.model=e,o.view=s,o.language=t,o.metadata=l,o.router=i,o.configuration=a,o}var e;return __extends(MailboxesTransportsEnum,n),MailboxesTransportsEnum.prototype.getValue=function(){var s=this,e=this.configuration.getData("mailboxtransports").find(function(e){return e.name==s.value});return e?this.language.getLabel(e.label):this.value},Object.defineProperty(MailboxesTransportsEnum.prototype,"transportoptions",{get:function(){return this.configuration.getData("mailboxtransports")},enumerable:!1,configurable:!0}),MailboxesTransportsEnum=__decorate([core_1.Component({template:'<field-label *ngIf="displayLabel" [fieldname]="fieldname" [fieldconfig]="fieldconfig"></field-label><field-generic-display *ngIf="!isEditMode()" [fielddisplayclass]="fielddisplayclass" [editable]="isEditable()" [fieldconfig]="fieldconfig" [fieldid]="fieldid">{{getValue()}}</field-generic-display><div *ngIf="isEditMode()" class="slds-form-element"><div class="slds-form-element__control" [ngClass]="getFieldClass()"><div class="slds-select_container slds-m-vertical--xx-small"><select #focus class="slds-select" [(ngModel)]="value"><option *ngFor="let o of transportoptions" [value]="o.name"><system-label [label]="o.label"></system-label></option></select></div><field-messages [fieldname]="fieldname"></field-messages></div></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.view,services_1.language,services_1.metadata,"function"==typeof(e=void 0!==router_1.Router&&router_1.Router)?e:Object,services_1.configurationService])],MailboxesTransportsEnum)}(objectfields_1.fieldGeneric);exports.MailboxesTransportsEnum=MailboxesTransportsEnum;var MailboxesmanagerTestModal=function(){function MailboxesmanagerTestModal(e,s,t,l){this.backend=e,this.language=s,this.model=t,this.session=l,this.self={},this.validConnection=!1,this.isvalid=new core_1.EventEmitter,this.testemailaddress="",this.testing=!1,this.tested=!1,this.testtype="email"}return MailboxesmanagerTestModal.prototype.ngOnInit=function(){switch(this.testtype){case"sms":break;default:this.testemailaddress=this.session.authData.email}},MailboxesmanagerTestModal.prototype.testConnection=function(){var s=this;this.testing=!0,this.testemailaddress=this.testemailaddress.trim();var e=this.model.utils.spiceModel2backend("Mailboxes",this.model.data);this.backend.postRequest("module/Mailboxes/test",{},{data:e,test_email:this.testemailaddress}).subscribe(function(e){!0===e.result?s.validConnection=!0:s.validConnection=!1,s.tested=!0,s.testing=!1},function(e){s.tested=!1,s.testing=!1,s.validConnection=!1})},MailboxesmanagerTestModal.prototype.close=function(){this.isvalid.emit(this.validConnection),this.self.destroy()},MailboxesmanagerTestModal.prototype.onModalEscX=function(){this.close()},Object.defineProperty(MailboxesmanagerTestModal.prototype,"testtypelabel",{get:function(){return this.language.getLabel("email"==this.testtype?"LBL_EMAIL":"LBL_SMS")},enumerable:!1,configurable:!0}),MailboxesmanagerTestModal=__decorate([core_1.Component({template:'<system-modal><system-modal-header (close)="close()"><system-label label="LBL_TEST"></system-label> {{testtypelabel}}</system-modal-header><system-modal-content><div class="slds-form-element slds-size--1-of-1"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_DESTINATION_ADDRESS"></system-label></label> <input type="text" [disabled]="testing" [(ngModel)]="testemailaddress" class="slds-input"></div></system-modal-content><system-modal-footer><div class="slds-grid slds-grid--vertical-align-center"><div *ngIf="testing" class="slds-grid slds-grid--vertical-align-center"><system-spinner size="10"></system-spinner><span class="slds-p-horizontal--xx-small"><system-label label="LBL_TESTING"></system-label></span></div><div *ngIf="!testing && validConnection" class="slds-grid slds-grid--vertical-align-center"><system-utility-icon icon="check" size="x-small"></system-utility-icon><span class="slds-p-horizontal--xx-small"><system-label label="LBL_OK"></system-label></span></div><button [disabled]="!validConnection" class="slds-button slds-col--bump-left slds-button--neutral" (click)="close()"><system-label label="LBL_CLOSE"></system-label></button> <button [disabled]="testemailaddress.trim().length === 0" class="slds-button slds-button--brand" (click)="testConnection()"><system-label label="LBL_TEST"></system-label></button></div></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[services_1.backend,services_1.language,services_1.model,services_1.session])],MailboxesmanagerTestModal)}();exports.MailboxesmanagerTestModal=MailboxesmanagerTestModal;var MailboxesmanagerTestIMAPModal=function(){function MailboxesmanagerTestIMAPModal(e,s,t,l){this.backend=e,this.language=s,this.model=t,this.session=l,this.self={},this.validConnection=!1,this.isvalid=new core_1.EventEmitter,this.testemailaddress="",this.imapStatus=!1,this.smtpStatus=!1,this.testing=!1,this.tested=!1,this.testemailaddress=this.session.authData.email}return Object.defineProperty(MailboxesmanagerTestIMAPModal.prototype,"isInbound",{get:function(){return!!this.model.getFieldValue("inbound_comm")},enumerable:!1,configurable:!0}),Object.defineProperty(MailboxesmanagerTestIMAPModal.prototype,"isOutbound",{get:function(){var e=this.model.getFieldValue("outbound_comm");return!(!e||"no"==e)},enumerable:!1,configurable:!0}),MailboxesmanagerTestIMAPModal.prototype.testConnection=function(){var s=this;this.testing=!0;var e=this.model.utils.spiceModel2backend("Mailboxes",this.model.data);this.backend.postRequest("module/Mailboxes/test",{},{data:e,test_email:this.testemailaddress}).subscribe(function(e){s.validConnection=!0,s.isInbound&&(!0!==e.imap.result&&(s.validConnection=!1),e.imap.errors&&0<e.imap.errors.length?s.imapStatus=!1:s.imapStatus=!0),s.isOutbound&&(e.smtp.errors&&0<e.smtp.errors.length?(s.smtpStatus=!1,s.validConnection=!1):s.smtpStatus=!0),s.tested=!0,s.testing=!1},function(e){s.testing=!1})},MailboxesmanagerTestIMAPModal.prototype.cancel=function(){this.self.destroy()},MailboxesmanagerTestIMAPModal.prototype.close=function(){this.isvalid.emit(this.validConnection),this.self.destroy()},Object.defineProperty(MailboxesmanagerTestIMAPModal.prototype,"imapIcon",{get:function(){return this.imapStatus?"check":"close"},enumerable:!1,configurable:!0}),Object.defineProperty(MailboxesmanagerTestIMAPModal.prototype,"smtpIcon",{get:function(){return this.smtpStatus?"check":"close"},enumerable:!1,configurable:!0}),MailboxesmanagerTestIMAPModal=__decorate([core_1.Component({template:'<system-modal><system-modal-header (close)="close()"></system-modal-header><system-modal-content><div *ngIf="isOutbound" class="slds-form-element slds-size--1-of-1"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_TEST_EMAIL"></system-label></label> <input type="text" [(ngModel)]="testemailaddress" class="slds-input"></div><div class="slds-p-vertical--x-small"><div *ngIf="isInbound" class="slds-grid slds-grid--align-spread slds-grid_vertical-align-center slds-p-vertical--xxx-small"><div><system-label label="LBL_IMAP"></system-label></div><system-utility-icon size="xx-small" [icon]="imapIcon"></system-utility-icon></div><div *ngIf="isOutbound" class="slds-grid slds-grid--align-spread slds-grid_vertical-align-center slds-p-vertical--xxx-small"><div><system-label label="LBL_SMTP"></system-label></div><system-utility-icon size="xx-small" [icon]="smtpIcon"></system-utility-icon></div></div></system-modal-content><system-modal-footer><div class="slds-grid slds-grid--vertical-align-center"><div *ngIf="testing" class="slds-grid slds-grid--vertical-align-center"><system-spinner size="10"></system-spinner><span class="slds-p-horizontal--xx-small"><system-label label="LBL_TESTING"></system-label></span></div><div *ngIf="!testing && validConnection" class="slds-grid slds-grid--vertical-align-center"><system-utility-icon icon="check" size="x-small"></system-utility-icon><span class="slds-p-horizontal--xx-small"><system-label label="LBL_OK"></system-label></span></div><button class="slds-col--bump-left slds-button slds-button--neutral" (click)="testConnection()"><system-label label="LBL_TEST"></system-label></button> <button class="slds-button slds-button--neutral" (click)="cancel()"><system-label label="LBL_CANCEL"></system-label></button> <button [disabled]="!validConnection" class="slds-button slds-button--brand" (click)="close()"><system-label label="LBL_OK"></system-label></button></div></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[services_1.backend,services_1.language,services_1.model,services_1.session])],MailboxesmanagerTestIMAPModal)}();exports.MailboxesmanagerTestIMAPModal=MailboxesmanagerTestIMAPModal;var MailboxesGmailTrafficManager=function(){function MailboxesGmailTrafficManager(e,s,t,l,i,a,o){this.backend=e,this.language=s,this.model=t,this.modal=l,this.toast=i,this.view=a,this.injector=o;var n=this.model.getField("settings");(!n||n&&0==n.length)&&this.model.setField("settings",{gmail_user_name:"",gmail_email_address:"",gmail_delete_emails:!1})}var e;return Object.defineProperty(MailboxesGmailTrafficManager.prototype,"isInbound",{get:function(){return!!this.model.getFieldValue("inbound_comm")},enumerable:!1,configurable:!0}),Object.defineProperty(MailboxesGmailTrafficManager.prototype,"isOutbound",{get:function(){return"no"!=this.model.getFieldValue("outbound_comm")},enumerable:!1,configurable:!0}),MailboxesGmailTrafficManager.prototype.getMailboxes=function(){var s=new rxjs_1.Subject,e=this.model.utils.spiceModel2backend("Mailboxes",this.model.data);return this.backend.postRequest("module/Mailboxes/gmail/labels",{},{data:e}).subscribe(function(e){!0===e.result?s.next(e):s.next(!1),s.complete()}),s.asObservable()},MailboxesGmailTrafficManager.prototype.testConnection=function(){this.modal.openModal("MailboxesmanagerTestModal",!0,this.injector)},MailboxesGmailTrafficManager=__decorate([core_1.Component({selector:"mailboxes-gmail-traffic-manager",template:'<div class="slds-m-vertical--xx-small slds-box--border"><div class="slds-p-around--x-small"><h1><system-label label="LBL_GMAIL"></system-label></h1><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_EMAIL_ADDRESS"></system-label></label> <input type="text" [(ngModel)]="model.data.settings.gmail_email_address" class="slds-input" [disabled]="!view.isEditMode()"></div><div class="slds-form-element slds-size--1-of-2 slds-p-left--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_USER_NAME"></system-label></label> <input type="text" [(ngModel)]="model.data.settings.gmail_user_name" class="slds-input" [disabled]="!view.isEditMode()"></div></div><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><system-checkbox [disabled]="!view.isEditMode()" [(ngModel)]="model.data.settings.gmail_delete_emails"><system-label label="LBL_DELETE_REMOTE"></system-label></system-checkbox></div></div><div class="slds-grid slds-p-vertical--xx-small"><button type="button" class="slds-col--bump-left slds-button slds-button--neutral" (click)="testConnection()" [disabled]="!view.isEditMode()"><system-label label="LBL_TEST_CONNECTION"></system-label></button></div></div></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.language,services_1.model,services_1.modal,services_1.toast,services_1.view,"function"==typeof(e=void 0!==core_1.Injector&&core_1.Injector)?e:Object])],MailboxesGmailTrafficManager)}();exports.MailboxesGmailTrafficManager=MailboxesGmailTrafficManager;var MailboxesMailgunTrafficManager=function(){function MailboxesMailgunTrafficManager(e,s,t,l,i){this.language=e,this.injector=s,this.model=t,this.modal=l,this.view=i;var a=this.model.getField("settings");(!a||a&&0==a.length)&&(this.model.data.settings={api_key:"",domain:"",imap_pop3_display_name:"",imap_pop3_username:"",reply_to:"",region:""})}var e;return MailboxesMailgunTrafficManager.prototype.testConnection=function(){this.modal.openModal("MailboxesmanagerTestModal",!0,this.injector)},MailboxesMailgunTrafficManager=__decorate([core_1.Component({selector:"mailboxes-mailgun-traffic-manager",template:'<div class="slds-m-vertical--xx-small slds-box--border"><div class="slds-p-around--x-small"><h1><system-label label="LBL_MAILGUN"></system-label></h1><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_DISPLAY_NAME"></system-label></label> <input type="text" [disabled]="!view.isEditMode()" [(ngModel)]="model.data.settings.imap_pop3_display_name" class="slds-input"></div><div class="slds-form-element slds-size--1-of-2 slds-p-left--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_DOMAIN"></system-label></label> <input type="text" [(ngModel)]="model.data.settings.domain" class="slds-input ng-pristine" [disabled]="!view.isEditMode()"></div></div><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_USER_NAME"></system-label></label> <input type="text" [(ngModel)]="model.data.settings.imap_pop3_username" class="slds-input" [disabled]="!view.isEditMode()"></div><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_REPLY_TO"></system-label></label> <input type="text" [disabled]="!view.isEditMode()" [(ngModel)]="model.data.settings.reply_to" class="slds-input"></div></div><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_REGION"></system-label></label><select type="text" [disabled]="!view.isEditMode()" [(ngModel)]="model.data.settings.region" class="slds-select"><option value="eu"><system-label label="LBL_EU"></system-label></option><option value="us"><system-label label="LBL_USA"></system-label></option></select></div><div class="slds-form-element slds-size--1-of-2 slds-p-left--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_API_KEY"></system-label></label><system-input-password [(ngModel)]="model.data.settings.api_key" [disabled]="!view.isEditMode()"></system-input-password></div></div><div class="slds-grid slds-p-vertical--xx-small"><button type="button" class="slds-col--bump-left slds-button slds-button--neutral" (click)="testConnection()" [disabled]="!view.isEditMode()"><system-label label="LBL_TEST_CONNECTION"></system-label></button></div></div></div>'}),__metadata("design:paramtypes",[services_1.language,"function"==typeof(e=void 0!==core_1.Injector&&core_1.Injector)?e:Object,services_1.model,services_1.modal,services_1.view])],MailboxesMailgunTrafficManager)}();exports.MailboxesMailgunTrafficManager=MailboxesMailgunTrafficManager;var MailboxesSendgridTrafficManager=function(){function MailboxesSendgridTrafficManager(e,s,t,l,i){this.language=e,this.model=s,this.modal=t,this.view=l,this.injector=i;var a=this.model.getField("settings");(!a||a&&0==a.length)&&(this.model.data.settings={api_key:"",imap_pop3_display_name:"",imap_pop3_username:"",reply_to:""})}var e;return MailboxesSendgridTrafficManager.prototype.testConnection=function(){this.modal.openModal("MailboxesmanagerTestModal",!0,this.injector)},MailboxesSendgridTrafficManager=__decorate([core_1.Component({selector:"mailboxes-sendgrid-traffic-manager",template:'<div class="slds-m-vertical--xx-small slds-box--border"><div class="slds-p-around--x-small"><h1><system-label label="LBL_SENDGRID"></system-label></h1><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_DISPLAY_NAME"></system-label></label> <input type="text" [disabled]="!view.isEditMode()" [(ngModel)]="model.data.settings.imap_pop3_display_name" class="slds-input ng-pristine ng-valid"></div><div class="slds-form-element slds-size--1-of-2 slds-p-left--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_REPLY_TO"></system-label></label> <input type="text" [disabled]="!view.isEditMode()" [(ngModel)]="model.data.settings.reply_to" class="slds-input ng-pristine ng-valid"></div></div><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_USER_NAME"></system-label></label> <input type="text" [disabled]="!view.isEditMode()" [(ngModel)]="model.data.settings.imap_pop3_username" class="slds-input ng-pristine ng-valid"></div><div class="slds-form-element slds-size--1-of-2 slds-p-left--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_API_KEY"></system-label></label><system-input-password [disabled]="!view.isEditMode()" [(ngModel)]="model.data.settings.api_key"></system-input-password></div></div><div class="slds-grid slds-p-vertical--xx-small"><button type="button" class="slds-col--bump-left slds-button slds-button--neutral" (click)="testConnection()" [disabled]="!view.isEditMode()"><system-label label="LBL_SEND_TEST_EMAIL"></system-label></button></div></div></div>'}),__metadata("design:paramtypes",[services_1.language,services_1.model,services_1.modal,services_1.view,"function"==typeof(e=void 0!==core_1.Injector&&core_1.Injector)?e:Object])],MailboxesSendgridTrafficManager)}();exports.MailboxesSendgridTrafficManager=MailboxesSendgridTrafficManager;var MailboxesTwillioTrafficManager=function(){function MailboxesTwillioTrafficManager(e,s,t,l,i){this.language=e,this.model=s,this.modal=t,this.view=l,this.injector=i;var a=this.model.getField("settings");(!a||a&&0==a.length)&&(this.model.data.settings={account_sid:"",auth_token:"",phone_number_from:""})}var e;return MailboxesTwillioTrafficManager.prototype.testConnection=function(){this.modal.openModal("MailboxesmanagerTestModal",!0,this.injector)},MailboxesTwillioTrafficManager=__decorate([core_1.Component({selector:"mailboxes-twillio-traffic-manager",template:'<div class="slds-m-vertical--xx-small slds-box--border"><div class="slds-p-around--x-small"><h1><system-label label="LBL_TWILLIO"></system-label></h1><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-3 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_ACCOUNT_SID"></system-label></label><system-input-password [disabled]="!view.isEditMode()" [(ngModel)]="model.data.settings.account_sid"></system-input-password></div><div class="slds-form-element slds-size--1-of-3 slds-p-left--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_AUTH_TOKEN"></system-label></label><system-input-password [disabled]="!view.isEditMode()" [(ngModel)]="model.data.settings.auth_token"></system-input-password></div><div class="slds-form-element slds-size--1-of-3 slds-p-left--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_PHONE_NUMBER_FROM"></system-label></label> <input type="text" [disabled]="!view.isEditMode()" [(ngModel)]="model.data.settings.phone_number_from" class="slds-input"></div></div><div class="slds-grid slds-p-vertical--xx-small"><button type="button" class="slds-col--bump-left slds-button slds-button--neutral" (click)="testConnection()" [disabled]="!view.isEditMode()"><system-label label="LBL_SEND_TEST_SMS"></system-label></button></div></div></div>'}),__metadata("design:paramtypes",[services_1.language,services_1.model,services_1.modal,services_1.view,"function"==typeof(e=void 0!==core_1.Injector&&core_1.Injector)?e:Object])],MailboxesTwillioTrafficManager)}();exports.MailboxesTwillioTrafficManager=MailboxesTwillioTrafficManager;var MailboxesA1SmsTrafficManager=function(){function MailboxesA1SmsTrafficManager(e,s,t,l,i){this.language=e,this.model=s,this.modal=t,this.view=l,this.injector=i;var a=this.model.getField("settings");(!a||a&&0==a.length)&&(this.model.data.settings={a1_username:"",a1_password:"",a1_sender:""})}var e;return MailboxesA1SmsTrafficManager.prototype.testConnection=function(){this.modal.openModal("MailboxesmanagerTestModal",!0,this.injector)},MailboxesA1SmsTrafficManager=__decorate([core_1.Component({selector:"mailboxes-a1sms-traffic-manager",template:'<div class="slds-m-vertical--xx-small slds-box--border"><div class="slds-p-around--x-small"><h1><system-label label="LBL_A1"></system-label></h1><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-3 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_USERNAME"></system-label></label><system-input-password [disabled]="!view.isEditMode()" [(ngModel)]="model.data.settings.a1_username"></system-input-password></div><div class="slds-form-element slds-size--1-of-3 slds-p-left--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_PASSWORD"></system-label></label><system-input-password [disabled]="!view.isEditMode()" [(ngModel)]="model.data.settings.a1_password"></system-input-password></div><div class="slds-form-element slds-size--1-of-3 slds-p-left--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_SENDER"></system-label></label> <input type="text" [disabled]="!view.isEditMode()" [(ngModel)]="model.data.settings.a1_sender" class="slds-input"></div></div><div class="slds-grid slds-p-vertical--xx-small"><button type="button" class="slds-col--bump-left slds-button slds-button--neutral" (click)="testConnection()" [disabled]="!view.isEditMode()"><system-label label="LBL_SEND_TEST_SMS"></system-label></button></div></div></div>'}),__metadata("design:paramtypes",[services_1.language,services_1.model,services_1.modal,services_1.view,"function"==typeof(e=void 0!==core_1.Injector&&core_1.Injector)?e:Object])],MailboxesA1SmsTrafficManager)}();exports.MailboxesA1SmsTrafficManager=MailboxesA1SmsTrafficManager;var MailboxesA1TrafficManager=function(){function e(e,s,t,l,i,a,o,n){this.metadata=e,this.language=s,this.backend=t,this.model=l,this.modal=i,this.toast=a,this.view=o,this.ViewContainerRef=n}var s;return e.prototype.ngOnInit=function(){0===this.model.data.settings.length&&(this.model.data.settings={api_key:"",imap_pop3_display_name:"",imap_pop3_username:"",reply_to:""})},e.prototype.testConnection=function(){this.modal.openModal("MailboxesmanagerTestModal",!0,this.ViewContainerRef.injector)},e=__decorate([core_1.Component({selector:"mailboxes-a1-traffic-manager",template:'<div class="slds-p-horizontal--medium slds-p-vertical--small"><h1><system-label label="LBL_SMS_GATEWAY"></system-label></h1><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-3 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_CONSUMER_KEY"></system-label></label> <input type="text" [disabled]="!view.isEditMode()" [(ngModel)]="model.data.settings.consumer_key" class="slds-input ng-pristine ng-valid"></div><div class="slds-form-element slds-size--1-of-3 slds-p-left--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_CONSUMER_SECRET"></system-label></label> <input type="text" [disabled]="!view.isEditMode()" [(ngModel)]="model.data.settings.consumer_secret" class="slds-input ng-pristine ng-valid"></div><div class="slds-form-element slds-size--1-of-3 slds-p-left--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_PHONE_NUMBER_FROM"></system-label></label> <input type="text" [disabled]="!view.isEditMode()" [(ngModel)]="model.data.settings.phone_number_from" class="slds-input ng-pristine ng-valid"></div></div><div class="slds-grid slds-p-vertical--xx-small"><button type="button" class="slds-col--bump-left slds-button slds-button--neutral" (click)="testConnection()" [disabled]="valid_connection"><system-label label="LBL_SEND_TEST_EMAIL"></system-label></button></div></div>'}),__metadata("design:paramtypes",[services_1.metadata,services_1.language,services_1.backend,services_1.model,services_1.modal,services_1.toast,services_1.view,"function"==typeof(s=void 0!==core_1.ViewContainerRef&&core_1.ViewContainerRef)?s:Object])],e)}();exports.MailboxesA1TrafficManager=MailboxesA1TrafficManager;var MailboxesEWSTrafficManager=function(){function MailboxesEWSTrafficManager(e,s,t,l,i,a){this.language=e,this.injector=s,this.model=t,this.modal=l,this.view=i,this.backend=a;var o=this.model.getField("settings");(!o||o&&0==o.length)&&(this.model.data.settings={ews_host:"",ews_username:"",ews_password:"",ews_email:"",ews_folder:"",ews_subscriptionid:"",ews_push:!1})}var e;return MailboxesEWSTrafficManager.prototype.testConnection=function(){this.modal.openModal("MailboxesmanagerTestModal",!0,this.injector)},MailboxesEWSTrafficManager.prototype.getMailboxes=function(){var s=new rxjs_1.Subject,e=this.model.utils.spiceModel2backend("Mailboxes",this.model.data);return this.backend.postRequest("module/Mailboxes/ews/folders",{},{data:e}).subscribe(function(e){!0===e.result?s.next(e):s.next(!1),s.complete()}),s.asObservable()},MailboxesEWSTrafficManager.prototype.displayFoldersModal=function(){var e=this,t=this.modal.await("loading folders");this.getMailboxes().subscribe(function(s){t.emit(!0),!1!==s&&e.modal.openModal("MailboxesEWSSelectFoldersModal",!0,e.injector).subscribe(function(e){e.instance.setMailboxes(s.mailboxes)})},function(e){t.emit(!0)})},Object.defineProperty(MailboxesEWSTrafficManager.prototype,"foldername",{get:function(){return this.model.data.settings.ews_folder?this.model.data.settings.ews_folder.name:""},enumerable:!1,configurable:!0}),MailboxesEWSTrafficManager=__decorate([core_1.Component({selector:"mailboxes-mailgun-ews-manager",template:'<div class="slds-m-vertical--xx-small slds-box--border"><div class="slds-p-around--x-small"><h1><system-label label="LBL_EWS"></system-label></h1><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-1"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_HOST"></system-label></label> <input type="text" [disabled]="!view.isEditMode()" [(ngModel)]="model.data.settings.ews_host" class="slds-input"></div></div><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_USER_NAME"></system-label></label> <input type="text" [(ngModel)]="model.data.settings.ews_username" class="slds-input" [disabled]="!view.isEditMode()"></div><div class="slds-form-element slds-size--1-of-2 slds-p-left--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_PASSWORD"></system-label></label><system-input-password [(ngModel)]="model.data.settings.ews_password" [disabled]="!view.isEditMode()"></system-input-password></div></div><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_MAILBOX_EMAIL"></system-label></label> <input type="text" [(ngModel)]="model.data.settings.ews_email" class="slds-input" [disabled]="!view.isEditMode()"></div><div class="slds-form-element slds-size--1-of-2 slds-p-left--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_MAILBOX_FOLDER"></system-label></label> <input type="text" [ngModel]="foldername" class="slds-input" disabled></div></div><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_PUSH"></system-label></label><div><system-checkbox [(ngModel)]="model.data.settings.ews_push"></system-checkbox></div></div><div class="slds-form-element slds-size--1-of-2 slds-p-left--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_SUBSCRIPTION"></system-label></label> <input type="text" [(ngModel)]="model.data.settings.ews_subscriptionid" class="slds-input" disabled></div></div><div class="slds-grid slds-p-vertical--xx-small"><button type="button" class="slds-col--bump-left slds-button slds-button--neutral" (click)="displayFoldersModal()" [disabled]="!view.isEditMode()"><system-label label="LBL_EWS_SELECT_FOLDERS"></system-label></button> <button type="button" class="slds-col--bump-left slds-button slds-button--neutral" (click)="testConnection()" [disabled]="!view.isEditMode()"><system-label label="LBL_TEST_CONNECTION"></system-label></button></div></div></div>'}),__metadata("design:paramtypes",[services_1.language,"function"==typeof(e=void 0!==core_1.Injector&&core_1.Injector)?e:Object,services_1.model,services_1.modal,services_1.view,services_1.backend])],MailboxesEWSTrafficManager)}();exports.MailboxesEWSTrafficManager=MailboxesEWSTrafficManager;var MailboxesEWSSelectFoldersModal=function(){function MailboxesEWSSelectFoldersModal(e,s){this.language=e,this.model=s,this.mailboxes=[]}return MailboxesEWSSelectFoldersModal.prototype.setMailboxes=function(e){this.mailboxes=e},Object.defineProperty(MailboxesEWSSelectFoldersModal.prototype,"mailbox",{get:function(){try{return this.model.data.settings.ews_folder.id}catch(e){return""}},set:function(s){var e=this.model.getField("settings");e.ews_folder=this.mailboxes.find(function(e){return e.id==s}),this.model.setField("settings",e)},enumerable:!1,configurable:!0}),MailboxesEWSSelectFoldersModal.prototype.close=function(){this.self.destroy()},MailboxesEWSSelectFoldersModal=__decorate([core_1.Component({selector:"mailbox-folders-modal",template:'<system-modal><system-modal-header (close)="close()">{{language.getLabel(model.module, \'LBL_MAILBOX_FOLDERS\')}}</system-modal-header><system-modal-content><div class="slds-grid slds-wrap slds-grid--pull-padded"><div class="slds-col"><div class="slds-form-element"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_INBOX_FOLDER"></system-label></label><select [disabled]="mailboxes.length == 0" [(ngModel)]="mailbox" class="slds-select"><option *ngFor="let mailbox of mailboxes" value="{{ mailbox.id }}">{{ mailbox.name }}</option></select></div></div></div></system-modal-content><system-modal-footer><button class="slds-button slds-button--brand" (click)="close()"><system-label label="LBL_OK"></system-label></button></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[services_1.language,services_1.model])],MailboxesEWSSelectFoldersModal)}();exports.MailboxesEWSSelectFoldersModal=MailboxesEWSSelectFoldersModal;var MailboxManagerAddDialog=function(){function MailboxManagerAddDialog(e,s,t,l,i){this.backend=e,this.metadata=s,this.language=t,this.modelutilities=l,this.model=i,this.closedialog=new core_1.EventEmitter,this.mailbox_name="",this.self=null,this.saving=!1}return MailboxManagerAddDialog.prototype.closeDialog=function(){this.closedialog.emit(!1),this.self.destroy()},MailboxManagerAddDialog.prototype.add=function(){var e=this;this.model.module="Mailboxes",this.model.id=this.modelutilities.generateGuid(),this.model.data.name=this.mailbox_name,this.saving=!0,this.model.save().subscribe(function(){e.closedialog.emit(e.model.data),e.self.destroy()})},MailboxManagerAddDialog.prototype.getComponents=function(){return this.metadata.getSystemComponents()},__decorate([core_1.Input(),__metadata("design:type",Array)],MailboxManagerAddDialog.prototype,"mailboxes",void 0),MailboxManagerAddDialog=__decorate([core_1.Component({selector:"mailboxmanager-add-dialog",template:'<div role="dialog" tabindex="-1" aria-labelledby="header43" class="slds-modal slds-fade-in-open"><div class="slds-modal__container"><div class="slds-modal__header"><button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" (click)="closeDialog()"><system-button-icon [icon]="\'close\'" [size]="\'large\'"></system-button-icon></button><h2 id="header43" class="slds-text-heading--medium"><system-label label="LBL_ADD"></system-label> <system-label label="LBL_MAILBOX"></system-label></h2></div><div class="slds-modal__content slds-p-around--medium"><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_MAILBOX"></system-label></label><div class="slds-form-element__control"><input type="text" class="slds-input" placeholder="name" [(ngModel)]="mailbox_name" [disabled]="saving"></div></div></div><div class="slds-modal__footer"><button class="slds-button slds-button--neutral" (click)="closeDialog()" [disabled]="saving"><system-label label="LBL_CANCEL"></system-label></button> <button class="slds-button slds-button--brand" (click)="add()" [disabled]="saving"><system-label label="LBL_ADD"></system-label></button></div></div></div><div class="slds-backdrop slds-backdrop--open"></div>',providers:[services_1.model]}),__metadata("design:paramtypes",[services_1.backend,services_1.metadata,services_1.language,services_1.modelutilities,services_1.model])],MailboxManagerAddDialog)}();exports.MailboxManagerAddDialog=MailboxManagerAddDialog;var MailboxesIMAPSMTPSelectFoldersModal=function(){function MailboxesIMAPSMTPSelectFoldersModal(e,s){this.language=e,this.model=s,this.mailboxes=[]}return MailboxesIMAPSMTPSelectFoldersModal.prototype.setMailboxes=function(e){this.mailboxes=e},MailboxesIMAPSMTPSelectFoldersModal.prototype.close=function(){this.self.destroy()},MailboxesIMAPSMTPSelectFoldersModal=__decorate([core_1.Component({selector:"mailbox-folders-modal",template:'<system-modal><system-modal-header (close)="close()">{{language.getLabel(model.module, \'LBL_MAILBOX_FOLDERS\')}}</system-modal-header><system-modal-content><div class="slds-grid slds-wrap slds-grid--pull-padded"><div class="slds-col"><div class="slds-form-element"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_INBOX_FOLDER"></system-label></label><select [disabled]="mailboxes.length == 0" [(ngModel)]="model.data.settings.imap_inbox_dir" class="slds-select"><option *ngFor="let mailbox of mailboxes" value="{{ mailbox }}">{{ mailbox }}</option></select></div><div class="slds-form-element"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_SENT_FOLDER"></system-label></label><select [disabled]="mailboxes.length == 0" [(ngModel)]="model.data.settings.imap_sent_dir" class="slds-select"><option *ngFor="let mailbox of mailboxes" value="{{ mailbox }}">{{ mailbox }}</option></select></div><div class="slds-form-element"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_TRASH_FOLDER"></system-label></label><select [disabled]="mailboxes.length == 0" [(ngModel)]="model.data.settings.imap_trash_dir" class="slds-select"><option *ngFor="let mailbox of mailboxes" value="{{ mailbox }}">{{ mailbox }}</option></select></div></div></div></system-modal-content><system-modal-footer><button class="slds-button slds-button--brand" (click)="close()"><system-label label="LBL_OK"></system-label></button></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[services_1.language,services_1.model])],MailboxesIMAPSMTPSelectFoldersModal)}();exports.MailboxesIMAPSMTPSelectFoldersModal=MailboxesIMAPSMTPSelectFoldersModal;var MailboxesImapSmtpTrafficManager=function(){function MailboxesImapSmtpTrafficManager(e,s,t,l,i,a,o){this.backend=e,this.language=s,this.model=t,this.modal=l,this.toast=i,this.view=a,this.injector=o;var n=this.model.getField("settings");(!n||n&&0==n.length)&&this.model.setField("settings",{imap_inbox_dir:"",imap_pop3_display_name:"",imap_pop3_encryption:"",imap_pop3_host:"",imap_pop3_password:"",imap_pop3_port:"",imap_pop3_protocol_type:"",imap_pop3_username:"",imap_sent_dir:"",imap_trash_dir:"",imap_delete_after_fetch:"",smtp_allow_self_signed:"",smtp_auth:"",smtp_encryption:"",smtp_host:"",smtp_port:"",smtp_verify_peer:"",smtp_verify_peer_name:"",reply_to:"",shared_mailbox_auth_user:"",shared_mailbox_user:""})}var e;return Object.defineProperty(MailboxesImapSmtpTrafficManager.prototype,"isInbound",{get:function(){return!!this.model.getFieldValue("inbound_comm")},enumerable:!1,configurable:!0}),Object.defineProperty(MailboxesImapSmtpTrafficManager.prototype,"isOutbound",{get:function(){return"no"!=this.model.getFieldValue("outbound_comm")},enumerable:!1,configurable:!0}),MailboxesImapSmtpTrafficManager.prototype.getMailboxes=function(){var s=new rxjs_1.Subject,e=this.model.utils.spiceModel2backend("Mailboxes",this.model.data);return this.backend.postRequest("module/Mailboxes/imap/folders",{},{data:e}).subscribe(function(e){!0===e.result?s.next(e):s.next(!1),s.complete()}),s.asObservable()},MailboxesImapSmtpTrafficManager.prototype.displayFoldersModal=function(){var t=this,e=this.modal.await("loading folders");this.getMailboxes().subscribe(function(s){e.emit(!0),!1!==s&&t.modal.openModal("MailboxesIMAPSMTPSelectFoldersModal",!0,t.injector).subscribe(function(e){e.instance.setMailboxes(s.mailboxes)},function(e){t.toast.sendToast(e)})})},MailboxesImapSmtpTrafficManager.prototype.testConnection=function(){this.modal.openModal("MailboxesmanagerTestIMAPModal",!0,this.injector)},MailboxesImapSmtpTrafficManager=__decorate([core_1.Component({selector:"mailboxes-imap-smtp-traffic-manager",template:'<div class="slds-m-vertical--xx-small slds-box--border"><div class="slds-p-around--x-small"><h1><system-label label="LBL_USER"></system-label></h1><div class="slds-grid"><div class="slds-form-element slds-size--1-of-1"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_DISPLAY_NAME"></system-label></label> <input type="text" [disabled]="!view.isEditMode()" [(ngModel)]="model.data.settings.imap_pop3_display_name" class="slds-input"></div></div><div class="slds-grid"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_USER_NAME"></system-label></label> <input type="text" [disabled]="!view.isEditMode()" [(ngModel)]="model.data.settings.imap_pop3_username" class="slds-input"></div><div class="slds-form-element slds-size--1-of-2 slds-p-left--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_PASSWORD"></system-label></label><system-input-password [disabled]="!view.isEditMode()" [(ngModel)]="model.data.settings.imap_pop3_password"></system-input-password></div></div><div class="slds-grid"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_SHARED_MAILBOX_AUTH_USER"></system-label></label> <input type="text" [disabled]="!view.isEditMode()" [(ngModel)]="model.data.settings.shared_mailbox_auth_user" class="slds-input"></div><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_SHARED_MAILBOX_USER"></system-label></label> <input type="text" [disabled]="!view.isEditMode()" [(ngModel)]="model.data.settings.shared_mailbox_user" class="slds-input"></div></div><div class="slds-grid slds-p-vertical--small"><button type="button" class="slds-col--bump-left slds-button slds-button--neutral" (click)="testConnection()" [disabled]="!view.isEditMode()"><system-label label="LBL_TEST_CONNECTION"></system-label></button></div></div></div><div *ngIf="isInbound" class="slds-m-vertical--xx-small slds-box--border"><div class="slds-p-around--x-small"><h1><system-label label="LBL_IMAP"></system-label></h1><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_PROTOCOL_TYPE"></system-label></label><select type="text" [disabled]="!view.isEditMode()" [(ngModel)]="model.data.settings.imap_pop3_protocol_type" class="slds-select ng-pristine ng-valid"><option value="imap"><system-label label="LBL_IMAP"></system-label></option><option value="pop3"><system-label label="LBL_POP3"></system-label></option></select></div><div class="slds-form-element slds-size--1-of-2 slds-p-left--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_HOST"></system-label></label> <input type="text" [(ngModel)]="model.data.settings.imap_pop3_host" [disabled]="!view.isEditMode()" class="slds-input"></div></div><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_PORT"></system-label></label> <input type="text" [(ngModel)]="model.data.settings.imap_pop3_port" [disabled]="!view.isEditMode()" class="slds-input"></div><div class="slds-form-element slds-size--1-of-2 slds-p-left--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_ENCRYPTION"></system-label></label><select type="text" [disabled]="!view.isEditMode()" [(ngModel)]="model.data.settings.imap_pop3_encryption" class="slds-select ng-pristine ng-valid"><option value="none"><system-label label="LBL_NOENCRYPTION"></system-label></option><option value="ssl"><system-label label="LBL_SSL"></system-label></option><option value="tls"><system-label label="LBL_TLS"></system-label></option></select></div></div><div class="slds-grid--vertical slds-p-vertical--xx-small"><div class="slds-form-element"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_INBOX_FOLDER"></system-label></label> <input class="slds-input" [ngModel]="model.data.settings.imap_inbox_dir" disabled></div><div class="slds-form-element"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_SENT_FOLDER"></system-label></label> <input class="slds-input" [ngModel]="model.data.settings.imap_sent_dir" disabled></div><div class="slds-form-element"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_TRASH_FOLDER"></system-label></label> <input class="slds-input" [ngModel]="model.data.settings.imap_trash_dir" disabled></div></div><div class="slds-grid--vertical slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-2 slds-p-left--xx-small"><div class="slds-form-element"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_IMAP_DELETE_AFTER_FETCH"></system-label></label></div><div class="slds-form-element"><system-checkbox [disabled]="!view.isEditMode()" id="imap_delete_after_fetch" [(ngModel)]="model.data.settings.imap_delete_after_fetch"></system-checkbox></div></div></div><div class="slds-grid slds-p-vertical--small"><button type="button" class="slds-col--bump-left slds-button slds-button--neutral" (click)="displayFoldersModal()" [disabled]="!view.isEditMode()"><system-label label="LBL_IMAP_SELECT_FOLDERS"></system-label></button></div></div></div><div *ngIf="isOutbound" class="slds-m-vertical--xx-small slds-box--border"><div class="slds-p-around--x-small"><h1><system-label label="LBL_SMTP"></system-label></h1><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_HOST"></system-label></label> <input type="text" [(ngModel)]="model.data.settings.smtp_host" [disabled]="!view.isEditMode()" class="slds-input"></div><div class="slds-form-element slds-size--1-of-2 slds-p-left--xx-small"><div class="slds-form-element"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_AUTHENTICATION"></system-label></label></div><div class="slds-form-element"><system-checkbox [disabled]="!view.isEditMode()" id="smtp_auth" [(ngModel)]="model.data.settings.smtp_auth"></system-checkbox></div></div></div><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_PORT"></system-label></label> <input type="text" [(ngModel)]="model.data.settings.smtp_port" [disabled]="!view.isEditMode()" class="slds-input"></div><div class="slds-form-element slds-size--1-of-2 slds-p-left--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_ENCRYPTION"></system-label></label><select type="text" [disabled]="!view.isEditMode()" [(ngModel)]="model.data.settings.smtp_encryption" class="slds-select ng-pristine ng-valid"><option value="none"><system-label label="LBL_NOENCRYPTION"></system-label></option><option value="ssl"><system-label label="LBL_SSL"></system-label></option><option value="tls"><system-label label="LBL_TLS"></system-label></option></select></div></div><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-2 slds-p-right--xx-small"><label class="slds-truncate slds-form-element__label"><system-label label="LBL_REPLY_TO"></system-label></label> <input type="text" [(ngModel)]="model.data.settings.reply_to" [disabled]="!view.isEditMode()" class="slds-input"></div></div><div class="slds-grid slds-p-vertical--xx-small"><div class="slds-form-element slds-size--1-of-4"><div class="slds-form-element"><system-checkbox [disabled]="!view.isEditMode()" [(ngModel)]="model.data.settings.smtp_verify_peer"></system-checkbox></div></div><div class="slds-form-element slds-size--1-of-4"><div class="slds-form-element"><system-checkbox [disabled]="!view.isEditMode()" [(ngModel)]="model.data.smtp_verify_peer_name"><system-label label="LBL_SMTP_VERIFY_PEER_NAME"></system-label></system-checkbox></div></div><div class="slds-form-element slds-size--1-of-4"><div class="slds-form-element"><system-checkbox [disabled]="!view.isEditMode()" [(ngModel)]="model.data.allow_external_delete"><system-label label="LBL_IMAP_SMTP_ALLOW_EXTERNAL_DELETE"></system-label></system-checkbox></div></div><div class="slds-form-element slds-size--1-of-4"><div class="slds-form-element"><system-checkbox [disabled]="!view.isEditMode()" [(ngModel)]="model.data.smtp_allow_self_signed"><system-label label="LBL_SMTP_ALLOW_SELF_SIGNED"></system-label></system-checkbox></div></div></div></div></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.language,services_1.model,services_1.modal,services_1.toast,services_1.view,"function"==typeof(e=void 0!==core_1.Injector&&core_1.Injector)?e:Object])],MailboxesImapSmtpTrafficManager)}();exports.MailboxesImapSmtpTrafficManager=MailboxesImapSmtpTrafficManager;var MailboxesTransportManager=function(){function MailboxesTransportManager(e,s,t,l,i){this.metadata=e,this.language=s,this.model=t,this.view=l,this.configuration=i}return Object.defineProperty(MailboxesTransportManager.prototype,"transportcomponent",{get:function(){var s=this.model.getField("transport");if(s){var e=this.configuration.getData("mailboxtransports").find(function(e){return e.name==s});return e?e.component:void 0}},enumerable:!1,configurable:!0}),MailboxesTransportManager=__decorate([core_1.Component({selector:"mailboxes-transport-manager",template:'<system-section titlelabel="LBL_TRANSPORT"><div class="slds-p-around--x-small"><field-container field="transport"></field-container><system-dynamic-component *ngIf="transportcomponent" [component]="transportcomponent"></system-dynamic-component></div></system-section>'}),__metadata("design:paramtypes",[services_1.metadata,services_1.language,services_1.model,services_1.view,services_1.configurationService])],MailboxesTransportManager)}();exports.MailboxesTransportManager=MailboxesTransportManager;var MailboxesProcessors=function(){function e(e,s,t,l,i){this.metadata=e,this.language=s,this.backend=t,this.model=l,this.view=i,this.processors=[],this.model.module="Mailboxes",this.view.isEditable=!0,this.view.setEditMode(),this.getProcessors()}return e.prototype.addProcessor=function(){this.model.data.mailbox_processors||(this.model.data.mailbox_processors=[]),this.model.data.mailbox_processors.push({id:this.model.generateGuid(),class:"",method:"",priority:"",stop_on_success:"",deleted:!1})},e.prototype.removeProcessor=function(s){this.model.data.mailbox_processors.forEach(function(e){e.id===s&&(e.deleted=!0)})},Object.defineProperty(e.prototype,"processorsvisible",{get:function(){return 0<this.model.data.mailbox_processors.length},enumerable:!1,configurable:!0}),e.prototype.getProcessorMethods=function(e){for(var s=0,t=this.processors;s<t.length;s++){var l=t[s];if(l.processor_class==e)return l.methods}return[]},e.prototype.getProcessors=function(){var s=this,t=new rxjs_1.Subject;return this.backend.getRequest("module/Mailboxes/processors").subscribe(function(e){!0===e.result&&(s.processors=e.processors),t.next(e),t.complete()}),t.asObservable()},e=__decorate([core_1.Component({selector:"mailboxes-processors",template:'<table *ngIf="processorsvisible" class="slds-table slds-table_bordered slds-table_cell-buffer"><thead><tr class="slds-text-title"><th scope="col"><div class="slds-truncate" title="Class">Class</div></th><th scope="col"><div class="slds-truncate" title="Method">Method</div></th><th scope="col"><div class="slds-truncate" title="Priority">Priority</div></th><th scope="col"><div class="slds-truncate" title="Stop on success">Stop on success</div></th></tr></thead><tbody><ng-container *ngFor="let mailbox_processor of model.data.mailbox_processors"><tr *ngIf="!mailbox_processor.deleted"><input type="hidden" [(ngModel)]="mailbox_processor.id"><td scope="row" data-label="Class"><select [disabled]="processors.length == 0" [(ngModel)]="mailbox_processor.processor_class" type="text" class="slds-select ng-pristine ng-valid"><option *ngFor="let processor of processors" value="{{ processor.processor_class }}">{{ processor.name }}</option></select></td><td scope="row" data-label="Method"><select [disabled]="!mailbox_processor.processor_class" [(ngModel)]="mailbox_processor.processor_method" type="text" class="slds-select ng-pristine ng-valid"><ng-container *ngIf="mailbox_processor.processor_class"><option *ngFor="let method of getProcessorMethods(mailbox_processor.processor_class)" value="{{ method }}">{{ method }}</option></ng-container></select></td><td scope="row" data-label="Priority"><input class="slds-input ng-pristine ng-valid ng-touched" [(ngModel)]="mailbox_processor.priority" title="Priority"></td><td scope="row" data-label="Stop on success"><input class="slds-input ng-pristine ng-valid ng-touched" [(ngModel)]="mailbox_processor.stop_on_success" title="Stop on success"></td><td scope="row"><button class="slds-button slds-button_destructive" (click)="removeProcessor(mailbox_processor.id)">X</button></td></tr></ng-container></tbody></table><button type="button" class="slds-col--bump-left slds-button slds-button--neutral" (click)="addProcessor()">Add Processor</button>'}),__metadata("design:paramtypes",[services_1.metadata,services_1.language,services_1.backend,services_1.model,services_1.view])],e)}();exports.MailboxesProcessors=MailboxesProcessors;var SelectTreeComponent=function(){function SelectTreeComponent(e,s,t,l,i,a,o){this.backend=e,this.metadata=s,this.language=t,this.config=l,this.utils=i,this.toast=a,this.modalservice=o,this.currentSelectTree="",this.category_tree=[],this.levels=[],this.max_levels=4,this.loading=!0,this.selected_categorys=[],this.edit_category=null,this.service_queues=[],this.trees=[],this.loadTrees(!0)}return SelectTreeComponent.prototype.addTree=function(){var s=this;this.modalservice.openModal("SelectTreeAddDialog").subscribe(function(e){e.instance.tree$.subscribe(function(e){s.updateTree(e)})})},SelectTreeComponent.prototype.updateTree=function(e){this.loadTrees(),this.currentSelectTree=e.id,this.loadSelectTree(this.currentSelectTree)},SelectTreeComponent.prototype.loadTrees=function(s){var t=this;void 0===s&&(s=!1),this.config.getData("select_trees")||this.backend.getRequest("configuration/spiceui/core/selecttree/trees").subscribe(function(e){t.trees=e,s&&(0<t.trees.length?(t.currentSelectTree=t.trees[0].id,t.loadSelectTree(t.currentSelectTree)):t.loading=!1)})},SelectTreeComponent.prototype.loadSelectTree=function(e){var s=this;this.edit_category=null,this.backend.getRequest("configuration/spiceui/core/selecttree/tree/"+e).subscribe(function(e){s.config.setData("select_tree",e),s.initializeTree(e)})},SelectTreeComponent.prototype.initializeTree=function(e){this.category_tree=e;for(var s=0;s<this.max_levels;s++)this.levels[s]=[];this.levels[0]=this.category_tree,this.loading=!1},SelectTreeComponent.prototype.resetLevels=function(e){void 0===e&&(e=0);for(var s=e;s<this.max_levels;s++)this.levels[s]=[];this.selected_categorys.splice(e,this.max_levels-e)},SelectTreeComponent.prototype.select=function(e){(this.selected_categorys[e.level]=e).childs?(this.levels[e.level+1]=e.childs,this.resetLevels(e.level+2)):this.resetLevels(e.level+1)},SelectTreeComponent.prototype.addCategory=function(e){void 0===e&&(e=null);var s={id:this.utils.generateGuid(),name:"new Field...",keyname:null,parent_id:null,tree:this.currentSelectTree,selectable:0,favorite:0,level:0};e?(e.childs||(e.childs=[]),s.parent_id=e.id,s.level=e.level+1,s.level>this.max_levels&&(this.max_levels=s.level),e.childs.push(s),this.levels[e.level+1]=e.childs):(this.category_tree.push(s),this.levels[0]=this.category_tree),this.select(s),this.edit(s)},SelectTreeComponent.prototype.removeCategory=function(e){if(e.childs&&!confirm("Are you sure you want to delete this Category? There are "+e.childs.length+" Subcategories which will be get deleted too!"))return!1;e==this.edit_category&&(this.edit_category=null);for(var s=0,t=0,l=this.category_tree;t<l.length;t++){var i=l[t];if(i==e)return this.category_tree.splice(s,1),!0;a(i,e),s++}function a(e,s){if(e.childs)for(var t=0;t<e.childs.length;t++){if(e.childs[t]==s)return e.childs.splice(t,1),!0;a(e.childs[t],s)}return!1}},SelectTreeComponent.prototype.edit=function(e){this.selected_categorys[e.level]=e,this.edit_category=e},SelectTreeComponent.prototype.save=function(){var s=this;this.backend.postRequest("configuration/spiceui/core/selecttree/tree",null,this.category_tree).subscribe(function(e){s.toast.sendToast("changes saved")},function(e){s.toast.sendAlert("saving failed!"),console.error(e)})},SelectTreeComponent.prototype.isCategorySelected=function(e){for(var s=0,t=this.selected_categorys;s<t.length;s++){if(t[s].id==e.id)return!0}return!1},SelectTreeComponent=__decorate([core_1.Component({template:'<div class="slds-p-around--small slds-border--bottom"><div class="slds-grid slds-grid--vertical-align-center slds-form--inline"><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_TREE"></system-label></label><div class="slds-form-element__control" style="min-width:250px;"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="currentSelectTree" (change)="loadSelectTree(currentSelectTree)" [disabled]="trees.length == 0"><option *ngFor="let tree of trees" [value]="tree.id">{{tree.name}}</option></select></div></div></div><div class="slds-form-element slds-col--bump-left"><button type="button" class="slds-button slds-button_icon slds-button_icon-border-filled" (click)="addTree()"><system-utility-icon [icon]="\'add\'" [size]="\'x-small\'"></system-utility-icon></button></div></div></div><div class="slds-grid slds-grid--align-spread slds-p-around--medium"><h2 class="slds-text-heading--medium">Select Tree</h2><button class="slds-button slds-button--brand" (click)="save()">Save</button></div><article class="slds-card slds-m-around--small"><div class="slds-card__header"><header class="slds-has-flexi-truncate"><h2>Service Category Tree</h2></header></div><div class="slds-card__body slds-card__body_inner slds-grid"><div *ngIf="loading" class="slds-p-around--small slds-align--absolute-center"><system-spinner></system-spinner></div><div *ngFor="let lvl of levels; let i = index" class="slds-col slds-size--1-of-2" [ngStyle]="{width: 100/levels.length+\'%\'}" [ngClass]="{\'slds-border--right\': i < max_levels -1}"><div *ngFor="let cat of lvl" [ngClass]="{\'slds-theme--shade\': isCategorySelected(cat) || cat == edit_category, \'slds-theme_alert-texture\': cat == edit_category}"><div class="slds-grid slds-grid--vertical-align-center slds-p-around--xx-small" (mouseenter)="select(cat)"><span class="slds-truncate" style="cursor: pointer;" (click)="edit(cat)">{{cat.name}}</span><system-utility-icon class="slds-m-left--small" *ngIf="cat.favorite == 1" [icon]="\'favorite\'" [size]="\'xx-small\'"></system-utility-icon><div class="slds-col--bump-left"><system-utility-icon *ngIf="cat.level < max_levels-1" [icon]="\'add\'" [size]="\'xx-small\'" style="cursor:pointer;" (click)="addCategory(cat)"></system-utility-icon><system-utility-icon *ngIf="cat.childs" [icon]="\'chevronright\'" [size]="\'xx-small\'"></system-utility-icon></div></div></div><div *ngIf="i == 0" class="slds-p-around--xx-small"><system-utility-icon [icon]="\'add\'" [size]="\'xx-small\'" style="cursor:pointer;" (click)="addCategory()"></system-utility-icon></div></div></div></article><article *ngIf="edit_category" class="slds-card slds-m-around--small slds-size--1-of-4 slds-theme--shade slds-theme_alert-texture"><div class="slds-card__header slds-grid"><header class="slds-has-flexi-truncate"><h2>Edit Category</h2></header><system-utility-icon [icon]="\'close\'" [size]="\'xx-small\'" style="cursor: pointer;" (click)="removeCategory(edit_category)"></system-utility-icon></div><div class="slds-card__body slds-card__body_inner"><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label">Name:</label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="edit_category.name"></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><label class="slds-form-element__label">Key:</label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="edit_category.keyname"></div></div><div class="slds-form-element slds-m-vertical--xxx-small"><div class="slds-form-element slds-p-top--small"><div class="slds-form-element__control slds-grid"><span class="slds-checkbox"><input type="checkbox" name="options" id="checkbox-42" [(ngModel)]="edit_category.favorite"> <label class="slds-checkbox__label" for="checkbox-42"><span class="slds-checkbox_faux"></span> <span class="slds-form-element__label">Favorite</span></label></span> <span class="slds-checkbox"><input type="checkbox" name="options" id="checkbox-49" [(ngModel)]="edit_category.selectable"> <label class="slds-checkbox__label" for="checkbox-49"><span class="slds-checkbox_faux"></span> <span class="slds-form-element__label">Selectable</span></label></span></div></div></div></div></article>'}),__metadata("design:paramtypes",[services_1.backend,services_1.metadata,services_1.language,services_1.configurationService,services_1.modelutilities,services_1.toast,services_1.modal])],SelectTreeComponent)}();exports.SelectTreeComponent=SelectTreeComponent;var SelectTreeAddDialog=function(){function SelectTreeAddDialog(e,s,t,l,i){this.backend=e,this.metadata=s,this.language=t,this.modelutilities=l,this.utils=i,this.tree=null,this.tree$=new core_1.EventEmitter,this.addType="fieldset",this.addName="",this.fieldsettype="custom"}return SelectTreeAddDialog.prototype.closeDialog=function(){this.self.destroy()},SelectTreeAddDialog.prototype.add=function(){var s=this;this.tree={id:this.utils.generateGuid(),name:this.addName},this.backend.postRequest("configuration/spiceui/core/selecttree/newtree",null,this.tree).subscribe(function(e){s.tree$.emit(s.tree),s.self.destroy()},function(e){console.error(e)})},__decorate([core_1.Input(),__metadata("design:type",Object)],SelectTreeAddDialog.prototype,"tree",void 0),__decorate([core_1.Output("tree"),__metadata("design:type",Object)],SelectTreeAddDialog.prototype,"tree$",void 0),SelectTreeAddDialog=__decorate([core_1.Component({selector:"selecttree-add-dialog",template:'<div role="dialog" tabindex="-1" aria-labelledby="header43" class="slds-modal slds-fade-in-open"><div class="slds-modal__container"><div class="slds-modal__header"><button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" (click)="closeDialog()"><system-button-icon [icon]="\'close\'" [size]="\'large\'"></system-button-icon></button><h2 id="header43" class="slds-text-heading--medium"><system-label label="LBL_ADD_TREE"></system-label></h2></div><div class="slds-modal__content slds-p-around--medium"><div class="slds-form-element slds-m-top--small"><label class="slds-form-element__label"><system-label label="LBL_TREE_NAME"></system-label></label><div class="slds-form-element__control"><input type="text" class="slds-input" placeholder="name" [(ngModel)]="addName"></div></div></div><div class="slds-modal__footer"><button class="slds-button slds-button--neutral" (click)="closeDialog()"><system-label label="LBL_CANCEL"></system-label></button> <button class="slds-button slds-button--brand" (click)="add()"><system-label label="LBL_ADD"></system-label></button></div></div></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.metadata,services_1.language,services_1.modelutilities,services_1.modelutilities])],SelectTreeAddDialog)}();exports.SelectTreeAddDialog=SelectTreeAddDialog;var ConfigCleaner=function(){function ConfigCleaner(e,s,t,l){this.backend=e,this.metadata=s,this.language=t,this.utils=l,this.results=[],this.is_loading=!1}return ConfigCleaner.prototype.diagnose=function(e){var s=this;this.is_loading=!0,this.backend.getRequest("admin/cleanup/configs/check/"+e).subscribe(function(e){s.results=e,s.is_loading=!1})},ConfigCleaner=__decorate([core_1.Component({selector:"language-label-manager",template:'<div class="slds-p-around--medium"><div class="slds-m-around--medium"><button class="slds-button slds-button--brand" (click)="diagnose(\'incomplete\')"><system-label label="LBL_INCOMPLETE_RECORDS"></system-label></button></div><div *ngIf="is_loading"><system-spinner></system-spinner></div><div *ngIf="results && results.total_checks > 0"><div class="slds-box slds-m-bottom--medium"><p>{{results.total_checks}} Checks are made and found {{results.total_records}} Records:</p></div><system-card *ngFor="let check of results.checks" class="slds-m-bottom--medium"><system-card-header [title]="check.table"></system-card-header><system-card-body><div *ngIf="!check.records" class="slds-inline_icon_text slds-grid"><system-utility-icon icon="check" size="x-small"></system-utility-icon><div class="slds-col slds-align-middle slds-text-color_success"><p>all fine!</p></div></div><div *ngIf="check.records && check.records.length > 0"><p>{{check.description}}</p><table class="slds-table slds-table--bordered"><thead><tr><th></th><th>ID</th><th>Name</th></tr></thead><tbody><tr *ngFor="let record of check.records"><td><system-checkbox [disabled]="true"></system-checkbox></td><td>{{record.id}}</td><td>{{record.name}}</td></tr></tbody></table></div></system-card-body></system-card></div></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.metadata,services_1.language,services_1.modelutilities])],ConfigCleaner)}();exports.ConfigCleaner=ConfigCleaner;var StyleCacheCleaner=function(){function StyleCacheCleaner(e,s,t){this.backend=e,this.toast=s,this.language=t,this.is_loading=!1}return StyleCacheCleaner.prototype.cleanCache=function(){var s=this;this.is_loading=!0,this.backend.getRequest("admin/cleanup/stylecache").subscribe(function(e){e?s.toast.sendToast(s.language.getLabel("LBL_CACHE_FILE_DELETED"),"success"):s.toast.sendToast(s.language.getLabel("LBL_CACHE_FILE_NOT_FOUND"),"info"),s.is_loading=!1})},StyleCacheCleaner=__decorate([core_1.Component({selector:"style-cache-cleaner",template:'<div class="slds-p-around--medium"><div class="slds-m-around--medium"><button class="slds-button slds-button--brand" (click)="cleanCache()"><system-label label="LBL_CLEAN_STYLE_CACHE"></system-label></button></div><div *ngIf="is_loading"><system-spinner></system-spinner></div></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.toast,services_1.language])],StyleCacheCleaner)}();exports.StyleCacheCleaner=StyleCacheCleaner;var GoogleCalendarManager=function(){function GoogleCalendarManager(e,s,t,l){this.backend=e,this.language=s,this.model=t,this.toast=l,this.beans=[],this.calendars=[],this.beanMappings=[],this.getBeans(),this.getCalendars(),this.getBeanMappings()}return GoogleCalendarManager.prototype.saveBeanMappings=function(){var s=this,e={bean_mappings:this.beanMappings};this.backend.postRequest("channels/groupware/gsuite/calendar/beanmappings",{},e).subscribe(function(e){s.toast.sendToast("Bean Mappings saved")})},GoogleCalendarManager.prototype.startSync=function(){var s=this;this.backend.getRequest("channels/groupware/gsuite/calendar/sync").subscribe(function(e){1==e.result?s.toast.sendToast("Google Calendar synchronization started.","success"):s.toast.sendToast(e.error,"error")})},GoogleCalendarManager.prototype.addMapping=function(){this.beanMappings||(this.beanMappings=[]),this.beanMappings.push({id:this.model.generateGuid(),deleted:!1,bean:{module:"",class:""},calendar:{id:"",name:""}})},GoogleCalendarManager.prototype.removeMapping=function(s){this.beanMappings.forEach(function(e){e.id===s&&(e.deleted=!0)})},GoogleCalendarManager.prototype.getBeans=function(){var s=this,t=new rxjs_1.Subject;return this.backend.getRequest("channels/groupware/gsuite/calendar/beans").subscribe(function(e){!0===e.result&&(s.beans=e.beans),t.next(e),t.complete()},function(e){}),t.asObservable()},GoogleCalendarManager.prototype.getCalendars=function(){var s=this,t=new rxjs_1.Subject;return this.backend.getRequest("channels/groupware/gsuite/calendar/calendars").subscribe(function(e){!0===e.result&&(s.calendars=e.calendars),t.next(e),t.complete()},function(e){}),t.asObservable()},GoogleCalendarManager.prototype.getBeanMappings=function(){var e=this,t=new rxjs_1.Subject;return this.backend.getRequest("channels/groupware/gsuite/calendar/beanmappings").subscribe(function(s){!0===s.result&&(e.beanMappings=Object.keys(s.bean_mappings).map(function(e){return s.bean_mappings[e]})),t.next(s),t.complete()},function(e){}),t.asObservable()},GoogleCalendarManager=__decorate([core_1.Component({providers:[services_1.model,services_1.view],selector:"google-calendar-manager",template:'<div class="slds-grid slds-form--inline slds-p-around--small slds-border--bottom"><div class="slds-form-element slds-col--bump-left"><div class="slds-button-group" role="group"><button type="button" class="slds-button slds-button--neutral" (click)="startSync()"><system-label label="LBL_START_SYNC"></system-label></button> <button type="button" class="slds-button slds-button--neutral" (click)="addMapping()"><system-label label="LBL_ADD"></system-label></button> <button type="button" class="slds-button slds-button--brand" (click)="saveBeanMappings()"><system-label label="LBL_SAVE"></system-label></button></div></div></div><table class="slds-table slds-table_bordered slds-table_cell-buffer"><thead><tr class="slds-text-title"><th scope="col"><div class="slds-truncate" title="Bean">Bean</div></th><th scope="col"><div class="slds-truncate" title="Calendar">Calendar</div></th></tr></thead><tbody><ng-container *ngFor="let beanMapping of beanMappings"><tr *ngIf="!beanMapping.deleted"><td scope="row" data-label="Class"><select [disabled]="beans.length == 0" [(ngModel)]="beanMapping.bean" type="text" class="slds-select ng-pristine ng-valid"><option *ngFor="let bean of beans" value="{{ bean.class }}">{{ bean.class }}</option></select></td><td scope="row" data-label="Method"><select [disabled]="calendars.length == 0" [(ngModel)]="beanMapping.calendar" type="text" class="slds-select ng-pristine ng-valid"><option *ngFor="let calendar of calendars" value="{{ calendar.id }}">{{ calendar.name }}</option></select></td><td scope="row"><button class="slds-button slds-button_destructive" (click)="removeMapping(beanMapping.id)">X</button></td></tr></ng-container></tbody></table>'}),__metadata("design:paramtypes",[services_1.backend,services_1.language,services_1.model,services_1.toast])],GoogleCalendarManager)}();exports.GoogleCalendarManager=GoogleCalendarManager;var ConfigTransfer=function(){function ConfigTransfer(e,s,t,l,i,a){this.backend=e,this.metadata=s,this.lang=t,this.prefs=l,this.modalservice=i,this.toast=a,this.tabToShow="i",this.selectableTables=[],this.blacklistedTables=[],this.additionalTables="",this.tablenamesLoaded=!1,this.showBlacklistedTables=!1,this.isLoadingTablenames=!1,this.isDownloading=!1,this.loadUrl=void 0,this.fileName="export.gz",this.changeExportSettings=!1,this.isUploading=!1,this.isImporting=!1,this.isAfterUpload=!1,this.dropErrorMessageCode=null,this.importOK=null,this.ignoreUnknownTables=!1,this.isDragOver=!1}var e,s;return ConfigTransfer.prototype.showExport=function(){var s=this;"e"!==this.tabToShow&&(this.tablenamesLoaded||this.isLoadingTablenames||(this.isLoadingTablenames=!0,this.backend.getRequest("configuration/transfer/tablenames").subscribe(function(e){e.selectableTables.forEach(function(e){s.selectableTables.push({name:e,include:!0})}),e.blacklistedTables.forEach(function(e){s.blacklistedTables.push(e)}),s.isLoadingTablenames=!1,s.tablenamesLoaded=!0})),this.tabToShow="e")},ConfigTransfer.prototype.showImport=function(){this.tabToShow="i"},ConfigTransfer.prototype.exportTables=function(){var s=this;this.isDownloading=!0,this.exportErrorID&&(this.toast.clearToast(this.exportErrorID),this.exportErrorID=null);var t=[];this.selectableTables.forEach(function(e){e.include&&t.push(e.name)}),this.fileName="spicecrm-cfg-"+moment().format("YYYYMMDD-HHmm")+".gz",this.backend.getDownloadPostRequestFile("configuration/transfer/export",{},{selectedTables:t,additionalTables:this.additionalTables}).subscribe(function(e){s.downloadlink.element.nativeElement.href=e,s.downloadlink.element.nativeElement.click(),s.isDownloading=!1},function(e){s.isDownloading=!1,s.exportErrorID=s.toast.sendToast(s.lang.getLabel("ERR_EXPORT_FAILED"),"error",s.exportErrorMessage=e.error.message)})},ConfigTransfer.prototype.selectAll=function(s){this.selectableTables.forEach(function(e){e.include=s})},Object.defineProperty(ConfigTransfer.prototype,"numberOfSelectedTables",{get:function(){var s=0;return this.selectableTables.forEach(function(e){return e.include&&s++}),s},enumerable:!1,configurable:!0}),ConfigTransfer.prototype.uploadFile=function(){var t=this;this.modalservice.confirm("You are about to upload a file and import its data into the database. This will change the existing database. Do you really want to do this?",this.lang.getLabel("LBL_WARNING"),"warning").subscribe(function(e){if(e){t.isUploading=!0,t.importOK=null;var s=new rxjs_1.BehaviorSubject(0);s.subscribe(function(e){100===(t.uploadProgress=e)&&(t.isImporting=!0)}),t.readFileFromFilesystem(t.fileFromBrowser).subscribe(function(e){t.backend.postRequestWithProgress("configuration/transfer/import",null,{file:e,ignoreUnknownTables:t.ignoreUnknownTables},s).subscribe(function(e){t.isAfterUpload=t.importOK=!0,t.isImporting=t.isUploading=!1,t.importResponse=e},function(e){t.isAfterUpload=!0,t.importOK=!1,t.isImporting=t.isUploading=!1,t.importErrorID=t.toast.sendToast(t.lang.getLabel("ERR_IMPORT_FAILED"),"error",t.importErrorMessage=e.error.error.message)})})}})},Object.defineProperty(ConfigTransfer.prototype,"filename",{get:function(){return this.fileFromBrowser?this.fileFromBrowser.name:""},enumerable:!1,configurable:!0}),ConfigTransfer.prototype.fileSelectionChange=function(){return 1===this.fileupload.element.nativeElement.files.length&&(this.fileFromBrowser=this.fileupload.element.nativeElement.files[0]),this.fileSelectedOrDropped(),this.fileupload.element.nativeElement.value=null,!1},ConfigTransfer.prototype.fileSelectedOrDropped=function(){this.isAfterUpload=this.isUploading=!1,this.importOK=null,this.importErrorID&&(this.toast.clearToast(this.importErrorID),this.importErrorID=null)},Object.defineProperty(ConfigTransfer.prototype,"fileReadyForUpload",{get:function(){return this.fileFromBrowser&&!0},enumerable:!1,configurable:!0}),ConfigTransfer.prototype.readFileFromFilesystem=function(e){var s=new rxjs_1.Subject,t=new FileReader;return t.onloadend=function(){var e=t.result.toString();e=e.substring(e.indexOf("base64,")+7),s.next(e),s.complete()},t.readAsDataURL(e),s.asObservable()},ConfigTransfer.prototype.onDrop=function(e){if(e.preventDefault(),this.isDragOver=!1,e.dataTransfer.items){if(1!==e.dataTransfer.items.length||"file"!==e.dataTransfer.items[0].kind)return void this.showDropError();var s=e.dataTransfer.items[0].getAsFile();if("gz"!==s.name.split(".").pop())return void this.showDropError();this.fileFromBrowser=s}else{if(1!==e.dataTransfer.files.length)return;if("gz"!==e.dataTransfer.files[0].name.split(".").pop())return void this.showDropError();this.fileFromBrowser=e.dataTransfer.files[0]}this.dropErrorMessageCode&&this.toast.clearToast(this.dropErrorMessageCode),this.fileSelectedOrDropped()},ConfigTransfer.prototype.showDropError=function(){this.dropErrorMessageCode&&this.toast.clearToast(this.dropErrorMessageCode),this.dropErrorMessageCode=this.toast.sendToast('You can drop only a file. One file. With the extension "gz".',"error",null,!1,this.dropErrorMessageCode)},ConfigTransfer.prototype.onDragOver=function(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy",this.isDragOver=!0},ConfigTransfer.prototype.onDragLeave=function(){this.isDragOver=!1},__decorate([core_1.ViewChild("downloadlink",{read:core_1.ViewContainerRef,static:!0}),__metadata("design:type","function"==typeof(e=void 0!==core_1.ViewContainerRef&&core_1.ViewContainerRef)?e:Object)],ConfigTransfer.prototype,"downloadlink",void 0),__decorate([core_1.ViewChild("fileupload",{read:core_1.ViewContainerRef,static:!0}),__metadata("design:type","function"==typeof(s=void 0!==core_1.ViewContainerRef&&core_1.ViewContainerRef)?s:Object)],ConfigTransfer.prototype,"fileupload",void 0),ConfigTransfer=__decorate([core_1.Component({template:'<div class="slds-m-horizontal--medium slds-m-top--medium slds-m-bottom--small"><h2 class="slds-text-heading--medium">{{lang.getLabel(\'LBL_CONFIGURATION_TRANSFER\')}}</h2><p>Export and import configuration data from/into database. Also usable for backup.</p><div class="slds-tabs_default slds-tabs_medium"><ul class="slds-tabs_default__nav" role="tablist"><li [ngClass]="{\'slds-is-active\':tabToShow===\'i\'}" class="slds-tabs_default__item" title="Item One" role="presentation"><a class="slds-tabs_default__link" href="javascript:void(0);" (click)="showImport()">{{lang.getLabel(\'LBL_IMPORT\')}}</a></li><li [ngClass]="{\'slds-is-active\':tabToShow===\'e\'}" class="slds-tabs_default__item" title="Item Two" role="presentation"><a class="slds-tabs_default__link" href="javascript:void(0);" (click)="showExport()">{{lang.getLabel(\'LBL_EXPORT\')}}</a></li></ul><div [ngClass]="{\'slds-hide\':tabToShow!==\'i\'}" class="slds-tabs_default__content"><div class="slds-form-element"><span class="slds-form-element__label">{{lang.getLabel(\'LBL_CONFIGURATION_FILE\')}}</span><div class="slds-form-element__control"><div class="slds-file-selector slds-file-selector_files" (drop)="onDrop($event)" (dragover)="onDragOver($event)" (dragleave)="onDragLeave()"><div class="slds-file-selector__dropzone" [ngClass]="{\'slds-has-drag-over\':isDragOver}"><input #fileupload (click)="fileupload.value = null" class="slds-file-selector__input slds-assistive-text" accept=".gz" type="file" id="config-file-upload-input" (change)="fileSelectionChange()" [disabled]="isUploading"> <label class="slds-file-selector__body" for="config-file-upload-input"><span class="slds-file-selector__button slds-button slds-button_neutral"><system-button-icon [icon]="\'upload\'" [size]="\'small\'" [addclasses]="\'slds-button__icon_left\'"></system-button-icon>{{lang.getLabel(\'LBL_SELECT_FILE\')}}</span> <span class="slds-file-selector__text slds-medium-show">{{lang.getLabel(\'LBL_OR_DROP_FILE_HERE\')}}</span></label></div></div></div></div><div *ngIf="fileReadyForUpload"><div class="slds-form-element"><div class="slds-form-element__control slds-m-vertical--medium"><div class="slds-checkbox"><input type="checkbox" id="cbIgnoreUnknownTables" [(ngModel)]="ignoreUnknownTables" [disabled]="isAfterUpload || isUploading"> <label class="slds-checkbox__label" for="cbIgnoreUnknownTables"><span class="slds-checkbox_faux"></span> <span class="slds-form-element__label">Ignore unknown tables and do the import anyway. In case the input data contains tables that are unknown to the system.</span></label></div></div></div><div *ngIf="!isAfterUpload && !isUploading"><div class="slds-m-vertical--medium">Upload and import the file &quot;<b>{{filename}}</b>&quot;?</div><div><button class="slds-button slds-button--brand" (click)="uploadFile()">{{lang.getLabel(\'LBL_UPLOAD_AND_IMPORT\')}}</button></div></div><system-progress-bar *ngIf="isUploading || isAfterUpload" class="slds-m-vertical--medium" [progress]="uploadProgress" size="large">Upload of file &quot;<b>{{filename}}</b>&quot; &hellip;</system-progress-bar><div *ngIf="isImporting"><b>Importing &hellip;</b></div><div *ngIf="importOK===true"><b>Import successful</b>: {{importResponse.numberLinesInserted}} records inserted into {{importResponse.numberAffectedTables}} tables.<br>Before import a backup of the affected tables has been made to folder &quot;{{importResponse.backupLocation}}&quot;. It will be automatically deleted after {{importResponse.backupPeriod}} days.</div><div *ngIf="importOK===false"><b>Import failed</b>. No record has been inserted. Reason: {{importErrorMessage}}</div></div></div><div [ngClass]="{\'slds-hide\':tabToShow!==\'e\'}" class="slds-tabs_default__content"><system-spinner *ngIf="isLoadingTablenames" class="slds-m-top--x-large" style="display:block"></system-spinner><div *ngIf="!isLoadingTablenames"><div *ngIf="!changeExportSettings" class="slds-m-bottom--medium"><button class="slds-button slds-button--neutral" (click)="changeExportSettings=true">change export settings &hellip;</button></div><div *ngIf="changeExportSettings"><div class="slds-button-group slds-m-bottom--medium" role="group"><button class="slds-button slds-button_neutral" (click)="selectAll(true)">{{lang.getLabel(\'LBL_SELECT_ALL\')}}</button> <button class="slds-button slds-button_neutral" (click)="selectAll(false)">{{lang.getLabel(\'LBL_DESELECT_ALL\')}}</button></div><div style="column-width:270px;column-gap:1em" system-multi-select-checkboxes><div *ngFor="let table of selectableTables; let i=index" class="slds-form-element" style="z-index:1"><div class="slds-form-element__control slds-m-bottom--xxx-small"><div class="slds-checkbox"><input type="checkbox" name="selectableTables" id="table{{i}}" [(ngModel)]="table.include"> <label class="slds-checkbox__label" for="table{{i}}"><span class="slds-checkbox_faux"></span> <span class="slds-form-element__label" style="display:inline-block">{{table.name}}</span></label></div></div></div></div><div class="slds-m-vertical--medium"><div><b>{{blacklistedTables.length}} tables are not listed</b>, because they may not be exported/imported <span *ngIf="blacklistedTables.length"><a href="javascript:void(0)" (click)="showBlacklistedTables=!showBlacklistedTables">[show/hide]</a>. If necessary use the following input field &quot;{{lang.getLabel(\'LBL_ADDITIONAL_TABLES\')}}&quot;.</span></div><span *ngIf="showBlacklistedTables">{{blacklistedTables.join(\', \')}}</span></div><div class="slds-form-element slds-m-vertical--medium"><label class="slds-form-element__label" for="additionalTables">{{lang.getLabel(\'LBL_ADDITIONAL_TABLES\')}}</label><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_right"><input id="additionalTables" class="slds-input" type="text" [(ngModel)]="additionalTables"> <button class="slds-button slds-button_icon slds-input__icon slds-input__icon_right" title="Clear" (click)="additionalTables=\'\'"><system-button-icon [icon]="\'clear\'" [size]="\'small\'"></system-button-icon></button></div></div></div><div><button class="slds-button slds-button--brand" (click)="exportTables()" [disabled]="( numberOfSelectedTables === 0 && additionalTables === \'\' ) || isDownloading">{{lang.getLabel(\'LBL_EXPORT\')}}</button></div></div></div></div><a #downloadlink style="display:none" [href]="loadUrl" [download]="fileName"></a></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.metadata,services_1.language,services_1.userpreferences,services_1.modal,services_1.toast])],ConfigTransfer)}();exports.ConfigTransfer=ConfigTransfer;var ModuleConfigManager=function(){function ModuleConfigManager(e,s,t,l,i,a,o,n){var d=this;this.backend=e,this.metadata=s,this.language=t,this.toast=l,this.modalservice=i,this.configurationService=a,this.view=o,this.modal=n,this.component="",this.configValues={},this.crActive=!1,this.change_request_required=!1,this.edit_mode="",this.allowCopyButton=!0,this.allowGlobalModal=!1,this.sysModules=[],this.sysRoles={},this.currentModule="",this.currentComponent="",this.selectedId="",this.selectedComponent={},this.newComponent={},this.componentTree=[],this.currentTableActive="",this.componentModuleList=[],this.treelist=[],this.initialized=!1,this.backend.getRequest("configuration/configurator/entries/sysuiroles").subscribe(function(e){d.sysRoles["*"]="*";for(var s=0,t=e;s<t.length;s++){var l=t[s];d.sysRoles[l.id]=l.name}}),this.backend.getRequest("system/spiceui/admin/modules").subscribe(function(e){d.sysModules=e,d.initialized=!0,d.currentModule="*",d.selectedModule()}),this.checkMode()}var e,s;return Object.defineProperty(ModuleConfigManager.prototype,"getAllowCopyButton",{get:function(){return(0!==Object.keys(this.selectedComponent).length||this.selectedComponent.constructor!==Object)&&this.allowCopyButton},enumerable:!1,configurable:!0}),ModuleConfigManager.prototype.checkMode=function(){var s=this;this.edit_mode=this.configurationService.getCapabilityConfig("core").edit_mode,this.change_request_required=!!this.configurationService.getCapabilityConfig("systemdeployment").change_request_required,"none"!=this.edit_mode&&"custom"!=this.edit_mode&&"all"!=this.edit_mode&&(this.edit_mode="custom"),this.change_request_required?this.backend.getRequest("module/SystemDeploymentCRs/active").subscribe(function(e){""==e.id?(s.setNoneMode(),s.toast.sendToast(s.language.getLabel("LBL_ACTIVATE_CR_WARNING"),"warning",null,3)):"all"==s.edit_mode?s.setAllMode():"custom"==s.edit_mode?s.setCustomMode():s.setNoneMode()}):"all"==this.edit_mode?this.setAllMode():"custom"==this.edit_mode?this.setCustomMode():this.setNoneMode()},ModuleConfigManager.prototype.setNoneMode=function(){this.view.setViewMode(),this.allowCopyButton=!1},ModuleConfigManager.prototype.setCustomMode=function(){"custom"==this.currentTableActive||"default_custom"==this.currentTableActive?this.view.setEditMode():this.view.setViewMode()},ModuleConfigManager.prototype.setAllMode=function(){this.allowGlobalModal=!0,this.view.setEditMode()},ModuleConfigManager.prototype.selectedModule=function(){this.currentComponent="",this.componentTree=[],this.selectedComponent={},"*"==this.currentModule?"default_custom"==this.currentTableActive?this.loadDefaultCustom():this.loadDefault():"custom"==this.currentTableActive?this.loadCustom():this.loadGlobal()},ModuleConfigManager.prototype.loadGlobal=function(){var t=this;this.modal.openModal("SystemLoadingModal").subscribe(function(s){t.selectedComponent={},t.currentTableActive="global",t.checkMode(),"*"!=t.currentModule?t.backend.getRequest("configuration/configurator/entries/sysuicomponentmoduleconf").subscribe(function(e){t.buildTreeList(e),s.instance.self.destroy()}):(t.loadDefault(),s.instance.self.destroy())})},ModuleConfigManager.prototype.loadCustom=function(){var t=this;this.modal.openModal("SystemLoadingModal").subscribe(function(s){t.selectedComponent={},t.currentTableActive="custom",t.checkMode(),"*"!=t.currentModule?t.backend.getRequest("configuration/configurator/entries/sysuicustomcomponentmoduleconf").subscribe(function(e){t.buildTreeList(e),s.instance.self.destroy()}):(t.loadDefaultCustom(),s.instance.self.destroy())})},ModuleConfigManager.prototype.loadDefault=function(){var t=this;this.modal.openModal("SystemLoadingModal").subscribe(function(s){t.currentTableActive="default",t.backend.getRequest("configuration/configurator/entries/sysuicomponentdefaultconf").subscribe(function(e){t.buildTreeList(e),s.instance.self.destroy()})})},ModuleConfigManager.prototype.loadDefaultCustom=function(){var t=this;this.modal.openModal("SystemLoadingModal").subscribe(function(s){t.currentTableActive="default_custom",t.backend.getRequest("configuration/configurator/entries/sysuicustomcomponentdefaultconf").subscribe(function(e){t.buildTreeList(e),s.instance.self.destroy()})})},ModuleConfigManager.prototype.buildTreeList=function(e){for(var d=[],s=function(s){if(s.module==r.currentModule||"*"==r.currentModule){r.componentModuleList.push(s);var e=r.checkRoleName(s.role_id),t={};t={id:s.id,parent_id:s.component,clickable:!0,name:e},r.newComponent&&r.newComponent.id==s.id&&(t.selected=!0,r.selectedOutputItem(t.id)),d.push(t);for(var l=0,i=0,a=d;i<a.length;i++){var o=a[i];s.component==o.id&&(l=1)}if(0==l){var n=s.component;0<r.metadata.getSystemComponents().length&&r.metadata.getSystemComponents().find(function(e){return e.component===s.component})&&"1"==r.metadata.getSystemComponents().find(function(e){return e.component===s.component}).deprecated&&(n+=" | dep."),d.push({id:s.component,parent_id:null,clickable:!1,name:n})}}},r=this,t=0,l=e;t<l.length;t++){s(l[t])}return this.newComponent={},d.sort(function(e,s){return e.name>s.name?1:-1}),this.treelist=d},ModuleConfigManager.prototype.checkRoleName=function(e){return this.sysRoles[e]?this.sysRoles[e]:e},ModuleConfigManager.prototype.selectedOutputItem=function(e){for(var s=0,t=this.componentModuleList;s<t.length;s++){var l=t[s];if(l.id==e){"string"==typeof l.componentconfig&&(l.componentconfig=JSON.parse(l.componentconfig));this.checkRoleName(l.role_id);this.selectedComponent=l,this.component=l.component,this.configValues=l.componentconfig}}},ModuleConfigManager.prototype.saveChanges=function(){var t=this;this.modal.openModal("SystemLoadingModal").subscribe(function(s){if(t.selectedComponent.componentconfig){switch(t.selectedComponent.componentconfig=JSON.stringify(t.selectedComponent.componentconfig),delete t.selectedComponent.role_name,t.currentTableActive){case"default":t.backend.postRequest("configuration/configurator/sysuicomponentdefaultconf/"+t.selectedComponent.id,{},{config:t.selectedComponent}).subscribe(function(e){"success"==e.status&&(s.instance.self.destroy(),t.toast.sendToast("changes saved"))});break;case"default_custom":t.backend.postRequest("configuration/configurator/sysuicustomcomponentdefaultconf/"+t.selectedComponent.id,{},{config:t.selectedComponent}).subscribe(function(e){"success"==e.status&&(s.instance.self.destroy(),t.toast.sendToast("changes saved"))});break;case"global":t.backend.postRequest("configuration/configurator/sysuicomponentmoduleconf/"+t.selectedComponent.id,{},{config:t.selectedComponent}).subscribe(function(e){"success"==e.status&&(s.instance.self.destroy(),t.toast.sendToast("changes saved"))});break;case"custom":t.backend.postRequest("configuration/configurator/sysuicustomcomponentmoduleconf/"+t.selectedComponent.id,{},{config:t.selectedComponent}).subscribe(function(e){"success"==e.status&&(s.instance.self.destroy(),t.toast.sendToast("changes saved"))});break;default:s.instance.self.destroy()}t.selectedComponent.componentconfig=JSON.parse(t.selectedComponent.componentconfig)}})},ModuleConfigManager.prototype.addConf=function(){var s=this;this.modalservice.openModal("ModuleConfigAddDialog").subscribe(function(e){e.instance.mode="add","default_custom"==s.currentTableActive||"custom"==s.currentTableActive?e.instance.currentType="custom":"all"==s.edit_mode?e.instance.currentType="global":e.instance.currentType="custom",e.instance.currentModule=s.currentModule,e.instance.allowGlobal=s.allowGlobalModal,e.instance.response$.subscribe(function(e){s.response(e)})})},ModuleConfigManager.prototype.copyConf=function(){var s=this;this.modalservice.openModal("ModuleConfigAddDialog").subscribe(function(e){e.instance.mode="copy",e.instance.currentComponent=s.selectedComponent,e.instance.currentRole=s.selectedComponent.role_id,e.instance.currentModule=s.currentModule,e.instance.allowGlobal=s.allowGlobalModal,e.instance.response$.subscribe(function(e){s.response(e)})})},ModuleConfigManager.prototype.response=function(e){e.module?this.currentModule=e.module:this.currentModule="*","sysuicomponentdefaultconf"==e.table||"sysuicomponentmoduleconf"==e.table?this.currentTableActive="global":this.currentTableActive="custom","sysuicustomcomponentdefaultconf"==e.table&&(this.currentTableActive="default_custom"),"sysuicustomcomponentmoduleconf"==e.table&&(this.currentTableActive="custom"),"sysuicomponentdefaultconf"==e.table&&(this.currentTableActive="default"),"sysuicomponentmoduleconf"==e.table&&(this.currentTableActive="global"),this.newComponent=e,this.selectedModule()},__decorate([core_1.ViewChild("treecontainer",{read:core_1.ViewContainerRef,static:!0}),__metadata("design:type","function"==typeof(e=void 0!==core_1.ViewContainerRef&&core_1.ViewContainerRef)?e:Object)],ModuleConfigManager.prototype,"treecontainer",void 0),__decorate([core_1.ViewChild("addconfigcontainer",{read:core_1.ViewContainerRef,static:!0}),__metadata("design:type","function"==typeof(s=void 0!==core_1.ViewContainerRef&&core_1.ViewContainerRef)?s:Object)],ModuleConfigManager.prototype,"addconfigcontainer",void 0),ModuleConfigManager=__decorate([core_1.Component({template:'<div system-to-bottom-noscroll><div class="slds-p-around--medium slds-theme--shade"><div class="slds-page-header__row"><div class="slds-page-header__col-title"><div class="slds-media"><system-icon icon="custom19" sprite="custom"></system-icon><div class="slds-media__body"><div class="slds-page-header__name"><div class="slds-page-header__name-title"><h1><span class="slds-page-header__title slds-truncate"><system-label label="LBL_CONFIGURATION_MANAGER"></system-label></span></h1></div></div><div class="slds-page-header__name-meta slds-grid"></div></div></div></div></div></div><div class="slds-grid slds-form--inline slds-p-around--small slds-border--bottom"><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_MODULE"></system-label></label><div class="slds-form-element__control"><div class="slds-select_container" style="min-width:250px;"><select class="slds-select" [(ngModel)]="currentModule" [disabled]="!initialized" (change)="selectedModule()"><option value="*">*</option><option *ngFor="let sysModule of sysModules" [value]="sysModule.module">{{sysModule.module}}</option></select></div></div></div></div><div *ngIf="!initialized" class="slds-align_absolute-center slds-p-around--large"><system-spinner></system-spinner></div><div class="slds-grid" [ngClass]="{\'slds-hidden\':!initialized}"><div class="slds-size--2-of-5 slds-border--right"><div class="slds-tree_container" role="application" style="max-width: none;"><div class="slds-tabs_default" style="background-color: transparent"><ul class="slds-tabs_default__nav" role="tablist"><li class="slds-tabs_default__item slds-is-active" [ngClass]="{\'slds-is-active\': currentTableActive == \'global\' || currentTableActive == \'default\'}" title="Item One" role="presentation"><div class="slds-grid slds-grid--vertical-align-center"><system-custom-icon icon="global" size="x-small"></system-custom-icon><a class="slds-tabs_default__link" href="javascript:void(0);" role="tab" tabindex="0" (click)="loadGlobal()" id="tab-default-1__item"><system-label label="LBL_GLOBAL"></system-label></a></div></li><li class="slds-tabs_default__item" [ngClass]="{\'slds-is-active\': currentTableActive == \'custom\' || currentTableActive == \'default_custom\'}" title="Item Two" role="presentation"><div class="slds-grid slds-grid--vertical-align-center"><system-custom-icon icon="custom" size="x-small"></system-custom-icon><a class="slds-tabs_default__link" href="javascript:void(0);" role="tab" tabindex="-1" aria-selected="false" aria-controls="tab-default-2" (click)="loadCustom()" id="tab-default-2__item"><system-label label="LBL_CUSTOM"></system-label></a></div></li></ul><div #treecontainer class="slds-tabs_default__content slds-p-vertical_none" role="tabpanel"><div class="slds-scrollable_y slds-border_bottom" system-to-bottom [marginBottom]="45"><system-tree [sourceList]="treelist" [selectedItem]="selectedComponent.id" (selectedItemChange)="selectedOutputItem($event)"></system-tree></div><div #addconfigcontainer class="slds-p-around--small slds-align--absolute-center"><button [disabled]="!view.isEditMode()" class="slds-button slds-button--icon" title="add item" (click)="addConf()"><system-utility-icon [icon]="\'new\'" [size]="\'xx-small\'" [addclasses]="\'slds-section__title-action-icon slds-button__icon slds-button__icon_left\'"></system-utility-icon></button></div></div></div></div></div><div class="slds-size--3-of-5 slds-p-horizontal--small slds-p-top--x-small"><div class="slds-grid slds-grid--vertical-align-center"><div *ngIf="selectedComponent.component" class="slds-text-heading_small">{{selectedComponent.component}} / {{selectedComponent.role_name}}</div><div class="slds-col--bump-left"><button [disabled]="!getAllowCopyButton" type="button" class="slds-m-bottom_small slds-col--bump-left slds-button slds-button--neutral" (click)="copyConf()"><system-label label="LBL_COPY"></system-label></button> <button [disabled]="!view.isEditMode()" type="button" class="slds-m-bottom_small slds-col--bump-left slds-button slds-button--brand" (click)="saveChanges()"><system-label label="LBL_SAVE"></system-label></button></div></div><workbench-config [component]="component" [configValues]="configValues"></workbench-config></div></div></div>',providers:[services_1.view]}),__metadata("design:paramtypes",[services_1.backend,services_1.metadata,services_1.language,services_1.toast,services_1.modal,services_1.configurationService,services_1.view,services_1.modal])],ModuleConfigManager)}();exports.ModuleConfigManager=ModuleConfigManager;var WorkbenchHeader=function(){function e(e){this.language=e,this.icon="custom"}return __decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"titlelabel",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"icon",void 0),e=__decorate([core_1.Component({selector:"workbench-header",template:'<div class="slds-p-around--medium slds-theme--shade"><div class="slds-page-header__row"><div class="slds-page-header__col-title"><div class="slds-media"><system-icon [icon]="icon"></system-icon><div class="slds-media__body"><div class="slds-page-header__name"><div class="slds-page-header__name-title"><h1><span class="slds-page-header__title slds-truncate"><system-label [label]="titlelabel"></system-label></span></h1></div></div><p class="slds-page-header__name-meta"><ng-content></ng-content></p></div></div></div><ng-content select="workbench-header-controls"></ng-content></div></div>'}),__metadata("design:paramtypes",[services_1.language])],e)}();exports.WorkbenchHeader=WorkbenchHeader;var WorkbenchHeaderControls=function(){function e(){}return e=__decorate([core_1.Component({selector:"workbench-header-controls",template:'<div class="slds-page-header__col-actions"><div class="slds-page-header__controls"><div class="slds-page-header__control"><ng-content></ng-content></div></div></div>'})],e)}();exports.WorkbenchHeaderControls=WorkbenchHeaderControls;var WorkbenchConfig=function(){function WorkbenchConfig(e,s,t){this.backend=e,this.metadata=s,this.language=t,this.component="",this.configValues={},this.configOptions=[],this.optionsElements=[]}var e;return WorkbenchConfig.prototype.ngOnChanges=function(e){for(var t=this,s=0,l=this.optionsElements;s<l.length;s++){(a=l[s]).destroy()}this.optionsElements=[],this.configOptions=[];var i=this.metadata.getComponentConfigOptions(this.component);for(var a in i)this.configOptions.push({option:a,type:i[a].type?i[a].type:"string",description:i[a].description?i[a].description:""});for(var o=function(s){var e="";e="WorkbenchConfigOption"+(s.type.charAt(0).toUpperCase()+s.type.slice(1)),n.metadata.checkComponent(e)||(e="WorkbenchConfigOptionDefault"),n.metadata.addComponent(e,n.optionscontainer).subscribe(function(e){t.optionsElements.push(e),e.instance.option=s,e.instance.configValues=t.configValues})},n=this,d=0,r=this.configOptions;d<r.length;d++){o(r[d])}},__decorate([core_1.ViewChild("optionscontainer",{read:core_1.ViewContainerRef,static:!0}),__metadata("design:type","function"==typeof(e=void 0!==core_1.ViewContainerRef&&core_1.ViewContainerRef)?e:Object)],WorkbenchConfig.prototype,"optionscontainer",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],WorkbenchConfig.prototype,"component",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],WorkbenchConfig.prototype,"configValues",void 0),WorkbenchConfig=__decorate([core_1.Component({template:"<div #optionscontainer></div>",selector:"workbench-config"}),__metadata("design:paramtypes",[services_1.backend,services_1.metadata,services_1.language])],WorkbenchConfig)}();exports.WorkbenchConfig=WorkbenchConfig;var WorkbenchConfigLabel=function(){function e(){this.option="",this.description=""}return __decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"option",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"description",void 0),e=__decorate([core_1.Component({template:'<div class="slds-grid slds-grid--vertical-align-center"><label class="slds-form-element__label">{{option}}</label><div *ngIf="description" class="slds-is-relative"><div class="slds-form-element"><div class="slds-form-element__icon slds-align-middle"><button class="slds-button slds-button_icon slds-button slds-button_icon" aria-describedby="help" title="Description" (mouseenter)="showInfo = true" (mouseleave)="showInfo = false"><system-button-icon [size]="\'small\'" [icon]="\'info\'"></system-button-icon></button></div></div><div *ngIf="showInfo" class="slds-popover slds-popover_tooltip slds-nubbin_bottom-right slds-rise-from-ground slds-is-absolute" role="tooltip" style="bottom: 25px; right: -17px; width: 320px; height: auto;"><div class="slds-popover__body slds-scrollable_y">{{description}}</div></div></div></div>',selector:"workbench-config-label"})],e)}();exports.WorkbenchConfigLabel=WorkbenchConfigLabel;var ModuleConfigAddDialog=function(){function ModuleConfigAddDialog(e,s,t,l,i,a){this.backend=e,this.metadata=s,this.language=t,this.modelutilities=l,this.utils=i,this.toast=a,this.mode="",this.currentRole="",this.currentType="",this.currentModule="",this.allowGlobal=!1,this.response$=new core_1.EventEmitter,this.showDeprecatedWarning=!1,this.types=[{value:"custom",text:"LBL_CUSTOM"},{value:"global",text:"LBL_GLOBAL"}],this.compSelectList=[],this.compDisabled=!1,this.moduleSelectList=[],this.roleSelectList=[]}var e;return Object.defineProperty(ModuleConfigAddDialog.prototype,"roleSelectedItem",{get:function(){return this.roleselecteditem},set:function(e){this.roleselecteditem=e},enumerable:!1,configurable:!0}),Object.defineProperty(ModuleConfigAddDialog.prototype,"moduleSelectedItem",{get:function(){return this.moduleselecteditem},set:function(e){this.moduleselecteditem=e},enumerable:!1,configurable:!0}),Object.defineProperty(ModuleConfigAddDialog.prototype,"compSelectedItem",{get:function(){return this.compselecteditem},set:function(e){this.compselecteditem=e,this.showDeprecatedWarning=!0,this.showDeprecatedWarning="1"==e.deprecated},enumerable:!1,configurable:!0}),ModuleConfigAddDialog.prototype.ngOnInit=function(){var i=this;this.allowGlobal||(this.types.pop(),this.currentType="custom"),this.backend.getRequest("configuration/configurator/entries/sysmodules").subscribe(function(e){i.moduleSelectList.push({id:"*",name:"*"}),"add"==i.mode&&"*"==i.currentModule&&(i.moduleSelectedItem={id:"*",name:"*"});for(var s=0,t=e;s<t.length;s++){var l=t[s];i.moduleSelectList.push({id:l.id,name:l.module,group:"global"}),"add"==i.mode&&l.module==i.currentModule&&(i.moduleSelectedItem={id:l.id,name:l.module,group:"global"})}i.sortArray(i.moduleSelectList),i.moduleSelectList=Object.assign([],i.moduleSelectList)}),this.backend.getRequest("configuration/configurator/entries/syscustommodules").subscribe(function(e){for(var s=0,t=e;s<t.length;s++){var l=t[s];i.moduleSelectList.push({id:l.id,name:l.module,group:"custom"}),"add"==i.mode&&l.module==i.currentModule&&(i.moduleSelectedItem={id:l.id,name:l.module,group:"custom"})}i.sortArray(i.moduleSelectList),i.moduleSelectList=Object.assign([],i.moduleSelectList)}),this.backend.getRequest("configuration/configurator/entries/sysuiroles").subscribe(function(e){i.roleSelectList.push({id:"*",name:"*"});for(var s=0,t=e;s<t.length;s++){var l=t[s];i.roleSelectList.push({id:l.id,name:l.name,group:"global"}),"copy"==i.mode&&l.id==i.currentRole&&(i.roleSelectedItem={id:l.id,name:l.name,group:"global"}),"*"==i.currentRole&&(i.roleSelectedItem={id:"*",name:"*"})}i.sortArray(i.roleSelectList),i.roleSelectList=Object.assign([],i.roleSelectList)}),this.backend.getRequest("configuration/configurator/entries/sysuicustomroles").subscribe(function(e){for(var s=0,t=e;s<t.length;s++){var l=t[s];i.roleSelectList.push({id:l.id,name:l.name,group:"custom"}),"copy"==i.mode&&l.id==i.currentRole&&(i.roleSelectedItem={id:l.id,name:l.name,group:"custom"}),"*"==i.currentRole&&(i.roleSelectedItem={id:"*",name:"*"})}i.sortArray(i.roleSelectList),i.roleSelectList=Object.assign([],i.roleSelectList)}),this.backend.getRequest("configuration/configurator/entries/sysuiobjectrepository").subscribe(function(e){for(var s=0,t=e;s<t.length;s++){var l=t[s];i.compSelectList.push({id:l.id,name:l.object,deprecated:l.deprecated,group:"global"}),"copy"==i.mode&&(i.compDisabled=!0,i.compSelectedItem={id:i.currentComponent.id,name:i.currentComponent.component})}i.sortArray(i.compSelectList),i.compSelectList=Object.assign([],i.compSelectList)}),this.backend.getRequest("configuration/configurator/entries/sysuicustomobjectrepository").subscribe(function(e){for(var s=0,t=e;s<t.length;s++){var l=t[s];i.compSelectList.push({id:l.id,name:l.object,deprecated:l.deprecated,group:"custom"}),"copy"==i.mode&&(i.compDisabled=!0,i.compSelectedItem={id:i.currentComponent.id,name:i.currentComponent.component})}i.sortArray(i.compSelectList),i.compSelectList=Object.assign([],i.compSelectList)})},ModuleConfigAddDialog.prototype.validate=function(){if("*"==this.currentModule){if(this.compSelectedItem&&this.roleSelectedItem&&this.currentType)return!1}else if(this.compSelectedItem&&this.moduleSelectedItem&&this.roleSelectedItem&&this.currentType)return!1;return!0},ModuleConfigAddDialog.prototype.sortArray=function(e){return e.sort(function(e,s){var t=e.name.toLowerCase(),l=s.name.toLowerCase();return t<l?-1:l<t?1:0}),e},ModuleConfigAddDialog.prototype.closeDialog=function(){this.self.destroy()},ModuleConfigAddDialog.prototype.save=function(){var e=this.currentType,s="",t={},l=this.modelutilities.generateGuid();if(this.currentComponent){var i=JSON.stringify(this.currentComponent.componentconfig);t={component:this.currentComponent.component,componentconfig:i}}else t={component:this.compSelectedItem.name,componentconfig:"{}"};t.id=l,t.role_id=this.roleSelectedItem.id,"*"!=t.module&&(t.module=this.moduleSelectedItem.name),"custom"==e&&"*"==t.module&&(s="sysuicustomcomponentdefaultconf"),"custom"==e&&"*"!=t.module&&(s="sysuicustomcomponentmoduleconf"),"global"==e&&"*"==t.module&&(s="sysuicomponentdefaultconf"),"global"==e&&"*"!=t.module&&(s="sysuicomponentmoduleconf"),this.saveComponent(t,s)},ModuleConfigAddDialog.prototype.saveComponent=function(s,t){var l=this;s.type=this.currentType;var e="";"*"==s.module?(e="componentdefaultalreadyexists",delete s.module):e="componentmodulealreadyexists",this.backend.getRequest("configuration/spiceui/core/"+e,s).subscribe(function(e){delete s.type,0==e?l.backend.postRequest("configuration/configurator/"+t+"/"+s.id,null,{config:s}).subscribe(function(e){l.toast.sendToast("saved"),s.table=t,l.response$.emit(s),l.self.destroy()},function(e){l.toast.sendAlert("saving failed!"),console.error(e)}):l.toast.sendAlert("Configuration already exists!")},function(e){l.toast.sendAlert("Saving configuration failed!"),console.error(e)})},__decorate([core_1.Input(),__metadata("design:type",String)],ModuleConfigAddDialog.prototype,"mode",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],ModuleConfigAddDialog.prototype,"currentComponent",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],ModuleConfigAddDialog.prototype,"currentRole",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],ModuleConfigAddDialog.prototype,"currentType",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],ModuleConfigAddDialog.prototype,"currentModule",void 0),__decorate([core_1.Input(),__metadata("design:type",Boolean)],ModuleConfigAddDialog.prototype,"allowGlobal",void 0),__decorate([core_1.Output("response"),__metadata("design:type","function"==typeof(e=void 0!==core_1.EventEmitter&&core_1.EventEmitter)?e:Object)],ModuleConfigAddDialog.prototype,"response$",void 0),ModuleConfigAddDialog=__decorate([core_1.Component({selector:"moduleconfig-add-dialog",template:'<div role="dialog" tabindex="-1" aria-labelledby="header43" class="slds-modal slds-fade-in-open slds-modal_medium"><div class="slds-modal__container"><div class="slds-modal__header"><button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" (click)="closeDialog()"><system-button-icon [icon]="\'close\'" [size]="\'large\'"></system-button-icon></button><h2 id="header43" *ngIf="this.mode == \'copy\'" class="slds-text-heading--medium"><system-label label="LBL_COPY_COMPONENT"></system-label></h2><h2 id="header44" *ngIf="this.mode == \'add\'" class="slds-text-heading--medium"><system-label label="LBL_ADD_COMPONENT"></system-label></h2></div><div class="slds-modal__content slds-p-around--medium" style="height: 355px;"><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_SCOPE"></system-label></label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="currentType"><option *ngFor="let type of types" [value]="type.value"><system-label [label]="type.text"></system-label></option></select></div></div></div><system-select [selectList]="moduleSelectList" [(selectedItem)]="moduleSelectedItem" [label]="\'LBL_MODULES\'"></system-select><system-select [selectList]="compSelectList" [(selectedItem)]="compSelectedItem" [disabled]="compDisabled" [label]="\'LBL_COMPONENT\'"></system-select><div *ngIf="showDeprecatedWarning" class="slds-notify slds-notify_alert slds-theme_alert-texture slds-theme_warning" role="alert"><span class="slds-assistive-text">warning</span> <span class="slds-icon_container slds-icon-utility-warning slds-m-right_x-small" title="Description of icon when needed"><svg class="slds-icon slds-icon_x-small" aria-hidden="true"><use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#warning"></use></svg></span><h2><system-label label="LBL_DEPRECATED_MSG"></system-label></h2></div><system-select [selectList]="roleSelectList" [(selectedItem)]="roleSelectedItem" [label]="\'LBL_ROLES\'"></system-select><div *ngIf="this.mode == \'copy\'" class="slds-text-align_center slds-p-vertical_small slds-text-heading_small"><system-label label="LBL_NOTE_COPY_CONFIG_INFO"></system-label></div></div><div class="slds-modal__footer"><button class="slds-button slds-button--neutral" (click)="closeDialog()"><system-label label="LBL_CANCEL"></system-label></button> <button class="slds-button slds-button--brand" (click)="save()" [disabled]="validate()"><span *ngIf="this.mode == \'add\'"><system-label label="LBL_ADD"></system-label></span> <span *ngIf="this.mode == \'copy\'"><system-label label="LBL_COPY"></system-label></span></button></div></div></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.metadata,services_1.language,services_1.modelutilities,services_1.modelutilities,services_1.toast])],ModuleConfigAddDialog)}();exports.ModuleConfigAddDialog=ModuleConfigAddDialog;var FieldsetManagerCopyDialog=function(){function FieldsetManagerCopyDialog(e){this.language=e,this.metaFieldSets=[],this.fieldset="",this.sysModules=[],this.edit_mode="",this.closedialog=new core_1.EventEmitter,this.currentName="",this.currentType="",this.currentModule=""}var e;return FieldsetManagerCopyDialog.prototype.ngOnInit=function(){this.fieldset&&(this.currentName=this.metaFieldSets[this.fieldset].name,this.currentModule=this.metaFieldSets[this.fieldset].module,"global"==this.edit_mode?this.currentType=this.metaFieldSets[this.fieldset].type:this.currentType="custom")},FieldsetManagerCopyDialog.prototype.closeDialog=function(){this.self.destroy()},FieldsetManagerCopyDialog.prototype.onModalEscX=function(){this.closeDialog()},FieldsetManagerCopyDialog.prototype.copy=function(){this.closedialog.emit({fieldset:this.metaFieldSets[this.fieldset],type:this.currentType,module:this.currentModule,name:this.currentName}),this.self.destroy()},FieldsetManagerCopyDialog.prototype.validate=function(){return!(this.fieldset&&this.currentModule&&this.currentType)},__decorate([core_1.Input(),__metadata("design:type",Array)],FieldsetManagerCopyDialog.prototype,"metaFieldSets",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],FieldsetManagerCopyDialog.prototype,"fieldset",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],FieldsetManagerCopyDialog.prototype,"sysModules",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],FieldsetManagerCopyDialog.prototype,"edit_mode",void 0),__decorate([core_1.Output(),__metadata("design:type","function"==typeof(e=void 0!==core_1.EventEmitter&&core_1.EventEmitter)?e:Object)],FieldsetManagerCopyDialog.prototype,"closedialog",void 0),FieldsetManagerCopyDialog=__decorate([core_1.Component({selector:"fieldsetmanager-copy-dialog",template:'<div role="dialog" tabindex="-1" aria-labelledby="header43" class="slds-modal slds-fade-in-open"><div class="slds-modal__container"><div class="slds-modal__header slds-theme--shade"><button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" (click)="closeDialog()"><system-button-icon [icon]="\'close\'" [size]="\'large\'"></system-button-icon></button><h2 id="header43" class="slds-text-heading--medium"><system-label label="LBL_COPY"></system-label></h2></div><div class="slds-modal__content slds-p-around--medium"><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_MODULE"></system-label></label><div class="slds-form-element__control" style="min-width:250px;"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="currentModule" [disabled]="sysModules.length == 0"><option value="*">*</option><option *ngFor="let sysModule of sysModules" [value]="sysModule.module">{{sysModule.module}}</option></select></div></div></div><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_SCOPE"></system-label></label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="currentType"><option value="custom"><system-label label="LBL_CUSTOM"></system-label></option><option *ngIf="edit_mode == \'all\'" value="global"><system-label label="LBL_GLOBAL"></system-label></option></select></div></div></div><div class="slds-form-element slds-m-top--small"><label class="slds-form-element__label"><system-label label="LBL_FIELDSET"></system-label></label><div class="slds-form-element__control"><input type="text" class="slds-input" placeholder="name" [(ngModel)]="currentName"></div></div></div><div class="slds-modal__footer"><button class="slds-button slds-button--neutral" (click)="closeDialog()"><system-label label="LBL_CANCEL"></system-label></button> <button class="slds-button slds-button--brand" [disabled]="validate()" (click)="copy()"><system-label label="LBL_SAVE"></system-label></button></div></div></div>'}),__metadata("design:paramtypes",[services_1.language])],FieldsetManagerCopyDialog)}();exports.FieldsetManagerCopyDialog=FieldsetManagerCopyDialog;var WorkbenchConfigOptionFieldset=function(){function WorkbenchConfigOptionFieldset(e,s){this.language=e,this.view=s,this.option={}}return WorkbenchConfigOptionFieldset=__decorate([core_1.Component({selector:"workbench-config-option-fieldset",template:'<div class="slds-form-element slds-m-vertical--xxx-small"><workbench-config-label [option]="option.option" [description]="option.description"></workbench-config-label><system-input-fieldset [(ngModel)]="configValues[option.option]" [disabled]="!view.isEditMode()"></system-input-fieldset></div>'}),__metadata("design:paramtypes",[services_1.language,services_1.view])],WorkbenchConfigOptionFieldset)}();exports.WorkbenchConfigOptionFieldset=WorkbenchConfigOptionFieldset;var WorkbenchConfigOptionModulefilter=function(){function WorkbenchConfigOptionModulefilter(e,s,t,l){this.language=e,this.metadata=s,this.cdRef=t,this.view=l,this.configValues=[],this.option={},this.modules=[],this.modulefilters=[],this.module=""}var e;return WorkbenchConfigOptionModulefilter.prototype.ngAfterViewInit=function(){this.modulefilters=this.metadata.getModuleFilters(),this.modules=this.metadata.getModules(),this.modules.sort(),this.configValues[this.option.option]&&this.metadata.getModuleFilter(this.configValues[this.option.option])&&(this.module=this.metadata.getModuleFilter(this.configValues[this.option.option]).module),this.cdRef.detectChanges()},WorkbenchConfigOptionModulefilter=__decorate([core_1.Component({selector:"workbench-config-option-module-filter",template:'<div class="slds-form-element slds-m-vertical--xxx-small"><workbench-config-label [option]="option.option" [description]="option.description"></workbench-config-label><system-input-module-filter [(ngModel)]="configValues[option.option]" [disabled]="!view.isEditMode()"></system-input-module-filter></div>'}),__metadata("design:paramtypes",[services_1.language,services_1.metadata,"function"==typeof(e=void 0!==core_1.ChangeDetectorRef&&core_1.ChangeDetectorRef)?e:Object,services_1.view])],WorkbenchConfigOptionModulefilter)}();exports.WorkbenchConfigOptionModulefilter=WorkbenchConfigOptionModulefilter;var WorkbenchConfigOptionActionset=function(){function WorkbenchConfigOptionActionset(e,s){this.language=e,this.view=s,this.configValues=[],this.option={}}return WorkbenchConfigOptionActionset=__decorate([core_1.Component({selector:"workbench-config-option-actionset",template:'<div class="slds-form-element slds-m-vertical--xxx-small"><workbench-config-label [option]="option.option" [description]="option.description"></workbench-config-label><system-input-actionset [(ngModel)]="configValues[option.option]" [disabled]="!view.isEditMode()"></system-input-actionset></div>'}),__metadata("design:paramtypes",[services_1.language,services_1.view])],WorkbenchConfigOptionActionset)}();exports.WorkbenchConfigOptionActionset=WorkbenchConfigOptionActionset;var WorkbenchConfigOptionBoolean=function(){function WorkbenchConfigOptionBoolean(e){this.view=e,this.configValues=[],this.option={},this.objtype="",this.showInfo=!1}return WorkbenchConfigOptionBoolean=__decorate([core_1.Component({selector:"workbench-config-option-boolean",template:'<div class="slds-form-element slds-p-vertical--x-small"><div class="slds-form-element__control slds-grid slds-grid--vertical-align-center"><div class="slds-checkbox"><input [disabled]="!view.isEditMode()" class="slds-float_left" type="checkbox" name="options" [id]="option.option" [(ngModel)]="configValues[option.option]"> <label class="slds-checkbox__label" [attr.for]="option.option"><span class="slds-checkbox_faux"></span></label></div><workbench-config-label [option]="option.option" [description]="option.description"></workbench-config-label></div></div>'}),__metadata("design:paramtypes",[services_1.view])],WorkbenchConfigOptionBoolean)}();exports.WorkbenchConfigOptionBoolean=WorkbenchConfigOptionBoolean;var WorkbenchConfigOptionComponentset=function(){function WorkbenchConfigOptionComponentset(e,s){this.language=e,this.view=s,this.configValues=[],this.option={}}return WorkbenchConfigOptionComponentset=__decorate([core_1.Component({selector:"workbench-config-option-componentset",template:'<div class="slds-form-element slds-m-vertical--xxx-small"><workbench-config-label [option]="option.option" [description]="option.description"></workbench-config-label><system-input-componentset [(ngModel)]="configValues[option.option]" [disabled]="!view.isEditMode()"></system-input-componentset></div>'}),__metadata("design:paramtypes",[services_1.language,services_1.view])],WorkbenchConfigOptionComponentset)}();exports.WorkbenchConfigOptionComponentset=WorkbenchConfigOptionComponentset;var WorkbenchConfigOptionModule=function(){function WorkbenchConfigOptionModule(e,s,t,l,i,a,o,n){this.backend=e,this.metadata=s,this.language=t,this.modelutilities=l,this.broadcast=i,this.toast=a,this.cdRef=o,this.view=n,this.option={},this.objtype="",this.modules=[]}var e;return WorkbenchConfigOptionModule.prototype.ngAfterViewInit=function(){this.modules=this.metadata.getModules().sort(),this.cdRef.detectChanges()},__decorate([core_1.Input(),__metadata("design:type",Object)],WorkbenchConfigOptionModule.prototype,"configValues",void 0),WorkbenchConfigOptionModule=__decorate([core_1.Component({selector:"workbench-config-option-componentset",template:'<div class="slds-form-element slds-m-vertical--xxx-small"><workbench-config-label [option]="option.option" [description]="option.description"></workbench-config-label><system-input-module [(ngModel)]="configValues[option.option]"></system-input-module></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.metadata,services_1.language,services_1.modelutilities,services_1.broadcast,services_1.toast,"function"==typeof(e=void 0!==core_1.ChangeDetectorRef&&core_1.ChangeDetectorRef)?e:Object,services_1.view])],WorkbenchConfigOptionModule)}();exports.WorkbenchConfigOptionModule=WorkbenchConfigOptionModule;var WorkbenchConfigOptionDefault=function(){function WorkbenchConfigOptionDefault(e){this.view=e,this.configValues=[],this.option={},this.showInfo=!1}return Object.defineProperty(WorkbenchConfigOptionDefault.prototype,"optionValue",{get:function(){return this.configValues[this.option.option]},set:function(e){this.configValues[this.option.option]=e},enumerable:!1,configurable:!0}),__decorate([core_1.Input(),__metadata("design:type",Object)],WorkbenchConfigOptionDefault.prototype,"configValues",void 0),WorkbenchConfigOptionDefault=__decorate([core_1.Component({selector:"workbench-config-option-default",template:'<div class="slds-form-element slds-m-vertical--xxx-small"><workbench-config-label [option]="option.option" [description]="option.description"></workbench-config-label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [(ngModel)]="optionValue"></div></div>'}),__metadata("design:paramtypes",[services_1.view])],WorkbenchConfigOptionDefault)}();exports.WorkbenchConfigOptionDefault=WorkbenchConfigOptionDefault;var WorkbenchConfigOptionLabel=function(){function WorkbenchConfigOptionLabel(e){this.view=e,this.configValues=[],this.option={}}return WorkbenchConfigOptionLabel=__decorate([core_1.Component({selector:"workbench-config-option-label",template:'<div class="slds-form-element slds-m-vertical--xxx-small"><workbench-config-label [option]="option.option" [description]="option.description"></workbench-config-label><system-input-label [(ngModel)]="configValues[option.option]"></system-input-label></div>'}),__metadata("design:paramtypes",[services_1.view])],WorkbenchConfigOptionLabel)}();exports.WorkbenchConfigOptionLabel=WorkbenchConfigOptionLabel;var WorkbenchConfigOptionMethod=function(){function e(e,s){this.language=e,this.view=s,this.option={}}return e=__decorate([core_1.Component({selector:"workbench-config-option-method",template:'<div class="slds-form-element slds-m-vertical--xxx-small"><workbench-config-label [option]="option.option" [description]="option.description"></workbench-config-label><system-input-backend-method [(ngModel)]="configValues[option.option]" [disabled]="!view.isEditMode()"></system-input-backend-method></div>'}),__metadata("design:paramtypes",[services_1.language,services_1.view])],e)}();exports.WorkbenchConfigOptionMethod=WorkbenchConfigOptionMethod;var ObjectRepositoryManagerFilter=function(){function e(){}return e.prototype.transform=function(e,s){if(!s)return e;for(var t=[],l=0,i=e;l<i.length;l++){var a=i[l];0<=a.object.toLowerCase().indexOf(s.toLowerCase())&&t.push(a)}return t},e=__decorate([core_1.Pipe({name:"objectrepositorymanagerfilter"})],e)}();exports.ObjectRepositoryManagerFilter=ObjectRepositoryManagerFilter;var ObjectRepositoryManager=function(){function ObjectRepositoryManager(e,s,t,l,i,a,o,n,d){var r=this;this.backend=e,this.metadata=s,this.language=t,this.modalservice=l,this.modelutilities=i,this.modal=a,this.toast=o,this.configurationService=n,this.view=d,this.treelist=[],this.edit_mode="custom",this.change_request_required=!1,this.crNoneActive=!1,this.moduleReposSelect=[],this.moduleRepos=[],this.modulereposselecteditem={},this.objrepoList=[],this.configList={},this.currentConfigArray=[],this.objectFilter="",this.fieldTypeList=["string","label","boolean","fieldset","actionset","componentset","module","modulefilter"],this.newRepo={},this.emptyRepo={component:"",componentconfig:"",description:"",id:"",module:"",object:"",package:""},this.currentModule={},this.newModule={},this.emptyModule={id:"",module:"",path:"",description:"",package:"",version:"",scope:"custom"},this.currentObjRepo={},this.backend.getRequest("configuration/configurator/entries/sysuimodulerepository").subscribe(function(e){for(var s=0,t=e;s<t.length;s++){var l=t[s];r.moduleRepos.push(l);var i;i={id:l.id,name:l.module,group:"global"},r.moduleReposSelect.push(i)}r.moduleReposSelect=Object.assign([],r.moduleReposSelect)}),this.backend.getRequest("configuration/configurator/entries/sysuicustommodulerepository").subscribe(function(e){for(var s=0,t=e;s<t.length;s++){var l=t[s];r.moduleRepos.push(l);var i;i={id:l.id,name:l.module,group:"custom"},r.moduleReposSelect.push(i)}r.moduleReposSelect=Object.assign([],r.moduleReposSelect)}),this.checkMode()}return Object.defineProperty(ObjectRepositoryManager.prototype,"moduleReposSelectedItem",{get:function(){return this.modulereposselecteditem},set:function(i){var a=this;"global"==(this.modulereposselecteditem=i).group?this.backend.getRequest("configuration/configurator/entries/sysuiobjectrepository").subscribe(function(e){a.objrepoList=[];for(var s=0,t=e;s<t.length;s++){var l=t[s];i.id==l.module&&a.objrepoList.push(l)}}):"custom"==i.group?this.backend.getRequest("configuration/configurator/entries/sysuicustomobjectrepository").subscribe(function(e){a.objrepoList=[];for(var s=0,t=e;s<t.length;s++){var l=t[s];i.id==l.module&&a.objrepoList.push(l)}}):console.error("Damaged item!"),this.objrepoList.sort(function(e,s){return e.object<s.object?1:-1});for(var e=0,s=this.moduleRepos;e<s.length;e++){var t=s[e];t.id==i.id&&(this.currentModule=t,this.currentModule.scope=i.group)}this.checkMode()},enumerable:!1,configurable:!0}),ObjectRepositoryManager.prototype.updateField=function(e){this.currentObjRepo.description=e},ObjectRepositoryManager.prototype.updateDeprecated=function(){this.currentObjRepo.deprecated="1"==this.currentObjRepo.deprecated?"0":"1"},ObjectRepositoryManager.prototype.checkMode=function(){var s=this;this.edit_mode=this.configurationService.getCapabilityConfig("core").edit_mode,this.change_request_required=this.configurationService.getCapabilityConfig("systemdeployment").change_request_required,"none"!=this.edit_mode&&"custom"!=this.edit_mode&&"all"!=this.edit_mode&&(this.edit_mode="custom"),this.change_request_required?this.backend.getRequest("module/SystemDeploymentCRs/active").subscribe(function(e){""==e.id?(s.setNoneMode(),s.crNoneActive=!0,s.toast.sendToast(s.language.getLabel("LBL_ACTIVATE_CR_WARNING"),"warning",null,3)):(s.crNoneActive=!1,"all"==s.edit_mode?s.setAllMode():"custom"==s.edit_mode?s.setCustomMode():s.setNoneMode())}):(this.crNoneActive=!1,"all"==this.edit_mode?this.setAllMode():"custom"==this.edit_mode?this.setCustomMode():this.setNoneMode())},ObjectRepositoryManager.prototype.setNoneMode=function(){this.view.setViewMode()},ObjectRepositoryManager.prototype.setCustomMode=function(){"custom"==this.currentModule.scope?this.view.setEditMode():this.view.setViewMode()},ObjectRepositoryManager.prototype.setAllMode=function(){this.view.setEditMode()},ObjectRepositoryManager.prototype.clickObjRepo=function(e){this.currentObjRepo=e,this.currentConfigArray=[];try{this.configList=JSON.parse(this.currentObjRepo.componentconfig);var s=0;for(var t in this.configList)if(this.configList.hasOwnProperty(t)){var l=void 0;l=this.configList[t].description?this.configList[t].description:"";var i={id:s,name:t,type:this.configList[t].type,description:l};this.currentConfigArray.push(i),s++}}catch(e){console.warn("JSON is invalid or empty!")}},ObjectRepositoryManager.prototype.checkCurrentObjRepo=function(e){return this.currentObjRepo.id==e},ObjectRepositoryManager.prototype.addConfig=function(){this.currentConfigArray.push({id:this.currentConfigArray.length+1,name:"",type:""})},ObjectRepositoryManager.prototype.deleteConfig=function(e){this.currentConfigArray.splice(e,1)},ObjectRepositoryManager.prototype.saveChanges=function(){var r=this;this.modal.openModal("SystemLoadingModal").subscribe(function(t){for(var e={},s=!0,l=0,i=__spreadArray([],r.currentConfigArray);l<i.length;l++){var a=i[l];if(""!=a.type&&""!=a.name){var o={};o.type=a.type;var n="description";a.description?o[n]=a.description:o[n]="",e[a.name]=o}else s=!1}if(s){r.currentObjRepo.componentconfig=JSON.stringify(e);var d="";d="global"==r.currentModule.scope?"sysuiobjectrepository":"sysuicustomobjectrepository",r.backend.postRequest("configuration/configurator/"+d+"/"+r.currentObjRepo.id,null,{config:r.currentObjRepo}).subscribe(function(e){for(var s in r.objrepoList)r.objrepoList[s].id==r.currentObjRepo.id&&(r.objrepoList[s]=r.currentObjRepo);t.instance.self.destroy(),r.toast.sendToast("changes saved")})}else t.instance.self.destroy(),r.toast.sendToast("Empty configuration!")})},ObjectRepositoryManager.prototype.addObjRepo=function(){var t=this;this.modalservice.openModal("ObjectRepositoryManagerAddRepo").subscribe(function(e){t.newRepo=__assign({},t.emptyRepo),e.instance.objRepo=t.newRepo,e.instance.closedialog.subscribe(function(e){e&&t.modal.openModal("SystemLoadingModal").subscribe(function(s){t.newRepo.id=t.modelutilities.generateGuid(),t.newRepo.module=t.currentModule.id;var e="";e="global"==t.currentModule.scope?"sysuiobjectrepository":"sysuicustomobjectrepository",t.backend.postRequest("configuration/configurator/"+e+"/"+t.newRepo.id,null,{config:t.newRepo}).subscribe(function(e){t.objrepoList.push(t.newRepo),t.currentObjRepo=t.newRepo,s.instance.self.destroy(),t.toast.sendToast("changes saved")})})})})},ObjectRepositoryManager.prototype.addModalRepo=function(d){var r=this;void 0===d&&(d="add"),this.modalservice.openModal("ObjectRepositoryManagerAddModule").subscribe(function(e){r.newModule=__assign({},"edit"==d?r.currentModule:r.emptyModule),e.instance.moduleRepo=r.newModule,e.instance.mode=d,e.instance.edit_mode=r.edit_mode,e.instance.closedialog.subscribe(function(e){e&&r.modal.openModal("SystemLoadingModal").subscribe(function(o){""==r.newModule.id&&(r.newModule.id=r.modelutilities.generateGuid());var e="",n="";n="global"==r.newModule.scope?(e="sysuimodulerepository","global"):(e="sysuicustommodulerepository","custom"),delete r.newModule.scope,r.backend.postRequest("configuration/configurator/"+e+"/"+r.newModule.id,null,{config:r.newModule}).subscribe(function(e){var s={id:r.newModule.id,name:r.newModule.module,group:n};if(r.newModule.scope=n,"add"==d)r.moduleReposSelect.push(s),r.moduleRepos.push(r.newModule),r.moduleReposSelectedItem=s;else{for(var t in r.moduleReposSelect)r.moduleReposSelect[t].id==s.id&&(r.moduleReposSelect[t]=s);for(var l=0,i=r.moduleRepos;l<i.length;l++){var a=i[l];a.id==r.newModule.id&&(a=r.newModule)}}r.currentModule=r.newModule,r.moduleReposSelect=Object.assign([],r.moduleReposSelect),r.moduleReposSelectedItem=s,o.instance.self.destroy(),r.toast.sendToast("changes saved")})})})})},ObjectRepositoryManager.prototype.editModalRepo=function(){this.addModalRepo("edit")},ObjectRepositoryManager.prototype.exportRepoList=function(){this.modalservice.openModal("ObjectRepositoryExport")},ObjectRepositoryManager.prototype.getDeprecatedBool=function(e){return"1"==e},ObjectRepositoryManager=__decorate([core_1.Component({template:'<div class="slds-grid slds-form--inline slds-p-around--small slds-border--bottom"><div class="slds-form-element"><label class="slds-form-element__label">Module</label><div style="width:400px" class="slds-form-element__control"><system-select style="width:100%" [listheight]="\'10\'" [selectList]="moduleReposSelect" [(selectedItem)]="moduleReposSelectedItem"></system-select></div></div><div class="slds-form-element slds-col--bump-left"><button [disabled]="!view.isEditMode()" *ngIf="(currentModule | json) != \'{}\'" type="button" class="slds-button slds-button_icon slds-button_icon-border-filled" (click)="editModalRepo()"><system-utility-icon [icon]="\'edit\'" [size]="\'x-small\'"></system-utility-icon></button> <button [disabled]="edit_mode == \'none\'" type="button" class="slds-button slds-button_icon slds-button_icon-border-filled" (click)="addModalRepo()"><system-utility-icon [icon]="\'add\'" [size]="\'x-small\'"></system-utility-icon></button> <button type="button" class="slds-button slds-button--neutral" (click)="exportRepoList()">EXP</button></div></div><div class="slds-grid"><div class="slds-size--2-of-5 slds-p-horizontal--small slds-border--right"><div *ngIf="(currentModule | json) != \'{}\'" class="slds-p-around--small slds-grid slds-grid_align-spread slds-grid_vertical-align-center slds-gutters"><div class="slds-grow slds-form-element__control slds-input-has-icon slds-input-has-icon_right slds-p-right--xx-small"><system-utility-icon icon="filterList" addclasses="slds-input__icon slds-input__icon--left"></system-utility-icon><input class="slds-input" type="text" [(ngModel)]="objectFilter"></div><button [disabled]="!view.isEditMode()" class="slds-button slds-button_neutral" (click)="addObjRepo()"><system-label label="LBL_ADD"></system-label></button></div><ul system-to-bottom class="slds-has-dividers_around-space"><li class="slds-item" *ngFor="let objrepoItem of objrepoList|objectrepositorymanagerfilter:objectFilter" (click)="clickObjRepo(objrepoItem)" [ngClass]="{\'slds-theme--shade\': checkCurrentObjRepo(objrepoItem.id)}">{{objrepoItem.object}}</li></ul></div><div system-to-bottom *ngIf="(currentObjRepo | json) != \'{}\'" class="slds-size--3-of-5 slds-p-horizontal--small"><div class="slds-form-element slds-m-vertical_medium"><label class="slds-form-element__label"><system-label label="LBL_OBJECT"></system-label></label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [ngModel]="currentObjRepo.object"></div></div><div class="slds-form-element slds-m-vertical_medium"><label class="slds-form-element__label"><system-label label="LBL_COMPONENT"></system-label></label><div class="slds-form-element__control"><input [disabled]="!view.isEditMode()" type="text" class="slds-input" [ngModel]="currentObjRepo.component"></div></div><label class="slds-checkbox" for="deprecated"><input [disabled]="!view.isEditMode()" type="checkbox" id="deprecated" (change)="updateDeprecated()" [ngModel]="getDeprecatedBool(currentObjRepo.deprecated)"> <span class="slds-checkbox--faux"></span> <span class="slds-form-element__label"><system-label label="LBL_DEPRECATED"></system-label></span></label><div *ngIf="view.isEditMode()" class="slds-form-element slds-m-vertical_medium"><label class="slds-form-element__label"><system-label label="LBL_DESCRIPTION"></system-label></label><div class="slds-form-element__control"><system-richtext-editor [(ngModel)]="currentObjRepo.description"></system-richtext-editor></div></div><div *ngIf="!view.isEditMode()" class="slds-form-element slds-m-vertical_medium"><label class="slds-form-element__label"><system-label label="LBL_DESCRIPTION"></system-label></label><div class="slds-form-element__control slds-box slds-scrollable_y" style="background-color: #ecebea; background-color: #ecebea; max-height: 300px;"><iframe [(srcdoc)]="currentObjRepo.description" width="100%" height="100%" frameborder="0" seamless></iframe></div></div><div class="slds-table_edit_container slds-is-relative"><label class="slds-form-element__label"><system-label label="LBL_CONFIGURATION"></system-label></label><table class="slds-table slds-table_bordered" role="grid" style="width: 100%;"><thead><tr class="slds-line-height_reset"><th scope="col"><span class="slds-truncate" title="Name"><system-label label="LBL_NAME"></system-label></span></th><th scope="col"><span class="slds-truncate" title="Name"><system-label label="LBL_TYPE"></system-label></span></th><th scope="col"><span class="slds-truncate" title="Name"><system-label label="LBL_DESCRIPTION"></system-label></span></th><th scope="col"></th></tr></thead><tbody><ng-container *ngFor="let currentConfig of currentConfigArray; index as i"><tr class="slds-hint-parent"><td class="slds-cell-edit" role="gridcell" style="width: 30%;"><span class="slds-grid slds-grid_align-spread"><div class="slds-form-element__control" style="width: 100%;"><input [disabled]="!view.isEditMode()" aria-describedby="error-message" type="text" class="slds-input" [(ngModel)]="currentConfig.name"></div></span></td><td class="slds-cell-edit" role="gridcell" style="width: 12%;"><span class="slds-grid slds-grid_align-spread"><div class="slds-form-element__control"><div class="slds-select_container"><select [disabled]="!view.isEditMode()" class="slds-select" [(ngModel)]="currentConfig.type"><option *ngFor="let fieldType of fieldTypeList" [value]="fieldType">{{fieldType}}</option></select></div></div></span></td><td class="slds-cell-edit" role="gridcell" style="width: 100%;"><span class="slds-grid slds-grid_align-spread"><div class="slds-form-element__control" style="width: 100%;"><input [disabled]="!view.isEditMode()" aria-describedby="error-message" type="text" class="slds-input" [(ngModel)]="currentConfig.description"></div></span></td><td class="slds-cell-edit" role="gridcell"><div class="slds-p-around--small slds-align--absolute-center slds-float_right"><button [disabled]="!view.isEditMode()" class="slds-button slds-button--icon" title="delete item" (click)="deleteConfig(i)"><system-button-icon [icon]="\'delete\'"></system-button-icon></button></div></td></tr></ng-container></tbody></table><div class="slds-p-around--small slds-align--absolute-center slds-border--bottom"><button [disabled]="!view.isEditMode()" class="slds-button slds-button--icon" title="add item" (click)="addConfig()"><system-button-icon [icon]="\'new\'"></system-button-icon></button></div></div><div class="slds-text-align--right slds-p-vertical--x-small"><button [disabled]="!view.isEditMode()" type="button" class="slds-button slds-button--brand" (click)="saveChanges()"><system-label label="LBL_SAVE"></system-label></button></div></div></div>',providers:[services_1.view]}),__metadata("design:paramtypes",[services_1.backend,services_1.metadata,services_1.language,services_1.modal,services_1.modelutilities,services_1.modal,services_1.toast,services_1.configurationService,services_1.view])],ObjectRepositoryManager)}();exports.ObjectRepositoryManager=ObjectRepositoryManager;var ObjectRepositoryManagerAddRepo=function(){function ObjectRepositoryManagerAddRepo(e,s,t){this.backend=e,this.language=s,this.modelutilities=t,this.closedialog=new core_1.EventEmitter,this.objRepo={component:"",componentconfig:"",description:"",id:"",module:"",object:"",package:""},this.currentObject="",this.currentComponent="",this.addType="fieldsetadd",this.addName="",this.addFieldset="",this.fieldsettype="custom",this.moduleFields=[]}var e;return ObjectRepositoryManagerAddRepo.prototype.ngOnInit=function(){},ObjectRepositoryManagerAddRepo.prototype.closeDialog=function(){this.self.destroy()},ObjectRepositoryManagerAddRepo.prototype.onModalEscX=function(){this.closeDialog()},ObjectRepositoryManagerAddRepo.prototype.add=function(){this.closedialog.emit(!0),this.self.destroy()},ObjectRepositoryManagerAddRepo.prototype.copyObject=function(){this.objRepo.component=this.objRepo.object},__decorate([core_1.Output(),__metadata("design:type","function"==typeof(e=void 0!==core_1.EventEmitter&&core_1.EventEmitter)?e:Object)],ObjectRepositoryManagerAddRepo.prototype,"closedialog",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],ObjectRepositoryManagerAddRepo.prototype,"objRepo",void 0),ObjectRepositoryManagerAddRepo=__decorate([core_1.Component({selector:"objectrepositorymanager-add-repo",template:'<div role="dialog" tabindex="-1" aria-labelledby="header43" class="slds-modal slds-fade-in-open"><div class="slds-modal__container"><div class="slds-modal__header slds-theme--shade"><button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" (click)="closeDialog()"><system-button-icon [icon]="\'close\'" [size]="\'large\'"></system-button-icon></button><h2 id="header43" class="slds-text-heading--medium"><system-label label="LBL_ADD_REPOSITORY"></system-label></h2></div><div class="slds-modal__content slds-p-around--medium"><div class="slds-form-element slds-m-top--small"><label class="slds-form-element__label"><system-label label="LBL_OBJECT"></system-label></label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="objRepo.object"></div></div><div class="slds-form-element slds-m-top--small"><label class="slds-form-element__label" for="text-input-id-1"><system-label label="LBL_COMPONENT"></system-label></label><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_right"><input type="text" id="text-input-id-1" class="slds-input" [(ngModel)]="objRepo.component"> <button class="slds-button slds-button_icon slds-input__icon slds-input__icon_right" title="add item" (click)="copyObject()"><system-utility-icon [icon]="\'redo\'" [size]="\'xx-small\'" [addclasses]="\'slds-section__title-action-icon slds-button__icon slds-button__icon_left\'"></system-utility-icon></button></div></div></div><div class="slds-modal__footer"><button class="slds-button slds-button--neutral" (click)="closeDialog()"><system-label label="LBL_CANCEL"></system-label></button> <button class="slds-button slds-button--brand" (click)="add()"><system-label label="LBL_ADD"></system-label></button></div></div></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.language,services_1.modelutilities])],ObjectRepositoryManagerAddRepo)}();exports.ObjectRepositoryManagerAddRepo=ObjectRepositoryManagerAddRepo;var ObjectRepositoryManagerAddModule=function(){function ObjectRepositoryManagerAddModule(e,s,t){this.backend=e,this.language=s,this.modelutilities=t,this.closedialog=new core_1.EventEmitter,this.mode="add",this.edit_mode="custom",this.moduleRepo={id:"",module:"",path:"",description:"",package:"",version:"",scope:"custom"},this.scopes=["custom","global"]}var e;return ObjectRepositoryManagerAddModule.prototype.ngOnInit=function(){"custom"==this.edit_mode?this.scopes=["custom"]:this.scopes=["custom","global"]},ObjectRepositoryManagerAddModule.prototype.closeDialog=function(){this.self.destroy()},ObjectRepositoryManagerAddModule.prototype.onModalEscX=function(){this.closeDialog()},ObjectRepositoryManagerAddModule.prototype.add=function(){this.closedialog.emit(!0),this.self.destroy()},ObjectRepositoryManagerAddModule.prototype.updateField=function(e){this.moduleRepo.description=e},__decorate([core_1.Output(),__metadata("design:type","function"==typeof(e=void 0!==core_1.EventEmitter&&core_1.EventEmitter)?e:Object)],ObjectRepositoryManagerAddModule.prototype,"closedialog",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],ObjectRepositoryManagerAddModule.prototype,"mode",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],ObjectRepositoryManagerAddModule.prototype,"edit_mode",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],ObjectRepositoryManagerAddModule.prototype,"moduleRepo",void 0),ObjectRepositoryManagerAddModule=__decorate([core_1.Component({selector:"objectrepositorymanager-add-module",template:'<div role="dialog" tabindex="-1" aria-labelledby="header43" class="slds-modal slds-fade-in-open"><div class="slds-modal__container"><div class="slds-modal__header slds-theme--shade"><button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" (click)="closeDialog()"><system-button-icon [icon]="\'close\'" [size]="\'large\'"></system-button-icon></button><h2 *ngIf="mode == \'add\'" id="header43" class="slds-text-heading--medium"><system-label label="LBL_ADD_Module"></system-label></h2><h2 *ngIf="mode == \'edit\'" id="header44" class="slds-text-heading--medium"><system-label label="LBL_EDIT_Module"></system-label></h2></div><div class="slds-modal__content slds-p-around--medium"><div *ngIf="mode == \'add\'" class="slds-form-element slds-m-top--small"><label class="slds-form-element__label">Scope</label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="moduleRepo.scope"><option *ngFor="let scope of scopes" [ngValue]="scope">{{scope}}</option></select></div></div></div><div class="slds-form-element slds-m-top--small"><label class="slds-form-element__label"><system-label label="LBL_NAME"></system-label></label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="moduleRepo.module"></div></div><div class="slds-form-element slds-m-top--small"><label class="slds-form-element__label"><system-label label="LBL_PATH"></system-label></label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="moduleRepo.path"></div></div><div class="slds-form-element slds-m-top--small"><label class="slds-form-element__label"><system-label label="LBL_DESCRIPTION"></system-label></label><div class="slds-form-element__control"><system-richtext-editor [(ngModel)]="moduleRepo.description"></system-richtext-editor></div></div></div><div class="slds-modal__footer"><button class="slds-button slds-button--neutral" (click)="closeDialog()"><system-label label="LBL_CANCEL"></system-label></button> <button *ngIf="mode == \'add\'" class="slds-button slds-button--brand" (click)="add()"><system-label label="LBL_ADD"></system-label></button> <button *ngIf="mode == \'edit\'" class="slds-button slds-button--brand" (click)="add()"><system-label label="LBL_SAVE"></system-label></button></div></div></div>',styles:[":host >>> .mce-ico{font-size: 12px; color: #54698d;}",":host >>> .mce-text{font-size: 12px; color: #54698d;}",":host >>> .mce-btn button{font-size: 12px; color: #54698d;}",":host >>> .mce-tinymce{border-radius: 4px}",":host >>> .mce-widget{font-family: 'Titillium Web', sans-serif;}"]}),__metadata("design:paramtypes",[services_1.backend,services_1.language,services_1.modelutilities])],ObjectRepositoryManagerAddModule)}();exports.ObjectRepositoryManagerAddModule=ObjectRepositoryManagerAddModule;var ObjectRepositoryExport=function(){function ObjectRepositoryExport(e,s,t){this.lang=e,this.backend=s,this.toast=t,this.isLoading=!1}var e;return ObjectRepositoryExport.prototype.ngOnInit=function(){var s=this;this.isLoading=!0,this.backend.getRequest("configuration/configurator/objectrepository").subscribe(function(e){s.repostring=e.repostring,s.isLoading=!1,window.setTimeout(function(){return s.inputField.nativeElement.select()},500)},function(){s.isLoading=!1,s.toast.sendToast("Error loading data!","error")})},ObjectRepositoryExport.prototype.closeModal=function(){this.self.destroy()},ObjectRepositoryExport.prototype.onModalEscX=function(){this.closeModal()},__decorate([core_1.ViewChild("inputField",{static:!0}),__metadata("design:type","function"==typeof(e=void 0!==core_1.ElementRef&&core_1.ElementRef)?e:Object)],ObjectRepositoryExport.prototype,"inputField",void 0),ObjectRepositoryExport=__decorate([core_1.Component({selector:"objectrepositoryexport",template:'<system-modal><system-modal-header (close)="closeModal()">Object Repository Export</system-modal-header><system-modal-content><system-spinner *ngIf="isLoading"></system-spinner><div *ngIf="!isLoading" class="slds-text-align--center slds-grid"><div class="slds-m-right--medium" style="width:100%"><input #inputField class="slds-input" type="text" value="{{repostring}}" style="width:100%"></div></div></system-modal-content><system-modal-footer><button class="slds-button slds-button--neutral" (click)="closeModal()">{{lang.getLabel(\'LBL_CLOSE\')}}</button></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[services_1.language,services_1.backend,services_1.toast])],ObjectRepositoryExport)}();exports.ObjectRepositoryExport=ObjectRepositoryExport;var CRMLogViewer=function(){function CRMLogViewer(e,s,t,l){this.lang=e,this.backend=s,this.modal=t,this.toast=l,this.filter={loglevels:[],pid:"",user_id:"",text:"",transaction_id:"",end:void 0},this.limit="250",this.load$=new core_1.EventEmitter}return CRMLogViewer.prototype.setNow=function(){this.filter.end=new moment},Object.defineProperty(CRMLogViewer.prototype,"filterUser",{get:function(){if(this.filter.user_id)return this.filter.user_id+"::"+this.filterUserName},set:function(e){if(!e)return this.filter.user_id="",void(this.filterUserName=void 0);var s=e.split("::");this.filter.user_id=s[0],this.filterUserName=s[1]},enumerable:!1,configurable:!0}),CRMLogViewer.prototype.canLoad=function(){return!(this.filter.pid&&!this.filter.pid.match(/\d$/))},CRMLogViewer.prototype.buttonLoad=function(){this.load$.emit()},CRMLogViewer.prototype.valueClicked=function(e,s){switch(e){case"date_entered":this.filter.end=new moment(s);break;case"transaction_id":this.filter.transaction_id=s;break;case"user":this.filter.user_id=s.user_id,this.filterUserName=s.user_name;break;case"log_level":-1===this.filter.loglevels.findIndex(function(e){return e===s})&&this.filter.loglevels.push(s),this.loglevelsCheckboxes.writeValue(this.filter.loglevels);break;case"pid":this.filter.pid=s.toString()}},CRMLogViewer.prototype.truncate=function(){var s=this;this.modal.prompt("confirm","Truncate the API log and delete all entries?","Empty the API Log?").subscribe(function(e){e&&s.backend.deleteRequest("admin/crmlog").subscribe(function(){s.load$.emit()},function(){s.toast.sendToast("Error truncating log","error")})})},__decorate([core_1.ViewChild("loglevelsCheckboxes"),__metadata("design:type",Object)],CRMLogViewer.prototype,"loglevelsCheckboxes",void 0),CRMLogViewer=__decorate([core_1.Component({template:'<div style="height:100%"><workbench-header titlelabel="LBL_CRM_LOG_VIEWER" icon="custom:custom62">({{countEntries}} <system-label label="LBL_RECORDS"></system-label>)<workbench-header-controls><button class="slds-button slds-button--neutral" (click)="truncate()"><system-label label="LBL_TRUNCATE"></system-label></button><button class="slds-button slds-button_brand" (click)="buttonLoad()" [attr.disabled]="!canLoad()?true:null"><system-label label="LBL_LOAD"></system-label></button></workbench-header-controls></workbench-header><div class="slds-section slds-is-open slds-m-bottom--medium"><div class="slds-section__content slds-m-horizontal_medium slds-m-bottom_medium" style="padding-top:0;margin-bottom:0"><div class="slds-grid slds-grid_vertical-align-center slds-m-bottom_xxx-small" style="padding-top:0"><div class="slds-col slds-size--5-of-12"><label class="slds-form-element__label"><system-label label="LBL_END"></system-label></label><div class="slds-grid slds-grid--vertical-align-center slds-p-right--small"><system-input-date [(ngModel)]="filter.end" class="slds-grow"></system-input-date><system-input-time [(ngModel)]="filter.end" class="slds-grow slds-p-horizontal--xx-small"></system-input-time><system-utility-icon system-title="LBL_NOW" icon="clock" size="x-small" (click)="setNow()"></system-utility-icon></div></div><div class="slds-col slds-size--1-of-12 slds-p-right_x-small"><label class="slds-form-element__label"><system-label label="LBL_ROWS"></system-label></label><div class="slds-select_container"><select class="slds-select" [(ngModel)]="limit"><option>250</option><option>500</option><option>1000</option></select></div></div><div class="slds-form-element slds-p-right_x-small slds-size--3-of-12"><label class="slds-form-element__label" for="pid">{{lang.getLabel(\'LBL_PROCESS_ID\')}}</label><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_right"><input id="pid" system-trim-input class="slds-input slds-text-align_right" type="text" size="5" [(ngModel)]="filter.pid"> <button class="slds-button slds-button_icon slds-input__icon slds-input__icon_right" (click)="filter.pid=\'\'"><system-button-icon icon="clear" addclasses="slds-icon-text-light"></system-button-icon></button></div></div><div class="slds-form-element slds-size--3-of-12"><label class="slds-form-element__label" for="transaction_id">{{lang.getLabel(\'LBL_TRANSACTION\')}}</label><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_right"><input system-trim-input id="transaction_id" class="slds-input slds-text-align_right" type="text" [(ngModel)]="filter.transaction_id"> <button class="slds-button slds-button_icon slds-input__icon slds-input__icon_right" (click)="filter.transaction_id=\'\'"><system-button-icon icon="clear" addclasses="slds-icon-text-light"></system-button-icon></button></div></div></div><div class="slds-grid slds-grid_vertical-align-end slds-m-bottom_xxx-small" style="padding-top:0"><div class="slds-p-right_x-small slds-size--3-of-12"><label class="slds-form-element__label">{{lang.getLabel(\'LBL_USER\')}}</label><system-input-relate module="Users" [(ngModel)]="filterUser" nameField="user_name"></system-input-relate></div><div class="slds-form-element slds-p-right_x-small slds-size--6-of-12"><system-label label="LBL_LOGFILE_LEVEL"></system-label><system-checkbox-group #loglevelsCheckboxes [(ngModel)]="filter.loglevels" class="slds-grid slds-wrap"><system-checkbox-group-checkbox value="debug" class="slds-size--1-of-6 slds-p-vertical--xxx-small"><system-label label="LBL_LOGLEVEL_DEBUG"></system-label></system-checkbox-group-checkbox><system-checkbox-group-checkbox value="info" class="slds-size--1-of-6 slds-p-vertical--xxx-small"><system-label label="LBL_LOGLEVEL_INFO"></system-label></system-checkbox-group-checkbox><system-checkbox-group-checkbox value="error" class="slds-size--1-of-6 slds-p-vertical--xxx-small"><system-label label="LBL_LOGLEVEL_ERROR"></system-label></system-checkbox-group-checkbox><system-checkbox-group-checkbox value="warn" class="slds-size--1-of-6 slds-p-vertical--xxx-small"><system-label label="LBL_LOGLEVEL_WARN"></system-label></system-checkbox-group-checkbox><system-checkbox-group-checkbox value="security" class="slds-size--1-of-6 slds-p-vertical--xxx-small"><system-label label="LBL_LOGLEVEL_SECURITY"></system-label></system-checkbox-group-checkbox><system-checkbox-group-checkbox value="fatal" class="slds-size--1-of-6 slds-p-vertical--xxx-small"><system-label label="LBL_LOGLEVEL_FATAL"></system-label></system-checkbox-group-checkbox></system-checkbox-group></div><div class="slds-form-element slds-size--3-of-12"><label class="slds-form-element__label" for="filtertextBackend">Text</label><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_right"><input id="filtertextBackend" system-trim-input class="slds-input" type="text" [(ngModel)]="filter.text"> <button class="slds-button slds-button_icon slds-input__icon slds-input__icon_right" (click)="filter.text=\'\'"><system-button-icon icon="clear" addclasses="slds-icon-text-light"></system-button-icon></button></div></div></div></div></div><crm-log-viewer-list [load]="load$" [filter]="filter" (countEntries$)="countEntries=$event" (valueClicked)="valueClicked($event.type,$event.value)"></crm-log-viewer-list></div>'}),__metadata("design:paramtypes",[services_1.language,services_1.backend,services_1.modal,services_1.toast])],CRMLogViewer)}();exports.CRMLogViewer=CRMLogViewer;var CRMLogViewerList=function(){function e(e,s,t,l,i,a){this.backend=e,this.metadata=s,this.lang=t,this.prefs=l,this.modalservice=i,this.toast=a,this.filter={loglevels:"",pid:"",user_id:"",text:"",transaction_id:"",end:void 0},this.period={type:"",begin:{year:"",month:"",day:"",hour:""},end:{year:"",month:"",day:"",hour:""},duration:""},this.valuesNotClickable=!1,this.countEntries$=new rxjs_1.BehaviorSubject(0),this.valueClicked$=new core_1.EventEmitter,this.entries=[],this.toastId="",this.isLoading=!1,this.isLoaded=!1,this.isInitialLoaded=!1}var s;return e.prototype.ngOnInit=function(){var e=this;this.load$?this.load$.subscribe(function(){e.loadData()}):this.loadData()},e.prototype.loadData=function(){var s=this;if(!this.isLoading){this.isLoaded=!1,this.isLoading=!0;var e={loglevels:this.filter.loglevels?this.filter.loglevels:void 0,pid:this.filter.pid?this.filter.pid:void 0,user_id:this.filter.user_id?this.filter.user_id:void 0,text:this.filter.text?this.filter.text:void 0,transaction_id:this.filter.transaction_id?this.filter.transaction_id:void 0,end:this.filter.end?this.filter.end.utc().format("YYYY-MM-DD HH:mm:ss"):void 0,limit:this.limit};this.toast.clearToast(this.toastId),this.backend.getRequest("admin/crmlog/entries",e).subscribe(function(e){s.entries=e.entries,s.countEntries$.next(s.entries.length),s.isLoading=!1,s.isInitialLoaded=!0},function(e){s.toast.sendToast("Error loading log data!","error"),s.isLoading=!1})}},e.prototype.showEntryInModal=function(s){var t=this;this.modalservice.openModal("CRMLogViewerModal").subscribe(function(e){e.instance.entry=t.entries[s],e.instance.user_name=t.entries[s].user_name})},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"filter",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"period",void 0),__decorate([core_1.Input("load"),__metadata("design:type","function"==typeof(s=void 0!==core_1.EventEmitter&&core_1.EventEmitter)?s:Object)],e.prototype,"load$",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"valuesNotClickable",void 0),__decorate([core_1.Output(),__metadata("design:type",Object)],e.prototype,"countEntries$",void 0),__decorate([core_1.Input(),__metadata("design:type",Number)],e.prototype,"limit",void 0),__decorate([core_1.Output("valueClicked"),__metadata("design:type",Object)],e.prototype,"valueClicked$",void 0),e=__decorate([core_1.Component({selector:"crm-log-viewer-list",template:'<div class="slds-section slds-is-open" [ngStyle]="!isInitialLoaded?{opacity:0}:undefined"><div class="slds-section__content slds-m-bottom_medium slds-grid slds-grid_vertical" style="padding-top:0"><div [system-overlay-loading-spinner]="isLoading" class="slds-grid slds-grid_vertical slds-border--top slds-scrollable--y" system-to-bottom><table class="slds-table slds-table--striped slds-table--bordered slds-table--fixed-layout slds-table--col-bordered slds-table--striped slds-table_header-fixed" [ngStyle]="isLoading?{opacity:0.33}:undefined"><thead><tr><th style="width:7.5rem"><system-label class="slds-th__action" label="LBL_DATE"></system-label></th><th style="width:3.5rem" class="slds-text-align--right"><span class="slds-th__action">PID</span></th><th style="width:17rem" class="slds-text-align--right"><system-label class="slds-th__action" label="LBL_TRANSACTION"></system-label></th><th style="width:4.5rem" class="slds-resizable"><system-label class="slds-th__action" label="LBL_USER"></system-label></th><th style="width:3rem"><system-label class="slds-th__action" label="LBL_LEVEL"></system-label></th><th style="width:100%" class="slds-resizable"><system-label class="slds-th__action" label="LBL_TEXT"></system-label></th><th style="width:2.5rem"></th></tr></thead><tbody><tr *ngFor="let entry of entries;let i=index"><td><a *ngIf="!valuesNotClickable" (click)="valueClicked$.emit({type:\'date_entered\',value:entry.date_entered})"><system-display-datetime [date]="entry.date_entered"></system-display-datetime></a><system-display-datetime *ngIf="valuesNotClickable" [date]="entry.date_entered"></system-display-datetime></td><td class="slds-text-align--right"><a *ngIf="!valuesNotClickable" (click)="valueClicked$.emit({type:\'pid\',value:entry.pid})">{{entry.pid}}</a><ng-container *ngIf="valuesNotClickable">{{entry.pid}}</ng-container></td><td><a *ngIf="!valuesNotClickable" (click)="valueClicked$.emit({type:\'transaction_id\',value:entry.transaction_id})">{{entry.transaction_id}}</a><ng-container *ngIf="valuesNotClickable">{{entry.transaction_id}}</ng-container></td><td><a *ngIf="!valuesNotClickable" (click)="valueClicked$.emit({type:\'user\',value:{user_id:entry.user_id,user_name:entry.user_name}})">{{entry.user_name}}</a><ng-container *ngIf="valuesNotClickable">{{entry.user_name}}</ng-container></td><td><a *ngIf="!valuesNotClickable" (click)="valueClicked$.emit({type:\'log_level\',value:entry.log_level})">{{entry.log_level}}</a><ng-container *ngIf="valuesNotClickable">{{entry.log_level}}</ng-container></td><td><div class="slds-truncate slds-text-font_monospace">{{entry.description}}</div></td><td><button class="slds-button slds-button--icon-border slds-button_icon-small" (click)="showEntryInModal(i)"><system-button-icon [icon]="\'expand\'" [size]="\'medium\'"></system-button-icon></button></td></tr></tbody></table><div *ngIf="entries.length == 0" class="slds-height_full slds-align--absolute-center"><system-illustration-no-records><system-label label="LBL_NO_RECORDS_FOUND"></system-label></system-illustration-no-records></div></div></div></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.metadata,services_1.language,services_1.userpreferences,services_1.modal,services_1.toast])],e)}();exports.CRMLogViewerList=CRMLogViewerList;var CRMLogViewerModal=function(){function CRMLogViewerModal(e,s,t,l){this.language=e,this.backend=s,this.toast=t,this.prefs=l,this.user_name="",this.isLoaded=!1,this.isLoading=!0}return CRMLogViewerModal.prototype.ngOnInit=function(){this.entry.fullDescription?this.isLoading=!(this.isLoaded=!0):this.loadFullData()},CRMLogViewerModal.prototype.loadFullData=function(){var s=this;this.backend.getRequest("admin/crmlog/entry/"+this.entry.id).subscribe(function(e){s.isLoaded=!0,s.isLoading=!1,s.entry.fullDescription=e.entry.description},function(e){s.toast.sendToast("Error loading entry of log file!","error","Entry "+s.entry.id+" of CRM log couldnÂ´t be fetched.",!1),s.isLoading=!1})},CRMLogViewerModal.prototype.closeModal=function(){this.self.destroy()},CRMLogViewerModal.prototype.onModalEscX=function(){this.closeModal()},__decorate([core_1.Input(),__metadata("design:type",Object)],CRMLogViewerModal.prototype,"entry",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],CRMLogViewerModal.prototype,"user_name",void 0),CRMLogViewerModal=__decorate([core_1.Component({template:'<system-modal size="large"><system-modal-header (close)="closeModal()"><system-display-datetime [date]="entry.date_entered"></system-display-datetime>â¢ {{entry.pid}} â¢ {{user_name}} â¢ {{entry.log_level}}</system-modal-header><system-modal-content style="height:100%"><system-spinner *ngIf="isLoading" class="slds-m-top--medium" style="display:block"></system-spinner><div *ngIf="isLoaded" class="slds-m-bottom--x-small slds-m-horizontal--x-small slds-text-font_monospace" style="overflow-wrap:break-word">{{entry.fullDescription}}</div></system-modal-content><system-modal-footer><button class="slds-button slds-button--neutral" (click)="closeModal()"><system-label label="LBL_CLOSE"></system-label></button></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[services_1.language,services_1.backend,services_1.toast,services_1.userpreferences])],CRMLogViewerModal)}();exports.CRMLogViewerModal=CRMLogViewerModal;var CRMLogViewerListModal=function(){function CRMLogViewerListModal(e){this.language=e}return CRMLogViewerListModal.prototype.closeModal=function(){this.self.destroy()},CRMLogViewerListModal.prototype.onModalEscX=function(){this.closeModal()},__decorate([core_1.Input(),__metadata("design:type",Object)],CRMLogViewerListModal.prototype,"filter",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],CRMLogViewerListModal.prototype,"crmLogId",void 0),CRMLogViewerListModal=__decorate([core_1.Component({template:'<system-modal size="large"><system-modal-header (close)="closeModal()">CRM Log Entries for API Request {{crmLogId}}</system-modal-header><system-modal-content style="height:100%"><crm-log-viewer-list [filter]="filter" [valuesNotClickable]="true"></crm-log-viewer-list></system-modal-content><system-modal-footer><button class="slds-button slds-button--neutral" (click)="closeModal()"><system-label label="LBL_CLOSE"></system-label></button></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[services_1.language])],CRMLogViewerListModal)}();exports.CRMLogViewerListModal=CRMLogViewerListModal;var APIlogViewer=function(){function APIlogViewer(e,s,t){this.backend=e,this.modal=s,this.toast=t,this.methods=["CONNECT","DELETE","GET","HEAD","OPTIONS","POST","PATCH","PUT","SOAP","TRACE"],this.limit="250",this.entries=[],this.filter={method:"",session_id:"",userId:"",term:"",ip:"",route:"",status:"",direction:""},this.isLoading=!1}return Object.defineProperty(APIlogViewer.prototype,"filterUser",{get:function(){if(this.filter.userId)return this.filter.userId+"::"+this.filterUserName},set:function(e){if(!e)return this.filter.userId="",void(this.filterUserName=void 0);var s=e.split("::");this.filter.userId=s[0],this.filterUserName=s[1]},enumerable:!1,configurable:!0}),APIlogViewer.prototype.setNow=function(){this.dateEnd=new moment},APIlogViewer.prototype.loadData=function(){var e,s=this;if(!this.isLoading){this.isLoading=!0;var t={limit:this.limit};this.filter.method&&(t.method=this.filter.method),this.filter.route&&(t.route=this.filter.route),this.filter.userId&&(t.user_id=this.filter.userId),this.filter.term&&(t.filter=this.filter.term),this.filter.ip&&(t.ip=this.filter.ip),this.filter.status&&(t.status=this.filter.status),this.filter.session_id&&(t.session_id=this.filter.session_id),this.filter.direction&&(t.direction=this.filter.direction),this.dateEnd&&(t.end=null===(e=this.dateEnd)||void 0===e?void 0:e.utc().format("YYYY-MM-DD HH:mm:ss")),this.backend.getRequest("admin/apilog",t).subscribe(function(e){s.entries=e.entries,s.isLoading=!1},function(e){s.toast.sendToast("Error loading log data!","error"),s.isLoading=!1})}},APIlogViewer.prototype.buttonLoad=function(){this.loadData()},APIlogViewer.prototype.truncate=function(){var s=this;this.modal.prompt("confirm","Truncate the API log and delete all entries?","Truncate API Log").subscribe(function(e){e&&(s.backend.deleteRequest("admin/apilog").subscribe(function(){s.isLoading=!1,s.loadData()},function(){s.toast.sendToast("Error truncating log","error"),s.isLoading=!1}),s.isLoading=!0)})},APIlogViewer.prototype.showEntryInModal=function(s){this.modal.openModal("APIlogViewerModal").subscribe(function(e){e.instance.entry=s})},APIlogViewer.prototype.showCRMlog=function(s){this.modal.openModal("CRMLogViewerListModal").subscribe(function(e){e.instance.filter={transaction_id:s}})},APIlogViewer.prototype.valueClicked=function(e,s){switch(e){case"route":this.filter.route=s;break;case"method":this.filter.method=s;break;case"status":this.filter.status=s;break;case"dir":this.filter.direction=s}},APIlogViewer=__decorate([core_1.Component({template:'<workbench-header titlelabel="LBL_API_LOG_VIEWER" icon="custom:custom62">({{entries.length}} <system-label label="LBL_RECORDS"></system-label>)<workbench-header-controls><button class="slds-button slds-button--neutral" (click)="truncate()" [disabled]="isLoading"><system-label label="LBL_TRUNCATE"></system-label></button> <button class="slds-button slds-button--brand" (click)="buttonLoad()" [disabled]="isLoading"><system-label label="LBL_LOAD"></system-label></button></workbench-header-controls></workbench-header><div class="slds-section slds-is-open slds-p-around--xx-small"><div class="slds-grid slds-grid--vertical-align-end slds-gutters_direct-xxx-small"><div class="slds-col slds-size--1-of-4"><label class="slds-form-element__label"><system-label label="LBL_ROUTE"></system-label></label><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_right"><input class="slds-input" type="text" system-trim-input [(ngModel)]="filter.route"> <button class="slds-button slds-button_icon slds-input__icon slds-input__icon_right" (click)="filter.route=\'\'"><system-button-icon icon="clear" addclasses="slds-icon-text-light"></system-button-icon></button></div></div><div class="slds-col slds-size--1-of-4"><label class="slds-form-element__label"><system-label label="LBL_FILTER"></system-label></label><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_right"><input class="slds-input" type="text" system-trim-input [(ngModel)]="filter.term"> <button class="slds-button slds-button_icon slds-input__icon slds-input__icon_right" (click)="filter.term=\'\'"><system-button-icon icon="clear" addclasses="slds-icon-text-light"></system-button-icon></button></div></div><div class="slds-col slds-size--1-of-4"><label class="slds-form-element__label"><system-label label="LBL_END"></system-label></label><div class="slds-grid slds-grid--vertical-align-center"><system-input-date [(ngModel)]="dateEnd" class="slds-grow"></system-input-date><system-input-time [(ngModel)]="dateEnd" class="slds-grow slds-p-horizontal--xx-small"></system-input-time><system-utility-icon system-title="LBL_NOW" icon="clock" size="x-small" (click)="setNow()"></system-utility-icon></div></div><div class="slds-col slds-size--1-of-4"><label class="slds-form-element__label"><system-label label="LBL_ROWS"></system-label></label><div class="slds-select_container"><select class="slds-select" [(ngModel)]="limit"><option>250</option><option>500</option><option>1000</option></select></div></div></div><div class="slds-grid slds-gutters_direct-xxx-small"><div class="slds-col slds-size--1-of-8"><label class="slds-form-element__label"><system-label label="LBL_USER"></system-label></label><system-input-relate module="Users" [(ngModel)]="filterUser" nameField="user_name"></system-input-relate></div><div class="slds-col slds-size--1-of-8"><label class="slds-form-element__label"><system-label label="LBL_METHOD"></system-label></label><div class="slds-select_container"><select class="slds-select" [(ngModel)]="filter.method"><option></option><option *ngFor="let method of methods">{{method}}</option></select></div></div><div class="slds-col slds-size--1-of-8"><label class="slds-form-element__label"><system-label label="LBL_DIRECTION"></system-label></label><div class="slds-select_container"><select class="slds-select" [(ngModel)]="filter.direction"><option></option><option value="I"><system-label label="LBL_DIRECTION_I"></system-label></option><option value="O"><system-label label="LBL_DIRECTION_O"></system-label></option></select></div></div><div class="slds-col slds-size--1-of-8"><label class="slds-form-element__label"><system-label label="LBL_STATUS"></system-label></label><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_right"><input class="slds-input" type="text" system-trim-input size="3" [(ngModel)]="filter.status"> <button class="slds-button slds-button_icon slds-input__icon slds-input__icon_right" (click)="filter.status=\'\'"><system-button-icon icon="clear" addclasses="slds-icon-text-light"></system-button-icon></button></div></div><div class="slds-col slds-size--1-of-4"><label class="slds-form-element__label"><system-label label="LBL_IP_ADDRESS"></system-label></label><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_right"><input class="slds-input" type="text" system-trim-input [(ngModel)]="filter.ip"> <button class="slds-button slds-button_icon slds-input__icon slds-input__icon_right" (click)="filter.ip=\'\'"><system-button-icon icon="clear" addclasses="slds-icon-text-light"></system-button-icon></button></div></div><div class="slds-col slds-size--1-of-4"><label class="slds-form-element__label"><system-label label="LBL_SESSION_ID"></system-label></label><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_right"><input class="slds-input" type="text" system-trim-input [(ngModel)]="filter.session_id"> <button class="slds-button slds-button_icon slds-input__icon slds-input__icon_right" (click)="filter.session_id=\'\'"><system-button-icon icon="clear" addclasses="slds-icon-text-light"></system-button-icon></button></div></div></div></div><div system-to-bottom class="slds-border--top"><table class="slds-table slds-table--bordered slds-table--fixed-layout slds-table--col-bordered slds-no-row-hover slds-table_header-fixed"><thead><tr><th style="width: 8rem;"><system-label class="slds-th__action" label="LBL_DATE"></system-label></th><th style="width: 8rem" class="slds-resizable"><system-label class="slds-th__action" label="LBL_USER"></system-label></th><th style="width: 8rem" class="slds-resizable"><system-label class="slds-th__action" label="LBL_TRANSACTION_ID"></system-label></th><th class="slds-resizable"><system-label class="slds-th__action" label="LBL_ROUTE"></system-label></th><th style="width: 4rem"><system-label class="slds-th__action" label="LBL_METHOD"></system-label></th><th style="width: 2rem" class="slds-text-align_center"><system-utility-icon icon="signpost" size="x-small"></system-utility-icon></th><th style="width: 3rem;"><system-label class="slds-th__action" label="LBL_STATUS"></system-label></th><th style="width: 3rem;" class="slds-text-align_center"><system-utility-icon icon="clock" size="x-small"></system-utility-icon></th><th class="slds-resizable"><system-label class="slds-th__action" label="LBL_ROUTE_ARGUMENTS"></system-label></th><th class="slds-resizable"><system-label class="slds-th__action" label="LBL_URL_PARAMETERS"></system-label></th><th style="width:2.5rem"></th></tr></thead><tbody #tbody><tr *ngFor="let entry of entries" [ngClass]="{\'slds-theme--error\' :entry.http_status_code!=200}"><td><system-display-datetime [date]="entry.date_entered"></system-display-datetime></td><td><div class="slds-truncate">{{entry.user_name}}</div></td><td><div class="slds-truncate">{{entry.transaction_id}}</div></td><td><div class="slds-truncate"><a (click)="valueClicked( \'route\', entry.route )">{{entry.route}}</a></div></td><td class="slds-text-align--center"><div class="slds-truncate"><a (click)="valueClicked( \'method\', entry.method )">{{entry.method}}</a></div></td><td class="slds-text-align--center">{{entry.direction}}</td><td class="slds-text-align--right status"><a (click)="valueClicked( \'status\', entry.http_status_code )">{{entry.http_status_code}}</a></td><td class="slds-text-align--center"><system-display-number [number]="entry.runtime" system-display-number-nodigits></system-display-number></td><td><div class="slds-truncate">{{entry.request_args}}</div></td><td><div class="slds-truncate">{{entry.request_params}}</div></td><td><button class="slds-button slds-button--icon-border slds-button_icon-small" (click)="showEntryInModal(entry)"><system-button-icon [icon]="\'expand\'" [size]="\'medium\'"></system-button-icon></button></td></tr></tbody></table><div *ngIf="entries.length == 0" class="slds-height_full slds-align--absolute-center"><system-illustration-no-records><system-label label="LBL_NO_RECORDS_FOUND"></system-label></system-illustration-no-records></div></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.modal,services_1.toast])],APIlogViewer)}();exports.APIlogViewer=APIlogViewer;var APIlogViewerModal=function(){function APIlogViewerModal(e,s,t,l){var i=this;this.language=e,this.backend=s,this.toast=t,this.libloader=l,this.record={},this._requestheaders={},this._responseheaders={},this.isLoading=!0,this.beautifyenabled=!1,this.activeTab="record",this.libloader.loadLib("jsbeautify").subscribe(function(e){i.beautifyenabled=!0})}return APIlogViewerModal.prototype.ngOnInit=function(){this.loadFullData()},APIlogViewerModal.prototype.loadFullData=function(){var s=this;this.isLoading=!0,this.backend.getRequest("admin/apilog/"+this.entry.id).subscribe(function(e){s.isLoading=!1,s.record=e,s.setRequestHeaders(),s.setResponseHeaders()},function(e){s.toast.sendToast("Error loading entry of log file!","error","Entry "+s.entry.id+" of REST log couldnÂ´t be fetched.",!1),s.isLoading=!1,s.close()})},APIlogViewerModal.prototype.setRequestHeaders=function(){try{var e=JSON.parse(this.record.request_headers);e&&(this._requestheaders=e)}catch(e){this._requestheaders={}}},APIlogViewerModal.prototype.setResponseHeaders=function(){try{var e=JSON.parse(this.record.response_headers);e&&(this._responseheaders=e)}catch(e){this._responseheaders={}}},Object.defineProperty(APIlogViewerModal.prototype,"requestHeaders",{get:function(){if(this.record.request_headers)try{var e=[],s=JSON.parse(this.record.request_headers);for(var t in s)e.push({name:t,value:s[t]});return e}catch(e){return[]}return[]},enumerable:!1,configurable:!0}),Object.defineProperty(APIlogViewerModal.prototype,"responseHeaders",{get:function(){if(this.record.response_headers)try{var e=[],s=JSON.parse(this.record.response_headers);for(var t in s)e.push({name:t,value:s[t]});return e}catch(e){return[]}return[]},enumerable:!1,configurable:!0}),Object.defineProperty(APIlogViewerModal.prototype,"requestArguments",{get:function(){if(this.record.request_args)try{var e=[],s=JSON.parse(this.record.request_args);for(var t in s)e.push({name:t,value:s[t]});return e}catch(e){return[]}return[]},enumerable:!1,configurable:!0}),Object.defineProperty(APIlogViewerModal.prototype,"requestParams",{get:function(){if(this.record.request_params)try{var e=[],s=JSON.parse(this.record.request_params);for(var t in s)e.push({name:t,value:s[t]});return e}catch(e){return[]}return[]},enumerable:!1,configurable:!0}),Object.defineProperty(APIlogViewerModal.prototype,"hasRequest",{get:function(){return this.record.request_body&&"{}"!=this.record.request_body},enumerable:!1,configurable:!0}),Object.defineProperty(APIlogViewerModal.prototype,"hasResponse",{get:function(){return this.record.response_body&&"{}"!=this.record.response_body},enumerable:!1,configurable:!0}),APIlogViewerModal.prototype.close=function(){this.self.destroy()},APIlogViewerModal.prototype.determineContentType=function(e){var s="application/json";for(var t in e)if("content-type"==t.toLowerCase()){s=(_.isArray(e[t])?e[t][0].toLowerCase().trim():e[t].toLowerCase().trim()).split(";")[0].trim();break}return s},APIlogViewerModal.prototype.formattedResponse=function(){return this.getFormattedBody(this.determineContentType(this._responseheaders),this.record.response_body)},APIlogViewerModal.prototype.formattedRequest=function(){return this.getFormattedBody(this.determineContentType(this._requestheaders),this.record.request_body)},APIlogViewerModal.prototype.getFormattedBody=function(e,s){switch(e){case"application/json":return JSON.stringify(JSON.parse(s),null,"\t");case"application/x-ndjson":for(var t=[],l=0,i=s.split("\n");l<i.length;l++){var a=i[l];a&&t.push(JSON.stringify(JSON.parse(a),null,"\t"))}return t.join("\r\n\r\n");case"application/x-www-form-urlencoded":for(var o=[],n=0,d=s.split("&");n<d.length;n++){var r=d[n].split("=");o.push({name:r[0],value:decodeURIComponent(r[1].replaceAll("+"," "))})}return o;case"text/xml":return html_beautify(s,{indent_size:4,indent_char:" ",indent_with_tabs:!1,end_with_newline:!1,indent_level:0,preserve_newlines:!0,max_preserve_newlines:10,space_in_paren:!1,space_in_empty_paren:!1,unindent_chained_methods:!1,break_chained_methods:!1,keep_array_indentation:!1,unescape_strings:!1,wrap_line_length:100,e4x:!1,comma_first:!1,operator_position:"before-newline",indent_empty_lines:!1,templating:["auto"]});default:return s}},APIlogViewerModal.prototype.formatted=function(s){try{return JSON.stringify(JSON.parse(this.record[s]),null,"\t")}catch(e){return this.record[s]}},__decorate([core_1.Input(),__metadata("design:type",Object)],APIlogViewerModal.prototype,"entry",void 0),APIlogViewerModal=__decorate([core_1.Component({template:'<system-modal size="large"><system-modal-header (close)="close()">{{entry.route}}</system-modal-header><system-modal-content system-modal-content-grow margin="none"><system-spinner *ngIf="isLoading" class="slds-m-top--medium" style="display:block"></system-spinner><div *ngIf="!isLoading" class="slds-tabs_default"><ul class="slds-tabs_default__nav" role="tablist"><li class="slds-tabs_default__item" [ngClass]="{\'slds-is-active\' : activeTab == \'record\'}" (click)="activeTab = \'record\'"><a class="slds-tabs_default__link"><system-label label="LBL_RECORD"></system-label></a></li><li class="slds-tabs_default__item" [ngClass]="{\'slds-is-active\' : activeTab == \'headers\'}" (click)="activeTab = \'headers\'"><a class="slds-tabs_default__link"><system-label label="LBL_HEADERS"></system-label></a></li><li *ngIf="hasRequest" class="slds-tabs_default__item" [ngClass]="{\'slds-is-active\' : activeTab == \'post\'}" (click)="activeTab = \'post\'"><a class="slds-tabs_default__link"><system-label label="LBL_REQUEST"></system-label></a></li><li *ngIf="hasResponse" class="slds-tabs_default__item" [ngClass]="{\'slds-is-active\' : activeTab == \'response\'}" (click)="activeTab = \'response\'"><a class="slds-tabs_default__link"><system-label label="LBL_RESPONSE"></system-label></a></li></ul><div class="slds-tabs_default__content slds-show" [ngClass]="{\'slds-hide\' : activeTab != \'record\'}"><table class="slds-table slds-table_cell-buffer slds-table_bordered slds-table--fixed-layout"><thead><tr class="slds-line-height_reset"><th class="slds-size--1-of-4" scope="col"><div class="slds-truncate"><system-label label="LBL_NAME"></system-label></div></th><th class="slds-size--3-of-4" scope="col"><div class="slds-truncate"><system-label label="LBL_VALUE"></system-label></div></th></tr></thead><tbody><tr><td><system-label label="LBL_ID"></system-label></td><td>{{entry.id}}</td></tr><tr><td><system-label label="LBL_TRANSACTIONID"></system-label></td><td>{{record.transaction_id}}</td></tr><tr><td><system-label label="LBL_SESSIONID"></system-label></td><td>{{record.session_id}}</td></tr><tr><td><system-label label="LBL_DATE"></system-label></td><td><system-display-datetime [date]="entry.date_entered"></system-display-datetime></td></tr><tr><td><system-label label="LBL_DIRECTION"></system-label></td><td>{{entry.direction}}</td></tr><tr><td><system-label label="LBL_STATUS"></system-label></td><td>{{entry.http_status_code}}</td></tr><tr><td><system-label label="LBL_METHOD"></system-label></td><td>{{entry.method}}</td></tr><tr><td><system-label label="LBL_RUNTIME"></system-label></td><td>{{entry.runtime}}</td></tr><tr><td><system-label label="LBL_USER"></system-label></td><td>{{entry.user_name}}</td></tr><tr><td><system-label label="LBL_ROUTE"></system-label></td><td>{{entry.route}}</td></tr><tr><td><system-label label="LBL_URL"></system-label></td><td>{{record.url}}</td></tr><tr><td><system-label label="LBL_IP"></system-label></td><td>{{record.ip}}</td></tr><tr><td><system-label label="LBL_ERROR"></system-label></td><td>{{record.response_error}}</td></tr></tbody></table><div *ngIf="requestArguments.length > 0" class="slds-p-vertical--small"><h3 class="slds-p-around--x-small"><system-label label="LBL_REQUEST_ARGUMENTS"></system-label></h3><table class="slds-table slds-table_cell-buffer slds-table_bordered slds-table--fixed-layout"><thead><tr class="slds-line-height_reset"><th class="slds-size--1-of-4" scope="col"><div class="slds-truncate"><system-label label="LBL_NAME"></system-label></div></th><th class="slds-size--3-of-4" scope="col"><div class="slds-truncate"><system-label label="LBL_VALUE"></system-label></div></th></tr></thead><tbody><tr class="slds-hint-parent" *ngFor="let requestArgument of requestArguments"><td><div class="slds-truncate">{{requestArgument.name}}</div></td><td><div class="slds-truncate">{{requestArgument.value}}</div></td></tr></tbody></table></div><div *ngIf="requestParams.length > 0" class="slds-p-vertical--small"><h3 class="slds-p-around--x-small"><system-label label="LBL_REQUEST_PARAMS"></system-label></h3><table class="slds-table slds-table_cell-buffer slds-table_bordered slds-table--fixed-layout"><thead><tr class="slds-line-height_reset"><th class="slds-size--1-of-4" scope="col"><div class="slds-truncate"><system-label label="LBL_NAME"></system-label></div></th><th class="slds-size--3-of-4" scope="col"><div class="slds-truncate"><system-label label="LBL_VALUE"></system-label></div></th></tr></thead><tbody><tr class="slds-hint-parent" *ngFor="let requestParam of requestParams"><td><div class="slds-truncate">{{requestParam.name}}</div></td><td><div class="slds-truncate">{{requestParam.value}}</div></td></tr></tbody></table></div></div><div class="slds-tabs_default__content slds-show" [ngClass]="{\'slds-hide\' : activeTab != \'headers\'}"><h3 class="slds-p-around--x-small"><system-label label="LBL_REQUEST_HEADERS"></system-label></h3><table class="slds-table slds-table_cell-buffer slds-table_bordered slds-table--fixed-layout"><thead><tr class="slds-line-height_reset"><th class="slds-size--1-of-4" scope="col"><div class="slds-truncate"><system-label label="LBL_NAME"></system-label></div></th><th class="slds-size--3-of-4" scope="col"><div class="slds-truncate"><system-label label="LBL_VALUE"></system-label></div></th></tr></thead><tbody><tr class="slds-hint-parent" *ngFor="let requestHeader of requestHeaders"><td><div class="slds-truncate">{{requestHeader.name}}</div></td><td><div class="slds-truncate">{{requestHeader.value}}</div></td></tr></tbody></table><ng-container *ngIf="record.response_headers"><h3 class="slds-p-around--x-small"><system-label label="LBL_RESPONSE_HEADERS"></system-label></h3><table class="slds-table slds-table_cell-buffer slds-table_bordered slds-table--fixed-layout"><thead><tr class="slds-line-height_reset"><th class="slds-size--1-of-4" scope="col"><div class="slds-truncate"><system-label label="LBL_NAME"></system-label></div></th><th class="slds-size--3-of-4" scope="col"><div class="slds-truncate"><system-label label="LBL_VALUE"></system-label></div></th></tr></thead><tbody><tr class="slds-hint-parent" *ngFor="let responseHeader of responseHeaders"><td><div class="slds-truncate">{{responseHeader.name}}</div></td><td><div class="slds-truncate">{{responseHeader.value}}</div></td></tr></tbody></table></ng-container></div><div *ngIf="hasRequest" class="slds-tabs_default__content slds-show" [ngClass]="{\'slds-hide\' : activeTab != \'post\'}"><ng-container [ngSwitch]="determineContentType(_requestheaders)"><div *ngSwitchCase="\'application/x-www-form-urlencoded\'"><table class="slds-table slds-table_cell-buffer slds-table_bordered slds-table--fixed-layout"><thead><tr class="slds-line-height_reset"><th class="slds-size--1-of-4" scope="col"><div class="slds-truncate"><system-label label="LBL_NAME"></system-label></div></th><th class="slds-size--3-of-4" scope="col"><div class="slds-truncate"><system-label label="LBL_VALUE"></system-label></div></th></tr></thead><tbody><tr class="slds-hint-parent" *ngFor="let rline of formattedRequest()"><td><div class="slds-truncate">{{rline.name}}</div></td><td><div class="slds-truncate">{{rline.value}}</div></td></tr></tbody></table></div><div *ngSwitchDefault class="slds-m-horizontal--x-small slds-box slds-theme--shade"><pre class="slds-text-font_monospace" style="overflow-wrap:break-word; white-space: pre-wrap;">{{formattedRequest()}}</pre></div></ng-container></div><div *ngIf="hasResponse" class="slds-tabs_default__content slds-show" [ngClass]="{\'slds-hide\' : activeTab != \'response\'}"><ng-container [ngSwitch]="determineContentType(_responseheaders)"><div *ngSwitchCase="\'application/x-www-form-urlencoded\'">url encoded</div><div *ngSwitchDefault class="slds-m-horizontal--x-small slds-box slds-theme--shade"><pre class="slds-text-font_monospace" style="overflow-wrap:break-word; white-space: pre-wrap;">{{formattedResponse()}}</pre></div></ng-container></div></div></system-modal-content><system-modal-footer><button class="slds-button slds-button--neutral" (click)="close()"><system-label label="LBL_CLOSE"></system-label></button></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[services_1.language,services_1.backend,services_1.toast,services_1.libloader])],APIlogViewerModal)}();exports.APIlogViewerModal=APIlogViewerModal;var ModuleFilterBuilder=function(){function ModuleFilterBuilder(){}return ModuleFilterBuilder=__decorate([core_1.Component({template:'<workbench-header titlelabel="LBL_FILTERBUILDER"></workbench-header><div class="slds-grid"><module-builder-filters class="slds-size--1-of-4" (filter)="filter = $event"></module-builder-filters><module-builder-filter-details class="slds-size--3-of-4" [filter]="filter"></module-builder-filter-details></div>'})],ModuleFilterBuilder)}();exports.ModuleFilterBuilder=ModuleFilterBuilder;var ModuleFilterBuilderFilters=function(){function e(e,s,t,l,i){this.backend=e,this.language=s,this.metadata=t,this.modelutilities=l,this.session=i,this.loading=!1,this._module="",this.filters=[],this.activeTab="global",this.filter=new core_1.EventEmitter,this.modules=this.metadata.getModules(),this.modules.sort()}var s;return Object.defineProperty(e.prototype,"module",{get:function(){return this._module},set:function(e){e!=this._module&&(this._module=e,this.filter.emit(null),this.loadLists())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"modulefilters",{get:function(){return this.filters.filter(function(e){return"global"==e.scope})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"customModulefilters",{get:function(){return this.filters.filter(function(e){return"custom"==e.scope})},enumerable:!1,configurable:!0}),e.prototype.goDetail=function(e){this.filter.emit(e)},e.prototype.loadLists=function(){var s=this;this.filters=[],this.module&&(this.loading=!0,this.backend.getRequest("configuration/sysmodulefilters/"+this.module).subscribe(function(e){s.filters=e,s.loading=!1}))},e.prototype.add=function(e){var s={id:this.modelutilities.generateGuid(),module:this.module,filterdefs:null,createdby:this.session.authData.userId,name:"new filter",scope:e,package:"",version:""};this.filters.push(s),this.filter.emit(s)},e.prototype.remove=function(s){this.metadata.removeModuleFilter(s.id),this.backend.deleteRequest("configuration/sysmodulefilters/"+s.module+"/"+s.id),this.filters=this.filters.filter(function(e){return e.id!=s.id}),this.filter.emit(void 0)},__decorate([core_1.Output(),__metadata("design:type","function"==typeof(s=void 0!==core_1.EventEmitter&&core_1.EventEmitter)?s:Object)],e.prototype,"filter",void 0),e=__decorate([core_1.Component({selector:"module-builder-filters",template:'<div class="slds-border--right"><div class="slds-p-around--x-small slds-border--bottom"><div class="slds-form-element slds-grid slds-grid--vertical-align-center"><label for="moduleselect" class="slds-form-element__label"><system-label label="LBL_MODULE"></system-label></label><div class="slds-form-element__control slds-col"><div class="slds-select_container"><select id="moduleselect" class="slds-select" [(ngModel)]="module"><option><system-label label="LBL_SELECT"></system-label></option><option *ngFor="let thismodule of modules" [value]="thismodule">{{thismodule}}</option></select></div></div></div></div><div system-to-bottom><div *ngIf="loading" class="slds-align--absolute-center slds-height_full"><system-spinner></system-spinner></div><div *ngIf="!module && !loading" class="slds-align--absolute-center slds-height_full"><system-label label="LBL_MAKE_SELECTION"></system-label></div><div *ngIf="module && !loading" class="slds-tabs_default" style="background-color: transparent"><ul class="slds-tabs_default__nav" role="tablist"><li class="slds-tabs_default__item slds-text-title--caps" [class.slds-is-active]="activeTab == \'custom\'" [title]="language.getLabel(\'LBL_CUSTOM\')" role="presentation"><a class="slds-tabs_default__link" href="javascript:void(0);" (click)="activeTab = \'custom\'" role="tab" tabindex="0" aria-selected="true" aria-controls="tab-custom" id="tab-custom-item"><system-label label="LBL_CUSTOM"></system-label></a></li><li class="slds-tabs_default__item slds-text-title--caps" [class.slds-is-active]="activeTab == \'global\'" [title]="language.getLabel(\'LBL_GLOBAL\')" role="presentation"><a class="slds-tabs_default__link" href="javascript:void(0);" (click)="activeTab = \'global\'" role="tab" tabindex="-1" aria-selected="false" aria-controls="tab-global" id="tab-global-item"><system-label label="LBL_GLOBAL"></system-label></a></li></ul><div id="tab-custom" class="slds-tabs_default__content slds-p-around--none" [ngClass]="activeTab == \'custom\' ? \'slds-show\' : \'slds-hide\'" role="tabpanel" aria-labelledby="tab-custom-item"><ul class="slds-has-dividers_around-space slds-p-around--x-small"><li *ngFor="let modulefilter of customModulefilters" class="slds-grid slds-grid--align-spread slds-item"><a href="javascript:void(0);" class="slds-text-link_reset" (click)="goDetail(modulefilter)">{{modulefilter.name}}</a> <button class="slds-button slds-button--icon slds-col_bump-left" (click)="remove(modulefilter)"><system-button-icon icon="clear"></system-button-icon></button></li></ul><div class="slds-p-around--x-small" [class.slds-border--top]="customModulefilters.length > 0"><button class="slds-align--absolute-center slds-button slds-button--icon slds-button--icon-border" style="border-radius: 50%;" (click)="add(\'custom\')"><system-button-icon icon="add" size="medium"></system-button-icon></button></div></div><div id="tab-global" class="slds-tabs_default__content slds-p-around--none" [ngClass]="activeTab == \'global\' ? \'slds-show\' : \'slds-hide\'" role="tabpanel" aria-labelledby="tab-global-item"><ul class="slds-has-dividers_around-space slds-p-around--x-small"><li *ngFor="let modulefilter of modulefilters" class="slds-grid slds-grid--align-spread slds-item"><a href="javascript:void(0);" class="slds-text-link_reset" (click)="goDetail(modulefilter)">{{modulefilter.name}}</a> <button class="slds-button slds-button--icon" (click)="remove(modulefilter)"><system-button-icon icon="clear"></system-button-icon></button></li></ul><div class="slds-p-around--x-small" [class.slds-border--top]="modulefilters.length > 0"><button class="slds-align--absolute-center slds-button slds-button--icon slds-button--icon-border" style="border-radius: 50%;" (click)="add(\'global\')"><system-button-icon icon="add" size="medium"></system-button-icon></button></div></div></div></div></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.language,services_1.metadata,services_1.modelutilities,services_1.session])],e)}();exports.ModuleFilterBuilderFilters=ModuleFilterBuilderFilters;var ModuleFilterBuilderFilterDetails=function(){function e(e,s,t,l){this.backend=e,this.language=s,this.metadata=t,this.toast=l,this.primaryGroup={logicaloperator:"and",groupscope:"all",conditions:[]}}return e.prototype.ngOnChanges=function(){this.filter&&(this.filter.filterdefs?this.primaryGroup="string"==typeof this.filter.filterdefs?JSON.parse(this.filter.filterdefs):this.filter.filterdefs:this.primaryGroup={logicaloperator:"and",conditions:[]})},e.prototype.save=function(){var s=this;this.cleangroup(this.primaryGroup),this.filter.filterdefs=this.primaryGroup,this.metadata.setModuleFilter(this.filter.id,this.filter.name,this.filter.module,this.filter.type),this.backend.postRequest("configuration/sysmodulefilters/"+this.filter.module+"/"+this.filter.id,{},this.filter).subscribe(function(e){return s.toast.sendToast(s.language.getLabel("LBL_DATA_SAVED")+".","success")})},e.prototype.cleangroup=function(e){for(var s=0,t=e.conditions;s<t.length;s++){var l=t[s],i=e.conditions.indexOf(l);!0===l.deleted?e.conditions.splice(i,1):l.conditions&&this.cleangroup(e.conditions[i])}},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"filter",void 0),e=__decorate([core_1.Component({selector:"module-builder-filter-details",template:'<div *ngIf="filter"><div class="slds-p-vertical--x-small slds-grid slds-grid--vertical-align-center slds-border--bottom"><div class="slds-col slds-grid slds-grid--vertical-align-center slds-size--1-of-2 slds-p-horizontal--x-small"><label class="slds-form-element__label"><system-label label="LBL_NAME"></system-label></label><div class="slds-form-element slds-col"><div class="slds-form-element__control"><input class="slds-input" type="text" [(ngModel)]="filter.name"></div></div></div><div class="slds-col slds-grid slds-grid--vertical-align-center slds-size--1-of-4 slds-p-horizontal--x-small"><label class="slds-form-element__label"><system-label label="LBL_PACKAGE"></system-label></label><div class="slds-form-element slds-col"><div class="slds-form-element__control"><input class="slds-input" type="text" [(ngModel)]="filter.package"></div></div></div><div class="slds-col slds-grid slds-grid--vertical-align-center slds-size--1-of-4 slds-p-horizontal--x-small"><label class="slds-form-element__label"><system-label label="LBL_VERSION"></system-label></label><div class="slds-form-element slds-col"><div class="slds-form-element__control"><input class="slds-input" type="text" [(ngModel)]="filter.version"></div></div></div></div><div class="slds-p-around--x-small"><div system-to-bottom class="slds-expression"><h2 class="slds-expression__title"><system-label label="LBL_CONDITIONS"></system-label></h2><ul><system-filter-builder-expression-group [filtergroup]="primaryGroup" [module]="filter.module"></system-filter-builder-expression-group></ul><h2 class="slds-expression__title"><system-label label="LBL_METHOD"></system-label></h2><div class="slds-p-around--xx-small"><system-input-backend-method [(ngModel)]="filter.filtermethod"></system-input-backend-method></div><div class="slds-expression__buttons"><button class="slds-button slds-button--brand" (click)="save()"><system-label label="LBL_SAVE"></system-label></button></div></div></div></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.language,services_1.metadata,services_1.toast])],e)}();exports.ModuleFilterBuilderFilterDetails=ModuleFilterBuilderFilterDetails;var DashletGenerator=function(){function DashletGenerator(){}return DashletGenerator=__decorate([core_1.Component({template:'<workbench-header titlelabel="LBL_DASHLET_GENERATOR"></workbench-header><div class="slds-grid"><dashlet-generator-dashlets class="slds-size--1-of-4" (dashlet)="dashlet = $event"></dashlet-generator-dashlets><dashlet_generator_dashlet-details class="slds-size--3-of-4" [dashlet]="dashlet"></dashlet_generator_dashlet-details></div>'})],DashletGenerator)}();exports.DashletGenerator=DashletGenerator;var DashletGeneratorDashlets=function(){function e(e,s,t,l){this.backend=e,this.language=s,this.metadata=t,this.modelutilities=l,this.loading=!1,this._module="",this.dashlets=[],this.activeTab="global",this.dashlet=new core_1.EventEmitter,this.modules=this.metadata.getModules(),this.modules.sort()}var s;return e.prototype.ngOnInit=function(){var s=this;this.loading=!0,this.backend.getRequest("module/Dashboards/dashlets").subscribe(function(e){s.dashlets=e,s.loading=!1})},Object.defineProperty(e.prototype,"module",{get:function(){return this._module},set:function(e){e!=this._module&&(this._module=e,this.dashlet.emit(null))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"moduleDashlets",{get:function(){var s=this;return this.dashlets.filter(function(e){return e.module==s.module&&"global"==e.type})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"customModuleDashlets",{get:function(){var s=this;return this.dashlets.filter(function(e){return e.module==s.module&&"custom"==e.type})},enumerable:!1,configurable:!0}),e.prototype.goDetail=function(e){this.dashlet.emit(e)},e.prototype.add=function(e){var s={id:this.modelutilities.generateGuid(),name:"new dashlet",component:"DashboardGenericDashlet",module:this.module,type:e,componentconfig:null,icon:"",description:"",acl_action:"",label:""};this.dashlets.push(s),this.dashlet.emit(s)},e.prototype.remove=function(s){this.backend.deleteRequest("module/Dashboards/dashlets/"+s),this.dashlets=this.dashlets.filter(function(e){return e.id!=s}),this.dashlet.emit(void 0)},__decorate([core_1.Output(),__metadata("design:type","function"==typeof(s=void 0!==core_1.EventEmitter&&core_1.EventEmitter)?s:Object)],e.prototype,"dashlet",void 0),e=__decorate([core_1.Component({selector:"dashlet-generator-dashlets",template:'<div class="slds-border--right"><div class="slds-p-around--x-small slds-border--bottom"><div class="slds-form-element slds-grid slds-grid--vertical-align-center"><label for="moduleselect" class="slds-form-element__label"><system-label label="LBL_MODULE"></system-label></label><div class="slds-form-element__control slds-col"><div class="slds-select_container"><select id="moduleselect" class="slds-select" [(ngModel)]="module"><option><system-label label="LBL_SELECT"></system-label></option><option *ngFor="let thismodule of modules" [value]="thismodule">{{thismodule}}</option></select></div></div></div></div><div system-to-bottom><div *ngIf="loading" class="slds-align--absolute-center slds-height_full"><system-spinner></system-spinner></div><div *ngIf="!module && !loading" class="slds-align--absolute-center slds-height_full"><system-label label="LBL_MAKE_SELECTION"></system-label></div><div *ngIf="module && !loading" class="slds-tabs_default" style="background-color: transparent"><ul class="slds-tabs_default__nav" role="tablist"><li class="slds-tabs_default__item slds-text-title--caps" [class.slds-is-active]="activeTab == \'custom\'" [title]="language.getLabel(\'LBL_CUSTOM\')" role="presentation"><a class="slds-tabs_default__link" href="javascript:void(0);" (click)="activeTab = \'custom\'" role="tab" tabindex="0" aria-selected="true" aria-controls="tab-custom" id="tab-custom-item"><system-label label="LBL_CUSTOM"></system-label></a></li><li class="slds-tabs_default__item slds-text-title--caps" [class.slds-is-active]="activeTab == \'global\'" [title]="language.getLabel(\'LBL_GLOBAL\')" role="presentation"><a class="slds-tabs_default__link" href="javascript:void(0);" (click)="activeTab = \'global\'" role="tab" tabindex="-1" aria-selected="false" aria-controls="tab-global" id="tab-global-item"><system-label label="LBL_GLOBAL"></system-label></a></li></ul><div id="tab-custom" class="slds-tabs_default__content slds-p-around--none" [ngClass]="activeTab == \'custom\' ? \'slds-show\' : \'slds-hide\'" role="tabpanel" aria-labelledby="tab-custom-item"><ul class="slds-has-dividers_around-space slds-p-around--x-small"><li *ngFor="let moduleDashlet of customModuleDashlets" class="slds-grid slds-grid--align-spread slds-item"><a href="javascript:void(0);" class="slds-text-link_reset" (click)="goDetail(moduleDashlet)">{{moduleDashlet.name}}</a> <button class="slds-button slds-button--icon slds-col_bump-left" (click)="remove(moduleDashlet.id)"><system-button-icon icon="clear"></system-button-icon></button></li></ul><div class="slds-p-around--x-small" [class.slds-border--top]="customModuleDashlets.length > 0"><button class="slds-align--absolute-center slds-button slds-button--icon slds-button--icon-border" style="border-radius: 50%;" (click)="add(\'custom\')"><system-button-icon icon="add" size="medium"></system-button-icon></button></div></div><div id="tab-global" class="slds-tabs_default__content slds-p-around--none" [ngClass]="activeTab == \'global\' ? \'slds-show\' : \'slds-hide\'" role="tabpanel" aria-labelledby="tab-global-item"><ul class="slds-has-dividers_around-space slds-p-around--x-small"><li *ngFor="let moduleDashlet of moduleDashlets" class="slds-grid slds-grid--align-spread slds-item"><a href="javascript:void(0);" class="slds-text-link_reset" (click)="goDetail(moduleDashlet)">{{moduleDashlet.name}}</a> <button class="slds-button slds-button--icon" (click)="remove(moduleDashlet.id)"><system-button-icon icon="clear"></system-button-icon></button></li></ul><div class="slds-p-around--x-small" [class.slds-border--top]="moduleDashlets.length > 0"><button class="slds-align--absolute-center slds-button slds-button--icon slds-button--icon-border" style="border-radius: 50%;" (click)="add(\'global\')"><system-button-icon icon="add" size="medium"></system-button-icon></button></div></div></div></div></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.language,services_1.metadata,services_1.modelutilities])],e)}();exports.DashletGeneratorDashlets=DashletGeneratorDashlets;var DashletGeneratorDashletDetails=function(){function e(e,s,t,l,i){this.backend=e,this.language=s,this.metadata=t,this.toast=l,this.view=i,this.sysModules=[],this.configValues={},this.view.setEditMode(),this.sysModules=this.metadata.getSystemModules()}return Object.defineProperty(e.prototype,"components",{get:function(){return this.metadata.getSystemComponents(this.sysModule)},enumerable:!1,configurable:!0}),e.prototype.ngOnChanges=function(){var s=this;if(this.dashlet){var e=this.metadata.getSystemComponents().find(function(e){return e.component==s.dashlet.component});this.sysModule=e?e.module:void 0,this.configValues=this.dashlet.componentconfig?JSON.parse(this.dashlet.componentconfig):{}}},e.prototype.save=function(){var s=this;this.dashlet.componentconfig=JSON.stringify(this.configValues),this.backend.postRequest("module/Dashboards/dashlets/"+this.dashlet.id,{},this.dashlet).subscribe(function(e){return s.toast.sendToast(s.language.getLabel("LBL_DATA_SAVED")+".","success")})},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"dashlet",void 0),e=__decorate([core_1.Component({selector:"dashlet_generator_dashlet-details",template:'<div *ngIf="dashlet"><div class="slds-p-around--x-small slds-border--bottom"><div class="slds-form-element slds-size--1-of-3 slds-form-element slds-size--1-of-3 slds-grid slds-grid--vertical-align-center"><div class="slds-grid slds-grid--vertical-align-center"><label class="slds-form-element__label"><system-label label="LBL_MODULE"></system-label></label><div class="slds-form-element__control slds-size--1-of-2"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="sysModule" [disabled]="generic"><option *ngFor="let sysModule of sysModules" [value]="sysModule.id">{{sysModule.module}}</option></select></div></div><label class="slds-form-element__label slds-m-left--small"><system-label label="LBL_COMPONENT"></system-label></label><div class="slds-form-element__control slds-size--1-of-2"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="dashlet.component" [disabled]="!sysModule"><option *ngFor="let component of components" [value]="component.component">{{component.component}}</option></select></div></div></div></div></div><div class="slds-p-around--x-small"><div class="slds-grid slds-gutters_direct-xx-small"><div class="slds-form-element slds-col slds-size--1-of-2"><label class="slds-form-element__label"><system-label label="LBL_NAME"></system-label></label><div class="slds-form-element__control"><input class="slds-input" type="text" [(ngModel)]="dashlet.name"></div></div><div class="slds-form-element slds-size--1-of-2"><label class="slds-form-element__label">Label</label><system-input-label [(ngModel)]="dashlet.label"></system-input-label></div></div><div class="slds-grid slds-gutters_direct-xx-small"><div class="slds-form-element slds-col slds-size--1-of-2"><label class="slds-form-element__label"><system-label label="LBL_PACKAGE"></system-label></label><div class="slds-form-element__control"><input class="slds-input" type="text" [(ngModel)]="dashlet.package"></div></div><div class="slds-form-element slds-col slds-size--1-of-2"><label class="slds-form-element__label"><system-label label="LBL_VERSION"></system-label></label><div class="slds-form-element__control"><input class="slds-input" type="text" [(ngModel)]="dashlet.version"></div></div></div><div class="slds-grid slds-gutters_direct-xx-small"><div class="slds-form-element slds-col slds-size--1-of-2"><label class="slds-form-element__label"><system-label label="LBL_ICON"></system-label></label><div class="slds-form-element__control"><input class="slds-input" type="text" [(ngModel)]="dashlet.icon"></div></div><div class="slds-form-element slds-col slds-size--1-of-2"><label class="slds-form-element__label"><system-label label="LBL_ACL_ACTION"></system-label></label><div class="slds-form-element__control"><input class="slds-input" type="text" [(ngModel)]="dashlet.acl_action"></div></div></div><div class="slds-form-element slds-size--1-of-1"><label class="slds-form-element__label"><system-label label="LBL_DESCRIPTION"></system-label></label><div class="slds-m-vertical--small slds-text-title_bold"><textarea class="slds-textarea" [(ngModel)]="dashlet.description" style="max-height: 400px; min-height: 30px"></textarea></div></div><div class="slds-size--1-of-1 slds-border--top slds-border--bottom slds-form-element slds-m-top--medium slds-p-bottom--medium"><div class="slds-text-title_bold slds-m-vertical--small"><system-label label="LBL_CONFIGURATION"></system-label></div><workbench-config [component]="dashlet.component" [configValues]="configValues"></workbench-config></div><div class="slds-align--absolute-center slds-p-top--medium"><button class="slds-button slds-button--brand" (click)="save()"><system-label label="LBL_SAVE"></system-label></button></div></div></div>',providers:[services_1.view]}),__metadata("design:paramtypes",[services_1.backend,services_1.language,services_1.metadata,services_1.toast,services_1.view])],e)}();exports.DashletGeneratorDashletDetails=DashletGeneratorDashletDetails;var WorkbenchModule=function(){function WorkbenchModule(){}return WorkbenchModule=__decorate([core_1.NgModule({imports:[common_1.CommonModule,forms_1.FormsModule,systemcomponents_1.SystemComponents,directives_1.DirectivesModule,objectfields_1.ObjectFields,objectcomponents_1.ObjectComponents,globalcomponents_1.GlobalComponents,drag_drop_1.DragDropModule],declarations:[DomainManager,DomainManagerDefinitions,DomainManagerFields,DomainManagerFieldTabs,DomainManagerFieldDetails,DomainManagerFieldValidation,DomainManagerAddDefinitionModal,DomainManagerAddFieldModal,DomainManagerSelectValidation,DomainManagerAddValidation,DomainManagerAddValidationValueModal,DictionaryManager,DictionaryManagerDefinitions,DictionaryManagerDefinitionTabs,DictionaryManagerItems,DictionaryManagerItemDetails,DictionaryManagerItemStatus,DictionaryManagerAddDefinitionModal,DictionaryManagerAddItemModal,DictionaryManagerRelationships,DictionaryManagerRelationshipsDetails,DictionaryManagerRelationshipAdd,DictionaryManagerRelationshipAddOneToMany,DictionaryManagerRelationshipContainerOneToMany,DictionaryManagerRelationshipAddManyToMany,DictionaryManagerRelationshipContainerManyToMany,DictionaryManagerRelationshipAddParent,DictionaryManagerRelationshipContainerParent,DictionaryManagerIndexes,DictionaryManagerIndexAdd,DictionaryManagerIndexDetails,DictionaryManagerFields,FieldsetManager,FieldsetManagerFieldsetDetails,FieldsetManagerFieldDetails,FieldsetManagerAddDialog,FieldsetManagerEditDialog,FieldsetManagerCopyDialog,ActionsetManager,ActionsetManagerActionDetails,ActionsetManagerAddDialog,ComponentsetManager,ComponentsetManagerComponentsetDetails,WorkbenchHeader,WorkbenchHeaderControls,WorkbenchConfigLabel,WorkbenchConfigOptionDefault,WorkbenchConfigOptionFieldset,WorkbenchConfigOptionModulefilter,WorkbenchConfigOptionComponentset,WorkbenchConfigOptionModule,WorkbenchConfigOptionActionset,WorkbenchConfigOptionBoolean,WorkbenchConfigOptionLabel,WorkbenchConfigOptionMethod,ComponentsetManagerAddDialog,ComponentsetManagerEditDialog,ValidationRulesManager,ValidationRulesConditions,ValidationRulesActions,MaybeJsonPipe,LanguageTranslationsManager,LanguageLabelManagerComponent,LanguageLabelModal,MailboxesManager,MailboxesTransportsEnum,LanguageLabelModal,MailboxManagerAddDialog,MailboxesmanagerTestModal,MailboxesmanagerTestIMAPModal,MailboxesImapSmtpTrafficManager,MailboxesIMAPSMTPSelectFoldersModal,MailboxesGmailTrafficManager,MailboxesMailgunTrafficManager,MailboxesSendgridTrafficManager,MailboxesTwillioTrafficManager,MailboxesA1SmsTrafficManager,MailboxesA1TrafficManager,MailboxesEWSTrafficManager,MailboxesEWSSelectFoldersModal,MailboxesTransportManager,SortPipe,MailboxesProcessors,SelectTreeComponent,SelectTreeAddDialog,ModuleConfigManager,ModuleConfigAddDialog,WorkbenchConfig,ConfigCleaner,StyleCacheCleaner,GoogleCalendarManager,ObjectRepositoryManager,ObjectRepositoryManagerFilter,ObjectRepositoryManagerAddRepo,ObjectRepositoryExport,ObjectRepositoryManagerAddModule,CRMLogViewer,CRMLogViewerList,CRMLogViewerModal,CRMLogViewerListModal,APIlogViewer,APIlogViewerModal,ModuleFilterBuilder,ModuleFilterBuilderFilters,ModuleFilterBuilderFilterDetails,DashletGenerator,DashletGeneratorDashlets,DashletGeneratorDashletDetails,ConfigTransfer],entryComponents:[DomainManager,DictionaryManager,FieldsetManager,ComponentsetManager,WorkbenchConfigLabel,WorkbenchConfigOptionDefault,WorkbenchConfigOptionFieldset,WorkbenchConfigOptionModulefilter,WorkbenchConfigOptionComponentset,WorkbenchConfigOptionActionset,ModuleConfigManager,WorkbenchConfig,ObjectRepositoryManager,CRMLogViewer,CRMLogViewerList,CRMLogViewerModal,CRMLogViewerListModal,APIlogViewer,APIlogViewerModal,ConfigTransfer],exports:[SortPipe]})],WorkbenchModule)}();exports.WorkbenchModule=WorkbenchModule;