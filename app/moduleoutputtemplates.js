/*!
 * 
 *                     aacService
 *
 *                     release: 2023.01.001
 *
 *                     date: 2023-04-19 17:23:57
 *
 *                     build: 2023.01.001.1681917837156
 *
 */
"use strict";(self.webpackChunkcore=self.webpackChunkcore||[]).push([["src_modules_outputtemplates_moduleoutputtemplates_ts"],{9769:(e,t,s)=>{s.r(t),s.d(t,{ModuleOutputTemplates:()=>ke});var l=s(6895),i=s(433),n=s(4357),o=s(5886),a=s(3283),d=s(8363),c=s(1652),u=s(1571),r=s(5329),p=s(4154),m=s(5710),g=s(9062),h=s(1553),f=s(3463),b=s(727),_=s(4505),T=s(4044),Z=s(1481),x=s(3278),v=s(2656),O=s(4561),y=s(4664);function M(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"div",3)(1,"div",23)(2,"span",24)(3,"span",25),u._UZ(4,"system-icon",26),u.qZA(),u.TgZ(5,"span",27),u._uU(6),u.qZA(),u.TgZ(7,"button",28),u.NdJ("click",(function(){u.CHM(e);const t=u.oxw();return u.KtG(t.clearField())})),u._UZ(8,"system-button-icon",29),u.qZA()()()()}if(2&e){const e=u.oxw();u.xp6(4),u.Q6J("module",e.module)("size","small"),u.xp6(2),u.Oqu(e.selectedItem.summary_text),u.xp6(2),u.Q6J("icon","close")}}function F(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"div",30)(1,"input",31),u.NdJ("focus",(function(){u.CHM(e);const t=u.oxw();return u.KtG(t.searchWithModal())})),u.qZA(),u.TgZ(2,"button",32),u.NdJ("click",(function(){u.CHM(e);const t=u.oxw();return u.KtG(t.searchWithModal())})),u._UZ(3,"system-button-icon",29),u.qZA()()}if(2&e){const e=u.oxw();u.xp6(1),u.Q6J("placeholder",e.placeholder),u.xp6(2),u.Q6J("icon","search")}}function L(e,t){if(1&e&&u._UZ(0,"iframe",33),2&e){const e=u.oxw();u.Q6J("srcdoc",e.sanitizedTemplated,u.oJD)}}function w(e,t){if(1&e&&u._UZ(0,"object",34),2&e){const e=u.oxw();u.Q6J("data",e.blobUrl,u.uOi)}}function A(e,t){1&e&&(u.TgZ(0,"div",35),u._UZ(1,"system-spinner"),u.qZA())}function J(e,t){1&e&&(u.TgZ(0,"div",35),u._UZ(1,"system-label",36),u.qZA())}let C=(()=>{class OutputTemplatesPreview{constructor(e,t,s,l,i,n,o,a){this.language=e,this.backend=t,this.metadata=s,this.model=l,this.modal=i,this.sanitizer=n,this.cdRef=o,this.toast=a,this._outputformat="pdf",this.loading_output=!1,this.subscriptions=new b.w0,this.compiled_selected_template="",this.model.data$.subscribe((e=>{this.checkModelChanges()}))}ngOnDestroy(){this.subscriptions.unsubscribe()}get sanitizedTemplated(){return this.sanitizer.bypassSecurityTrustHtml(this.compiled_selected_template)}get outputformat(){return this._outputformat}set outputformat(e){this._outputformat=e,this.rendertemplate()}checkModelChanges(){this.selectedItem&&this.selectedItem.module!=this.module&&this.clearField()}get module(){return this.model.getField("module_name")}get placeholder(){return this.module?this.language.getModuleCombinedLabel("LBL_SEARCH",this.module):this.language.getLabel("LBL_SEARCH")}searchWithModal(){this.modal.openModal("ObjectModalModuleLookup").subscribe((e=>{e.instance.module=this.module,e.instance.multiselect=!1,this.subscriptions.add(e.instance.selectedItems.subscribe((e=>{e.length&&(this.selectedItem={id:e[0].id,summary_text:e[0].summary_text,module:this.module,data:e[0]},this.blobUrl=null,this.compiled_selected_template=null,this.rendertemplate())})))}))}clearField(){this.selectedItem=void 0,this.blobUrl=null,this.compiled_selected_template=null,this.cdRef.detectChanges()}rendertemplate(){this.loading_output=!0,this.blobUrl=null,this.compiled_selected_template=null,this.cdRef.detectChanges();let e={language:this.model.getField("language"),parentype:this.module,parentid:this.selectedItem.id,body:this.model.getField("body"),header:this.model.getField("header"),footer:this.model.getField("footer"),stylesheet_id:this.model.getField("stylesheet_id"),page_orientation:this.model.getField("page_orientation"),page_size:this.model.getField("page_size"),margin_left:this.model.getField("margin_left"),margin_top:this.model.getField("margin_top"),margin_right:this.model.getField("margin_right"),margin_bottom:this.model.getField("margin_bottom"),id:this.model.id};switch(this.outputformat){case"pdf":this.backend.postRequest("module/OutputTemplates/previewpdf",{},e).subscribe((e=>{let t=this.datatoBlob(atob(e.content));this.blobUrl=this.sanitizer.bypassSecurityTrustResourceUrl(URL.createObjectURL(t)),this.loading_output=!1,this.cdRef.detectChanges()}),(e=>{this.toast.sendToast(this.language.getLabel("ERR_PROCESSING_OUTPUT_TEMPLATE"),"error",e.error.error.message),this.loading_output=!1,this.cdRef.detectChanges()}));break;case"html":this.backend.postRequest("module/OutputTemplates/previewhtml",{},e).subscribe((e=>{this.compiled_selected_template=e.content,this.loading_output=!1,this.cdRef.detectChanges()}),(e=>{this.toast.sendToast(this.language.getLabel("ERR_PROCESSING_OUTPUT_TEMPLATE"),"error",e.error.error.message),this.loading_output=!1,this.cdRef.detectChanges()}))}}datatoBlob(e,t="",s=512){let l=[];for(let t=0;t<e.length;t+=s){let i=e.slice(t,t+s),n=new Array(i.length);for(let e=0;e<i.length;e++)n[e]=i.charCodeAt(e);let o=new Uint8Array(n);l.push(o)}return new Blob(l,{type:t})}}return OutputTemplatesPreview.ɵfac=function(e){return new(e||OutputTemplatesPreview)(u.Y36(r.d),u.Y36(_.y),u.Y36(p.Pu),u.Y36(m.o),u.Y36(T.o),u.Y36(Z.H7),u.Y36(u.sBO),u.Y36(x.A))},OutputTemplatesPreview.ɵcmp=u.Xpm({type:OutputTemplatesPreview,selectors:[["output-templates-preview"]],decls:28,vars:9,consts:[[1,"slds-grid","slds-grid--vertical-align-end","slds-gutters_direct-xx-small"],[1,"slds-col","slds-grow","slds-form-element"],[1,"slds-form-element__label"],[1,"slds-form-element__control"],[1,"slds-combobox_container"],["aria-expanded","false","aria-haspopup","listbox","role","combobox",1,"slds-combobox","slds-dropdown-trigger","slds-dropdown-trigger_click"],[1,"slds-form-element__control","slds-box--border"],["class","slds-form-element__control",4,"ngIf"],["class","slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right",4,"ngIf"],[1,"slds-col","slds-form-element","slds-size--1-of-4"],[1,"slds-form-element__labe"],["label","LBL_DISPLAY"],[1,"slds-form-element__control","slds-p-top--xx-small"],[1,"slds-select_container"],[1,"slds-col","slds-select",3,"disabled","ngModel","ngModelChange"],["value","html"],["value","pdf"],[1,"slds-button","slds-button--icon","slds-button--icon-border",3,"disabled","click"],["icon","refresh"],[1,"slds-m-top--small","slds-border--top","slds-border--right","slds-border--left","slds-border--bottom",2,"height","calc(100vh - 300px)"],["frameBorder","0","style","width: 100%;height: 100%;",3,"srcdoc",4,"ngIf"],["type","application/pdf","width","100%","height","100%",3,"data",4,"ngIf"],["class","slds-align--absolute-center","style","height: 100%;",4,"ngIf"],[1,"slds-pill_container"],[1,"slds-pill","slds-size--1-of-1"],[1,"slds-icon_container","slds-icon-standard-account","slds-pill__icon_container"],[3,"module","size"],[1,"slds-pill__label"],[1,"slds-button","slds-button--icon","slds-pill__remove",3,"click"],[3,"icon"],[1,"slds-combobox__form-element","slds-input-has-icon","slds-input-has-icon_right"],["type","text","autocomplete","none","role","combobox",1,"slds-input","slds-combobox__input",3,"placeholder","focus"],[1,"slds-button","slds-button_icon","slds-input__icon","slds-input__icon_right",3,"click"],["frameBorder","0",2,"width","100%","height","100%",3,"srcdoc"],["type","application/pdf","width","100%","height","100%",3,"data"],[1,"slds-align--absolute-center",2,"height","100%"],["label","MSG_NO_RECORD_SELECTED"]],template:function(e,t){1&e&&(u.TgZ(0,"div",0)(1,"div",1)(2,"label",2),u._uU(3,"Bean"),u.qZA(),u.TgZ(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6),u.YNc(8,M,9,4,"div",7),u.YNc(9,F,4,2,"div",8),u.qZA()()()()(),u.TgZ(10,"div",9)(11,"label",10),u._UZ(12,"system-label",11),u.qZA(),u.TgZ(13,"div",12)(14,"div",13)(15,"select",14),u.NdJ("ngModelChange",(function(e){return t.outputformat=e})),u.TgZ(16,"option",15),u._uU(17,"HTML"),u.qZA(),u.TgZ(18,"option",16),u._uU(19,"PDF"),u.qZA()()()()(),u.TgZ(20,"div")(21,"button",17),u.NdJ("click",(function(){return t.rendertemplate()})),u._UZ(22,"system-button-icon",18),u.qZA()()(),u.TgZ(23,"div",19),u.YNc(24,L,1,1,"iframe",20),u.YNc(25,w,1,1,"object",21),u.YNc(26,A,2,0,"div",22),u.YNc(27,J,2,0,"div",22),u.qZA()),2&e&&(u.xp6(8),u.Q6J("ngIf",t.selectedItem),u.xp6(1),u.Q6J("ngIf",!t.selectedItem),u.xp6(6),u.Q6J("disabled",!t.selectedItem)("ngModel",t.outputformat),u.xp6(6),u.Q6J("disabled",!t.selectedItem||t.loading_output),u.xp6(3),u.Q6J("ngIf","html"===t.outputformat&&!t.loading_output&&t.compiled_selected_template),u.xp6(1),u.Q6J("ngIf","pdf"===t.outputformat&&!t.loading_output&&t.blobUrl),u.xp6(1),u.Q6J("ngIf",t.loading_output),u.xp6(1),u.Q6J("ngIf",!t.selectedItem&&!t.loading_output))},dependencies:[l.O5,i.YN,i.Kr,i.EJ,i.JJ,i.On,v.J,O.f,f._,y.W],encapsulation:2,changeDetection:0}),OutputTemplatesPreview})();const N=function(e){return{"slds-is-active":e}},B=function(e,t){return{"slds-show":e,"slds-hide":t}};let q=(()=>{class OutputTemplatesEditor{constructor(e,t,s){this.language=e,this.metadata=t,this.model=s,this.selectedTab="body",this.componentconfig={}}get bodyfieldset(){return this.componentconfig.body}get headerfieldset(){return this.componentconfig.header}get footerfieldset(){return this.componentconfig.footer}}return OutputTemplatesEditor.ɵfac=function(e){return new(e||OutputTemplatesEditor)(u.Y36(r.d),u.Y36(p.Pu),u.Y36(m.o))},OutputTemplatesEditor.ɵcmp=u.Xpm({type:OutputTemplatesEditor,selectors:[["ng-component"]],decls:23,vars:35,consts:[["tabtitle","LBL_CONTENT"],[1,"slds-tabs_scoped","slds-p-around--x-small"],["role","tablist",1,"slds-tabs_scoped__nav"],["role","presentation",1,"slds-tabs_scoped__item",3,"ngClass","title","click"],["href","javascript:void(0);","role","tab",1,"slds-tabs_scoped__link"],["label","LBL_CONTENT"],["label","LBL_HEADER"],["label","LBL_FOOTER"],["label","LBL_PREVIEW"],["role","tabpanel",1,"slds-tabs_scoped__content",3,"ngClass"],["direction","vertical",3,"fieldset"]],template:function(e,t){1&e&&(u.TgZ(0,"system-collapsable-tab",0)(1,"div",1)(2,"ul",2)(3,"li",3),u.NdJ("click",(function(){return t.selectedTab="body"})),u.TgZ(4,"a",4),u._UZ(5,"system-label",5),u.qZA()(),u.TgZ(6,"li",3),u.NdJ("click",(function(){return t.selectedTab="header"})),u.TgZ(7,"a",4),u._UZ(8,"system-label",6),u.qZA()(),u.TgZ(9,"li",3),u.NdJ("click",(function(){return t.selectedTab="footer"})),u.TgZ(10,"a",4),u._UZ(11,"system-label",7),u.qZA()(),u.TgZ(12,"li",3),u.NdJ("click",(function(){return t.selectedTab="preview"})),u.TgZ(13,"a",4),u._UZ(14,"system-label",8),u.qZA()()(),u.TgZ(15,"div",9),u._UZ(16,"object-record-fieldset",10),u.qZA(),u.TgZ(17,"div",9),u._UZ(18,"object-record-fieldset",10),u.qZA(),u.TgZ(19,"div",9),u._UZ(20,"object-record-fieldset",10),u.qZA(),u.TgZ(21,"div",9),u._UZ(22,"output-templates-preview"),u.qZA()()()),2&e&&(u.xp6(3),u.Q6J("ngClass",u.VKq(15,N,"body"==t.selectedTab))("title",t.language.getLabel("LBL_CONTENT")),u.xp6(3),u.Q6J("ngClass",u.VKq(17,N,"header"==t.selectedTab))("title",t.language.getLabel("LBL_HEADER")),u.xp6(3),u.Q6J("ngClass",u.VKq(19,N,"footer"==t.selectedTab))("title",t.language.getLabel("LBL_FOOTER")),u.xp6(3),u.Q6J("ngClass",u.VKq(21,N,"preview"==t.selectedTab))("title",t.language.getLabel("LBL_PREVIEW")),u.xp6(3),u.Q6J("ngClass",u.WLB(23,B,"body"==t.selectedTab,"body"!=t.selectedTab)),u.xp6(1),u.Q6J("fieldset",t.bodyfieldset),u.xp6(1),u.Q6J("ngClass",u.WLB(26,B,"header"==t.selectedTab,"header"!=t.selectedTab)),u.xp6(1),u.Q6J("fieldset",t.headerfieldset),u.xp6(1),u.Q6J("ngClass",u.WLB(29,B,"footer"==t.selectedTab,"footer"!=t.selectedTab)),u.xp6(1),u.Q6J("fieldset",t.footerfieldset),u.xp6(1),u.Q6J("ngClass",u.WLB(32,B,"preview"==t.selectedTab,"preview"!=t.selectedTab)))},dependencies:[l.mk,g.d,h.z,f._,C],encapsulation:2}),OutputTemplatesEditor})();function k(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"div",2)(1,"div",8)(2,"span",9)(3,"span",10),u._UZ(4,"system-icon",11),u.qZA(),u.TgZ(5,"span",12),u._uU(6),u.qZA(),u.TgZ(7,"button",13),u.NdJ("click",(function(){u.CHM(e);const t=u.oxw();return u.KtG(t.clearField())})),u._UZ(8,"system-button-icon",14),u.qZA()()()()}if(2&e){const e=u.oxw();u.xp6(4),u.Q6J("module",e.module)("size","small"),u.xp6(2),u.Oqu(e.selectedItem.summary_text),u.xp6(2),u.Q6J("icon","close")}}function U(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"div",15)(1,"input",16),u.NdJ("focus",(function(){u.CHM(e);const t=u.oxw();return u.KtG(t.searchWithModal())})),u.qZA(),u.TgZ(2,"button",17),u.NdJ("click",(function(){u.CHM(e);const t=u.oxw();return u.KtG(t.searchWithModal())})),u._UZ(3,"system-button-icon",14),u.qZA()()}if(2&e){const e=u.oxw();u.xp6(1),u.Q6J("disabled",e.module)("placeholder",e.placeholder),u.xp6(2),u.Q6J("icon","search")}}let Q=(()=>{class OutputTemplatesPreviewSelector{constructor(e,t,s,l){this.language=e,this.metadata=t,this.model=s,this.modal=l,this.subscriptions=new b.w0}ngOnDestroy(){this.subscriptions.unsubscribe()}get module(){return this.model.getField("module_name")}get placeholder(){return this.language.getModuleCombinedLabel("LBL_SEARCH",this.module)}searchWithModal(){this.modal.openModal("ObjectModalModuleLookup").subscribe((e=>{e.instance.module=this.module,e.instance.multiselect=!1,this.subscriptions.add(e.instance.selectedItems.subscribe((e=>{e.length&&(this.selectedItem=e[0])})))}))}clearField(){this.selectedItem=void 0}}return OutputTemplatesPreviewSelector.ɵfac=function(e){return new(e||OutputTemplatesPreviewSelector)(u.Y36(r.d),u.Y36(p.Pu),u.Y36(m.o),u.Y36(T.o))},OutputTemplatesPreviewSelector.ɵcmp=u.Xpm({type:OutputTemplatesPreviewSelector,selectors:[["output-templates-preview-selector"]],decls:9,vars:2,consts:[[1,"slds-form-element"],[1,"slds-form-element__label"],[1,"slds-form-element__control"],[1,"slds-combobox_container"],["aria-expanded","false","aria-haspopup","listbox","role","combobox",1,"slds-combobox","slds-dropdown-trigger","slds-dropdown-trigger_click"],[1,"slds-form-element__control","slds-box--border"],["class","slds-form-element__control",4,"ngIf"],["class","slds-input-has-icon slds-input-has-icon--right slds-grow",4,"ngIf"],[1,"slds-pill_container"],[1,"slds-pill","slds-size--1-of-1"],[1,"slds-icon_container","slds-icon-standard-account","slds-pill__icon_container"],[3,"module","size"],[1,"slds-pill__label"],[1,"slds-button","slds-button--icon","slds-pill__remove",3,"click"],[3,"icon"],[1,"slds-input-has-icon","slds-input-has-icon--right","slds-grow"],["type","text","role","combobox",1,"slds-lookup__search-input","slds-input--bare",3,"disabled","placeholder","focus"],[1,"slds-button","slds-button_icon","slds-input__icon","slds-input__icon_right",3,"click"]],template:function(e,t){1&e&&(u.TgZ(0,"div",0)(1,"label",1),u._uU(2,"Bean"),u.qZA(),u.TgZ(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5),u.YNc(7,k,9,4,"div",6),u.YNc(8,U,4,3,"div",7),u.qZA()()()()()),2&e&&(u.xp6(7),u.Q6J("ngIf",t.selectedItem),u.xp6(1),u.Q6J("ngIf",!t.selectedItem))},dependencies:[l.O5,v.J,O.f],encapsulation:2}),OutputTemplatesPreviewSelector})();var E=s(6625);let R=(()=>{class ObjectActionOutputBeanButton{constructor(e,t,s,l,i,n){this.language=e,this.model=t,this.modal=s,this.backend=l,this.configuration=i,this.viewContainerRef=n,this.templates=[]}execute(){let e=this.configuration.getData("OutputTemplates");e&&e[this.model.module]?(this.templates=e[this.model.module],this.openOutput()):(e={},this.modal.openModal("SystemLoadingModal",!1).subscribe((e=>{e.instance.messagelabel="Loading Templates",this.backend.getRequest("module/OutputTemplates/formodule/"+this.model.module,{}).subscribe((t=>{e.instance.self.destroy(),this.configuration.setData("OutputTemplates",t),this.templates=t,this.openOutput()}),(t=>{e.instance.self.destroy()}))})))}openOutput(){this.templates.length>0?(this.templates.sort(((e,t)=>e.name>t.name?1:-1)),this.modal.openModal("ObjectActionOutputBeanModal",!0,this.viewContainerRef.injector).subscribe((e=>{e.instance.templates=this.templates,e.instance.modalTitle=this.modalTitle,e.instance.noDownload=this.noDownload,e.instance.handBack=this.handBack,e.instance.customActionsetId=this.actionconfig.modal_actionset,e.instance.buttonText=this.buttonText}))):this.modal.info("No Templates Found","there are no Output templates defined for the Module")}}return ObjectActionOutputBeanButton.ɵfac=function(e){return new(e||ObjectActionOutputBeanButton)(u.Y36(r.d),u.Y36(m.o),u.Y36(T.o),u.Y36(_.y),u.Y36(E.C),u.Y36(u.s_b))},ObjectActionOutputBeanButton.ɵcmp=u.Xpm({type:ObjectActionOutputBeanButton,selectors:[["object-action-output-bean-button"]],decls:2,vars:0,consts:[["label","LBL_PDF"]],template:function(e,t){1&e&&(u.TgZ(0,"span"),u._UZ(1,"system-label",0),u.qZA())},dependencies:[f._],encapsulation:2}),ObjectActionOutputBeanButton})(),I=(()=>{class ObjectActionLiveCompileBeanButton extends R{constructor(){super(...arguments),this.actionemitter=new u.vpe}openOutput(){this.templates.length>0?(this.templates.sort(((e,t)=>e.name>t.name?1:-1)),this.modal.openModal("ObjectActionOutputBeanModal",!0,this.viewContainerRef.injector).subscribe((e=>{e.instance.templates=this.templates,e.instance.modalTitle=this.modalTitle,e.instance.noDownload=this.noDownload,e.instance.handBack=this.handBack,e.instance.liveCompile=!0,e.instance.forcedFormat="pdf",e.instance.customActionsetId=this.actionconfig.modal_actionset,e.instance.buttonText=this.buttonText,e.instance.outputModalService.modalResponse$.subscribe((e=>{"marksent"==e&&this.actionemitter.emit(e)}))}))):this.modal.info("No Templates Found","there are no Output templates defined for the Module")}}return ObjectActionLiveCompileBeanButton.ɵfac=function(){let e;return function(t){return(e||(e=u.n5z(ObjectActionLiveCompileBeanButton)))(t||ObjectActionLiveCompileBeanButton)}}(),ObjectActionLiveCompileBeanButton.ɵcmp=u.Xpm({type:ObjectActionLiveCompileBeanButton,selectors:[["object-action-live-compile-bean-button"]],outputs:{actionemitter:"actionemitter"},features:[u.qOj],decls:2,vars:0,consts:[["label","LBL_PDF"]],template:function(e,t){1&e&&(u.TgZ(0,"span"),u._UZ(1,"system-label",0),u.qZA())},dependencies:[f._],encapsulation:2}),ObjectActionLiveCompileBeanButton})();var Y=s(2198),j=s(2486),S=s(7040),P=s(2294),H=s(1933),D=s(6367),z=s(3208),V=s(5638);function $(e,t){if(1&e&&u._UZ(0,"field-label",3),2&e){const e=u.oxw();u.Q6J("fieldname",e.fieldname)("fieldconfig",e.fieldconfig)}}function K(e,t){if(1&e&&(u.ynx(0),u._uU(1),u.BQk()),2&e){const e=u.oxw(2);u.xp6(1),u.AsE("",null==e.selected_item?null:e.selected_item.name," (",null==e.selected_item?null:e.selected_item.language,")")}}function W(e,t){if(1&e&&(u.TgZ(0,"field-generic-display",4),u.YNc(1,K,2,2,"ng-container",5),u.qZA()),2&e){const e=u.oxw();u.Q6J("fielddisplayclass",e.fielddisplayclass)("editable",e.isEditable())("fieldconfig",e.fieldconfig),u.xp6(1),u.Q6J("ngIf",e.value)}}function G(e,t){if(1&e&&(u.TgZ(0,"option",12),u._uU(1),u.qZA()),2&e){const e=t.$implicit;u.Q6J("ngValue",e.id),u.xp6(1),u.AsE("",e.name," (",e.language,")")}}function X(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"div",6)(1,"div",7)(2,"div",8)(3,"select",9),u.NdJ("ngModelChange",(function(t){u.CHM(e);const s=u.oxw();return u.KtG(s.value=t)})),u.YNc(4,G,2,3,"option",10),u.qZA()(),u._UZ(5,"field-messages",11),u.qZA()()}if(2&e){const e=u.oxw();u.xp6(1),u.Q6J("ngClass",e.getFieldClass()),u.xp6(2),u.Q6J("disabled",e.isDisabled)("ngModel",e.value),u.xp6(1),u.Q6J("ngForOf",e.items),u.xp6(1),u.Q6J("fieldname",e.fieldname)}}let ee=(()=>{class fieldOutputTemplates extends S.O{constructor(e,t,s,l,i,n,o){super(e,t,s,l,i),this.model=e,this.view=t,this.language=s,this.metadata=l,this.router=i,this.backend=n,this.configuration=o,this.isLoaded=!1,this.items=[]}get isDisabled(){return!this.isLoaded||!this.items}get selected_item(){return this.items.find((e=>e.id==this.value))}ngOnInit(){let e=this.configuration.getData("OutputTemplates");e&&e[this.model.module]?(this.items=e[this.model.module],this.isLoaded=!0):this.backend.getRequest("module/OutputTemplates/formodule/"+this.model.module,{}).subscribe((e=>{this.configuration.setData("OutputTemplates",e),this.items=e,this.isLoaded=!0}))}}return fieldOutputTemplates.ɵfac=function(e){return new(e||fieldOutputTemplates)(u.Y36(m.o),u.Y36(P.e),u.Y36(r.d),u.Y36(p.Pu),u.Y36(H.F0),u.Y36(_.y),u.Y36(E.C))},fieldOutputTemplates.ɵcmp=u.Xpm({type:fieldOutputTemplates,selectors:[["field-output-templates"]],features:[u.qOj],decls:3,vars:3,consts:[[3,"fieldname","fieldconfig",4,"ngIf"],[3,"fielddisplayclass","editable","fieldconfig",4,"ngIf"],["class","slds-form-element",4,"ngIf"],[3,"fieldname","fieldconfig"],[3,"fielddisplayclass","editable","fieldconfig"],[4,"ngIf"],[1,"slds-form-element"],[1,"slds-form-element__control",3,"ngClass"],[1,"slds-select_container","slds-m-vertical--xx-small"],[1,"slds-select",3,"disabled","ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"fieldname"],[3,"ngValue"]],template:function(e,t){1&e&&(u.YNc(0,$,1,2,"field-label",0),u.YNc(1,W,2,4,"field-generic-display",1),u.YNc(2,X,6,5,"div",2)),2&e&&(u.Q6J("ngIf",t.displayLabel),u.xp6(1),u.Q6J("ngIf",!t.isEditMode()),u.xp6(1),u.Q6J("ngIf",t.isEditMode()))},dependencies:[l.mk,l.sg,l.O5,i.YN,i.Kr,i.EJ,i.JJ,i.On,D.q,z.D,V.a],encapsulation:2}),fieldOutputTemplates})();var te=s(5698),se=s(9621),le=s(3499),ie=s(5767),ne=s(1916),oe=s(2161),ae=s(494),de=s(8859),ce=s(4947);function ue(e,t){if(1&e&&(u.TgZ(0,"option",18),u._uU(1),u.qZA()),2&e){const e=u.oxw().$implicit;u.Q6J("value",e.templateObjectName),u.xp6(1),u.Oqu(e.displayName)}}function re(e,t){if(1&e&&(u.ynx(0),u.YNc(1,ue,2,2,"option",62),u.BQk()),2&e){const e=t.$implicit;u.xp6(1),u.Q6J("ngIf","current_user"!==e.templateObjectName&&"template"!==e.templateObjectName)}}function pe(e,t){1&e&&(u.TgZ(0,"option",63),u._uU(1," "),u.qZA())}function me(e,t){1&e&&(u.ynx(0),u.TgZ(1,"option",63),u._uU(2," "),u.qZA(),u.TgZ(3,"option",64),u._UZ(4,"system-label",65),u.qZA(),u.BQk()),2&e&&(u.xp6(3),u.Q6J("value","template"))}function ge(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"div",68)(1,"system-module-tree",69),u.NdJ("itemSelected",(function(t){const s=u.CHM(e).$implicit,l=u.oxw(2);return u.KtG(l.treeItemSelected(t,s.name))})),u.qZA()()}if(2&e){const e=t.$implicit,s=u.oxw(2);u.ekj("slds-hide",s.activeModule!=e.templateObjectName),u.xp6(1),u.Q6J("module",e.name)}}function he(e,t){if(1&e&&(u.TgZ(0,"div",66),u.YNc(1,ge,2,3,"div",67),u.qZA()),2&e){const e=u.oxw();u.xp6(1),u.Q6J("ngForOf",e.offeredModules)("ngForTrackBy",e.trackByFn)}}function fe(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"tr")(1,"td")(2,"div",30)(3,"a",70),u.NdJ("click",(function(){const t=u.CHM(e).$implicit,s=u.oxw(2);return u.KtG(s.fieldSelected(t.name))})),u._uU(4),u.qZA()()(),u.TgZ(5,"td")(6,"div",30),u._UZ(7,"system-label",71),u.qZA()()()}if(2&e){const e=t.$implicit;u.xp6(4),u.Oqu(e.name),u.xp6(3),u.Q6J("label",e.label)}}function be(e,t){if(1&e&&(u.TgZ(0,"tbody"),u.YNc(1,fe,8,2,"tr",16),u.qZA()),2&e){const e=t.$implicit,s=u.oxw();u.ekj("slds-hide",s.isLoadingModuleFields||s.activeModule!=e.templateObjectName),u.xp6(1),u.Q6J("ngForOf",s.getFilteredFields(s.moduleFields[e.name]))("ngForTrackBy",s.trackByFn)}}function _e(e,t){1&e&&u._UZ(0,"tbody",72),2&e&&u.Q6J("columns",2)("rows",5)}function Te(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"tr")(1,"td")(2,"div",30)(3,"a",70),u.NdJ("click",(function(){const t=u.CHM(e).$implicit,s=u.oxw();return u.KtG(s.functionSelected(t))})),u._uU(4),u.qZA()()()()}if(2&e){const e=t.$implicit;u.xp6(4),u.Oqu(e.name)}}function Ze(e,t){1&e&&(u.TgZ(0,"abbr",83),u._uU(1,"* "),u.qZA())}function xe(e,t){if(1&e&&u._UZ(0,"system-tooltip",84),2&e){const e=u.oxw().$implicit;u.Q6J("tooltiptext",e.help)}}function ve(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"input",85),u.NdJ("ngModelChange",(function(t){u.CHM(e);const s=u.oxw().$implicit;return u.KtG(s.value=t)})),u.qZA()}if(2&e){const e=u.oxw().$implicit;u.Q6J("ngModel",e.value)}}function Oe(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"input",88),u.NdJ("ngModelChange",(function(t){u.CHM(e);const s=u.oxw(2).$implicit;return u.KtG(s.value=t)})),u.qZA()}if(2&e){const e=u.oxw(2).$implicit;u.Q6J("ngModel",e.value)}}function ye(e,t){if(1&e&&(u.TgZ(0,"option",18),u._uU(1),u.qZA()),2&e){const e=t.$implicit;u.Q6J("value",e.key),u.xp6(1),u.Oqu(e.value)}}function Me(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"select",89),u.NdJ("ngModelChange",(function(t){u.CHM(e);const s=u.oxw(2).$implicit;return u.KtG(s.value=t)})),u.TgZ(1,"option",90),u._uU(2,"Select…"),u.qZA(),u.YNc(3,ye,2,2,"option",91),u.ALo(4,"keyvalue"),u.qZA()}if(2&e){const e=u.oxw(2).$implicit;u.Q6J("ngModel",e.value),u.xp6(3),u.Q6J("ngForOf",u.lcZ(4,2,e.options))}}function Fe(e,t){if(1&e&&(u.ynx(0),u.YNc(1,Oe,1,1,"input",86),u.YNc(2,Me,5,4,"select",87),u.BQk()),2&e){const e=u.oxw().$implicit;u.xp6(1),u.Q6J("ngIf",!e.options),u.xp6(1),u.Q6J("ngIf",e.options)}}function Le(e,t){if(1&e&&(u.TgZ(0,"span",92),u._uU(1),u.qZA()),2&e){const e=u.oxw().$implicit;u.xp6(1),u.Oqu(e.unit)}}const we=function(e){return{"slds-p-left--x-small":e}},Ae=function(e){return{"slds-input-has-fixed-addon":e}};function Je(e,t){if(1&e&&(u.ynx(0),u.TgZ(1,"div",74)(2,"label",75),u.YNc(3,Ze,2,0,"abbr",76),u._UZ(4,"system-label",71),u.YNc(5,xe,1,1,"system-tooltip",77),u.qZA(),u.TgZ(6,"div",78),u.ynx(7,79),u.YNc(8,ve,1,1,"input",80),u.YNc(9,Fe,3,2,"ng-container",81),u.YNc(10,Le,2,1,"span",82),u.BQk(),u.qZA()(),u.BQk()),2&e){const e=t.$implicit,s=t.first;u.xp6(1),u.Q6J("ngClass",u.VKq(8,we,!s)),u.xp6(2),u.Q6J("ngIf",e.required),u.xp6(1),u.Q6J("label",e.label),u.xp6(1),u.Q6J("ngIf",e.help),u.xp6(1),u.Q6J("ngClass",u.VKq(10,Ae,!!e.unit)),u.xp6(1),u.Q6J("ngSwitch",e.type),u.xp6(1),u.Q6J("ngSwitchCase","color"),u.xp6(2),u.Q6J("ngIf",e.unit)}}function Ce(e,t){if(1&e&&(u.TgZ(0,"div",73),u.YNc(1,Je,11,12,"ng-container",48),u.qZA()),2&e){const e=u.oxw();u.xp6(1),u.Q6J("ngForOf",e.actualFunctionParams)}}let Ne=(()=>{class OutputTemplatesVariableHelper{constructor(e,t,s,l,i){this.language=e,this.metadata=t,this.backend=s,this.cdr=l,this.model=i,this.response=new u.vpe,this.offeredModules=[],this.moduleFields=[],this.fieldFilter="",this.isLoadingModuleFields=!1,this.isLoadingFunctions=!1,this.modulePathFromTree="",this.functionResult="",this.fieldResult="",this.functionHistory=[],this.hasTemplate=!1,this.actualFunctionParams=[]}ngOnInit(){if(this.offeredModules=[{name:"Users",templateObjectName:"current_user",displayName:this.language.getLabel("LBL_CURRENT_USER")}],"CampaignTasks"===this.model?.module){let e={};if(this.metadata.fieldDefs.ProspectLists){let t=this.metadata.fieldDefs.ProspectLists;Object.keys(t).forEach((s=>{if("link"===t[s].type){let l=(t[s].module?t[s].module:t[s].name).toLowerCase();for(let t in this.metadata.fieldDefs)t.toLowerCase()==l&&!0==!e[t]&&(this.offeredModules.push({name:t,templateObjectName:"bean."+t,displayName:this.language.getLabel(this.metadata.getModuleDefs(t).module_label)}),e[t]=!0)}}))}}"OutputTemplates"!==this.model?.module&&"EmailTemplates"!==this.model?.module||(this.hasTemplate=!0,this.templateModel=this.model,this.offeredModules.push({name:this.templateModel.module,templateObjectName:"template",displayName:this.language.getLabel("LBL_TEMPLATE")}),this.templateModel.getFieldValue("module_name")&&this.offeredModules.push({name:this.templateModel.getFieldValue("module_name"),templateObjectName:"bean."+this.templateModel.getFieldValue("module_name"),displayName:this.language.getModuleName(this.templateModel.getFieldValue("module_name"),!0)}),this.templateModel.getFieldValue("for_bean")&&this.offeredModules.push({name:this.templateModel.getFieldValue("for_bean"),templateObjectName:"bean."+this.templateModel.getFieldValue("for_bean"),displayName:this.language.getModuleName(this.templateModel.getFieldValue("for_bean"),!0)})),this.language.sortObjects(this.offeredModules,"displayName"),this.loadFunctions()}loadFunctions(){this.isLoadingFunctions=!0,this.backend.getRequest("module/OutputTemplates/templateFunctions").pipe((0,te.q)(1)).subscribe((e=>{this.allFunctions=e,this.language.sortObjects(this.allFunctions.pipe,"name"),this.language.sortObjects(this.allFunctions.noPipe,"name"),this.isLoadingFunctions=!1,this.buildOfferedFunctions()}))}buildOfferedFunctions(){this.fieldResult||this.functionResult?this.offeredFunctions=this.allFunctions.pipe:this.offeredFunctions=this.allFunctions.noPipe}close(){this.self.destroy()}cancel(){this.close()}onModalEscX(){this.cancel()}submit(){let e;this.fieldResult||this.functionResultWithParams||(e=""),!this.fieldResult&&this.functionResultWithParams?e="func."+this.functionResultWithParams:(e=this.fieldResult,this.functionResultWithParams&&(e+="|"+this.functionResultWithParams)),this.response.emit(e),this.close()}getModuleFields(e,t){this.moduleFields[t]=[],this.isLoadingModuleFields=!0,this.cdr.detectChanges(),this.backend.getRequest("dictionary/browser/"+e+"/fields").pipe((0,te.q)(1)).subscribe((e=>{this.moduleFields[t]=e.filter((e=>"relate"!=e.type&&"non-db"!=e.source)),this.isLoadingModuleFields=!1}))}getFilteredFields(e){return this.fieldFilter?e.filter((e=>e.name.toLowerCase().includes(this.fieldFilter.toLowerCase())||e.label&&this.language.getLabel(e.label).toLowerCase().includes(this.fieldFilter.toLowerCase()))):e}trackByFn(e,t){return e}setActiveModuleTab(e){this.activeModule=e}treeItemSelected(e,t){this.modulePathFromTree=e.path,this.getModuleFields(e.module,t)}functionUndo(){if(this.functionHistory.length){let e=this.functionHistory.pop();this.functionResult=e.result,this.actualFunctionParams=e.params,this.buildOfferedFunctions()}}isTypeString(e){switch(e){case"string":case"color":return!0}return!1}get functionResultWithParams(){let e=this.functionResult;return this.actualFunctionParams.forEach((t=>{e+=":","color"===t.type&&"#000000"===t.value||void 0===t.value||""===t.value||(e+=this.isTypeString(t.type)?"'"+t.value+"'":t.value)})),e=e.replace(/:+$/g,""),e}functionSelected(e){this.functionHistory.push({result:this.functionResult,params:this.actualFunctionParams}),this.functionResult=this.functionResultWithParams,this.functionResult&&(this.functionResult+="|"),this.functionResult+=e.name,this.actualFunctionParams=e.paramConfigs?JSON.parse(JSON.stringify(e.paramConfigs)):[],this.buildOfferedFunctions()}fieldSelected(e){let t=this.modulePathFromTree.split(/::/),s=[];for(let e=1;e<t.length;e++)s.push(t[e].split(":").pop());let l=s.join(".");if(l&&(l+="."),-1!==this.activeModule.indexOf("bean.",0))this.fieldResult="bean."+l+e;else switch(this.activeModule){case"current_user":this.fieldResult="current_user."+l+e;break;case"template":this.fieldResult="template."+l+e}this.buildOfferedFunctions()}clearFieldResult(){this.fieldResult="",this.buildOfferedFunctions()}}return OutputTemplatesVariableHelper.ɵfac=function(e){return new(e||OutputTemplatesVariableHelper)(u.Y36(r.d),u.Y36(p.Pu),u.Y36(_.y),u.Y36(u.sBO),u.Y36(m.o,8))},OutputTemplatesVariableHelper.ɵcmp=u.Xpm({type:OutputTemplatesVariableHelper,selectors:[["ng-component"]],outputs:{response:"response"},decls:79,vars:19,consts:[["size","large"],[3,"close"],["label","LBL_TEMPLATE_VARIABLE_HELPER"],["margin","none","system-modal-content-grow",""],[1,"slds-grid","slds-grid--vertical",2,"height","100%"],[1,"slds-grid","slds-grow",2,"height","0"],[1,"slds-size--3-of-5","slds-border--right","slds-grid","slds-grid--vertical",2,"height","100%"],[1,"slds-grid","slds-grid--vertical","slds-grow",2,"height","0"],[1,"slds-border--bottom","slds-grid","slds-grid--vertical",2,"height","50%"],[1,"slds-form-element","slds-m-around--small",2,"margin-top","0"],[1,"slds-form-element__label"],[1,"slds-form-element__control"],[1,"slds-select_container"],["id","templateVarHelperSource",1,"slds-select",3,"ngModel","ngModelChange"],["hidden","","selected",""],["label","LBL_SELECT"],[4,"ngFor","ngForOf","ngForTrackBy"],["style","font-size:1px;background-color:#ccc","disabled","",4,"ngIf"],[3,"value"],["label","LBL_CURRENT_USER"],[4,"ngIf"],[1,"slds-grid","slds-grid--vertical","slds-grow",2,"x-height","100"],["class","slds-grow","style","height:0",4,"ngIf"],[1,"slds-grid","slds-grid--vertical",2,"height","50%"],["role","none",1,"slds-input-has-icon","slds-input-has-icon_left","slds-m-around--x-small"],["icon","search","addclasses","slds-input__icon slds-input__icon--left"],["type","search",1,"slds-input",3,"placeholder","ngModel","ngModelChange"],[1,"slds-grow","slds-scrollable--y","slds-m-bottom--x-small"],[1,"slds-table","slds-table_cell-buffer","slds-table_bordered","slds-table--header-fixed",2,"border-top","none"],["scope","col",2,"min-width","20rem"],[1,"slds-truncate"],["label","LBL_FIELD"],["scope","col",1,"slds-p-horizontal--x-small",2,"width","100%"],[1,"slds-truncate","slds-p-left--x-small"],["label","LBL_NAME"],[3,"slds-hide",4,"ngFor","ngForOf","ngForTrackBy"],["system-table-stencils","",3,"columns","rows",4,"ngIf"],[1,"slds-p-horizontal--medium","slds-p-bottom--medium","slds-p-top--xx-small","slds-border--top","slds-grid","slds-grid--vertical-align-end"],[1,"slds-form-element","slds-col--bump-right","slds-grow","slds-m-right--small"],["type","text","disabled","",1,"slds-input",3,"ngModel","ngModelChange"],[1,"slds-button","slds-button--icon","slds-button_icon-border",3,"disabled","click"],["icon","clear","size","medium"],[1,"slds-assistive-text"],["label","LBL_UNDO"],[1,"slds-size--2-of-5","slds-grid","slds-grid--vertical","slds-p-top--x-small",2,"height","100%"],[1,"slds-line-height_reset"],["scope","col"],["label","LBL_APPLICABLE_FUNCTIONS"],[4,"ngFor","ngForOf"],[1,"slds-border--top","slds-grid","slds-grid--vertical-align-end","slds-p-horizontal--medium","slds-p-bottom--medium","slds-p-top--xx-small"],[1,"slds-grow","slds-p-right--small"],["class","slds-grid slds-p-top--xx-small",4,"ngIf"],[1,"slds-form-element"],["label","LBL_FUNCTION"],["label","LBL_FUNCTION_CHAIN"],[1,"slds-form-element__control","slds-grow"],["type","text","disabled","",1,"slds-input",3,"ngModel"],["icon","undo",3,"size"],[1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_CANCEL"],[1,"slds-button","slds-button--brand",3,"click"],["label","LBL_OK"],[3,"value",4,"ngIf"],["disabled","",2,"font-size","1px","background-color","#ccc"],[2,"border-top","1px solid #333333",3,"value"],["label","LBL_TEMPLATE"],[1,"slds-grow",2,"height","0"],["class","slds-scrollable--y","style","height: 100%",3,"slds-hide",4,"ngFor","ngForOf","ngForTrackBy"],[1,"slds-scrollable--y",2,"height","100%"],[3,"module","itemSelected"],["href","javascript:void(0)",3,"click"],[3,"label"],["system-table-stencils","",3,"columns","rows"],[1,"slds-grid","slds-p-top--xx-small"],[1,"slds-form-element","slds-grow",3,"ngClass"],[1,"slds-form-element__label","slds-grid","slds-grid--vertical-align-center"],["class","slds-required","title","required",4,"ngIf"],["class","slds-m-left--x-small",3,"tooltiptext",4,"ngIf"],[1,"slds-form-element__control","slds-grow",3,"ngClass"],[3,"ngSwitch"],["type","color","class","slds-input","style","width:3.5rem;padding-left:2px;padding-right:2px",3,"ngModel","ngModelChange",4,"ngSwitchCase"],[4,"ngSwitchDefault"],["class","slds-form-element__addon",4,"ngIf"],["title","required",1,"slds-required"],[1,"slds-m-left--x-small",3,"tooltiptext"],["type","color",1,"slds-input",2,"width","3.5rem","padding-left","2px","padding-right","2px",3,"ngModel","ngModelChange"],["type","text","class","slds-input",3,"ngModel","ngModelChange",4,"ngIf"],["class","slds-select",3,"ngModel","ngModelChange",4,"ngIf"],["type","text",1,"slds-input",3,"ngModel","ngModelChange"],[1,"slds-select",3,"ngModel","ngModelChange"],["selected","","value",""],[3,"value",4,"ngFor","ngForOf"],[1,"slds-form-element__addon"]],template:function(e,t){1&e&&(u.TgZ(0,"system-modal",0)(1,"system-modal-header",1),u.NdJ("close",(function(){return t.cancel()})),u._UZ(2,"system-label",2),u.qZA(),u.TgZ(3,"system-modal-content",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9)(10,"label",10),u._uU(11,"Variable Source"),u.qZA(),u.TgZ(12,"div",11)(13,"div",12)(14,"select",13),u.NdJ("ngModelChange",(function(e){return t.activeModule=e})),u.TgZ(15,"option",14),u._UZ(16,"system-label",15),u.qZA(),u.YNc(17,re,2,1,"ng-container",16),u.YNc(18,pe,2,0,"option",17),u.TgZ(19,"option",18),u._UZ(20,"system-label",19),u.qZA(),u.YNc(21,me,5,1,"ng-container",20),u.qZA()()()(),u.TgZ(22,"div",21),u.YNc(23,he,2,2,"div",22),u.qZA()(),u.TgZ(24,"div",23)(25,"div",24),u._UZ(26,"system-utility-icon",25),u.TgZ(27,"input",26),u.NdJ("ngModelChange",(function(e){return t.fieldFilter=e})),u.qZA()(),u.TgZ(28,"div",27)(29,"table",28)(30,"thead")(31,"tr")(32,"th",29)(33,"div",30),u._UZ(34,"system-label",31),u.qZA()(),u.TgZ(35,"th",32)(36,"div",33),u._UZ(37,"system-label",34),u.qZA()()()(),u.YNc(38,be,2,4,"tbody",35),u.YNc(39,_e,1,2,"tbody",36),u.qZA()()()(),u.TgZ(40,"div",37)(41,"div",38)(42,"label",10),u._UZ(43,"system-label",31),u.qZA(),u.TgZ(44,"div",11)(45,"input",39),u.NdJ("ngModelChange",(function(e){return t.fieldResult=e})),u.qZA()()(),u.TgZ(46,"button",40),u.NdJ("click",(function(){return t.clearFieldResult()})),u._UZ(47,"system-button-icon",41),u.TgZ(48,"span",42),u._UZ(49,"system-label",43),u.qZA()()()(),u.TgZ(50,"div",44)(51,"div",27)(52,"table",28)(53,"thead")(54,"tr",45)(55,"th",46)(56,"div",30),u._UZ(57,"system-label",47),u.qZA()()()(),u.TgZ(58,"tbody"),u.YNc(59,Te,5,1,"tr",48),u.qZA()()(),u.TgZ(60,"div",49)(61,"div",50),u.YNc(62,Ce,2,1,"div",51),u.TgZ(63,"div",52)(64,"label",10),u._UZ(65,"system-label",53),u._uU(66," / "),u._UZ(67,"system-label",54),u.qZA(),u.TgZ(68,"div",55),u._UZ(69,"input",56),u.qZA()()(),u.TgZ(70,"button",40),u.NdJ("click",(function(){return t.functionUndo()})),u._UZ(71,"system-button-icon",57),u.TgZ(72,"span",42),u._UZ(73,"system-label",43),u.qZA()()()()()()(),u.TgZ(74,"system-modal-footer")(75,"button",58),u.NdJ("click",(function(){return t.cancel()})),u._UZ(76,"system-label",59),u.qZA(),u.TgZ(77,"button",60),u.NdJ("click",(function(){return t.submit()})),u._UZ(78,"system-label",61),u.qZA()()()),2&e&&(u.xp6(14),u.Q6J("ngModel",t.activeModule),u.xp6(3),u.Q6J("ngForOf",t.offeredModules)("ngForTrackBy",t.trackByFn),u.xp6(1),u.Q6J("ngIf",t.offeredModules.length),u.xp6(1),u.Q6J("value","current_user"),u.xp6(2),u.Q6J("ngIf",t.hasTemplate),u.xp6(2),u.Q6J("ngIf",!!t.activeModule),u.xp6(4),u.Q6J("placeholder",t.language.getLabel("LBL_SEARCH"))("ngModel",t.fieldFilter),u.xp6(11),u.Q6J("ngForOf",t.offeredModules)("ngForTrackBy",t.trackByFn),u.xp6(1),u.Q6J("ngIf",t.isLoadingModuleFields),u.xp6(6),u.Q6J("ngModel",t.fieldResult),u.xp6(1),u.Q6J("disabled",!t.fieldResult.length),u.xp6(13),u.Q6J("ngForOf",t.offeredFunctions),u.xp6(3),u.Q6J("ngIf",t.actualFunctionParams.length),u.xp6(7),u.Q6J("ngModel",t.functionResultWithParams),u.xp6(1),u.Q6J("disabled",!t.functionHistory.length),u.xp6(1),u.Q6J("size","xx-small"))},dependencies:[l.mk,l.sg,l.O5,l.RF,l.n9,l.ED,i.YN,i.Kr,i.Fj,i.EJ,i.JJ,i.On,v.J,f._,se.j,le.x,ie.p,ne.y,oe.x,ae.S,de.r,ce.w,l.Nd],encapsulation:2}),OutputTemplatesVariableHelper})();var Be=s(3507);let qe=(()=>{class ObjectActionMarkSentBeanButton extends R{constructor(e,t,s,l,i,n,o,a){super(e,t,s,l,i,a),this.language=e,this.model=t,this.modal=s,this.backend=l,this.configuration=i,this.toast=n,this.outputModalService=o,this.viewContainerRef=a,this.actionemitter=new u.vpe}execute(){if(!this.outputModalService.selectedTemplate)return;const e=this.outputModalService.selectedTemplate.id;let t=this.model.utils.spiceModel2backend("Letters",this.model.data);this.backend.postRequest(`module/Letters/${this.model.id}/marksent/${e}`,null,t).subscribe((e=>{this.actionemitter.emit({close:!0,name:"marksent"}),e?.success?(this.toast.sendToast(this.language.getLabel("LETTER_MARKED_AS_SENT"),"success"),this.model.setField("letter_status","sent")):this.toast.sendToast(this.language.getLabel("ERR_FAILED_TO_EXECUTE"),"error")}))}}return ObjectActionMarkSentBeanButton.ɵfac=function(e){return new(e||ObjectActionMarkSentBeanButton)(u.Y36(r.d),u.Y36(m.o),u.Y36(T.o),u.Y36(_.y),u.Y36(E.C),u.Y36(x.A),u.Y36(Be.w),u.Y36(u.s_b))},ObjectActionMarkSentBeanButton.ɵcmp=u.Xpm({type:ObjectActionMarkSentBeanButton,selectors:[["object-action-mark-sent-bean-button"]],outputs:{actionemitter:"actionemitter"},features:[u.qOj],decls:2,vars:0,consts:[["label","LBL_MARK_SENT"]],template:function(e,t){1&e&&(u.TgZ(0,"span"),u._UZ(1,"system-label",0),u.qZA())},dependencies:[f._],encapsulation:2}),ObjectActionMarkSentBeanButton})(),ke=(()=>{class ModuleOutputTemplates{}return ModuleOutputTemplates.ɵfac=function(e){return new(e||ModuleOutputTemplates)},ModuleOutputTemplates.ɵmod=u.oAB({type:ModuleOutputTemplates}),ModuleOutputTemplates.ɵinj=u.cJS({imports:[l.ez,i.u5,o.ObjectFields,a.GlobalComponents,d.ObjectComponents,c.SystemComponents,n.o]}),ModuleOutputTemplates})();("undefined"==typeof ngJitMode||ngJitMode)&&u.kYT(ke,{declarations:[q,C,Q,R,Y.N,j.s,ee,Ne,I,qe],imports:[l.ez,i.u5,o.ObjectFields,a.GlobalComponents,d.ObjectComponents,c.SystemComponents,n.o],exports:[Y.N]})}}]);