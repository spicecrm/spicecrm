/*!
 * 
 *                     aacService
 *
 *                     release: 2022.02.001
 *
 *                     date: 2022-09-03 11:05:02
 *
 *                     build: 2022.02.001.1662195902704
 *
 */
"use strict";(self.webpackChunkcore=self.webpackChunkcore||[]).push([["src_include_spiceimporter_spiceimporter_ts"],{4877:(e,t,i)=>{i.r(t),i.d(t,{SpiceImporterModule:()=>Oe});var s=i(1481),l=i(433),o=i(5478),r=i(3283),n=i(4518),d=i(3121),p=i(4357),c=i(1571),a=i(5329);let m=(()=>{class SpiceImporterService{constructor(e){this.language=e,this.fileMapping={},this.fileId="",this.fileName="",this.fileHeader=[],this.checkFields=[],this.fixedFields=[],this.idfield="",this.importDuplicateAction="ignore",this.importAction="new",this.importTemplateAction="none",this.idFieldAction="auto",this.enclosure="none",this.separator="semicolon",this.fileTooBig=!1,this.savedImports=[],this.fileRows="",this.currentImportStep=0,this.result={},this.importStepsText=["LBL_SELECT_UPLOAD_FILE","LBL_MAP_FIELDS","LBL_ADD_FIXED_FIELDS","LBL_DUPLICATE_CHECK","LBL_RESULTS"]}get stepLongText(){return this.language.getLabel(this.importStepsText[this.currentImportStep],"","long")}get idField(){return this.idfield}set idField(e){this.fileMapping[e]&&delete this.fileMapping[e],this.idfield=e}resetSettings(){this.fileMapping={},this.fixedFields=[],this.checkFields=[],this.idField="",this.result={}}addFixed(){this.fixedFields.push({field:void 0})}getFixed(e){let t=this.fixedFields.indexOf(e);return t>-1?this.fixedFields[t].field:""}setFixedField(e,t){this.fixedFields[e].field=t}removeFixed(e){this.fixedFields.splice(e,1)}addCheck(){this.checkFields.push({field:void 0})}getCheckField(e){return this.checkFields[e]&&this.checkFields[e].field?this.checkFields[e].field:""}setCheckField(e,t){this.checkFields[e].field=t}removeCheck(e){this.checkFields.splice(e,1)}getMapping(e){return this.fileMapping&&this.fileMapping[e]?this.fileMapping[e]:""}setMapping(e,t){""!=t?this.fileMapping[e]=t:delete this.fileMapping[e]}setSavedImport(e){this.resetSettings(),this.savedImports.some((t=>{if(t.id===e){for(let e in t.mappings)t.mappings.hasOwnProperty(e)&&-1!=this.fileHeader.indexOf(e)&&(this.fileMapping[e]=t.mappings[e]);return this.fixedFields=t.fixed,this.checkFields=t.checks,!0}}))}}return SpiceImporterService.ɵfac=function(e){return new(e||SpiceImporterService)(c.LFG(a.d))},SpiceImporterService.ɵprov=c.Yz7({token:SpiceImporterService,factory:SpiceImporterService.ɵfac}),SpiceImporterService})();var u=i(4154),g=i(5710),h=i(7774),f=i(6559),I=i(3463);let b=(()=>{class SpiceImporterImportButton{constructor(e,t,i,s,l){this.language=e,this.metadata=t,this.model=i,this.router=s,this.layout=l}execute(){this.router.navigate(["/import/"+this.model.module])}get disabled(){return!this.metadata.checkModuleAcl(this.model.module,"import")||"small"==this.layout.screenwidth}}return SpiceImporterImportButton.ɵfac=function(e){return new(e||SpiceImporterImportButton)(c.Y36(a.d),c.Y36(u.Pu),c.Y36(g.o),c.Y36(h.F0),c.Y36(f.b))},SpiceImporterImportButton.ɵcmp=c.Xpm({type:SpiceImporterImportButton,selectors:[["spice-importer-import-button"]],decls:2,vars:0,consts:[["label","LBL_IMPORT"]],template:function(e,t){1&e&&(c.TgZ(0,"span"),c._UZ(1,"system-label",0),c.qZA())},dependencies:[I._],encapsulation:2}),SpiceImporterImportButton})();var Z=i(3278),x=i(4505),v=i(6895),F=i(6271),A=i(6041),S=i(4021);const T=function(){return{label:";",value:"semicolon"}},L=function(){return{label:",",value:"comma"}},M=function(e,t){return[e,t]};function q(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",32)(1,"fieldset",33)(2,"div",11)(3,"system-input-radio-button-group",34),c.NdJ("ngModelChange",(function(t){c.CHM(e);const i=c.oxw();return c.KtG(i.spiceImport.separator=t)})),c.qZA()(),c.TgZ(4,"legend",9),c._UZ(5,"system-label",35),c.qZA()(),c.TgZ(6,"fieldset",33)(7,"div",11)(8,"system-input-radio-button-group",34),c.NdJ("ngModelChange",(function(t){c.CHM(e);const i=c.oxw();return c.KtG(i.spiceImport.enclosure=t)})),c.qZA()(),c.TgZ(9,"legend",9),c._UZ(10,"system-label",36),c.qZA()()()}if(2&e){const e=c.oxw();c.xp6(3),c.Q6J("ngModel",e.spiceImport.separator)("inputOptions",c.WLB(6,M,c.DdM(4,T),c.DdM(5,L))),c.xp6(5),c.Q6J("ngModel",e.spiceImport.enclosure)("inputOptions",e.enclosureOptions)}}function y(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"span",12)(1,"input",37),c.NdJ("ngModelChange",(function(t){c.CHM(e);const i=c.oxw();return c.KtG(i.importTemplateAction=t)})),c.qZA(),c.TgZ(2,"label",38),c._UZ(3,"span",15),c.TgZ(4,"span",16),c._UZ(5,"system-label",39),c.qZA()()()}if(2&e){const e=c.oxw();c.xp6(1),c.Q6J("ngModel",e.importTemplateAction)}}function k(e,t){if(1&e&&(c.TgZ(0,"option",44),c._uU(1),c.qZA()),2&e){const e=t.$implicit;c.Q6J("value",e.id),c.xp6(1),c.hij(" ",e.name," ")}}function w(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",4)(1,"label",16),c._uU(2),c.qZA(),c.TgZ(3,"div",11)(4,"div",40)(5,"select",41),c.NdJ("change",(function(t){c.CHM(e);const i=c.oxw();return c.KtG(i.setSavedImport(t))})),c._UZ(6,"option",42),c.YNc(7,k,2,2,"option",43),c.qZA()()()()}if(2&e){const e=c.oxw();c.xp6(2),c.Oqu(e.language.getLabel("LBL_SELECT_TEMPLATE","","short")),c.xp6(5),c.Q6J("ngForOf",e.spiceImport.savedImports)}}function U(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",4)(1,"div",33)(2,"label",16),c._UZ(3,"system-label",45),c.qZA(),c.TgZ(4,"div",11)(5,"input",46),c.NdJ("ngModelChange",(function(t){c.CHM(e);const i=c.oxw();return c.KtG(i.templateName=t)})),c.qZA()()()()}if(2&e){const e=c.oxw();c.xp6(5),c.Q6J("ngModel",e.templateName)}}function C(e,t){if(1&e&&(c.TgZ(0,"td")(1,"div",56),c._uU(2),c.qZA()()),2&e){const e=t.$implicit,i=c.oxw().index;c.xp6(2),c.Oqu(e[i])}}function J(e,t){if(1&e&&(c.TgZ(0,"tr")(1,"td",55)(2,"div",56),c._uU(3),c.qZA()(),c.YNc(4,C,3,1,"td",54),c.qZA()),2&e){const e=t.$implicit,i=c.oxw(2);c.xp6(3),c.Oqu(e),c.xp6(1),c.Q6J("ngForOf",i.spiceImport.fileData)}}function E(e,t){if(1&e&&(c.TgZ(0,"table",47)(1,"thead")(2,"tr",48)(3,"th",49)(4,"div",50),c._UZ(5,"system-label",51),c.qZA()(),c.TgZ(6,"th",52)(7,"div",50),c._UZ(8,"system-label",53),c._uU(9),c.qZA()()()(),c.TgZ(10,"tbody"),c.YNc(11,J,5,2,"tr",54),c.qZA()()),2&e){const e=c.oxw();c.xp6(9),c.hij(" (",e.spiceImport.fileRows,") "),c.xp6(2),c.Q6J("ngForOf",e.spiceImport.fileHeader)}}let N=(()=>{class SpiceImporterSelect{constructor(e,t,i,s){this.spiceImport=e,this.toast=t,this.backend=i,this.language=s,this.templateNameSet=new c.vpe,this.importActionSet=new c.vpe,this.isLoading=!1,this.file=null,this.enclosureOptions=[{label:"'",value:"single"},{label:" ",value:"none"},{label:'"',value:"double"}]}get templateName(){return this.spiceImport.templateName}set templateName(e){this.spiceImport.templateName=e,this.templateNameSet.emit(e)}get importAction(){return this.spiceImport.importAction}set importAction(e){this.spiceImport.importAction=e,this.importActionSet.emit(e),this.spiceImport.idField="",this.templateName=void 0,this.resetOptions(),this.spiceImport.resetSettings()}get importTemplateAction(){return this.spiceImport.importTemplateAction}set importTemplateAction(e){this.spiceImport.importTemplateAction=e,"choose"!=e&&this.spiceImport.resetSettings()}resetOptions(){this.spiceImport.importDuplicateAction="ignore",this.spiceImport.importTemplateAction="none",this.spiceImport.idFieldAction="auto"}setSavedImport(e){this.spiceImport.setSavedImport(e.target.value)}clearFile(){this.spiceImport.fileName="",this.spiceImport.fileId="",this.spiceImport.fileHeader=[],this.spiceImport.fileData=void 0,this.spiceImport.fileRows="",this.spiceImport.fileTooBig=!1,this.spiceImport.resetSettings()}loadFilePreview(e){let t=e.file_name.toLowerCase();if(this.file=e,!t.endsWith(".csv"))return this.toast.sendToast(this.language.getLabel("MSG_ONLY_CSV_ALLOWED"),"error"),e.remove();this.isLoading=!0,this.spiceImport.fileName=e.file_name,this.spiceImport.fileId=e.file_md5;const i={file_md5:e.file_md5,enclosure:this.spiceImport.enclosure,separator:this.spiceImport.separator};this.backend.getRequest("module/SpiceImports/filepreview",i).subscribe((e=>{this.isLoading=!1,this.spiceImport.fileHeader=e.fileHeader,this.spiceImport.fileData=e.fileData,this.spiceImport.fileRows=e.fileRows,this.spiceImport.fileTooBig=e.fileTooBig,e.fileTooBig&&this.toast.sendToast(this.language.getLabel("MSG_FILE_ROWS_TOO_LARGE"),"warning","",!1)}),(()=>{this.isLoading=!1,this.toast.sendToast(this.language.getLabel("ERR_CANT_READ_FILE_DATA"),"error","",!1),e.remove()}))}}return SpiceImporterSelect.ɵfac=function(e){return new(e||SpiceImporterSelect)(c.Y36(m),c.Y36(Z.A),c.Y36(x.y),c.Y36(a.d))},SpiceImporterSelect.ɵcmp=c.Xpm({type:SpiceImporterSelect,selectors:[["spice-importer-select"]],outputs:{templateNameSet:"templateNameSet",importActionSet:"importActionSet"},decls:47,vars:13,consts:[[1,"slds-grid","slds-wrap","slds-height_full"],[1,"slds-p-horizontal--small","slds-size--1-of-4","slds-border--right","slds-height_full"],[1,"slds-text-body--regular","slds-box","slds-m-top--small","slds-text-color--weak",2,"padding",".25rem"],[1,"slds-form","slds-size--1-of-1"],[1,"slds-form-element","slds-m-vertical--medium"],[1,"slds-form-element__control","slds-grid"],[1,"slds-grow",2,"min-width","0"],["accept",".csv",1,"slds-size--1-of-1",3,"ngModel","ngModelChange","onRemove"],["class","slds-grid slds-m-around--x-small",4,"ngIf"],[1,"slds-form-element__legend","slds-form-element__label"],["label","LBL_IMPORT_ACTION"],[1,"slds-form-element__control"],[1,"slds-radio"],["type","radio","id","importactionnew","name","options","value","new",3,"ngModel","ngModelChange"],["for","importactionnew",1,"slds-radio__label"],[1,"slds-radio--faux"],[1,"slds-form-element__label"],["label","LBL_LOAD_NEW_RECORDS"],["type","radio","id","importactionupdate","name","options","value","update",3,"ngModel","ngModelChange"],["for","importactionupdate",1,"slds-radio__label"],["label","LBL_UPDATE_EXISTING_RECORDS"],[1,"slds-form-element","slds-m-vertical--medium",3,"hidden"],["label","LBL_IMPORT_TEMPLATE"],["type","radio","id","importtemplatenone","value","none","name","template",3,"ngModel","ngModelChange"],["for","importtemplatenone",1,"slds-radio__label"],["class","slds-radio",4,"ngIf"],["type","radio","id","importtemplatesave","value","new","name","template",3,"ngModel","ngModelChange"],["for","importtemplatesave",1,"slds-radio__label"],["label","LBL_SAVE_AS"],["class","slds-form-element slds-m-vertical--medium",4,"ngIf"],[1,"slds-size--3-of-4","slds-height_full",3,"system-overlay-loading-spinner"],["class","slds-table slds-table--bordered slds-table--cell-buffer",4,"ngIf"],[1,"slds-grid","slds-m-around--x-small"],[1,"slds-form-element"],[3,"ngModel","inputOptions","ngModelChange"],["label","LBL_SEPARATOR"],["label","LBL_ENCLOSURE"],["type","radio","id","importtemplatechoose","value","choose","name","template",3,"ngModel","ngModelChange"],["for","importtemplatechoose",1,"slds-radio__label"],["label","LBL_SELECT"],[1,"slds-select_container"],[1,"slds-select",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["label","LBL_TEMPLATE_NAME"],["type","text",1,"slds-input",3,"ngModel","ngModelChange"],[1,"slds-table","slds-table--bordered","slds-table--cell-buffer"],[1,"slds-text-title--caps","slds-p-vertical--small"],["scope","col"],[1,"slds-truncate","slds-p-vertical--xx-small",2,"font-weight","600"],["label","LBL_HEADER"],["colspan","2","scope","col"],["label","LBL_RECORDS"],[4,"ngFor","ngForOf"],["scope","row"],[1,"slds-truncate"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0)(1,"div",1)(2,"div",2),c._uU(3),c.qZA(),c.TgZ(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6)(8,"system-input-file",7),c.NdJ("ngModelChange",(function(e){return t.loadFilePreview(e)}))("onRemove",(function(){return t.clearFile()})),c.qZA()(),c.YNc(9,q,11,9,"div",8),c.qZA()(),c.TgZ(10,"div",4)(11,"legend",9),c._UZ(12,"system-label",10),c.qZA(),c.TgZ(13,"div",11)(14,"span",12)(15,"input",13),c.NdJ("ngModelChange",(function(e){return t.importAction=e})),c.qZA(),c.TgZ(16,"label",14),c._UZ(17,"span",15),c.TgZ(18,"span",16),c._UZ(19,"system-label",17),c.qZA()()(),c.TgZ(20,"span",12)(21,"input",18),c.NdJ("ngModelChange",(function(e){return t.importAction=e})),c.qZA(),c.TgZ(22,"label",19),c._UZ(23,"span",15),c.TgZ(24,"span",16),c._UZ(25,"system-label",20),c.qZA()()()()(),c.TgZ(26,"div",21)(27,"legend",9),c._UZ(28,"system-label",22),c.qZA(),c.TgZ(29,"div",11)(30,"span",12)(31,"input",23),c.NdJ("ngModelChange",(function(e){return t.importTemplateAction=e})),c.qZA(),c.TgZ(32,"label",24),c._UZ(33,"span",15),c.TgZ(34,"span",16),c._uU(35,"none"),c.qZA()()(),c.YNc(36,y,6,1,"span",25),c.TgZ(37,"span",12)(38,"input",26),c.NdJ("ngModelChange",(function(e){return t.importTemplateAction=e})),c.qZA(),c.TgZ(39,"label",27),c._UZ(40,"span",15),c.TgZ(41,"span",16),c._UZ(42,"system-label",28),c.qZA()()()()(),c.YNc(43,w,8,2,"div",29),c.YNc(44,U,6,1,"div",29),c.qZA()(),c.TgZ(45,"div",30),c.YNc(46,E,12,2,"table",31),c.qZA()()),2&e&&(c.xp6(3),c.hij(" ",t.spiceImport.stepLongText," "),c.xp6(5),c.Q6J("ngModel",t.file),c.xp6(1),c.Q6J("ngIf",!t.spiceImport.fileData),c.xp6(6),c.Q6J("ngModel",t.importAction),c.xp6(6),c.Q6J("ngModel",t.importAction),c.xp6(5),c.Q6J("hidden",!t.spiceImport.fileId),c.xp6(5),c.Q6J("ngModel",t.importTemplateAction),c.xp6(5),c.Q6J("ngIf",(null==t.spiceImport.savedImports?null:t.spiceImport.savedImports.length)>0),c.xp6(2),c.Q6J("ngModel",t.importTemplateAction),c.xp6(5),c.Q6J("ngIf","choose"==t.importTemplateAction&&t.spiceImport.fileId),c.xp6(1),c.Q6J("ngIf","new"==t.importTemplateAction),c.xp6(1),c.Q6J("system-overlay-loading-spinner",t.isLoading),c.xp6(1),c.Q6J("ngIf",t.spiceImport.fileHeader.length>0))},dependencies:[v.sg,v.O5,l.YN,l.Kr,l.Fj,l._,l.JJ,l.On,F.p,I._,A.K,S._],encapsulation:2}),SpiceImporterSelect})();var O=i(2656);const Q=function(e,t){return{"slds-text-color_success":e,"slds-text-color--error":t}};function B(e,t){if(1&e&&(c.TgZ(0,"div",24)(1,"span",25),c._uU(2),c.qZA(),c.TgZ(3,"span",26),c._UZ(4,"system-button-icon",27),c.qZA()()),2&e){const e=t.$implicit,i=c.oxw(2);c.xp6(2),c.hij(" ",e.displayname," "),c.xp6(2),c.Q6J("ngClass",c.WLB(3,Q,i.checkRequired(e.name),!i.checkRequired(e.name)))("icon",i.checkRequired(e.name)?"success":"record")}}function Y(e,t){if(1&e&&(c.TgZ(0,"div")(1,"legend",6),c._UZ(2,"system-label",21),c.qZA(),c.TgZ(3,"div",22),c.YNc(4,B,5,6,"div",23),c.qZA()()),2&e){const e=c.oxw();c.xp6(4),c.Q6J("ngForOf",e.requiredModelFields)("ngForTrackBy",e.trackByFn)}}function R(e,t){if(1&e&&(c.TgZ(0,"option",35),c._uU(1),c.qZA()),2&e){const e=t.$implicit;c.Q6J("value",e),c.xp6(1),c.Oqu(e)}}function D(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",28)(1,"label",29),c._UZ(2,"system-label",30),c.qZA(),c.TgZ(3,"div",8)(4,"div",31)(5,"select",32),c.NdJ("ngModelChange",(function(t){c.CHM(e);const i=c.oxw();return c.KtG(i.spiceImport.idField=t)})),c._UZ(6,"option",33),c.YNc(7,R,2,2,"option",34),c.qZA()()()()}if(2&e){const e=c.oxw();c.xp6(5),c.Q6J("ngModel",e.spiceImport.idField),c.xp6(2),c.Q6J("ngForOf",e.spiceImport.fileHeader)("ngForTrackBy",e.trackByFn)}}function P(e,t){1&e&&c._UZ(0,"system-button-icon",51),2&e&&c.Q6J("icon","lock")}function G(e,t){if(1&e&&(c.ynx(0),c.TgZ(1,"option",52),c._uU(2),c.qZA(),c.BQk()),2&e){const e=t.$implicit,i=c.oxw(3);c.xp6(1),c.Q6J("disabled",i.isChosen(e.name))("value",e.name),c.xp6(1),c.hij(" ",e.displayname," ")}}function H(e,t){if(1&e&&(c.TgZ(0,"td")(1,"div",25),c._uU(2),c.qZA()()),2&e){const e=t.$implicit,i=c.oxw().index;c.xp6(2),c.Oqu(e[i])}}function j(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"tr")(1,"td",46)(2,"div",47),c.YNc(3,P,1,1,"system-button-icon",48),c.qZA()(),c.TgZ(4,"td",49)(5,"div",25),c._uU(6),c.qZA()(),c.TgZ(7,"td")(8,"div",25)(9,"div",8)(10,"div",31)(11,"select",50),c.NdJ("change",(function(t){const i=c.CHM(e).$implicit,s=c.oxw(2);return c.KtG(s.setMapping(i,t))})),c._UZ(12,"option",33),c.YNc(13,G,3,3,"ng-container",45),c.qZA()()()()(),c.YNc(14,H,3,1,"td",45),c.qZA()}if(2&e){const e=t.$implicit,i=c.oxw(2);c.xp6(3),c.Q6J("ngIf",i.spiceImport.idField==e),c.xp6(3),c.Oqu(e),c.xp6(5),c.Q6J("disabled",i.spiceImport.idField==e)("value",i.spiceImport.idField==e?"":i.getMapping(e)),c.xp6(2),c.Q6J("ngForOf",i.modelFields)("ngForTrackBy",i.trackByFn),c.xp6(1),c.Q6J("ngForOf",i.spiceImport.fileData)("ngForTrackBy",i.trackByFn)}}function z(e,t){if(1&e&&(c.TgZ(0,"table",36)(1,"thead")(2,"tr",37)(3,"th",38)(4,"div",39),c._UZ(5,"system-label",40),c.qZA()(),c.TgZ(6,"th",41)(7,"div",39),c._uU(8),c._UZ(9,"system-label",42),c.qZA()(),c.TgZ(10,"th",43)(11,"div",39),c._UZ(12,"system-label",44),c._uU(13),c.qZA()()()(),c.TgZ(14,"tbody"),c.YNc(15,j,15,8,"tr",45),c.qZA()()),2&e){const e=c.oxw();c.xp6(8),c.hij("",e.model.module," "),c.xp6(5),c.hij(" (",e.spiceImport.fileRows,") "),c.xp6(2),c.Q6J("ngForOf",e.spiceImport.fileHeader)("ngForTrackBy",e.trackByFn)}}let K=(()=>{class SpiceImporterMap{constructor(e,t,i,s){this.spiceImport=e,this.language=t,this.metadata=i,this.model=s,this.modelFields=void 0,this.requiredModelFields=void 0}get idFieldAction(){return this.spiceImport.idFieldAction}set idFieldAction(e){this.spiceImport.idFieldAction=e,"auto"==e&&(this.spiceImport.idField="")}get description(){return this.spiceImport.stepLongText}getMapping(e){return this.spiceImport.getMapping(e)}setMapping(e,t){this.spiceImport.setMapping(e,t.target.value)}checkRequired(e){let t=_.invert(this.spiceImport.fileMapping).hasOwnProperty(e),i=this.spiceImport.fixedFields.some((t=>t.field==e));return t||i}isChosen(e){return!!_.invert(this.spiceImport.fileMapping)[e]}trackByFn(e,t){return e}}return SpiceImporterMap.ɵfac=function(e){return new(e||SpiceImporterMap)(c.Y36(m),c.Y36(a.d),c.Y36(u.Pu),c.Y36(g.o))},SpiceImporterMap.ɵcmp=c.Xpm({type:SpiceImporterMap,selectors:[["spice-importer-map"]],inputs:{modelFields:["modelfields","modelFields"],requiredModelFields:["requiredmodelfields","requiredModelFields"]},decls:25,vars:6,consts:[[1,"slds-grid","slds-wrap","slds-height_full"],[1,"slds-p-horizontal--small","slds-size--1-of-4","slds-border--right","slds-height_full"],[1,"slds-text-body--regular","slds-box","slds-m-vertical--small","slds-text-color--weak",2,"padding",".25rem"],[4,"ngIf"],[1,"slds-m-vertical--x-small"],[1,"slds-form-element","slds-m-top--small"],[1,"slds-form-element__legend","slds-form-element__label"],["label","LBL_UNIQUE_FIELD"],[1,"slds-form-element__control"],[1,"slds-radio"],["type","radio","id","idFieldAuto","name","idFieldOptions","value","auto",3,"ngModel","ngModelChange"],["for","idFieldAuto",1,"slds-radio__label"],[1,"slds-radio_faux"],[1,"slds-form-element__label"],["label","LBL_HAVE_NO_ID"],["type","radio","id","idFieldHave","name","idFieldOptions","value","have",3,"ngModel","ngModelChange"],["for","idFieldHave",1,"slds-radio__label"],["label","LBL_ALREAD_HAVE_ID"],["class","slds-form-element  slds-m-vertical--small",4,"ngIf"],[1,"slds-size--3-of-4","slds-height_full"],["class","slds-table slds-table--bordered slds-table--cell-buffer",4,"ngIf"],["label","MSG_REQUIRED_MAPPED_FIXED"],[1,"slds-tile__detail","slds-text-body--small","slds-p-horizontal--small"],["class","slds-grid",4,"ngFor","ngForOf","ngForTrackBy"],[1,"slds-grid"],[1,"slds-truncate"],[1,"slds-col--bump-left","slds-truncate"],[3,"ngClass","icon"],[1,"slds-form-element","slds-m-vertical--small"],["for","idFieldSelect",1,"slds-form-element__label"],["label","LBL_SELECT_ID_FIELD"],[1,"slds-select_container"],["id","idFieldSelect",1,"slds-select",3,"ngModel","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],[3,"value"],[1,"slds-table","slds-table--bordered","slds-table--cell-buffer"],[1,"slds-text-title--caps"],["scope","col","colspan","2"],[1,"slds-truncate","slds-p-vertical--xx-small",2,"font-weight","600"],["label","LBL_HEADER"],["scope","col"],["label","LBL_FIELDS"],["colspan","2","scope","col"],["label","LBL_RECORDS"],[4,"ngFor","ngForOf","ngForTrackBy"],["scope","row","width","22px",1,"slds-p-right--none","slds-p-left--none","slds-text-align_center"],[1,"slds-text-align_center","slds-p-around--xx-small"],["size","small",3,"icon",4,"ngIf"],["scope","row"],[1,"slds-select",3,"disabled","value","change"],["size","small",3,"icon"],[3,"disabled","value"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0)(1,"div",1)(2,"div",2),c._uU(3),c.qZA(),c.YNc(4,Y,5,2,"div",3),c.TgZ(5,"div",4)(6,"fieldset",5)(7,"legend",6),c._UZ(8,"system-label",7),c.qZA(),c.TgZ(9,"div",8)(10,"span",9)(11,"input",10),c.NdJ("ngModelChange",(function(e){return t.idFieldAction=e})),c.qZA(),c.TgZ(12,"label",11),c._UZ(13,"span",12),c.TgZ(14,"span",13),c._UZ(15,"system-label",14),c.qZA()()(),c.TgZ(16,"span",9)(17,"input",15),c.NdJ("ngModelChange",(function(e){return t.idFieldAction=e})),c.qZA(),c.TgZ(18,"label",16),c._UZ(19,"span",12),c.TgZ(20,"span",13),c._UZ(21,"system-label",17),c.qZA()()()()(),c.YNc(22,D,8,3,"div",18),c.qZA()(),c.TgZ(23,"div",19),c.YNc(24,z,16,4,"table",20),c.qZA()()),2&e&&(c.xp6(3),c.hij(" ",t.spiceImport.stepLongText," "),c.xp6(1),c.Q6J("ngIf",t.modelFields&&"new"==t.spiceImport.importAction),c.xp6(7),c.Q6J("ngModel",t.idFieldAction),c.xp6(6),c.Q6J("ngModel",t.idFieldAction),c.xp6(5),c.Q6J("ngIf","have"==t.idFieldAction),c.xp6(2),c.Q6J("ngIf",t.spiceImport.fileHeader.length>0))},dependencies:[v.mk,v.sg,v.O5,l.YN,l.Kr,l.Fj,l.EJ,l._,l.JJ,l.On,O.J,I._],encapsulation:2}),SpiceImporterMap})();var $=i(2294),X=i(3634);const V=function(e,t){return{"slds-text-color_success":e,"slds-text-color--error":t}};function W(e,t){if(1&e&&(c.TgZ(0,"div",13)(1,"span",14),c._uU(2),c.qZA(),c.TgZ(3,"span",15),c._UZ(4,"system-button-icon",16),c.qZA()()),2&e){const e=t.$implicit,i=c.oxw(2);c.xp6(2),c.hij(" ",e.displayname," "),c.xp6(2),c.Q6J("ngClass",c.WLB(3,V,i.checkRequired(e.name),!i.checkRequired(e.name)))("icon",i.checkRequired(e.name)?"success":"record")}}function ee(e,t){if(1&e&&(c.TgZ(0,"div")(1,"legend",9),c._UZ(2,"system-label",10),c.qZA(),c.TgZ(3,"div",11),c.YNc(4,W,5,6,"div",12),c.qZA()()),2&e){const e=c.oxw();c.xp6(4),c.Q6J("ngForOf",e.requiredModelFields)}}function te(e,t){if(1&e&&(c.TgZ(0,"option",32),c._uU(1),c.qZA()),2&e){const e=t.$implicit,i=c.oxw(3);c.Q6J("disabled",i.isChosen(e.name))("value",e.name),c.xp6(1),c.hij("",e.displayname," ")}}function ie(e,t){if(1&e&&(c.TgZ(0,"div",25),c._UZ(1,"field-container",33),c.qZA()),2&e){const e=c.oxw().$implicit;c.xp6(1),c.Q6J("field",e.field)}}function se(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"tr")(1,"td")(2,"div",14)(3,"div",25)(4,"div")(5,"select",26),c.NdJ("change",(function(t){const i=c.CHM(e).index,s=c.oxw(2);return c.KtG(s.setFixedField(i,t.srcElement.value))})),c._UZ(6,"option",27),c.YNc(7,te,2,3,"option",28),c.qZA()()()()(),c.TgZ(8,"td")(9,"div",14),c.YNc(10,ie,2,1,"div",29),c.qZA()(),c.TgZ(11,"td")(12,"button",30),c.NdJ("click",(function(){const t=c.CHM(e).index,i=c.oxw(2);return c.KtG(i.removeFixed(t))})),c._UZ(13,"system-button-icon",31),c.qZA()()()}if(2&e){const e=t.$implicit,i=c.oxw(2);c.xp6(5),c.Q6J("disabled",i.getFixed(e))("value",i.getFixed(e)),c.xp6(2),c.Q6J("ngForOf",i.filteredModuleFileds),c.xp6(3),c.Q6J("ngIf",e.field),c.xp6(3),c.Q6J("icon","clear")("size","large")}}function le(e,t){if(1&e&&(c.TgZ(0,"table",17)(1,"thead")(2,"tr",18)(3,"th",19)(4,"div",20),c._UZ(5,"system-label",21),c.qZA()(),c.TgZ(6,"th",19)(7,"div",20),c._UZ(8,"system-label",22),c.qZA()(),c._UZ(9,"th",23),c.qZA()(),c.TgZ(10,"tbody"),c.YNc(11,se,14,6,"tr",24),c.qZA()()),2&e){const e=c.oxw();c.xp6(11),c.Q6J("ngForOf",e.spiceImport.fixedFields)}}let oe=(()=>{class SpiceImporterFixed{constructor(e,t,i,s,l){this.spiceImport=e,this.language=t,this.metadata=i,this.model=s,this.view=l,this.view.isEditable=!0,this.view.setEditMode(),this.view.displayLabels=!1}set currentImportStep(e){2==e&&this.getFilteredModuleFields()}get modelFields(){return this.modelfields}set modelFields(e){this.modelfields=e,this.filteredModuleFileds=e}getFilteredModuleFields(){let e=_.invert(this.spiceImport.fileMapping);this.filteredModuleFileds=this.modelFields.filter((t=>!e.hasOwnProperty(t.name)))}setFixedField(e,t){this.spiceImport.setFixedField(e,t)}getFixed(e){return this.spiceImport.getFixed(e)}removeFixed(e){this.model.setData(_.omit(this.model.data,this.spiceImport.fixedFields[e].field)),this.spiceImport.removeFixed(e)}checkRequired(e){let t=_.invert(this.spiceImport.fileMapping).hasOwnProperty(e),i=this.spiceImport.fixedFields.some((t=>t.field==e));return t||i}isChosen(e){return!!_.invert(this.spiceImport.fileMapping)[e]}}return SpiceImporterFixed.ɵfac=function(e){return new(e||SpiceImporterFixed)(c.Y36(m),c.Y36(a.d),c.Y36(u.Pu),c.Y36(g.o),c.Y36($.e))},SpiceImporterFixed.ɵcmp=c.Xpm({type:SpiceImporterFixed,selectors:[["spice-importer-fixed"]],inputs:{requiredModelFields:["requiredmodelfields","requiredModelFields"],currentImportStep:["currentimportstep","currentImportStep"],modelFields:["modelfields","modelFields"]},features:[c._Bn([$.e])],decls:10,vars:3,consts:[[1,"slds-grid","slds-wrap","slds-height_full"],[1,"slds-p-horizontal--small","slds-size--1-of-4","slds-border--right","slds-height_full"],[1,"slds-text-body--regular","slds-box","slds-m-vertical--small","slds-text-color--weak",2,"padding",".25rem"],[4,"ngIf"],[1,"slds-size--3-of-4","slds-height_full"],["class","slds-table slds-table--bordered slds-table--cell-buffer",4,"ngIf"],[1,"slds-grid","slds-grid--align-center","slds-p-vertical--xx-small"],["type","button",1,"slds-button","slds-button--brand",3,"click"],["label","LBL_ADD_FIXED_FIELDS","length","short"],[1,"slds-form-element__legend","slds-form-element__label"],["label","MSG_REQUIRED_MAPPED_FIXED"],[1,"slds-tile__detail","slds-text-body--small","slds-p-horizontal--small"],["class","slds-grid",4,"ngFor","ngForOf"],[1,"slds-grid"],[1,"slds-truncate"],[1,"slds-col--bump-left","slds-truncate"],[3,"ngClass","icon"],[1,"slds-table","slds-table--bordered","slds-table--cell-buffer"],[1,"slds-text-title--caps"],["scope","col","width","50%"],[1,"slds-truncate","slds-p-vertical--xx-small",2,"font-weight","600"],["label","LBL_FIELD"],["label","LBL_VALUE"],["scope","col"],[4,"ngFor","ngForOf"],[1,"slds-form-element__control"],[1,"slds-select",3,"disabled","value","change"],["value",""],[3,"disabled","value",4,"ngFor","ngForOf"],["class","slds-form-element__control",4,"ngIf"],[1,"slds-button","slds-button--icon",3,"click"],[3,"icon","size"],[3,"disabled","value"],[3,"field"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0)(1,"div",1)(2,"div",2),c._uU(3),c.qZA(),c.YNc(4,ee,5,1,"div",3),c.qZA(),c.TgZ(5,"div",4),c.YNc(6,le,12,1,"table",5),c.TgZ(7,"div",6)(8,"button",7),c.NdJ("click",(function(){return t.spiceImport.addFixed()})),c._UZ(9,"system-label",8),c.qZA()()()()),2&e&&(c.xp6(3),c.hij(" ",t.spiceImport.stepLongText," "),c.xp6(1),c.Q6J("ngIf",t.modelFields&&"new"==t.spiceImport.importAction),c.xp6(2),c.Q6J("ngIf",t.spiceImport.fileHeader.length>0))},dependencies:[v.mk,v.sg,v.O5,l.YN,l.Kr,O.J,I._,X.j],encapsulation:2}),SpiceImporterFixed})(),re=(()=>{class SpiceImporterCheck{constructor(e,t,i,s){this.language=e,this.metadata=t,this.model=i,this.spiceImporter=s}get fileMapping(){return this.spiceImporter.fileMapping}get importDuplicateAction(){return this.spiceImporter.importDuplicateAction}set importDuplicateAction(e){this.spiceImporter.importDuplicateAction=e,this.setCheckFields(e)}setCheckFields(e){if("log"==e){this.spiceImporter.checkFields=[];for(let e in this.fileMapping)this.fileMapping.hasOwnProperty(e)&&this.spiceImporter.checkFields.push({mappedField:e,moduleField:this.fileMapping[e]})}else this.spiceImporter.checkFields=[]}}return SpiceImporterCheck.ɵfac=function(e){return new(e||SpiceImporterCheck)(c.Y36(a.d),c.Y36(u.Pu),c.Y36(g.o),c.Y36(m))},SpiceImporterCheck.ɵcmp=c.Xpm({type:SpiceImporterCheck,selectors:[["spice-importer-check"]],inputs:{currentImportStep:"currentImportStep"},decls:22,vars:3,consts:[[1,"slds-grid","slds-wrap","slds-height_full"],[1,"slds-p-horizontal--small","slds-size--1-of-4","slds-border--right","slds-height_full"],[1,"slds-text-body--regular","slds-box","slds-m-top--small","slds-text-color--weak",2,"padding",".25rem"],[1,"slds-form","slds-m-around--medium"],[1,"slds-form-element","slds-m-vertical--medium"],[1,"slds-form-element__legend","slds-form-element__label"],["label","LBL_DUPLICATE_ACTION"],[1,"slds-form-element__control"],[1,"slds-radio"],["type","radio","id","importduplicateactionignore","name","duplicateoptions","value","ignore",3,"ngModel","ngModelChange"],["for","importduplicateactionignore",1,"slds-radio__label"],[1,"slds-radio--faux"],[1,"slds-form-element__label"],["label","LBL_IGNORE_DUPLICATE"],["type","radio","id","importduplicateactionlog","name","duplicateoptions","value","log",3,"ngModel","ngModelChange"],["for","importduplicateactionlog",1,"slds-radio__label"],["label","LBL_LOG_DUPLICATES"],[1,"slds-p-horizontal--small","slds-size--3-of-4","slds-height_full"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0)(1,"div",1)(2,"div",2),c._uU(3),c.qZA(),c.TgZ(4,"div",3)(5,"div",4)(6,"legend",5),c._UZ(7,"system-label",6),c.qZA(),c.TgZ(8,"div",7)(9,"span",8)(10,"input",9),c.NdJ("ngModelChange",(function(e){return t.importDuplicateAction=e})),c.qZA(),c.TgZ(11,"label",10),c._UZ(12,"span",11),c.TgZ(13,"span",12),c._UZ(14,"system-label",13),c.qZA()()(),c.TgZ(15,"span",8)(16,"input",14),c.NdJ("ngModelChange",(function(e){return t.importDuplicateAction=e})),c.qZA(),c.TgZ(17,"label",15),c._UZ(18,"span",11),c.TgZ(19,"span",12),c._UZ(20,"system-label",16),c.qZA()()()()()()(),c._UZ(21,"div",17),c.qZA()),2&e&&(c.xp6(3),c.hij(" ",t.spiceImporter.stepLongText," "),c.xp6(7),c.Q6J("ngModel",t.importDuplicateAction),c.xp6(6),c.Q6J("ngModel",t.importDuplicateAction))},dependencies:[l.Fj,l._,l.JJ,l.On,I._],encapsulation:2}),SpiceImporterCheck})();var ne=i(7443);function de(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"tr")(1,"td",8)(2,"span",16)(3,"input",22),c.NdJ("change",(function(t){const i=c.CHM(e).$implicit,s=c.oxw(2);return c.KtG(s.setCheckedField(i.key,i.value,t))})),c.qZA(),c.TgZ(4,"label",23),c._UZ(5,"span",19),c.qZA()()(),c.TgZ(6,"td",8)(7,"div",20),c._uU(8),c.qZA()(),c.TgZ(9,"td",8)(10,"div",20),c._uU(11),c.qZA()()()}if(2&e){const e=t.$implicit,i=c.oxw(2);c.xp6(3),c.s9C("id",e.key),c.Q6J("checked",i.getCheckedField(e.key)),c.xp6(1),c.s9C("for",e.key),c.xp6(4),c.hij(" ",e.key," "),c.xp6(3),c.hij(" ",e.value," ")}}function pe(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",5)(1,"table",6)(2,"thead")(3,"tr",7)(4,"th",8),c._UZ(5,"system-button-icon",9),c.qZA(),c.TgZ(6,"th",10)(7,"div",11)(8,"div",12),c._UZ(9,"system-label",13),c.qZA()()(),c.TgZ(10,"th",10)(11,"div",14),c._uU(12),c._UZ(13,"system-label",15),c.qZA()()()(),c.TgZ(14,"tbody")(15,"tr")(16,"td",8)(17,"span",16)(18,"input",17),c.NdJ("change",(function(t){c.CHM(e);const i=c.oxw();return c.KtG(i.setCheckedField(i.spiceImport.idField,"id",t))})),c.qZA(),c.TgZ(19,"label",18),c._UZ(20,"span",19),c.qZA()()(),c.TgZ(21,"td",8)(22,"div",20),c._uU(23),c.qZA()(),c.TgZ(24,"td",8)(25,"div",20),c._uU(26," id "),c.qZA()()(),c.YNc(27,de,12,5,"tr",21),c.ALo(28,"objectkeyvalues"),c.qZA()()()}if(2&e){const e=c.oxw();c.xp6(5),c.Q6J("icon","lock"),c.xp6(7),c.hij(" ",e.model.module," "),c.xp6(6),c.Q6J("checked",e.getCheckedField(e.spiceImport.idField)),c.xp6(5),c.hij(" ",e.spiceImport.idField," "),c.xp6(4),c.Q6J("ngForOf",c.lcZ(28,5,e.fileMapping))}}let ce=(()=>{class SpiceImporterUpdate{constructor(e,t,i,s){this.language=e,this.metadata=t,this.model=i,this.spiceImport=s,this.checkFields=[]}get fileMapping(){return this.spiceImport.fileMapping}setCheckedField(e,t,i){i.target.checked?(this.spiceImport.checkFields=this.spiceImport.checkFields.filter((t=>t.mappedField!==e)),this.spiceImport.checkFields.push({mappedField:e,moduleField:t})):this.spiceImport.checkFields=this.spiceImport.checkFields.filter((t=>t.mappedField!==e))}getCheckedField(e){return this.spiceImport.checkFields.some((t=>t.mappedField==e))}}return SpiceImporterUpdate.ɵfac=function(e){return new(e||SpiceImporterUpdate)(c.Y36(a.d),c.Y36(u.Pu),c.Y36(g.o),c.Y36(m))},SpiceImporterUpdate.ɵcmp=c.Xpm({type:SpiceImporterUpdate,selectors:[["spice-importer-update"]],inputs:{currentImportStep:"currentImportStep"},decls:6,vars:3,consts:[[1,"slds-grid","slds-wrap","slds-height_full"],[1,"slds-p-horizontal--small","slds-size--1-of-4","slds-border--right","slds-height_full"],[1,"slds-text-body--regular","slds-box","slds-m-top--small","slds-text-color--weak",2,"padding",".25rem"],["size","small",1,"slds-m-right--xx-small",3,"icon"],["class","slds-size--3-of-4 slds-height_full",4,"ngIf"],[1,"slds-size--3-of-4","slds-height_full"],[1,"slds-table","slds-table--bordered","slds-table--cell-buffer",2,"border-top","none"],[1,"slds-text-title--caps"],["scope","row"],["size","small",3,"icon"],["scope","col"],[1,"slds-truncate","slds-p-vertical--x-small"],[1,"slds-form-element__control",2,"font-weight","600"],["label","LBL_MAPPED_FIELDS"],[1,"slds-truncate","slds-p-vertical--x-small",2,"font-weight","600"],["label","LBL_FIELDS"],[1,"slds-checkbox"],["type","checkbox","id","idField",3,"checked","change"],["for","idField",1,"slds-checkbox__label"],[1,"slds-checkbox_faux"],[1,"slds-truncate"],[4,"ngFor","ngForOf"],["type","checkbox",3,"id","checked","change"],[1,"slds-checkbox__label",3,"for"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0)(1,"div",1)(2,"div",2),c._UZ(3,"system-button-icon",3),c._uU(4),c.qZA()(),c.YNc(5,pe,29,7,"div",4),c.qZA()),2&e&&(c.xp6(3),c.Q6J("icon","lock"),c.xp6(1),c.hij(" ",t.spiceImport.stepLongText," "),c.xp6(1),c.Q6J("ngIf",(null==t.spiceImport.fileHeader?null:t.spiceImport.fileHeader.length)>0))},dependencies:[v.sg,v.O5,O.J,I._,ne.E],encapsulation:2}),SpiceImporterUpdate})();var ae=i(5920),me=i(6625);const ue=["fileupload"];function ge(e,t){if(1&e&&(c.TgZ(0,"td")(1,"div",13),c._uU(2),c.qZA()()),2&e){const e=t.$implicit;c.xp6(2),c.Oqu(e)}}const he=function(e){return{cursor:e}};function fe(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"tr",11),c.NdJ("click",(function(){const t=c.CHM(e).$implicit,i=c.oxw(2);return c.KtG(!!t.recordId&&i.goToRecord(t.recordId))})),c.TgZ(1,"td",12)(2,"div",13),c._uU(3),c.qZA()(),c.YNc(4,ge,3,1,"td",14),c.qZA()}if(2&e){const e=t.$implicit;c.Q6J("ngStyle",c.VKq(3,he,e.recordId?"pointer":"initial")),c.xp6(3),c.Oqu(e.status),c.xp6(1),c.Q6J("ngForOf",e.data)}}function Ie(e,t){if(1&e&&(c.TgZ(0,"table",3)(1,"thead")(2,"tr",4)(3,"th",5)(4,"div",6),c._UZ(5,"system-label",7),c.qZA()(),c.TgZ(6,"th",8)(7,"div",6),c._UZ(8,"system-label",9),c.qZA()()()(),c.TgZ(9,"tbody"),c.YNc(10,fe,5,5,"tr",10),c.qZA()()),2&e){const e=c.oxw();c.xp6(10),c.Q6J("ngForOf",e.spiceImport.result.list)}}let _e=(()=>{class SpiceImporterResult{constructor(e,t,i,s,l,o,r){this.spiceImport=e,this.toast=t,this.language=i,this.session=s,this.configurationService=l,this.model=o,this.router=r}goToRecord(e){this.router.navigate([`/module/${this.model.module}/${e}`])}}return SpiceImporterResult.ɵfac=function(e){return new(e||SpiceImporterResult)(c.Y36(m),c.Y36(Z.A),c.Y36(a.d),c.Y36(ae.n),c.Y36(me.C),c.Y36(g.o),c.Y36(h.F0))},SpiceImporterResult.ɵcmp=c.Xpm({type:SpiceImporterResult,selectors:[["spice-importer-result"]],viewQuery:function(e,t){if(1&e&&c.Gf(ue,7,c.s_b),2&e){let e;c.iGM(e=c.CRH())&&(t.fileupload=e.first)}},decls:3,vars:1,consts:[[1,"slds-wrap","slds-height_full"],[1,"slds-height_full"],["class","slds-table slds-table--bordered slds-table--cell-buffer",4,"ngIf"],[1,"slds-table","slds-table--bordered","slds-table--cell-buffer"],[1,"slds-text-title--caps"],["scope","col"],[1,"slds-truncate",2,"font-weight","600"],["label","LBL_STATUS"],["colspan","4","scope","col"],["label","LBL_DATA"],[3,"ngStyle","click",4,"ngFor","ngForOf"],[3,"ngStyle","click"],["scope","row"],[1,"slds-truncate"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0)(1,"div",1),c.YNc(2,Ie,11,1,"table",2),c.qZA()()),2&e&&(c.xp6(2),c.Q6J("ngIf",t.spiceImport.result&&t.spiceImport.result.list&&t.spiceImport.result.list.length>0))},dependencies:[v.sg,v.O5,v.PC,I._],styles:["[_nghost-%COMP%]{height:100%}"]}),SpiceImporterResult})();var be=i(7017),Ze=i(4561),xe=i(3333),ve=i(4664);const Fe=["contentcontainer"];function Ae(e,t){if(1&e&&(c.TgZ(0,"li",32),c._uU(1),c.qZA()),2&e){const e=c.oxw();c.xp6(1),c.hij(" ","new"==e.spiceImporter.importAction?e.language.getLabel("LBL_LOAD_NEW_RECORDS"):e.language.getLabel("LBL_UPDATE_EXISTING_RECORDS")," ")}}function Se(e,t){1&e&&c._UZ(0,"system-button-icon",37),2&e&&c.Q6J("icon","success")}const Te=function(e){return{"slds-button--icon slds-progress__marker--icon":e}};function Le(e,t){if(1&e&&(c.TgZ(0,"li",33)(1,"button",34)(2,"span",35),c._uU(3),c.qZA(),c.YNc(4,Se,1,1,"system-button-icon",36),c.qZA()()),2&e){const e=t.$implicit,i=c.oxw();c.Q6J("ngClass",i.getStepClass(e)),c.xp6(1),c.Q6J("ngClass",c.VKq(4,Te,i.getStepComplete(e))),c.xp6(2),c.Oqu(e),c.xp6(1),c.Q6J("ngIf",i.getStepComplete(e))}}function Me(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"button",38),c.NdJ("click",(function(){c.CHM(e);const t=c.oxw();return c.KtG(t.nextStep())})),c._UZ(1,"system-label",39),c.qZA()}}function qe(e,t){if(1&e&&(c.TgZ(0,"span",43),c._uU(1),c.qZA()),2&e){const e=c.oxw(2);c.xp6(1),c.hij(" ","new"==e.spiceImporter.importAction?e.language.getLabel("LBL_IMPORT"):e.language.getLabel("LBL_UPDATE")," ")}}function ye(e,t){if(1&e&&(c.TgZ(0,"span",43),c._uU(1),c.qZA()),2&e){const e=c.oxw(2);c.xp6(1),c.hij(" ","new"==e.spiceImporter.importAction?e.language.getLabel("LBL_IMPORTING"):e.language.getLabel("LBL_UPDATING")," ")}}function ke(e,t){1&e&&c._UZ(0,"system-spinner",44),2&e&&c.Q6J("size",16)}function we(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"button",40),c.NdJ("click",(function(){c.CHM(e);const t=c.oxw();return c.KtG(t.nextStep())})),c.YNc(1,qe,2,1,"span",41),c.YNc(2,ye,2,1,"span",41),c.YNc(3,ke,1,1,"system-spinner",42),c.qZA()}if(2&e){const e=c.oxw();c.Q6J("disabled",e.processing),c.xp6(1),c.Q6J("ngIf",!e.processing),c.xp6(1),c.Q6J("ngIf",e.processing),c.xp6(1),c.Q6J("ngIf",e.processing)}}function Ue(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"button",45),c.NdJ("click",(function(){c.CHM(e);const t=c.oxw();return c.KtG(t.nextStep())})),c._UZ(1,"system-label",46),c.qZA()}}function Ce(e,t){1&e&&c._UZ(0,"spice-importer-check")}function Je(e,t){1&e&&c._UZ(0,"spice-importer-update")}const Ee=function(e){return{"slds-hide":e}};let Ne=(()=>{class SpiceImporter{constructor(e,t,i,s,l,o,r,n){this.spiceImporter=e,this.language=t,this.metadata=i,this.model=s,this.navigationtab=l,this.router=o,this.backend=r,this.toast=n,this.importSteps=["select","map","fixed","check","result"],this.importAction="new",this.processing=!1,this.modelFields=void 0,this.requiredModelFields=void 0,this.model.module=this.navigationtab.activeRoute.params.module,this.model.initialize(),this.metadata.checkModuleAcl(this.model.module,"import")||(this.toast.sendToast(this.language.getLabel("MSG_NOT_AUTHORIZED_TO_IMPORT")+" "+this.language.getModuleName(this.model.module),"error"),this.router.navigate(["/module/"+this.model.module])),this.getModuleFields()}get templateName(){return this.templatename}set templateName(e){this.templatename=e}get currentImportStep(){return this.spiceImporter.currentImportStep}ngOnInit(){this.navigationtab.setTabInfo({displayname:this.language.getLabel("LBL_IMPORT"),displaymodule:this.model.module}),this.backend.getRequest("module/SpiceImports/savedimports/"+this.model.module).subscribe((e=>{this.spiceImporter.savedImports=e}))}getModuleFields(){if(""!==this.model.module){this.modelFields=[];let e=this.metadata.getModuleFields(this.model.module);for(let t in e)if(e.hasOwnProperty(t)){let i=e[t];"link"===i.type||"relate"===i.type||"email1"!=i.name&&"non-db"===i.source||"id"==i.name||(i.vname?i.displayname=this.language.getLabel(this.model.module,i.vname)+" ("+i.name+")":i.displayname=i.name,this.modelFields.push(i))}}this.requiredModelFields=this.modelFields.filter((e=>"id"!=e.name&&e.required))}setImportAction(e){let t;switch(this.importAction=e,e){case"new":t=this.importSteps.indexOf("update"),this.importSteps[t]="check",this.spiceImporter.importStepsText[t]="LBL_DUPLICATE_CHECK";break;case"update":t=this.importSteps.indexOf("check"),this.importSteps[t]="update",this.spiceImporter.importStepsText[t]="LBL_UPDATE_EXISTING_RECORDS"}}getCurrentStep(){return this.language.getLabel(this.spiceImporter.importStepsText[this.spiceImporter.currentImportStep])}gotoModule(){this.router.navigate(["/module/"+this.model.module])}getContainerStyle(){return{height:"calc(100vh - "+this.contentcontainer.element.nativeElement.getBoundingClientRect().top+"px)","overflow-y":"auto"}}getStepClass(e){let t=this.importSteps.indexOf(e);return t==this.spiceImporter.currentImportStep?"slds-is-active":t<this.spiceImporter.currentImportStep?"slds-is-completed":void 0}getStepComplete(e){return this.importSteps.indexOf(e)<this.spiceImporter.currentImportStep}getProgressBarWidth(){return{width:this.spiceImporter.currentImportStep/(this.importSteps.length-1)*100+"%"}}nextStep(){switch(this.spiceImporter.currentImportStep){case 0:if(""===this.spiceImporter.fileName)return this.toast.sendToast(this.language.getLabel("MSG_SELECT_VALID_FILE"),"error");if("choose"==this.spiceImporter.importTemplateAction&&Object.keys(this.spiceImporter.fileMapping).length<=0&&0==this.spiceImporter.checkFields.length&&0==this.spiceImporter.fixedFields.length)return this.toast.sendToast(this.language.getLabel("LBL_MAKE_SELECTION"),"error");if("new"==this.spiceImporter.importTemplateAction&&!this.templateName)return this.toast.sendToast(this.language.getLabel("MSG_INPUT_REQUIRED"),"error");this.spiceImporter.currentImportStep++;break;case 1:if(Object.keys(this.spiceImporter.fileMapping).length<=0)return this.toast.sendToast(this.language.getLabel("MSG_MAP_FIELDS"),"error");if("have"==this.spiceImporter.idFieldAction&&""==this.spiceImporter.idField)return this.toast.sendToast(this.language.getLabel("LBL_MAKE_SELECTION"),"error");this.spiceImporter.currentImportStep++;break;case 2:for(let e of this.spiceImporter.fixedFields){if(!this.model.data.hasOwnProperty(e.field))return this.toast.sendToast(this.language.getLabel("MSG_INPUT_REQUIRED"),"error");if(this.model.data[e.field].length<1)return this.toast.sendToast(this.language.getLabel("MSG_INPUT_REQUIRED"),"error")}if(!this.checkRequiredMapped()&&"new"==this.spiceImporter.importAction)return this.toast.sendToast(this.language.getLabel("MSG_MAP_FIELDS"),"error");this.spiceImporter.currentImportStep++;break;case 3:if("update"==this.importAction&&this.spiceImporter.checkFields.length<1)return this.toast.sendToast(this.language.getLabel("LBL_MAKE_SELECTION"),"error");this.import();break;case 4:this.gotoModule(),this.spiceImporter.currentImportStep=0;break;default:this.spiceImporter.currentImportStep++}}checkRequiredMapped(){let e=_.invert(this.spiceImporter.fileMapping),t=0,i={};for(let e of this.spiceImporter.fixedFields)i[e.field]=e.field;for(let s of this.requiredModelFields)"id"!=s.name&&(e[s.name]&&t++,i[s.name]&&t++);return this.requiredModelFields.length==t}prevStep(){this.spiceImporter.currentImportStep>0&&this.spiceImporter.currentImportStep--}showNext(){return this.spiceImporter.currentImportStep<this.importSteps.length-2}showImport(){return this.spiceImporter.currentImportStep==this.importSteps.length-2}showExit(){return this.spiceImporter.currentImportStep==this.importSteps.length-1}import(){let e=this.prepareObjectImport();this.spiceImporter.result={},this.processing=!0,this.backend.postRequest("module/SpiceImports/import",{objectimport:e}).subscribe((e=>{switch(e.status){case"imported":this.spiceImporter.result=e;break;case"scheduled":this.gotoModule(),this.toast.sendToast(e.msg,"success");break;case"error":this.toast.sendToast(e.msg,"error","",!1)}this.processing=!1,this.spiceImporter.currentImportStep++}))}prepareObjectImport(){let e=_.pick(this.spiceImporter,"fileName","fileId","fileHeader","fileMapping","templateName","fileTooBig","enclosure","separator","checkFields","importAction","idFieldAction","idField","fixedFields","importDuplicateAction");return e.fixedFieldsValues=this.model.data,e.module=this.model.module,""!=this.spiceImporter.idField&&(e.fileMapping[this.spiceImporter.idField]="id"),"have"==e.idFieldAction&&(e.checkFields=[{mappedField:this.spiceImporter.idField,moduleField:"id"}]),e}}return SpiceImporter.ɵfac=function(e){return new(e||SpiceImporter)(c.Y36(m),c.Y36(a.d),c.Y36(u.Pu),c.Y36(g.o),c.Y36(be.d),c.Y36(h.F0),c.Y36(x.y),c.Y36(Z.A))},SpiceImporter.ɵcmp=c.Xpm({type:SpiceImporter,selectors:[["ng-component"]],viewQuery:function(e,t){if(1&e&&c.Gf(Fe,7,c.s_b),2&e){let e;c.iGM(e=c.CRH())&&(t.contentcontainer=e.first)}},features:[c._Bn([g.o,m])],decls:37,vars:25,consts:[[1,"slds-page-header"],[1,"slds-grid"],[1,"slds-col","slds-has-flexi-truncate"],[1,"slds-media","slds-no-space","slds-grow"],[3,"module"],[1,"slds-media__body"],["role","navigation","aria-label","Breadcrumbs"],[1,"slds-breadcrumb","slds-list--horizontal"],[1,"slds-breadcrumb__item","slds-text-title--caps"],["href","javascript:void(0);",3,"click"],["href","javascript:void(0);"],["label","LBL_IMPORT"],["class","slds-breadcrumb__item slds-text-title--caps slds-p-left--x-small",4,"ngIf"],[1,"slds-page-header__title","slds-m-right--small","slds-align-middle","slds-truncate"],[1,"slds-grid","slds-grid--align-spread","slds-p-around--small","slds-theme--shade","slds-border--bottom"],[1,"slds-button","slds-button--neutral",3,"disabled","ngClass","click"],["label","LBL_PREVIOUS"],[1,"slds-progress","slds-progress--shade"],[1,"slds-progress__list"],["class","slds-progress__item",3,"ngClass",4,"ngFor","ngForOf"],[1,"slds-progress-bar","slds-progress-bar_x-small"],[1,"slds-progress-bar__value",3,"ngStyle"],["class","slds-button slds-button--neutral",3,"click",4,"ngIf"],["class","slds-button slds-button--brand slds-grid slds-grid_vertical-align-center",3,"disabled","click",4,"ngIf"],["class","slds-button slds-button--brand",3,"click",4,"ngIf"],[1,"slds-scrollable--y",3,"ngStyle"],["contentcontainer",""],[3,"hidden","templateNameSet","importActionSet"],[3,"modelfields","requiredmodelfields","hidden"],[3,"modelfields","requiredmodelfields","hidden","currentimportstep"],[4,"ngIf"],[3,"hidden"],[1,"slds-breadcrumb__item","slds-text-title--caps","slds-p-left--x-small"],[1,"slds-progress__item",3,"ngClass"],[1,"slds-button","slds-progress__marker",3,"ngClass"],[1,"slds-assistive-text"],[3,"icon",4,"ngIf"],[3,"icon"],[1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_NEXT"],[1,"slds-button","slds-button--brand","slds-grid","slds-grid_vertical-align-center",3,"disabled","click"],["class","slds-p-right--xx-small",4,"ngIf"],["inverse","true",3,"size",4,"ngIf"],[1,"slds-p-right--xx-small"],["inverse","true",3,"size"],[1,"slds-button","slds-button--brand",3,"click"],["label","LBL_CLOSE"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),c._UZ(4,"system-icon",4),c.TgZ(5,"div",5)(6,"nav",6)(7,"ol",7)(8,"li",8)(9,"a",9),c.NdJ("click",(function(){return t.gotoModule()})),c._UZ(10,"system-label-modulename",4),c.qZA()(),c.TgZ(11,"li",8)(12,"a",10),c._UZ(13,"system-label",11),c.qZA()(),c.YNc(14,Ae,2,1,"li",12),c.qZA()(),c.TgZ(15,"div")(16,"h1",13),c._uU(17),c.qZA()()()()()()(),c.TgZ(18,"div",14)(19,"button",15),c.NdJ("click",(function(){return t.prevStep()})),c._UZ(20,"system-label",16),c.qZA(),c.TgZ(21,"div",17)(22,"ol",18),c.YNc(23,Le,5,6,"li",19),c.qZA(),c.TgZ(24,"div",20),c._UZ(25,"span",21),c.qZA()(),c.YNc(26,Me,2,0,"button",22),c.YNc(27,we,4,4,"button",23),c.YNc(28,Ue,2,0,"button",24),c.qZA(),c.TgZ(29,"div",25,26)(31,"spice-importer-select",27),c.NdJ("templateNameSet",(function(e){return t.templateName=e}))("importActionSet",(function(e){return t.setImportAction(e)})),c.qZA(),c._UZ(32,"spice-importer-map",28)(33,"spice-importer-fixed",29),c.YNc(34,Ce,1,0,"spice-importer-check",30),c.YNc(35,Je,1,0,"spice-importer-update",30),c._UZ(36,"spice-importer-result",31),c.qZA()),2&e&&(c.xp6(4),c.Q6J("module",t.model.module),c.xp6(6),c.Q6J("module",t.model.module),c.xp6(4),c.Q6J("ngIf",t.currentImportStep>=1),c.xp6(3),c.hij(" ",t.getCurrentStep(),""),c.xp6(2),c.Q6J("disabled",t.showExit())("ngClass",c.VKq(23,Ee,!t.currentImportStep)),c.xp6(4),c.Q6J("ngForOf",t.importSteps),c.xp6(2),c.Q6J("ngStyle",t.getProgressBarWidth()),c.xp6(1),c.Q6J("ngIf",t.showNext()),c.xp6(1),c.Q6J("ngIf",t.showImport()),c.xp6(1),c.Q6J("ngIf",t.showExit()),c.xp6(1),c.Q6J("ngStyle",t.getContainerStyle()),c.xp6(2),c.Q6J("hidden",0!==t.currentImportStep),c.xp6(1),c.Q6J("modelfields",t.modelFields)("requiredmodelfields",t.requiredModelFields)("hidden",1!==t.currentImportStep),c.xp6(1),c.Q6J("modelfields",t.modelFields)("requiredmodelfields",t.requiredModelFields)("hidden",2!==t.currentImportStep)("currentimportstep",t.currentImportStep),c.xp6(1),c.Q6J("ngIf",3===t.currentImportStep&&"new"==t.spiceImporter.importAction),c.xp6(1),c.Q6J("ngIf",3===t.currentImportStep&&"update"==t.spiceImporter.importAction),c.xp6(1),c.Q6J("hidden",4!==t.currentImportStep))},dependencies:[v.mk,v.sg,v.O5,v.PC,O.J,Ze.f,I._,xe.M,ve.W,N,K,oe,re,ce,_e],encapsulation:2}),SpiceImporter})(),Oe=(()=>{class SpiceImporterModule{}return SpiceImporterModule.ɵfac=function(e){return new(e||SpiceImporterModule)},SpiceImporterModule.ɵmod=c.oAB({type:SpiceImporterModule}),SpiceImporterModule.ɵinj=c.cJS({providers:[m],imports:[s.b2,l.u5,o.SystemComponents,r.GlobalComponents,n.ObjectComponents,d.ObjectFields,p.o]}),SpiceImporterModule})();("undefined"==typeof ngJitMode||ngJitMode)&&c.kYT(Oe,{declarations:[Ne,N,K,oe,re,ce,_e,b],imports:[s.b2,l.u5,o.SystemComponents,r.GlobalComponents,n.ObjectComponents,d.ObjectFields,p.o],exports:[Ne,b]})}}]);