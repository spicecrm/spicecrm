/*!
 * 
 *                     SpiceCRM
 *
 *                     release: 2024.01.001
 *
 *                     date: 2024-05-28 17:40:40
 *
 *                     build: 2024.01.001.1716910840504
 *
 */
"use strict";(self.webpackChunkcore=self.webpackChunkcore||[]).push([["src_include_sendinblue_sendinbluemodule_ts"],{20197:(e,t,s)=>{s.r(t),s.d(t,{SendinBlueModule:()=>k});var n=s(60177),l=s(84341),i=s(71341),a=s(7745),o=s(12948),d=s(37328),c=s(70569),u=s(54438),r=s(69904),b=s(83935),m=s(35911),h=s(50531),g=s(49722),B=s(41081),S=s(32062);let L=(()=>{class SendinBlueButton{constructor(e,t,s,n,l,i,a){this.language=e,this.metadata=t,this.model=s,this.modal=n,this.injector=l,this.backend=i,this.toast=a}get disabled(){return"0"==this.model.getFieldValue("entry_count")}execute(){let e=this.modal.await(this.language.getLabel("LBL_LOADING"));this.backend.getRequest(`channels/emarketing/sendinblue/${this.model.module}/${this.model.id}`).subscribe((t=>{e.emit(!0),t?this.modal.openModal("SendinBlueModal",!0,this.injector).subscribe((e=>{e.instance.contacts=t.synced})):this.toast.sendToast(this.language.getLabel("ERR_FAILED_TO_EXECUTE"),"error")}))}static#e=this.ɵfac=function(e){return new(e||SendinBlueButton)(u.rXU(r.B),u.rXU(b.yu),u.rXU(m.g),u.rXU(h.y),u.rXU(u.zZn),u.rXU(g.H),u.rXU(B.o))};static#t=this.ɵcmp=u.VBU({type:SendinBlueButton,selectors:[["sendinblue-button"]],decls:2,vars:2,consts:[["label","LBL_SENDINBLUE"]],template:function(e,t){1&e&&(u.j41(0,"span"),u.nrm(1,"system-label",0),u.k0s()),2&e&&u.AVh("disabled",t.disabled)},dependencies:[S.W],encapsulation:2})}return SendinBlueButton})();var p=s(57363),E=s(40713),U=s(25028),y=s(88418),f=s(83524);function I(e,t){if(1&e&&(u.j41(0,"div"),u.EFF(1),u.nrm(2,"system-label",1)(3,"system-label",1),u.k0s()),2&e){const e=u.XpG();u.R7$(),u.SpI(" ",e.contacts.length," "),u.R7$(),u.Y8G("label","MSG_SENDINBLUE_FOUND"),u.R7$(),u.Y8G("label","MSG_SENDINBLUE_UPDATE_LIST")}}function M(e,t){1&e&&(u.j41(0,"div"),u.nrm(1,"system-label",1),u.k0s()),2&e&&(u.R7$(),u.Y8G("label","MSG_SENDINBLUE_UPDATE_LIST"))}let X=(()=>{class SendinBlueModal{constructor(e,t,s,n,l,i,a){this.language=e,this.router=t,this.metadata=s,this.backend=n,this.model=l,this.modal=i,this.toast=a,this.contacts=[],this.self={}}updateSendInBlueList(){const e=this.model.getFieldValue("ext_id");_.isEmpty(e)?(this.toast.sendToast(this.language.getLabel("MSG_NO_EXT_ID"),"error"),this.close()):this.modal.openModal("SystemLoadingModal").subscribe((t=>{t.instance.messagelabel="LBL_UPDATING",this.backend.postRequest(`channels/emarketing/sendinblue/${this.model.module}/${this.model.id}/${e}`,{}).subscribe((e=>{e?(t.instance.self.destroy(),this.close(),this.toast.sendToast(this.language.getLabel("MSG_SUCCESSFULLY_EXECUTED"),"success")):this.toast.sendToast(this.language.getLabel("ERR_FAILED_TO_EXECUTE"),"error")}))}))}close(){this.self.destroy()}static#e=this.ɵfac=function(e){return new(e||SendinBlueModal)(u.rXU(r.B),u.rXU(p.Ix),u.rXU(b.yu),u.rXU(g.H),u.rXU(m.g),u.rXU(h.y),u.rXU(B.o))};static#t=this.ɵcmp=u.VBU({type:SendinBlueModal,selectors:[["sendinblue-modal"]],decls:11,vars:5,consts:[[3,"close"],[3,"label"],[4,"ngIf"],[1,"slds-button","slds-button--brand",3,"click"]],template:function(e,t){1&e&&(u.j41(0,"system-modal")(1,"system-modal-header",0),u.bIt("close",(function(){return t.close()})),u.nrm(2,"system-label",1),u.k0s(),u.j41(3,"system-modal-content"),u.DNE(4,I,4,3,"div",2)(5,M,2,1,"div",2),u.k0s(),u.j41(6,"system-modal-footer")(7,"button",3),u.bIt("click",(function(){return t.close()})),u.nrm(8,"system-label",1),u.k0s(),u.j41(9,"button",3),u.bIt("click",(function(){return t.updateSendInBlueList()})),u.nrm(10,"system-label",1),u.k0s()()()),2&e&&(u.R7$(2),u.Y8G("label","LBL_SENDINBLUE"),u.R7$(2),u.Y8G("ngIf",t.contacts.length>0),u.R7$(),u.Y8G("ngIf",0==t.contacts.length),u.R7$(3),u.Y8G("label","LBL_CANCEL"),u.R7$(2),u.Y8G("label","LBL_UPDATE"))},dependencies:[n.bT,S.W,E.D,U.I,y.Q,f.C],encapsulation:2})}return SendinBlueModal})(),k=(()=>{class SendinBlueModule{static#e=this.ɵfac=function(e){return new(e||SendinBlueModule)};static#t=this.ɵmod=u.$C({type:SendinBlueModule});static#s=this.ɵinj=u.G2t({imports:[n.MD,l.YN,a.ObjectFields,o.GlobalComponents,d.ObjectComponents,c.SystemComponents,i.h,l.X1]})}return SendinBlueModule})();("undefined"==typeof ngJitMode||ngJitMode)&&u.Obh(k,{declarations:[L,X],imports:[n.MD,l.YN,a.ObjectFields,o.GlobalComponents,d.ObjectComponents,c.SystemComponents,i.h,l.X1]})}}]);