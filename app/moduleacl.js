/*!
 * 
 *                     SpiceCRM
 *
 *                     release: 2024.01.001
 *
 *                     date: 2024-06-07 18:47:00
 *
 *                     build: 2024.01.001.1717778820753
 *
 */
"use strict";(self.webpackChunkcore=self.webpackChunkcore||[]).push([["src_modules_acl_moduleacl_ts"],{43841:(e,t,s)=>{s.r(t),s.d(t,{ModuleACL:()=>Kt});var i=s(60177),l=s(84341),n=s(7745),o=s(12948),c=s(37328),a=s(71341),d=s(70569),r=s(54438),u=s(49722),p=s(92462),m=s(69139),f=s(69904),b=s(68823),h=s(32062),g=s(44985);let y=(()=>{class ACLManagerHeader{constructor(e){this.language=e,this.displaylabel=""}static#e=this.ɵfac=function(e){return new(e||ACLManagerHeader)(r.rXU(f.B))};static#t=this.ɵcmp=r.VBU({type:ACLManagerHeader,selectors:[["acl-manager-header"]],inputs:{displaylabel:"displaylabel"},decls:12,vars:1,consts:[[1,"slds-p-around--medium","slds-theme--default","slds-border--bottom"],[1,"slds-grid"],[1,"slds-col","slds-has-flexi-truncate"],[1,"slds-media","slds-no-space","slds-grow"],[1,"slds-media__figure"],["module","SpiceACLObjects"],[1,"slds-media__body"],[1,"slds-text-title_caps","slds-line-height_reset"],[1,"slds-page-header__title","slds-p-right_x-small"],[1,"slds-truncate"],[3,"label"]],template:function(e,t){1&e&&(r.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),r.nrm(5,"system-icon",5),r.k0s(),r.j41(6,"div",6)(7,"p",7),r.nrm(8,"system-label-modulename",5),r.k0s(),r.j41(9,"h1",8)(10,"div",9),r.nrm(11,"system-label",10),r.k0s()()()()()()()),2&e&&(r.R7$(11),r.Y8G("label",t.displaylabel))},dependencies:[b.J,h.W,g.r],encapsulation:2})}return ACLManagerHeader})();var j=s(50531),k=s(97466),v=s(48717),_=s(18521),L=s(28933),C=s(90154);function I(e,t){1&e&&(r.j41(0,"div",8),r.nrm(1,"system-spinner"),r.k0s())}function A(e,t){1&e&&r.nrm(0,"system-utility-icon",21)}function R(e,t){1&e&&r.nrm(0,"system-utility-icon",22)}const O=e=>({"slds-theme--shade":e});function F(e,t){if(1&e){const e=r.RV6();r.j41(0,"tr",16),r.bIt("click",(function(){const t=r.eBV(e).$implicit,s=r.XpG(2);return r.Njj(s.selectType(t))})),r.j41(1,"td")(2,"div",17)(3,"system-link"),r.EFF(4),r.k0s()()(),r.j41(5,"td",18),r.DNE(6,A,1,0,"system-utility-icon",19)(7,R,1,0,"system-utility-icon",20),r.k0s()()}if(2&e){const e=t.$implicit,s=r.XpG(2);r.Y8G("ngClass",r.eq3(4,O,e.id==s.activeTypeId)),r.R7$(4),r.JRh(e.module),r.R7$(2),r.Y8G("ngIf",e.usagecount>0),r.R7$(),r.Y8G("ngIf",0==e.usagecount)}}function E(e,t){if(1&e&&(r.j41(0,"table",9)(1,"thead")(2,"tr",10)(3,"th",11)(4,"div",12),r.nrm(5,"system-label",13),r.k0s()(),r.nrm(6,"th",14),r.k0s()(),r.j41(7,"tbody"),r.DNE(8,F,8,6,"tr",15),r.k0s()()),2&e){const e=r.XpG();r.R7$(8),r.Y8G("ngForOf",e.acltypeslist)}}let M=(()=>{class ACLTypesManagerTypes{constructor(e,t,s,i){this.backend=e,this.modal=t,this.language=s,this.modelutilities=i,this.loading=!0,this.acltypes=[],this.activeTypeId="",this.typeselected=new r.bkB,this.backend.getRequest("module/SpiceACLObjects/modules").subscribe((e=>{this.acltypes=e,this.acltypes.sort(((e,t)=>e.module>t.module?1:-1)),this.loading=!1}))}get acltypeslist(){return this.filter?this.acltypes.filter((e=>e.id==this.activeTypeId||e.module.toLowerCase().indexOf(this.filter.toLowerCase())>=0)):this.acltypes}selectType(e){this.activeTypeId=e.id,this.typeselected.emit(e)}static#e=this.ɵfac=function(e){return new(e||ACLTypesManagerTypes)(r.rXU(u.H),r.rXU(j.y),r.rXU(f.B),r.rXU(p.g))};static#t=this.ɵcmp=r.VBU({type:ACLTypesManagerTypes,selectors:[["acltypes-manager-types"]],outputs:{typeselected:"typeselected"},decls:9,vars:3,consts:[[2,"height","100%"],[1,"slds-grid","slds-grid--vertical-align-center","slds-p-around--x-small","slds-border--bottom"],[1,"slds-text-heading--small"],["label","LBL_MODULES"],["system-placeholder","LBL_FILTER",1,"slds-col--bump-left","slds-size--1-of-2","slds-input",3,"ngModel","ngModelChange"],["system-to-bottom","",1,"slds-scrollable"],["class","slds-p-around--medium slds-align--absolute-center",4,"ngIf","ngIfElse"],["typesdisplay",""],[1,"slds-p-around--medium","slds-align--absolute-center"],[1,"slds-table","slds-table--header-fixed","slds-table_bordered","slds-table_cell-buffer"],[1,"slds-text-title_caps"],["scope","col"],[1,"slds-truncate","slds-th__action"],["label","LBL_MODULE"],["scope","col",2,"width","3rem"],[3,"ngClass","click",4,"ngFor","ngForOf"],[3,"ngClass","click"],[1,"slds-truncate"],[2,"width","3rem"],["icon","lock","size","x-small","addclasses","slds-icon slds-icon-text-default",4,"ngIf"],["icon","unlock","size","x-small","addclasses","slds-icon slds-icon-text-light",4,"ngIf"],["icon","lock","size","x-small","addclasses","slds-icon slds-icon-text-default"],["icon","unlock","size","x-small","addclasses","slds-icon slds-icon-text-light"]],template:function(e,t){if(1&e&&(r.j41(0,"div",0)(1,"div",1)(2,"h2",2),r.nrm(3,"system-label",3),r.k0s(),r.j41(4,"input",4),r.mxI("ngModelChange",(function(e){return r.DH7(t.filter,e)||(t.filter=e),e})),r.k0s()(),r.j41(5,"div",5),r.DNE(6,I,2,0,"div",6)(7,E,9,1,"ng-template",null,7,r.C5r),r.k0s()()),2&e){const e=r.sdS(8);r.R7$(4),r.R50("ngModel",t.filter),r.R7$(2),r.Y8G("ngIf",t.loading)("ngIfElse",e)}},dependencies:[i.YU,i.Sq,i.bT,l.me,l.BC,l.vS,h.W,k.k,v.P,_.B,L.b,C.m],encapsulation:2})}return ACLTypesManagerTypes})();function G(e,t){if(1&e){const e=r.RV6();r.j41(0,"tr")(1,"td")(2,"div",14),r.EFF(3),r.k0s()(),r.j41(4,"td")(5,"div",14),r.EFF(6),r.k0s()(),r.j41(7,"td",15)(8,"system-utility-icon",16),r.bIt("click",(function(){const t=r.eBV(e).$implicit,s=r.XpG();return r.Njj(s.deleteAction(t.id))})),r.k0s()()()}if(2&e){const e=t.$implicit;r.R7$(3),r.JRh(e.action),r.R7$(3),r.JRh(e.description)}}let T=(()=>{class ACLTypesManagerTypesActions{constructor(e,t,s,i){this.backend=e,this.modal=t,this.language=s,this.modelutilities=i,this.authtypeactions=[],this.addaction=new r.bkB,this.deleteaction=new r.bkB}addAction(){this.modal.openModal("ACLTypesManagerTypesAddAction",!0).subscribe((e=>{e.instance.currentactions=this.authtypeactions,e.instance.addaction.subscribe((e=>{this.addaction.emit(e)}))}))}deleteAction(e){this.modal.confirm("MSG_DELETE_ACL_ACTION","MSG_DELETE_ACL_ACTION").subscribe((t=>{t&&this.deleteaction.emit(e)}))}static#e=this.ɵfac=function(e){return new(e||ACLTypesManagerTypesActions)(r.rXU(u.H),r.rXU(j.y),r.rXU(f.B),r.rXU(p.g))};static#t=this.ɵcmp=r.VBU({type:ACLTypesManagerTypesActions,selectors:[["acltypes-manager-types-actions"]],inputs:{authtypeactions:"authtypeactions"},outputs:{addaction:"addaction",deleteaction:"deleteaction"},decls:18,vars:1,consts:[[1,"slds-grid","slds-grid--vertical-align-center","slds-p-around--x-small","slds-border--top","slds-border--bottom"],[1,"slds-text-heading--small"],["label","LBL_ACTIONS"],[1,"slds-col--bump-left","slds-button","slds-button--brand",3,"click"],["label","LBL_ADD"],["system-to-bottom",""],[1,"slds-table","slds-table--header-fixed","slds-table_bordered","slds-table_cell-buffer"],[1,"slds-text-title_caps"],["scope","col"],[1,"slds-truncate","slds-th__action"],["label","LBL_ACTION"],["label","DESCRIPTION"],["scope","col",2,"width","3rem"],[4,"ngFor","ngForOf"],[1,"slds-truncate"],[2,"width","3rem"],["icon","delete","size","x-small","addclasses","slds-icon slds-icon-text-default",3,"click"]],template:function(e,t){1&e&&(r.j41(0,"div",0)(1,"h2",1),r.nrm(2,"system-label",2),r.k0s(),r.j41(3,"button",3),r.bIt("click",(function(){return t.addAction()})),r.nrm(4,"system-label",4),r.k0s()(),r.j41(5,"div",5)(6,"table",6)(7,"thead")(8,"tr",7)(9,"th",8)(10,"div",9),r.nrm(11,"system-label",10),r.k0s()(),r.j41(12,"th",8)(13,"div",9),r.nrm(14,"system-label",11),r.k0s()(),r.nrm(15,"th",12),r.k0s()(),r.j41(16,"tbody"),r.DNE(17,G,9,2,"tr",13),r.k0s()()()),2&e&&(r.R7$(17),r.Y8G("ngForOf",t.authtypeactions))},dependencies:[i.Sq,h.W,_.B,L.b],encapsulation:2})}return ACLTypesManagerTypesActions})();function B(e,t){if(1&e){const e=r.RV6();r.j41(0,"tr")(1,"td")(2,"div",8),r.EFF(3),r.k0s()(),r.j41(4,"td",12)(5,"system-utility-icon",13),r.bIt("click",(function(){const t=r.eBV(e).$implicit,s=r.XpG();return r.Njj(s.deleteField(t.id))})),r.k0s()()()}if(2&e){const e=t.$implicit;r.R7$(3),r.JRh(e.name)}}let x=(()=>{class ACLTypesManagerTypesFields{constructor(e,t,s,i){this.backend=e,this.modal=t,this.language=s,this.modelutilities=i,this.authtypefields=[],this.authtypemodule="",this.addfields=new r.bkB,this.deletefield=new r.bkB}addField(){for(let e of this.authtypefields)e.hide=!0;this.modal.openModal("ACLTypesManagerTypesAddFields").subscribe((e=>{e.instance.module=this.authtypemodule,e.instance.currentfields=this.authtypefields,e.instance.addfields.subscribe((e=>{if(e){let t=[];for(let s of e){let e=!1;for(let t in this.authtypefields)this.authtypefields[t].name==s&&(e=!0);e||t.push(s)}this.addfields.emit(t)}}))}))}deleteField(e){this.modal.confirm(this.language.getLabel("MSG_DELETE_ACL_FIELD","","long"),this.language.getLabel("MSG_DELETE_ACL_FIELD","","default")).subscribe((t=>{t&&this.deletefield.emit(e)}))}static#e=this.ɵfac=function(e){return new(e||ACLTypesManagerTypesFields)(r.rXU(u.H),r.rXU(j.y),r.rXU(f.B),r.rXU(p.g))};static#t=this.ɵcmp=r.VBU({type:ACLTypesManagerTypesFields,selectors:[["acltypes-manager-types-fields"]],inputs:{authtypefields:"authtypefields",authtypemodule:"authtypemodule"},outputs:{addfields:"addfields",deletefield:"deletefield"},decls:14,vars:1,consts:[[1,"slds-grid","slds-grid--vertical-align-center","slds-p-around--x-small"],[1,"slds-text-heading--small"],["label","LBL_FIELDS"],[1,"slds-col--bump-left","slds-button","slds-button--brand",3,"click"],["label","LBL_ADD"],[1,"slds-table","slds-table_bordered","slds-table_cell-buffer"],[1,"slds-text-title_caps"],["scope","col"],[1,"slds-truncate"],["label","LBL_FIELD"],["scope","col",2,"width","3rem"],[4,"ngFor","ngForOf"],[2,"width","3rem"],["icon","delete","size","x-small","addclasses","slds-icon slds-icon-text-default",3,"click"]],template:function(e,t){1&e&&(r.j41(0,"div",0)(1,"h2",1),r.nrm(2,"system-label",2),r.k0s(),r.j41(3,"button",3),r.bIt("click",(function(){return t.addField()})),r.nrm(4,"system-label",4),r.k0s()(),r.j41(5,"table",5)(6,"thead")(7,"tr",6)(8,"th",7)(9,"div",8),r.nrm(10,"system-label",9),r.k0s()(),r.nrm(11,"th",10),r.k0s()(),r.j41(12,"tbody"),r.DNE(13,B,6,1,"tr",11),r.k0s()()),2&e&&(r.R7$(13),r.Y8G("ngForOf",t.authtypefields))},dependencies:[i.Sq,h.W,_.B],encapsulation:2})}return ACLTypesManagerTypesFields})();const $=["managercontent"];let U=(()=>{class ACLTypesManager{constructor(e,t,s){this.backend=e,this.modelutilities=t,this.elementRef=s,this.activeType={authtypeid:"",authtypemodule:"",authtypefields:{},authtypeactions:[]},this.activeModule=""}setType(e){this.activeType.authtypeid=e.id,this.activeType.authtypemodule=e.module,this.backend.getRequest("module/SpiceACLObjects/modules/"+e.id).subscribe((e=>{this.activeType.authtypefields=e.authtypefields?e.authtypefields:[],this.activeType.authtypeactions=e.authtypeactions,this.activeType.authtypeactions.sort(((e,t)=>e.action.localeCompare(t.action))),this.sortType()}))}addFields(e){for(let t of e)this.backend.postRequest("module/SpiceACLObjects/modules/"+this.activeType.authtypeid+"/fields/"+t).subscribe((e=>{this.activeType.authtypefields.push(e),this.sortType()}))}deleteField(e){this.backend.deleteRequest("module/SpiceACLObjects/modules/"+this.activeType.authtypeid+"/fields/"+e).subscribe((t=>{this.activeType.authtypefields.some(((t,s)=>{if(t.id==e)return this.activeType.authtypefields.splice(s,1),!0}))}))}addAction(e){this.backend.postRequest("module/SpiceACLObjects/modules/"+this.activeType.authtypeid+"/actions/"+e.action,{},{description:e.description}).subscribe((e=>{this.activeType.authtypeactions.push(e),this.sortType()}))}deleteAction(e){this.backend.deleteRequest("module/SpiceACLObjects/modules/"+this.activeType.authtypeid+"/actions/"+e).subscribe((t=>{this.activeType.authtypeactions.some(((t,s)=>{if(t.id==e)return this.activeType.authtypeactions.splice(s,1),!0}))}))}sortType(){this.activeType.authtypefields.sort(((e,t)=>e.name>t.name)),this.activeType.authtypeactions.sort(((e,t)=>e.action>t.action?1:-1))}static#e=this.ɵfac=function(e){return new(e||ACLTypesManager)(r.rXU(u.H),r.rXU(p.g),r.rXU(r.aKT))};static#t=this.ɵcmp=r.VBU({type:ACLTypesManager,selectors:[["acl-types-manager"]],viewQuery:function(e,t){if(1&e&&r.GBs($,7,r.c1b),2&e){let e;r.mGM(e=r.lsd())&&(t.elementmanagercontent=e.first)}},decls:11,vars:3,consts:[[2,"height","100%"],["displaylabel","LBL_SPICEACLTYPES"],["system-to-bottom-noscroll","",1,"slds-grid"],["managercontent",""],[1,"slds-size--1-of-2","slds-border--right",3,"typeselected"],["system-to-bottom-noscroll","",1,"slds-size--1-of-2"],[1,"slds-scrollable--y",2,"height","50%"],[3,"authtypemodule","authtypefields","addfields","deletefield"],[2,"height","50%"],[3,"authtypeactions","addaction","deleteaction"]],template:function(e,t){1&e&&(r.j41(0,"div",0)(1,"div"),r.nrm(2,"acl-manager-header",1),r.k0s(),r.j41(3,"div",2,3)(5,"acltypes-manager-types",4),r.bIt("typeselected",(function(e){return t.setType(e)})),r.k0s(),r.j41(6,"div",5)(7,"div",6)(8,"acltypes-manager-types-fields",7),r.bIt("addfields",(function(e){return t.addFields(e)}))("deletefield",(function(e){return t.deleteField(e)})),r.k0s()(),r.j41(9,"div",8)(10,"acltypes-manager-types-actions",9),r.bIt("addaction",(function(e){return t.addAction(e)}))("deleteaction",(function(e){return t.deleteAction(e)})),r.k0s()()()()()),2&e&&(r.R7$(8),r.Y8G("authtypemodule",t.activeType.authtypemodule)("authtypefields",t.activeType.authtypefields),r.R7$(2),r.Y8G("authtypeactions",t.activeType.authtypeactions))},dependencies:[m.p,y,M,T,x],encapsulation:2})}return ACLTypesManager})();var X=s(83935),S=s(40713),V=s(25028),D=s(88418),N=s(83524);function Y(e,t){if(1&e){const e=r.RV6();r.j41(0,"div",4),r.bIt("click",(function(t){r.eBV(e);const s=r.XpG().$implicit,i=r.XpG();return r.Njj(i.setFieldValue(s,t))})),r.nrm(1,"input",5),r.j41(2,"label",6),r.nrm(3,"span",7),r.j41(4,"span",8),r.EFF(5),r.k0s()()()}if(2&e){const e=r.XpG().$implicit,t=r.XpG();r.R7$(),r.Y8G("id","id"+e)("checked",t.getFieldValue(e)),r.R7$(),r.BMQ("for","id"+e),r.R7$(3),r.Lme("",t.getFieldDisplayName(e)," / ",e,"")}}function P(e,t){if(1&e&&(r.j41(0,"div",3),r.DNE(1,Y,6,5,"div",15),r.k0s()),2&e){const e=t.$implicit,s=r.XpG();r.R7$(),r.Y8G("ngIf",!s.getFieldDisplay(e))}}let w=(()=>{class ACLTypesManagerTypesAddFields{constructor(e,t,s,i){this.backend=e,this.metadata=t,this.language=s,this.modelutilities=i,this.module="",this.self={},this.currentfields=[],this.selectedfields=[],this.fields=[],this.addfields=new r.bkB,this.showAll=!1,this.selectAllChecked=!1}ngOnInit(){let e=this.metadata.getModuleFields(this.module);this.selectedfields=[];for(let t in e)(this.showAll||this.allowField(e[t]))&&this.fields.push(t);for(let e of this.currentfields)this.selectedfields.push(e.name);this.fields.sort()}allowField(e){return"non-db"!=e.source&&"link"!=e.type&&"relate"!=e.type}getFieldDisplayName(e){return this.language.getFieldDisplayName(this.module,e)}close(){this.self.destroy()}add(){this.addfields.emit(this.selectedfields),this.close()}getFieldDisplay(e){for(let t of this.currentfields)if(t.name==e&&t.hide)return!0;return!1}getFieldValue(e){for(let t of this.selectedfields)if(t==e)return!0;return!1}setFieldValue(e,t){t.preventDefault();let s=!1;for(let t in this.selectedfields)this.selectedfields[t]==e&&(this.selectedfields.splice(+t,1),s=!0);s||this.selectedfields.push(e)}toggleSelectAll(e){if(e.preventDefault(),this.selectAllChecked)this.selectAllChecked=!1,this.selectedfields=[];else{for(let e of this.fields)this.selectedfields.push(e);this.selectAllChecked=!0}}static#e=this.ɵfac=function(e){return new(e||ACLTypesManagerTypesAddFields)(r.rXU(u.H),r.rXU(X.yu),r.rXU(f.B),r.rXU(p.g))};static#t=this.ɵcmp=r.VBU({type:ACLTypesManagerTypesAddFields,selectors:[["acltypes-manager-types-add-fields"]],inputs:{module:"module"},decls:19,vars:5,consts:[[3,"close"],["label","LBL_ADD_FIELD"],[1,"slds-form-element"],[1,"slds-form-element__control"],[1,"slds-checkbox",3,"click"],["type","checkbox",3,"id","checked"],[1,"slds-checkbox__label"],[1,"slds-checkbox_faux"],[1,"slds-form-element__label"],["label","LBL_SELECT_ALL"],["class","slds-form-element__control",4,"ngFor","ngForOf"],[1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_CANCEL"],[1,"slds-button","slds-button--brand",3,"disabled","click"],["label","LBL_ADD"],["class","slds-checkbox",3,"click",4,"ngIf"]],template:function(e,t){1&e&&(r.j41(0,"system-modal")(1,"system-modal-header",0),r.bIt("close",(function(){return t.close()})),r.nrm(2,"system-label",1),r.k0s(),r.j41(3,"system-modal-content")(4,"fieldset",2)(5,"div",3)(6,"div",4),r.bIt("click",(function(e){return t.toggleSelectAll(e)})),r.nrm(7,"input",5),r.j41(8,"label",6),r.nrm(9,"span",7),r.j41(10,"span",8),r.nrm(11,"system-label",9),r.k0s()()()()(),r.j41(12,"fieldset",2),r.DNE(13,P,2,1,"div",10),r.k0s()(),r.j41(14,"system-modal-footer")(15,"button",11),r.bIt("click",(function(){return t.close()})),r.nrm(16,"system-label",12),r.k0s(),r.j41(17,"button",13),r.bIt("click",(function(){return t.add()})),r.nrm(18,"system-label",14),r.k0s()()()),2&e&&(r.R7$(7),r.Y8G("id","select_all")("checked",t.selectAllChecked),r.R7$(),r.BMQ("for","select_all"),r.R7$(5),r.Y8G("ngForOf",t.fields),r.R7$(4),r.Y8G("disabled",t.selectedfields.length<1))},dependencies:[i.Sq,i.bT,h.W,S.D,V.I,D.Q,N.C],encapsulation:2})}return ACLTypesManagerTypesAddFields})(),q=(()=>{class ACLTypesManagerTypesAddAction{constructor(e,t,s,i){this.backend=e,this.metadata=t,this.language=s,this.modelutilities=i,this.self={},this.currentactions=[],this._currentActions=[],this.action="",this.description="",this.addaction=new r.bkB}ngOnInit(){for(let e of this.currentactions)this._currentActions.push(e.action)}close(){this.self.destroy()}get adddisabled(){return""==this.action||this._currentActions.indexOf(this.action)>=0}add(){this.addaction.emit({action:this.action,description:this.description}),this.close()}static#e=this.ɵfac=function(e){return new(e||ACLTypesManagerTypesAddAction)(r.rXU(u.H),r.rXU(X.yu),r.rXU(f.B),r.rXU(p.g))};static#t=this.ɵcmp=r.VBU({type:ACLTypesManagerTypesAddAction,selectors:[["acltypes-manager-types-add-action"]],decls:19,vars:3,consts:[[3,"close"],["label","LBL_ADD_ACTION"],[1,"slds-form-element"],[1,"slds-form-element__label"],["label","LBL_ACTION"],[1,"slds-form-element__control"],["type","text","maxlength","50",1,"slds-input",3,"ngModel","ngModelChange"],["label","LBL_DESCRIPTION"],["type","text","maxlength","255",1,"slds-input",3,"ngModel","ngModelChange"],[1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_CANCEL"],[1,"slds-button","slds-button--brand",3,"disabled","click"],["label","LBL_ADD"]],template:function(e,t){1&e&&(r.j41(0,"system-modal")(1,"system-modal-header",0),r.bIt("close",(function(){return t.close()})),r.nrm(2,"system-label",1),r.k0s(),r.j41(3,"system-modal-content")(4,"div",2)(5,"label",3),r.nrm(6,"system-label",4),r.k0s(),r.j41(7,"div",5)(8,"input",6),r.mxI("ngModelChange",(function(e){return r.DH7(t.action,e)||(t.action=e),e})),r.k0s()()(),r.j41(9,"div",2)(10,"label",3),r.nrm(11,"system-label",7),r.k0s(),r.j41(12,"div",5)(13,"input",8),r.mxI("ngModelChange",(function(e){return r.DH7(t.description,e)||(t.description=e),e})),r.k0s()()()(),r.j41(14,"system-modal-footer")(15,"button",9),r.bIt("click",(function(){return t.close()})),r.nrm(16,"system-label",10),r.k0s(),r.j41(17,"button",11),r.bIt("click",(function(){return t.add()})),r.nrm(18,"system-label",12),r.k0s()()()),2&e&&(r.R7$(8),r.R50("ngModel",t.action),r.R7$(5),r.R50("ngModel",t.description),r.R7$(4),r.Y8G("disabled",t.adddisabled))},dependencies:[l.me,l.BC,l.tU,l.vS,h.W,S.D,V.I,D.Q,N.C],encapsulation:2})}return ACLTypesManagerTypesAddAction})();var z=s(25863);const H=["header"];function J(e,t){if(1&e&&(r.qex(0),r.j41(1,"option",15),r.EFF(2),r.k0s(),r.bVm()),2&e){const e=t.$implicit;r.R7$(),r.Y8G("value",e.id),r.R7$(),r.JRh(e.module)}}function W(e,t){1&e&&(r.j41(0,"div",16),r.nrm(1,"system-spinner"),r.k0s())}function Q(e,t){if(1&e){const e=r.RV6();r.j41(0,"system-utility-icon",33),r.bIt("click",(function(){r.eBV(e);const t=r.XpG().$implicit,s=r.XpG(2);return r.Njj(s.deactivateObject(t.id))})),r.k0s()}}function K(e,t){if(1&e){const e=r.RV6();r.j41(0,"system-utility-icon",34),r.bIt("click",(function(){r.eBV(e);const t=r.XpG().$implicit,s=r.XpG(2);return r.Njj(s.activateObject(t.id))})),r.k0s()}}function Z(e,t){1&e&&r.nrm(0,"system-utility-icon",35)}const ee=e=>({"slds-theme--shade":e}),te=e=>({"slds-hidden":e});function se(e,t){if(1&e){const e=r.RV6();r.j41(0,"tr",26),r.bIt("click",(function(){const t=r.eBV(e).$implicit,s=r.XpG(2);return r.Njj(s.selectObject(t))})),r.j41(1,"td")(2,"div",20),r.EFF(3),r.k0s()(),r.j41(4,"td")(5,"div",20),r.EFF(6),r.k0s()(),r.j41(7,"td")(8,"div",20),r.EFF(9),r.k0s()(),r.j41(10,"td",27)(11,"div",28),r.DNE(12,Q,1,0,"system-utility-icon",29)(13,K,1,0,"system-utility-icon",30),r.nrm(14,"system-utility-icon",31),r.DNE(15,Z,1,0,"system-utility-icon",32),r.k0s()()()}if(2&e){const e=t.$implicit,s=r.XpG(2);r.Y8G("ngClass",r.eq3(8,ee,e.id==s.activeObjectId)),r.R7$(3),r.JRh(e.name),r.R7$(3),r.JRh(s.getType(e.spiceaclobjecttype)),r.R7$(3),r.JRh(e.activity),r.R7$(3),r.Y8G("ngIf","r"==e.status),r.R7$(),r.Y8G("ngIf","r"!=e.status),r.R7$(),r.Y8G("ngClass",r.eq3(10,te,!e.description)),r.R7$(),r.Y8G("ngIf",e.customSQL)}}function ie(e,t){if(1&e&&(r.j41(0,"table",17)(1,"thead")(2,"tr",18)(3,"th",19)(4,"div",20),r.nrm(5,"system-label",21),r.k0s()(),r.j41(6,"th",19)(7,"div",20),r.nrm(8,"system-label",22),r.k0s()(),r.j41(9,"th",19)(10,"div",20),r.nrm(11,"system-label",23),r.k0s()(),r.nrm(12,"th",24),r.k0s()(),r.j41(13,"tbody"),r.DNE(14,se,16,12,"tr",25),r.k0s()()),2&e){const e=r.XpG();r.R7$(14),r.Y8G("ngForOf",e.aclobjects)}}let le=(()=>{class ACLObjectsManagerObjects{constructor(e,t,s){this.backend=e,this.modal=t,this.language=s,this.loading=!1,this.acltypes=[],this.activeTypeId="",this.aclobjects=[],this.activeObjectId="",this.searchterm="",this.objectselected=new r.bkB,this.typeselected=new r.bkB,this.backend.getRequest("module/SpiceACLObjects/modules").subscribe((e=>{this.acltypes=e,this.acltypes.sort(((e,t)=>e.module>t.module?1:-1))}))}keyUp(e){if("Enter"===e.key)this.getObjects()}getObjects(){this.loading=!0,this.aclobjects=[];let e={moduleid:this.activeTypeId,searchterm:this.searchterm};this.backend.getRequest("module/SpiceACLObjects",e).subscribe((e=>{this.aclobjects=e,this.aclobjects.sort(((e,t)=>e.name.localeCompare(t.name))),this.loading=!1}))}get contentStyle(){return{height:"calc(100% - "+this.header.element.nativeElement.getBoundingClientRect().height+"px)"}}getType(e){return this.language.getFieldDisplayOptionValue("SpiceACLObjects","spiceaclobjecttype",e)}selectType(e){this.getObjects(),this.activeObjectId="",this.objectselected.emit(this.activeObjectId),this.typeselected.emit(this.activeTypeId)}addObject(){this.modal.openModal("ACLObjectsManagerAddObjectModal").subscribe((e=>{e.instance.sysmodule_id=this.activeTypeId,e.instance.newObjectData.subscribe((e=>{e&&(this.aclobjects.push(e),this.selectObject(e))}))}))}addDefaultObjects(){if(0==this.aclobjects.length&&this.activeTypeId){this.loading=!0;let e={moduleid:this.activeTypeId,modulename:this.acltypes.find((e=>e.id==this.activeTypeId)).module};this.backend.postRequest("module/SpiceACLObjects/defaultobjects",{},e).subscribe((e=>{this.getObjects(),this.loading=!1}))}}selectObject(e){this.activeObjectId=e.id,this.objectselected.emit(this.activeObjectId)}activateObject(e){this.modal.confirm("LBL_ACTIVATE_OBJECT","LBL_ACTIVATE_OBJECT").subscribe((t=>{t&&this.backend.postRequest("module/SpiceACLObjects/"+e+"/activation").subscribe((t=>{this.aclobjects.some((t=>{if(t.id==e)return t.status="r",!0}))}))}))}deactivateObject(e){this.modal.confirm("LBL_DEACTIVATE_OBJECT","LBL_DEACTIVATE_OBJECT").subscribe((t=>{t&&this.backend.deleteRequest("module/SpiceACLObjects/"+e+"/activation").subscribe((t=>{this.aclobjects.some((t=>{if(t.id==e)return t.status="d",!0}))}))}))}static#e=this.ɵfac=function(e){return new(e||ACLObjectsManagerObjects)(r.rXU(u.H),r.rXU(j.y),r.rXU(f.B))};static#t=this.ɵcmp=r.VBU({type:ACLObjectsManagerObjects,selectors:[["aclobjects-manager-objects"]],viewQuery:function(e,t){if(1&e&&r.GBs(H,7,r.c1b),2&e){let e;r.mGM(e=r.lsd())&&(t.header=e.first)}},outputs:{objectselected:"objectselected",typeselected:"typeselected"},decls:18,vars:10,consts:[[2,"height","100%"],[1,"slds-grid","slds-grid--vertical-align-center","slds-p-around--x-small"],["header",""],[1,"slds-form-element__control","slds-size--1-of-3","slds-p-right--xx-small"],[1,"slds-select_container"],[1,"slds-select",3,"ngModel","disabled","ngModelChange","change"],[4,"ngFor","ngForOf"],["type","text",1,"slds-input",3,"disabled","ngModel","ngModelChange","keyup"],[1,"slds-p-left--xx-small"],[1,"slds-button","slds-button--icon-border",3,"disabled","click"],["icon","new"],["icon","insert_template"],[1,"slds-scrollable",3,"ngStyle"],["class","slds-p-around--medium slds-align--absolute-center",4,"ngIf","ngIfElse"],["typesdisplay",""],[3,"value"],[1,"slds-p-around--medium","slds-align--absolute-center"],[1,"slds-table","slds-table_bordered","slds-table_cell-buffer"],[1,"slds-text-title_caps"],["scope","col"],[1,"slds-truncate"],["label","LBL_NAME"],["label","LBL_TYPE"],["label","LBL_ACTIVITIES"],["scope","col",2,"width","3rem"],[3,"ngClass","click",4,"ngFor","ngForOf"],[3,"ngClass","click"],[2,"width","3rem"],[1,"slds-grid"],["icon","light_bulb","size","x-small","colorclass","slds-icon-text-success",3,"click",4,"ngIf"],["icon","light_bulb","size","x-small","colorclass","slds-icon-text-light",3,"click",4,"ngIf"],["icon","info_alt","size","x-small",3,"ngClass"],["icon","database","size","x-small",4,"ngIf"],["icon","light_bulb","size","x-small","colorclass","slds-icon-text-success",3,"click"],["icon","light_bulb","size","x-small","colorclass","slds-icon-text-light",3,"click"],["icon","database","size","x-small"]],template:function(e,t){if(1&e&&(r.j41(0,"div",0)(1,"div",1,2)(3,"div",3)(4,"div",4)(5,"select",5),r.mxI("ngModelChange",(function(e){return r.DH7(t.activeTypeId,e)||(t.activeTypeId=e),e})),r.bIt("change",(function(e){return t.selectType(e)})),r.DNE(6,J,3,2,"ng-container",6),r.k0s()()(),r.j41(7,"input",7),r.mxI("ngModelChange",(function(e){return r.DH7(t.searchterm,e)||(t.searchterm=e),e})),r.bIt("keyup",(function(e){return t.keyUp(e)})),r.k0s(),r.j41(8,"div",8)(9,"button",9),r.bIt("click",(function(){return t.addObject()})),r.nrm(10,"system-button-icon",10),r.k0s()(),r.j41(11,"div",8)(12,"button",9),r.bIt("click",(function(){return t.addDefaultObjects()})),r.nrm(13,"system-button-icon",11),r.k0s()()(),r.j41(14,"div",12),r.DNE(15,W,2,0,"div",13)(16,ie,15,1,"ng-template",null,14,r.C5r),r.k0s()()),2&e){const e=r.sdS(17);r.R7$(5),r.R50("ngModel",t.activeTypeId),r.Y8G("disabled",0==t.acltypes.length),r.R7$(),r.Y8G("ngForOf",t.acltypes),r.R7$(),r.Y8G("disabled",!t.activeTypeId),r.R50("ngModel",t.searchterm),r.R7$(2),r.Y8G("disabled",!t.activeTypeId),r.R7$(3),r.Y8G("disabled",!t.activeTypeId||t.aclobjects.length>0),r.R7$(2),r.Y8G("ngStyle",t.contentStyle),r.R7$(),r.Y8G("ngIf",t.loading)("ngIfElse",e)}},dependencies:[i.YU,i.Sq,i.bT,i.B3,l.xH,l.y7,l.me,l.wz,l.BC,l.vS,z.t,h.W,v.P,_.B],encapsulation:2})}return ACLObjectsManagerObjects})();var ne=s(35911),oe=s(10650);const ce=["header"],ae=e=>({"slds-is-active":e});function de(e,t){if(1&e){const e=r.RV6();r.j41(0,"li",8),r.bIt("click",(function(){const t=r.eBV(e).$implicit,s=r.XpG(2);return r.Njj(s.switchTab(t.tab))})),r.j41(1,"a",9),r.nrm(2,"system-label",10),r.k0s()()}if(2&e){const e=t.$implicit,s=r.XpG(2);r.Y8G("ngClass",r.eq3(2,ae,e.tab==s.activeTab)),r.R7$(2),r.Y8G("label",e.label)}}function re(e,t){if(1&e&&r.nrm(0,"system-dynamic-component",13),2&e){const e=r.XpG().$implicit;r.Y8G("component",e.component)}}const ue=(e,t)=>({"slds-show":e,"slds-hide":t});function pe(e,t){if(1&e&&(r.j41(0,"div",11),r.DNE(1,re,1,1,"system-dynamic-component",12),r.k0s()),2&e){const e=t.$implicit,s=r.XpG(2);r.Y8G("ngClass",r.l_i(2,ue,e.tab==s.activeTab,e.tab!=s.activeTab)),r.R7$(),r.Y8G("ngIf",e.component)}}function me(e,t){if(1&e){const e=r.RV6();r.j41(0,"div",1)(1,"ul",2),r.DNE(2,de,3,4,"li",3),r.k0s(),r.DNE(3,pe,2,5,"div",4),r.j41(4,"div",5)(5,"button",6),r.bIt("click",(function(){r.eBV(e);const t=r.XpG();return r.Njj(t.save())})),r.nrm(6,"system-label",7),r.k0s()()()}if(2&e){const e=r.XpG();r.R7$(2),r.Y8G("ngForOf",e.tabs),r.R7$(),r.Y8G("ngForOf",e.tabs)}}let fe=(()=>{class ACLObjectsManagerObject{constructor(e,t,s,i){this.metadata=e,this.backend=t,this.model=s,this.language=i,this.objectid="",this.typeid="",this.loaded=!1,this.tabs=[],this.activeTab="",this.model.module="SpiceACLObjects";let l=this.metadata.getComponentConfig("ACLObjectsManagerObject",this.model.module);if(l.componentset){let e=this.metadata.getComponentSetObjects(l.componentset);for(let t of e)this.tabs.push({tab:t.id,label:t.componentconfig.name,component:t.component}),this.activeTab||(this.activeTab=t.id)}}switchTab(e){this.activeTab=e}ngOnChanges(){this.loaded=!1,this.objectid&&(this.model.id=this.objectid,this.model.getData(!0).subscribe((e=>{this.loaded=!0})))}save(){this.model.save(!0)}static#e=this.ɵfac=function(e){return new(e||ACLObjectsManagerObject)(r.rXU(X.yu),r.rXU(u.H),r.rXU(ne.g),r.rXU(f.B))};static#t=this.ɵcmp=r.VBU({type:ACLObjectsManagerObject,selectors:[["aclobjects-manager-object"]],viewQuery:function(e,t){if(1&e&&r.GBs(ce,7,r.c1b),2&e){let e;r.mGM(e=r.lsd())&&(t.header=e.first)}},inputs:{objectid:"objectid",typeid:"typeid"},features:[r.Jv_([ne.g]),r.OA$],decls:1,vars:1,consts:[["class","slds-tabs_scoped","style","height: 100%;",4,"ngIf"],[1,"slds-tabs_scoped",2,"height","100%"],["role","tablist",1,"slds-tabs_scoped__nav"],["class","slds-tabs_scoped__item",3,"ngClass","click",4,"ngFor","ngForOf"],["class","slds-tabs_scoped__content","role","tabpanel",3,"ngClass",4,"ngFor","ngForOf"],[1,"slds-grid","slds-grid--align-center","slds-p-around--xx-small"],[1,"slds-button","slds-button--brand",3,"click"],["label","LBL_SAVE"],[1,"slds-tabs_scoped__item",3,"ngClass","click"],["href","javascript:void(0);","role","tab",1,"slds-tabs_scoped__link"],[3,"label"],["role","tabpanel",1,"slds-tabs_scoped__content",3,"ngClass"],[3,"component",4,"ngIf"],[3,"component"]],template:function(e,t){1&e&&r.DNE(0,me,7,2,"div",0),2&e&&r.Y8G("ngIf",t.loaded)},dependencies:[i.YU,i.Sq,i.bT,oe.s,h.W],encapsulation:2})}return ACLObjectsManagerObject})();const be=["managercontent"];let he=(()=>{class ACLObjectsManager{constructor(e,t){this.modelutilities=e,this.elementRef=t,this.activeobjectid="",this.activetypeid=""}get contentStyle(){return{height:"calc(100% - "+this.elementmanagercontent.element.nativeElement.getBoundingClientRect().top+"px"}}setObject(e){this.activeobjectid=e}setType(e){this.activetypeid=e}static#e=this.ɵfac=function(e){return new(e||ACLObjectsManager)(r.rXU(p.g),r.rXU(r.aKT))};static#t=this.ɵcmp=r.VBU({type:ACLObjectsManager,selectors:[["ng-component"]],viewQuery:function(e,t){if(1&e&&r.GBs(be,7,r.c1b),2&e){let e;r.mGM(e=r.lsd())&&(t.elementmanagercontent=e.first)}},decls:7,vars:2,consts:[[2,"height","100%"],["displaylabel","LBL_SPICEACLOBJECTS"],[1,"slds-grid",3,"ngStyle"],["managercontent",""],[1,"slds-size--1-of-2","slds-border--right",3,"typeselected","objectselected"],[1,"slds-size--1-of-2",2,"height","100%",3,"objectid"]],template:function(e,t){1&e&&(r.j41(0,"div",0)(1,"div"),r.nrm(2,"acl-manager-header",1),r.k0s(),r.j41(3,"div",2,3)(5,"aclobjects-manager-objects",4),r.bIt("typeselected",(function(e){return t.setType(e)}))("objectselected",(function(e){return t.setObject(e)})),r.k0s(),r.nrm(6,"aclobjects-manager-object",5),r.k0s()()),2&e&&(r.R7$(3),r.Y8G("ngStyle",t.contentStyle),r.R7$(3),r.Y8G("objectid",t.activeobjectid))},dependencies:[i.B3,y,le,fe],encapsulation:2})}return ACLObjectsManager})();var ge=s(41731),ye=s(3719);let je=(()=>{class ACLObjectsManagerAddObjectModal{constructor(e,t,s,i){this.metadata=e,this.model=t,this.view=s,this.language=i,this.self={},this.fieldset="",this.sysmodule_id="",this.newObjectData=new r.bkB,this.model.module="SpiceACLObjects",this.model.initialize(),this.model.setField("status","d"),this.view.isEditable=!0,this.view.setEditMode();let l=this.metadata.getComponentConfig("ACLObjectsManagerAddObjectModal");this.fieldset=l.fieldset}ngOnInit(){this.model.setField("sysmodule_id",this.sysmodule_id)}close(){this.self.destroy()}save(){this.model.save().subscribe((e=>{this.newObjectData.emit(this.model.data),this.close()}))}static#e=this.ɵfac=function(e){return new(e||ACLObjectsManagerAddObjectModal)(r.rXU(X.yu),r.rXU(ne.g),r.rXU(ge.U),r.rXU(f.B))};static#t=this.ɵcmp=r.VBU({type:ACLObjectsManagerAddObjectModal,selectors:[["aclobjects-manager-add-object-modal"]],inputs:{sysmodule_id:"sysmodule_id"},outputs:{newObjectData:"newObjectData"},features:[r.Jv_([ne.g,ge.U])],decls:10,vars:1,consts:[[3,"close"],["label","LBL_ADD_OBJECT"],["margin","none"],["direction","vertical",3,"fieldset"],[1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_CANCEL"],[1,"slds-button","slds-button--brand",3,"click"],["label","LBL_SAVE"]],template:function(e,t){1&e&&(r.j41(0,"system-modal")(1,"system-modal-header",0),r.bIt("close",(function(){return t.close()})),r.nrm(2,"system-label",1),r.k0s(),r.j41(3,"system-modal-content",2),r.nrm(4,"object-record-fieldset",3),r.k0s(),r.j41(5,"system-modal-footer")(6,"button",4),r.bIt("click",(function(){return t.close()})),r.nrm(7,"system-label",5),r.k0s(),r.j41(8,"button",6),r.bIt("click",(function(){return t.save()})),r.nrm(9,"system-label",7),r.k0s()()()),2&e&&(r.R7$(4),r.Y8G("fieldset",t.fieldset))},dependencies:[ye.D,h.W,S.D,V.I,D.Q,N.C],encapsulation:2})}return ACLObjectsManagerAddObjectModal})();var ke=s(84359);function ve(e,t){if(1&e){const e=r.RV6();r.j41(0,"system-checkbox",11),r.bIt("ngModelChange",(function(t){const s=r.eBV(e).$implicit,i=r.XpG(2);return r.Njj(i.setActionValue(s.id,t))})),r.nrm(1,"system-label",12),r.k0s()}if(2&e){const e=t.$implicit,s=r.XpG(2);r.Y8G("ngModel",s.getActionValue(e.id)),r.R7$(),r.Y8G("label",e.action)}}function _e(e,t){if(1&e){const e=r.RV6();r.j41(0,"system-checkbox",13),r.bIt("ngModelChange",(function(t){const s=r.eBV(e).$implicit,i=r.XpG(2);return r.Njj(i.setActionValue(s.id,t))})),r.nrm(1,"system-label",12),r.k0s()}if(2&e){const e=t.$implicit,s=r.XpG(2);r.Y8G("title",e.description?e.description:e.action)("ngModel",s.getActionValue(e.id)),r.R7$(),r.Y8G("label",e.action)}}function Le(e,t){if(1&e&&(r.j41(0,"div",5)(1,"h2",1),r.nrm(2,"system-label",6),r.k0s(),r.j41(3,"div",7)(4,"div",8),r.DNE(5,ve,2,2,"system-checkbox",9),r.k0s(),r.j41(6,"div",8),r.DNE(7,_e,2,3,"system-checkbox",10),r.k0s()()()),2&e){const e=r.XpG();r.R7$(5),r.Y8G("ngForOf",e.standardactions),r.R7$(2),r.Y8G("ngForOf",e.objectactions)}}let Ce=(()=>{class ACLObjectsManagerObjectDetails{constructor(e,t,s,i,l){this.view=e,this.metadata=t,this.model=s,this.language=i,this.backend=l,this.fieldset="",this.standardactions=[{id:"list",action:"LBL_LIST"},{id:"listrelated",action:"LBL_LISTRELATED"},{id:"view",action:"LBL_VIEW"},{id:"editrelated",action:"LBL_EDITRELATION"},{id:"edit",action:"LBL_EDIT"},{id:"create",action:"LBL_CREATE"},{id:"deleterelated",action:"LBL_REMOVERELATION"},{id:"delete",action:"LBL_DELETE"},{id:"export",action:"LBL_EXPORT"},{id:"import",action:"LBL_IMPORT"},{id:"massupdate",action:"LBL_MASSUPDATE"},{id:"moduleadmin",action:"LBL_MODULEADMIN"}],this.objectactions=[],this.view.isEditable=!0,this.view.setEditMode();let n=this.metadata.getComponentConfig("ACLObjectsManagerObjectDetails","SpiceACLObjects");this.fieldset=n.fieldset}ngOnInit(){this.backend.getRequest("module/SpiceACLObjects/modules/"+this.model.getFieldValue("sysmodule_id")+"/actions").subscribe((e=>{this.objectactions=e,this.objectactions.sort(((e,t)=>e.action.localeCompare(t.action)))}))}get showActions(){return"0"==this.model.getFieldValue("spiceaclobjecttype")||"3"==this.model.getFieldValue("spiceaclobjecttype")||"6"==this.model.getFieldValue("spiceaclobjecttype")}getActionValue(e){let t=this.model.getFieldValue("objectactions");for(let s of t)if(s.spiceaclaction_id==e)return!0;return!1}setActionValue(e,t){let s=this.model.getFieldValue("objectactions");if(t)s.push({spiceaclobject_id:this.model.id,spiceaclaction_id:e});else{let t=s.findIndex((t=>t.spiceaclaction_id==e));s.splice(t,1)}}static#e=this.ɵfac=function(e){return new(e||ACLObjectsManagerObjectDetails)(r.rXU(ge.U),r.rXU(X.yu),r.rXU(ne.g),r.rXU(f.B),r.rXU(u.H))};static#t=this.ɵcmp=r.VBU({type:ACLObjectsManagerObjectDetails,selectors:[["aclobjects-manager-object-details"]],features:[r.Jv_([ge.U])],decls:5,vars:2,consts:[[1,"slds-box--border"],[1,"slds-text-heading--small","slds-p-around--x-small"],["label","LBL_DETAILS"],["direction","vertical",3,"fieldset"],["class","slds-box--border slds-m-vertical--x-small",4,"ngIf"],[1,"slds-box--border","slds-m-vertical--x-small"],["label","LBL_OBJECT_ACTIONS"],[1,"slds-grid","slds-p-horizontal--small","slds-p-bottom--x-small"],[1,"slds-size--1-of-2","slds-grid","slds-grid--vertical"],[3,"ngModel","ngModelChange",4,"ngFor","ngForOf"],[3,"title","ngModel","ngModelChange",4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"],[3,"label"],[3,"title","ngModel","ngModelChange"]],template:function(e,t){1&e&&(r.j41(0,"div",0)(1,"h2",1),r.nrm(2,"system-label",2),r.k0s(),r.nrm(3,"object-record-fieldset",3),r.k0s(),r.DNE(4,Le,8,2,"div",4)),2&e&&(r.R7$(3),r.Y8G("fieldset",t.fieldset),r.R7$(),r.Y8G("ngIf",t.showActions))},dependencies:[i.Sq,i.bT,l.BC,l.vS,ye.D,ke.f,h.W],encapsulation:2})}return ACLObjectsManagerObjectDetails})();function Ie(e,t){if(1&e){const e=r.RV6();r.j41(0,"tr")(1,"td")(2,"div",7),r.EFF(3),r.k0s()(),r.j41(4,"td")(5,"div",13)(6,"div",14)(7,"select",15),r.bIt("change",(function(t){const s=r.eBV(e).$implicit,i=r.XpG(2);return r.Njj(i.setFieldValue("operator",s.id,"change",t))})),r.j41(8,"option",16),r.EFF(9,"ignore"),r.k0s(),r.j41(10,"option",17),r.EFF(11,"="),r.k0s(),r.j41(12,"option",18),r.EFF(13,"≠"),r.k0s(),r.j41(14,"option",19),r.EFF(15,">"),r.k0s(),r.j41(16,"option",20),r.EFF(17,"≥"),r.k0s(),r.j41(18,"option",21),r.EFF(19,"<"),r.k0s(),r.j41(20,"option",22),r.EFF(21,"≤"),r.k0s(),r.j41(22,"option",23),r.EFF(23,"Like"),r.k0s(),r.j41(24,"option",24),r.EFF(25,"in"),r.k0s(),r.j41(26,"option",25),r.EFF(27,"not in"),r.k0s(),r.j41(28,"option",26),r.EFF(29,"is emtpy"),r.k0s(),r.j41(30,"option",27),r.EFF(31,"is not emtpy"),r.k0s(),r.j41(32,"option",28),r.EFF(33,"starts with"),r.k0s(),r.j41(34,"option",29),r.EFF(35,"does not start with"),r.k0s(),r.j41(36,"option",30),r.EFF(37,"Current User Field"),r.k0s()()()()(),r.j41(38,"td")(39,"div",13)(40,"input",31),r.bIt("blur",(function(t){const s=r.eBV(e).$implicit,i=r.XpG(2);return r.Njj(i.setFieldValue("value1",s.id,"blur",t))})),r.k0s()()(),r.j41(41,"td")(42,"div",13)(43,"input",32),r.bIt("change",(function(t){const s=r.eBV(e).$implicit,i=r.XpG(2);return r.Njj(i.setFieldValue("value2",s.id,"change",t))})),r.k0s()()(),r.j41(44,"td")(45,"system-utility-icon",33),r.bIt("click",(function(){const t=r.eBV(e).$implicit,s=r.XpG(2);return r.Njj(s.resetid(t.id))})),r.k0s()()()}if(2&e){const e=t.$implicit,s=r.XpG(2);r.R7$(3),r.JRh(e.name),r.R7$(4),r.Y8G("value",s.getFieldValue("operator",e.id)),r.R7$(33),r.Y8G("value",s.getFieldValue("value1",e.id)),r.R7$(3),r.Y8G("value",s.getFieldValue("value2",e.id))}}function Ae(e,t){if(1&e&&(r.j41(0,"div",3)(1,"table",4)(2,"thead")(3,"tr",5)(4,"th",6)(5,"div",7),r.nrm(6,"system-label",8),r.k0s()(),r.j41(7,"th",6)(8,"div",7),r.nrm(9,"system-label",9),r.k0s()(),r.j41(10,"th",6)(11,"div",7),r.nrm(12,"system-label",10),r.k0s()(),r.j41(13,"th",6)(14,"div",7),r.nrm(15,"system-label",11),r.k0s()(),r.nrm(16,"th",6),r.k0s()(),r.j41(17,"tbody"),r.DNE(18,Ie,46,4,"tr",12),r.k0s()()()),2&e){const e=r.XpG();r.R7$(18),r.Y8G("ngForOf",e.fields)}}let Re=(()=>{class ACLObjectsManagerObjectFieldvalues{constructor(e,t,s,i,l,n){this.backend=e,this.view=t,this.metadata=s,this.model=i,this.language=l,this.modelutilities=n,this.fields=[],this.fieldset="",this.loadedtype="",this.view.isEditable=!0,this.view.setEditMode(),this.handleType();let o=this.metadata.getComponentConfig("ACLObjectsManagerObjectFieldvalues","SpiceACLObjects");this.fieldset=o.fieldset}handleType(){let e=this.model.getFieldValue("sysmodule_id");e&&this.loadedtype!=e&&(this.loadedtype=e,this.backend.getRequest("module/SpiceACLObjects/modules/"+e).subscribe((e=>{this.fields=e.authtypefields})))}getFieldValue(e,t){let s=this.model.getFieldValue("fieldvalues");if(s&&s.length>0)for(let i of s)if(i.spiceaclmodulefield_id==t)return i[e];return""}setFieldValue(e,t,s,i){let l=this.model.getFieldValue("fieldvalues");if(l&&l.length>0)for(let s of l)if(s.spiceaclmodulefield_id==t)return void(s[e]=i.currentTarget.value);let n={spiceaclobject_id:this.model.id,spiceaclmodulefield_id:t,operator:"",value1:"",value2:""};n[e]=i.currentTarget.value,l.push(n)}resetid(e){let t=0,s=this.model.getFieldValue("fieldvalues");if(s&&s.length>0)for(let i of s){if(i.spiceaclmodulefield_id==e)return void s.splice(t,1);t++}}static#e=this.ɵfac=function(e){return new(e||ACLObjectsManagerObjectFieldvalues)(r.rXU(u.H),r.rXU(ge.U),r.rXU(X.yu),r.rXU(ne.g),r.rXU(f.B),r.rXU(p.g))};static#t=this.ɵcmp=r.VBU({type:ACLObjectsManagerObjectFieldvalues,selectors:[["aclobjects-manager-object-fieldvalues"]],features:[r.Jv_([ge.U])],decls:3,vars:2,consts:[["class","slds-box",4,"ngIf"],[1,"slds-p-top--small"],["direction","vertical",3,"fieldset"],[1,"slds-box"],[1,"slds-table","slds-table_bordered","slds-table_cell-buffer"],[1,"slds-text-title_caps"],["scope","col"],[1,"slds-truncate"],["label","LBL_NAME"],["label","LBL_OPERATOR"],["label","LBL_VALUE1"],["label","LBL_VALUE2"],[4,"ngFor","ngForOf"],[1,"slds-form-element__control"],[1,"slds-select_container"],[1,"slds-select",3,"value","change"],["value",""],["value","EQ"],["value","NE"],["value","GT"],["value","GTE"],["value","LT"],["value","LTE"],["value","LK"],["value","IN"],["value","NI"],["value","ISEMPTY"],["value","ISNEMPTY"],["value","SW"],["value","SN"],["value","CU"],["type","text",1,"slds-input",3,"value","blur"],["type","text",1,"slds-input",3,"value","change"],["icon","clear","size","x-small",3,"click"]],template:function(e,t){1&e&&(r.DNE(0,Ae,19,1,"div",0),r.j41(1,"div",1),r.nrm(2,"object-record-fieldset",2),r.k0s()),2&e&&(r.Y8G("ngIf",t.fields.length>0),r.R7$(2),r.Y8G("fieldset",t.fieldset))},dependencies:[i.Sq,i.bT,l.xH,l.y7,ye.D,h.W,_.B],encapsulation:2})}return ACLObjectsManagerObjectFieldvalues})();function Oe(e,t){if(1&e){const e=r.RV6();r.j41(0,"tr")(1,"td")(2,"div",6),r.EFF(3),r.k0s()(),r.j41(4,"td")(5,"div",12)(6,"div",13)(7,"select",14),r.bIt("change",(function(t){const s=r.eBV(e).$implicit,i=r.XpG(2);return r.Njj(i.setFieldControl(s.field,t))})),r.j41(8,"option",15),r.nrm(9,"system-label",16),r.k0s(),r.j41(10,"option",17),r.nrm(11,"system-label",18),r.k0s(),r.j41(12,"option",19),r.nrm(13,"system-label",20),r.k0s()()()()(),r.j41(14,"td")(15,"system-utility-icon",21),r.bIt("click",(function(){const t=r.eBV(e).$implicit,s=r.XpG(2);return r.Njj(s.removeField(t.field))})),r.k0s()()()}if(2&e){const e=t.$implicit,s=r.XpG(2);r.R7$(3),r.JRh(e.field),r.R7$(4),r.Y8G("value",s.getFieldControl(e.field))}}function Fe(e,t){if(1&e){const e=r.RV6();r.j41(0,"div",2)(1,"table",3)(2,"thead")(3,"tr",4)(4,"th",5)(5,"div",6),r.nrm(6,"system-label",7),r.k0s()(),r.j41(7,"th",5)(8,"div",6),r.nrm(9,"system-label",8),r.k0s()(),r.nrm(10,"th",5),r.k0s()(),r.j41(11,"tbody"),r.DNE(12,Oe,16,2,"tr",9),r.k0s()(),r.j41(13,"div",10)(14,"system-utility-icon",11),r.bIt("click",(function(){r.eBV(e);const t=r.XpG();return r.Njj(t.addField())})),r.k0s()()()}if(2&e){const e=r.XpG();r.R7$(12),r.Y8G("ngForOf",e.fields)}}function Ee(e,t){1&e&&(r.j41(0,"div",22),r.nrm(1,"system-label",23),r.k0s())}let Me=(()=>{class ACLObjectsManagerObjectFields{constructor(e,t,s){this.modal=e,this.model=t,this.language=s}get fields(){let e=[],t=this.model.getFieldValue("fieldcontrols");if(t)for(let s of t)e.push(s);return e}get showFieldControls(){return"0"==this.model.getFieldValue("spiceaclobjecttype")||"3"==this.model.getFieldValue("spiceaclobjecttype")}getFieldControl(e){let t=this.model.getFieldValue("fieldcontrols");for(let s of t)if(s.field==e)return s.control;return""}setFieldControl(e,t){let s=this.model.getFieldValue("fieldcontrols");for(let i of s)i.field==e&&(i.control=t.currentTarget.value)}removeField(e){let t=this.model.getFieldValue("fieldcontrols"),s=0;for(let i of t){if(i.field==e)return t.splice(s,1),void this.model.setField("fieldcontrols",t);s++}}addField(){let e=this.model.getFieldValue("spiceacltype_module"),t=[],s=this.model.getFieldValue("fieldcontrols");for(let e of s)t.push({name:e.field,id:e.id});this.modal.openModal("ACLTypesManagerTypesAddFields",!0).subscribe((s=>{s.instance.module=e,s.instance.currentfields=t,s.instance.showAll=!0,s.instance.addfields.subscribe((e=>{if(e){let t=this.model.getFieldValue("fieldcontrols"),s=[];for(let i of e){let e=!1;for(let l in t)t[l].field==i&&(e=!0,s.push(t[l]));e||s.push({spiceaclobject_id:this.model.id,field:i,control:1})}t=s,this.model.setField("fieldcontrols",t)}}))}))}static#e=this.ɵfac=function(e){return new(e||ACLObjectsManagerObjectFields)(r.rXU(j.y),r.rXU(ne.g),r.rXU(f.B))};static#t=this.ɵcmp=r.VBU({type:ACLObjectsManagerObjectFields,selectors:[["aclobjects-manager-object-fields"]],decls:3,vars:2,consts:[["class","slds-box",4,"ngIf","ngIfElse"],["nofieldcontrols",""],[1,"slds-box"],[1,"slds-table","slds-table_bordered","slds-table_cell-buffer"],[1,"slds-text-title_caps"],["scope","col"],[1,"slds-truncate"],["label","LBL_NAME"],["label","LBL_CONTROL"],[4,"ngFor","ngForOf"],[1,"slds-align_absolute-center","slds-p-top--medium"],["icon","new","size","x-small",3,"click"],[1,"slds-form-element__control"],[1,"slds-select_container"],[1,"slds-select",3,"value","change"],["value","1"],["label","LBL_HIDE"],["value","2"],["label","LBL_DISPLAY"],["value","3"],["label","LBL_EDIT"],["icon","clear","size","x-small",1,"slds-float--right",3,"click"],[1,"slds-p-around--medium","slds-align_absolute-center"],["label","LBL_NOFIELDCONTROLSFORTHISTYPE"]],template:function(e,t){if(1&e&&r.DNE(0,Fe,15,1,"div",0)(1,Ee,2,0,"ng-template",null,1,r.C5r),2&e){const e=r.sdS(2);r.Y8G("ngIf",t.showFieldControls)("ngIfElse",e)}},dependencies:[i.Sq,i.bT,l.xH,l.y7,h.W,_.B],encapsulation:2})}return ACLObjectsManagerObjectFields})();function Ge(e,t){1&e&&(r.j41(0,"div",8),r.nrm(1,"system-spinner"),r.k0s())}function Te(e,t){if(1&e){const e=r.RV6();r.j41(0,"system-utility-icon",21),r.bIt("click",(function(){r.eBV(e);const t=r.XpG().$implicit,s=r.XpG(2);return r.Njj(s.deactivateProfile(t.id))})),r.k0s()}}function Be(e,t){if(1&e){const e=r.RV6();r.j41(0,"system-utility-icon",22),r.bIt("click",(function(){r.eBV(e);const t=r.XpG().$implicit,s=r.XpG(2);return r.Njj(s.activateProfile(t.id))})),r.k0s()}}const xe=e=>({"slds-theme--shade":e});function $e(e,t){if(1&e){const e=r.RV6();r.j41(0,"tr",16),r.bIt("click",(function(){const t=r.eBV(e).$implicit,s=r.XpG(2);return r.Njj(s.selectProfile(t))})),r.j41(1,"td",12)(2,"div"),r.EFF(3),r.k0s()(),r.j41(4,"td",17)(5,"div",18),r.DNE(6,Te,1,0,"system-utility-icon",19)(7,Be,1,0,"system-utility-icon",20),r.k0s()()()}if(2&e){const e=t.$implicit,s=r.XpG(2);r.Y8G("ngClass",r.eq3(4,xe,e.id==s.activeProfileId)),r.R7$(3),r.JRh(e.name),r.R7$(3),r.Y8G("ngIf","r"==e.status),r.R7$(),r.Y8G("ngIf","r"!=e.status)}}function Ue(e,t){if(1&e&&(r.j41(0,"table",9)(1,"thead")(2,"tr",10)(3,"th",11)(4,"div",12),r.nrm(5,"system-label",13),r.k0s()(),r.nrm(6,"th",14),r.k0s()(),r.j41(7,"tbody"),r.DNE(8,$e,8,6,"tr",15),r.k0s()()),2&e){const e=r.XpG();r.R7$(8),r.Y8G("ngForOf",e.aclprofiles)}}let Xe=(()=>{class ACLProfilesManagerProfiles{constructor(e,t,s,i){this.backend=e,this.modal=t,this.language=s,this.modelutilities=i,this.loading=!1,this.aclprofiles=[],this.activeProfile={},this.activeProfileId="",this.searchterm="",this.profileselected=new r.bkB,this.getProfiles()}keyUp(e){if("Enter"===e.key)this.getProfiles()}getProfiles(){this.loading=!0,this.aclprofiles=[],this.activeProfileId="",this.profileselected.emit(this.activeProfileId);let e={fields:["id","name","description","status","for_portal_users"],searchterm:this.searchterm,limit:"-99"};this.backend.getRequest("module/SpiceACLProfiles",e).subscribe((e=>{this.aclprofiles=e.list,this.aclprofiles.sort(((e,t)=>e.name>t.name?1:-1)),this.aclprofiles.forEach((e=>{e.hasOwnProperty("for_portal_users")&&(e.for_portal_users=this.modelutilities.backend2spice("SpiceACLProfiles","for_portal_users",e.for_portal_users))})),this.loading=!1}))}addProfile(){this.modal.openModal("ACLProfilesManagerAddProfileModal").subscribe((e=>{e.instance.newObjectData.subscribe((e=>{e&&(this.aclprofiles.push(e),this.selectProfile(e))}))}))}selectProfile(e){this.activeProfile=e,this.activeProfileId=e.id,this.profileselected.emit(this.activeProfile)}activateProfile(e){this.modal.confirm("LBL_ACTIVATE_PROFILE","LBL_ACTIVATE_PROFILE").subscribe((t=>{t&&this.backend.postRequest("module/SpiceACLProfiles/"+e+"/activation").subscribe((t=>{this.aclprofiles.some((t=>{if(t.id==e)return t.status="r",!0}))}))}))}deactivateProfile(e){this.modal.confirm("LBL_DEACTIVATE_PROFILE","LBL_DEACTIVATE_PROFILE").subscribe((t=>{t&&this.backend.deleteRequest("module/SpiceACLProfiles/"+e+"/activation").subscribe((t=>{this.aclprofiles.some((t=>{if(t.id==e)return t.status="d",!0}))}))}))}static#e=this.ɵfac=function(e){return new(e||ACLProfilesManagerProfiles)(r.rXU(u.H),r.rXU(j.y),r.rXU(f.B),r.rXU(p.g))};static#t=this.ɵcmp=r.VBU({type:ACLProfilesManagerProfiles,selectors:[["aclprofiles-manager-profiles"]],outputs:{profileselected:"profileselected"},decls:9,vars:3,consts:[[1,"slds-grid","slds-grid--vertical-align-center","slds-p-around--x-small"],["type","text",1,"slds-input",3,"ngModel","ngModelChange","keyup"],[1,"slds-p-left--xx-small"],[1,"slds-button","slds-button--icon-border",3,"click"],["icon","new"],["system-to-bottom",""],["class","slds-p-around--medium slds-align--absolute-center",4,"ngIf","ngIfElse"],["profilesdisplay",""],[1,"slds-p-around--medium","slds-align--absolute-center"],[1,"slds-table","slds-table_bordered","slds-table_cell-buffer"],[1,"slds-text-title_caps"],["scope","col",1,"slds-truncate"],[1,"slds-truncate"],["label","LBL_NAME"],["scope","col",2,"width","3rem"],[3,"ngClass","click",4,"ngFor","ngForOf"],[3,"ngClass","click"],[2,"width","3rem"],[1,"slds-grid"],["icon","light_bulb","colorclass","slds-icon-text-success","size","x-small","addclasses","slds-icon slds-icon-text-default",3,"click",4,"ngIf"],["icon","light_bulb","colorclass","slds-icon-text-light","size","x-small","addclasses","slds-icon slds-icon-text-light",3,"click",4,"ngIf"],["icon","light_bulb","colorclass","slds-icon-text-success","size","x-small","addclasses","slds-icon slds-icon-text-default",3,"click"],["icon","light_bulb","colorclass","slds-icon-text-light","size","x-small","addclasses","slds-icon slds-icon-text-light",3,"click"]],template:function(e,t){if(1&e&&(r.j41(0,"div",0)(1,"input",1),r.mxI("ngModelChange",(function(e){return r.DH7(t.searchterm,e)||(t.searchterm=e),e})),r.bIt("keyup",(function(e){return t.keyUp(e)})),r.k0s(),r.j41(2,"div",2)(3,"button",3),r.bIt("click",(function(){return t.addProfile()})),r.nrm(4,"system-button-icon",4),r.k0s()()(),r.j41(5,"div",5),r.DNE(6,Ge,2,0,"div",6)(7,Ue,9,1,"ng-template",null,7,r.C5r),r.k0s()),2&e){const e=r.sdS(8);r.R7$(),r.R50("ngModel",t.searchterm),r.R7$(5),r.Y8G("ngIf",t.loading)("ngIfElse",e)}},dependencies:[i.YU,i.Sq,i.bT,l.me,l.BC,l.vS,z.t,h.W,v.P,_.B,L.b],encapsulation:2})}return ACLProfilesManagerProfiles})();var Se=s(63983),Ve=s(49380),De=s(66589),Ne=s(33325),Ye=s(22465);let Pe=(()=>{class ACLUsersFilterPipe{transform(e,t){return e.filter((e=>!t||e.user_name.toLowerCase().includes(t.toLowerCase())))}static#e=this.ɵfac=function(e){return new(e||ACLUsersFilterPipe)};static#t=this.ɵpipe=r.EJ8({name:"filterACLUsers",type:ACLUsersFilterPipe,pure:!1})}return ACLUsersFilterPipe})();function we(e,t){1&e&&(r.j41(0,"div",2)(1,"span",3),r.EFF(2,"Please select a profile"),r.k0s()())}function qe(e,t){1&e&&(r.j41(0,"div",20),r.nrm(1,"system-spinner"),r.k0s())}function ze(e,t){1&e&&r.nrm(0,"system-custom-icon",37)}function He(e,t){1&e&&r.nrm(0,"system-custom-icon",38)}function Je(e,t){if(1&e){const e=r.RV6();r.j41(0,"tr")(1,"td")(2,"div",24),r.EFF(3),r.k0s()(),r.j41(4,"td")(5,"div",24),r.EFF(6),r.k0s()(),r.j41(7,"td",32)(8,"div",33),r.DNE(9,ze,1,0,"system-custom-icon",34)(10,He,1,0,"system-custom-icon",35),r.j41(11,"system-utility-icon",36),r.bIt("click",(function(){const t=r.eBV(e).$implicit,s=r.XpG(4);return r.Njj(s.removeProfile(t.id))})),r.k0s()()()()}if(2&e){const e=t.$implicit;r.R7$(3),r.JRh(e.module),r.R7$(3),r.JRh(e.name),r.R7$(3),r.Y8G("ngIf","r"==e.status),r.R7$(),r.Y8G("ngIf","r"!=e.status)}}function We(e,t){if(1&e){const e=r.RV6();r.j41(0,"table",21)(1,"thead")(2,"tr",22)(3,"th",23)(4,"div",24),r.nrm(5,"system-label",25),r.k0s()(),r.j41(6,"th",23)(7,"div",24),r.nrm(8,"system-label",26),r.k0s()(),r.nrm(9,"th",27),r.k0s()(),r.j41(10,"tbody"),r.DNE(11,Je,12,4,"tr",28),r.k0s()(),r.j41(12,"div",29)(13,"button",30),r.bIt("click",(function(){r.eBV(e);const t=r.XpG(3);return r.Njj(t.selectProfile())})),r.nrm(14,"system-button-icon",31),r.k0s()()}if(2&e){const e=r.XpG(3);r.R7$(11),r.Y8G("ngForOf",e.aclobjects)}}function Qe(e,t){if(1&e&&(r.j41(0,"div",17),r.DNE(1,qe,2,0,"div",18)(2,We,15,1,"ng-template",null,19,r.C5r),r.k0s()),2&e){const e=r.sdS(3),t=r.XpG(2);r.R7$(),r.Y8G("ngIf",t.loadingobjects)("ngIfElse",e)}}function Ke(e,t){1&e&&(r.j41(0,"div",20),r.nrm(1,"system-spinner",40),r.k0s())}function Ze(e,t){if(1&e){const e=r.RV6();r.j41(0,"div",33)(1,"system-utility-icon",36),r.bIt("click",(function(t){r.eBV(e);const s=r.XpG().$implicit,i=r.XpG(5);return r.Njj(i.removeUser(s.id,t))})),r.k0s()()}}function et(e,t){if(1&e&&(r.j41(0,"tr")(1,"td")(2,"div",24)(3,"span",51),r.EFF(4),r.k0s()()(),r.j41(5,"td",32),r.DNE(6,Ze,2,0,"div",52),r.k0s()()),2&e){const e=t.$implicit;r.R7$(3),r.Y8G("id",e.id),r.R7$(),r.JRh(e.user_name?e.user_name:e.id),r.R7$(2),r.Y8G("ngIf","*"!=e.id)}}const tt=e=>({page:e,limit:20});function st(e,t){if(1&e){const e=r.RV6();r.j41(0,"div")(1,"table",21)(2,"thead")(3,"tr",22)(4,"th",23)(5,"div",24),r.nrm(6,"system-label",50),r.k0s()(),r.nrm(7,"th",27),r.k0s()(),r.j41(8,"tbody"),r.DNE(9,et,7,3,"tr",28),r.nI1(10,"paginate"),r.nI1(11,"filterACLUsers"),r.k0s()(),r.j41(12,"div",29)(13,"button",30),r.bIt("click",(function(){r.eBV(e);const t=r.XpG(4);return r.Njj(t.selectUser())})),r.nrm(14,"system-button-icon",31),r.k0s()()()}if(2&e){const e=r.XpG(4);r.R7$(9),r.Y8G("ngForOf",r.i5U(10,1,r.i5U(11,4,e.aclusers,e.userNameFilter),r.eq3(7,tt,e.page)))}}const it=e=>({"slds-hidden":e});function lt(e,t){if(1&e){const e=r.RV6();r.j41(0,"div",41)(1,"div",42)(2,"system-checkbox",43),r.mxI("ngModelChange",(function(t){r.eBV(e);const s=r.XpG(3);return r.DH7(s.aclallusers,t)||(s.aclallusers=t),r.Njj(t)})),r.EFF(3,"all users"),r.k0s()(),r.j41(4,"div",44)(5,"div",45)(6,"input",46),r.mxI("ngModelChange",(function(t){r.eBV(e);const s=r.XpG(3);return r.DH7(s.userNameFilter,t)||(s.userNameFilter=t),r.Njj(t)})),r.k0s(),r.j41(7,"button",47),r.bIt("click",(function(){r.eBV(e);const t=r.XpG(3);return r.Njj(t.userNameFilter="")})),r.nrm(8,"system-button-icon",48),r.k0s()()(),r.j41(9,"pagination-controls",49),r.mxI("pageChange",(function(t){r.eBV(e);const s=r.XpG(3);return r.DH7(s.page,t)||(s.page=t),r.Njj(t)})),r.k0s()(),r.DNE(10,st,15,9,"div",16)}if(2&e){const e=r.XpG(3);r.R7$(2),r.R50("ngModel",e.aclallusers),r.R7$(2),r.Y8G("ngClass",r.eq3(9,it,e.aclallusers)),r.R7$(2),r.R50("ngModel",e.userNameFilter),r.R7$(2),r.Y8G("icon","clear"),r.R7$(),r.Y8G("ngClass",r.eq3(11,it,e.aclallusers)),r.R50("page",e.page),r.Y8G("limit",20)("total_records",e.aclusers.length),r.R7$(),r.Y8G("ngIf",!e.aclallusers)}}function nt(e,t){if(1&e&&(r.j41(0,"div",17),r.DNE(1,Ke,2,0,"div",18)(2,lt,11,13,"ng-template",null,39,r.C5r),r.k0s()),2&e){const e=r.sdS(3),t=r.XpG(2);r.R7$(),r.Y8G("ngIf",t.loadingusers)("ngIfElse",e)}}function ot(e,t){1&e&&(r.j41(0,"div",20),r.nrm(1,"system-spinner",40),r.k0s())}function ct(e,t){if(1&e){const e=r.RV6();r.j41(0,"tr")(1,"td")(2,"div",24),r.EFF(3),r.k0s()(),r.j41(4,"td",32)(5,"div",33)(6,"system-utility-icon",36),r.bIt("click",(function(t){const s=r.eBV(e).$implicit,i=r.XpG(4);return r.Njj(i.removeOrgUnit(s.id,t))})),r.k0s()()()()}if(2&e){const e=t.$implicit;r.R7$(3),r.JRh(e.name)}}function at(e,t){if(1&e){const e=r.RV6();r.j41(0,"table",21)(1,"thead")(2,"tr",22)(3,"th",23)(4,"div",24),r.nrm(5,"system-label",54),r.k0s()(),r.nrm(6,"th",27),r.k0s()(),r.j41(7,"tbody"),r.DNE(8,ct,7,1,"tr",28),r.k0s()(),r.j41(9,"div",29)(10,"button",30),r.bIt("click",(function(){r.eBV(e);const t=r.XpG(3);return r.Njj(t.selectOrgUnit())})),r.nrm(11,"system-button-icon",31),r.k0s()()}if(2&e){const e=r.XpG(3);r.R7$(8),r.Y8G("ngForOf",e.aclorgunits)}}function dt(e,t){if(1&e&&(r.j41(0,"div",17),r.DNE(1,ot,2,0,"div",18)(2,at,12,1,"ng-template",null,53,r.C5r),r.k0s()),2&e){const e=r.sdS(3),t=r.XpG(2);r.R7$(),r.Y8G("ngIf",t.loadingorgunits)("ngIfElse",e)}}function rt(e,t){if(1&e){const e=r.RV6();r.j41(0,"div")(1,"div",55)(2,"div",56)(3,"label",57),r.nrm(4,"system-label",26),r.k0s(),r.j41(5,"div",58)(6,"input",59),r.mxI("ngModelChange",(function(t){r.eBV(e);const s=r.XpG(2);return r.DH7(s.profile.name,t)||(s.profile.name=t),r.Njj(t)})),r.k0s()()(),r.j41(7,"div",56)(8,"label",57),r.nrm(9,"system-label",60),r.k0s(),r.j41(10,"div",58)(11,"textarea",61),r.mxI("ngModelChange",(function(t){r.eBV(e);const s=r.XpG(2);return r.DH7(s.profile.description,t)||(s.profile.description=t),r.Njj(t)})),r.k0s()()(),r.j41(12,"div",56)(13,"label",57),r.nrm(14,"system-label",62),r.k0s(),r.j41(15,"div",33)(16,"system-input-radio",63),r.mxI("ngModelChange",(function(t){r.eBV(e);const s=r.XpG(2);return r.DH7(s.profile.spiceaclprofilescope,t)||(s.profile.spiceaclprofilescope=t),r.Njj(t)})),r.nrm(17,"system-label",64),r.k0s(),r.j41(18,"system-input-radio",65),r.mxI("ngModelChange",(function(t){r.eBV(e);const s=r.XpG(2);return r.DH7(s.profile.spiceaclprofilescope,t)||(s.profile.spiceaclprofilescope=t),r.Njj(t)})),r.nrm(19,"system-label",66),r.k0s(),r.j41(20,"system-input-radio",67),r.mxI("ngModelChange",(function(t){r.eBV(e);const s=r.XpG(2);return r.DH7(s.profile.spiceaclprofilescope,t)||(s.profile.spiceaclprofilescope=t),r.Njj(t)})),r.nrm(21,"system-label",68),r.k0s()()(),r.j41(22,"system-checkbox",43),r.mxI("ngModelChange",(function(t){r.eBV(e);const s=r.XpG(2);return r.DH7(s.profile.for_portal_users,t)||(s.profile.for_portal_users=t),r.Njj(t)})),r.nrm(23,"system-label",69),r.k0s(),r.j41(24,"div",70)(25,"button",71),r.bIt("click",(function(){r.eBV(e);const t=r.XpG(2);return r.Njj(t.save())})),r.nrm(26,"system-label",72),r.k0s()()()()}if(2&e){const e=r.XpG(2);r.R7$(6),r.R50("ngModel",e.profile.name),r.R7$(5),r.R50("ngModel",e.profile.description),r.R7$(5),r.Y8G("name","aclprofilescope"+e.profile.id),r.R50("ngModel",e.profile.spiceaclprofilescope),r.R7$(2),r.Y8G("name","aclprofilescope"+e.profile.id),r.R50("ngModel",e.profile.spiceaclprofilescope),r.R7$(2),r.Y8G("name","aclprofilescope"+e.profile.id),r.R50("ngModel",e.profile.spiceaclprofilescope),r.R7$(2),r.R50("ngModel",e.profile.for_portal_users)}}const ut=e=>({"slds-is-active":e});function pt(e,t){if(1&e){const e=r.RV6();r.j41(0,"div",4)(1,"ul",5)(2,"li",6)(3,"a",7),r.bIt("click",(function(){r.eBV(e);const t=r.XpG();return r.Njj(t.activetab="profiles")})),r.nrm(4,"system-label",8),r.k0s()(),r.j41(5,"li",9)(6,"a",7),r.bIt("click",(function(){r.eBV(e);const t=r.XpG();return r.Njj(t.activetab="users")})),r.nrm(7,"system-label",10),r.k0s()(),r.j41(8,"li",11)(9,"a",7),r.bIt("click",(function(){r.eBV(e);const t=r.XpG();return r.Njj(t.activetab="orgunits")})),r.nrm(10,"system-label",12),r.k0s()(),r.j41(11,"li",13)(12,"a",7),r.bIt("click",(function(){r.eBV(e);const t=r.XpG();return r.Njj(t.activetab="details")})),r.nrm(13,"system-label",14),r.k0s()()(),r.DNE(14,Qe,4,2,"div",15)(15,nt,4,2,"div",15)(16,dt,4,2,"div",15)(17,rt,27,9,"div",16),r.k0s()}if(2&e){const e=r.XpG();r.R7$(2),r.Y8G("ngClass",r.eq3(8,ut,"profiles"==e.activetab)),r.R7$(3),r.Y8G("ngClass",r.eq3(10,ut,"users"==e.activetab)),r.R7$(3),r.Y8G("ngClass",r.eq3(12,ut,"orgunits"==e.activetab)),r.R7$(3),r.Y8G("ngClass",r.eq3(14,ut,"details"==e.activetab)),r.R7$(3),r.Y8G("ngIf","profiles"==e.activetab),r.R7$(),r.Y8G("ngIf","users"==e.activetab),r.R7$(),r.Y8G("ngIf","orgunits"==e.activetab),r.R7$(),r.Y8G("ngIf","details"==e.activetab)}}let mt=(()=>{class ACLProfilesManagerProfile{constructor(e,t,s,i){this.modal=e,this.language=t,this.backend=s,this.cdref=i,this.profileid="",this.loaded=!1,this.loadingobjects=!1,this.loadingusers=!1,this.loadingorgunits=!1,this._activetab="profiles",this.aclobjects=[],this.aclusers=[],this.aclorgunits=[],this.page=1,this.userNameFilter=""}get activetab(){return this._activetab}set activetab(e){this._activetab=e,this.cdref.detectChanges()}get aclallusers(){return this.aclusers.filter((e=>"*"==e.id)).length>0}set aclallusers(e){e?this.backend.postRequest("module/SpiceACLProfiles/"+this.profileid+"/related/users",{},{userids:["*"]}).subscribe((e=>{this.aclusers.push({id:"*",user_name:""})})):this.backend.deleteRequest("module/SpiceACLProfiles/"+this.profileid+"/related/users/*").subscribe((e=>{let t=0;for(let e of this.aclusers)"*"==e.id&&this.aclusers.splice(t,1),t++}))}ngOnChanges(){this.loaded=!1,this.profileid&&(this.loadingobjects=!0,this.aclobjects=[],this.loadingusers=!0,this.loadingorgunits=!0,this.aclusers=[],this.backend.getRequest("module/SpiceACLProfiles/"+this.profileid+"/related/spiceaclobjects").subscribe((e=>{this.aclobjects=e,this.loadingobjects=!1,this.sortobjects()})),this.backend.getRequest("module/SpiceACLProfiles/"+this.profileid+"/related/users").subscribe((e=>{this.aclusers=e,this.loadingusers=!1,this.sortusers()})),this.backend.getRequest("module/SpiceACLProfiles/"+this.profileid+"/related/orgunits").subscribe((e=>{this.aclorgunits=e,this.loadingorgunits=!1,this.sortorgunits()})))}selectProfile(){this.modal.openModal("ACLProfilesManagerAddObjectModal").subscribe((e=>{e.instance.aclobject.subscribe((e=>{this.backend.postRequest("module/SpiceACLProfiles/"+this.profileid+"/related/spiceaclobjects/"+e.id).subscribe((t=>{this.aclobjects.push(e),this.sortobjects()}))}))}))}removeProfile(e){this.backend.deleteRequest("module/SpiceACLProfiles/"+this.profileid+"/related/spiceaclobjects/"+e).subscribe((t=>{let s=0;for(let t of this.aclobjects){if(t.id==e)return void this.aclobjects.splice(s,1);s++}}))}save(){this.backend.save("SpiceACLProfiles",this.profileid,{name:this.profile.name,description:this.profile.description,for_portal_users:this.profile.for_portal_users,spiceaclprofilescope:this.profile.spiceaclprofilescope})}removeUser(e,t){t.stopPropagation(),t.preventDefault(),this.backend.deleteRequest("module/SpiceACLProfiles/"+this.profileid+"/related/users/"+e).subscribe((t=>{let s=this.aclusers.findIndex((t=>t.id==e));this.aclusers.splice(s,1)}))}removeOrgUnit(e,t){t.stopPropagation(),t.preventDefault(),this.backend.deleteRequest("module/SpiceACLProfiles/"+this.profileid+"/related/orgunit/"+e).subscribe((t=>{let s=this.aclorgunits.findIndex((t=>t.id==e));this.aclorgunits.splice(s,1)}))}selectUser(){this.modal.openModal("ObjectModalModuleLookup").subscribe((e=>{e.instance.module="Users",e.instance.multiselect=!0,e.instance.selectedItems.subscribe((e=>{if(e.length){let t=[];e.forEach((e=>{-1==this.aclusers.findIndex((t=>t.id==e.id))&&t.push(e.id)})),t.length>0&&this.backend.postRequest("module/SpiceACLProfiles/"+this.profileid+"/related/users",{},{userids:t}).subscribe((t=>{e.forEach((e=>{-1==this.aclusers.findIndex((t=>t.id==e.id))&&this.aclusers.push({id:e.id,user_name:e.user_name})})),this.sortusers()}))}}))}))}selectOrgUnit(){this.modal.openModal("ObjectModalModuleLookup").subscribe((e=>{e.instance.module="OrgUnits",e.instance.multiselect=!0,e.instance.selectedItems.subscribe((e=>{if(e.length){let t=[];e.forEach((e=>{this.aclorgunits.findIndex((t=>t.id==e.id))<0&&t.push(e.id)})),t.length>0&&this.backend.postRequest("module/SpiceACLProfiles/"+this.profileid+"/related/orgunits",{},{orgunitids:t}).subscribe((t=>{e.forEach((e=>{this.aclorgunits.findIndex((t=>t.id==e.id))<0&&this.aclorgunits.push({id:e.id,name:e.name})})),this.sortusers(),this.sortorgunits()}))}}))}))}sortobjects(){this.aclobjects.sort(((e,t)=>e.module==t.module?e.name.localeCompare(t.name):e.module.localeCompare(t.module)))}sortusers(){this.aclusers.sort(((e,t)=>"*"==e.id?-1:"*"==t.id?1:e.user_name.localeCompare(t.user_name)))}sortorgunits(){this.aclorgunits.sort(((e,t)=>e.name.localeCompare(t.name)))}static#e=this.ɵfac=function(e){return new(e||ACLProfilesManagerProfile)(r.rXU(j.y),r.rXU(f.B),r.rXU(u.H),r.rXU(r.gRc))};static#t=this.ɵcmp=r.VBU({type:ACLProfilesManagerProfile,selectors:[["aclprofiles-manager-profile"]],inputs:{profile:"profile",profileid:"profileid"},features:[r.OA$],decls:3,vars:2,consts:[["style","height: 100%;","class","slds-align_absolute-center",4,"ngIf","ngIfElse"],["objectlist",""],[1,"slds-align_absolute-center",2,"height","100%"],[1,"slds-text-heading--small"],[1,"slds-tabs_scoped"],["role","tablist",1,"slds-tabs_scoped__nav"],["title","Profiles","role","presentation",1,"slds-tabs_scoped__item",3,"ngClass"],["href","javascript:void(0);","role","tab",1,"slds-tabs_scoped__link",3,"click"],["label","LBL_SPICEACLOBJECTS"],["system-title","LBL_USERS","role","presentation",1,"slds-tabs_scoped__item",3,"ngClass"],["label","LBL_USERS"],["system-title","LBL_ORGUNITS","role","presentation",1,"slds-tabs_scoped__item",3,"ngClass"],["label","LBL_ORGUNITS"],["system-title","LBL_DETAILS","role","presentation",1,"slds-tabs_scoped__item",3,"ngClass"],["label","LBL_DETAILS"],["system-to-bottom","",4,"ngIf"],[4,"ngIf"],["system-to-bottom",""],["class","slds-p-around--medium slds-align--absolute-center",4,"ngIf","ngIfElse"],["objectsdisplay",""],[1,"slds-p-around--medium","slds-align--absolute-center"],[1,"slds-table","slds-table_bordered","slds-table_cell-buffer"],[1,"slds-text-title_caps"],["scope","col"],[1,"slds-truncate"],["label","LBL_MODULE"],["label","LBL_NAME"],["scope","col",2,"width","3rem"],[4,"ngFor","ngForOf"],[1,"slds-p-around--medium","slds-align_absolute-center"],[1,"slds-button",3,"click"],["icon","new"],[2,"width","3rem"],[1,"slds-grid"],["icon","light-bulb-on","size","x-small","addclasses","slds-icon slds-icon-text-default",4,"ngIf"],["icon","light-bulb-off","size","x-small","addclasses","slds-icon slds-icon-text-light",4,"ngIf"],["icon","delete","size","x-small",3,"click"],["icon","light-bulb-on","size","x-small","addclasses","slds-icon slds-icon-text-default"],["icon","light-bulb-off","size","x-small","addclasses","slds-icon slds-icon-text-light"],["usersdisplay",""],["message","LBL_LOADING"],[1,"slds-grid","slds-grid--align-spread","slds-grid--vertical-align-center","slds-p-around--x-small"],[1,"slds-col--bump-right"],[3,"ngModel","ngModelChange"],[1,"slds-p-right--x-small","slds-size--1-of-4",3,"ngClass"],[1,"slds-form-element__control","slds-input-has-icon","slds-input-has-icon_right"],["type","text","system-placeholder","LBL_FILTER",1,"slds-input",3,"ngModel","ngModelChange"],[1,"slds-input__icon","slds-input__icon_right","slds-button","slds-button_icon",3,"click"],[3,"icon"],["variation","short",3,"ngClass","page","limit","total_records","pageChange"],["label","LBL_USER_NAME"],["system-model-popover","","module","Users",3,"id"],["class","slds-grid",4,"ngIf"],["orgunitdisplay",""],["label","LBL_ORGUNIT"],[1,"slds-p-around--x-small"],[1,"slds-form-element"],[1,"slds-form-element__label"],[1,"slds-form-element__control"],["type","text",1,"slds-input",3,"ngModel","ngModelChange"],["label","LBL_DESCRIPTION"],[1,"slds-textarea",3,"ngModel","ngModelChange"],["label","LBL_APPLICABLE_SCOPE"],["value","a",3,"name","ngModel","ngModelChange"],["label","LBL_ALL"],["value","i",3,"name","ngModel","ngModelChange"],["label","LBL_INTERNAL_ONLY"],["value","e",3,"name","ngModel","ngModelChange"],["label","LBL_EXTERNAL_ONLY"],["label","LBL_FOR_PORTAL_USERS"],[1,"slds-p-vertical--x-small","slds-align--absolute-center"],[1,"slds-button","slds-button--brand",3,"click"],["label","LBL_SAVE"]],template:function(e,t){if(1&e&&r.DNE(0,we,3,0,"div",0)(1,pt,18,16,"ng-template",null,1,r.C5r),2&e){const e=r.sdS(2);r.Y8G("ngIf",!t.profileid)("ngIfElse",e)}},dependencies:[i.YU,i.Sq,i.bT,l.me,l.BC,l.vS,Se.e,z.t,ke.f,Ve.k,De.J,h.W,v.P,_.B,Ne.j,L.b,C.m,Ye.L,Se.j,Pe],encapsulation:2})}return ACLProfilesManagerProfile})(),ft=(()=>{class ACLProfilesManager{constructor(e,t,s){this.backend=e,this.modelutilities=t,this.elementRef=s,this.activeprofileid=""}setProfile(e){this.activeprofile=e,this.activeprofileid=e.id}static#e=this.ɵfac=function(e){return new(e||ACLProfilesManager)(r.rXU(u.H),r.rXU(p.g),r.rXU(r.aKT))};static#t=this.ɵcmp=r.VBU({type:ACLProfilesManager,selectors:[["acl-profiles-manager"]],decls:4,vars:2,consts:[["displaylabel","LBL_SPICEACLPROFILES"],[1,"slds-grid"],[1,"slds-size--1-of-2","slds-border--right",3,"profileselected"],[1,"slds-size--1-of-2",2,"height","100%",3,"profileid","profile"]],template:function(e,t){1&e&&(r.nrm(0,"acl-manager-header",0),r.j41(1,"div",1)(2,"aclprofiles-manager-profiles",2),r.bIt("profileselected",(function(e){return t.setProfile(e)})),r.k0s(),r.nrm(3,"aclprofiles-manager-profile",3),r.k0s()),2&e&&(r.R7$(3),r.Y8G("profileid",t.activeprofileid)("profile",t.activeprofile))},dependencies:[y,Xe,mt],encapsulation:2})}return ACLProfilesManager})();const bt=["header"];function ht(e,t){if(1&e&&(r.qex(0),r.j41(1,"option",14),r.EFF(2),r.k0s(),r.bVm()),2&e){const e=t.$implicit;r.R7$(),r.Y8G("value",e.id),r.R7$(),r.JRh(e.module)}}function gt(e,t){1&e&&(r.j41(0,"div",15),r.nrm(1,"system-spinner"),r.k0s())}function yt(e,t){1&e&&r.nrm(0,"system-custom-icon",28)}function jt(e,t){1&e&&r.nrm(0,"system-custom-icon",29)}const kt=e=>({"slds-theme--shade":e});function vt(e,t){if(1&e){const e=r.RV6();r.j41(0,"tr",24),r.bIt("click",(function(){const t=r.eBV(e).$implicit,s=r.XpG(2);return r.Njj(s.selectObject(t))})),r.j41(1,"td")(2,"div",19),r.EFF(3),r.k0s()(),r.j41(4,"td")(5,"div",19),r.EFF(6),r.k0s()(),r.j41(7,"td",25),r.DNE(8,yt,1,0,"system-custom-icon",26)(9,jt,1,0,"system-custom-icon",27),r.k0s()()}if(2&e){const e=t.$implicit,s=r.XpG(2);r.Y8G("ngClass",r.eq3(5,kt,e.id==s.activeObjectId)),r.R7$(3),r.JRh(e.name),r.R7$(3),r.JRh(s.getType(e.spiceaclobjecttype)),r.R7$(2),r.Y8G("ngIf","r"==e.status),r.R7$(),r.Y8G("ngIf","r"!=e.status)}}function _t(e,t){if(1&e&&(r.j41(0,"table",16)(1,"thead")(2,"tr",17)(3,"th",18)(4,"div",19),r.nrm(5,"system-label",20),r.k0s()(),r.j41(6,"th",18)(7,"div",19),r.nrm(8,"system-label",21),r.k0s()(),r.nrm(9,"th",22),r.k0s()(),r.j41(10,"tbody"),r.DNE(11,vt,10,7,"tr",23),r.k0s()()),2&e){const e=r.XpG();r.R7$(11),r.Y8G("ngForOf",e.aclobjects)}}let Lt=(()=>{class ACLProfilesManagerAddObjectModal{constructor(e,t){this.language=e,this.backend=t,this.self={},this.acltypes=[],this.aclobjects=[],this.activeTypeId="",this.activeObjectId="",this.searchterm="",this.loading=!1,this.aclobject=new r.bkB,this.backend.getRequest("module/SpiceACLObjects/modules").subscribe((e=>{this.acltypes=e,this.acltypes.sort(((e,t)=>e.module>t.module?1:-1))}))}keyUp(e){if("Enter"===e.key)this.getObjects()}getObjects(){this.loading=!0,this.aclobjects=[];let e={moduleid:this.activeTypeId,searchterm:this.searchterm};this.backend.getRequest("module/SpiceACLObjects",e).subscribe((e=>{this.aclobjects=e,this.aclobjects.sort(((e,t)=>e.name>t.name?1:-1)),this.loading=!1}))}getType(e){return this.language.getFieldDisplayOptionValue("SpiceACLObjects","spiceaclobjecttype",e)}selectType(e){this.getObjects(),this.activeObjectId=""}get currentModule(){for(let e of this.acltypes)if(e.id==this.activeTypeId)return e.module;return""}selectObject(e){e.module=this.currentModule,this.aclobject.emit(e),this.close()}close(){this.self.destroy()}static#e=this.ɵfac=function(e){return new(e||ACLProfilesManagerAddObjectModal)(r.rXU(f.B),r.rXU(u.H))};static#t=this.ɵcmp=r.VBU({type:ACLProfilesManagerAddObjectModal,selectors:[["ng-component"]],viewQuery:function(e,t){if(1&e&&r.GBs(bt,7,r.c1b),2&e){let e;r.mGM(e=r.lsd())&&(t.header=e.first)}},outputs:{aclobject:"aclobject"},features:[r.Jv_([ne.g])],decls:17,vars:8,consts:[[3,"close"],["label","LBL_SELECT_SPICEACLOBJECT"],["margin","none",3,"grow"],[1,"slds-grid","slds-grid--vertical-align-center","slds-p-around--x-small"],["header",""],[1,"slds-form-element__control","slds-size--1-of-3","slds-p-right--xx-small"],[1,"slds-select_container"],[1,"slds-select",3,"ngModel","disabled","ngModelChange","change"],[4,"ngFor","ngForOf"],["type","text",1,"slds-input",3,"disabled","ngModel","ngModelChange","keyup"],["class","slds-p-around--medium slds-align--absolute-center",4,"ngIf","ngIfElse"],["typesdisplay",""],[1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_CANCEL"],[3,"value"],[1,"slds-p-around--medium","slds-align--absolute-center"],[1,"slds-table","slds-table_bordered","slds-table_cell-buffer"],[1,"slds-text-title_caps"],["scope","col"],[1,"slds-truncate"],["label","LBL_NAME"],["label","LBL_TYPE"],["scope","col",2,"width","3rem"],[3,"ngClass","click",4,"ngFor","ngForOf"],[3,"ngClass","click"],[2,"width","3rem"],["icon","light-bulb-on","size","x-small","addclasses","slds-icon slds-icon-text-default",4,"ngIf"],["icon","light-bulb-off","size","x-small","addclasses","slds-icon slds-icon-text-light",4,"ngIf"],["icon","light-bulb-on","size","x-small","addclasses","slds-icon slds-icon-text-default"],["icon","light-bulb-off","size","x-small","addclasses","slds-icon slds-icon-text-light"]],template:function(e,t){if(1&e&&(r.j41(0,"system-modal")(1,"system-modal-header",0),r.bIt("close",(function(){return t.close()})),r.nrm(2,"system-label",1),r.k0s(),r.j41(3,"system-modal-content",2)(4,"div",3,4)(6,"div",5)(7,"div",6)(8,"select",7),r.mxI("ngModelChange",(function(e){return r.DH7(t.activeTypeId,e)||(t.activeTypeId=e),e})),r.bIt("change",(function(e){return t.selectType(e)})),r.DNE(9,ht,3,2,"ng-container",8),r.k0s()()(),r.j41(10,"input",9),r.mxI("ngModelChange",(function(e){return r.DH7(t.searchterm,e)||(t.searchterm=e),e})),r.bIt("keyup",(function(e){return t.keyUp(e)})),r.k0s()(),r.DNE(11,gt,2,0,"div",10)(12,_t,12,1,"ng-template",null,11,r.C5r),r.k0s(),r.j41(14,"system-modal-footer")(15,"button",12),r.bIt("click",(function(){return t.close()})),r.nrm(16,"system-label",13),r.k0s()()()),2&e){const e=r.sdS(13);r.R7$(3),r.Y8G("grow",!0),r.R7$(5),r.R50("ngModel",t.activeTypeId),r.Y8G("disabled",0==t.acltypes.length),r.R7$(),r.Y8G("ngForOf",t.acltypes),r.R7$(),r.Y8G("disabled",!t.activeTypeId),r.R50("ngModel",t.searchterm),r.R7$(),r.Y8G("ngIf",t.loading)("ngIfElse",e)}},dependencies:[i.YU,i.Sq,i.bT,l.xH,l.y7,l.me,l.wz,l.BC,l.vS,Ve.k,h.W,S.D,V.I,D.Q,N.C,v.P],encapsulation:2})}return ACLProfilesManagerAddObjectModal})(),Ct=(()=>{class ACLProfilesManagerAddProfileModal{constructor(e,t,s,i){this.metadata=e,this.model=t,this.view=s,this.language=i,this.self={},this.fieldset="",this.sysmodule_id="",this.newObjectData=new r.bkB,this.model.module="SpiceACLProfiles",this.model.initialize(),this.model.setField("status","d"),this.view.isEditable=!0,this.view.setEditMode();let l=this.metadata.getComponentConfig("ACLProfilesManagerAddProfileModal",this.model.module);this.fieldset=l.fieldset}ngOnInit(){this.model.setField("sysmodule_id",this.sysmodule_id)}close(){this.self.destroy()}save(){this.model.save().subscribe((e=>{this.newObjectData.emit(this.model.data),this.close()}))}static#e=this.ɵfac=function(e){return new(e||ACLProfilesManagerAddProfileModal)(r.rXU(X.yu),r.rXU(ne.g),r.rXU(ge.U),r.rXU(f.B))};static#t=this.ɵcmp=r.VBU({type:ACLProfilesManagerAddProfileModal,selectors:[["ng-component"]],inputs:{sysmodule_id:"sysmodule_id"},outputs:{newObjectData:"newObjectData"},features:[r.Jv_([ne.g,ge.U])],decls:10,vars:1,consts:[[3,"close"],["label","LBL_ADD_SPICEACLPROFILE"],["margin","none"],["direction","vertical",3,"fieldset"],[1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_CANCEL"],[1,"slds-button","slds-button--brand",3,"click"],["label","LBL_SAVE"]],template:function(e,t){1&e&&(r.j41(0,"system-modal")(1,"system-modal-header",0),r.bIt("close",(function(){return t.close()})),r.nrm(2,"system-label",1),r.k0s(),r.j41(3,"system-modal-content",2),r.nrm(4,"object-record-fieldset",3),r.k0s(),r.j41(5,"system-modal-footer")(6,"button",4),r.bIt("click",(function(){return t.close()})),r.nrm(7,"system-label",5),r.k0s(),r.j41(8,"button",6),r.bIt("click",(function(){return t.save()})),r.nrm(9,"system-label",7),r.k0s()()()),2&e&&(r.R7$(4),r.Y8G("fieldset",t.fieldset))},dependencies:[ye.D,h.W,S.D,V.I,D.Q,N.C],encapsulation:2})}return ACLProfilesManagerAddProfileModal})();var It=s(41081),At=s(29994);function Rt(e,t){1&e&&r.nrm(0,"system-utility-icon",16)}function Ot(e,t){1&e&&r.nrm(0,"system-utility-icon",17)}function Ft(e,t){1&e&&r.nrm(0,"system-utility-icon",18)}const Et=e=>({"slds-is-selected":e});function Mt(e,t){if(1&e){const e=r.RV6();r.j41(0,"tr",9),r.qex(1),r.j41(2,"td",10),r.bIt("click",(function(){const t=r.eBV(e).$implicit,s=r.XpG();return r.Njj(s.selectProfile(t.id))})),r.EFF(3),r.k0s(),r.j41(4,"td",11),r.DNE(5,Rt,1,0,"system-utility-icon",12)(6,Ot,1,0,"system-utility-icon",13)(7,Ft,1,0,"system-utility-icon",14),r.k0s(),r.j41(8,"td",11),r.nrm(9,"system-utility-icon",15),r.k0s(),r.bVm(),r.k0s()}if(2&e){const e=t.$implicit,s=r.XpG();r.Y8G("ngClass",r.eq3(6,Et,e.id==s.selectedProfileId)),r.R7$(3),r.SpI(" ",e.name," "),r.R7$(2),r.Y8G("ngIf","global"==e.profilesource),r.R7$(),r.Y8G("ngIf","user"==e.profilesource),r.R7$(),r.Y8G("ngIf","orgunit"==e.profilesource),r.R7$(2),r.Y8G("colorclass","r"==e.status?"slds-icon-text-success":"slds-icon-text-light")}}function Gt(e,t){if(1&e&&(r.j41(0,"tr",25),r.qex(1),r.j41(2,"td"),r.EFF(3),r.k0s(),r.j41(4,"td"),r.EFF(5),r.k0s(),r.j41(6,"td",11),r.nrm(7,"system-utility-icon",26),r.k0s(),r.bVm(),r.k0s()),2&e){const e=t.$implicit;r.R7$(3),r.SpI(" ",e.module," "),r.R7$(2),r.SpI(" ",e.name," "),r.R7$(2),r.Y8G("colorclass","r"==e.status?"slds-icon-text-success":"slds-icon-text-light")}}function Tt(e,t){if(1&e&&(r.j41(0,"table",19)(1,"thead",1)(2,"tr",2)(3,"th",20),r.nrm(4,"system-label",21),r.k0s(),r.j41(5,"th",22),r.nrm(6,"system-label",23),r.k0s(),r.j41(7,"th",4),r.nrm(8,"system-label",6),r.k0s()()(),r.j41(9,"tbody"),r.DNE(10,Gt,8,3,"tr",24),r.k0s()()),2&e){const e=r.XpG();r.R7$(10),r.Y8G("ngForOf",e.profileObjects)}}let Bt=(()=>{class ACLUserProfiles{constructor(e,t,s,i,l,n){this.backend=e,this.toast=t,this.modal=s,this.model=i,this.session=l,this.language=n,this.userProfiles=[],this.selectedProfileId="",this.profileObjects=[],this.backend.getRequest("module/Users/"+this.model.id+"/related/spiceaclprofiles").subscribe((e=>{this.userProfiles=e}))}selectProfile(e){this.selectedProfileId!=e&&(this.selectedProfileId=e,this.profileObjects=[],this.backend.getRequest("module/SpiceACLProfiles/"+e+"/related/spiceaclobjects").subscribe((e=>{for(let t in e)this.profileObjects.push(e[t])})))}static#e=this.ɵfac=function(e){return new(e||ACLUserProfiles)(r.rXU(u.H),r.rXU(It.o),r.rXU(j.y),r.rXU(ne.g),r.rXU(At.d),r.rXU(f.B))};static#t=this.ɵcmp=r.VBU({type:ACLUserProfiles,selectors:[["acl-user-profiles"]],decls:12,vars:2,consts:[[1,"slds-table","slds-table--fixed-layout","slds-table_bordered",2,"box-shadow","0px 2px 5px 0 rgba(0,0,0,.1)","border-radius",".15rem"],[1,"slds-table--bordered","slds-text-align_center"],[1,"slds-text-title--caps"],["label","LBL_SPICEACLPROFILE"],[1,"slds-text-align--center",2,"width","4rem"],["label","LBL_SCOPE"],["label","LBL_ACTIVE"],["class","slds-hint-parent",3,"ngClass",4,"ngFor","ngForOf"],["class","slds-table slds-table--fixed-layout slds-table_bordered slds-table_cell-buffer slds-m-top--medium","style","box-shadow:0px 2px 5px 0 rgba(0,0,0,.1); border-radius: .15rem",4,"ngIf"],[1,"slds-hint-parent",3,"ngClass"],[3,"click"],[1,"slds-text-align--center"],["icon","world","size","x-small",4,"ngIf"],["icon","user","size","x-small",4,"ngIf"],["icon","org_chart","size","x-small",4,"ngIf"],["icon","light_bulb","size","x-small",3,"colorclass"],["icon","world","size","x-small"],["icon","user","size","x-small"],["icon","org_chart","size","x-small"],[1,"slds-table","slds-table--fixed-layout","slds-table_bordered","slds-table_cell-buffer","slds-m-top--medium",2,"box-shadow","0px 2px 5px 0 rgba(0,0,0,.1)","border-radius",".15rem"],[2,"width","30%"],["label","LBL_MODULE"],[2,"width","70%"],["label","LBL_SPICEACLOBJECT"],["class","slds-hint-parent",4,"ngFor","ngForOf"],[1,"slds-hint-parent"],["icon","light_bulb","size","x-small","addclasses","slds-icon slds-icon-text-default",3,"colorclass"]],template:function(e,t){1&e&&(r.j41(0,"table",0)(1,"thead",1)(2,"tr",2)(3,"th"),r.nrm(4,"system-label",3),r.k0s(),r.j41(5,"th",4),r.nrm(6,"system-label",5),r.k0s(),r.j41(7,"th",4),r.nrm(8,"system-label",6),r.k0s()()(),r.j41(9,"tbody"),r.DNE(10,Mt,10,8,"tr",7),r.k0s()(),r.DNE(11,Tt,11,1,"table",8)),2&e&&(r.R7$(10),r.Y8G("ngForOf",t.userProfiles),r.R7$(),r.Y8G("ngIf",t.profileObjects.length>0))},dependencies:[i.YU,i.Sq,i.bT,h.W,_.B],encapsulation:2})}return ACLUserProfiles})();var xt=s(13921),$t=s(57363),Ut=s(766),Xt=s(66935),St=s(89166),Vt=s(53915),Dt=s(29836);function Nt(e,t){if(1&e&&r.nrm(0,"field-label",3),2&e){const e=r.XpG();r.Y8G("fieldname",e.fieldname)("fieldconfig",e.fieldconfig)}}function Yt(e,t){if(1&e&&(r.j41(0,"li",7)(1,"a",8),r.EFF(2),r.k0s()()),2&e){const e=t.$implicit;r.R7$(),r.Y8G("id",e.id),r.R7$(),r.JRh(e.summary_text)}}function Pt(e,t){if(1&e&&(r.j41(0,"field-generic-display",4)(1,"ul",5),r.DNE(2,Yt,3,2,"li",6),r.k0s()()),2&e){const e=r.XpG();r.Y8G("fielddisplayclass",e.fielddisplayclass)("fieldconfig",e.fieldconfig)("editable",e.isEditable()),r.R7$(2),r.Y8G("ngForOf",e.users)}}function wt(e,t){if(1&e){const e=r.RV6();r.j41(0,"field-lookup-recent",22),r.bIt("selectedObject",(function(t){r.eBV(e);const s=r.XpG(2);return r.Njj(s.addItem(t))})),r.k0s()}}function qt(e,t){if(1&e){const e=r.RV6();r.j41(0,"field-lookup-search",23),r.bIt("selectedObject",(function(t){r.eBV(e);const s=r.XpG(2);return r.Njj(s.addItem(t))}))("searchWithModal",(function(){r.eBV(e);const t=r.XpG(2);return r.Njj(t.searchWithModal())})),r.k0s()}if(2&e){const e=r.XpG(2);r.Y8G("searchterm",e.lookupSearchTerm)("disableadd",!0)}}function zt(e,t){if(1&e){const e=r.RV6();r.j41(0,"li",26)(1,"div",27)(2,"span",28),r.nrm(3,"system-icon",29),r.k0s(),r.j41(4,"span",30),r.EFF(5),r.k0s(),r.j41(6,"button",31),r.bIt("click",(function(){const t=r.eBV(e).$implicit,s=r.XpG(3);return r.Njj(s.removeItem(t.id))})),r.nrm(7,"system-button-icon",16),r.k0s()()()}if(2&e){const e=t.$implicit;r.R7$(4),r.Y8G("id",e.id),r.R7$(),r.JRh(e.summary_text),r.R7$(2),r.Y8G("icon","close")}}function Ht(e,t){if(1&e&&(r.j41(0,"ul",24),r.DNE(1,zt,8,3,"li",25),r.k0s()),2&e){const e=r.XpG(2);r.R7$(),r.Y8G("ngForOf",e.users)}}const Jt=e=>({"slds-is-open":e});function Wt(e,t){if(1&e){const e=r.RV6();r.j41(0,"div",9)(1,"div",10)(2,"div",11)(3,"div",12)(4,"div",13)(5,"input",14),r.bIt("focus",(function(){r.eBV(e);const t=r.XpG();return r.Njj(t.onFocus())}))("click",(function(){r.eBV(e);const t=r.XpG();return r.Njj(t.onFieldClick())})),r.mxI("ngModelChange",(function(t){r.eBV(e);const s=r.XpG();return r.DH7(s.lookupSearchTerm,t)||(s.lookupSearchTerm=t),r.Njj(t)})),r.k0s(),r.j41(6,"button",15),r.bIt("click",(function(){r.eBV(e);const t=r.XpG();return r.Njj(t.searchWithModal())})),r.nrm(7,"system-button-icon",16),r.k0s()(),r.j41(8,"div",17),r.DNE(9,wt,1,0,"field-lookup-recent",18)(10,qt,1,2,"field-lookup-search",19),r.k0s()()()(),r.DNE(11,Ht,2,1,"ul",20),r.nrm(12,"field-messages",21),r.k0s()}if(2&e){const e=r.XpG();r.Y8G("ngClass",e.getFieldClass()),r.R7$(3),r.Y8G("ngClass",r.eq3(9,Jt,e.lookupSearchOpen)),r.R7$(2),r.R50("ngModel",e.lookupSearchTerm),r.Y8G("placeholder",e.language.getModuleCombinedLabel("LBL_SEARCH","Users")),r.R7$(2),r.Y8G("icon","search"),r.R7$(2),r.Y8G("ngIf",e.lookupSearchOpen&&""===e.lookupSearchTerm),r.R7$(),r.Y8G("ngIf",e.lookupSearchOpen&&""!==e.lookupSearchTerm),r.R7$(),r.Y8G("ngIf",e.users.length>0),r.R7$(),r.Y8G("fieldname",e.fieldname)}}let Qt=(()=>{class fieldACLAdditionalUsers extends xt.s{constructor(e,t,s,i,l,n,o,c){super(e,t,s,i,l),this.model=e,this.view=t,this.language=s,this.metadata=i,this.router=l,this.elementRef=n,this.renderer=o,this.modal=c,this.lookupSearchOpen=!1,this.lookupSearchTerm=""}get displayAssignedUser(){return this.fieldconfig.displayassigneduser}get users(){try{return JSON.parse(this.model.getField("spiceacl_additional_users"))}catch(e){return[]}}set users(e){this.model.setField("spiceacl_additional_users",JSON.stringify(e))}addItem(e){let t=this.users;-1==t.findIndex((t=>t.id==e.id))&&t.push({id:e.id,summary_text:e.text}),this.closePopups(),this.users=t}onClick(e){this.elementRef.nativeElement.contains(e.target)||this.closePopups()}closePopups(){this.lookupSearchOpen=!1,this.lookupSearchTerm="",this.clickListener()}removeItem(e){let t=this.users,s=t.findIndex((t=>t.id==e));s>=0&&t.splice(s,1),this.users=t}onFocus(){this.openSearchDropDown()}onFieldClick(){this.openSearchDropDown()}openSearchDropDown(){this.lookupSearchOpen=!0,this.clickListener=this.renderer.listen("document","click",(e=>this.onClick(e)))}parentSearchStyle(){if(this.lookupSearchOpen)return{display:"block"}}searchWithModal(){this.modal.openModal("ObjectModalModuleLookup").subscribe((e=>{e.instance.module="Users",e.instance.multiselect=!1,e.instance.selectedItems.subscribe((e=>{this.addItem({id:e[0].id,text:e[0].summary_text,data:e[0]})})),e.instance.usedSearchTerm.subscribe((e=>{this.lookupSearchTerm=e})),e.instance.searchTerm=this.lookupSearchTerm}))}static#e=this.ɵfac=function(e){return new(e||fieldACLAdditionalUsers)(r.rXU(ne.g),r.rXU(ge.U),r.rXU(f.B),r.rXU(X.yu),r.rXU($t.Ix),r.rXU(r.aKT),r.rXU(r.sFG),r.rXU(j.y))};static#t=this.ɵcmp=r.VBU({type:fieldACLAdditionalUsers,selectors:[["ng-component"]],features:[r.Vt3],decls:3,vars:3,consts:[[3,"fieldname","fieldconfig",4,"ngIf"],[3,"fielddisplayclass","fieldconfig","editable",4,"ngIf"],["class","slds-form-element__control",3,"ngClass",4,"ngIf"],[3,"fieldname","fieldconfig"],[3,"fielddisplayclass","fieldconfig","editable"],[1,"slds-list_horizontal","slds-has-dividers_left"],["class","slds-item",4,"ngFor","ngForOf"],[1,"slds-item"],["href","javascript:void(0);","system-model-popover","","module","Users",1,"slds-text-link_reset",3,"id"],[1,"slds-form-element__control",3,"ngClass"],[1,"slds-form-element__control","slds-box--border"],[1,"slds-combobox_container"],["role","combobox",1,"slds-combobox","slds-dropdown-trigger","slds-dropdown-trigger_click",3,"ngClass"],["role","none",1,"slds-combobox__form-element","slds-input-has-icon","slds-input-has-icon_right"],["type","text","aria-autocomplete","list","autoComplete","off","role","textbox",1,"slds-input","slds-combobox__input",3,"ngModel","placeholder","focus","click","ngModelChange"],[1,"slds-button","slds-button_icon","slds-input__icon","slds-input__icon_right",3,"click"],[3,"icon"],["role","listbox",1,"slds-dropdown","slds-dropdown_length-with-icon-7","slds-dropdown_fluid"],["module","Users",3,"selectedObject",4,"ngIf"],["module","Users",3,"searchterm","disableadd","selectedObject","searchWithModal",4,"ngIf"],["class","slds-listbox slds-listbox_horizontal","role","group",4,"ngIf"],[3,"fieldname"],["module","Users",3,"selectedObject"],["module","Users",3,"searchterm","disableadd","selectedObject","searchWithModal"],["role","group",1,"slds-listbox","slds-listbox_horizontal"],["role","presentation","class","slds-listbox__item slds-p-top_xxx-small",4,"ngFor","ngForOf"],["role","presentation",1,"slds-listbox__item","slds-p-top_xxx-small"],[1,"slds-pill"],[1,"slds-icon_container","slds-icon-standard-account","slds-pill__icon_container"],["module","Users","size","small"],["system-model-popover","","module","Users",1,"slds-pill__label",3,"id"],[1,"slds-button","slds-button--icon","slds-pill__remove",3,"click"]],template:function(e,t){1&e&&r.DNE(0,Nt,1,2,"field-label",0)(1,Pt,3,4,"field-generic-display",1)(2,Wt,13,11,"div",2),2&e&&(r.Y8G("ngIf",t.displayLabel),r.R7$(),r.Y8G("ngIf",!t.isEditMode()),r.R7$(),r.Y8G("ngIf",t.isEditable()&&t.isEditMode()))},dependencies:[i.YU,i.Sq,i.bT,l.me,l.BC,l.vS,Ut.b,Xt.K,St.A,Vt._,Dt.T,z.t,b.J,Ne.j],styles:["\n\n\n\n\n\n\n\n\n\n\ninput[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:focus{border:none;outline:none}"]})}return fieldACLAdditionalUsers})(),Kt=(()=>{class ModuleACL{static#e=this.ɵfac=function(e){return new(e||ModuleACL)};static#t=this.ɵmod=r.$C({type:ModuleACL});static#s=this.ɵinj=r.G2t({imports:[i.MD,l.YN,n.ObjectFields,o.GlobalComponents,c.ObjectComponents,d.SystemComponents,a.h]})}return ModuleACL})();("undefined"==typeof ngJitMode||ngJitMode)&&r.Obh(Kt,{declarations:[U,y,M,T,q,x,w,he,le,je,fe,Ce,Re,Me,ft,Xe,mt,Ct,Lt,Bt,Qt,Pe],imports:[i.MD,l.YN,n.ObjectFields,o.GlobalComponents,c.ObjectComponents,d.SystemComponents,a.h]})}}]);